<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L128">[^]</a><a href="#L414">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L128" title="Defined at 128.">getEngineTime</a></li>
<li><a href="#L150" title="Defined at 150.">getEngineId</a></li>
<li><a href="#L158" title="Defined at 158.">getUsmKeyHandler</a></li>
<li><a href="#L166" title="Defined at 166.">getLcd</a></li>
<li><a href="#L173" title="Defined at 173.">getEngineBoots</a></li>
<li><a href="#L309" title="Defined at 309.">activateCheckOid</a></li>
<li><a href="#L316" title="Defined at 316.">deactivateCheckOid</a></li>
<li><a href="#L323" title="Defined at 323.">isCheckOidActivated</a></li>
<li><a href="#L328" title="Defined at 328.">storeNBBoots</a></li>
<li><a href="#L338" title="Defined at 338.">init</a></li>
<li><a href="#L352" title="Defined at 352.">setUsmKeyHandler</a></li>
<li><a href="#L357" title="Defined at 357.">initEngineID</a></li>
<li><a href="#L369" title="Defined at 369.">getMsgProcessingSubSystem</a></li>
<li><a href="#L377" title="Defined at 377.">setMsgProcessingSubSystem</a></li>
<li><a href="#L385" title="Defined at 385.">getSecuritySubSystem</a></li>
<li><a href="#L392" title="Defined at 392.">setSecuritySubSystem</a></li>
<li><a href="#L399" title="Defined at 399.">setAccessControlSubSystem</a></li>
<li><a href="#L407" title="Defined at 407.">getAccessControlSubSystem</a></li>
<li><a href="#L414" title="Defined at 414.">checkSecurityLevel</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2001, 2006, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 <strong class="reserved">package</strong> com.sun.jmx.snmp.internal;
<a id="L26" name="L26"></a>  26 
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.net.InetAddress;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.net.UnknownHostException;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.util.Hashtable;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.util.logging.Level;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.io.Serializable;
<a id="L32" name="L32"></a>  32 
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpDefinitions;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpEngineId;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpEngine;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpUsmKeyHandler;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpEngineFactory;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpUnknownModelException;
<a id="L39" name="L39"></a>  39 
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> com.sun.jmx.snmp.internal.SnmpTools;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpBadSecurityLevelException;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> static com.sun.jmx.defaults.JmxProperties.SNMP_LOGGER;
<a id="L43" name="L43"></a>  43 
<div class="comment">
  This engine is conformant with the RFC 2571. It is the main object within
  an SNMP entity (agent, manager...).
  To an engine is associated an {@link com.sun.jmx.snmp.SnmpEngineId}.
  The way the engineId is retrieved is linked to the way the engine is
  instantiated. See each <code>SnmpEngine</code> constructor for more details.
  An engine is composed of a set of sub systems
  {@link com.sun.jmx.snmp.internal.SnmpSubSystem}. An <code>SNMP</code>
  engine can contain a:
 <ul><li> Message Processing Sub System :
  {@link com.sun.jmx.snmp.internal.SnmpMsgProcessingSubSystem}</li><li> Security Sub System :
  {@link com.sun.jmx.snmp.internal.SnmpSecuritySubSystem} </li><li> Access Control Sub System :
  {@link com.sun.jmx.snmp.internal.SnmpAccessControlSubSystem}</li>
 </ul>
 <p> Each sub system contains a set of models. A model is an implementation
  of a particular treatement (eg: the User based Security Model defined in
  RFC 2574 is a functional element dealing with authentication and privacy).
 </p>
  Engine instantiation is based on a factory. This factory, implementing
  mandatorily {@link com.sun.jmx.snmp.SnmpEngineFactory  SnmpEngineFactory}
  is set in the method <code>setFactory</code>.
  <p><b>This API is a Sun Microsystems internal API  and is subject
  to change without notice.</b></p>
  @since 1.5</div>
<a id="L72" name="L72"></a>  72 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/7344.html" title="Multiple referred from 8 places.">SnmpEngineImpl</a> <strong class="reserved">implements</strong> <a href="../S/6481.html#L47" title="Defined at 47 in src/com/sun/jmx/snmp/SnmpEngine.java.">SnmpEngine</a>, <a href="../S/1407.html#L169" title="Defined at 169 in src/java/io/Serializable.java.">Serializable</a> <em class="brace">{</em>
<a id="L73" name="L73"></a>  73     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = -2564301391365614725L;
<a id="L74" name="L74"></a>  74 
<div class="comment">
      Security level. No authentication, no privacy. Value is 0,
      as defined in RFC 2572</div>
<a id="L79" name="L79"></a>  79     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> noAuthNoPriv = 0;
<div class="comment">
      Security level. Authentication, no privacy. Value is 1, as
      defined in RFC 2572</div>
<a id="L84" name="L84"></a>  84     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> authNoPriv = 1;
<div class="comment">
      Security level. Authentication, privacy. Value is 3,
      as defined in RFC 2572</div>
<a id="L89" name="L89"></a>  89     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> authPriv = 3;
<div class="comment">
      Flag that indicates that a report is to be sent. Value is 4, as defined in RFC 2572</div>
<a id="L93" name="L93"></a>  93     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> reportableFlag = 4;
<a id="L94" name="L94"></a>  94 
<div class="comment">
      Mask used to isolate authentication information within a message flag.</div>
<a id="L98" name="L98"></a>  98     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> authMask = 1;
<div class="comment">
      Mask used to isolate privacy information within a message flag.</div>
<a id="L102" name="L102"></a> 102     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> privMask = 2;
<div class="comment">
      Mask used to isolate authentication and privacy information within a message flag.</div>
<a id="L106" name="L106"></a> 106     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> authPrivMask = 3;
<a id="L107" name="L107"></a> 107 
<a id="L108" name="L108"></a> 108     <strong class="reserved">private</strong> <a href="../S/6308.html#L42" title="Defined at 42 in src/com/sun/jmx/snmp/SnmpEngineId.java.">SnmpEngineId</a> engineid = <strong class="reserved">null</strong>;
<a id="L109" name="L109"></a> 109     <strong class="reserved">private</strong> <a href="../S/6378.html#L39" title="Defined at 39 in src/com/sun/jmx/snmp/SnmpEngineFactory.java.">SnmpEngineFactory</a> <a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a> = <strong class="reserved">null</strong>;
<a id="L110" name="L110"></a> 110     <strong class="reserved">private</strong> <strong class="reserved">long</strong> startTime = 0;
<a id="L111" name="L111"></a> 111 
<a id="L112" name="L112"></a> 112     <strong class="reserved">private</strong> <strong class="reserved">int</strong> boot = 0;
<a id="L113" name="L113"></a> 113     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> checkOid = <strong class="reserved">false</strong>;
<a id="L114" name="L114"></a> 114 
<a id="L115" name="L115"></a> 115     <strong class="reserved">transient</strong> <strong class="reserved">private</strong> <a href="../S/6441.html#L34" title="Defined at 34 in src/com/sun/jmx/snmp/SnmpUsmKeyHandler.java.">SnmpUsmKeyHandler</a> usmKeyHandler = <strong class="reserved">null</strong>;
<a id="L116" name="L116"></a> 116     <strong class="reserved">transient</strong> <strong class="reserved">private</strong> <a href="../S/6397.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">SnmpLcd</a> lcd = <strong class="reserved">null</strong>;
<a id="L117" name="L117"></a> 117 
<a id="L118" name="L118"></a> 118     <strong class="reserved">transient</strong> <strong class="reserved">private</strong> <a href="../S/6395.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpSecuritySubSystem.java.">SnmpSecuritySubSystem</a> securitySub = <strong class="reserved">null</strong>;
<a id="L119" name="L119"></a> 119 
<a id="L120" name="L120"></a> 120     <strong class="reserved">transient</strong> <strong class="reserved">private</strong> <a href="../S/6396.html#L45" title="Defined at 45 in src/com/sun/jmx/snmp/internal/SnmpMsgProcessingSubSystem.java.">SnmpMsgProcessingSubSystem</a> messageSub = <strong class="reserved">null</strong>;
<a id="L121" name="L121"></a> 121 
<a id="L122" name="L122"></a> 122     <strong class="reserved">transient</strong> <strong class="reserved">private</strong> <a href="../S/6386.html#L37" title="Defined at 37 in src/com/sun/jmx/snmp/internal/SnmpAccessControlSubSystem.java.">SnmpAccessControlSubSystem</a> accessSub = <strong class="reserved">null</strong>;
<a id="L123" name="L123"></a> 123 
<div class="comment">
      Gets the engine time in seconds. This is the time from the last reboot.
      @return The time from the last reboot.</div>
<a id="L128" name="L128"></a> 128     <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">int</strong> <a href="../R/16381.html" title="Multiple referred from 3 places.">getEngineTime</a>() <em class="brace">{</em>
<a id="L129" name="L129"></a> 129         <em class="comment">//We do the counter wrap in a lazt way. Each time Engine is asked for his time it checks. So if nobody use the Engine, the time can wrap and wrap again without incrementing nb boot. We can imagine that it is irrelevant due to the amount of time needed to wrap.</em>
<a id="L130" name="L130"></a> 130         <strong class="reserved">long</strong> delta = (<a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() / 1000) - startTime;
<a id="L131" name="L131"></a> 131         <strong class="reserved">if</strong>(delta &gt;  0x7FFFFFFF) <em class="brace">{</em>
<a id="L132" name="L132"></a> 132             <em class="comment">//67 years of running. That is a great thing!</em>
<a id="L133" name="L133"></a> 133             <em class="comment">//Reinitialize startTime.</em>
<a id="L134" name="L134"></a> 134             startTime = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() / 1000;
<a id="L135" name="L135"></a> 135 
<a id="L136" name="L136"></a> 136             <em class="comment">//Can't do anything with this counter.</em>
<a id="L137" name="L137"></a> 137             <strong class="reserved">if</strong>(boot != 0x7FFFFFFF)
<a id="L138" name="L138"></a> 138                 boot += 1;
<a id="L139" name="L139"></a> 139             <em class="comment">//Store for future use.</em>
<a id="L140" name="L140"></a> 140             <a href="../S/6385.html#L328" title="Defined at 328 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">storeNBBoots</a>(boot);
<a id="L141" name="L141"></a> 141         <em class="brace">}</em>
<a id="L142" name="L142"></a> 142 
<a id="L143" name="L143"></a> 143         <strong class="reserved">return</strong> (<strong class="reserved">int</strong>) ((<a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() / 1000) - startTime);
<a id="L144" name="L144"></a> 144     <em class="brace">}</em>
<a id="L145" name="L145"></a> 145 
<div class="comment">
      Gets the engine Id. This is unique for each engine.
      @return The engine Id object.</div>
<a id="L150" name="L150"></a> 150     <strong class="reserved">public</strong> <a href="../S/6308.html#L42" title="Defined at 42 in src/com/sun/jmx/snmp/SnmpEngineId.java.">SnmpEngineId</a> <a href="../S/6385.html#L358" title="Referred from 358 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">getEngineId</a>() <em class="brace">{</em>
<a id="L151" name="L151"></a> 151         <strong class="reserved">return</strong> engineid;
<a id="L152" name="L152"></a> 152     <em class="brace">}</em>
<a id="L153" name="L153"></a> 153 
<div class="comment">
      Gets the Usm key handler.
      @return The key handler.</div>
<a id="L158" name="L158"></a> 158     <strong class="reserved">public</strong> <a href="../S/6441.html#L34" title="Defined at 34 in src/com/sun/jmx/snmp/SnmpUsmKeyHandler.java.">SnmpUsmKeyHandler</a> getUsmKeyHandler() <em class="brace">{</em>
<a id="L159" name="L159"></a> 159         <strong class="reserved">return</strong> usmKeyHandler;
<a id="L160" name="L160"></a> 160     <em class="brace">}</em>
<a id="L161" name="L161"></a> 161 
<div class="comment">
      Gets the engine Lcd.
      @return The engine Lcd.</div>
<a id="L166" name="L166"></a> 166     <strong class="reserved">public</strong> <a href="../S/6397.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">SnmpLcd</a> getLcd() <em class="brace">{</em>
<a id="L167" name="L167"></a> 167         <strong class="reserved">return</strong> lcd;
<a id="L168" name="L168"></a> 168     <em class="brace">}</em>
<div class="comment">
      Gets the engine boot number. This is the number of time this engine has rebooted. Each time an <code>SnmpEngine</code> is instantiated, it will read this value in its Lcd, and store back the value incremented by one.
      @return The engine's number of reboot.</div>
<a id="L173" name="L173"></a> 173     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/6385.html#L341" title="Referred from 341 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">getEngineBoots</a>() <em class="brace">{</em>
<a id="L174" name="L174"></a> 174         <strong class="reserved">return</strong> boot;
<a id="L175" name="L175"></a> 175     <em class="brace">}</em>
<a id="L176" name="L176"></a> 176 
<div class="comment">
      Constructor. A Local Configuration Datastore is passed to the engine. It will be used to store and retrieve data (engine Id, engine boots).
      <p> WARNING : The SnmpEngineId is computed as follow:
      </p><ul><li> If an lcd file is provided containing the property "localEngineID", this property value is used.</li><li> If not, if the passed engineID is not null, this engine ID is used.</li><li> If not, a time based engineID is computed.</li>
      </ul>
      This constructor should be called by an <code>SnmpEngineFactory</code>. Don't call it directly.
      @param fact The factory used to instantiate this engine.
      @param lcd The local configuration datastore.
      @param engineid The engine ID to use. If null is provided, an SnmpEngineId is computed using the current time.
      @throws UnknownHostException Exception thrown, if the host name located in the property "localEngineID" is invalid.</div>
<a id="L191" name="L191"></a> 191     <strong class="reserved">public</strong> SnmpEngineImpl(<a href="../S/6378.html#L39" title="Defined at 39 in src/com/sun/jmx/snmp/SnmpEngineFactory.java.">SnmpEngineFactory</a> fact,
<a id="L192" name="L192"></a> 192                           <a href="../S/6397.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">SnmpLcd</a> lcd,
<a id="L193" name="L193"></a> 193                           <a href="../S/6308.html#L42" title="Defined at 42 in src/com/sun/jmx/snmp/SnmpEngineId.java.">SnmpEngineId</a> engineid) <strong class="reserved">throws</strong> <a href="../D/9351.html" title="Multiple defined in 2 places.">UnknownHostException</a> <em class="brace">{</em>
<a id="L194" name="L194"></a> 194 
<a id="L195" name="L195"></a> 195         <a href="../D/24497.html" title="Multiple defined in 127 places.">init</a>(lcd, fact);
<a id="L196" name="L196"></a> 196         <a href="../S/6385.html#L357" title="Defined at 357 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">initEngineID</a>();
<a id="L197" name="L197"></a> 197         <strong class="reserved">if</strong>(<strong class="reserved">this</strong>.engineid == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L198" name="L198"></a> 198             <strong class="reserved">if</strong>(engineid != <strong class="reserved">null</strong>)
<a id="L199" name="L199"></a> 199                 <strong class="reserved">this</strong>.engineid = engineid;
<a id="L200" name="L200"></a> 200             <strong class="reserved">else</strong>
<a id="L201" name="L201"></a> 201                 <strong class="reserved">this</strong>.engineid = <a href="../S/6308.html#L42" title="Defined at 42 in src/com/sun/jmx/snmp/SnmpEngineId.java.">SnmpEngineId</a>.<a href="../D/13857.html" title="Multiple defined in 10 places.">createEngineId</a>();
<a id="L202" name="L202"></a> 202         <em class="brace">}</em>
<a id="L203" name="L203"></a> 203         lcd.<a href="../S/6397.html#L83" title="Defined at 83 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">storeEngineId</a>(<strong class="reserved">this</strong>.engineid);
<a id="L204" name="L204"></a> 204         <strong class="reserved">if</strong> (SNMP_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L205" name="L205"></a> 205             SNMP_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6385.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">SnmpEngineImpl</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L206" name="L206"></a> 206                     "SnmpEngineImpl(SnmpEngineFactory,SnmpLcd,SnmpEngineId)",
<a id="L207" name="L207"></a> 207                     "LOCAL ENGINE ID: " + <strong class="reserved">this</strong>.engineid);
<a id="L208" name="L208"></a> 208         <em class="brace">}</em>
<a id="L209" name="L209"></a> 209     <em class="brace">}</em>
<div class="comment">
      Constructor. A Local Configuration Datastore is passed to the engine. It will be used to store and retrieve data (engine ID, engine boots).
      <p> WARNING : The SnmpEngineId is computed as follow:
      </p><ul><li> If an lcd file is provided containing the property "localEngineID", this property value is used.</li><li> If not, the passed address and port are used to compute one.</li>
      </ul>
      This constructor should be called by an <code>SnmpEngineFactory</code>. Don't call it directly.
      @param fact The factory used to instantiate this engine.
      @param lcd The local configuration datastore.
      @param port UDP port to use in order to calculate the engine ID.
      @param address An IP address used to calculate the engine ID.
      @throws UnknownHostException Exception thrown, if the host name located in the property "localEngineID" is invalid.</div>
<a id="L224" name="L224"></a> 224     <strong class="reserved">public</strong> SnmpEngineImpl(<a href="../S/6378.html#L39" title="Defined at 39 in src/com/sun/jmx/snmp/SnmpEngineFactory.java.">SnmpEngineFactory</a> fact,
<a id="L225" name="L225"></a> 225                           <a href="../S/6397.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">SnmpLcd</a> lcd,
<a id="L226" name="L226"></a> 226                           <a href="../S/826.html#L189" title="Defined at 189 in src/java/net/InetAddress.java.">InetAddress</a> <a href="../D/11204.html" title="Multiple defined in 16 places.">address</a>,
<a id="L227" name="L227"></a> 227                           <strong class="reserved">int</strong> port) <strong class="reserved">throws</strong> <a href="../D/9351.html" title="Multiple defined in 2 places.">UnknownHostException</a> <em class="brace">{</em>
<a id="L228" name="L228"></a> 228         <a href="../D/24497.html" title="Multiple defined in 127 places.">init</a>(lcd, fact);
<a id="L229" name="L229"></a> 229         <a href="../S/6385.html#L357" title="Defined at 357 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">initEngineID</a>();
<a id="L230" name="L230"></a> 230         <strong class="reserved">if</strong>(engineid == <strong class="reserved">null</strong>)
<a id="L231" name="L231"></a> 231             engineid = <a href="../S/6308.html#L42" title="Defined at 42 in src/com/sun/jmx/snmp/SnmpEngineId.java.">SnmpEngineId</a>.<a href="../D/13857.html" title="Multiple defined in 10 places.">createEngineId</a>(<a href="../D/11204.html" title="Multiple defined in 16 places.">address</a>, port);
<a id="L232" name="L232"></a> 232 
<a id="L233" name="L233"></a> 233         lcd.<a href="../S/6397.html#L83" title="Defined at 83 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">storeEngineId</a>(engineid);
<a id="L234" name="L234"></a> 234 
<a id="L235" name="L235"></a> 235         <strong class="reserved">if</strong> (SNMP_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L236" name="L236"></a> 236             SNMP_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6385.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">SnmpEngineImpl</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L237" name="L237"></a> 237                     "SnmpEngineImpl(SnmpEngineFactory,SnmpLcd,InetAddress,int)",
<a id="L238" name="L238"></a> 238                     "LOCAL ENGINE ID: " + engineid + " / " +
<a id="L239" name="L239"></a> 239                     "LOCAL ENGINE NB BOOTS: " + boot + " / " +
<a id="L240" name="L240"></a> 240                     "LOCAL ENGINE START TIME: " + <a href="../D/18790.html" title="Multiple defined in 2 places.">getEngineTime</a>());
<a id="L241" name="L241"></a> 241         <em class="brace">}</em>
<a id="L242" name="L242"></a> 242     <em class="brace">}</em>
<a id="L243" name="L243"></a> 243 
<div class="comment">
      Constructor. A Local Configuration Datastore is passed to the engine. It will be used to store and retrieve data (engine ID, engine boots).
      <p> WARNING : The SnmpEngineId is computed as follow:
      </p><ul><li> If an lcd file is provided containing the property "localEngineID", this property value is used.</li><li> If not, The passed port is used to compute one.</li>
      </ul>
      This constructor should be called by an <code>SnmpEngineFactory</code>. Don't call it directly.
      @param fact The factory used to instantiate this engine.
      @param lcd The local configuration datastore
      @param port UDP port to use in order to calculate the engine ID.
      @throws UnknownHostException Exception thrown, if the host name located in the property "localEngineID" is invalid.</div>
<a id="L257" name="L257"></a> 257     <strong class="reserved">public</strong> SnmpEngineImpl(<a href="../S/6378.html#L39" title="Defined at 39 in src/com/sun/jmx/snmp/SnmpEngineFactory.java.">SnmpEngineFactory</a> fact,
<a id="L258" name="L258"></a> 258                           <a href="../S/6397.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">SnmpLcd</a> lcd,
<a id="L259" name="L259"></a> 259                           <strong class="reserved">int</strong> port) <strong class="reserved">throws</strong> <a href="../D/9351.html" title="Multiple defined in 2 places.">UnknownHostException</a> <em class="brace">{</em>
<a id="L260" name="L260"></a> 260         <a href="../D/24497.html" title="Multiple defined in 127 places.">init</a>(lcd, fact);
<a id="L261" name="L261"></a> 261         <a href="../S/6385.html#L357" title="Defined at 357 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">initEngineID</a>();
<a id="L262" name="L262"></a> 262         <strong class="reserved">if</strong>(engineid == <strong class="reserved">null</strong>)
<a id="L263" name="L263"></a> 263            engineid = <a href="../S/6308.html#L42" title="Defined at 42 in src/com/sun/jmx/snmp/SnmpEngineId.java.">SnmpEngineId</a>.<a href="../D/13857.html" title="Multiple defined in 10 places.">createEngineId</a>(port);
<a id="L264" name="L264"></a> 264 
<a id="L265" name="L265"></a> 265         lcd.<a href="../S/6397.html#L83" title="Defined at 83 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">storeEngineId</a>(engineid);
<a id="L266" name="L266"></a> 266 
<a id="L267" name="L267"></a> 267         <strong class="reserved">if</strong> (SNMP_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L268" name="L268"></a> 268             SNMP_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6385.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">SnmpEngineImpl</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L269" name="L269"></a> 269                     "SnmpEngineImpl(SnmpEngineFactory,SnmpLcd,int)",
<a id="L270" name="L270"></a> 270                     "LOCAL ENGINE ID: " + engineid + " / " +
<a id="L271" name="L271"></a> 271                     "LOCAL ENGINE NB BOOTS: " + boot + " / " +
<a id="L272" name="L272"></a> 272                     "LOCAL ENGINE START TIME: " + <a href="../D/18790.html" title="Multiple defined in 2 places.">getEngineTime</a>());
<a id="L273" name="L273"></a> 273         <em class="brace">}</em>
<a id="L274" name="L274"></a> 274     <em class="brace">}</em>
<a id="L275" name="L275"></a> 275 
<div class="comment">
      Constructor. A Local Configuration Datastore is passed to the engine. It will be used to store and retrieve data (engine ID, engine boots).
      <p> WARNING : The SnmpEngineId is computed as follow:
      </p><ul><li> If an lcd file is provided containing the property "localEngineID", this property value is used.</li><li> If not, a time based engineID is computed.</li>
      </ul>
      When no configuration nor java property is set for the engine ID value, a unique time based engine ID will be generated.
      This constructor should be called by an <code>SnmpEngineFactory</code>. Don't call it directly.
      @param fact The factory used to instantiate this engine.
      @param lcd The local configuration datastore.</div>
<a id="L288" name="L288"></a> 288     <strong class="reserved">public</strong> SnmpEngineImpl(<a href="../S/6378.html#L39" title="Defined at 39 in src/com/sun/jmx/snmp/SnmpEngineFactory.java.">SnmpEngineFactory</a> fact,
<a id="L289" name="L289"></a> 289                           <a href="../S/6397.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">SnmpLcd</a> lcd) <strong class="reserved">throws</strong> <a href="../D/9351.html" title="Multiple defined in 2 places.">UnknownHostException</a> <em class="brace">{</em>
<a id="L290" name="L290"></a> 290         <a href="../D/24497.html" title="Multiple defined in 127 places.">init</a>(lcd, fact);
<a id="L291" name="L291"></a> 291         <a href="../S/6385.html#L357" title="Defined at 357 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">initEngineID</a>();
<a id="L292" name="L292"></a> 292         <strong class="reserved">if</strong>(engineid == <strong class="reserved">null</strong>)
<a id="L293" name="L293"></a> 293             engineid = <a href="../S/6308.html#L42" title="Defined at 42 in src/com/sun/jmx/snmp/SnmpEngineId.java.">SnmpEngineId</a>.<a href="../D/13857.html" title="Multiple defined in 10 places.">createEngineId</a>();
<a id="L294" name="L294"></a> 294 
<a id="L295" name="L295"></a> 295         lcd.<a href="../S/6397.html#L83" title="Defined at 83 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">storeEngineId</a>(engineid);
<a id="L296" name="L296"></a> 296 
<a id="L297" name="L297"></a> 297         <strong class="reserved">if</strong> (SNMP_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L298" name="L298"></a> 298             SNMP_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6385.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">SnmpEngineImpl</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L299" name="L299"></a> 299                     "SnmpEngineImpl(SnmpEngineFactory,SnmpLcd)",
<a id="L300" name="L300"></a> 300                     "LOCAL ENGINE ID: " + engineid + " / " +
<a id="L301" name="L301"></a> 301                     "LOCAL ENGINE NB BOOTS: " + boot + " / " +
<a id="L302" name="L302"></a> 302                     "LOCAL ENGINE START TIME: " + <a href="../D/18790.html" title="Multiple defined in 2 places.">getEngineTime</a>());
<a id="L303" name="L303"></a> 303         <em class="brace">}</em>
<a id="L304" name="L304"></a> 304     <em class="brace">}</em>
<a id="L305" name="L305"></a> 305 
<div class="comment">
      Access Control will check the oids. By default is false.</div>
<a id="L309" name="L309"></a> 309     <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> activateCheckOid() <em class="brace">{</em>
<a id="L310" name="L310"></a> 310         checkOid = <strong class="reserved">true</strong>;
<a id="L311" name="L311"></a> 311     <em class="brace">}</em>
<a id="L312" name="L312"></a> 312 
<div class="comment">
      Access Control will not check the oids. By default is false.</div>
<a id="L316" name="L316"></a> 316     <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> deactivateCheckOid() <em class="brace">{</em>
<a id="L317" name="L317"></a> 317         checkOid = <strong class="reserved">false</strong>;
<a id="L318" name="L318"></a> 318     <em class="brace">}</em>
<a id="L319" name="L319"></a> 319 
<div class="comment">
      Access Control check or not the oids. By default is false.</div>
<a id="L323" name="L323"></a> 323     <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">boolean</strong> <a href="../S/6404.html#L69" title="Referred from 69 in src/com/sun/jmx/snmp/agent/AcmChecker.java.">isCheckOidActivated</a>() <em class="brace">{</em>
<a id="L324" name="L324"></a> 324         <strong class="reserved">return</strong> checkOid;
<a id="L325" name="L325"></a> 325     <em class="brace">}</em>
<a id="L326" name="L326"></a> 326 
<a id="L327" name="L327"></a> 327     <em class="comment">//Do some check and store the nb boots value.</em>
<a id="L328" name="L328"></a> 328     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/28930.html" title="Multiple referred from 2 places.">storeNBBoots</a>(<strong class="reserved">int</strong> boot) <em class="brace">{</em>
<a id="L329" name="L329"></a> 329         <strong class="reserved">if</strong>(boot &lt; 0 || boot == 0x7FFFFFFF) <em class="brace">{</em>
<a id="L330" name="L330"></a> 330             boot = 0x7FFFFFFF;
<a id="L331" name="L331"></a> 331             lcd.<a href="../S/6397.html#L77" title="Defined at 77 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">storeEngineBoots</a>(boot);
<a id="L332" name="L332"></a> 332         <em class="brace">}</em>
<a id="L333" name="L333"></a> 333         <strong class="reserved">else</strong>
<a id="L334" name="L334"></a> 334             lcd.<a href="../S/6397.html#L77" title="Defined at 77 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">storeEngineBoots</a>(boot + 1);
<a id="L335" name="L335"></a> 335     <em class="brace">}</em>
<a id="L336" name="L336"></a> 336 
<a id="L337" name="L337"></a> 337     <em class="comment">// Initialize internal status.</em>
<a id="L338" name="L338"></a> 338     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/20537.html" title="Multiple referred from 888 places.">init</a>(<a href="../S/6397.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpLcd.java.">SnmpLcd</a> lcd, <a href="../S/6378.html#L39" title="Defined at 39 in src/com/sun/jmx/snmp/SnmpEngineFactory.java.">SnmpEngineFactory</a> fact) <em class="brace">{</em>
<a id="L339" name="L339"></a> 339         <strong class="reserved">this</strong>.<a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a> = fact;
<a id="L340" name="L340"></a> 340         <strong class="reserved">this</strong>.lcd = lcd;
<a id="L341" name="L341"></a> 341         boot = lcd.<a href="../D/18783.html" title="Multiple defined in 3 places.">getEngineBoots</a>();
<a id="L342" name="L342"></a> 342 
<a id="L343" name="L343"></a> 343         <strong class="reserved">if</strong>(boot == -1 || boot == 0)
<a id="L344" name="L344"></a> 344             boot = 1;
<a id="L345" name="L345"></a> 345 
<a id="L346" name="L346"></a> 346         <a href="../S/6385.html#L328" title="Defined at 328 in src/com/sun/jmx/snmp/internal/SnmpEngineImpl.java.">storeNBBoots</a>(boot);
<a id="L347" name="L347"></a> 347 
<a id="L348" name="L348"></a> 348         startTime = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() / 1000;
<a id="L349" name="L349"></a> 349 
<a id="L350" name="L350"></a> 350     <em class="brace">}</em>
<a id="L351" name="L351"></a> 351 
<a id="L352" name="L352"></a> 352     <strong class="reserved">void</strong> setUsmKeyHandler(<a href="../S/6441.html#L34" title="Defined at 34 in src/com/sun/jmx/snmp/SnmpUsmKeyHandler.java.">SnmpUsmKeyHandler</a> usmKeyHandler) <em class="brace">{</em>
<a id="L353" name="L353"></a> 353         <strong class="reserved">this</strong>.usmKeyHandler = usmKeyHandler;
<a id="L354" name="L354"></a> 354     <em class="brace">}</em>
<a id="L355" name="L355"></a> 355 
<a id="L356" name="L356"></a> 356     <em class="comment">//Initialize the engineID.</em>
<a id="L357" name="L357"></a> 357     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/20569.html" title="Multiple referred from 4 places.">initEngineID</a>() <strong class="reserved">throws</strong> <a href="../D/9351.html" title="Multiple defined in 2 places.">UnknownHostException</a> <em class="brace">{</em>
<a id="L358" name="L358"></a> 358         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a> = lcd.<a href="../D/18788.html" title="Multiple defined in 4 places.">getEngineId</a>();
<a id="L359" name="L359"></a> 359         <strong class="reserved">if</strong>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L360" name="L360"></a> 360             engineid = <a href="../S/6308.html#L42" title="Defined at 42 in src/com/sun/jmx/snmp/SnmpEngineId.java.">SnmpEngineId</a>.<a href="../D/13857.html" title="Multiple defined in 10 places.">createEngineId</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>);
<a id="L361" name="L361"></a> 361         <em class="brace">}</em>
<a id="L362" name="L362"></a> 362     <em class="brace">}</em>
<a id="L363" name="L363"></a> 363 
<a id="L364" name="L364"></a> 364 
<div class="comment">
      Returns the Message Processing Sub System.
      @return The Message Processing Sub System.</div>
<a id="L369" name="L369"></a> 369     <strong class="reserved">public</strong> <a href="../S/6396.html#L45" title="Defined at 45 in src/com/sun/jmx/snmp/internal/SnmpMsgProcessingSubSystem.java.">SnmpMsgProcessingSubSystem</a> getMsgProcessingSubSystem() <em class="brace">{</em>
<a id="L370" name="L370"></a> 370         <strong class="reserved">return</strong> messageSub;
<a id="L371" name="L371"></a> 371     <em class="brace">}</em>
<a id="L372" name="L372"></a> 372 
<div class="comment">
      Sets the Message Processing Sub System.
      @param sys The Message Processing Sub System.</div>
<a id="L377" name="L377"></a> 377     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setMsgProcessingSubSystem(<a href="../S/6396.html#L45" title="Defined at 45 in src/com/sun/jmx/snmp/internal/SnmpMsgProcessingSubSystem.java.">SnmpMsgProcessingSubSystem</a> sys) <em class="brace">{</em>
<a id="L378" name="L378"></a> 378         messageSub = sys;
<a id="L379" name="L379"></a> 379     <em class="brace">}</em>
<a id="L380" name="L380"></a> 380 
<div class="comment">
      Returns the Security Sub System.
      @return The Security Sub System.</div>
<a id="L385" name="L385"></a> 385     <strong class="reserved">public</strong> <a href="../S/6395.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpSecuritySubSystem.java.">SnmpSecuritySubSystem</a> getSecuritySubSystem() <em class="brace">{</em>
<a id="L386" name="L386"></a> 386         <strong class="reserved">return</strong> securitySub;
<a id="L387" name="L387"></a> 387     <em class="brace">}</em>
<div class="comment">
      Sets the Security Sub System.
      @param sys The Security Sub System.</div>
<a id="L392" name="L392"></a> 392     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSecuritySubSystem(<a href="../S/6395.html#L38" title="Defined at 38 in src/com/sun/jmx/snmp/internal/SnmpSecuritySubSystem.java.">SnmpSecuritySubSystem</a> sys) <em class="brace">{</em>
<a id="L393" name="L393"></a> 393         securitySub = sys;
<a id="L394" name="L394"></a> 394     <em class="brace">}</em>
<div class="comment">
      Sets the Access Control Sub System.
      @param sys The Access Control Sub System.</div>
<a id="L399" name="L399"></a> 399     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setAccessControlSubSystem(<a href="../S/6386.html#L37" title="Defined at 37 in src/com/sun/jmx/snmp/internal/SnmpAccessControlSubSystem.java.">SnmpAccessControlSubSystem</a> sys) <em class="brace">{</em>
<a id="L400" name="L400"></a> 400         accessSub = sys;
<a id="L401" name="L401"></a> 401     <em class="brace">}</em>
<a id="L402" name="L402"></a> 402 
<div class="comment">
      Returns the Access Control Sub System.
      @return The Access Control Sub System.</div>
<a id="L407" name="L407"></a> 407     <strong class="reserved">public</strong> <a href="../S/6386.html#L37" title="Defined at 37 in src/com/sun/jmx/snmp/internal/SnmpAccessControlSubSystem.java.">SnmpAccessControlSubSystem</a> <a href="../S/6404.html#L78" title="Referred from 78 in src/com/sun/jmx/snmp/agent/AcmChecker.java.">getAccessControlSubSystem</a>() <em class="brace">{</em>
<a id="L408" name="L408"></a> 408         <strong class="reserved">return</strong> accessSub;
<a id="L409" name="L409"></a> 409     <em class="brace">}</em>
<div class="comment">
      Checks the passed msg flags according to the rules specified in RFC 2572.
      @param msgFlags The msg flags.</div>
<a id="L414" name="L414"></a> 414     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> checkSecurityLevel(<strong class="reserved">byte</strong> msgFlags)
<a id="L415" name="L415"></a> 415         <strong class="reserved">throws</strong> <a href="../S/6301.html#L32" title="Defined at 32 in src/com/sun/jmx/snmp/SnmpBadSecurityLevelException.java.">SnmpBadSecurityLevelException</a> <em class="brace">{</em>
<a id="L416" name="L416"></a> 416         <strong class="reserved">int</strong> secLevel = msgFlags &amp; <a href="../S/6476.html#L19" title="Defined at 19 in src/com/sun/jmx/snmp/SnmpDefinitions.java.">SnmpDefinitions</a>.authPriv;
<a id="L417" name="L417"></a> 417         <strong class="reserved">if</strong>((secLevel &amp; <a href="../S/6476.html#L19" title="Defined at 19 in src/com/sun/jmx/snmp/SnmpDefinitions.java.">SnmpDefinitions</a>.privMask) != 0)
<a id="L418" name="L418"></a> 418             <strong class="reserved">if</strong>((secLevel &amp; <a href="../S/6476.html#L19" title="Defined at 19 in src/com/sun/jmx/snmp/SnmpDefinitions.java.">SnmpDefinitions</a>.authMask) == 0) <em class="brace">{</em>
<a id="L419" name="L419"></a> 419                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/6301.html#L32" title="Defined at 32 in src/com/sun/jmx/snmp/SnmpBadSecurityLevelException.java.">SnmpBadSecurityLevelException</a>("Security level:"+
<a id="L420" name="L420"></a> 420                                                         " noAuthPriv!!!");
<a id="L421" name="L421"></a> 421             <em class="brace">}</em>
<a id="L422" name="L422"></a> 422     <em class="brace">}</em>
<a id="L423" name="L423"></a> 423 
<a id="L424" name="L424"></a> 424 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L128">[^]</a><a href="#L414">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>