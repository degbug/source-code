<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xpath/internal/SourceTreeManager.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L56">[^]</a><a href="#L343">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L56" title="Defined at 56.">reset</a></li>
<li><a href="#L70" title="Defined at 70.">setURIResolver</a></li>
<li><a href="#L81" title="Defined at 81.">getURIResolver</a></li>
<li><a href="#L92" title="Defined at 92.">findURIFromDoc</a></li>
<li><a href="#L120" title="Defined at 120.">resolveURI</a></li>
<li><a href="#L147" title="Defined at 147.">removeDocumentFromCache</a></li>
<li><a href="#L171" title="Defined at 171.">putDocumentInCache</a></li>
<li><a href="#L198" title="Defined at 198.">getNode</a></li>
<li><a href="#L239" title="Defined at 239.">getSourceTree</a></li>
<li><a href="#L274" title="Defined at 274.">getSourceTree</a></li>
<li><a href="#L302" title="Defined at 302.">parseToNode</a></li>
<li><a href="#L343" title="Defined at 343.">getXMLReader</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: SourceTreeManager.java,v 1.2.4.1 2005/09/10 18:14:09 jeffsuttor Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xpath.internal;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> java.io.IOException;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> java.util.Vector;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> javax.xml.transform.Source;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> javax.xml.transform.SourceLocator;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> javax.xml.transform.TransformerException;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> javax.xml.transform.URIResolver;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> javax.xml.transform.sax.SAXSource;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> javax.xml.transform.stream.StreamSource;
<a id="L34" name="L34"></a>  34 
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTM;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.SystemIDResolver;
<a id="L37" name="L37"></a>  37 
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> org.xml.sax.XMLReader;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> org.xml.sax.helpers.XMLReaderFactory;
<a id="L40" name="L40"></a>  40 
<div class="comment">
  This class bottlenecks all management of source trees.  The methods
  in this class should allow easy garbage collection of source
  trees (not yet!), and should centralize parsing for those source trees.</div>
<a id="L46" name="L46"></a>  46 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/7500.html" title="Multiple referred from 3 places.">SourceTreeManager</a>
<a id="L47" name="L47"></a>  47 <em class="brace">{</em>
<a id="L48" name="L48"></a>  48 
<div class="comment">
   /** Vector of SourceTree objects that this manager manages. */</div>
<a id="L50" name="L50"></a>  50   <strong class="reserved">private</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> m_sourceTree = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>();
<a id="L51" name="L51"></a>  51 
<div class="comment">
    Reset the list of SourceTree objects that this manager manages.</div>
<a id="L56" name="L56"></a>  56   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26238.html" title="Multiple referred from 619 places.">reset</a>()
<a id="L57" name="L57"></a>  57   <em class="brace">{</em>
<a id="L58" name="L58"></a>  58     m_sourceTree = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>();
<a id="L59" name="L59"></a>  59   <em class="brace">}</em>
<a id="L60" name="L60"></a>  60 
<div class="comment">
   /** The TrAX URI resolver used to obtain source trees. */</div>
<a id="L62" name="L62"></a>  62   <a href="../S/4040.html#L32" title="Defined at 32 in src/javax/xml/transform/URIResolver.java.">URIResolver</a> m_uriResolver;
<a id="L63" name="L63"></a>  63 
<div class="comment">
    Set an object that will be used to resolve URIs used in
    document(), etc.
    @param resolver An object that implements the URIResolver interface,
    or null.</div>
<a id="L70" name="L70"></a>  70   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28340.html" title="Multiple referred from 18 places.">setURIResolver</a>(<a href="../S/4040.html#L32" title="Defined at 32 in src/javax/xml/transform/URIResolver.java.">URIResolver</a> resolver)
<a id="L71" name="L71"></a>  71   <em class="brace">{</em>
<a id="L72" name="L72"></a>  72     m_uriResolver = resolver;
<a id="L73" name="L73"></a>  73   <em class="brace">}</em>
<a id="L74" name="L74"></a>  74 
<div class="comment">
    Get the object that will be used to resolve URIs used in
    document(), etc.
    @return An object that implements the URIResolver interface,
    or null.</div>
<a id="L81" name="L81"></a>  81   <strong class="reserved">public</strong> <a href="../S/4040.html#L32" title="Defined at 32 in src/javax/xml/transform/URIResolver.java.">URIResolver</a> getURIResolver()
<a id="L82" name="L82"></a>  82   <em class="brace">{</em>
<a id="L83" name="L83"></a>  83     <strong class="reserved">return</strong> m_uriResolver;
<a id="L84" name="L84"></a>  84   <em class="brace">}</em>
<a id="L85" name="L85"></a>  85 
<div class="comment">
    Given a document, find the URL associated with that document.
    @param owner Document that was previously processed by this liaison.
    @return The base URI of the owner argument.</div>
<a id="L92" name="L92"></a>  92   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> findURIFromDoc(<strong class="reserved">int</strong> <a href="../D/28636.html" title="Multiple defined in 2 places.">owner</a>)
<a id="L93" name="L93"></a>  93   <em class="brace">{</em>
<a id="L94" name="L94"></a>  94     <strong class="reserved">int</strong> n = m_sourceTree.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L95" name="L95"></a>  95 
<a id="L96" name="L96"></a>  96     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L97" name="L97"></a>  97     <em class="brace">{</em>
<a id="L98" name="L98"></a>  98       <a href="../S/4990.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/SourceTree.java.">SourceTree</a> sTree = (<a href="../S/4990.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/SourceTree.java.">SourceTree</a>) m_sourceTree.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L99" name="L99"></a>  99 
<a id="L100" name="L100"></a> 100       <strong class="reserved">if</strong> (<a href="../D/28636.html" title="Multiple defined in 2 places.">owner</a> == sTree.m_root)
<a id="L101" name="L101"></a> 101         <strong class="reserved">return</strong> sTree.m_url;
<a id="L102" name="L102"></a> 102     <em class="brace">}</em>
<a id="L103" name="L103"></a> 103 
<a id="L104" name="L104"></a> 104     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L105" name="L105"></a> 105   <em class="brace">}</em>
<a id="L106" name="L106"></a> 106 
<div class="comment">
    This will be called by the processor when it encounters
    an xsl:include, xsl:import, or document() function.
    @param base The base URI that should be used.
    @param urlString Value from an xsl:import or xsl:include's href attribute,
    or a URI specified in the document() function.
    @return a Source that can be used to process the resource.
    @throws IOException
    @throws TransformerException</div>
<a id="L120" name="L120"></a> 120   <strong class="reserved">public</strong> <a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> <a href="../R/26392.html" title="Multiple referred from 8 places.">resolveURI</a>(
<a id="L121" name="L121"></a> 121           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> base, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> urlString, <a href="../S/4044.html#L32" title="Defined at 32 in src/javax/xml/transform/SourceLocator.java.">SourceLocator</a> locator)
<a id="L122" name="L122"></a> 122             <strong class="reserved">throws</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>, <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L123" name="L123"></a> 123   <em class="brace">{</em>
<a id="L124" name="L124"></a> 124 
<a id="L125" name="L125"></a> 125     <a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> = <strong class="reserved">null</strong>;
<a id="L126" name="L126"></a> 126 
<a id="L127" name="L127"></a> 127     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_uriResolver)
<a id="L128" name="L128"></a> 128     <em class="brace">{</em>
<a id="L129" name="L129"></a> 129       <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> = m_uriResolver.<a href="../D/31237.html" title="Multiple defined in 38 places.">resolve</a>(urlString, base);
<a id="L130" name="L130"></a> 130     <em class="brace">}</em>
<a id="L131" name="L131"></a> 131 
<a id="L132" name="L132"></a> 132     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>)
<a id="L133" name="L133"></a> 133     <em class="brace">{</em>
<a id="L134" name="L134"></a> 134       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> uri = <a href="../D/8695.html" title="Multiple defined in 2 places.">SystemIDResolver</a>.<a href="../D/16701.html" title="Multiple defined in 4 places.">getAbsoluteURI</a>(urlString, base);
<a id="L135" name="L135"></a> 135 
<a id="L136" name="L136"></a> 136       <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> = <strong class="reserved">new</strong> <a href="../S/4039.html#L43" title="Defined at 43 in src/javax/xml/transform/stream/StreamSource.java.">StreamSource</a>(uri);
<a id="L137" name="L137"></a> 137     <em class="brace">}</em>
<a id="L138" name="L138"></a> 138 
<a id="L139" name="L139"></a> 139     <strong class="reserved">return</strong> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>;
<a id="L140" name="L140"></a> 140   <em class="brace">}</em>
<a id="L141" name="L141"></a> 141 
<div class="comment">
 JJK: Support  <!--?xalan:doc_cache_off?--> kluge in ElemForEach.
    TODO: This function is highly dangerous. Cache management must be improved.
    @param n The node to remove.</div>
<a id="L147" name="L147"></a> 147   <strong class="reserved">public</strong> <strong class="reserved">void</strong> removeDocumentFromCache(<strong class="reserved">int</strong> n)
<a id="L148" name="L148"></a> 148   <em class="brace">{</em>
<a id="L149" name="L149"></a> 149     <strong class="reserved">if</strong>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> ==n)
<a id="L150" name="L150"></a> 150       <strong class="reserved">return</strong>;
<a id="L151" name="L151"></a> 151     <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i=m_sourceTree.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()-1;i&gt;=0;--i)
<a id="L152" name="L152"></a> 152     <em class="brace">{</em>
<a id="L153" name="L153"></a> 153       <a href="../S/4990.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/SourceTree.java.">SourceTree</a> st=(<a href="../S/4990.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/SourceTree.java.">SourceTree</a>)m_sourceTree.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L154" name="L154"></a> 154       <strong class="reserved">if</strong>(st!=<strong class="reserved">null</strong> &amp;&amp; st.m_root==n)
<a id="L155" name="L155"></a> 155       <em class="brace">{</em>
<a id="L156" name="L156"></a> 156         m_sourceTree.<a href="../D/30775.html" title="Multiple defined in 12 places.">removeElementAt</a>(i);
<a id="L157" name="L157"></a> 157         <strong class="reserved">return</strong>;
<a id="L158" name="L158"></a> 158       <em class="brace">}</em>
<a id="L159" name="L159"></a> 159     <em class="brace">}</em>
<a id="L160" name="L160"></a> 160   <em class="brace">}</em>
<a id="L161" name="L161"></a> 161 
<a id="L162" name="L162"></a> 162 
<a id="L163" name="L163"></a> 163 
<div class="comment">
    Put the source tree root node in the document cache.
    TODO: This function needs to be a LOT more sophisticated.
    @param n The node to cache.
    @param source The Source object to cache.</div>
<a id="L171" name="L171"></a> 171   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/4909.html#L286" title="Referred from 286 in src/com/sun/org/apache/xpath/internal/SourceTreeManager.java.">putDocumentInCache</a>(<strong class="reserved">int</strong> n, <a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>)
<a id="L172" name="L172"></a> 172   <em class="brace">{</em>
<a id="L173" name="L173"></a> 173 
<a id="L174" name="L174"></a> 174     <strong class="reserved">int</strong> cachedNode = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L175" name="L175"></a> 175 
<a id="L176" name="L176"></a> 176     <strong class="reserved">if</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != cachedNode)
<a id="L177" name="L177"></a> 177     <em class="brace">{</em>
<a id="L178" name="L178"></a> 178       <strong class="reserved">if</strong> (!(cachedNode == n))
<a id="L179" name="L179"></a> 179         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>(
<a id="L180" name="L180"></a> 180           "Programmer's Error!  "
<a id="L181" name="L181"></a> 181           + "putDocumentInCache found reparse of doc: "
<a id="L182" name="L182"></a> 182           + <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>.<a href="../D/22911.html" title="Multiple defined in 50 places.">getSystemId</a>());
<a id="L183" name="L183"></a> 183       <strong class="reserved">return</strong>;
<a id="L184" name="L184"></a> 184     <em class="brace">}</em>
<a id="L185" name="L185"></a> 185     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>.<a href="../D/22911.html" title="Multiple defined in 50 places.">getSystemId</a>())
<a id="L186" name="L186"></a> 186     <em class="brace">{</em>
<a id="L187" name="L187"></a> 187       m_sourceTree.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<strong class="reserved">new</strong> <a href="../S/4990.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/SourceTree.java.">SourceTree</a>(n, <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>.<a href="../D/22911.html" title="Multiple defined in 50 places.">getSystemId</a>()));
<a id="L188" name="L188"></a> 188     <em class="brace">}</em>
<a id="L189" name="L189"></a> 189   <em class="brace">}</em>
<a id="L190" name="L190"></a> 190 
<div class="comment">
    Given a Source object, find the node associated with it.
    @param source The Source object to act as the key.
    @return The node that is associated with the Source, or null if not found.</div>
<a id="L198" name="L198"></a> 198   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/17972.html" title="Multiple referred from 119 places.">getNode</a>(<a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>)
<a id="L199" name="L199"></a> 199   <em class="brace">{</em>
<a id="L200" name="L200"></a> 200 
<a id="L201" name="L201"></a> 201 <em class="comment">//    if (source instanceof DOMSource)</em>
<a id="L202" name="L202"></a> 202 <em class="comment">//      return ((DOMSource) source).getNode();</em>
<a id="L203" name="L203"></a> 203 
<a id="L204" name="L204"></a> 204     <em class="comment">// TODO: Not sure if the BaseID is really the same thing as the ID.</em>
<a id="L205" name="L205"></a> 205     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> url = <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>.<a href="../D/22911.html" title="Multiple defined in 50 places.">getSystemId</a>();
<a id="L206" name="L206"></a> 206 
<a id="L207" name="L207"></a> 207     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == url)
<a id="L208" name="L208"></a> 208       <strong class="reserved">return</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L209" name="L209"></a> 209 
<a id="L210" name="L210"></a> 210     <strong class="reserved">int</strong> n = m_sourceTree.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L211" name="L211"></a> 211 
<a id="L212" name="L212"></a> 212     <em class="comment">// System.out.println("getNode: "+n);</em>
<a id="L213" name="L213"></a> 213     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L214" name="L214"></a> 214     <em class="brace">{</em>
<a id="L215" name="L215"></a> 215       <a href="../S/4990.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/SourceTree.java.">SourceTree</a> sTree = (<a href="../S/4990.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/SourceTree.java.">SourceTree</a>) m_sourceTree.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L216" name="L216"></a> 216 
<a id="L217" name="L217"></a> 217       <em class="comment">// System.out.println("getNode -         url: "+url);</em>
<a id="L218" name="L218"></a> 218       <em class="comment">// System.out.println("getNode - sTree.m_url: "+sTree.m_url);</em>
<a id="L219" name="L219"></a> 219       <strong class="reserved">if</strong> (url.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(sTree.m_url))
<a id="L220" name="L220"></a> 220         <strong class="reserved">return</strong> sTree.m_root;
<a id="L221" name="L221"></a> 221     <em class="brace">}</em>
<a id="L222" name="L222"></a> 222 
<a id="L223" name="L223"></a> 223     <em class="comment">// System.out.println("getNode - returning: "+node);</em>
<a id="L224" name="L224"></a> 224     <strong class="reserved">return</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L225" name="L225"></a> 225   <em class="brace">}</em>
<a id="L226" name="L226"></a> 226 
<div class="comment">
    Get the source tree from the a base URL and a URL string.
    @param base The base URI to use if the urlString is relative.
    @param urlString An absolute or relative URL string.
    @param locator The location of the caller, for diagnostic purposes.
    @return should be a non-null reference to the node identified by the
    base and urlString.
    @throws TransformerException If the URL can not resolve to a node.</div>
<a id="L239" name="L239"></a> 239   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/4909.html#L250" title="Referred from 250 in src/com/sun/org/apache/xpath/internal/SourceTreeManager.java.">getSourceTree</a>(
<a id="L240" name="L240"></a> 240           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> base, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> urlString, <a href="../S/4044.html#L32" title="Defined at 32 in src/javax/xml/transform/SourceLocator.java.">SourceLocator</a> locator, <a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L241" name="L241"></a> 241             <strong class="reserved">throws</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L242" name="L242"></a> 242   <em class="brace">{</em>
<a id="L243" name="L243"></a> 243 
<a id="L244" name="L244"></a> 244     <em class="comment">// System.out.println("getSourceTree");</em>
<a id="L245" name="L245"></a> 245     <strong class="reserved">try</strong>
<a id="L246" name="L246"></a> 246     <em class="brace">{</em>
<a id="L247" name="L247"></a> 247       <a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> = <strong class="reserved">this</strong>.<a href="../D/31316.html" title="Multiple defined in 4 places.">resolveURI</a>(base, urlString, locator);
<a id="L248" name="L248"></a> 248 
<a id="L249" name="L249"></a> 249       <em class="comment">// System.out.println("getSourceTree - base: "+base+", urlString: "+urlString+", source: "+source.getSystemId());</em>
<a id="L250" name="L250"></a> 250       <strong class="reserved">return</strong> <a href="../D/22631.html" title="Multiple defined in 2 places.">getSourceTree</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, locator, xctxt);
<a id="L251" name="L251"></a> 251     <em class="brace">}</em>
<a id="L252" name="L252"></a> 252     <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> ioe)
<a id="L253" name="L253"></a> 253     <em class="brace">{</em>
<a id="L254" name="L254"></a> 254       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>(ioe.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>(), locator, ioe);
<a id="L255" name="L255"></a> 255     <em class="brace">}</em>
<a id="L256" name="L256"></a> 256 
<div class="comment">
 catch (TransformerException te)
     {
       throw new TransformerException(te.getMessage(), locator, te);
     }</div>
<a id="L261" name="L261"></a> 261   <em class="brace">}</em>
<a id="L262" name="L262"></a> 262 
<div class="comment">
    Get the source tree from the input source.
    @param source The Source object that should identify the desired node.
    @param locator The location of the caller, for diagnostic purposes.
    @return non-null reference to a node.
    @throws TransformerException if the Source argument can't be resolved to
            a node.</div>
<a id="L274" name="L274"></a> 274   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/4909.html#L250" title="Referred from 250 in src/com/sun/org/apache/xpath/internal/SourceTreeManager.java.">getSourceTree</a>(<a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <a href="../S/4044.html#L32" title="Defined at 32 in src/javax/xml/transform/SourceLocator.java.">SourceLocator</a> locator, <a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L275" name="L275"></a> 275           <strong class="reserved">throws</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L276" name="L276"></a> 276   <em class="brace">{</em>
<a id="L277" name="L277"></a> 277 
<a id="L278" name="L278"></a> 278     <strong class="reserved">int</strong> n = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L279" name="L279"></a> 279 
<a id="L280" name="L280"></a> 280     <strong class="reserved">if</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != n)
<a id="L281" name="L281"></a> 281       <strong class="reserved">return</strong> n;
<a id="L282" name="L282"></a> 282 
<a id="L283" name="L283"></a> 283     n = <a href="../S/4909.html#L302" title="Defined at 302 in src/com/sun/org/apache/xpath/internal/SourceTreeManager.java.">parseToNode</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, locator, xctxt);
<a id="L284" name="L284"></a> 284 
<a id="L285" name="L285"></a> 285     <strong class="reserved">if</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != n)
<a id="L286" name="L286"></a> 286       <a href="../S/4909.html#L171" title="Defined at 171 in src/com/sun/org/apache/xpath/internal/SourceTreeManager.java.">putDocumentInCache</a>(n, <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L287" name="L287"></a> 287 
<a id="L288" name="L288"></a> 288     <strong class="reserved">return</strong> n;
<a id="L289" name="L289"></a> 289   <em class="brace">}</em>
<a id="L290" name="L290"></a> 290 
<div class="comment">
    Try to create a DOM source tree from the input source.
    @param source The Source object that identifies the source node.
    @param locator The location of the caller, for diagnostic purposes.
    @return non-null reference to node identified by the source argument.
    @throws TransformerException if the source argument can not be resolved
            to a source node.</div>
<a id="L302" name="L302"></a> 302   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/4909.html#L283" title="Referred from 283 in src/com/sun/org/apache/xpath/internal/SourceTreeManager.java.">parseToNode</a>(<a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <a href="../S/4044.html#L32" title="Defined at 32 in src/javax/xml/transform/SourceLocator.java.">SourceLocator</a> locator, <a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L303" name="L303"></a> 303           <strong class="reserved">throws</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L304" name="L304"></a> 304   <em class="brace">{</em>
<a id="L305" name="L305"></a> 305 
<a id="L306" name="L306"></a> 306     <strong class="reserved">try</strong>
<a id="L307" name="L307"></a> 307     <em class="brace">{</em>
<a id="L308" name="L308"></a> 308       <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> xowner = xctxt.<a href="../S/4946.html#L448" title="Defined at 448 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">getOwnerObject</a>();
<a id="L309" name="L309"></a> 309       <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm;
<a id="L310" name="L310"></a> 310       <strong class="reserved">if</strong>(<strong class="reserved">null</strong> != xowner &amp;&amp; xowner <strong class="reserved">instanceof</strong> com.sun.org.apache.xml.internal.dtm.<a href="../S/5926.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMWSFilter.java.">DTMWSFilter</a>)
<a id="L311" name="L311"></a> 311       <em class="brace">{</em>
<a id="L312" name="L312"></a> 312         dtm = xctxt.<a href="../D/18175.html" title="Multiple defined in 19 places.">getDTM</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <strong class="reserved">false</strong>,
<a id="L313" name="L313"></a> 313                           (com.sun.org.apache.xml.internal.dtm.<a href="../S/5926.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMWSFilter.java.">DTMWSFilter</a>)xowner, <strong class="reserved">false</strong>, <strong class="reserved">true</strong>);
<a id="L314" name="L314"></a> 314       <em class="brace">}</em>
<a id="L315" name="L315"></a> 315       <strong class="reserved">else</strong>
<a id="L316" name="L316"></a> 316       <em class="brace">{</em>
<a id="L317" name="L317"></a> 317         dtm = xctxt.<a href="../D/18175.html" title="Multiple defined in 19 places.">getDTM</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <strong class="reserved">false</strong>, <strong class="reserved">null</strong>, <strong class="reserved">false</strong>, <strong class="reserved">true</strong>);
<a id="L318" name="L318"></a> 318       <em class="brace">}</em>
<a id="L319" name="L319"></a> 319       <strong class="reserved">return</strong> dtm.<a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>();
<a id="L320" name="L320"></a> 320     <em class="brace">}</em>
<a id="L321" name="L321"></a> 321     <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e)
<a id="L322" name="L322"></a> 322     <em class="brace">{</em>
<a id="L323" name="L323"></a> 323       <em class="comment">//e.printStackTrace();</em>
<a id="L324" name="L324"></a> 324       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>(e.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>(), locator, e);
<a id="L325" name="L325"></a> 325     <em class="brace">}</em>
<a id="L326" name="L326"></a> 326 
<a id="L327" name="L327"></a> 327   <em class="brace">}</em>
<a id="L328" name="L328"></a> 328 
<div class="comment">
    This method returns the SAX2 parser to use with the InputSource
    obtained from this URI.
    It may return null if any SAX2-conformant XML parser can be used,
    or if getInputSource() will also return null. The parser must
    be free for use (i.e.
    not currently in use for another parse().
    @param inputSource The value returned from the URIResolver.
    @return a SAX2 XMLReader to use to resolve the inputSource argument.
    @param locator The location of the original caller, for diagnostic purposes.
    @throws TransformerException if the reader can not be created.</div>
<a id="L343" name="L343"></a> 343   <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/724.html#L84" title="Defined at 84 in src/org/xml/sax/XMLReader.java.">XMLReader</a> <a href="../R/19913.html" title="Multiple referred from 37 places.">getXMLReader</a>(<a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> inputSource, <a href="../S/4044.html#L32" title="Defined at 32 in src/javax/xml/transform/SourceLocator.java.">SourceLocator</a> locator)
<a id="L344" name="L344"></a> 344           <strong class="reserved">throws</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L345" name="L345"></a> 345   <em class="brace">{</em>
<a id="L346" name="L346"></a> 346 
<a id="L347" name="L347"></a> 347     <strong class="reserved">try</strong>
<a id="L348" name="L348"></a> 348     <em class="brace">{</em>
<a id="L349" name="L349"></a> 349       <a href="../S/724.html#L84" title="Defined at 84 in src/org/xml/sax/XMLReader.java.">XMLReader</a> <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a> = (inputSource <strong class="reserved">instanceof</strong> <a href="../S/4031.html#L45" title="Defined at 45 in src/javax/xml/transform/sax/SAXSource.java.">SAXSource</a>)
<a id="L350" name="L350"></a> 350                          ? ((<a href="../S/4031.html#L45" title="Defined at 45 in src/javax/xml/transform/sax/SAXSource.java.">SAXSource</a>) inputSource).<a href="../D/23755.html" title="Multiple defined in 9 places.">getXMLReader</a>() : <strong class="reserved">null</strong>;
<a id="L351" name="L351"></a> 351 
<a id="L352" name="L352"></a> 352       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>)
<a id="L353" name="L353"></a> 353       <em class="brace">{</em>
<a id="L354" name="L354"></a> 354         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L355" name="L355"></a> 355           <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.parsers.<a href="../S/3844.html#L43" title="Defined at 43 in src/javax/xml/parsers/SAXParserFactory.java.">SAXParserFactory</a> <a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a>=
<a id="L356" name="L356"></a> 356               <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.parsers.<a href="../S/3844.html#L43" title="Defined at 43 in src/javax/xml/parsers/SAXParserFactory.java.">SAXParserFactory</a>.<a href="../D/28016.html" title="Multiple defined in 74 places.">newInstance</a>();
<a id="L357" name="L357"></a> 357           <a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a>.<a href="../D/33323.html" title="Multiple defined in 3 places.">setNamespaceAware</a>( <strong class="reserved">true</strong> );
<a id="L358" name="L358"></a> 358           <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.parsers.<a href="../D/7467.html" title="Multiple defined in 2 places.">SAXParser</a> jaxpParser=
<a id="L359" name="L359"></a> 359               <a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a>.<a href="../D/28066.html" title="Multiple defined in 2 places.">newSAXParser</a>();
<a id="L360" name="L360"></a> 360           <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>=jaxpParser.<a href="../D/23755.html" title="Multiple defined in 9 places.">getXMLReader</a>();
<a id="L361" name="L361"></a> 361 
<a id="L362" name="L362"></a> 362         <em class="brace">}</em> <strong class="reserved">catch</strong>( <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.parsers.<a href="../S/3851.html#L34" title="Defined at 34 in src/javax/xml/parsers/ParserConfigurationException.java.">ParserConfigurationException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a> ) <em class="brace">{</em>
<a id="L363" name="L363"></a> 363           <strong class="reserved">throw</strong> <strong class="reserved">new</strong> org.xml.sax.<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a>( <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a> );
<a id="L364" name="L364"></a> 364         <em class="brace">}</em> <strong class="reserved">catch</strong>( <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.parsers.<a href="../D/3123.html" title="Multiple defined in 2 places.">FactoryConfigurationError</a> ex1 ) <em class="brace">{</em>
<a id="L365" name="L365"></a> 365             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> org.xml.sax.<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a>( ex1.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() );
<a id="L366" name="L366"></a> 366         <em class="brace">}</em> <strong class="reserved">catch</strong>( <a href="../S/1678.html#L41" title="Defined at 41 in src/java/lang/NoSuchMethodError.java.">NoSuchMethodError</a> ex2 ) <em class="brace">{</em>
<a id="L367" name="L367"></a> 367         <em class="brace">}</em>
<a id="L368" name="L368"></a> 368         <strong class="reserved">catch</strong> (<a href="../S/1595.html#L39" title="Defined at 39 in src/java/lang/AbstractMethodError.java.">AbstractMethodError</a> ame)<em class="brace">{</em><em class="brace">}</em>
<a id="L369" name="L369"></a> 369         <strong class="reserved">if</strong>(<strong class="reserved">null</strong> == <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>)
<a id="L370" name="L370"></a> 370           <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a> = <a href="../S/729.html#L74" title="Defined at 74 in src/org/xml/sax/helpers/XMLReaderFactory.java.">XMLReaderFactory</a>.<a href="../D/14338.html" title="Multiple defined in 2 places.">createXMLReader</a>();
<a id="L371" name="L371"></a> 371       <em class="brace">}</em>
<a id="L372" name="L372"></a> 372 
<a id="L373" name="L373"></a> 373       <strong class="reserved">try</strong>
<a id="L374" name="L374"></a> 374       <em class="brace">{</em>
<a id="L375" name="L375"></a> 375         <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32684.html" title="Multiple defined in 62 places.">setFeature</a>("http://xml.org/sax/features/namespace-prefixes",
<a id="L376" name="L376"></a> 376                           <strong class="reserved">true</strong>);
<a id="L377" name="L377"></a> 377       <em class="brace">}</em>
<a id="L378" name="L378"></a> 378       <strong class="reserved">catch</strong> (org.xml.sax.<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a> se)
<a id="L379" name="L379"></a> 379       <em class="brace">{</em>
<a id="L380" name="L380"></a> 380 
<a id="L381" name="L381"></a> 381         <em class="comment">// What can we do?</em>
<a id="L382" name="L382"></a> 382         <em class="comment">// TODO: User diagnostics.</em>
<a id="L383" name="L383"></a> 383       <em class="brace">}</em>
<a id="L384" name="L384"></a> 384 
<a id="L385" name="L385"></a> 385       <strong class="reserved">return</strong> <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>;
<a id="L386" name="L386"></a> 386     <em class="brace">}</em>
<a id="L387" name="L387"></a> 387     <strong class="reserved">catch</strong> (org.xml.sax.<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a> se)
<a id="L388" name="L388"></a> 388     <em class="brace">{</em>
<a id="L389" name="L389"></a> 389       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>(se.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>(), locator, se);
<a id="L390" name="L390"></a> 390     <em class="brace">}</em>
<a id="L391" name="L391"></a> 391   <em class="brace">}</em>
<a id="L392" name="L392"></a> 392 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L56">[^]</a><a href="#L343">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>