<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/rmi/activation/ActivationGroup.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L186">[^]</a><a href="#L529">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L186" title="Defined at 186.">inactiveObject</a></li>
<li><a href="#L209" title="Defined at 209.">activeObject</a></li>
<li><a href="#L278" title="Defined at 278.">createGroup</a></li>
<li><a href="#L357" title="Defined at 357.">currentGroupID</a></li>
<li><a href="#L372" title="Defined at 372.">internalCurrentGroupID</a></li>
<li><a href="#L409" title="Defined at 409.">setSystem</a></li>
<li><a href="#L444" title="Defined at 444.">getSystem</a></li>
<li><a href="#L476" title="Defined at 476.">activeObject</a></li>
<li><a href="#L494" title="Defined at 494.">inactiveGroup</a></li>
<li><a href="#L507" title="Defined at 507.">getMonitor</a></li>
<li><a href="#L519" title="Defined at 519.">destroyGroup</a></li>
<li><a href="#L529" title="Defined at 529.">currentGroup</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.rmi.activation;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.lang.reflect.Constructor;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.lang.reflect.InvocationTargetException;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.rmi.MarshalledObject;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.rmi.Naming;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> java.rmi.Remote;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> java.rmi.RemoteException;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> java.rmi.activation.UnknownGroupException;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> java.rmi.activation.UnknownObjectException;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> java.rmi.server.RMIClassLoader;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> java.rmi.server.UnicastRemoteObject;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> java.security.AccessController;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> sun.security.action.GetIntegerAction;
<a id="L40" name="L40"></a>  40 
<div class="comment">
  An <code>ActivationGroup</code> is responsible for creating new
  instances of "activatable" objects in its group, informing its
  <code>ActivationMonitor</code> when either: its object's become
  active or inactive, or the group as a whole becomes inactive. <p>
  An <code>ActivationGroup</code> is <i>initially</i> created in one
  of several ways: </p><ul><li>as a side-effect of creating an <code>ActivationDesc</code>
      without an explicit <code>ActivationGroupID</code> for the
      first activatable object in the group, or
  </li><li>via the <code>ActivationGroup.createGroup</code> method
  </li><li>as a side-effect of activating the first object in a group
      whose <code>ActivationGroupDesc</code> was only registered.</li></ul><p>
  Only the activator can <i>recreate</i> an
  <code>ActivationGroup</code>.  The activator spawns, as needed, a
  separate VM (as a child process, for example) for each registered
  activation group and directs activation requests to the appropriate
  group. It is implementation specific how VMs are spawned. An
  activation group is created via the
  <code>ActivationGroup.createGroup</code> static method. The
  <code>createGroup</code> method has two requirements on the group
  to be created: 1) the group must be a concrete subclass of
  <code>ActivationGroup</code>, and 2) the group must have a
  constructor that takes two arguments:
  </p><ul><li> the group's <code>ActivationGroupID</code>, and
  </li><li> the group's initialization data (in a
       <code>java.rmi.MarshalledObject</code>)</li></ul><p>
  When created, the default implementation of
  <code>ActivationGroup</code> will override the system properties
  with the properties requested when its
  <code>ActivationGroupDesc</code> was created, and will set a
  <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> as the default system
  security manager.  If your application requires specific properties
  to be set when objects are activated in the group, the application
  should create a special <code>Properties</code> object containing
  these properties, then create an <code>ActivationGroupDesc</code>
  with the <code>Properties</code> object, and use
  <code>ActivationGroup.createGroup</code> before creating any
  <code>ActivationDesc</code>s (before the default
  <code>ActivationGroupDesc</code> is created).  If your application
  requires the use of a security manager other than
  <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a>, in the
  ActivativationGroupDescriptor properties list you can set
  <code>java.security.manager</code> property to the name of the security
  manager you would like to install.
  @author      Ann Wollrath
  @see         ActivationInstantiator
  @see         ActivationGroupDesc
  @see         ActivationGroupID
  @since       1.2</p></div>
<a id="L98" name="L98"></a>  98 <strong class="reserved">public</strong> <strong class="reserved">abstract</strong> <strong class="reserved">class</strong> <a href="../R/290.html" title="Multiple referred from 17 places.">ActivationGroup</a>
<a id="L99" name="L99"></a>  99         <strong class="reserved">extends</strong> <a href="../S/2534.html#L147" title="Defined at 147 in src/java/rmi/server/UnicastRemoteObject.java.">UnicastRemoteObject</a>
<a id="L100" name="L100"></a> 100         <strong class="reserved">implements</strong> <a href="../S/2508.html#L42" title="Defined at 42 in src/java/rmi/activation/ActivationInstantiator.java.">ActivationInstantiator</a>
<a id="L101" name="L101"></a> 101 <em class="brace">{</em>
<div class="comment">
      @serial the group's identifier</div>
<a id="L105" name="L105"></a> 105     <strong class="reserved">private</strong> <a href="../S/2515.html#L48" title="Defined at 48 in src/java/rmi/activation/ActivationGroupID.java.">ActivationGroupID</a> groupID;
<a id="L106" name="L106"></a> 106 
<div class="comment">
      @serial the group's monitor</div>
<a id="L110" name="L110"></a> 110     <strong class="reserved">private</strong> <a href="../S/2513.html#L49" title="Defined at 49 in src/java/rmi/activation/ActivationMonitor.java.">ActivationMonitor</a> <a href="../S/3455.html#L1122" title="Defined at 1122 in src/javax/management/monitor/Monitor.java.">monitor</a>;
<a id="L111" name="L111"></a> 111 
<div class="comment">
      @serial the group's incarnation number</div>
<a id="L115" name="L115"></a> 115     <strong class="reserved">private</strong> <strong class="reserved">long</strong> incarnation;
<a id="L116" name="L116"></a> 116 
<div class="comment">
     /** the current activation group for this VM */</div>
<a id="L118" name="L118"></a> 118     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a> currGroup;
<div class="comment">
     /** the current group's identifier */</div>
<a id="L120" name="L120"></a> 120     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/2515.html#L48" title="Defined at 48 in src/java/rmi/activation/ActivationGroupID.java.">ActivationGroupID</a> currGroupID;
<div class="comment">
     /** the current group's activation system */</div>
<a id="L122" name="L122"></a> 122     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/2509.html#L47" title="Defined at 47 in src/java/rmi/activation/ActivationSystem.java.">ActivationSystem</a> currSystem;
<div class="comment">
     /** used to control a group being created only once */</div>
<a id="L124" name="L124"></a> 124     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> canCreate = <strong class="reserved">true</strong>;
<a id="L125" name="L125"></a> 125 
<div class="comment">
     /** indicate compatibility with the Java 2 SDK v1.2 version of class */</div>
<a id="L127" name="L127"></a> 127     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = -7696947875314805420L;
<a id="L128" name="L128"></a> 128 
<div class="comment">
      Constructs an activation group with the given activation group
      identifier.  The group is exported as a
      <code>java.rmi.server.UnicastRemoteObject</code>.
      @param   groupID the group's identifier
      @throws  RemoteException if this group could not be exported
      @throws  UnsupportedOperationException if and only if activation is
               not supported by this implementation
      @since   1.2</div>
<a id="L140" name="L140"></a> 140     <strong class="reserved">protected</strong> ActivationGroup(<a href="../S/2515.html#L48" title="Defined at 48 in src/java/rmi/activation/ActivationGroupID.java.">ActivationGroupID</a> groupID)
<a id="L141" name="L141"></a> 141         <strong class="reserved">throws</strong> <a href="../S/2551.html#L49" title="Defined at 49 in src/java/rmi/RemoteException.java.">RemoteException</a>
<a id="L142" name="L142"></a> 142     <em class="brace">{</em>
<a id="L143" name="L143"></a> 143         <em class="comment">// call super constructor to export the object</em>
<a id="L144" name="L144"></a> 144         <strong class="reserved">super</strong>();
<a id="L145" name="L145"></a> 145         <strong class="reserved">this</strong>.groupID = groupID;
<a id="L146" name="L146"></a> 146     <em class="brace">}</em>
<a id="L147" name="L147"></a> 147 
<div class="comment">
      The group's <code>inactiveObject</code> method is called
      indirectly via a call to the <code>Activatable.inactive</code>
      method. A remote object implementation must call
      <code>Activatable</code>'s <code>inactive</code> method when
      that object deactivates (the object deems that it is no longer
      active). If the object does not call
      <code>Activatable.inactive</code> when it deactivates, the
      object will never be garbage collected since the group keeps
      strong references to the objects it creates.
      <p>The group's <code>inactiveObject</code> method unexports the
      remote object from the RMI runtime so that the object can no
      longer receive incoming RMI calls. An object will only be unexported
      if the object has no pending or executing calls.
      The subclass of <code>ActivationGroup</code> must override this
      method and unexport the object.
      </p><p>After removing the object from the RMI runtime, the group
      must inform its <code>ActivationMonitor</code> (via the monitor's
      <code>inactiveObject</code> method) that the remote object is
      not currently active so that the remote object will be
      re-activated by the activator upon a subsequent activation
      request.
      </p><p>This method simply informs the group's monitor that the object
      is inactive.  It is up to the concrete subclass of ActivationGroup
      to fulfill the additional requirement of unexporting the object. </p><p>
      @param id the object's activation identifier
      @return true if the object was successfully deactivated; otherwise
              returns false.
      @exception UnknownObjectException if object is unknown (may already
      be inactive)
      @exception RemoteException if call informing monitor fails
      @exception ActivationException if group is inactive
      @since 1.2</p></div>
<a id="L186" name="L186"></a> 186     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/20464.html" title="Multiple referred from 2 places.">inactiveObject</a>(<a href="../S/2510.html#L70" title="Defined at 70 in src/java/rmi/activation/ActivationID.java.">ActivationID</a> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>)
<a id="L187" name="L187"></a> 187         <strong class="reserved">throws</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>, <a href="../S/2506.html#L47" title="Defined at 47 in src/java/rmi/activation/UnknownObjectException.java.">UnknownObjectException</a>, <a href="../S/2551.html#L49" title="Defined at 49 in src/java/rmi/RemoteException.java.">RemoteException</a>
<a id="L188" name="L188"></a> 188     <em class="brace">{</em>
<a id="L189" name="L189"></a> 189         <a href="../S/2502.html#L507" title="Defined at 507 in src/java/rmi/activation/ActivationGroup.java.">getMonitor</a>().<a href="../D/24418.html" title="Multiple defined in 2 places.">inactiveObject</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>);
<a id="L190" name="L190"></a> 190         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L191" name="L191"></a> 191     <em class="brace">}</em>
<a id="L192" name="L192"></a> 192 
<div class="comment">
      The group's <code>activeObject</code> method is called when an
      object is exported (either by <code>Activatable</code> object
      construction or an explicit call to
      <code>Activatable.exportObject</code>. The group must inform its
      <code>ActivationMonitor</code> that the object is active (via
      the monitor's <code>activeObject</code> method) if the group
      hasn't already done so.
      @param id the object's identifier
      @param obj the remote object implementation
      @exception UnknownObjectException if object is not registered
      @exception RemoteException if call informing monitor fails
      @exception ActivationException if group is inactive
      @since 1.2</div>
<a id="L209" name="L209"></a> 209     <strong class="reserved">public</strong> <strong class="reserved">abstract</strong> <strong class="reserved">void</strong> <a href="../R/9578.html" title="Multiple referred from 2 places.">activeObject</a>(<a href="../S/2510.html#L70" title="Defined at 70 in src/java/rmi/activation/ActivationID.java.">ActivationID</a> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>, <a href="../S/2494.html#L50" title="Defined at 50 in src/java/rmi/Remote.java.">Remote</a> obj)
<a id="L210" name="L210"></a> 210         <strong class="reserved">throws</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>, <a href="../S/2506.html#L47" title="Defined at 47 in src/java/rmi/activation/UnknownObjectException.java.">UnknownObjectException</a>, <a href="../S/2551.html#L49" title="Defined at 49 in src/java/rmi/RemoteException.java.">RemoteException</a>;
<a id="L211" name="L211"></a> 211 
<div class="comment">
      Create and set the activation group for the current VM.  The
      activation group can only be set if it is not currently set.
      An activation group is set using the <code>createGroup</code>
      method when the <code>Activator</code> initiates the
      re-creation of an activation group in order to carry out
      incoming <code>activate</code> requests. A group must first be
      registered with the <code>ActivationSystem</code> before it can
      be created via this method.
      <p>The group class specified by the
      <code>ActivationGroupDesc</code> must be a concrete subclass of
      <code>ActivationGroup</code> and have a public constructor that
      takes two arguments: the <code>ActivationGroupID</code> for the
      group and the <code>MarshalledObject</code> containing the
      group's initialization data (obtained from the
      <code>ActivationGroupDesc</code>.
      </p><p>If the group class name specified in the
      <code>ActivationGroupDesc</code> is <code>null</code>, then
      this method will behave as if the group descriptor contained
      the name of the default activation group implementation class.
      </p><p>Note that if your application creates its own custom
      activation group, a security manager must be set for that
      group.  Otherwise objects cannot be activated in the group.
      <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> is set by default.
      </p><p>If a security manager is already set in the group VM, this
      method first calls the security manager's
      <code>checkSetFactory</code> method.  This could result in a
      <code>SecurityException</code>. If your application needs to
      set a different security manager, you must ensure that the
      policy file specified by the group's
      <code>ActivationGroupDesc</code> grants the group the necessary
      permissions to set a new security manager.  (Note: This will be
      necessary if your group downloads and sets a security manager).
      </p><p>After the group is created, the
      <code>ActivationSystem</code> is informed that the group is
      active by calling the <code>activeGroup</code> method which
      returns the <code>ActivationMonitor</code> for the group. The
      application need not call <code>activeGroup</code>
      independently since it is taken care of by this method.
      </p><p>Once a group is created, subsequent calls to the
      <code>currentGroupID</code> method will return the identifier
      for this group until the group becomes inactive.
      @param id the activation group's identifier
      @param desc the activation group's descriptor
      @param incarnation the group's incarnation number (zero on group's
      initial creation)
      @return the activation group for the VM
      @exception ActivationException if group already exists or if error
      occurs during group creation
      @exception SecurityException if permission to create group is denied.
      (Note: The default implementation of the security manager
      <code>checkSetFactory</code>
      method requires the RuntimePermission "setFactory")
      @exception UnsupportedOperationException if and only if activation is
      not supported by this implementation
      @see SecurityManager#checkSetFactory
      @since 1.2</p></div>
<a id="L277" name="L277"></a> 277     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">synchronized</strong>
<a id="L278" name="L278"></a> 278         <a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a> <a href="../R/12470.html" title="Multiple referred from 7 places.">createGroup</a>(<a href="../S/2515.html#L48" title="Defined at 48 in src/java/rmi/activation/ActivationGroupID.java.">ActivationGroupID</a> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>,
<a id="L279" name="L279"></a> 279                                     <strong class="reserved">final</strong> <a href="../S/2507.html#L59" title="Defined at 59 in src/java/rmi/activation/ActivationGroupDesc.java.">ActivationGroupDesc</a> desc,
<a id="L280" name="L280"></a> 280                                     <strong class="reserved">long</strong> incarnation)
<a id="L281" name="L281"></a> 281         <strong class="reserved">throws</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>
<a id="L282" name="L282"></a> 282     <em class="brace">{</em>
<a id="L283" name="L283"></a> 283         <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> security = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>();
<a id="L284" name="L284"></a> 284         <strong class="reserved">if</strong> (security != <strong class="reserved">null</strong>)
<a id="L285" name="L285"></a> 285             security.<a href="../S/1785.html#L1663" title="Defined at 1663 in src/java/lang/SecurityManager.java.">checkSetFactory</a>();
<a id="L286" name="L286"></a> 286 
<a id="L287" name="L287"></a> 287         <strong class="reserved">if</strong> (currGroup != <strong class="reserved">null</strong>)
<a id="L288" name="L288"></a> 288             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>("group already exists");
<a id="L289" name="L289"></a> 289 
<a id="L290" name="L290"></a> 290         <strong class="reserved">if</strong> (canCreate == <strong class="reserved">false</strong>)
<a id="L291" name="L291"></a> 291             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>("group deactivated and " +
<a id="L292" name="L292"></a> 292                                           "cannot be recreated");
<a id="L293" name="L293"></a> 293 
<a id="L294" name="L294"></a> 294         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L295" name="L295"></a> 295             <em class="comment">// load group's class</em>
<a id="L296" name="L296"></a> 296             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> groupClassName = desc.<a href="../D/17698.html" title="Multiple defined in 41 places.">getClassName</a>();
<a id="L297" name="L297"></a> 297             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;? <strong class="reserved">extends</strong> <a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a>&gt; cl;
<a id="L298" name="L298"></a> 298             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;? <strong class="reserved">extends</strong> <a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a>&gt; defaultGroupClass =
<a id="L299" name="L299"></a> 299                 sun.rmi.server.ActivationGroupImpl.<strong class="reserved">class</strong>;
<a id="L300" name="L300"></a> 300             <strong class="reserved">if</strong> (groupClassName == <strong class="reserved">null</strong> ||       <em class="comment">// see 4252236</em>
<a id="L301" name="L301"></a> 301                 groupClassName.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(defaultGroupClass.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>()))
<a id="L302" name="L302"></a> 302             <em class="brace">{</em>
<a id="L303" name="L303"></a> 303                 cl = defaultGroupClass;
<a id="L304" name="L304"></a> 304             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L305" name="L305"></a> 305                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; cl0;
<a id="L306" name="L306"></a> 306                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L307" name="L307"></a> 307                     cl0 = <a href="../S/2535.html#L110" title="Defined at 110 in src/java/rmi/server/RMIClassLoader.java.">RMIClassLoader</a>.<a href="../D/26901.html" title="Multiple defined in 49 places.">loadClass</a>(desc.<a href="../D/20238.html" title="Multiple defined in 36 places.">getLocation</a>(),
<a id="L308" name="L308"></a> 308                                                    groupClassName);
<a id="L309" name="L309"></a> 309                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L310" name="L310"></a> 310                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>(
<a id="L311" name="L311"></a> 311                         "Could not load group implementation class", <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>);
<a id="L312" name="L312"></a> 312                 <em class="brace">}</em>
<a id="L313" name="L313"></a> 313                 <strong class="reserved">if</strong> (<a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a>.<strong class="reserved">class</strong>.<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(cl0)) <em class="brace">{</em>
<a id="L314" name="L314"></a> 314                     cl = cl0.<a href="../S/1722.html#L3400" title="Defined at 3400 in src/java/lang/Class.java.">asSubclass</a>(<a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a>.<strong class="reserved">class</strong>);
<a id="L315" name="L315"></a> 315                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L316" name="L316"></a> 316                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>("group not correct class: " +
<a id="L317" name="L317"></a> 317                                                   cl0.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>());
<a id="L318" name="L318"></a> 318                 <em class="brace">}</em>
<a id="L319" name="L319"></a> 319             <em class="brace">}</em>
<a id="L320" name="L320"></a> 320 
<a id="L321" name="L321"></a> 321             <em class="comment">// create group</em>
<a id="L322" name="L322"></a> 322             <a href="../D/1833.html" title="Multiple defined in 2 places.">Constructor</a>&lt;? <strong class="reserved">extends</strong> <a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a>&gt; <a href="../S/1606.html#L332" title="Defined at 332 in src/java/lang/invoke/BoundMethodHandle.java.">constructor</a> =
<a id="L323" name="L323"></a> 323                 cl.<a href="../D/17932.html" title="Multiple defined in 2 places.">getConstructor</a>(<a href="../S/2515.html#L48" title="Defined at 48 in src/java/rmi/activation/ActivationGroupID.java.">ActivationGroupID</a>.<strong class="reserved">class</strong>,
<a id="L324" name="L324"></a> 324                                   <a href="../S/2546.html#L71" title="Defined at 71 in src/java/rmi/MarshalledObject.java.">MarshalledObject</a>.<strong class="reserved">class</strong>);
<a id="L325" name="L325"></a> 325             <a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a> newGroup =
<a id="L326" name="L326"></a> 326                 <a href="../S/1606.html#L332" title="Defined at 332 in src/java/lang/invoke/BoundMethodHandle.java.">constructor</a>.<a href="../D/28016.html" title="Multiple defined in 74 places.">newInstance</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>, desc.<a href="../D/18190.html" title="Multiple defined in 47 places.">getData</a>());
<a id="L327" name="L327"></a> 327             currSystem = <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>.<a href="../D/22894.html" title="Multiple defined in 2 places.">getSystem</a>();
<a id="L328" name="L328"></a> 328             newGroup.incarnation = incarnation;
<a id="L329" name="L329"></a> 329             newGroup.<a href="../S/3455.html#L1122" title="Defined at 1122 in src/javax/management/monitor/Monitor.java.">monitor</a> =
<a id="L330" name="L330"></a> 330                 currSystem.<a href="../S/2509.html#L126" title="Defined at 126 in src/java/rmi/activation/ActivationSystem.java.">activeGroup</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>, newGroup, incarnation);
<a id="L331" name="L331"></a> 331             currGroup = newGroup;
<a id="L332" name="L332"></a> 332             currGroupID = <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>;
<a id="L333" name="L333"></a> 333             canCreate = <strong class="reserved">false</strong>;
<a id="L334" name="L334"></a> 334         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1671.html#L42" title="Defined at 42 in src/java/lang/reflect/InvocationTargetException.java.">InvocationTargetException</a> e) <em class="brace">{</em>
<a id="L335" name="L335"></a> 335                 e.<a href="../D/23010.html" title="Multiple defined in 6 places.">getTargetException</a>().<a href="../D/29703.html" title="Multiple defined in 46 places.">printStackTrace</a>();
<a id="L336" name="L336"></a> 336                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>("exception in group constructor",
<a id="L337" name="L337"></a> 337                                               e.<a href="../D/23010.html" title="Multiple defined in 6 places.">getTargetException</a>());
<a id="L338" name="L338"></a> 338 
<a id="L339" name="L339"></a> 339         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a> e) <em class="brace">{</em>
<a id="L340" name="L340"></a> 340             <strong class="reserved">throw</strong> e;
<a id="L341" name="L341"></a> 341 
<a id="L342" name="L342"></a> 342         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L343" name="L343"></a> 343             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>("exception creating group", e);
<a id="L344" name="L344"></a> 344         <em class="brace">}</em>
<a id="L345" name="L345"></a> 345 
<a id="L346" name="L346"></a> 346         <strong class="reserved">return</strong> currGroup;
<a id="L347" name="L347"></a> 347     <em class="brace">}</em>
<a id="L348" name="L348"></a> 348 
<div class="comment">
      Returns the current activation group's identifier.  Returns null
      if no group is currently active for this VM.
      @exception UnsupportedOperationException if and only if activation is
      not supported by this implementation
      @return the activation group's identifier
      @since 1.2</div>
<a id="L357" name="L357"></a> 357     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">synchronized</strong> <a href="../S/2515.html#L48" title="Defined at 48 in src/java/rmi/activation/ActivationGroupID.java.">ActivationGroupID</a> currentGroupID() <em class="brace">{</em>
<a id="L358" name="L358"></a> 358         <strong class="reserved">return</strong> currGroupID;
<a id="L359" name="L359"></a> 359     <em class="brace">}</em>
<a id="L360" name="L360"></a> 360 
<div class="comment">
      Returns the activation group identifier for the VM.  If an
      activation group does not exist for this VM, a default
      activation group is created. A group can be created only once,
      so if a group has already become active and deactivated.
      @return the activation group identifier
      @exception ActivationException if error occurs during group
      creation, if security manager is not set, or if the group
      has already been created and deactivated.</div>
<a id="L372" name="L372"></a> 372     <strong class="reserved">static</strong> <strong class="reserved">synchronized</strong> <a href="../S/2515.html#L48" title="Defined at 48 in src/java/rmi/activation/ActivationGroupID.java.">ActivationGroupID</a> <a href="../R/20926.html" title="Multiple referred from 2 places.">internalCurrentGroupID</a>()
<a id="L373" name="L373"></a> 373         <strong class="reserved">throws</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>
<a id="L374" name="L374"></a> 374     <em class="brace">{</em>
<a id="L375" name="L375"></a> 375         <strong class="reserved">if</strong> (currGroupID == <strong class="reserved">null</strong>)
<a id="L376" name="L376"></a> 376             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>("nonexistent group");
<a id="L377" name="L377"></a> 377 
<a id="L378" name="L378"></a> 378         <strong class="reserved">return</strong> currGroupID;
<a id="L379" name="L379"></a> 379     <em class="brace">}</em>
<a id="L380" name="L380"></a> 380 
<div class="comment">
      Set the activation system for the VM.  The activation system can
      only be set it if no group is currently active. If the activation
      system is not set via this call, then the <code>getSystem</code>
      method attempts to obtain a reference to the
      <code>ActivationSystem</code> by looking up the name
      "java.rmi.activation.ActivationSystem" in the Activator's
      registry. By default, the port number used to look up the
      activation system is defined by
      <code>ActivationSystem.SYSTEM_PORT</code>. This port can be overridden
      by setting the property <code>java.rmi.activation.port</code>.
      <p>If there is a security manager, this method first
      calls the security manager's <code>checkSetFactory</code> method.
      This could result in a SecurityException.
      @param system remote reference to the <code>ActivationSystem</code>
      @exception ActivationException if activation system is already set
      @exception SecurityException if permission to set the activation system is denied.
      (Note: The default implementation of the security manager
      <code>checkSetFactory</code>
      method requires the RuntimePermission "setFactory")
      @exception UnsupportedOperationException if and only if activation is
      not supported by this implementation
      @see #getSystem
      @see SecurityManager#checkSetFactory
      @since 1.2</p></div>
<a id="L409" name="L409"></a> 409     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> setSystem(<a href="../S/2509.html#L47" title="Defined at 47 in src/java/rmi/activation/ActivationSystem.java.">ActivationSystem</a> <a href="../S/1552.html#L196" title="Defined at 196 in src/java/time/Clock.java.">system</a>)
<a id="L410" name="L410"></a> 410         <strong class="reserved">throws</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>
<a id="L411" name="L411"></a> 411     <em class="brace">{</em>
<a id="L412" name="L412"></a> 412         <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> security = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>();
<a id="L413" name="L413"></a> 413         <strong class="reserved">if</strong> (security != <strong class="reserved">null</strong>)
<a id="L414" name="L414"></a> 414             security.<a href="../S/1785.html#L1663" title="Defined at 1663 in src/java/lang/SecurityManager.java.">checkSetFactory</a>();
<a id="L415" name="L415"></a> 415 
<a id="L416" name="L416"></a> 416         <strong class="reserved">if</strong> (currSystem != <strong class="reserved">null</strong>)
<a id="L417" name="L417"></a> 417             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>("activation system already set");
<a id="L418" name="L418"></a> 418 
<a id="L419" name="L419"></a> 419         currSystem = <a href="../S/1552.html#L196" title="Defined at 196 in src/java/time/Clock.java.">system</a>;
<a id="L420" name="L420"></a> 420     <em class="brace">}</em>
<a id="L421" name="L421"></a> 421 
<div class="comment">
      Returns the activation system for the VM. The activation system
      may be set by the <code>setSystem</code> method. If the
      activation system is not set via the <code>setSystem</code>
      method, then the <code>getSystem</code> method attempts to
      obtain a reference to the <code>ActivationSystem</code> by
      looking up the name "java.rmi.activation.ActivationSystem" in
      the Activator's registry. By default, the port number used to
      look up the activation system is defined by
      <code>ActivationSystem.SYSTEM_PORT</code>. This port can be
      overridden by setting the property
      <code>java.rmi.activation.port</code>.
      @return the activation system for the VM/group
      @exception ActivationException if activation system cannot be
       obtained or is not bound
      (means that it is not running)
      @exception UnsupportedOperationException if and only if activation is
      not supported by this implementation
      @see #setSystem
      @since 1.2</div>
<a id="L444" name="L444"></a> 444     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">synchronized</strong> <a href="../S/2509.html#L47" title="Defined at 47 in src/java/rmi/activation/ActivationSystem.java.">ActivationSystem</a> <a href="../R/19306.html" title="Multiple referred from 4 places.">getSystem</a>()
<a id="L445" name="L445"></a> 445         <strong class="reserved">throws</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>
<a id="L446" name="L446"></a> 446     <em class="brace">{</em>
<a id="L447" name="L447"></a> 447         <strong class="reserved">if</strong> (currSystem == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L448" name="L448"></a> 448             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L449" name="L449"></a> 449                 <strong class="reserved">int</strong> port = <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(
<a id="L450" name="L450"></a> 450                     <strong class="reserved">new</strong> GetIntegerAction("java.rmi.activation.port",
<a id="L451" name="L451"></a> 451                                          <a href="../S/2509.html#L47" title="Defined at 47 in src/java/rmi/activation/ActivationSystem.java.">ActivationSystem</a>.SYSTEM_PORT));
<a id="L452" name="L452"></a> 452                 currSystem = (<a href="../S/2509.html#L47" title="Defined at 47 in src/java/rmi/activation/ActivationSystem.java.">ActivationSystem</a>)
<a id="L453" name="L453"></a> 453                     <a href="../S/2558.html#L72" title="Defined at 72 in src/java/rmi/Naming.java.">Naming</a>.<a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>("//:" + port +
<a id="L454" name="L454"></a> 454                                   "/java.rmi.activation.ActivationSystem");
<a id="L455" name="L455"></a> 455             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L456" name="L456"></a> 456                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>(
<a id="L457" name="L457"></a> 457                     "unable to obtain ActivationSystem", e);
<a id="L458" name="L458"></a> 458             <em class="brace">}</em>
<a id="L459" name="L459"></a> 459         <em class="brace">}</em>
<a id="L460" name="L460"></a> 460         <strong class="reserved">return</strong> currSystem;
<a id="L461" name="L461"></a> 461     <em class="brace">}</em>
<a id="L462" name="L462"></a> 462 
<div class="comment">
      This protected method is necessary for subclasses to
      make the <code>activeObject</code> callback to the group's
      monitor. The call is simply forwarded to the group's
      <code>ActivationMonitor</code>.
      @param id the object's identifier
      @param mobj a marshalled object containing the remote object's stub
      @exception UnknownObjectException if object is not registered
      @exception RemoteException if call informing monitor fails
      @exception ActivationException if an activation error occurs
      @since 1.2</div>
<a id="L476" name="L476"></a> 476     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/9578.html" title="Multiple referred from 2 places.">activeObject</a>(<a href="../S/2510.html#L70" title="Defined at 70 in src/java/rmi/activation/ActivationID.java.">ActivationID</a> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>,
<a id="L477" name="L477"></a> 477                                 <a href="../S/2546.html#L71" title="Defined at 71 in src/java/rmi/MarshalledObject.java.">MarshalledObject</a>&lt;? <strong class="reserved">extends</strong> <a href="../S/2494.html#L50" title="Defined at 50 in src/java/rmi/Remote.java.">Remote</a>&gt; mobj)
<a id="L478" name="L478"></a> 478         <strong class="reserved">throws</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>, <a href="../S/2506.html#L47" title="Defined at 47 in src/java/rmi/activation/UnknownObjectException.java.">UnknownObjectException</a>, <a href="../S/2551.html#L49" title="Defined at 49 in src/java/rmi/RemoteException.java.">RemoteException</a>
<a id="L479" name="L479"></a> 479     <em class="brace">{</em>
<a id="L480" name="L480"></a> 480         <a href="../S/2502.html#L507" title="Defined at 507 in src/java/rmi/activation/ActivationGroup.java.">getMonitor</a>().<a href="../D/10616.html" title="Multiple defined in 3 places.">activeObject</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>, mobj);
<a id="L481" name="L481"></a> 481     <em class="brace">}</em>
<a id="L482" name="L482"></a> 482 
<div class="comment">
      This protected method is necessary for subclasses to
      make the <code>inactiveGroup</code> callback to the group's
      monitor. The call is simply forwarded to the group's
      <code>ActivationMonitor</code>. Also, the current group
      for the VM is set to null.
      @exception UnknownGroupException if group is not registered
      @exception RemoteException if call informing monitor fails
      @since 1.2</div>
<a id="L494" name="L494"></a> 494     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/2502.html#L498" title="Referred from 498 in src/java/rmi/activation/ActivationGroup.java.">inactiveGroup</a>()
<a id="L495" name="L495"></a> 495         <strong class="reserved">throws</strong> <a href="../S/2511.html#L45" title="Defined at 45 in src/java/rmi/activation/UnknownGroupException.java.">UnknownGroupException</a>, <a href="../S/2551.html#L49" title="Defined at 49 in src/java/rmi/RemoteException.java.">RemoteException</a>
<a id="L496" name="L496"></a> 496     <em class="brace">{</em>
<a id="L497" name="L497"></a> 497         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L498" name="L498"></a> 498             <a href="../S/2502.html#L507" title="Defined at 507 in src/java/rmi/activation/ActivationGroup.java.">getMonitor</a>().<a href="../D/24417.html" title="Multiple defined in 2 places.">inactiveGroup</a>(groupID, incarnation);
<a id="L499" name="L499"></a> 499         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L500" name="L500"></a> 500             <a href="../S/2502.html#L519" title="Defined at 519 in src/java/rmi/activation/ActivationGroup.java.">destroyGroup</a>();
<a id="L501" name="L501"></a> 501         <em class="brace">}</em>
<a id="L502" name="L502"></a> 502     <em class="brace">}</em>
<a id="L503" name="L503"></a> 503 
<div class="comment">
      Returns the monitor for the activation group.</div>
<a id="L507" name="L507"></a> 507     <strong class="reserved">private</strong> <a href="../S/2513.html#L49" title="Defined at 49 in src/java/rmi/activation/ActivationMonitor.java.">ActivationMonitor</a> <a href="../R/17784.html" title="Multiple referred from 3 places.">getMonitor</a>() <strong class="reserved">throws</strong> <a href="../S/2551.html#L49" title="Defined at 49 in src/java/rmi/RemoteException.java.">RemoteException</a> <em class="brace">{</em>
<a id="L508" name="L508"></a> 508         <strong class="reserved">synchronized</strong> (<a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L509" name="L509"></a> 509             <strong class="reserved">if</strong> (<a href="../S/3455.html#L1122" title="Defined at 1122 in src/javax/management/monitor/Monitor.java.">monitor</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L510" name="L510"></a> 510                 <strong class="reserved">return</strong> <a href="../S/3455.html#L1122" title="Defined at 1122 in src/javax/management/monitor/Monitor.java.">monitor</a>;
<a id="L511" name="L511"></a> 511             <em class="brace">}</em>
<a id="L512" name="L512"></a> 512         <em class="brace">}</em>
<a id="L513" name="L513"></a> 513         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2551.html#L49" title="Defined at 49 in src/java/rmi/RemoteException.java.">RemoteException</a>("monitor not received");
<a id="L514" name="L514"></a> 514     <em class="brace">}</em>
<a id="L515" name="L515"></a> 515 
<div class="comment">
      Destroys the current group.</div>
<a id="L519" name="L519"></a> 519     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../S/2502.html#L500" title="Referred from 500 in src/java/rmi/activation/ActivationGroup.java.">destroyGroup</a>() <em class="brace">{</em>
<a id="L520" name="L520"></a> 520         currGroup = <strong class="reserved">null</strong>;
<a id="L521" name="L521"></a> 521         currGroupID = <strong class="reserved">null</strong>;
<a id="L522" name="L522"></a> 522         <em class="comment">// NOTE: don't set currSystem to null since it may be needed</em>
<a id="L523" name="L523"></a> 523     <em class="brace">}</em>
<a id="L524" name="L524"></a> 524 
<div class="comment">
      Returns the current group for the VM.
      @exception ActivationException if current group is null (not active)</div>
<a id="L529" name="L529"></a> 529     <strong class="reserved">static</strong> <strong class="reserved">synchronized</strong> <a href="../S/2502.html#L98" title="Defined at 98 in src/java/rmi/activation/ActivationGroup.java.">ActivationGroup</a> <a href="../R/12862.html" title="Multiple referred from 12 places.">currentGroup</a>()
<a id="L530" name="L530"></a> 530         <strong class="reserved">throws</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>
<a id="L531" name="L531"></a> 531     <em class="brace">{</em>
<a id="L532" name="L532"></a> 532         <strong class="reserved">if</strong> (currGroup == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L533" name="L533"></a> 533             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2504.html#L45" title="Defined at 45 in src/java/rmi/activation/ActivationException.java.">ActivationException</a>("group is not active");
<a id="L534" name="L534"></a> 534         <em class="brace">}</em>
<a id="L535" name="L535"></a> 535         <strong class="reserved">return</strong> currGroup;
<a id="L536" name="L536"></a> 536     <em class="brace">}</em>
<a id="L537" name="L537"></a> 537 
<a id="L538" name="L538"></a> 538 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L186">[^]</a><a href="#L529">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>