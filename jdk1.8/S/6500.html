<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/jmx/remote/security/JMXPluggableAuthenticator.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L157">[^]</a><a href="#L341">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L157" title="Defined at 157.">authenticate</a></li>
<li><a href="#L208" title="Defined at 208.">authenticationFailure</a></li>
<li><a href="#L216" title="Defined at 216.">authenticationFailure</a></li>
<li><a href="#L234" title="Defined at 234.">logException</a></li>
<li><a href="#L267" title="Defined at 267.">handle</a></li>
<li><a href="#L333" title="Defined at 333.">getAppConfigurationEntry</a></li>
<li><a href="#L341" title="Defined at 341.">refresh</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2004, 2008, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> com.sun.jmx.remote.security;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.IOException;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.security.AccessController;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.security.Principal;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.security.PrivilegedAction;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> java.security.PrivilegedActionException;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> java.security.PrivilegedExceptionAction;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> java.util.Collections;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> java.util.HashMap;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> java.util.Map;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> java.util.Properties;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> javax.management.remote.JMXPrincipal;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> javax.management.remote.JMXAuthenticator;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> javax.security.auth.AuthPermission;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> javax.security.auth.Subject;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> javax.security.auth.callback.*;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> javax.security.auth.login.AppConfigurationEntry;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> javax.security.auth.login.Configuration;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> javax.security.auth.login.LoginContext;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> javax.security.auth.login.LoginException;
<a id="L47" name="L47"></a>  47 <strong class="reserved">import</strong> javax.security.auth.spi.LoginModule;
<a id="L48" name="L48"></a>  48 <strong class="reserved">import</strong> com.sun.jmx.remote.util.ClassLogger;
<a id="L49" name="L49"></a>  49 <strong class="reserved">import</strong> com.sun.jmx.remote.util.EnvHelp;
<a id="L50" name="L50"></a>  50 
<div class="comment">
  <p>This class represents a
  <a href="{@docRoot}/../guide/security/jaas/JAASRefGuide.html">JAAS</a>
  based implementation of the <a href="../S/3608.html#L52" title="Defined at 52 in src/javax/management/remote/JMXAuthenticator.java.">JMXAuthenticator</a> interface.</p>
  <p>Authentication is performed by passing the supplied user's credentials
  to one or more authentication mechanisms ({@link LoginModule}) for
  verification. An authentication mechanism acquires the user's credentials
  by calling <a href="../S/2650.html#L35" title="Defined at 35 in src/javax/security/auth/callback/NameCallback.java.">NameCallback</a> and/or <a href="../S/2651.html#L35" title="Defined at 35 in src/javax/security/auth/callback/PasswordCallback.java.">PasswordCallback</a>.
  If authentication is successful then an authenticated <a href="../S/2639.html#L100" title="Defined at 100 in src/javax/security/auth/Subject.java.">Subject</a>
  filled in with a {@link Principal} is returned.  Authorization checks
  will then be performed based on this <code>Subject</code>.</p>
  <p>By default, a single file-based authentication mechanism
  <a href="../S/6495.html#L111" title="Defined at 111 in src/com/sun/jmx/remote/security/FileLoginModule.java.">FileLoginModule</a> is configured (<code>FileLoginConfig</code>).</p>
  <p>To override the default configuration use the
  <code>com.sun.management.jmxremote.login.config</code> management property
  described in the JRE/lib/management/management.properties file.
  Set this property to the name of a JAAS configuration entry and ensure that
  the entry is loaded by the installed <a href="../S/2667.html#L188" title="Defined at 188 in src/javax/security/auth/login/Configuration.java.">Configuration</a>. In addition,
  ensure that the authentication mechanisms specified in the entry acquire
  the user's credentials by calling <a href="../S/2650.html#L35" title="Defined at 35 in src/javax/security/auth/callback/NameCallback.java.">NameCallback</a> and
  <a href="../S/2651.html#L35" title="Defined at 35 in src/javax/security/auth/callback/PasswordCallback.java.">PasswordCallback</a> and that they return a <a href="../S/2639.html#L100" title="Defined at 100 in src/javax/security/auth/Subject.java.">Subject</a> filled-in
  with a {@link Principal}, for those users that are successfully
  authenticated.</p></div>
<a id="L78" name="L78"></a>  78 <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/4200.html" title="Multiple referred from 2 places.">JMXPluggableAuthenticator</a> <strong class="reserved">implements</strong> <a href="../S/3608.html#L52" title="Defined at 52 in src/javax/management/remote/JMXAuthenticator.java.">JMXAuthenticator</a> <em class="brace">{</em>
<a id="L79" name="L79"></a>  79 
<div class="comment">
      Creates an instance of <code>JMXPluggableAuthenticator</code>
      and initializes it with a <a href="../S/2665.html#L195" title="Defined at 195 in src/javax/security/auth/login/LoginContext.java.">LoginContext</a>.
      @param env the environment containing configuration properties for the
                 authenticator. Can be null, which is equivalent to an empty
                 Map.
      @exception SecurityException if the authentication mechanism cannot be
                 initialized.</div>
<a id="L90" name="L90"></a>  90     <strong class="reserved">public</strong> JMXPluggableAuthenticator(<a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;?, ?&gt; <a href="../D/15665.html" title="Multiple defined in 2 places.">env</a>) <em class="brace">{</em>
<a id="L91" name="L91"></a>  91 
<a id="L92" name="L92"></a>  92         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> loginConfigName = <strong class="reserved">null</strong>;
<a id="L93" name="L93"></a>  93         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> passwordFile = <strong class="reserved">null</strong>;
<a id="L94" name="L94"></a>  94 
<a id="L95" name="L95"></a>  95         <strong class="reserved">if</strong> (<a href="../D/15665.html" title="Multiple defined in 2 places.">env</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L96" name="L96"></a>  96             loginConfigName = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) <a href="../D/15665.html" title="Multiple defined in 2 places.">env</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(LOGIN_CONFIG_PROP);
<a id="L97" name="L97"></a>  97             passwordFile = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) <a href="../D/15665.html" title="Multiple defined in 2 places.">env</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(PASSWORD_FILE_PROP);
<a id="L98" name="L98"></a>  98         <em class="brace">}</em>
<a id="L99" name="L99"></a>  99 
<a id="L100" name="L100"></a> 100         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L101" name="L101"></a> 101 
<a id="L102" name="L102"></a> 102             <strong class="reserved">if</strong> (loginConfigName != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L103" name="L103"></a> 103                 <em class="comment">// use the supplied JAAS login configuration</em>
<a id="L104" name="L104"></a> 104                 loginContext =
<a id="L105" name="L105"></a> 105                     <strong class="reserved">new</strong> <a href="../S/2665.html#L195" title="Defined at 195 in src/javax/security/auth/login/LoginContext.java.">LoginContext</a>(loginConfigName, <strong class="reserved">new</strong> <a href="../S/6500.html#L262" title="Defined at 262 in src/com/sun/jmx/remote/security/JMXPluggableAuthenticator.java.">JMXCallbackHandler</a>());
<a id="L106" name="L106"></a> 106 
<a id="L107" name="L107"></a> 107             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L108" name="L108"></a> 108                 <em class="comment">// use the default JAAS login configuration (file-based)</em>
<a id="L109" name="L109"></a> 109                 <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> sm = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>();
<a id="L110" name="L110"></a> 110                 <strong class="reserved">if</strong> (sm != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L111" name="L111"></a> 111                     sm.<a href="../D/12594.html" title="Multiple defined in 22 places.">checkPermission</a>(
<a id="L112" name="L112"></a> 112                             <strong class="reserved">new</strong> <a href="../S/2649.html#L129" title="Defined at 129 in src/javax/security/auth/AuthPermission.java.">AuthPermission</a>("createLoginContext." +
<a id="L113" name="L113"></a> 113                                                LOGIN_CONFIG_NAME));
<a id="L114" name="L114"></a> 114                 <em class="brace">}</em>
<a id="L115" name="L115"></a> 115 
<a id="L116" name="L116"></a> 116                 <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> pf = passwordFile;
<a id="L117" name="L117"></a> 117                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L118" name="L118"></a> 118                     loginContext = <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(
<a id="L119" name="L119"></a> 119                         <strong class="reserved">new</strong> <a href="../S/1263.html#L45" title="Defined at 45 in src/java/security/PrivilegedExceptionAction.java.">PrivilegedExceptionAction</a>&lt;<a href="../S/2665.html#L195" title="Defined at 195 in src/javax/security/auth/login/LoginContext.java.">LoginContext</a>&gt;() <em class="brace">{</em>
<a id="L120" name="L120"></a> 120                             <strong class="reserved">public</strong> <a href="../S/2665.html#L195" title="Defined at 195 in src/javax/security/auth/login/LoginContext.java.">LoginContext</a> <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>() <strong class="reserved">throws</strong> <a href="../S/2666.html#L34" title="Defined at 34 in src/javax/security/auth/login/LoginException.java.">LoginException</a> <em class="brace">{</em>
<a id="L121" name="L121"></a> 121                                 <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/2665.html#L195" title="Defined at 195 in src/javax/security/auth/login/LoginContext.java.">LoginContext</a>(
<a id="L122" name="L122"></a> 122                                                 LOGIN_CONFIG_NAME,
<a id="L123" name="L123"></a> 123                                                 <strong class="reserved">null</strong>,
<a id="L124" name="L124"></a> 124                                                 <strong class="reserved">new</strong> <a href="../S/6500.html#L262" title="Defined at 262 in src/com/sun/jmx/remote/security/JMXPluggableAuthenticator.java.">JMXCallbackHandler</a>(),
<a id="L125" name="L125"></a> 125                                                 <strong class="reserved">new</strong> <a href="../S/6500.html#L295" title="Defined at 295 in src/com/sun/jmx/remote/security/JMXPluggableAuthenticator.java.">FileLoginConfig</a>(pf));
<a id="L126" name="L126"></a> 126                             <em class="brace">}</em>
<a id="L127" name="L127"></a> 127                         <em class="brace">}</em>);
<a id="L128" name="L128"></a> 128                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1259.html#L50" title="Defined at 50 in src/java/security/PrivilegedActionException.java.">PrivilegedActionException</a> pae) <em class="brace">{</em>
<a id="L129" name="L129"></a> 129                     <strong class="reserved">throw</strong> (<a href="../S/2666.html#L34" title="Defined at 34 in src/javax/security/auth/login/LoginException.java.">LoginException</a>) pae.<a href="../D/18894.html" title="Multiple defined in 26 places.">getException</a>();
<a id="L130" name="L130"></a> 130                 <em class="brace">}</em>
<a id="L131" name="L131"></a> 131             <em class="brace">}</em>
<a id="L132" name="L132"></a> 132 
<a id="L133" name="L133"></a> 133         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/2666.html#L34" title="Defined at 34 in src/javax/security/auth/login/LoginException.java.">LoginException</a> le) <em class="brace">{</em>
<a id="L134" name="L134"></a> 134             <a href="../D/11643.html" title="Multiple defined in 2 places.">authenticationFailure</a>("authenticate", le);
<a id="L135" name="L135"></a> 135 
<a id="L136" name="L136"></a> 136         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> se) <em class="brace">{</em>
<a id="L137" name="L137"></a> 137             <a href="../D/11643.html" title="Multiple defined in 2 places.">authenticationFailure</a>("authenticate", se);
<a id="L138" name="L138"></a> 138         <em class="brace">}</em>
<a id="L139" name="L139"></a> 139     <em class="brace">}</em>
<a id="L140" name="L140"></a> 140 
<div class="comment">
      Authenticate the <code>MBeanServerConnection</code> client
      with the given client credentials.
      @param credentials the user-defined credentials to be passed in
      to the server in order to authenticate the user before creating
      the <code>MBeanServerConnection</code>.  This parameter must
      be a two-element <code>String[]</code> containing the client's
      username and password in that order.
      @return the authenticated subject containing a
      <code>JMXPrincipal(username)</code>.
      @exception SecurityException if the server cannot authenticate the user
      with the provided credentials.</div>
<a id="L157" name="L157"></a> 157     <strong class="reserved">public</strong> <a href="../S/2639.html#L100" title="Defined at 100 in src/javax/security/auth/Subject.java.">Subject</a> <a href="../R/10413.html" title="Multiple referred from 4 places.">authenticate</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> credentials) <em class="brace">{</em>
<a id="L158" name="L158"></a> 158         <em class="comment">// Verify that credentials is of type String[].</em>
<a id="L159" name="L159"></a> 159         <em class="comment">//</em>
<a id="L160" name="L160"></a> 160         <strong class="reserved">if</strong> (!(credentials <strong class="reserved">instanceof</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[])) <em class="brace">{</em>
<a id="L161" name="L161"></a> 161             <em class="comment">// Special case for null so we get a more informative message</em>
<a id="L162" name="L162"></a> 162             <strong class="reserved">if</strong> (credentials == <strong class="reserved">null</strong>)
<a id="L163" name="L163"></a> 163                 <a href="../D/11643.html" title="Multiple defined in 2 places.">authenticationFailure</a>("authenticate", "Credentials required");
<a id="L164" name="L164"></a> 164 
<a id="L165" name="L165"></a> 165             <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> =
<a id="L166" name="L166"></a> 166                 "Credentials should be String[] instead of " +
<a id="L167" name="L167"></a> 167                  credentials.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>().<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L168" name="L168"></a> 168             <a href="../D/11643.html" title="Multiple defined in 2 places.">authenticationFailure</a>("authenticate", <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>);
<a id="L169" name="L169"></a> 169         <em class="brace">}</em>
<a id="L170" name="L170"></a> 170         <em class="comment">// Verify that the array contains two elements.</em>
<a id="L171" name="L171"></a> 171         <em class="comment">//</em>
<a id="L172" name="L172"></a> 172         <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] aCredentials = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[]) credentials;
<a id="L173" name="L173"></a> 173         <strong class="reserved">if</strong> (aCredentials.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != 2) <em class="brace">{</em>
<a id="L174" name="L174"></a> 174             <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> =
<a id="L175" name="L175"></a> 175                 "Credentials should have 2 elements not " +
<a id="L176" name="L176"></a> 176                 aCredentials.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L177" name="L177"></a> 177             <a href="../D/11643.html" title="Multiple defined in 2 places.">authenticationFailure</a>("authenticate", <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>);
<a id="L178" name="L178"></a> 178         <em class="brace">}</em>
<a id="L179" name="L179"></a> 179         <em class="comment">// Verify that username exists and the associated</em>
<a id="L180" name="L180"></a> 180         <em class="comment">// password matches the one supplied by the client.</em>
<a id="L181" name="L181"></a> 181         <em class="comment">//</em>
<a id="L182" name="L182"></a> 182         username = aCredentials[0];
<a id="L183" name="L183"></a> 183         password = aCredentials[1];
<a id="L184" name="L184"></a> 184         <strong class="reserved">if</strong> (username == <strong class="reserved">null</strong> || password == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L185" name="L185"></a> 185             <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = "Username or password is null";
<a id="L186" name="L186"></a> 186             <a href="../D/11643.html" title="Multiple defined in 2 places.">authenticationFailure</a>("authenticate", <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>);
<a id="L187" name="L187"></a> 187         <em class="brace">}</em>
<a id="L188" name="L188"></a> 188 
<a id="L189" name="L189"></a> 189         <em class="comment">// Perform authentication</em>
<a id="L190" name="L190"></a> 190         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L191" name="L191"></a> 191             loginContext.<a href="../D/27059.html" title="Multiple defined in 11 places.">login</a>();
<a id="L192" name="L192"></a> 192             <strong class="reserved">final</strong> <a href="../S/2639.html#L100" title="Defined at 100 in src/javax/security/auth/Subject.java.">Subject</a> subject = loginContext.<a href="../D/22833.html" title="Multiple defined in 5 places.">getSubject</a>();
<a id="L193" name="L193"></a> 193             <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<strong class="reserved">new</strong> <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../S/1638.html#L37" title="Defined at 37 in src/java/lang/Void.java.">Void</a>&gt;() <em class="brace">{</em>
<a id="L194" name="L194"></a> 194                     <strong class="reserved">public</strong> <a href="../S/1638.html#L37" title="Defined at 37 in src/java/lang/Void.java.">Void</a> <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>() <em class="brace">{</em>
<a id="L195" name="L195"></a> 195                         subject.<a href="../D/33663.html" title="Multiple defined in 19 places.">setReadOnly</a>();
<a id="L196" name="L196"></a> 196                         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L197" name="L197"></a> 197                     <em class="brace">}</em>
<a id="L198" name="L198"></a> 198                 <em class="brace">}</em>);
<a id="L199" name="L199"></a> 199 
<a id="L200" name="L200"></a> 200             <strong class="reserved">return</strong> subject;
<a id="L201" name="L201"></a> 201 
<a id="L202" name="L202"></a> 202         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/2666.html#L34" title="Defined at 34 in src/javax/security/auth/login/LoginException.java.">LoginException</a> le) <em class="brace">{</em>
<a id="L203" name="L203"></a> 203             <a href="../D/11643.html" title="Multiple defined in 2 places.">authenticationFailure</a>("authenticate", le);
<a id="L204" name="L204"></a> 204         <em class="brace">}</em>
<a id="L205" name="L205"></a> 205         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L206" name="L206"></a> 206     <em class="brace">}</em>
<a id="L207" name="L207"></a> 207 
<a id="L208" name="L208"></a> 208     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/10414.html" title="Multiple referred from 7 places.">authenticationFailure</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> method, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>)
<a id="L209" name="L209"></a> 209         <strong class="reserved">throws</strong> <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> <em class="brace">{</em>
<a id="L210" name="L210"></a> 210         <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a> = "Authentication failed! " + <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>;
<a id="L211" name="L211"></a> 211         <strong class="reserved">final</strong> <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> e = <strong class="reserved">new</strong> <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a>(<a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>);
<a id="L212" name="L212"></a> 212         <a href="../S/6500.html#L234" title="Defined at 234 in src/com/sun/jmx/remote/security/JMXPluggableAuthenticator.java.">logException</a>(method, <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, e);
<a id="L213" name="L213"></a> 213         <strong class="reserved">throw</strong> e;
<a id="L214" name="L214"></a> 214     <em class="brace">}</em>
<a id="L215" name="L215"></a> 215 
<a id="L216" name="L216"></a> 216     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/10414.html" title="Multiple referred from 7 places.">authenticationFailure</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> method,
<a id="L217" name="L217"></a> 217                                               <a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../D/15769.html" title="Multiple defined in 5 places.">exception</a>)
<a id="L218" name="L218"></a> 218         <strong class="reserved">throws</strong> <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> <em class="brace">{</em>
<a id="L219" name="L219"></a> 219         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>;
<a id="L220" name="L220"></a> 220         <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> se;
<a id="L221" name="L221"></a> 221         <strong class="reserved">if</strong> (<a href="../D/15769.html" title="Multiple defined in 5 places.">exception</a> <strong class="reserved">instanceof</strong> <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a>) <em class="brace">{</em>
<a id="L222" name="L222"></a> 222             <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a> = <a href="../D/15769.html" title="Multiple defined in 5 places.">exception</a>.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>();
<a id="L223" name="L223"></a> 223             se = (<a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a>) <a href="../D/15769.html" title="Multiple defined in 5 places.">exception</a>;
<a id="L224" name="L224"></a> 224         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L225" name="L225"></a> 225             <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a> = "Authentication failed! " + <a href="../D/15769.html" title="Multiple defined in 5 places.">exception</a>.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>();
<a id="L226" name="L226"></a> 226             <strong class="reserved">final</strong> <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> e = <strong class="reserved">new</strong> <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a>(<a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>);
<a id="L227" name="L227"></a> 227             <a href="../S/6493.html#L55" title="Defined at 55 in src/com/sun/jmx/remote/util/EnvHelp.java.">EnvHelp</a>.<a href="../D/24507.html" title="Multiple defined in 7 places.">initCause</a>(e, <a href="../D/15769.html" title="Multiple defined in 5 places.">exception</a>);
<a id="L228" name="L228"></a> 228             se = e;
<a id="L229" name="L229"></a> 229         <em class="brace">}</em>
<a id="L230" name="L230"></a> 230         <a href="../S/6500.html#L234" title="Defined at 234 in src/com/sun/jmx/remote/security/JMXPluggableAuthenticator.java.">logException</a>(method, <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, se);
<a id="L231" name="L231"></a> 231         <strong class="reserved">throw</strong> se;
<a id="L232" name="L232"></a> 232     <em class="brace">}</em>
<a id="L233" name="L233"></a> 233 
<a id="L234" name="L234"></a> 234     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/22678.html" title="Multiple referred from 2 places.">logException</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> method,
<a id="L235" name="L235"></a> 235                                      <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>,
<a id="L236" name="L236"></a> 236                                      <a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L237" name="L237"></a> 237         <strong class="reserved">if</strong> (<a href="../S/835.html#L1128" title="Defined at 1128 in src/java/util/prefs/WindowsPreferences.java.">logger</a>.<a href="../S/6492.html#L61" title="Defined at 61 in src/com/sun/jmx/remote/util/ClassLogger.java.">traceOn</a>()) <em class="brace">{</em>
<a id="L238" name="L238"></a> 238             <a href="../S/835.html#L1128" title="Defined at 1128 in src/java/util/prefs/WindowsPreferences.java.">logger</a>.<a href="../D/35559.html" title="Multiple defined in 6 places.">trace</a>(method, <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>);
<a id="L239" name="L239"></a> 239         <em class="brace">}</em>
<a id="L240" name="L240"></a> 240         <strong class="reserved">if</strong> (<a href="../S/835.html#L1128" title="Defined at 1128 in src/java/util/prefs/WindowsPreferences.java.">logger</a>.<a href="../S/6492.html#L65" title="Defined at 65 in src/com/sun/jmx/remote/util/ClassLogger.java.">debugOn</a>()) <em class="brace">{</em>
<a id="L241" name="L241"></a> 241             <a href="../S/835.html#L1128" title="Defined at 1128 in src/java/util/prefs/WindowsPreferences.java.">logger</a>.<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>(method, e);
<a id="L242" name="L242"></a> 242         <em class="brace">}</em>
<a id="L243" name="L243"></a> 243     <em class="brace">}</em>
<a id="L244" name="L244"></a> 244 
<a id="L245" name="L245"></a> 245     <strong class="reserved">private</strong> <a href="../S/2665.html#L195" title="Defined at 195 in src/javax/security/auth/login/LoginContext.java.">LoginContext</a> loginContext;
<a id="L246" name="L246"></a> 246     <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> username;
<a id="L247" name="L247"></a> 247     <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> password;
<a id="L248" name="L248"></a> 248     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> LOGIN_CONFIG_PROP =
<a id="L249" name="L249"></a> 249         "jmx.remote.x.login.config";
<a id="L250" name="L250"></a> 250     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> LOGIN_CONFIG_NAME = "JMXPluggableAuthenticator";
<a id="L251" name="L251"></a> 251     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> PASSWORD_FILE_PROP =
<a id="L252" name="L252"></a> 252         "jmx.remote.x.password.file";
<a id="L253" name="L253"></a> 253     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/6492.html#L30" title="Defined at 30 in src/com/sun/jmx/remote/util/ClassLogger.java.">ClassLogger</a> <a href="../S/835.html#L1128" title="Defined at 1128 in src/java/util/prefs/WindowsPreferences.java.">logger</a> =
<a id="L254" name="L254"></a> 254         <strong class="reserved">new</strong> <a href="../S/6492.html#L30" title="Defined at 30 in src/com/sun/jmx/remote/util/ClassLogger.java.">ClassLogger</a>("javax.management.remote.misc", LOGIN_CONFIG_NAME);
<a id="L255" name="L255"></a> 255 
<div class="comment">
  This callback handler supplies the username and password (which was
  originally supplied by the JMX user) to the JAAS login module performing
  the authentication. No interactive user prompting is required because the
  credentials are already available to this class (via its enclosing class).</div>
<a id="L262" name="L262"></a> 262 <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/4191.html" title="Multiple referred from 2 places.">JMXCallbackHandler</a> <strong class="reserved">implements</strong> <a href="../S/2659.html#L68" title="Defined at 68 in src/javax/security/auth/callback/CallbackHandler.java.">CallbackHandler</a> <em class="brace">{</em>
<a id="L263" name="L263"></a> 263 
<div class="comment">
      Sets the username and password in the appropriate Callback object.</div>
<a id="L267" name="L267"></a> 267     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/20059.html" title="Multiple referred from 158 places.">handle</a>(<a href="../D/1261.html" title="Multiple defined in 2 places.">Callback</a>[] callbacks)
<a id="L268" name="L268"></a> 268         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/2652.html#L33" title="Defined at 33 in src/javax/security/auth/callback/UnsupportedCallbackException.java.">UnsupportedCallbackException</a> <em class="brace">{</em>
<a id="L269" name="L269"></a> 269 
<a id="L270" name="L270"></a> 270         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; callbacks.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L271" name="L271"></a> 271             <strong class="reserved">if</strong> (callbacks[i] <strong class="reserved">instanceof</strong> <a href="../S/2650.html#L35" title="Defined at 35 in src/javax/security/auth/callback/NameCallback.java.">NameCallback</a>) <em class="brace">{</em>
<a id="L272" name="L272"></a> 272                 ((<a href="../S/2650.html#L35" title="Defined at 35 in src/javax/security/auth/callback/NameCallback.java.">NameCallback</a>)callbacks[i]).<a href="../D/33314.html" title="Multiple defined in 37 places.">setName</a>(username);
<a id="L273" name="L273"></a> 273 
<a id="L274" name="L274"></a> 274             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (callbacks[i] <strong class="reserved">instanceof</strong> <a href="../S/2651.html#L35" title="Defined at 35 in src/javax/security/auth/callback/PasswordCallback.java.">PasswordCallback</a>) <em class="brace">{</em>
<a id="L275" name="L275"></a> 275                 ((<a href="../S/2651.html#L35" title="Defined at 35 in src/javax/security/auth/callback/PasswordCallback.java.">PasswordCallback</a>)callbacks[i])
<a id="L276" name="L276"></a> 276                     .<a href="../D/33524.html" title="Multiple defined in 3 places.">setPassword</a>(password.<a href="../D/35368.html" title="Multiple defined in 3 places.">toCharArray</a>());
<a id="L277" name="L277"></a> 277 
<a id="L278" name="L278"></a> 278             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L279" name="L279"></a> 279                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2652.html#L33" title="Defined at 33 in src/javax/security/auth/callback/UnsupportedCallbackException.java.">UnsupportedCallbackException</a>
<a id="L280" name="L280"></a> 280                     (callbacks[i], "Unrecognized Callback");
<a id="L281" name="L281"></a> 281             <em class="brace">}</em>
<a id="L282" name="L282"></a> 282         <em class="brace">}</em>
<a id="L283" name="L283"></a> 283     <em class="brace">}</em>
<a id="L284" name="L284"></a> 284 <em class="brace">}</em>
<a id="L285" name="L285"></a> 285 
<div class="comment">
  This class defines the JAAS configuration for file-based authentication.
  It is equivalent to the following textual configuration entry:
  <pre>      JMXPluggableAuthenticator {
          com.sun.jmx.remote.security.FileLoginModule required;
      };
  </pre></div>
<a id="L295" name="L295"></a> 295 <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> <a href="../S/6500.html#L125" title="Referred from 125 in src/com/sun/jmx/remote/security/JMXPluggableAuthenticator.java.">FileLoginConfig</a> <strong class="reserved">extends</strong> <a href="../S/2667.html#L188" title="Defined at 188 in src/javax/security/auth/login/Configuration.java.">Configuration</a> <em class="brace">{</em>
<a id="L296" name="L296"></a> 296 
<a id="L297" name="L297"></a> 297     <em class="comment">// The JAAS configuration for file-based authentication</em>
<a id="L298" name="L298"></a> 298     <strong class="reserved">private</strong> <a href="../S/2674.html#L44" title="Defined at 44 in src/javax/security/auth/login/AppConfigurationEntry.java.">AppConfigurationEntry</a>[] <a href="../D/15643.html" title="Multiple defined in 6 places.">entries</a>;
<a id="L299" name="L299"></a> 299 
<a id="L300" name="L300"></a> 300     <em class="comment">// The classname of the login module for file-based authentication</em>
<a id="L301" name="L301"></a> 301     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> FILE_LOGIN_MODULE =
<a id="L302" name="L302"></a> 302         <a href="../S/6495.html#L111" title="Defined at 111 in src/com/sun/jmx/remote/security/FileLoginModule.java.">FileLoginModule</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L303" name="L303"></a> 303 
<a id="L304" name="L304"></a> 304     <em class="comment">// The option that identifies the password file to use</em>
<a id="L305" name="L305"></a> 305     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> PASSWORD_FILE_OPTION = "passwordFile";
<a id="L306" name="L306"></a> 306 
<div class="comment">
      Creates an instance of <code>FileLoginConfig</code>
      @param passwordFile A filepath that identifies the password file to use.
                          If null then the default password file is used.</div>
<a id="L313" name="L313"></a> 313     <strong class="reserved">public</strong> FileLoginConfig(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> passwordFile) <em class="brace">{</em>
<a id="L314" name="L314"></a> 314 
<a id="L315" name="L315"></a> 315         <a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; <a href="../S/7709.html#L57" title="Defined at 57 in src/com/sun/javadoc/RootDoc.java.">options</a>;
<a id="L316" name="L316"></a> 316         <strong class="reserved">if</strong> (passwordFile != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L317" name="L317"></a> 317             <a href="../S/7709.html#L57" title="Defined at 57 in src/com/sun/javadoc/RootDoc.java.">options</a> = <strong class="reserved">new</strong> <a href="../S/867.html#L137" title="Defined at 137 in src/java/util/HashMap.java.">HashMap</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt;(1);
<a id="L318" name="L318"></a> 318             <a href="../S/7709.html#L57" title="Defined at 57 in src/com/sun/javadoc/RootDoc.java.">options</a>.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(PASSWORD_FILE_OPTION, passwordFile);
<a id="L319" name="L319"></a> 319         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L320" name="L320"></a> 320             <a href="../S/7709.html#L57" title="Defined at 57 in src/com/sun/javadoc/RootDoc.java.">options</a> = <a href="../S/1147.html#L80" title="Defined at 80 in src/java/util/Collections.java.">Collections</a>.<a href="../S/1147.html#L4519" title="Defined at 4519 in src/java/util/Collections.java.">emptyMap</a>();
<a id="L321" name="L321"></a> 321         <em class="brace">}</em>
<a id="L322" name="L322"></a> 322 
<a id="L323" name="L323"></a> 323         <a href="../D/15643.html" title="Multiple defined in 6 places.">entries</a> = <strong class="reserved">new</strong> <a href="../S/2674.html#L44" title="Defined at 44 in src/javax/security/auth/login/AppConfigurationEntry.java.">AppConfigurationEntry</a>[] <em class="brace">{</em>
<a id="L324" name="L324"></a> 324             <strong class="reserved">new</strong> <a href="../S/2674.html#L44" title="Defined at 44 in src/javax/security/auth/login/AppConfigurationEntry.java.">AppConfigurationEntry</a>(FILE_LOGIN_MODULE,
<a id="L325" name="L325"></a> 325                 <a href="../S/2674.html#L44" title="Defined at 44 in src/javax/security/auth/login/AppConfigurationEntry.java.">AppConfigurationEntry</a>.<a href="../S/2674.html#L127" title="Defined at 127 in src/javax/security/auth/login/AppConfigurationEntry.java.">LoginModuleControlFlag</a>.REQUIRED,
<a id="L326" name="L326"></a> 326                     <a href="../S/7709.html#L57" title="Defined at 57 in src/com/sun/javadoc/RootDoc.java.">options</a>)
<a id="L327" name="L327"></a> 327         <em class="brace">}</em>;
<a id="L328" name="L328"></a> 328     <em class="brace">}</em>
<a id="L329" name="L329"></a> 329 
<div class="comment">
      Gets the JAAS configuration for file-based authentication</div>
<a id="L333" name="L333"></a> 333     <strong class="reserved">public</strong> <a href="../S/2674.html#L44" title="Defined at 44 in src/javax/security/auth/login/AppConfigurationEntry.java.">AppConfigurationEntry</a>[] <a href="../R/15084.html" title="Multiple referred from 2 places.">getAppConfigurationEntry</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>) <em class="brace">{</em>
<a id="L334" name="L334"></a> 334 
<a id="L335" name="L335"></a> 335         <strong class="reserved">return</strong> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(LOGIN_CONFIG_NAME) ? <a href="../D/15643.html" title="Multiple defined in 6 places.">entries</a> : <strong class="reserved">null</strong>;
<a id="L336" name="L336"></a> 336     <em class="brace">}</em>
<a id="L337" name="L337"></a> 337 
<div class="comment">
      Refreshes the configuration.</div>
<a id="L341" name="L341"></a> 341     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25739.html" title="Multiple referred from 7 places.">refresh</a>() <em class="brace">{</em>
<a id="L342" name="L342"></a> 342         <em class="comment">// the configuration is fixed</em>
<a id="L343" name="L343"></a> 343     <em class="brace">}</em>
<a id="L344" name="L344"></a> 344 <em class="brace">}</em>
<a id="L345" name="L345"></a> 345 
<a id="L346" name="L346"></a> 346 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L157">[^]</a><a href="#L341">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>