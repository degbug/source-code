<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/javax/swing/text/WrappedPlainView.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L83">[^]</a><a href="#L839">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L83" title="Defined at 83.">getTabSize</a></li>
<li><a href="#L104" title="Defined at 104.">drawLine</a></li>
<li><a href="#L128" title="Defined at 128.">drawText</a></li>
<li><a href="#L175" title="Defined at 175.">drawUnselectedText</a></li>
<li><a href="#L200" title="Defined at 200.">drawSelectedText</a></li>
<li><a href="#L217" title="Defined at 217.">getLineBuffer</a></li>
<li><a href="#L232" title="Defined at 232.">calculateBreakPosition</a></li>
<li><a href="#L260" title="Defined at 260.">loadChildren</a></li>
<li><a href="#L276" title="Defined at 276.">updateChildren</a></li>
<li><a href="#L306" title="Defined at 306.">loadText</a></li>
<li><a href="#L315" title="Defined at 315.">updateMetrics</a></li>
<li><a href="#L334" title="Defined at 334.">nextTabStop</a></li>
<li><a href="#L355" title="Defined at 355.">paint</a></li>
<li><a href="#L380" title="Defined at 380.">setSize</a></li>
<li><a href="#L407" title="Defined at 407.">getPreferredSpan</a></li>
<li><a href="#L427" title="Defined at 427.">getMinimumSpan</a></li>
<li><a href="#L447" title="Defined at 447.">getMaximumSpan</a></li>
<li><a href="#L462" title="Defined at 462.">insertUpdate</a></li>
<li><a href="#L484" title="Defined at 484.">removeUpdate</a></li>
<li><a href="#L505" title="Defined at 505.">changedUpdate</a></li>
<li><a href="#L549" title="Defined at 549.">getPreferredSpan</a></li>
<li><a href="#L578" title="Defined at 578.">paint</a></li>
<li><a href="#L619" title="Defined at 619.">modelToView</a></li>
<li><a href="#L663" title="Defined at 663.">viewToModel</a></li>
<li><a href="#L722" title="Defined at 722.">insertUpdate</a></li>
<li><a href="#L726" title="Defined at 726.">removeUpdate</a></li>
<li><a href="#L730" title="Defined at 730.">update</a></li>
<li><a href="#L748" title="Defined at 748.">getLineEnds</a></li>
<li><a href="#L767" title="Defined at 767.">breakLines</a></li>
<li><a href="#L828" title="Defined at 828.">findLine</a></li>
<li><a href="#L839" title="Defined at 839.">findLine</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1998, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 <strong class="reserved">package</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.swing.<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>;
<a id="L26" name="L26"></a>  26 
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.awt.*;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.lang.ref.SoftReference;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> javax.swing.event.*;
<a id="L30" name="L30"></a>  30 
<div class="comment">
  View of plain text (text with only one font and color)
  that does line-wrapping.  This view expects that its
  associated element has child elements that represent
  the lines it should be wrapping.  It is implemented
  as a vertical box that contains logical line views.
  The logical line views are nested classes that render
  the logical line as multiple physical line if the logical
  line is too wide to fit within the allocation.  The
  line views draw upon the outer class for its state
  to reduce their memory requirements.
  <p>
  The line views do all of their rendering through the
  <code>drawLine</code> method which in turn does all of
  its rendering through the <code>drawSelectedText</code>
  and <code>drawUnselectedText</code> methods.  This
  enables subclasses to easily specialize the rendering
  without concern for the layout aspects.
  @author  Timothy Prinzing
  @see     View</p></div>
<a id="L53" name="L53"></a>  53 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/8871.html" title="Multiple referred from 5 places.">WrappedPlainView</a> <strong class="reserved">extends</strong> <a href="../S/3355.html#L61" title="Defined at 61 in src/javax/swing/text/BoxView.java.">BoxView</a> <strong class="reserved">implements</strong> <a href="../S/3341.html#L34" title="Defined at 34 in src/javax/swing/text/TabExpander.java.">TabExpander</a> <em class="brace">{</em>
<a id="L54" name="L54"></a>  54 
<div class="comment">
      Creates a new WrappedPlainView.  Lines will be wrapped
      on character boundaries.
      @param elem the element underlying the view</div>
<a id="L61" name="L61"></a>  61     <strong class="reserved">public</strong> WrappedPlainView(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem) <em class="brace">{</em>
<a id="L62" name="L62"></a>  62         <strong class="reserved">this</strong>(elem, <strong class="reserved">false</strong>);
<a id="L63" name="L63"></a>  63     <em class="brace">}</em>
<a id="L64" name="L64"></a>  64 
<div class="comment">
      Creates a new WrappedPlainView.  Lines can be wrapped on
      either character or word boundaries depending upon the
      setting of the wordWrap parameter.
      @param elem the element underlying the view
      @param wordWrap should lines be wrapped on word boundaries?</div>
<a id="L73" name="L73"></a>  73     <strong class="reserved">public</strong> WrappedPlainView(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem, <strong class="reserved">boolean</strong> wordWrap) <em class="brace">{</em>
<a id="L74" name="L74"></a>  74         <strong class="reserved">super</strong>(elem, Y_AXIS);
<a id="L75" name="L75"></a>  75         <strong class="reserved">this</strong>.wordWrap = wordWrap;
<a id="L76" name="L76"></a>  76     <em class="brace">}</em>
<a id="L77" name="L77"></a>  77 
<div class="comment">
      Returns the tab size set for the document, defaulting to 8.
      @return the tab size</div>
<a id="L83" name="L83"></a>  83     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/19365.html" title="Multiple referred from 3 places.">getTabSize</a>() <em class="brace">{</em>
<a id="L84" name="L84"></a>  84         <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a> i = (<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>) <a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>().<a href="../D/21720.html" title="Multiple defined in 77 places.">getProperty</a>(<a href="../S/3340.html#L59" title="Defined at 59 in src/javax/swing/text/PlainDocument.java.">PlainDocument</a>.tabSizeAttribute);
<a id="L85" name="L85"></a>  85         <strong class="reserved">int</strong> <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a> = (i != <strong class="reserved">null</strong>) ? i.<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>() : 8;
<a id="L86" name="L86"></a>  86         <strong class="reserved">return</strong> <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>;
<a id="L87" name="L87"></a>  87     <em class="brace">}</em>
<a id="L88" name="L88"></a>  88 
<div class="comment">
      Renders a line of text, suppressing whitespace at the end
      and expanding any tabs.  This is implemented to make calls
      to the methods <code>drawUnselectedText</code> and
      <code>drawSelectedText</code> so that the way selected and
      unselected text are rendered can be customized.
      @param p0 the starting document location to use &gt;= 0
      @param p1 the ending document location to use &gt;= p1
      @param g the graphics context
      @param x the starting X position &gt;= 0
      @param y the starting Y position &gt;= 0
      @see #drawUnselectedText
      @see #drawSelectedText</div>
<a id="L104" name="L104"></a> 104     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/13556.html" title="Multiple referred from 1513 places.">drawLine</a>(<strong class="reserved">int</strong> p0, <strong class="reserved">int</strong> p1, <a href="../S/2313.html#L104" title="Defined at 104 in src/java/awt/Graphics.java.">Graphics</a> g, <strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">int</strong> y) <em class="brace">{</em>
<a id="L105" name="L105"></a> 105         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> lineMap = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L106" name="L106"></a> 106         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> = lineMap.<a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>(lineMap.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(p0));
<a id="L107" name="L107"></a> 107         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem;
<a id="L108" name="L108"></a> 108 
<a id="L109" name="L109"></a> 109         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L110" name="L110"></a> 110             <strong class="reserved">if</strong> (<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/25780.html" title="Multiple defined in 13 places.">isLeaf</a>()) <em class="brace">{</em>
<a id="L111" name="L111"></a> 111                  <a href="../S/3247.html#L128" title="Defined at 128 in src/javax/swing/text/WrappedPlainView.java.">drawText</a>(<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>, p0, p1, g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y);
<a id="L112" name="L112"></a> 112             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L113" name="L113"></a> 113                 <em class="comment">// this line contains the composed text.</em>
<a id="L114" name="L114"></a> 114                 <strong class="reserved">int</strong> idx = <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(p0);
<a id="L115" name="L115"></a> 115                 <strong class="reserved">int</strong> lastIdx = <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(p1);
<a id="L116" name="L116"></a> 116                 <strong class="reserved">for</strong>(; idx &lt;= lastIdx; idx++) <em class="brace">{</em>
<a id="L117" name="L117"></a> 117                     elem = <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>(idx);
<a id="L118" name="L118"></a> 118                     <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(elem.<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>(), p0);
<a id="L119" name="L119"></a> 119                     <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(elem.<a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>(), p1);
<a id="L120" name="L120"></a> 120                     <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../S/3247.html#L128" title="Defined at 128 in src/javax/swing/text/WrappedPlainView.java.">drawText</a>(elem, <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>, g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y);
<a id="L121" name="L121"></a> 121                 <em class="brace">}</em>
<a id="L122" name="L122"></a> 122             <em class="brace">}</em>
<a id="L123" name="L123"></a> 123         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> e) <em class="brace">{</em>
<a id="L124" name="L124"></a> 124             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3266.html#L34" title="Defined at 34 in src/javax/swing/text/StateInvariantError.java.">StateInvariantError</a>("Can't render: " + p0 + "," + p1);
<a id="L125" name="L125"></a> 125         <em class="brace">}</em>
<a id="L126" name="L126"></a> 126     <em class="brace">}</em>
<a id="L127" name="L127"></a> 127 
<a id="L128" name="L128"></a> 128     <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/13573.html" title="Multiple referred from 2 places.">drawText</a>(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem, <strong class="reserved">int</strong> p0, <strong class="reserved">int</strong> p1, <a href="../S/2313.html#L104" title="Defined at 104 in src/java/awt/Graphics.java.">Graphics</a> g, <strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">int</strong> y) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L129" name="L129"></a> 129         p1 = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(<a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>().<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>(), p1);
<a id="L130" name="L130"></a> 130         <a href="../D/585.html" title="Multiple defined in 3 places.">AttributeSet</a> <a href="../D/11626.html" title="Multiple defined in 2 places.">attr</a> = elem.<a href="../D/17112.html" title="Multiple defined in 109 places.">getAttributes</a>();
<a id="L131" name="L131"></a> 131 
<a id="L132" name="L132"></a> 132         <strong class="reserved">if</strong> (<a href="../S/3270.html#L52" title="Defined at 52 in src/javax/swing/text/Utilities.java.">Utilities</a>.<a href="../S/3270.html#L874" title="Defined at 874 in src/javax/swing/text/Utilities.java.">isComposedTextAttributeDefined</a>(<a href="../D/11626.html" title="Multiple defined in 2 places.">attr</a>)) <em class="brace">{</em>
<a id="L133" name="L133"></a> 133             g.<a href="../D/32183.html" title="Multiple defined in 19 places.">setColor</a>(unselected);
<a id="L134" name="L134"></a> 134             <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../S/3270.html#L52" title="Defined at 52 in src/javax/swing/text/Utilities.java.">Utilities</a>.<a href="../S/3270.html#L891" title="Defined at 891 in src/javax/swing/text/Utilities.java.">drawComposedText</a>(<strong class="reserved">this</strong>, <a href="../D/11626.html" title="Multiple defined in 2 places.">attr</a>, g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y,
<a id="L135" name="L135"></a> 135                                         p0-elem.<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>(),
<a id="L136" name="L136"></a> 136                                         p1-elem.<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>());
<a id="L137" name="L137"></a> 137         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L138" name="L138"></a> 138             <strong class="reserved">if</strong> (sel0 == sel1 || selected == unselected) <em class="brace">{</em>
<a id="L139" name="L139"></a> 139                 <em class="comment">// no selection, or it is invisible</em>
<a id="L140" name="L140"></a> 140                 <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15227.html" title="Multiple defined in 3 places.">drawUnselectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, p0, p1);
<a id="L141" name="L141"></a> 141             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((p0 &gt;= sel0 &amp;&amp; p0 &lt;= sel1) &amp;&amp; (p1 &gt;= sel0 &amp;&amp; p1 &lt;= sel1)) <em class="brace">{</em>
<a id="L142" name="L142"></a> 142                 <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15216.html" title="Multiple defined in 3 places.">drawSelectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, p0, p1);
<a id="L143" name="L143"></a> 143             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (sel0 &gt;= p0 &amp;&amp; sel0 &lt;= p1) <em class="brace">{</em>
<a id="L144" name="L144"></a> 144                 <strong class="reserved">if</strong> (sel1 &gt;= p0 &amp;&amp; sel1 &lt;= p1) <em class="brace">{</em>
<a id="L145" name="L145"></a> 145                     <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15227.html" title="Multiple defined in 3 places.">drawUnselectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, p0, sel0);
<a id="L146" name="L146"></a> 146                     <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15216.html" title="Multiple defined in 3 places.">drawSelectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, sel0, sel1);
<a id="L147" name="L147"></a> 147                     <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15227.html" title="Multiple defined in 3 places.">drawUnselectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, sel1, p1);
<a id="L148" name="L148"></a> 148                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L149" name="L149"></a> 149                     <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15227.html" title="Multiple defined in 3 places.">drawUnselectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, p0, sel0);
<a id="L150" name="L150"></a> 150                     <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15216.html" title="Multiple defined in 3 places.">drawSelectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, sel0, p1);
<a id="L151" name="L151"></a> 151                 <em class="brace">}</em>
<a id="L152" name="L152"></a> 152             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (sel1 &gt;= p0 &amp;&amp; sel1 &lt;= p1) <em class="brace">{</em>
<a id="L153" name="L153"></a> 153                 <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15216.html" title="Multiple defined in 3 places.">drawSelectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, p0, sel1);
<a id="L154" name="L154"></a> 154                 <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15227.html" title="Multiple defined in 3 places.">drawUnselectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, sel1, p1);
<a id="L155" name="L155"></a> 155             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L156" name="L156"></a> 156                 <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = <a href="../D/15227.html" title="Multiple defined in 3 places.">drawUnselectedText</a>(g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, p0, p1);
<a id="L157" name="L157"></a> 157             <em class="brace">}</em>
<a id="L158" name="L158"></a> 158         <em class="brace">}</em>
<a id="L159" name="L159"></a> 159 
<a id="L160" name="L160"></a> 160         <strong class="reserved">return</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L161" name="L161"></a> 161     <em class="brace">}</em>
<a id="L162" name="L162"></a> 162 
<div class="comment">
      Renders the given range in the model as normal unselected
      text.
      @param g the graphics context
      @param x the starting X coordinate &gt;= 0
      @param y the starting Y coordinate &gt;= 0
      @param p0 the beginning position in the model &gt;= 0
      @param p1 the ending position in the model &gt;= p0
      @return the X location of the end of the range &gt;= 0
      @exception BadLocationException if the range is invalid</div>
<a id="L175" name="L175"></a> 175     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/13578.html" title="Multiple referred from 13 places.">drawUnselectedText</a>(<a href="../S/2313.html#L104" title="Defined at 104 in src/java/awt/Graphics.java.">Graphics</a> g, <strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">int</strong> y,
<a id="L176" name="L176"></a> 176                                      <strong class="reserved">int</strong> p0, <strong class="reserved">int</strong> p1) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L177" name="L177"></a> 177         g.<a href="../D/32183.html" title="Multiple defined in 19 places.">setColor</a>(unselected);
<a id="L178" name="L178"></a> 178         <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = <a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>();
<a id="L179" name="L179"></a> 179         <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> segment = <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L65" title="Defined at 65 in src/javax/swing/text/SegmentCache.java.">getSharedSegment</a>();
<a id="L180" name="L180"></a> 180         doc.<a href="../D/23044.html" title="Multiple defined in 43 places.">getText</a>(p0, p1 - p0, segment);
<a id="L181" name="L181"></a> 181         <strong class="reserved">int</strong> ret = <a href="../S/3270.html#L52" title="Defined at 52 in src/javax/swing/text/Utilities.java.">Utilities</a>.<a href="../D/15221.html" title="Multiple defined in 3 places.">drawTabbedText</a>(<strong class="reserved">this</strong>, segment, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, g, <strong class="reserved">this</strong>, p0);
<a id="L182" name="L182"></a> 182         <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L73" title="Defined at 73 in src/javax/swing/text/SegmentCache.java.">releaseSharedSegment</a>(segment);
<a id="L183" name="L183"></a> 183         <strong class="reserved">return</strong> ret;
<a id="L184" name="L184"></a> 184     <em class="brace">}</em>
<a id="L185" name="L185"></a> 185 
<div class="comment">
      Renders the given range in the model as selected text.  This
      is implemented to render the text in the color specified in
      the hosting component.  It assumes the highlighter will render
      the selected background.
      @param g the graphics context
      @param x the starting X coordinate &gt;= 0
      @param y the starting Y coordinate &gt;= 0
      @param p0 the beginning position in the model &gt;= 0
      @param p1 the ending position in the model &gt;= p0
      @return the location of the end of the range.
      @exception BadLocationException if the range is invalid</div>
<a id="L200" name="L200"></a> 200     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/13567.html" title="Multiple referred from 9 places.">drawSelectedText</a>(<a href="../S/2313.html#L104" title="Defined at 104 in src/java/awt/Graphics.java.">Graphics</a> g, <strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>,
<a id="L201" name="L201"></a> 201                                    <strong class="reserved">int</strong> y, <strong class="reserved">int</strong> p0, <strong class="reserved">int</strong> p1) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L202" name="L202"></a> 202         g.<a href="../D/32183.html" title="Multiple defined in 19 places.">setColor</a>(selected);
<a id="L203" name="L203"></a> 203         <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = <a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>();
<a id="L204" name="L204"></a> 204         <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> segment = <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L65" title="Defined at 65 in src/javax/swing/text/SegmentCache.java.">getSharedSegment</a>();
<a id="L205" name="L205"></a> 205         doc.<a href="../D/23044.html" title="Multiple defined in 43 places.">getText</a>(p0, p1 - p0, segment);
<a id="L206" name="L206"></a> 206         <strong class="reserved">int</strong> ret = <a href="../S/3270.html#L52" title="Defined at 52 in src/javax/swing/text/Utilities.java.">Utilities</a>.<a href="../D/15221.html" title="Multiple defined in 3 places.">drawTabbedText</a>(<strong class="reserved">this</strong>, segment, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, g, <strong class="reserved">this</strong>, p0);
<a id="L207" name="L207"></a> 207         <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L73" title="Defined at 73 in src/javax/swing/text/SegmentCache.java.">releaseSharedSegment</a>(segment);
<a id="L208" name="L208"></a> 208         <strong class="reserved">return</strong> ret;
<a id="L209" name="L209"></a> 209     <em class="brace">}</em>
<a id="L210" name="L210"></a> 210 
<div class="comment">
      Gives access to a buffer that can be used to fetch
      text from the associated document.
      @return the buffer</div>
<a id="L217" name="L217"></a> 217     <strong class="reserved">protected</strong> <strong class="reserved">final</strong> <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> getLineBuffer() <em class="brace">{</em>
<a id="L218" name="L218"></a> 218         <strong class="reserved">if</strong> (lineBuffer == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L219" name="L219"></a> 219             lineBuffer = <strong class="reserved">new</strong> <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a>();
<a id="L220" name="L220"></a> 220         <em class="brace">}</em>
<a id="L221" name="L221"></a> 221         <strong class="reserved">return</strong> lineBuffer;
<a id="L222" name="L222"></a> 222     <em class="brace">}</em>
<a id="L223" name="L223"></a> 223 
<div class="comment">
      This is called by the nested wrapped line
      views to determine the break location.  This can
      be reimplemented to alter the breaking behavior.
      It will either break at word or character boundaries
      depending upon the break argument given at
      construction.</div>
<a id="L232" name="L232"></a> 232     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../S/3247.html#L782" title="Referred from 782 in src/javax/swing/text/WrappedPlainView.java.">calculateBreakPosition</a>(<strong class="reserved">int</strong> p0, <strong class="reserved">int</strong> p1) <em class="brace">{</em>
<a id="L233" name="L233"></a> 233         <strong class="reserved">int</strong> p;
<a id="L234" name="L234"></a> 234         <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> segment = <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L65" title="Defined at 65 in src/javax/swing/text/SegmentCache.java.">getSharedSegment</a>();
<a id="L235" name="L235"></a> 235         <a href="../S/3247.html#L306" title="Defined at 306 in src/javax/swing/text/WrappedPlainView.java.">loadText</a>(segment, p0, p1);
<a id="L236" name="L236"></a> 236         <strong class="reserved">int</strong> currentWidth = <a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>();
<a id="L237" name="L237"></a> 237         <strong class="reserved">if</strong> (wordWrap) <em class="brace">{</em>
<a id="L238" name="L238"></a> 238             p = p0 + <a href="../S/3270.html#L52" title="Defined at 52 in src/javax/swing/text/Utilities.java.">Utilities</a>.<a href="../S/3270.html#L449" title="Defined at 449 in src/javax/swing/text/Utilities.java.">getBreakLocation</a>(segment, metrics,
<a id="L239" name="L239"></a> 239                                                 tabBase, tabBase + currentWidth,
<a id="L240" name="L240"></a> 240                                                 <strong class="reserved">this</strong>, p0);
<a id="L241" name="L241"></a> 241         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L242" name="L242"></a> 242             p = p0 + <a href="../S/3270.html#L52" title="Defined at 52 in src/javax/swing/text/Utilities.java.">Utilities</a>.<a href="../D/22970.html" title="Multiple defined in 4 places.">getTabbedTextOffset</a>(segment, metrics,
<a id="L243" name="L243"></a> 243                                                    tabBase, tabBase + currentWidth,
<a id="L244" name="L244"></a> 244                                                    <strong class="reserved">this</strong>, p0, <strong class="reserved">false</strong>);
<a id="L245" name="L245"></a> 245         <em class="brace">}</em>
<a id="L246" name="L246"></a> 246         <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L73" title="Defined at 73 in src/javax/swing/text/SegmentCache.java.">releaseSharedSegment</a>(segment);
<a id="L247" name="L247"></a> 247         <strong class="reserved">return</strong> p;
<a id="L248" name="L248"></a> 248     <em class="brace">}</em>
<a id="L249" name="L249"></a> 249 
<div class="comment">
      Loads all of the children to initialize the view.
      This is called by the <code>setParent</code> method.
      Subclasses can reimplement this to initialize their
      child views in a different manner.  The default
      implementation creates a child view for each
      child element.
      @param f the view factory</div>
<a id="L260" name="L260"></a> 260     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/22554.html" title="Multiple referred from 11 places.">loadChildren</a>(<a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L261" name="L261"></a> 261         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> e = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L262" name="L262"></a> 262         <strong class="reserved">int</strong> n = e.<a href="../D/18674.html" title="Multiple defined in 5 places.">getElementCount</a>();
<a id="L263" name="L263"></a> 263         <strong class="reserved">if</strong> (n &gt; 0) <em class="brace">{</em>
<a id="L264" name="L264"></a> 264             <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[] added = <strong class="reserved">new</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[n];
<a id="L265" name="L265"></a> 265             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L266" name="L266"></a> 266                 added[i] = <strong class="reserved">new</strong> <a href="../S/3247.html#L531" title="Defined at 531 in src/javax/swing/text/WrappedPlainView.java.">WrappedLine</a>(e.<a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>(i));
<a id="L267" name="L267"></a> 267             <em class="brace">}</em>
<a id="L268" name="L268"></a> 268             <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(0, 0, added);
<a id="L269" name="L269"></a> 269         <em class="brace">}</em>
<a id="L270" name="L270"></a> 270     <em class="brace">}</em>
<a id="L271" name="L271"></a> 271 
<div class="comment">
      Update the child views in response to a
      document event.</div>
<a id="L276" name="L276"></a> 276     <strong class="reserved">void</strong> <a href="../R/29832.html" title="Multiple referred from 6 places.">updateChildren</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) <em class="brace">{</em>
<a id="L277" name="L277"></a> 277         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L278" name="L278"></a> 278         <a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a>.<a href="../S/3381.html#L143" title="Defined at 143 in src/javax/swing/event/DocumentEvent.java.">ElementChange</a> ec = e.<a href="../D/17564.html" title="Multiple defined in 3 places.">getChange</a>(elem);
<a id="L279" name="L279"></a> 279         <strong class="reserved">if</strong> (ec != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L280" name="L280"></a> 280             <em class="comment">// the structure of this element changed.</em>
<a id="L281" name="L281"></a> 281             <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a>[] removedElems = ec.<a href="../D/17657.html" title="Multiple defined in 2 places.">getChildrenRemoved</a>();
<a id="L282" name="L282"></a> 282             <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a>[] addedElems = ec.<a href="../D/17656.html" title="Multiple defined in 2 places.">getChildrenAdded</a>();
<a id="L283" name="L283"></a> 283             <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[] added = <strong class="reserved">new</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[addedElems.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L284" name="L284"></a> 284             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; addedElems.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L285" name="L285"></a> 285                 added[i] = <strong class="reserved">new</strong> <a href="../S/3247.html#L531" title="Defined at 531 in src/javax/swing/text/WrappedPlainView.java.">WrappedLine</a>(addedElems[i]);
<a id="L286" name="L286"></a> 286             <em class="brace">}</em>
<a id="L287" name="L287"></a> 287             <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(ec.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>(), removedElems.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>, added);
<a id="L288" name="L288"></a> 288 
<a id="L289" name="L289"></a> 289             <em class="comment">// should damge a little more intelligently.</em>
<a id="L290" name="L290"></a> 290             <strong class="reserved">if</strong> (<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L291" name="L291"></a> 291                 <a href="../D/29542.html" title="Multiple defined in 7 places.">preferenceChanged</a>(<strong class="reserved">null</strong>, <strong class="reserved">true</strong>, <strong class="reserved">true</strong>);
<a id="L292" name="L292"></a> 292                 <a href="../D/17946.html" title="Multiple defined in 9 places.">getContainer</a>().<a href="../D/31014.html" title="Multiple defined in 22 places.">repaint</a>();
<a id="L293" name="L293"></a> 293             <em class="brace">}</em>
<a id="L294" name="L294"></a> 294         <em class="brace">}</em>
<a id="L295" name="L295"></a> 295 
<a id="L296" name="L296"></a> 296         <em class="comment">// update font metrics which may be used by the child views</em>
<a id="L297" name="L297"></a> 297         <a href="../D/36161.html" title="Multiple defined in 2 places.">updateMetrics</a>();
<a id="L298" name="L298"></a> 298     <em class="brace">}</em>
<a id="L299" name="L299"></a> 299 
<div class="comment">
      Load the text buffer with the given range
      of text.  This is used by the fragments
      broken off of this view as well as this
      view itself.</div>
<a id="L306" name="L306"></a> 306     <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/22634.html" title="Multiple referred from 3 places.">loadText</a>(<a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> segment, <strong class="reserved">int</strong> p0, <strong class="reserved">int</strong> p1) <em class="brace">{</em>
<a id="L307" name="L307"></a> 307         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L308" name="L308"></a> 308             <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = <a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>();
<a id="L309" name="L309"></a> 309             doc.<a href="../D/23044.html" title="Multiple defined in 43 places.">getText</a>(p0, p1 - p0, segment);
<a id="L310" name="L310"></a> 310         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> bl) <em class="brace">{</em>
<a id="L311" name="L311"></a> 311             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3266.html#L34" title="Defined at 34 in src/javax/swing/text/StateInvariantError.java.">StateInvariantError</a>("Can't get line text");
<a id="L312" name="L312"></a> 312         <em class="brace">}</em>
<a id="L313" name="L313"></a> 313     <em class="brace">}</em>
<a id="L314" name="L314"></a> 314 
<a id="L315" name="L315"></a> 315     <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/29917.html" title="Multiple referred from 10 places.">updateMetrics</a>() <em class="brace">{</em>
<a id="L316" name="L316"></a> 316         <a href="../S/2177.html#L186" title="Defined at 186 in src/java/awt/Component.java.">Component</a> host = <a href="../D/17946.html" title="Multiple defined in 9 places.">getContainer</a>();
<a id="L317" name="L317"></a> 317         <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> f = host.<a href="../D/19178.html" title="Multiple defined in 44 places.">getFont</a>();
<a id="L318" name="L318"></a> 318         metrics = host.<a href="../D/19185.html" title="Multiple defined in 25 places.">getFontMetrics</a>(f);
<a id="L319" name="L319"></a> 319         tabSize = <a href="../D/22967.html" title="Multiple defined in 3 places.">getTabSize</a>() * metrics.<a href="../D/12333.html" title="Multiple defined in 2 places.">charWidth</a>('m');
<a id="L320" name="L320"></a> 320     <em class="brace">}</em>
<a id="L321" name="L321"></a> 321 
<a id="L322" name="L322"></a> 322     <em class="comment">// --- TabExpander methods ------------------------------------------</em>
<a id="L323" name="L323"></a> 323 
<div class="comment">
      Returns the next tab stop position after a given reference position.
      This implementation does not support things like centering so it
      ignores the tabOffset argument.
      @param x the current position &gt;= 0
      @param tabOffset the position within the text stream
        that the tab occurred at &gt;= 0.
      @return the tab stop, measured in points &gt;= 0</div>
<a id="L334" name="L334"></a> 334     <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/23698.html" title="Multiple referred from 4 places.">nextTabStop</a>(<strong class="reserved">float</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">int</strong> tabOffset) <em class="brace">{</em>
<a id="L335" name="L335"></a> 335         <strong class="reserved">if</strong> (tabSize == 0)
<a id="L336" name="L336"></a> 336             <strong class="reserved">return</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L337" name="L337"></a> 337         <strong class="reserved">int</strong> ntabs = ((<strong class="reserved">int</strong>) <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> - tabBase) / tabSize;
<a id="L338" name="L338"></a> 338         <strong class="reserved">return</strong> tabBase + ((ntabs + 1) * tabSize);
<a id="L339" name="L339"></a> 339     <em class="brace">}</em>
<a id="L340" name="L340"></a> 340 
<a id="L341" name="L341"></a> 341 
<a id="L342" name="L342"></a> 342     <em class="comment">// --- View methods -------------------------------------</em>
<a id="L343" name="L343"></a> 343 
<div class="comment">
      Renders using the given rendering surface and area
      on that surface.  This is implemented to stash the
      selection positions, selection colors, and font
      metrics for the nested lines to use.
      @param g the rendering surface to use
      @param a the allocated region to render into
      @see View#paint</div>
<a id="L355" name="L355"></a> 355     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/24094.html" title="Multiple referred from 414 places.">paint</a>(<a href="../S/2313.html#L104" title="Defined at 104 in src/java/awt/Graphics.java.">Graphics</a> g, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) <em class="brace">{</em>
<a id="L356" name="L356"></a> 356         <a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a> alloc = (<a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a>) <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>;
<a id="L357" name="L357"></a> 357         tabBase = alloc.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L358" name="L358"></a> 358         <a href="../S/3351.html#L293" title="Defined at 293 in src/javax/swing/text/JTextComponent.java.">JTextComponent</a> host = (<a href="../S/3351.html#L293" title="Defined at 293 in src/javax/swing/text/JTextComponent.java.">JTextComponent</a>) <a href="../D/17946.html" title="Multiple defined in 9 places.">getContainer</a>();
<a id="L359" name="L359"></a> 359         sel0 = host.<a href="../D/22380.html" title="Multiple defined in 11 places.">getSelectionStart</a>();
<a id="L360" name="L360"></a> 360         sel1 = host.<a href="../D/22371.html" title="Multiple defined in 11 places.">getSelectionEnd</a>();
<a id="L361" name="L361"></a> 361         unselected = (host.<a href="../D/25496.html" title="Multiple defined in 50 places.">isEnabled</a>()) ?
<a id="L362" name="L362"></a> 362             host.<a href="../D/19200.html" title="Multiple defined in 21 places.">getForeground</a>() : host.<a href="../D/18507.html" title="Multiple defined in 4 places.">getDisabledTextColor</a>();
<a id="L363" name="L363"></a> 363         <a href="../D/1302.html" title="Multiple defined in 2 places.">Caret</a> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = host.<a href="../D/17495.html" title="Multiple defined in 4 places.">getCaret</a>();
<a id="L364" name="L364"></a> 364         selected = <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>.<a href="../D/26220.html" title="Multiple defined in 2 places.">isSelectionVisible</a>() &amp;&amp; host.<a href="../S/3351.html#L600" title="Defined at 600 in src/javax/swing/text/JTextComponent.java.">getHighlighter</a>() != <strong class="reserved">null</strong> ?
<a id="L365" name="L365"></a> 365                         host.<a href="../S/3351.html#L1256" title="Defined at 1256 in src/javax/swing/text/JTextComponent.java.">getSelectedTextColor</a>() : unselected;
<a id="L366" name="L366"></a> 366         g.<a href="../D/32750.html" title="Multiple defined in 25 places.">setFont</a>(host.<a href="../D/19178.html" title="Multiple defined in 44 places.">getFont</a>());
<a id="L367" name="L367"></a> 367 
<a id="L368" name="L368"></a> 368         <em class="comment">// superclass paints the children</em>
<a id="L369" name="L369"></a> 369         <strong class="reserved">super</strong>.<a href="../D/28657.html" title="Multiple defined in 228 places.">paint</a>(g, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L370" name="L370"></a> 370     <em class="brace">}</em>
<a id="L371" name="L371"></a> 371 
<div class="comment">
      Sets the size of the view.  This should cause
      layout of the view along the given axis, if it
      has any layout duties.
      @param width the width &gt;= 0
      @param height the height &gt;= 0</div>
<a id="L380" name="L380"></a> 380     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28186.html" title="Multiple referred from 157 places.">setSize</a>(<strong class="reserved">float</strong> <a href="../D/36863.html" title="Multiple defined in 3 places.">width</a>, <strong class="reserved">float</strong> <a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a>) <em class="brace">{</em>
<a id="L381" name="L381"></a> 381         <a href="../D/36161.html" title="Multiple defined in 2 places.">updateMetrics</a>();
<a id="L382" name="L382"></a> 382         <strong class="reserved">if</strong> ((<strong class="reserved">int</strong>) <a href="../D/36863.html" title="Multiple defined in 3 places.">width</a> != <a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>()) <em class="brace">{</em>
<a id="L383" name="L383"></a> 383             <em class="comment">// invalidate the view itself since the desired widths</em>
<a id="L384" name="L384"></a> 384             <em class="comment">// of the children will be based upon this views width.</em>
<a id="L385" name="L385"></a> 385             <a href="../D/29542.html" title="Multiple defined in 7 places.">preferenceChanged</a>(<strong class="reserved">null</strong>, <strong class="reserved">true</strong>, <strong class="reserved">true</strong>);
<a id="L386" name="L386"></a> 386             widthChanging = <strong class="reserved">true</strong>;
<a id="L387" name="L387"></a> 387         <em class="brace">}</em>
<a id="L388" name="L388"></a> 388         <strong class="reserved">super</strong>.<a href="../D/33924.html" title="Multiple defined in 54 places.">setSize</a>(<a href="../D/36863.html" title="Multiple defined in 3 places.">width</a>, <a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a>);
<a id="L389" name="L389"></a> 389         widthChanging = <strong class="reserved">false</strong>;
<a id="L390" name="L390"></a> 390     <em class="brace">}</em>
<a id="L391" name="L391"></a> 391 
<div class="comment">
      Determines the preferred span for this view along an
      axis.  This is implemented to provide the superclass
      behavior after first making sure that the current font
      metrics are cached (for the nested lines which use
      the metrics to determine the height of the potentially
      wrapped lines).
      @param axis may be either View.X_AXIS or View.Y_AXIS
      @return  the span the view would like to be rendered into.
                Typically the view is told to render into the span
                that is returned, although there is no guarantee.
                The parent may choose to resize or break the view.
      @see View#getPreferredSpan</div>
<a id="L407" name="L407"></a> 407     <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/18413.html" title="Multiple referred from 96 places.">getPreferredSpan</a>(<strong class="reserved">int</strong> axis) <em class="brace">{</em>
<a id="L408" name="L408"></a> 408         <a href="../D/36161.html" title="Multiple defined in 2 places.">updateMetrics</a>();
<a id="L409" name="L409"></a> 409         <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/21585.html" title="Multiple defined in 27 places.">getPreferredSpan</a>(axis);
<a id="L410" name="L410"></a> 410     <em class="brace">}</em>
<a id="L411" name="L411"></a> 411 
<div class="comment">
      Determines the minimum span for this view along an
      axis.  This is implemented to provide the superclass
      behavior after first making sure that the current font
      metrics are cached (for the nested lines which use
      the metrics to determine the height of the potentially
      wrapped lines).
      @param axis may be either View.X_AXIS or View.Y_AXIS
      @return  the span the view would like to be rendered into.
                Typically the view is told to render into the span
                that is returned, although there is no guarantee.
                The parent may choose to resize or break the view.
      @see View#getMinimumSpan</div>
<a id="L427" name="L427"></a> 427     <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/17741.html" title="Multiple referred from 44 places.">getMinimumSpan</a>(<strong class="reserved">int</strong> axis) <em class="brace">{</em>
<a id="L428" name="L428"></a> 428         <a href="../D/36161.html" title="Multiple defined in 2 places.">updateMetrics</a>();
<a id="L429" name="L429"></a> 429         <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/20667.html" title="Multiple defined in 20 places.">getMinimumSpan</a>(axis);
<a id="L430" name="L430"></a> 430     <em class="brace">}</em>
<a id="L431" name="L431"></a> 431 
<div class="comment">
      Determines the maximum span for this view along an
      axis.  This is implemented to provide the superclass
      behavior after first making sure that the current font
      metrics are cached (for the nested lines which use
      the metrics to determine the height of the potentially
      wrapped lines).
      @param axis may be either View.X_AXIS or View.Y_AXIS
      @return  the span the view would like to be rendered into.
                Typically the view is told to render into the span
                that is returned, although there is no guarantee.
                The parent may choose to resize or break the view.
      @see View#getMaximumSpan</div>
<a id="L447" name="L447"></a> 447     <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/17622.html" title="Multiple referred from 43 places.">getMaximumSpan</a>(<strong class="reserved">int</strong> axis) <em class="brace">{</em>
<a id="L448" name="L448"></a> 448         <a href="../D/36161.html" title="Multiple defined in 2 places.">updateMetrics</a>();
<a id="L449" name="L449"></a> 449         <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/20504.html" title="Multiple defined in 19 places.">getMaximumSpan</a>(axis);
<a id="L450" name="L450"></a> 450     <em class="brace">}</em>
<a id="L451" name="L451"></a> 451 
<div class="comment">
      Gives notification that something was inserted into the
      document in a location that this view is responsible for.
      This is implemented to simply update the children.
      @param e the change information from the associated document
      @param a the current allocation of the view
      @param f the factory to use to rebuild if the view has children
      @see View#insertUpdate</div>
<a id="L462" name="L462"></a> 462     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/20799.html" title="Multiple referred from 23 places.">insertUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L463" name="L463"></a> 463         <a href="../D/36069.html" title="Multiple defined in 6 places.">updateChildren</a>(e, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L464" name="L464"></a> 464 
<a id="L465" name="L465"></a> 465         <a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a> alloc = ((<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a> != <strong class="reserved">null</strong>) &amp;&amp; <a href="../S/3355.html#L609" title="Defined at 609 in src/javax/swing/text/BoxView.java.">isAllocationValid</a>()) ?
<a id="L466" name="L466"></a> 466             <a href="../S/3349.html#L608" title="Defined at 608 in src/javax/swing/text/CompositeView.java.">getInsideAllocation</a>(<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) : <strong class="reserved">null</strong>;
<a id="L467" name="L467"></a> 467         <strong class="reserved">int</strong> pos = e.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>();
<a id="L468" name="L468"></a> 468         <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> v = <a href="../D/23599.html" title="Multiple defined in 5 places.">getViewAtPosition</a>(pos, alloc);
<a id="L469" name="L469"></a> 469         <strong class="reserved">if</strong> (v != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L470" name="L470"></a> 470             v.<a href="../D/24781.html" title="Multiple defined in 28 places.">insertUpdate</a>(e, alloc, f);
<a id="L471" name="L471"></a> 471         <em class="brace">}</em>
<a id="L472" name="L472"></a> 472     <em class="brace">}</em>
<a id="L473" name="L473"></a> 473 
<div class="comment">
      Gives notification that something was removed from the
      document in a location that this view is responsible for.
      This is implemented to simply update the children.
      @param e the change information from the associated document
      @param a the current allocation of the view
      @param f the factory to use to rebuild if the view has children
      @see View#removeUpdate</div>
<a id="L484" name="L484"></a> 484     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26095.html" title="Multiple referred from 20 places.">removeUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L485" name="L485"></a> 485         <a href="../D/36069.html" title="Multiple defined in 6 places.">updateChildren</a>(e, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L486" name="L486"></a> 486 
<a id="L487" name="L487"></a> 487         <a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a> alloc = ((<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a> != <strong class="reserved">null</strong>) &amp;&amp; <a href="../S/3355.html#L609" title="Defined at 609 in src/javax/swing/text/BoxView.java.">isAllocationValid</a>()) ?
<a id="L488" name="L488"></a> 488             <a href="../S/3349.html#L608" title="Defined at 608 in src/javax/swing/text/CompositeView.java.">getInsideAllocation</a>(<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) : <strong class="reserved">null</strong>;
<a id="L489" name="L489"></a> 489         <strong class="reserved">int</strong> pos = e.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>();
<a id="L490" name="L490"></a> 490         <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> v = <a href="../D/23599.html" title="Multiple defined in 5 places.">getViewAtPosition</a>(pos, alloc);
<a id="L491" name="L491"></a> 491         <strong class="reserved">if</strong> (v != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L492" name="L492"></a> 492             v.<a href="../D/30986.html" title="Multiple defined in 27 places.">removeUpdate</a>(e, alloc, f);
<a id="L493" name="L493"></a> 493         <em class="brace">}</em>
<a id="L494" name="L494"></a> 494     <em class="brace">}</em>
<a id="L495" name="L495"></a> 495 
<div class="comment">
      Gives notification from the document that attributes were changed
      in a location that this view is responsible for.
      @param e the change information from the associated document
      @param a the current allocation of the view
      @param f the factory to use to rebuild if the view has children
      @see View#changedUpdate</div>
<a id="L505" name="L505"></a> 505     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11034.html" title="Multiple referred from 17 places.">changedUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L506" name="L506"></a> 506         <a href="../D/36069.html" title="Multiple defined in 6 places.">updateChildren</a>(e, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L507" name="L507"></a> 507     <em class="brace">}</em>
<a id="L508" name="L508"></a> 508 
<a id="L509" name="L509"></a> 509     <em class="comment">// --- variables -------------------------------------------</em>
<a id="L510" name="L510"></a> 510 
<a id="L511" name="L511"></a> 511     <a href="../S/2386.html#L99" title="Defined at 99 in src/java/awt/FontMetrics.java.">FontMetrics</a> metrics;
<a id="L512" name="L512"></a> 512     <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> lineBuffer;
<a id="L513" name="L513"></a> 513     <strong class="reserved">boolean</strong> widthChanging;
<a id="L514" name="L514"></a> 514     <strong class="reserved">int</strong> tabBase;
<a id="L515" name="L515"></a> 515     <strong class="reserved">int</strong> tabSize;
<a id="L516" name="L516"></a> 516     <strong class="reserved">boolean</strong> wordWrap;
<a id="L517" name="L517"></a> 517 
<a id="L518" name="L518"></a> 518     <strong class="reserved">int</strong> sel0;
<a id="L519" name="L519"></a> 519     <strong class="reserved">int</strong> sel1;
<a id="L520" name="L520"></a> 520     <a href="../S/2447.html#L60" title="Defined at 60 in src/java/awt/Color.java.">Color</a> unselected;
<a id="L521" name="L521"></a> 521     <a href="../S/2447.html#L60" title="Defined at 60 in src/java/awt/Color.java.">Color</a> selected;
<a id="L522" name="L522"></a> 522 
<a id="L523" name="L523"></a> 523 
<div class="comment">
      Simple view of a line that wraps if it doesn't
      fit withing the horizontal space allocated.
      This class tries to be lightweight by carrying little
      state of it's own and sharing the state of the outer class
      with it's sibblings.</div>
<a id="L531" name="L531"></a> 531     <strong class="reserved">class</strong> <a href="../R/8869.html" title="Multiple referred from 2 places.">WrappedLine</a> <strong class="reserved">extends</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> <em class="brace">{</em>
<a id="L532" name="L532"></a> 532 
<a id="L533" name="L533"></a> 533         WrappedLine(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem) <em class="brace">{</em>
<a id="L534" name="L534"></a> 534             <strong class="reserved">super</strong>(elem);
<a id="L535" name="L535"></a> 535             lineCount = -1;
<a id="L536" name="L536"></a> 536         <em class="brace">}</em>
<a id="L537" name="L537"></a> 537 
<div class="comment">
          Determines the preferred span for this view along an
          axis.
          @param axis may be either X_AXIS or Y_AXIS
          @return   the span the view would like to be rendered into.
                    Typically the view is told to render into the span
                    that is returned, although there is no guarantee.
                    The parent may choose to resize or break the view.
          @see View#getPreferredSpan</div>
<a id="L549" name="L549"></a> 549         <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/18413.html" title="Multiple referred from 96 places.">getPreferredSpan</a>(<strong class="reserved">int</strong> axis) <em class="brace">{</em>
<a id="L550" name="L550"></a> 550             <strong class="reserved">switch</strong> (axis) <em class="brace">{</em>
<a id="L551" name="L551"></a> 551             <strong class="reserved">case</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>.X_AXIS:
<a id="L552" name="L552"></a> 552                 <strong class="reserved">float</strong> <a href="../D/36863.html" title="Multiple defined in 3 places.">width</a> = <a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>();
<a id="L553" name="L553"></a> 553                 <strong class="reserved">if</strong> (<a href="../D/36863.html" title="Multiple defined in 3 places.">width</a> == <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MAX_VALUE) <em class="brace">{</em>
<a id="L554" name="L554"></a> 554                     <em class="comment">// We have been initially set to MAX_VALUE, but we don't</em>
<a id="L555" name="L555"></a> 555                     <em class="comment">// want this as our preferred.</em>
<a id="L556" name="L556"></a> 556                     <strong class="reserved">return</strong> 100f;
<a id="L557" name="L557"></a> 557                 <em class="brace">}</em>
<a id="L558" name="L558"></a> 558                 <strong class="reserved">return</strong> <a href="../D/36863.html" title="Multiple defined in 3 places.">width</a>;
<a id="L559" name="L559"></a> 559             <strong class="reserved">case</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>.Y_AXIS:
<a id="L560" name="L560"></a> 560                 <strong class="reserved">if</strong> (lineCount &lt; 0 || widthChanging) <em class="brace">{</em>
<a id="L561" name="L561"></a> 561                     <a href="../S/3247.html#L767" title="Defined at 767 in src/javax/swing/text/WrappedPlainView.java.">breakLines</a>(<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>());
<a id="L562" name="L562"></a> 562                 <em class="brace">}</em>
<a id="L563" name="L563"></a> 563                 <strong class="reserved">return</strong> lineCount * metrics.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>();
<a id="L564" name="L564"></a> 564             <strong class="reserved">default</strong>:
<a id="L565" name="L565"></a> 565                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Invalid axis: " + axis);
<a id="L566" name="L566"></a> 566             <em class="brace">}</em>
<a id="L567" name="L567"></a> 567         <em class="brace">}</em>
<a id="L568" name="L568"></a> 568 
<div class="comment">
          Renders using the given rendering surface and area on that
          surface.  The view may need to do layout and create child
          views to enable itself to render into the given allocation.
          @param g the rendering surface to use
          @param a the allocated region to render into
          @see View#paint</div>
<a id="L578" name="L578"></a> 578         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/24094.html" title="Multiple referred from 414 places.">paint</a>(<a href="../S/2313.html#L104" title="Defined at 104 in src/java/awt/Graphics.java.">Graphics</a> g, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) <em class="brace">{</em>
<a id="L579" name="L579"></a> 579             <a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a> alloc = (<a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a>) <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>;
<a id="L580" name="L580"></a> 580             <strong class="reserved">int</strong> y = alloc.y + metrics.<a href="../D/17040.html" title="Multiple defined in 9 places.">getAscent</a>();
<a id="L581" name="L581"></a> 581             <strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = alloc.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L582" name="L582"></a> 582 
<a id="L583" name="L583"></a> 583             <a href="../S/3351.html#L293" title="Defined at 293 in src/javax/swing/text/JTextComponent.java.">JTextComponent</a> host = (<a href="../S/3351.html#L293" title="Defined at 293 in src/javax/swing/text/JTextComponent.java.">JTextComponent</a>)<a href="../D/17946.html" title="Multiple defined in 9 places.">getContainer</a>();
<a id="L584" name="L584"></a> 584             <a href="../S/3239.html#L37" title="Defined at 37 in src/javax/swing/text/Highlighter.java.">Highlighter</a> h = host.<a href="../S/3351.html#L600" title="Defined at 600 in src/javax/swing/text/JTextComponent.java.">getHighlighter</a>();
<a id="L585" name="L585"></a> 585             <a href="../S/3241.html#L36" title="Defined at 36 in src/javax/swing/text/LayeredHighlighter.java.">LayeredHighlighter</a> dh = (h <strong class="reserved">instanceof</strong> <a href="../S/3241.html#L36" title="Defined at 36 in src/javax/swing/text/LayeredHighlighter.java.">LayeredHighlighter</a>) ?
<a id="L586" name="L586"></a> 586                                      (<a href="../S/3241.html#L36" title="Defined at 36 in src/javax/swing/text/LayeredHighlighter.java.">LayeredHighlighter</a>)h : <strong class="reserved">null</strong>;
<a id="L587" name="L587"></a> 587 
<a id="L588" name="L588"></a> 588             <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = <a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>();
<a id="L589" name="L589"></a> 589             <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = <a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>();
<a id="L590" name="L590"></a> 590             <strong class="reserved">int</strong> p0 = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L591" name="L591"></a> 591             <strong class="reserved">int</strong>[] lineEnds = <a href="../S/3247.html#L748" title="Defined at 748 in src/javax/swing/text/WrappedPlainView.java.">getLineEnds</a>();
<a id="L592" name="L592"></a> 592             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; lineCount; i++) <em class="brace">{</em>
<a id="L593" name="L593"></a> 593                 <strong class="reserved">int</strong> p1 = (lineEnds == <strong class="reserved">null</strong>) ? <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> :
<a id="L594" name="L594"></a> 594                                              <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> + lineEnds[i];
<a id="L595" name="L595"></a> 595                 <strong class="reserved">if</strong> (dh != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L596" name="L596"></a> 596                     <strong class="reserved">int</strong> hOffset = (p1 == <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>)
<a id="L597" name="L597"></a> 597                                   ? (p1 - 1)
<a id="L598" name="L598"></a> 598                                   : p1;
<a id="L599" name="L599"></a> 599                     dh.<a href="../D/28848.html" title="Multiple defined in 3 places.">paintLayeredHighlights</a>(g, p0, hOffset, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, host, <strong class="reserved">this</strong>);
<a id="L600" name="L600"></a> 600                 <em class="brace">}</em>
<a id="L601" name="L601"></a> 601                 <a href="../D/15201.html" title="Multiple defined in 7 places.">drawLine</a>(p0, p1, g, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y);
<a id="L602" name="L602"></a> 602 
<a id="L603" name="L603"></a> 603                 p0 = p1;
<a id="L604" name="L604"></a> 604                 y += metrics.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>();
<a id="L605" name="L605"></a> 605             <em class="brace">}</em>
<a id="L606" name="L606"></a> 606         <em class="brace">}</em>
<a id="L607" name="L607"></a> 607 
<div class="comment">
          Provides a mapping from the document model coordinate space
          to the coordinate space of the view mapped to it.
          @param pos the position to convert
          @param a the allocated region to render into
          @return the bounding box of the given position is returned
          @exception BadLocationException  if the given position does not represent a
            valid location in the associated document
          @see View#modelToView</div>
<a id="L619" name="L619"></a> 619         <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../R/23332.html" title="Multiple referred from 109 places.">modelToView</a>(<strong class="reserved">int</strong> pos, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a> b)
<a id="L620" name="L620"></a> 620                 <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L621" name="L621"></a> 621             <a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a> alloc = <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>.<a href="../D/17335.html" title="Multiple defined in 41 places.">getBounds</a>();
<a id="L622" name="L622"></a> 622             alloc.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a> = metrics.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>();
<a id="L623" name="L623"></a> 623             alloc.<a href="../D/36863.html" title="Multiple defined in 3 places.">width</a> = 1;
<a id="L624" name="L624"></a> 624 
<a id="L625" name="L625"></a> 625             <strong class="reserved">int</strong> p0 = <a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>();
<a id="L626" name="L626"></a> 626             <strong class="reserved">if</strong> (pos &lt; p0 || pos &gt; <a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>()) <em class="brace">{</em>
<a id="L627" name="L627"></a> 627                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a>("Position out of range", pos);
<a id="L628" name="L628"></a> 628             <em class="brace">}</em>
<a id="L629" name="L629"></a> 629 
<a id="L630" name="L630"></a> 630             <strong class="reserved">int</strong> testP = (b == <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a>.Forward) ? pos :
<a id="L631" name="L631"></a> 631                         <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(p0, pos - 1);
<a id="L632" name="L632"></a> 632             <strong class="reserved">int</strong> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> = 0;
<a id="L633" name="L633"></a> 633             <strong class="reserved">int</strong>[] lineEnds = <a href="../S/3247.html#L748" title="Defined at 748 in src/javax/swing/text/WrappedPlainView.java.">getLineEnds</a>();
<a id="L634" name="L634"></a> 634             <strong class="reserved">if</strong> (lineEnds != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L635" name="L635"></a> 635                 <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> = <a href="../D/16159.html" title="Multiple defined in 2 places.">findLine</a>(testP - p0);
<a id="L636" name="L636"></a> 636                 <strong class="reserved">if</strong> (<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> &gt; 0) <em class="brace">{</em>
<a id="L637" name="L637"></a> 637                     p0 += lineEnds[<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> - 1];
<a id="L638" name="L638"></a> 638                 <em class="brace">}</em>
<a id="L639" name="L639"></a> 639                 alloc.y += alloc.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a> * <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>;
<a id="L640" name="L640"></a> 640             <em class="brace">}</em>
<a id="L641" name="L641"></a> 641 
<a id="L642" name="L642"></a> 642             <strong class="reserved">if</strong> (pos &gt; p0) <em class="brace">{</em>
<a id="L643" name="L643"></a> 643                 <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> segment = <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L65" title="Defined at 65 in src/javax/swing/text/SegmentCache.java.">getSharedSegment</a>();
<a id="L644" name="L644"></a> 644                 <a href="../S/3247.html#L306" title="Defined at 306 in src/javax/swing/text/WrappedPlainView.java.">loadText</a>(segment, p0, pos);
<a id="L645" name="L645"></a> 645                 alloc.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> += <a href="../S/3270.html#L52" title="Defined at 52 in src/javax/swing/text/Utilities.java.">Utilities</a>.<a href="../D/22971.html" title="Multiple defined in 2 places.">getTabbedTextWidth</a>(segment, metrics,
<a id="L646" name="L646"></a> 646                         alloc.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <a href="../S/3247.html#L53" title="Defined at 53 in src/javax/swing/text/WrappedPlainView.java.">WrappedPlainView</a>.<strong class="reserved">this</strong>, p0);
<a id="L647" name="L647"></a> 647                 <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L73" title="Defined at 73 in src/javax/swing/text/SegmentCache.java.">releaseSharedSegment</a>(segment);
<a id="L648" name="L648"></a> 648             <em class="brace">}</em>
<a id="L649" name="L649"></a> 649             <strong class="reserved">return</strong> alloc;
<a id="L650" name="L650"></a> 650         <em class="brace">}</em>
<a id="L651" name="L651"></a> 651 
<div class="comment">
          Provides a mapping from the view coordinate space to the logical
          coordinate space of the model.
          @param fx the X coordinate
          @param fy the Y coordinate
          @param a the allocated region to render into
          @return the location within the model that best represents the
           given point in the view
          @see View#viewToModel</div>
<a id="L663" name="L663"></a> 663         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/30138.html" title="Multiple referred from 99 places.">viewToModel</a>(<strong class="reserved">float</strong> fx, <strong class="reserved">float</strong> fy, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a>[] bias) <em class="brace">{</em>
<a id="L664" name="L664"></a> 664             <em class="comment">// PENDING(prinz) implement bias properly</em>
<a id="L665" name="L665"></a> 665             bias[0] = <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a>.Forward;
<a id="L666" name="L666"></a> 666 
<a id="L667" name="L667"></a> 667             <a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a> alloc = (<a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a>) <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>;
<a id="L668" name="L668"></a> 668             <strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = (<strong class="reserved">int</strong>) fx;
<a id="L669" name="L669"></a> 669             <strong class="reserved">int</strong> y = (<strong class="reserved">int</strong>) fy;
<a id="L670" name="L670"></a> 670             <strong class="reserved">if</strong> (y &lt; alloc.y) <em class="brace">{</em>
<a id="L671" name="L671"></a> 671                 <em class="comment">// above the area covered by this icon, so the the position</em>
<a id="L672" name="L672"></a> 672                 <em class="comment">// is assumed to be the start of the coverage for this view.</em>
<a id="L673" name="L673"></a> 673                 <strong class="reserved">return</strong> <a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>();
<a id="L674" name="L674"></a> 674             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (y &gt; alloc.y + alloc.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a>) <em class="brace">{</em>
<a id="L675" name="L675"></a> 675                 <em class="comment">// below the area covered by this icon, so the the position</em>
<a id="L676" name="L676"></a> 676                 <em class="comment">// is assumed to be the end of the coverage for this view.</em>
<a id="L677" name="L677"></a> 677                 <strong class="reserved">return</strong> <a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>() - 1;
<a id="L678" name="L678"></a> 678             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L679" name="L679"></a> 679                 <em class="comment">// positioned within the coverage of this view vertically,</em>
<a id="L680" name="L680"></a> 680                 <em class="comment">// so we figure out which line the point corresponds to.</em>
<a id="L681" name="L681"></a> 681                 <em class="comment">// if the line is greater than the number of lines contained, then</em>
<a id="L682" name="L682"></a> 682                 <em class="comment">// simply use the last line as it represents the last possible place</em>
<a id="L683" name="L683"></a> 683                 <em class="comment">// we can position to.</em>
<a id="L684" name="L684"></a> 684                 alloc.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a> = metrics.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>();
<a id="L685" name="L685"></a> 685                 <strong class="reserved">int</strong> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> = (alloc.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a> &gt; 0 ?
<a id="L686" name="L686"></a> 686                             (y - alloc.y) / alloc.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a> : lineCount - 1);
<a id="L687" name="L687"></a> 687                 <strong class="reserved">if</strong> (<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> &gt;= lineCount) <em class="brace">{</em>
<a id="L688" name="L688"></a> 688                     <strong class="reserved">return</strong> <a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>() - 1;
<a id="L689" name="L689"></a> 689                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L690" name="L690"></a> 690                     <strong class="reserved">int</strong> p0 = <a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>();
<a id="L691" name="L691"></a> 691                     <strong class="reserved">int</strong> p1;
<a id="L692" name="L692"></a> 692                     <strong class="reserved">if</strong> (lineCount == 1) <em class="brace">{</em>
<a id="L693" name="L693"></a> 693                         p1 = <a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>();
<a id="L694" name="L694"></a> 694                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L695" name="L695"></a> 695                         <strong class="reserved">int</strong>[] lineEnds = <a href="../S/3247.html#L748" title="Defined at 748 in src/javax/swing/text/WrappedPlainView.java.">getLineEnds</a>();
<a id="L696" name="L696"></a> 696                         p1 = p0 + lineEnds[<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>];
<a id="L697" name="L697"></a> 697                         <strong class="reserved">if</strong> (<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> &gt; 0) <em class="brace">{</em>
<a id="L698" name="L698"></a> 698                             p0 += lineEnds[<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> - 1];
<a id="L699" name="L699"></a> 699                         <em class="brace">}</em>
<a id="L700" name="L700"></a> 700                     <em class="brace">}</em>
<a id="L701" name="L701"></a> 701 
<a id="L702" name="L702"></a> 702                     <strong class="reserved">if</strong> (<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &lt; alloc.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L703" name="L703"></a> 703                         <em class="comment">// point is to the left of the line</em>
<a id="L704" name="L704"></a> 704                         <strong class="reserved">return</strong> p0;
<a id="L705" name="L705"></a> 705                     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &gt; alloc.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> + alloc.<a href="../D/36863.html" title="Multiple defined in 3 places.">width</a>) <em class="brace">{</em>
<a id="L706" name="L706"></a> 706                         <em class="comment">// point is to the right of the line</em>
<a id="L707" name="L707"></a> 707                         <strong class="reserved">return</strong> p1 - 1;
<a id="L708" name="L708"></a> 708                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L709" name="L709"></a> 709                         <em class="comment">// Determine the offset into the text</em>
<a id="L710" name="L710"></a> 710                         <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> segment = <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L65" title="Defined at 65 in src/javax/swing/text/SegmentCache.java.">getSharedSegment</a>();
<a id="L711" name="L711"></a> 711                         <a href="../S/3247.html#L306" title="Defined at 306 in src/javax/swing/text/WrappedPlainView.java.">loadText</a>(segment, p0, p1);
<a id="L712" name="L712"></a> 712                         <strong class="reserved">int</strong> n = <a href="../S/3270.html#L52" title="Defined at 52 in src/javax/swing/text/Utilities.java.">Utilities</a>.<a href="../D/22970.html" title="Multiple defined in 4 places.">getTabbedTextOffset</a>(segment, metrics,
<a id="L713" name="L713"></a> 713                                                    alloc.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>,
<a id="L714" name="L714"></a> 714                                                    <a href="../S/3247.html#L53" title="Defined at 53 in src/javax/swing/text/WrappedPlainView.java.">WrappedPlainView</a>.<strong class="reserved">this</strong>, p0);
<a id="L715" name="L715"></a> 715                         <a href="../S/3326.html#L42" title="Defined at 42 in src/javax/swing/text/SegmentCache.java.">SegmentCache</a>.<a href="../S/3326.html#L73" title="Defined at 73 in src/javax/swing/text/SegmentCache.java.">releaseSharedSegment</a>(segment);
<a id="L716" name="L716"></a> 716                         <strong class="reserved">return</strong> <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(p0 + n, p1 - 1);
<a id="L717" name="L717"></a> 717                     <em class="brace">}</em>
<a id="L718" name="L718"></a> 718                 <em class="brace">}</em>
<a id="L719" name="L719"></a> 719             <em class="brace">}</em>
<a id="L720" name="L720"></a> 720         <em class="brace">}</em>
<a id="L721" name="L721"></a> 721 
<a id="L722" name="L722"></a> 722         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/20799.html" title="Multiple referred from 23 places.">insertUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L723" name="L723"></a> 723             <a href="../D/36027.html" title="Multiple defined in 124 places.">update</a>(e, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L724" name="L724"></a> 724         <em class="brace">}</em>
<a id="L725" name="L725"></a> 725 
<a id="L726" name="L726"></a> 726         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26095.html" title="Multiple referred from 20 places.">removeUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L727" name="L727"></a> 727             <a href="../D/36027.html" title="Multiple defined in 124 places.">update</a>(e, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L728" name="L728"></a> 728         <em class="brace">}</em>
<a id="L729" name="L729"></a> 729 
<a id="L730" name="L730"></a> 730         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/29799.html" title="Multiple referred from 234 places.">update</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> ev, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) <em class="brace">{</em>
<a id="L731" name="L731"></a> 731             <strong class="reserved">int</strong> oldCount = lineCount;
<a id="L732" name="L732"></a> 732             <a href="../S/3247.html#L767" title="Defined at 767 in src/javax/swing/text/WrappedPlainView.java.">breakLines</a>(ev.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>());
<a id="L733" name="L733"></a> 733             <strong class="reserved">if</strong> (oldCount != lineCount) <em class="brace">{</em>
<a id="L734" name="L734"></a> 734                 <a href="../S/3247.html#L53" title="Defined at 53 in src/javax/swing/text/WrappedPlainView.java.">WrappedPlainView</a>.<strong class="reserved">this</strong>.<a href="../D/29542.html" title="Multiple defined in 7 places.">preferenceChanged</a>(<strong class="reserved">this</strong>, <strong class="reserved">false</strong>, <strong class="reserved">true</strong>);
<a id="L735" name="L735"></a> 735                 <em class="comment">// have to repaint any views after the receiver.</em>
<a id="L736" name="L736"></a> 736                 <a href="../D/17946.html" title="Multiple defined in 9 places.">getContainer</a>().<a href="../D/31014.html" title="Multiple defined in 22 places.">repaint</a>();
<a id="L737" name="L737"></a> 737             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L738" name="L738"></a> 738                 <a href="../S/2177.html#L186" title="Defined at 186 in src/java/awt/Component.java.">Component</a> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/17946.html" title="Multiple defined in 9 places.">getContainer</a>();
<a id="L739" name="L739"></a> 739                 <a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a> alloc = (<a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a>) <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>;
<a id="L740" name="L740"></a> 740                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>.<a href="../D/31014.html" title="Multiple defined in 22 places.">repaint</a>(alloc.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, alloc.y, alloc.<a href="../D/36863.html" title="Multiple defined in 3 places.">width</a>, alloc.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a>);
<a id="L741" name="L741"></a> 741             <em class="brace">}</em>
<a id="L742" name="L742"></a> 742         <em class="brace">}</em>
<a id="L743" name="L743"></a> 743 
<div class="comment">
          Returns line cache. If the cache was GC'ed, recreates it.
          If there's no cache, returns null</div>
<a id="L748" name="L748"></a> 748         <strong class="reserved">final</strong> <strong class="reserved">int</strong>[] <a href="../R/17361.html" title="Multiple referred from 3 places.">getLineEnds</a>() <em class="brace">{</em>
<a id="L749" name="L749"></a> 749             <strong class="reserved">if</strong> (lineCache == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L750" name="L750"></a> 750                 <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L751" name="L751"></a> 751             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L752" name="L752"></a> 752                 <strong class="reserved">int</strong>[] lineEnds = lineCache.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L753" name="L753"></a> 753                 <strong class="reserved">if</strong> (lineEnds == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L754" name="L754"></a> 754                     <em class="comment">// Cache was GC'ed, so rebuild it</em>
<a id="L755" name="L755"></a> 755                     <strong class="reserved">return</strong> <a href="../S/3247.html#L767" title="Defined at 767 in src/javax/swing/text/WrappedPlainView.java.">breakLines</a>(<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>());
<a id="L756" name="L756"></a> 756                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L757" name="L757"></a> 757                     <strong class="reserved">return</strong> lineEnds;
<a id="L758" name="L758"></a> 758                 <em class="brace">}</em>
<a id="L759" name="L759"></a> 759             <em class="brace">}</em>
<a id="L760" name="L760"></a> 760         <em class="brace">}</em>
<a id="L761" name="L761"></a> 761 
<div class="comment">
          Creates line cache if text breaks into more than one physical line.
          @param startPos position to start breaking from
          @return the cache created, ot null if text breaks into one line</div>
<a id="L767" name="L767"></a> 767         <strong class="reserved">final</strong> <strong class="reserved">int</strong>[] <a href="../R/10669.html" title="Multiple referred from 3 places.">breakLines</a>(<strong class="reserved">int</strong> startPos) <em class="brace">{</em>
<a id="L768" name="L768"></a> 768             <strong class="reserved">int</strong>[] lineEnds = (lineCache == <strong class="reserved">null</strong>) ? <strong class="reserved">null</strong> : lineCache.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L769" name="L769"></a> 769             <strong class="reserved">int</strong>[] oldLineEnds = lineEnds;
<a id="L770" name="L770"></a> 770             <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = <a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>();
<a id="L771" name="L771"></a> 771             <strong class="reserved">int</strong> lineIndex = 0;
<a id="L772" name="L772"></a> 772             <strong class="reserved">if</strong> (lineEnds != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L773" name="L773"></a> 773                 lineIndex = <a href="../D/16159.html" title="Multiple defined in 2 places.">findLine</a>(startPos - <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>);
<a id="L774" name="L774"></a> 774                 <strong class="reserved">if</strong> (lineIndex &gt; 0) <em class="brace">{</em>
<a id="L775" name="L775"></a> 775                     lineIndex--;
<a id="L776" name="L776"></a> 776                 <em class="brace">}</em>
<a id="L777" name="L777"></a> 777             <em class="brace">}</em>
<a id="L778" name="L778"></a> 778 
<a id="L779" name="L779"></a> 779             <strong class="reserved">int</strong> p0 = (lineIndex == 0) ? <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> : <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> + lineEnds[lineIndex - 1];
<a id="L780" name="L780"></a> 780             <strong class="reserved">int</strong> p1 = <a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>();
<a id="L781" name="L781"></a> 781             <strong class="reserved">while</strong> (p0 &lt; p1) <em class="brace">{</em>
<a id="L782" name="L782"></a> 782                 <strong class="reserved">int</strong> p = <a href="../S/3247.html#L232" title="Defined at 232 in src/javax/swing/text/WrappedPlainView.java.">calculateBreakPosition</a>(p0, p1);
<a id="L783" name="L783"></a> 783                 p0 = (p == p0) ? ++p : p;      <em class="comment">// 4410243</em>
<a id="L784" name="L784"></a> 784 
<a id="L785" name="L785"></a> 785                 <strong class="reserved">if</strong> (lineIndex == 0 &amp;&amp; p0 &gt;= p1) <em class="brace">{</em>
<a id="L786" name="L786"></a> 786                     <em class="comment">// do not use cache if there's only one line</em>
<a id="L787" name="L787"></a> 787                     lineCache = <strong class="reserved">null</strong>;
<a id="L788" name="L788"></a> 788                     lineEnds = <strong class="reserved">null</strong>;
<a id="L789" name="L789"></a> 789                     lineIndex = 1;
<a id="L790" name="L790"></a> 790                     <strong class="reserved">break</strong>;
<a id="L791" name="L791"></a> 791                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (lineEnds == <strong class="reserved">null</strong> || lineIndex &gt;= lineEnds.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L792" name="L792"></a> 792                     <em class="comment">// we have 2+ lines, and the cache is not big enough</em>
<a id="L793" name="L793"></a> 793                     <em class="comment">// we try to estimate total number of lines</em>
<a id="L794" name="L794"></a> 794                     <strong class="reserved">double</strong> growFactor = ((<strong class="reserved">double</strong>)(p1 - <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>) / (p0 - <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>));
<a id="L795" name="L795"></a> 795                     <strong class="reserved">int</strong> newSize = (<strong class="reserved">int</strong>)<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/12285.html" title="Multiple defined in 2 places.">ceil</a>((lineIndex + 1) * growFactor);
<a id="L796" name="L796"></a> 796                     newSize = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(newSize, lineIndex + 2);
<a id="L797" name="L797"></a> 797                     <strong class="reserved">int</strong>[] tmp = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[newSize];
<a id="L798" name="L798"></a> 798                     <strong class="reserved">if</strong> (lineEnds != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L799" name="L799"></a> 799                         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(lineEnds, 0, tmp, 0, lineIndex);
<a id="L800" name="L800"></a> 800                     <em class="brace">}</em>
<a id="L801" name="L801"></a> 801                     lineEnds = tmp;
<a id="L802" name="L802"></a> 802                 <em class="brace">}</em>
<a id="L803" name="L803"></a> 803                 lineEnds[lineIndex++] = p0 - <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L804" name="L804"></a> 804             <em class="brace">}</em>
<a id="L805" name="L805"></a> 805 
<a id="L806" name="L806"></a> 806             lineCount = lineIndex;
<a id="L807" name="L807"></a> 807             <strong class="reserved">if</strong> (lineCount &gt; 1) <em class="brace">{</em>
<a id="L808" name="L808"></a> 808                 <em class="comment">// check if the cache is too big</em>
<a id="L809" name="L809"></a> 809                 <strong class="reserved">int</strong> maxCapacity = lineCount + lineCount / 3;
<a id="L810" name="L810"></a> 810                 <strong class="reserved">if</strong> (lineEnds.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; maxCapacity) <em class="brace">{</em>
<a id="L811" name="L811"></a> 811                     <strong class="reserved">int</strong>[] tmp = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[maxCapacity];
<a id="L812" name="L812"></a> 812                     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(lineEnds, 0, tmp, 0, lineCount);
<a id="L813" name="L813"></a> 813                     lineEnds = tmp;
<a id="L814" name="L814"></a> 814                 <em class="brace">}</em>
<a id="L815" name="L815"></a> 815             <em class="brace">}</em>
<a id="L816" name="L816"></a> 816 
<a id="L817" name="L817"></a> 817             <strong class="reserved">if</strong> (lineEnds != <strong class="reserved">null</strong> &amp;&amp; lineEnds != oldLineEnds) <em class="brace">{</em>
<a id="L818" name="L818"></a> 818                 lineCache = <strong class="reserved">new</strong> <a href="../S/1564.html#L64" title="Defined at 64 in src/java/lang/ref/SoftReference.java.">SoftReference</a>&lt;<strong class="reserved">int</strong>[]&gt;(lineEnds);
<a id="L819" name="L819"></a> 819             <em class="brace">}</em>
<a id="L820" name="L820"></a> 820             <strong class="reserved">return</strong> lineEnds;
<a id="L821" name="L821"></a> 821         <em class="brace">}</em>
<a id="L822" name="L822"></a> 822 
<div class="comment">
          Binary search in the cache for line containing specified offset
          (which is relative to the beginning of the view). This method
          assumes that cache exists.</div>
<a id="L828" name="L828"></a> 828         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/14410.html" title="Multiple referred from 5 places.">findLine</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L829" name="L829"></a> 829             <strong class="reserved">int</strong>[] lineEnds = lineCache.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L830" name="L830"></a> 830             <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &lt; lineEnds[0]) <em class="brace">{</em>
<a id="L831" name="L831"></a> 831                 <strong class="reserved">return</strong> 0;
<a id="L832" name="L832"></a> 832             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &gt; lineEnds[lineCount - 1]) <em class="brace">{</em>
<a id="L833" name="L833"></a> 833                 <strong class="reserved">return</strong> lineCount;
<a id="L834" name="L834"></a> 834             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L835" name="L835"></a> 835                 <strong class="reserved">return</strong> <a href="../D/16159.html" title="Multiple defined in 2 places.">findLine</a>(lineEnds, <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, 0, lineCount - 1);
<a id="L836" name="L836"></a> 836             <em class="brace">}</em>
<a id="L837" name="L837"></a> 837         <em class="brace">}</em>
<a id="L838" name="L838"></a> 838 
<a id="L839" name="L839"></a> 839         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/14410.html" title="Multiple referred from 5 places.">findLine</a>(<strong class="reserved">int</strong>[] <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, <strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <strong class="reserved">int</strong> <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>, <strong class="reserved">int</strong> <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>) <em class="brace">{</em>
<a id="L840" name="L840"></a> 840             <strong class="reserved">if</strong> (<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a> - <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a> &lt;= 1) <em class="brace">{</em>
<a id="L841" name="L841"></a> 841                 <strong class="reserved">return</strong> <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>;
<a id="L842" name="L842"></a> 842             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L843" name="L843"></a> 843                 <strong class="reserved">int</strong> mid = (<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a> + <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>) / 2;
<a id="L844" name="L844"></a> 844                 <strong class="reserved">return</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &lt; <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>[mid]) ?
<a id="L845" name="L845"></a> 845                         <a href="../D/16159.html" title="Multiple defined in 2 places.">findLine</a>(<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>, mid) :
<a id="L846" name="L846"></a> 846                         <a href="../D/16159.html" title="Multiple defined in 2 places.">findLine</a>(<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, mid, <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>);
<a id="L847" name="L847"></a> 847             <em class="brace">}</em>
<a id="L848" name="L848"></a> 848         <em class="brace">}</em>
<a id="L849" name="L849"></a> 849 
<a id="L850" name="L850"></a> 850         <strong class="reserved">int</strong> lineCount;
<a id="L851" name="L851"></a> 851         <a href="../S/1564.html#L64" title="Defined at 64 in src/java/lang/ref/SoftReference.java.">SoftReference</a>&lt;<strong class="reserved">int</strong>[]&gt; lineCache = <strong class="reserved">null</strong>;
<a id="L852" name="L852"></a> 852     <em class="brace">}</em>
<a id="L853" name="L853"></a> 853 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L83">[^]</a><a href="#L839">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>