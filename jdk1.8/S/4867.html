<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L66">[^]</a><a href="#L642">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L66" title="Defined at 66.">readObject</a></li>
<li><a href="#L88" title="Defined at 88.">clone</a></li>
<li><a href="#L118" title="Defined at 118.">getPredicateCount</a></li>
<li><a href="#L136" title="Defined at 136.">setPredicateCount</a></li>
<li><a href="#L161" title="Defined at 161.">initPredicateInfo</a></li>
<li><a href="#L188" title="Defined at 188.">getPredicate</a></li>
<li><a href="#L198" title="Defined at 198.">getProximityPosition</a></li>
<li><a href="#L212" title="Defined at 212.">getProximityPosition</a></li>
<li><a href="#L225" title="Defined at 225.">getLastPos</a></li>
<li><a href="#L235" title="Defined at 235.">getProximityPosition</a></li>
<li><a href="#L243" title="Defined at 243.">resetProximityPositions</a></li>
<li><a href="#L273" title="Defined at 273.">initProximityPosition</a></li>
<li><a href="#L284" title="Defined at 284.">countProximityPosition</a></li>
<li><a href="#L298" title="Defined at 298.">isReverseAxes</a></li>
<li><a href="#L308" title="Defined at 308.">getPredicateIndex</a></li>
<li><a href="#L323" title="Defined at 323.">executePredicates</a></li>
<li><a href="#L419" title="Defined at 419.">fixupVariables</a></li>
<li><a href="#L439" title="Defined at 439.">nodeToString</a></li>
<li><a href="#L463" title="Defined at 463.">acceptNode</a></li>
<li><a href="#L508" title="Defined at 508.">getLocPathIterator</a></li>
<li><a href="#L519" title="Defined at 519.">setLocPathIterator</a></li>
<li><a href="#L532" title="Defined at 532.">canTraverseOutsideSubtree</a></li>
<li><a href="#L550" title="Defined at 550.">callPredicateVisitors</a></li>
<li><a href="#L570" title="Defined at 570.">deepEquals</a></li>
<li><a href="#L633" title="Defined at 633.">getExpression</a></li>
<li><a href="#L642" title="Defined at 642.">setExpression</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: PredicatedNodeTest.java,v 1.2.4.2 2005/09/14 19:45:20 jeffsuttor Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xpath.internal.axes;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTM;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMIterator;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.PrefixResolver;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.Expression;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.ExpressionOwner;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.XPathContext;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.XPathVisitor;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.compiler.Compiler;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.objects.XObject;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.patterns.NodeTest;
<a id="L35" name="L35"></a>  35 
<a id="L36" name="L36"></a>  36 <strong class="reserved">public</strong> <strong class="reserved">abstract</strong> <strong class="reserved">class</strong> <a href="../R/6187.html" title="Multiple referred from 15 places.">PredicatedNodeTest</a> <strong class="reserved">extends</strong> <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a> <strong class="reserved">implements</strong> <a href="../S/4890.html#L32" title="Defined at 32 in src/com/sun/org/apache/xpath/internal/axes/SubContextList.java.">SubContextList</a>
<a id="L37" name="L37"></a>  37 <em class="brace">{</em>
<a id="L38" name="L38"></a>  38     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = -6193530757296377351L;
<a id="L39" name="L39"></a>  39 
<div class="comment">
    Construct an AxesWalker using a LocPathIterator.
    @param locPathIterator non-null reference to the parent iterator.</div>
<a id="L45" name="L45"></a>  45   PredicatedNodeTest(<a href="../S/4876.html#L51" title="Defined at 51 in src/com/sun/org/apache/xpath/internal/axes/LocPathIterator.java.">LocPathIterator</a> locPathIterator)
<a id="L46" name="L46"></a>  46   <em class="brace">{</em>
<a id="L47" name="L47"></a>  47     m_lpi = locPathIterator;
<a id="L48" name="L48"></a>  48   <em class="brace">}</em>
<a id="L49" name="L49"></a>  49 
<div class="comment">
    Construct an AxesWalker.  The location path iterator will have to be set
    before use.</div>
<a id="L54" name="L54"></a>  54   PredicatedNodeTest()
<a id="L55" name="L55"></a>  55   <em class="brace">{</em>
<a id="L56" name="L56"></a>  56   <em class="brace">}</em>
<a id="L57" name="L57"></a>  57 
<div class="comment">
    Read the object from a serialization stream.
    @param stream Input stream to read from
    @throws java.io.IOException
    @throws javax.xml.transform.TransformerException</div>
<a id="L66" name="L66"></a>  66   <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25518.html" title="Multiple referred from 189 places.">readObject</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1378.html#L206" title="Defined at 206 in src/java/io/ObjectInputStream.java.">ObjectInputStream</a> <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>)
<a id="L67" name="L67"></a>  67           <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L68" name="L68"></a>  68   <em class="brace">{</em>
<a id="L69" name="L69"></a>  69     <strong class="reserved">try</strong>
<a id="L70" name="L70"></a>  70     <em class="brace">{</em>
<a id="L71" name="L71"></a>  71       <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/14746.html" title="Multiple defined in 2 places.">defaultReadObject</a>();
<a id="L72" name="L72"></a>  72       m_predicateIndex = -1;
<a id="L73" name="L73"></a>  73       <a href="../S/4867.html#L243" title="Defined at 243 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">resetProximityPositions</a>();
<a id="L74" name="L74"></a>  74     <em class="brace">}</em>
<a id="L75" name="L75"></a>  75     <strong class="reserved">catch</strong> (<a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a> cnfe)
<a id="L76" name="L76"></a>  76     <em class="brace">{</em>
<a id="L77" name="L77"></a>  77       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>(cnfe);
<a id="L78" name="L78"></a>  78     <em class="brace">}</em>
<a id="L79" name="L79"></a>  79   <em class="brace">}</em>
<a id="L80" name="L80"></a>  80 
<div class="comment">
    Get a cloned PrdicatedNodeTest.
    @return A new PredicatedNodeTest that can be used without mutating this one.
    @throws CloneNotSupportedException</div>
<a id="L88" name="L88"></a>  88   <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/11555.html" title="Multiple referred from 1378 places.">clone</a>() <strong class="reserved">throws</strong> <a href="../S/1725.html#L45" title="Defined at 45 in src/java/lang/CloneNotSupportedException.java.">CloneNotSupportedException</a>
<a id="L89" name="L89"></a>  89   <em class="brace">{</em>
<a id="L90" name="L90"></a>  90     <em class="comment">// Do not access the location path itterator during this operation!</em>
<a id="L91" name="L91"></a>  91 
<a id="L92" name="L92"></a>  92     <a href="../S/4867.html#L36" title="Defined at 36 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">PredicatedNodeTest</a> <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a> = (<a href="../S/4867.html#L36" title="Defined at 36 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">PredicatedNodeTest</a>) <strong class="reserved">super</strong>.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L93" name="L93"></a>  93 
<a id="L94" name="L94"></a>  94     <strong class="reserved">if</strong> ((<strong class="reserved">null</strong> != <strong class="reserved">this</strong>.m_proximityPositions)
<a id="L95" name="L95"></a>  95             &amp;&amp; (<strong class="reserved">this</strong>.m_proximityPositions == <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>.m_proximityPositions))
<a id="L96" name="L96"></a>  96     <em class="brace">{</em>
<a id="L97" name="L97"></a>  97       <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>.m_proximityPositions = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[<strong class="reserved">this</strong>.m_proximityPositions.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L98" name="L98"></a>  98 
<a id="L99" name="L99"></a>  99       <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(<strong class="reserved">this</strong>.m_proximityPositions, 0,
<a id="L100" name="L100"></a> 100                        <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>.m_proximityPositions, 0,
<a id="L101" name="L101"></a> 101                        <strong class="reserved">this</strong>.m_proximityPositions.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L102" name="L102"></a> 102     <em class="brace">}</em>
<a id="L103" name="L103"></a> 103 
<a id="L104" name="L104"></a> 104     <strong class="reserved">if</strong>(<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>.m_lpi == <strong class="reserved">this</strong>)
<a id="L105" name="L105"></a> 105       <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>.m_lpi = (<a href="../S/4876.html#L51" title="Defined at 51 in src/com/sun/org/apache/xpath/internal/axes/LocPathIterator.java.">LocPathIterator</a>)<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>;
<a id="L106" name="L106"></a> 106 
<a id="L107" name="L107"></a> 107     <strong class="reserved">return</strong> <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>;
<a id="L108" name="L108"></a> 108   <em class="brace">}</em>
<a id="L109" name="L109"></a> 109 
<a id="L110" name="L110"></a> 110   <em class="comment">// Only for clones for findLastPos.  See bug4638.</em>
<a id="L111" name="L111"></a> 111   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> m_predCount = -1;
<a id="L112" name="L112"></a> 112 
<div class="comment">
    Get the number of predicates that this walker has.
    @return the number of predicates that this walker has.</div>
<a id="L118" name="L118"></a> 118   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/18395.html" title="Multiple referred from 15 places.">getPredicateCount</a>()
<a id="L119" name="L119"></a> 119   <em class="brace">{</em>
<a id="L120" name="L120"></a> 120     <strong class="reserved">if</strong>(-1 == m_predCount)
<a id="L121" name="L121"></a> 121       <strong class="reserved">return</strong> (<strong class="reserved">null</strong> == m_predicates) ? 0 : m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L122" name="L122"></a> 122     <strong class="reserved">else</strong>
<a id="L123" name="L123"></a> 123       <strong class="reserved">return</strong> m_predCount;
<a id="L124" name="L124"></a> 124   <em class="brace">}</em>
<a id="L125" name="L125"></a> 125 
<div class="comment">
    Set the number of predicates that this walker has.  This does more
    that one would think, as it creates a new predicate array of the
    size of the count argument, and copies count predicates into the new
    one from the old, and then reassigns the predicates value.  All this
    to keep from having to have a predicate count value.
    @param count The number of predicates, which must be equal or less
                  than the existing count.</div>
<a id="L136" name="L136"></a> 136   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27946.html" title="Multiple referred from 3 places.">setPredicateCount</a>(<strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>)
<a id="L137" name="L137"></a> 137   <em class="brace">{</em>
<a id="L138" name="L138"></a> 138     <strong class="reserved">if</strong>(<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> &gt; 0)
<a id="L139" name="L139"></a> 139     <em class="brace">{</em>
<a id="L140" name="L140"></a> 140       <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a>[] newPredicates = <strong class="reserved">new</strong> <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a>[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>];
<a id="L141" name="L141"></a> 141       <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>; i++)
<a id="L142" name="L142"></a> 142       <em class="brace">{</em>
<a id="L143" name="L143"></a> 143         newPredicates[i] = m_predicates[i];
<a id="L144" name="L144"></a> 144       <em class="brace">}</em>
<a id="L145" name="L145"></a> 145       m_predicates = newPredicates;
<a id="L146" name="L146"></a> 146     <em class="brace">}</em>
<a id="L147" name="L147"></a> 147     <strong class="reserved">else</strong>
<a id="L148" name="L148"></a> 148       m_predicates = <strong class="reserved">null</strong>;
<a id="L149" name="L149"></a> 149 
<a id="L150" name="L150"></a> 150   <em class="brace">}</em>
<a id="L151" name="L151"></a> 151 
<div class="comment">
    Init predicate info.
    @param compiler The Compiler object that has information about this
                    walker in the op map.
    @param opPos The op code position of this location step.
    @throws javax.xml.transform.TransformerException</div>
<a id="L161" name="L161"></a> 161   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/20629.html" title="Multiple referred from 3 places.">initPredicateInfo</a>(<a href="../D/1702.html" title="Multiple defined in 2 places.">Compiler</a> compiler, <strong class="reserved">int</strong> opPos)
<a id="L162" name="L162"></a> 162           <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L163" name="L163"></a> 163   <em class="brace">{</em>
<a id="L164" name="L164"></a> 164 
<a id="L165" name="L165"></a> 165     <strong class="reserved">int</strong> pos = compiler.<a href="../S/4996.html#L275" title="Defined at 275 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getFirstPredicateOpPos</a>(opPos);
<a id="L166" name="L166"></a> 166 
<a id="L167" name="L167"></a> 167     <strong class="reserved">if</strong>(pos &gt; 0)
<a id="L168" name="L168"></a> 168     <em class="brace">{</em>
<a id="L169" name="L169"></a> 169       m_predicates = compiler.<a href="../S/4997.html#L949" title="Defined at 949 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">getCompiledPredicates</a>(pos);
<a id="L170" name="L170"></a> 170       <strong class="reserved">if</strong>(<strong class="reserved">null</strong> != m_predicates)
<a id="L171" name="L171"></a> 171       <em class="brace">{</em>
<a id="L172" name="L172"></a> 172         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i = 0; i &lt; m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++)
<a id="L173" name="L173"></a> 173         <em class="brace">{</em>
<a id="L174" name="L174"></a> 174                 m_predicates[i].<a href="../D/15890.html" title="Multiple defined in 3 places.">exprSetParent</a>(<strong class="reserved">this</strong>);
<a id="L175" name="L175"></a> 175         <em class="brace">}</em>
<a id="L176" name="L176"></a> 176       <em class="brace">}</em>
<a id="L177" name="L177"></a> 177     <em class="brace">}</em>
<a id="L178" name="L178"></a> 178   <em class="brace">}</em>
<a id="L179" name="L179"></a> 179 
<div class="comment">
    Get a predicate expression at the given index.
    @param index Index of the predicate.
    @return A predicate expression.</div>
<a id="L188" name="L188"></a> 188   <strong class="reserved">public</strong> <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../R/18394.html" title="Multiple referred from 2 places.">getPredicate</a>(<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>)
<a id="L189" name="L189"></a> 189   <em class="brace">{</em>
<a id="L190" name="L190"></a> 190     <strong class="reserved">return</strong> m_predicates[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>];
<a id="L191" name="L191"></a> 191   <em class="brace">}</em>
<a id="L192" name="L192"></a> 192 
<div class="comment">
    Get the current sub-context position.
    @return The node position of this walker in the sub-context node list.</div>
<a id="L198" name="L198"></a> 198   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/18546.html" title="Multiple referred from 9 places.">getProximityPosition</a>()
<a id="L199" name="L199"></a> 199   <em class="brace">{</em>
<a id="L200" name="L200"></a> 200 
<a id="L201" name="L201"></a> 201     <em class="comment">// System.out.println("getProximityPosition - m_predicateIndex: "+m_predicateIndex);</em>
<a id="L202" name="L202"></a> 202     <strong class="reserved">return</strong> <a href="../D/21769.html" title="Multiple defined in 8 places.">getProximityPosition</a>(m_predicateIndex);
<a id="L203" name="L203"></a> 203   <em class="brace">}</em>
<a id="L204" name="L204"></a> 204 
<div class="comment">
    Get the current sub-context position.
    @param xctxt The XPath runtime context.
    @return The node position of this walker in the sub-context node list.</div>
<a id="L212" name="L212"></a> 212   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/18546.html" title="Multiple referred from 9 places.">getProximityPosition</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L213" name="L213"></a> 213   <em class="brace">{</em>
<a id="L214" name="L214"></a> 214     <strong class="reserved">return</strong> <a href="../D/21769.html" title="Multiple defined in 8 places.">getProximityPosition</a>();
<a id="L215" name="L215"></a> 215   <em class="brace">}</em>
<a id="L216" name="L216"></a> 216 
<div class="comment">
    Get the index of the last node that can be itterated to.
    @param xctxt XPath runtime context.
    @return the index of the last node that can be itterated to.</div>
<a id="L225" name="L225"></a> 225   <strong class="reserved">public</strong> <strong class="reserved">abstract</strong> <strong class="reserved">int</strong> <a href="../S/4977.html#L71" title="Referred from 71 in src/com/sun/org/apache/xpath/internal/functions/FuncLast.java.">getLastPos</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt);
<a id="L226" name="L226"></a> 226 
<div class="comment">
    Get the current sub-context position.
    @param predicateIndex The index of the predicate where the proximity
                          should be taken from.
    @return The node position of this walker in the sub-context node list.</div>
<a id="L235" name="L235"></a> 235   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/18546.html" title="Multiple referred from 9 places.">getProximityPosition</a>(<strong class="reserved">int</strong> predicateIndex)
<a id="L236" name="L236"></a> 236   <em class="brace">{</em>
<a id="L237" name="L237"></a> 237     <strong class="reserved">return</strong> (predicateIndex &gt;= 0) ? m_proximityPositions[predicateIndex] : 0;
<a id="L238" name="L238"></a> 238   <em class="brace">}</em>
<a id="L239" name="L239"></a> 239 
<div class="comment">
    Reset the proximity positions counts.</div>
<a id="L243" name="L243"></a> 243   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26278.html" title="Multiple referred from 6 places.">resetProximityPositions</a>()
<a id="L244" name="L244"></a> 244   <em class="brace">{</em>
<a id="L245" name="L245"></a> 245     <strong class="reserved">int</strong> nPredicates = <a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>();
<a id="L246" name="L246"></a> 246     <strong class="reserved">if</strong> (nPredicates &gt; 0)
<a id="L247" name="L247"></a> 247     <em class="brace">{</em>
<a id="L248" name="L248"></a> 248       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == m_proximityPositions)
<a id="L249" name="L249"></a> 249         m_proximityPositions = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[nPredicates];
<a id="L250" name="L250"></a> 250 
<a id="L251" name="L251"></a> 251       <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nPredicates; i++)
<a id="L252" name="L252"></a> 252       <em class="brace">{</em>
<a id="L253" name="L253"></a> 253         <strong class="reserved">try</strong>
<a id="L254" name="L254"></a> 254         <em class="brace">{</em>
<a id="L255" name="L255"></a> 255           <a href="../S/4867.html#L273" title="Defined at 273 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">initProximityPosition</a>(i);
<a id="L256" name="L256"></a> 256         <em class="brace">}</em>
<a id="L257" name="L257"></a> 257         <strong class="reserved">catch</strong>(<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e)
<a id="L258" name="L258"></a> 258         <em class="brace">{</em>
<a id="L259" name="L259"></a> 259           <em class="comment">// TODO: Fix this...</em>
<a id="L260" name="L260"></a> 260           <strong class="reserved">throw</strong> <strong class="reserved">new</strong> com.sun.org.apache.xml.internal.utils.<a href="../D/9772.html" title="Multiple defined in 2 places.">WrappedRuntimeException</a>(e);
<a id="L261" name="L261"></a> 261         <em class="brace">}</em>
<a id="L262" name="L262"></a> 262       <em class="brace">}</em>
<a id="L263" name="L263"></a> 263     <em class="brace">}</em>
<a id="L264" name="L264"></a> 264   <em class="brace">}</em>
<a id="L265" name="L265"></a> 265 
<div class="comment">
    Init the proximity position to zero for a forward axes.
    @param i The index into the m_proximityPositions array.
    @throws javax.xml.transform.TransformerException</div>
<a id="L273" name="L273"></a> 273   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/4867.html#L255" title="Referred from 255 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">initProximityPosition</a>(<strong class="reserved">int</strong> i) <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L274" name="L274"></a> 274   <em class="brace">{</em>
<a id="L275" name="L275"></a> 275     m_proximityPositions[i] = 0;
<a id="L276" name="L276"></a> 276   <em class="brace">}</em>
<a id="L277" name="L277"></a> 277 
<div class="comment">
    Count forward one proximity position.
    @param i The index into the m_proximityPositions array, where the increment
             will occur.</div>
<a id="L284" name="L284"></a> 284   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/12182.html" title="Multiple referred from 4 places.">countProximityPosition</a>(<strong class="reserved">int</strong> i)
<a id="L285" name="L285"></a> 285   <em class="brace">{</em>
<a id="L286" name="L286"></a> 286         <em class="comment">// Note that in the case of a UnionChildIterator, this may be a</em>
<a id="L287" name="L287"></a> 287         <em class="comment">// static object and so m_proximityPositions may indeed be null!</em>
<a id="L288" name="L288"></a> 288         <strong class="reserved">int</strong>[] pp = m_proximityPositions;
<a id="L289" name="L289"></a> 289     <strong class="reserved">if</strong> ((<strong class="reserved">null</strong> != pp) &amp;&amp; (i &lt; pp.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>))
<a id="L290" name="L290"></a> 290       pp[i]++;
<a id="L291" name="L291"></a> 291   <em class="brace">}</em>
<a id="L292" name="L292"></a> 292 
<div class="comment">
    Tells if this is a reverse axes.
    @return false, unless a derived class overrides.</div>
<a id="L298" name="L298"></a> 298   <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21969.html" title="Multiple referred from 3 places.">isReverseAxes</a>()
<a id="L299" name="L299"></a> 299   <em class="brace">{</em>
<a id="L300" name="L300"></a> 300     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L301" name="L301"></a> 301   <em class="brace">}</em>
<a id="L302" name="L302"></a> 302 
<div class="comment">
    Get which predicate is executing.
    @return The current predicate index, or -1 if no predicate is executing.</div>
<a id="L308" name="L308"></a> 308   <strong class="reserved">public</strong> <strong class="reserved">int</strong> getPredicateIndex()
<a id="L309" name="L309"></a> 309   <em class="brace">{</em>
<a id="L310" name="L310"></a> 310     <strong class="reserved">return</strong> m_predicateIndex;
<a id="L311" name="L311"></a> 311   <em class="brace">}</em>
<a id="L312" name="L312"></a> 312 
<div class="comment">
    Process the predicates.
    @param context The current context node.
    @param xctxt The XPath runtime context.
    @return the result of executing the predicate expressions.
    @throws javax.xml.transform.TransformerException</div>
<a id="L323" name="L323"></a> 323   <strong class="reserved">boolean</strong> <a href="../R/14097.html" title="Multiple referred from 5 places.">executePredicates</a>(<strong class="reserved">int</strong> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, <a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L324" name="L324"></a> 324           <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L325" name="L325"></a> 325   <em class="brace">{</em>
<a id="L326" name="L326"></a> 326 
<a id="L327" name="L327"></a> 327     <strong class="reserved">int</strong> nPredicates = <a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>();
<a id="L328" name="L328"></a> 328     <em class="comment">// System.out.println("nPredicates: "+nPredicates);</em>
<a id="L329" name="L329"></a> 329     <strong class="reserved">if</strong> (nPredicates == 0)
<a id="L330" name="L330"></a> 330       <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L331" name="L331"></a> 331 
<a id="L332" name="L332"></a> 332     <a href="../S/5879.html#L32" title="Defined at 32 in src/com/sun/org/apache/xml/internal/utils/PrefixResolver.java.">PrefixResolver</a> savedResolver = xctxt.<a href="../D/20811.html" title="Multiple defined in 14 places.">getNamespaceContext</a>();
<a id="L333" name="L333"></a> 333 
<a id="L334" name="L334"></a> 334     <strong class="reserved">try</strong>
<a id="L335" name="L335"></a> 335     <em class="brace">{</em>
<a id="L336" name="L336"></a> 336       m_predicateIndex = 0;
<a id="L337" name="L337"></a> 337       xctxt.<a href="../S/4946.html#L941" title="Defined at 941 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushSubContextList</a>(<strong class="reserved">this</strong>);
<a id="L338" name="L338"></a> 338       xctxt.<a href="../S/4946.html#L901" title="Defined at 901 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushNamespaceContext</a>(m_lpi.<a href="../S/4876.html#L889" title="Defined at 889 in src/com/sun/org/apache/xpath/internal/axes/LocPathIterator.java.">getPrefixResolver</a>());
<a id="L339" name="L339"></a> 339       xctxt.<a href="../S/4946.html#L750" title="Defined at 750 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushCurrentNode</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>);
<a id="L340" name="L340"></a> 340 
<a id="L341" name="L341"></a> 341       <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nPredicates; i++)
<a id="L342" name="L342"></a> 342       <em class="brace">{</em>
<a id="L343" name="L343"></a> 343         <em class="comment">// System.out.println("Executing predicate expression - waiting count: "+m_lpi.getWaitingCount());</em>
<a id="L344" name="L344"></a> 344         <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> = m_predicates[i].<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt);
<a id="L345" name="L345"></a> 345         <em class="comment">// System.out.println("\nBack from executing predicate expression - waiting count: "+m_lpi.getWaitingCount());</em>
<a id="L346" name="L346"></a> 346         <em class="comment">// System.out.println("pred.getType(): "+pred.getType());</em>
<a id="L347" name="L347"></a> 347         <strong class="reserved">if</strong> (<a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a>.CLASS_NUMBER == <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>())
<a id="L348" name="L348"></a> 348         <em class="brace">{</em>
<a id="L349" name="L349"></a> 349           <strong class="reserved">if</strong> (DEBUG_PREDICATECOUNTING)
<a id="L350" name="L350"></a> 350           <em class="brace">{</em>
<a id="L351" name="L351"></a> 351             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/16474.html" title="Multiple defined in 60 places.">flush</a>();
<a id="L352" name="L352"></a> 352             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\n===== start predicate count ========");
<a id="L353" name="L353"></a> 353             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("m_predicateIndex: " + m_predicateIndex);
<a id="L354" name="L354"></a> 354             <em class="comment">// System.out.println("getProximityPosition(m_predicateIndex): "</em>
<a id="L355" name="L355"></a> 355             <em class="comment">//                   + getProximityPosition(m_predicateIndex));</em>
<a id="L356" name="L356"></a> 356             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("pred.num(): " + <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/28365.html" title="Multiple defined in 17 places.">num</a>());
<a id="L357" name="L357"></a> 357           <em class="brace">}</em>
<a id="L358" name="L358"></a> 358 
<a id="L359" name="L359"></a> 359           <strong class="reserved">int</strong> proxPos = <strong class="reserved">this</strong>.<a href="../D/21769.html" title="Multiple defined in 8 places.">getProximityPosition</a>(m_predicateIndex);
<a id="L360" name="L360"></a> 360           <strong class="reserved">int</strong> predIndex = (<strong class="reserved">int</strong>) <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/28365.html" title="Multiple defined in 17 places.">num</a>();
<a id="L361" name="L361"></a> 361           <strong class="reserved">if</strong> (proxPos != predIndex)
<a id="L362" name="L362"></a> 362           <em class="brace">{</em>
<a id="L363" name="L363"></a> 363             <strong class="reserved">if</strong> (DEBUG_PREDICATECOUNTING)
<a id="L364" name="L364"></a> 364             <em class="brace">{</em>
<a id="L365" name="L365"></a> 365               <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\nnode context: "+<a href="../D/28252.html" title="Multiple defined in 2 places.">nodeToString</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>));
<a id="L366" name="L366"></a> 366               <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("index predicate is false: "+proxPos);
<a id="L367" name="L367"></a> 367               <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\n===== end predicate count ========");
<a id="L368" name="L368"></a> 368             <em class="brace">}</em>
<a id="L369" name="L369"></a> 369             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L370" name="L370"></a> 370           <em class="brace">}</em>
<a id="L371" name="L371"></a> 371           <strong class="reserved">else</strong> <strong class="reserved">if</strong> (DEBUG_PREDICATECOUNTING)
<a id="L372" name="L372"></a> 372           <em class="brace">{</em>
<a id="L373" name="L373"></a> 373             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\nnode context: "+<a href="../D/28252.html" title="Multiple defined in 2 places.">nodeToString</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>));
<a id="L374" name="L374"></a> 374             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("index predicate is true: "+proxPos);
<a id="L375" name="L375"></a> 375             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\n===== end predicate count ========");
<a id="L376" name="L376"></a> 376           <em class="brace">}</em>
<a id="L377" name="L377"></a> 377 
<a id="L378" name="L378"></a> 378           <em class="comment">// If there is a proximity index that will not change during the</em>
<a id="L379" name="L379"></a> 379           <em class="comment">// course of itteration, then we know there can be no more true</em>
<a id="L380" name="L380"></a> 380           <em class="comment">// occurances of this predicate, so flag that we're done after</em>
<a id="L381" name="L381"></a> 381           <em class="comment">// this.</em>
<a id="L382" name="L382"></a> 382           <em class="comment">//</em>
<a id="L383" name="L383"></a> 383           <em class="comment">// bugzilla 14365</em>
<a id="L384" name="L384"></a> 384           <em class="comment">// We can't set m_foundLast = true unless we're sure that -all-</em>
<a id="L385" name="L385"></a> 385           <em class="comment">// remaining parameters are stable, or else last() fails. Fixed so</em>
<a id="L386" name="L386"></a> 386           <em class="comment">// only sets m_foundLast if on the last predicate</em>
<a id="L387" name="L387"></a> 387           <strong class="reserved">if</strong>(m_predicates[i].<a href="../D/26268.html" title="Multiple defined in 3 places.">isStableNumber</a>() &amp;&amp; i == nPredicates - 1)
<a id="L388" name="L388"></a> 388           <em class="brace">{</em>
<a id="L389" name="L389"></a> 389             m_foundLast = <strong class="reserved">true</strong>;
<a id="L390" name="L390"></a> 390           <em class="brace">}</em>
<a id="L391" name="L391"></a> 391         <em class="brace">}</em>
<a id="L392" name="L392"></a> 392         <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!<a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/11887.html" title="Multiple defined in 15 places.">bool</a>())
<a id="L393" name="L393"></a> 393           <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L394" name="L394"></a> 394 
<a id="L395" name="L395"></a> 395         <a href="../D/13576.html" title="Multiple defined in 3 places.">countProximityPosition</a>(++m_predicateIndex);
<a id="L396" name="L396"></a> 396       <em class="brace">}</em>
<a id="L397" name="L397"></a> 397     <em class="brace">}</em>
<a id="L398" name="L398"></a> 398     <strong class="reserved">finally</strong>
<a id="L399" name="L399"></a> 399     <em class="brace">{</em>
<a id="L400" name="L400"></a> 400       xctxt.<a href="../S/4946.html#L758" title="Defined at 758 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popCurrentNode</a>();
<a id="L401" name="L401"></a> 401       xctxt.<a href="../S/4946.html#L918" title="Defined at 918 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popNamespaceContext</a>();
<a id="L402" name="L402"></a> 402       xctxt.<a href="../S/4946.html#L950" title="Defined at 950 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popSubContextList</a>();
<a id="L403" name="L403"></a> 403       m_predicateIndex = -1;
<a id="L404" name="L404"></a> 404     <em class="brace">}</em>
<a id="L405" name="L405"></a> 405 
<a id="L406" name="L406"></a> 406     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L407" name="L407"></a> 407   <em class="brace">}</em>
<a id="L408" name="L408"></a> 408 
<div class="comment">
    This function is used to fixup variables from QNames to stack frame
    indexes at stylesheet build time.
    @param vars List of QNames that correspond to variables.  This list
    should be searched backwards for the first qualified name that
    corresponds to the variable reference qname.  The position of the
    QName in the vector from the start of the vector will be its position
    in the stack frame (but variables above the globalsTop value will need
    to be offset to the current stack frame).</div>
<a id="L419" name="L419"></a> 419   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/14669.html" title="Multiple referred from 33 places.">fixupVariables</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util.<a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> vars, <strong class="reserved">int</strong> globalsSize)
<a id="L420" name="L420"></a> 420   <em class="brace">{</em>
<a id="L421" name="L421"></a> 421     <strong class="reserved">super</strong>.<a href="../D/16440.html" title="Multiple defined in 31 places.">fixupVariables</a>(vars, globalsSize);
<a id="L422" name="L422"></a> 422 
<a id="L423" name="L423"></a> 423     <strong class="reserved">int</strong> nPredicates = <a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>();
<a id="L424" name="L424"></a> 424 
<a id="L425" name="L425"></a> 425     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nPredicates; i++)
<a id="L426" name="L426"></a> 426     <em class="brace">{</em>
<a id="L427" name="L427"></a> 427       m_predicates[i].<a href="../D/16440.html" title="Multiple defined in 31 places.">fixupVariables</a>(vars, globalsSize);
<a id="L428" name="L428"></a> 428     <em class="brace">}</em>
<a id="L429" name="L429"></a> 429   <em class="brace">}</em>
<a id="L430" name="L430"></a> 430 
<a id="L431" name="L431"></a> 431 
<div class="comment">
    Diagnostics.
    @param n Node to give diagnostic information about, or null.
    @return Informative string about the argument.</div>
<a id="L439" name="L439"></a> 439   <strong class="reserved">protected</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/23756.html" title="Multiple referred from 3 places.">nodeToString</a>(<strong class="reserved">int</strong> n)
<a id="L440" name="L440"></a> 440   <em class="brace">{</em>
<a id="L441" name="L441"></a> 441     <strong class="reserved">if</strong>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != n)
<a id="L442" name="L442"></a> 442     <em class="brace">{</em>
<a id="L443" name="L443"></a> 443       <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm = m_lpi.<a href="../D/23775.html" title="Multiple defined in 5 places.">getXPathContext</a>().<a href="../D/18175.html" title="Multiple defined in 19 places.">getDTM</a>(n);
<a id="L444" name="L444"></a> 444       <strong class="reserved">return</strong> dtm.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>(n) + "{" + (n+1) + "}";
<a id="L445" name="L445"></a> 445     <em class="brace">}</em>
<a id="L446" name="L446"></a> 446     <strong class="reserved">else</strong>
<a id="L447" name="L447"></a> 447     <em class="brace">{</em>
<a id="L448" name="L448"></a> 448       <strong class="reserved">return</strong> "null";
<a id="L449" name="L449"></a> 449     <em class="brace">}</em>
<a id="L450" name="L450"></a> 450   <em class="brace">}</em>
<a id="L451" name="L451"></a> 451 
<a id="L452" name="L452"></a> 452   <em class="comment">//=============== NodeFilter Implementation ===============</em>
<a id="L453" name="L453"></a> 453 
<div class="comment">
     Test whether a specified node is visible in the logical view of a
    TreeWalker or NodeIterator. This function will be called by the
    implementation of TreeWalker and NodeIterator; it is not intended to
    be called directly from user code.
    @param n  The node to check to see if it passes the filter or not.
    @return  a constant to determine whether the node is accepted,
      rejected, or skipped, as defined  above .</div>
<a id="L463" name="L463"></a> 463   <strong class="reserved">public</strong> <strong class="reserved">short</strong> <a href="../R/9519.html" title="Multiple referred from 29 places.">acceptNode</a>(<strong class="reserved">int</strong> n)
<a id="L464" name="L464"></a> 464   <em class="brace">{</em>
<a id="L465" name="L465"></a> 465 
<a id="L466" name="L466"></a> 466     <a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt = m_lpi.<a href="../D/23775.html" title="Multiple defined in 5 places.">getXPathContext</a>();
<a id="L467" name="L467"></a> 467 
<a id="L468" name="L468"></a> 468     <strong class="reserved">try</strong>
<a id="L469" name="L469"></a> 469     <em class="brace">{</em>
<a id="L470" name="L470"></a> 470       xctxt.<a href="../S/4946.html#L750" title="Defined at 750 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushCurrentNode</a>(n);
<a id="L471" name="L471"></a> 471 
<a id="L472" name="L472"></a> 472       <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> score = <a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt, n);
<a id="L473" name="L473"></a> 473 
<a id="L474" name="L474"></a> 474       <em class="comment">// System.out.println("\n::acceptNode - score: "+score.num()+"::");</em>
<a id="L475" name="L475"></a> 475       <strong class="reserved">if</strong> (score != <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE)
<a id="L476" name="L476"></a> 476       <em class="brace">{</em>
<a id="L477" name="L477"></a> 477         <strong class="reserved">if</strong> (<a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>() &gt; 0)
<a id="L478" name="L478"></a> 478         <em class="brace">{</em>
<a id="L479" name="L479"></a> 479           <a href="../D/13576.html" title="Multiple defined in 3 places.">countProximityPosition</a>(0);
<a id="L480" name="L480"></a> 480 
<a id="L481" name="L481"></a> 481           <strong class="reserved">if</strong> (!<a href="../D/15809.html" title="Multiple defined in 2 places.">executePredicates</a>(n, xctxt))
<a id="L482" name="L482"></a> 482             <strong class="reserved">return</strong> <a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a>.FILTER_SKIP;
<a id="L483" name="L483"></a> 483         <em class="brace">}</em>
<a id="L484" name="L484"></a> 484 
<a id="L485" name="L485"></a> 485         <strong class="reserved">return</strong> <a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a>.FILTER_ACCEPT;
<a id="L486" name="L486"></a> 486       <em class="brace">}</em>
<a id="L487" name="L487"></a> 487     <em class="brace">}</em>
<a id="L488" name="L488"></a> 488     <strong class="reserved">catch</strong> (<a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a> se)
<a id="L489" name="L489"></a> 489     <em class="brace">{</em>
<a id="L490" name="L490"></a> 490 
<a id="L491" name="L491"></a> 491       <em class="comment">// TODO: Fix this.</em>
<a id="L492" name="L492"></a> 492       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>(se.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L493" name="L493"></a> 493     <em class="brace">}</em>
<a id="L494" name="L494"></a> 494     <strong class="reserved">finally</strong>
<a id="L495" name="L495"></a> 495     <em class="brace">{</em>
<a id="L496" name="L496"></a> 496       xctxt.<a href="../S/4946.html#L758" title="Defined at 758 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popCurrentNode</a>();
<a id="L497" name="L497"></a> 497     <em class="brace">}</em>
<a id="L498" name="L498"></a> 498 
<a id="L499" name="L499"></a> 499     <strong class="reserved">return</strong> <a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a>.FILTER_SKIP;
<a id="L500" name="L500"></a> 500   <em class="brace">}</em>
<a id="L501" name="L501"></a> 501 
<a id="L502" name="L502"></a> 502 
<div class="comment">
    Get the owning location path iterator.
    @return the owning location path iterator, which should not be null.</div>
<a id="L508" name="L508"></a> 508   <strong class="reserved">public</strong> <a href="../S/4876.html#L51" title="Defined at 51 in src/com/sun/org/apache/xpath/internal/axes/LocPathIterator.java.">LocPathIterator</a> <a href="../S/4960.html#L63" title="Referred from 63 in src/com/sun/org/apache/xpath/internal/functions/FuncCurrent.java.">getLocPathIterator</a>()
<a id="L509" name="L509"></a> 509   <em class="brace">{</em>
<a id="L510" name="L510"></a> 510     <strong class="reserved">return</strong> m_lpi;
<a id="L511" name="L511"></a> 511   <em class="brace">}</em>
<a id="L512" name="L512"></a> 512 
<div class="comment">
    Set the location path iterator owner for this walker.  Besides
    initialization, this function is called during cloning operations.
    @param li non-null reference to the owning location path iterator.</div>
<a id="L519" name="L519"></a> 519   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27681.html" title="Multiple referred from 3 places.">setLocPathIterator</a>(<a href="../S/4876.html#L51" title="Defined at 51 in src/com/sun/org/apache/xpath/internal/axes/LocPathIterator.java.">LocPathIterator</a> li)
<a id="L520" name="L520"></a> 520   <em class="brace">{</em>
<a id="L521" name="L521"></a> 521     m_lpi = li;
<a id="L522" name="L522"></a> 522     <strong class="reserved">if</strong>(<strong class="reserved">this</strong> != li)
<a id="L523" name="L523"></a> 523       li.<a href="../D/15890.html" title="Multiple defined in 3 places.">exprSetParent</a>(<strong class="reserved">this</strong>);
<a id="L524" name="L524"></a> 524   <em class="brace">}</em>
<a id="L525" name="L525"></a> 525 
<div class="comment">
    Tell if this expression or it's subexpressions can traverse outside
    the current subtree.
    @return true if traversal outside the context node's subtree can occur.</div>
<a id="L532" name="L532"></a> 532    <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/10909.html" title="Multiple referred from 14 places.">canTraverseOutsideSubtree</a>()
<a id="L533" name="L533"></a> 533    <em class="brace">{</em>
<a id="L534" name="L534"></a> 534     <strong class="reserved">int</strong> n = <a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>();
<a id="L535" name="L535"></a> 535     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L536" name="L536"></a> 536     <em class="brace">{</em>
<a id="L537" name="L537"></a> 537       <strong class="reserved">if</strong>(<a href="../D/21564.html" title="Multiple defined in 2 places.">getPredicate</a>(i).<a href="../D/12178.html" title="Multiple defined in 11 places.">canTraverseOutsideSubtree</a>())
<a id="L538" name="L538"></a> 538         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L539" name="L539"></a> 539     <em class="brace">}</em>
<a id="L540" name="L540"></a> 540     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L541" name="L541"></a> 541    <em class="brace">}</em>
<a id="L542" name="L542"></a> 542 
<div class="comment">
          This will traverse the heararchy, calling the visitor for
          each member.  If the called visitor method returns
          false, the subtree should not be called.
          @param visitor The visitor whose appropriate method will be called.</div>
<a id="L550" name="L550"></a> 550         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/10856.html" title="Multiple referred from 5 places.">callPredicateVisitors</a>(<a href="../S/4945.html#L53" title="Defined at 53 in src/com/sun/org/apache/xpath/internal/XPathVisitor.java.">XPathVisitor</a> visitor)
<a id="L551" name="L551"></a> 551         <em class="brace">{</em>
<a id="L552" name="L552"></a> 552           <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_predicates)
<a id="L553" name="L553"></a> 553             <em class="brace">{</em>
<a id="L554" name="L554"></a> 554             <strong class="reserved">int</strong> n = m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L555" name="L555"></a> 555             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L556" name="L556"></a> 556               <em class="brace">{</em>
<a id="L557" name="L557"></a> 557               <a href="../S/4989.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/ExpressionOwner.java.">ExpressionOwner</a> predOwner = <strong class="reserved">new</strong> <a href="../D/6787.html" title="Multiple defined in 2 places.">PredOwner</a>(i);
<a id="L558" name="L558"></a> 558               <strong class="reserved">if</strong> (visitor.<a href="../D/36692.html" title="Multiple defined in 2 places.">visitPredicate</a>(predOwner, m_predicates[i]))
<a id="L559" name="L559"></a> 559                 <em class="brace">{</em>
<a id="L560" name="L560"></a> 560                 m_predicates[i].<a href="../D/12116.html" title="Multiple defined in 16 places.">callVisitors</a>(predOwner, visitor);
<a id="L561" name="L561"></a> 561               <em class="brace">}</em>
<a id="L562" name="L562"></a> 562 
<a id="L563" name="L563"></a> 563             <em class="brace">}</em>
<a id="L564" name="L564"></a> 564           <em class="brace">}</em>
<a id="L565" name="L565"></a> 565         <em class="brace">}</em>
<a id="L566" name="L566"></a> 566 
<div class="comment">
      @see Expression#deepEquals(Expression)</div>
<a id="L570" name="L570"></a> 570     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13134.html" title="Multiple referred from 37 places.">deepEquals</a>(<a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>)
<a id="L571" name="L571"></a> 571     <em class="brace">{</em>
<a id="L572" name="L572"></a> 572       <strong class="reserved">if</strong> (!<strong class="reserved">super</strong>.<a href="../D/14718.html" title="Multiple defined in 25 places.">deepEquals</a>(<a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>))
<a id="L573" name="L573"></a> 573             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L574" name="L574"></a> 574 
<a id="L575" name="L575"></a> 575       <a href="../S/4867.html#L36" title="Defined at 36 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">PredicatedNodeTest</a> pnt = (<a href="../S/4867.html#L36" title="Defined at 36 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">PredicatedNodeTest</a>) <a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>;
<a id="L576" name="L576"></a> 576       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_predicates)
<a id="L577" name="L577"></a> 577       <em class="brace">{</em>
<a id="L578" name="L578"></a> 578 
<a id="L579" name="L579"></a> 579         <strong class="reserved">int</strong> n = m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L580" name="L580"></a> 580         <strong class="reserved">if</strong> ((<strong class="reserved">null</strong> == pnt.m_predicates) || (pnt.m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != n))
<a id="L581" name="L581"></a> 581               <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L582" name="L582"></a> 582         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L583" name="L583"></a> 583         <em class="brace">{</em>
<a id="L584" name="L584"></a> 584           <strong class="reserved">if</strong> (!m_predicates[i].<a href="../D/14718.html" title="Multiple defined in 25 places.">deepEquals</a>(pnt.m_predicates[i]))
<a id="L585" name="L585"></a> 585                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L586" name="L586"></a> 586         <em class="brace">}</em>
<a id="L587" name="L587"></a> 587       <em class="brace">}</em>
<a id="L588" name="L588"></a> 588       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != pnt.m_predicates)
<a id="L589" name="L589"></a> 589               <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L590" name="L590"></a> 590 
<a id="L591" name="L591"></a> 591       <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L592" name="L592"></a> 592     <em class="brace">}</em>
<a id="L593" name="L593"></a> 593 
<div class="comment">
   /** This is true if nextNode returns null. */</div>
<a id="L595" name="L595"></a> 595   <strong class="reserved">transient</strong> <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> m_foundLast = <strong class="reserved">false</strong>;
<a id="L596" name="L596"></a> 596 
<div class="comment">
 The owning location path iterator.
   *  @serial </div>
<a id="L599" name="L599"></a> 599   <strong class="reserved">protected</strong> <a href="../S/4876.html#L51" title="Defined at 51 in src/com/sun/org/apache/xpath/internal/axes/LocPathIterator.java.">LocPathIterator</a> m_lpi;
<a id="L600" name="L600"></a> 600 
<div class="comment">
    Which predicate we are executing.</div>
<a id="L604" name="L604"></a> 604   <strong class="reserved">transient</strong> <strong class="reserved">int</strong> m_predicateIndex = -1;
<a id="L605" name="L605"></a> 605 
<div class="comment">
 The list of predicate expressions. Is static and does not need
     to be deep cloned.
     @serial</div>
<a id="L610" name="L610"></a> 610   <strong class="reserved">private</strong> <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a>[] m_predicates;
<a id="L611" name="L611"></a> 611 
<div class="comment">
    An array of counts that correspond to the number
    of predicates the step contains.</div>
<a id="L616" name="L616"></a> 616   <strong class="reserved">transient</strong> <strong class="reserved">protected</strong> <strong class="reserved">int</strong>[] m_proximityPositions;
<a id="L617" name="L617"></a> 617 
<div class="comment">
   /** If true, diagnostic messages about predicate execution will be posted.  */</div>
<a id="L619" name="L619"></a> 619   <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> DEBUG_PREDICATECOUNTING = <strong class="reserved">false</strong>;
<a id="L620" name="L620"></a> 620 
<a id="L621" name="L621"></a> 621   <strong class="reserved">class</strong> <a href="../R/6184.html" title="Multiple referred from 2 places.">PredOwner</a> <strong class="reserved">implements</strong> <a href="../S/4989.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/ExpressionOwner.java.">ExpressionOwner</a>
<a id="L622" name="L622"></a> 622   <em class="brace">{</em>
<a id="L623" name="L623"></a> 623         <strong class="reserved">int</strong> m_index;
<a id="L624" name="L624"></a> 624 
<a id="L625" name="L625"></a> 625         PredOwner(<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>)
<a id="L626" name="L626"></a> 626         <em class="brace">{</em>
<a id="L627" name="L627"></a> 627                 m_index = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L628" name="L628"></a> 628         <em class="brace">}</em>
<a id="L629" name="L629"></a> 629 
<div class="comment">
      @see ExpressionOwner#getExpression()</div>
<a id="L633" name="L633"></a> 633     <strong class="reserved">public</strong> <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../R/16497.html" title="Multiple referred from 16 places.">getExpression</a>()
<a id="L634" name="L634"></a> 634     <em class="brace">{</em>
<a id="L635" name="L635"></a> 635       <strong class="reserved">return</strong> m_predicates[m_index];
<a id="L636" name="L636"></a> 636     <em class="brace">}</em>
<a id="L637" name="L637"></a> 637 
<a id="L638" name="L638"></a> 638 
<div class="comment">
      @see ExpressionOwner#setExpression(Expression)</div>
<a id="L642" name="L642"></a> 642     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27380.html" title="Multiple referred from 3 places.">setExpression</a>(<a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>)
<a id="L643" name="L643"></a> 643     <em class="brace">{</em>
<a id="L644" name="L644"></a> 644         <a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>.<a href="../D/15890.html" title="Multiple defined in 3 places.">exprSetParent</a>(<a href="../S/4867.html#L36" title="Defined at 36 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">PredicatedNodeTest</a>.<strong class="reserved">this</strong>);
<a id="L645" name="L645"></a> 645         m_predicates[m_index] = <a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>;
<a id="L646" name="L646"></a> 646     <em class="brace">}</em>
<a id="L647" name="L647"></a> 647   <em class="brace">}</em>
<a id="L648" name="L648"></a> 648 
<a id="L649" name="L649"></a> 649 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L66">[^]</a><a href="#L642">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>