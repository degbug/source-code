<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/lang/invoke/MethodHandles.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L92">[^]</a><a href="#L3098">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L92" title="Defined at 92.">lookup</a></li>
<li><a href="#L116" title="Defined at 116.">publicLookup</a></li>
<li><a href="#L143" title="Defined at 143.">reflectAs</a></li>
<li><a href="#L550" title="Defined at 550.">fixmods</a></li>
<li><a href="#L564" title="Defined at 564.">lookupClass</a></li>
<li><a href="#L569" title="Defined at 569.">lookupClassOrNull</a></li>
<li><a href="#L591" title="Defined at 591.">lookupModes</a></li>
<li><a href="#L635" title="Defined at 635.">in</a></li>
<li><a href="#L673" title="Defined at 673.">checkUnprivilegedlookupClass</a></li>
<li><a href="#L717" title="Defined at 717.">toString</a></li>
<li><a href="#L776" title="Defined at 776.">findStatic</a></li>
<li><a href="#L852" title="Defined at 852.">findVirtual</a></li>
<li><a href="#L861" title="Defined at 861.">findVirtualForMH</a></li>
<li><a href="#L918" title="Defined at 918.">findConstructor</a></li>
<li><a href="#L996" title="Defined at 996.">findSpecial</a></li>
<li><a href="#L1021" title="Defined at 1021.">findGetter</a></li>
<li><a href="#L1043" title="Defined at 1043.">findSetter</a></li>
<li><a href="#L1067" title="Defined at 1067.">findStaticGetter</a></li>
<li><a href="#L1091" title="Defined at 1091.">findStaticSetter</a></li>
<li><a href="#L1144" title="Defined at 1144.">bind</a></li>
<li><a href="#L1177" title="Defined at 1177.">unreflect</a></li>
<li><a href="#L1190" title="Defined at 1190.">unreflectForMH</a></li>
<li><a href="#L1226" title="Defined at 1226.">unreflectSpecial</a></li>
<li><a href="#L1259" title="Defined at 1259.">unreflectConstructor</a></li>
<li><a href="#L1284" title="Defined at 1284.">unreflectGetter</a></li>
<li><a href="#L1287" title="Defined at 1287.">unreflectField</a></li>
<li><a href="#L1314" title="Defined at 1314.">unreflectSetter</a></li>
<li><a href="#L1336" title="Defined at 1336.">revealDirect</a></li>
<li><a href="#L1369" title="Defined at 1369.">resolveOrFail</a></li>
<li><a href="#L1377" title="Defined at 1377.">resolveOrFail</a></li>
<li><a href="#L1386" title="Defined at 1386.">resolveOrFail</a></li>
<li><a href="#L1394" title="Defined at 1394.">checkSymbolicClass</a></li>
<li><a href="#L1402" title="Defined at 1402.">checkMethodName</a></li>
<li><a href="#L1413" title="Defined at 1413.">findBoundCallerClass</a></li>
<li><a href="#L1426" title="Defined at 1426.">hasPrivateAccess</a></li>
<li><a href="#L1435" title="Defined at 1435.">checkSecurityManager</a></li>
<li><a href="#L1460" title="Defined at 1460.">checkMethod</a></li>
<li><a href="#L1474" title="Defined at 1474.">checkField</a></li>
<li><a href="#L1485" title="Defined at 1485.">checkAccess</a></li>
<li><a href="#L1535" title="Defined at 1535.">accessFailedMessage</a></li>
<li><a href="#L1560" title="Defined at 1560.">checkSpecialCaller</a></li>
<li><a href="#L1571" title="Defined at 1571.">restrictProtectedReceiver</a></li>
<li><a href="#L1583" title="Defined at 1583.">restrictReceiver</a></li>
<li><a href="#L1598" title="Defined at 1598.">getDirectMethod</a></li>
<li><a href="#L1604" title="Defined at 1604.">getDirectMethodNoRestrict</a></li>
<li><a href="#L1610" title="Defined at 1610.">getDirectMethodNoSecurityManager</a></li>
<li><a href="#L1616" title="Defined at 1616.">getDirectMethodCommon</a></li>
<li><a href="#L1669" title="Defined at 1669.">maybeBindCaller</a></li>
<li><a href="#L1682" title="Defined at 1682.">getDirectField</a></li>
<li><a href="#L1687" title="Defined at 1687.">getDirectFieldNoSecurityManager</a></li>
<li><a href="#L1692" title="Defined at 1692.">getDirectFieldCommon</a></li>
<li><a href="#L1706" title="Defined at 1706.">getDirectConstructor</a></li>
<li><a href="#L1711" title="Defined at 1711.">getDirectConstructorNoSecurityManager</a></li>
<li><a href="#L1716" title="Defined at 1716.">getDirectConstructorCommon</a></li>
<li><a href="#L1730" title="Defined at 1730.">linkMethodHandleConstant</a></li>
<li><a href="#L1761" title="Defined at 1761.">canBeCached</a></li>
<li><a href="#L1793" title="Defined at 1793.">getDirectMethodForConstant</a></li>
<li><a href="#L1820" title="Defined at 1820.">arrayElementGetter</a></li>
<li><a href="#L1835" title="Defined at 1835.">arrayElementSetter</a></li>
<li><a href="#L1888" title="Defined at 1888.">spreadInvoker</a></li>
<li><a href="#L1931" title="Defined at 1931.">exactInvoker</a></li>
<li><a href="#L1970" title="Defined at 1970.">invoker</a></li>
<li><a href="#L1975" title="Defined at 1975.">basicInvoker</a></li>
<li><a href="#L2026" title="Defined at 2026.">explicitCastArguments</a></li>
<li><a href="#L2037" title="Defined at 2037.">explicitCastArgumentsChecks</a></li>
<li><a href="#L2103" title="Defined at 2103.">permuteArguments</a></li>
<li><a href="#L2175" title="Defined at 2175.">findFirstDupOrDrop</a></li>
<li><a href="#L2224" title="Defined at 2224.">permuteArgumentChecks</a></li>
<li><a href="#L2263" title="Defined at 2263.">constant</a></li>
<li><a href="#L2287" title="Defined at 2287.">identity</a></li>
<li><a href="#L2301" title="Defined at 2301.">makeIdentity</a></li>
<li><a href="#L2307" title="Defined at 2307.">zero</a></li>
<li><a href="#L2319" title="Defined at 2319.">makeZero</a></li>
<li><a href="#L2325" title="Defined at 2325.">setCachedMethodHandle</a></li>
<li><a href="#L2363" title="Defined at 2363.">insertArguments</a></li>
<li><a href="#L2381" title="Defined at 2381.">insertArgumentPrimitive</a></li>
<li><a href="#L2395" title="Defined at 2395.">insertArgumentsChecks</a></li>
<li><a href="#L2449" title="Defined at 2449.">dropArguments</a></li>
<li><a href="#L2464" title="Defined at 2464.">dropArgumentChecks</a></li>
<li><a href="#L2524" title="Defined at 2524.">dropArguments</a></li>
<li><a href="#L2594" title="Defined at 2594.">filterArguments</a></li>
<li><a href="#L2607" title="Defined at 2607.">filterArgument</a></li>
<li><a href="#L2619" title="Defined at 2619.">filterArgumentsCheckArity</a></li>
<li><a href="#L2626" title="Defined at 2626.">filterArgumentChecks</a></li>
<li><a href="#L2741" title="Defined at 2741.">collectArguments</a></li>
<li><a href="#L2756" title="Defined at 2756.">collectArgumentsChecks</a></li>
<li><a href="#L2828" title="Defined at 2828.">filterReturnValue</a></li>
<li><a href="#L2840" title="Defined at 2840.">filterReturnValueChecks</a></li>
<li><a href="#L2926" title="Defined at 2926.">foldArguments</a></li>
<li><a href="#L2942" title="Defined at 2942.">foldArgumentChecks</a></li>
<li><a href="#L2992" title="Defined at 2992.">guardWithTest</a></li>
<li><a href="#L3014" title="Defined at 3014.">misMatchedTypes</a></li>
<li><a href="#L3062" title="Defined at 3062.">catchException</a></li>
<li><a href="#L3098" title="Defined at 3098.">throwException</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2008, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../D/25050.html" title="Multiple defined in 52 places.">invoke</a>;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.lang.reflect.*;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.util.BitSet;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.util.List;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.util.Arrays;
<a id="L32" name="L32"></a>  32 
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> sun.invoke.util.ValueConversions;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> sun.invoke.util.VerifyAccess;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> sun.invoke.util.Wrapper;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> sun.reflect.CallerSensitive;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> sun.reflect.Reflection;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> sun.reflect.misc.ReflectUtil;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> sun.security.util.SecurityConstants;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.lang.invoke.LambdaForm.BasicType;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> static java.lang.invoke.LambdaForm.BasicType.*;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandleStatics.*;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandleImpl.Intrinsic;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandleNatives.Constants.*;
<a id="L45" name="L45"></a>  45 
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> java.util.concurrent.ConcurrentHashMap;
<a id="L47" name="L47"></a>  47 
<div class="comment">
  This class consists exclusively of static methods that operate on or return
  method handles. They fall into several categories:
  <ul><li>Lookup methods which help create method handles for methods and fields.
  </li><li>Combinator methods, which combine or transform pre-existing method handles into new ones.
  </li><li>Other factory methods to create method handles that emulate other common JVM operations or control flow patterns.
  </li></ul>
  <p>
  @author John Rose, JSR 292 EG
  @since 1.7</p></div>
<a id="L60" name="L60"></a>  60 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/5120.html" title="Multiple referred from 35 places.">MethodHandles</a> <em class="brace">{</em>
<a id="L61" name="L61"></a>  61 
<a id="L62" name="L62"></a>  62     <strong class="reserved">private</strong> MethodHandles() <em class="brace">{</em> <em class="brace">}</em>  <em class="comment">// do not instantiate</em>
<a id="L63" name="L63"></a>  63 
<a id="L64" name="L64"></a>  64     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../D/3122.html" title="Multiple defined in 4 places.">Factory</a> IMPL_NAMES = <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../D/18981.html" title="Multiple defined in 13 places.">getFactory</a>();
<a id="L65" name="L65"></a>  65     <strong class="reserved">static</strong> <em class="brace">{</em> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L66" title="Defined at 66 in src/java/lang/invoke/MethodHandleImpl.java.">initStatics</a>(); <em class="brace">}</em>
<a id="L66" name="L66"></a>  66     <em class="comment">// See IMPL_LOOKUP below.</em>
<a id="L67" name="L67"></a>  67 
<a id="L68" name="L68"></a>  68     <em class="comment">//// Method handle creation from ordinary methods.</em>
<a id="L69" name="L69"></a>  69 
<div class="comment">
      Returns a <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> with
      full capabilities to emulate all supported bytecode behaviors of the caller.
      These capabilities include <a href="MethodHandles.Lookup.html#privacc">private access</a> to the caller.
      Factory methods on the lookup object can create
      <a href="MethodHandleInfo.html#directmh">direct method handles</a>
      for any member that the caller has access to via bytecodes,
      including protected and private fields and methods.
      This lookup object is a <em>capability</em> which may be delegated to trusted agents.
      Do not store it in place where untrusted code can access it.
      <p>
      This method is caller sensitive, which means that it may return different
      values to different callers.
      </p><p>
      For any given caller class <code>C</code>, the lookup object returned by this call
      has equivalent capabilities to any lookup object
      supplied by the JVM to the bootstrap method of an
      <a href="package-summary.html#indyinsn">invokedynamic instruction</a>
      executing in the same caller class <code>C</code>.
      @return a lookup object for the caller of this method, with private access</p></div>
<a id="L91" name="L91"></a>  91     @CallerSensitive
<a id="L92" name="L92"></a>  92     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../R/22724.html" title="Multiple referred from 149 places.">lookup</a>() <em class="brace">{</em>
<a id="L93" name="L93"></a>  93         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(Reflection.getCallerClass());
<a id="L94" name="L94"></a>  94     <em class="brace">}</em>
<a id="L95" name="L95"></a>  95 
<div class="comment">
      Returns a <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> which is trusted minimally.
      It can only be used to create method handles to
      publicly accessible fields and methods.
      <p>
      As a matter of pure convention, the {@linkplain Lookup#lookupClass lookup class}
      of this lookup object will be {@link java.lang.Object}.
      </p><p style="font-size:smaller;">
      <em>Discussion:</em>
      The lookup class can be changed to any other class <code>C</code> using an expression of the form
      {@link Lookup#in publicLookup().in(C.class)}.
      Since all classes have equal access to public names,
      such a change would confer no new access rights.
      A public lookup object is always subject to
      <a href="MethodHandles.Lookup.html#secmgr">security manager checks</a>.
      Also, it cannot access
      <a href="MethodHandles.Lookup.html#callsens">caller sensitive methods</a>.
      @return a lookup object which is trusted minimally</p></div>
<a id="L116" name="L116"></a> 116     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../S/1619.html#L1784" title="Referred from 1784 in src/java/lang/invoke/MethodHandles.java.">publicLookup</a>() <em class="brace">{</em>
<a id="L117" name="L117"></a> 117         <strong class="reserved">return</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>.PUBLIC_LOOKUP;
<a id="L118" name="L118"></a> 118     <em class="brace">}</em>
<a id="L119" name="L119"></a> 119 
<div class="comment">
      Performs an unchecked "crack" of a
      <a href="MethodHandleInfo.html#directmh">direct method handle</a>.
      The result is as if the user had obtained a lookup object capable enough
      to crack the target method handle, called
      {@link java.lang.invoke.MethodHandles.Lookup#revealDirect Lookup.revealDirect}
      on the target to obtain its symbolic reference, and then called
      {@link java.lang.invoke.MethodHandleInfo#reflectAs MethodHandleInfo.reflectAs}
      to resolve the symbolic reference to a member.
      <p>
      If there is a security manager, its <code>checkPermission</code> method
      is called with a <code>ReflectPermission("suppressAccessChecks")</code> permission.
      @param <t> the desired type of the result, either <a href="../S/1664.html#L40" title="Defined at 40 in src/java/lang/reflect/Member.java.">Member</a> or a subtype
      @param target a direct method handle to crack into symbolic reference components
      @param expected a class object representing the desired result type <code>T</code>
      @return a reference to the method, constructor, or field object
      @exception SecurityException if the caller is not privileged to call <code>setAccessible</code>
      @exception NullPointerException if either argument is <code>null</code>
      @exception IllegalArgumentException if the target is not a direct method handle
      @exception ClassCastException if the member is not of the expected type
      @since 1.8</t></p></div>
<a id="L142" name="L142"></a> 142     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> <strong class="reserved">extends</strong> <a href="../S/1664.html#L40" title="Defined at 40 in src/java/lang/reflect/Member.java.">Member</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>
<a id="L143" name="L143"></a> 143     <a href="../S/1619.html#L147" title="Referred from 147 in src/java/lang/invoke/MethodHandles.java.">reflectAs</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; expected, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>) <em class="brace">{</em>
<a id="L144" name="L144"></a> 144         <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> smgr = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>();
<a id="L145" name="L145"></a> 145         <strong class="reserved">if</strong> (smgr != <strong class="reserved">null</strong>)  smgr.<a href="../D/12594.html" title="Multiple defined in 22 places.">checkPermission</a>(ACCESS_PERMISSION);
<a id="L146" name="L146"></a> 146         <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a> = <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>.IMPL_LOOKUP;  <em class="comment">// use maximally privileged lookup</em>
<a id="L147" name="L147"></a> 147         <strong class="reserved">return</strong> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>.<a href="../S/1619.html#L1336" title="Defined at 1336 in src/java/lang/invoke/MethodHandles.java.">revealDirect</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>).<a href="../D/30502.html" title="Multiple defined in 3 places.">reflectAs</a>(expected, <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>);
<a id="L148" name="L148"></a> 148     <em class="brace">}</em>
<a id="L149" name="L149"></a> 149     <em class="comment">// Copied from AccessibleObject, as used by Method.setAccessible, etc.:</em>
<a id="L150" name="L150"></a> 150     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">private</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.<a href="../D/6689.html" title="Multiple defined in 2 places.">Permission</a> ACCESS_PERMISSION =
<a id="L151" name="L151"></a> 151         <strong class="reserved">new</strong> <a href="../S/1669.html#L75" title="Defined at 75 in src/java/lang/reflect/ReflectPermission.java.">ReflectPermission</a>("suppressAccessChecks");
<a id="L152" name="L152"></a> 152 
<div class="comment">
      A <em>lookup object</em> is a factory for creating method handles,
      when the creation requires access checking.
      Method handles do not perform
      access checks when they are called, but rather when they are created.
      Therefore, method handle access
      restrictions must be enforced when a method handle is created.
      The caller class against which those restrictions are enforced
      is known as the {@linkplain #lookupClass lookup class}.
      <p>
      A lookup class which needs to create method handles will call
      {@link MethodHandles#lookup MethodHandles.lookup} to create a factory for itself.
      When the <code>Lookup</code> factory object is created, the identity of the lookup class is
      determined, and securely stored in the <code>Lookup</code> object.
      The lookup class (or its delegates) may then use factory methods
      on the <code>Lookup</code> object to create method handles for access-checked members.
      This includes all methods, constructors, and fields which are allowed to the lookup class,
      even private ones.
      </p><h1><a name="lookups"></a>Lookup Factory Methods</h1>
      The factory methods on a <code>Lookup</code> object correspond to all major
      use cases for methods, constructors, and fields.
      Each method handle created by a factory method is the functional
      equivalent of a particular <em>bytecode behavior</em>.
      (Bytecode behaviors are described in section 5.4.3.5 of the Java Virtual Machine Specification.)
      Here is a summary of the correspondence between these factory methods and
      the behavior the resulting method handles:
      <table border="1" cellpadding="5" summary="lookup method behaviors">
      <tbody><tr>
          <th><a name="equiv"></a>lookup expression</th>
          <th>member</th>
          <th>bytecode behavior</th>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#findGetter lookup.findGetter(C.class,"f",FT.class)}</td>
          <td><code>FT f;</code></td><td><code>(T) this.f;</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#findStaticGetter lookup.findStaticGetter(C.class,"f",FT.class)}</td>
          <td><code>static</code><br><code>FT f;</code></td><td><code>(T) C.f;</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#findSetter lookup.findSetter(C.class,"f",FT.class)}</td>
          <td><code>FT f;</code></td><td><code>this.f = x;</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#findStaticSetter lookup.findStaticSetter(C.class,"f",FT.class)}</td>
          <td><code>static</code><br><code>FT f;</code></td><td><code>C.f = arg;</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#findVirtual lookup.findVirtual(C.class,"m",MT)}</td>
          <td><code>T m(A*);</code></td><td><code>(T) this.m(arg*);</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#findStatic lookup.findStatic(C.class,"m",MT)}</td>
          <td><code>static</code><br><code>T m(A*);</code></td><td><code>(T) C.m(arg*);</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#findSpecial lookup.findSpecial(C.class,"m",MT,this.class)}</td>
          <td><code>T m(A*);</code></td><td><code>(T) super.m(arg*);</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#findConstructor lookup.findConstructor(C.class,MT)}</td>
          <td><code>C(A*);</code></td><td><code>new C(arg*);</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#unreflectGetter lookup.unreflectGetter(aField)}</td>
          <td>(<code>static</code>)?<br><code>FT f;</code></td><td><code>(FT) aField.get(thisOrNull);</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#unreflectSetter lookup.unreflectSetter(aField)}</td>
          <td>(<code>static</code>)?<br><code>FT f;</code></td><td><code>aField.set(thisOrNull, arg);</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#unreflect lookup.unreflect(aMethod)}</td>
          <td>(<code>static</code>)?<br><code>T m(A*);</code></td><td><code>(T) aMethod.invoke(thisOrNull, arg*);</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#unreflectConstructor lookup.unreflectConstructor(aConstructor)}</td>
          <td><code>C(A*);</code></td><td><code>(C) aConstructor.newInstance(arg*);</code></td>
      </tr>
      <tr>
          <td>{@link java.lang.invoke.MethodHandles.Lookup#unreflect lookup.unreflect(aMethod)}</td>
          <td>(<code>static</code>)?<br><code>T m(A*);</code></td><td><code>(T) aMethod.invoke(thisOrNull, arg*);</code></td>
      </tr>
      </tbody></table>
      Here, the type <code>C</code> is the class or interface being searched for a member,
      documented as a parameter named <code>refc</code> in the lookup methods.
      The method type <code>MT</code> is composed from the return type <code>T</code>
      and the sequence of argument types <code>A*</code>.
      The constructor also has a sequence of argument types <code>A*</code> and
      is deemed to return the newly-created object of type <code>C</code>.
      Both <code>MT</code> and the field type <code>FT</code> are documented as a parameter named <code>type</code>.
      The formal parameter <code>this</code> stands for the self-reference of type <code>C</code>;
      if it is present, it is always the leading argument to the method handle invocation.
      (In the case of some <code>protected</code> members, <code>this</code> may be
      restricted in type to the lookup class; see below.)
      The name <code>arg</code> stands for all the other method handle arguments.
      In the code examples for the Core Reflection API, the name <code>thisOrNull</code>
      stands for a null reference if the accessed method or field is static,
      and <code>this</code> otherwise.
      The names <code>aMethod</code>, <code>aField</code>, and <code>aConstructor</code> stand
      for reflective objects corresponding to the given members.
      <p>
      In cases where the given member is of variable arity (i.e., a method or constructor)
      the returned method handle will also be of {@linkplain MethodHandle#asVarargsCollector variable arity}.
      In all other cases, the returned method handle will be of fixed arity.
      </p><p style="font-size:smaller;">
      <em>Discussion:</em>
      The equivalence between looked-up method handles and underlying
      class members and bytecode behaviors
      can break down in a few ways:
      </p><ul style="font-size:smaller;">
      <li>If <code>C</code> is not symbolically accessible from the lookup class's loader,
      the lookup can still succeed, even when there is no equivalent
      Java expression or bytecoded constant.
      </li><li>Likewise, if <code>T</code> or <code>MT</code>
      is not symbolically accessible from the lookup class's loader,
      the lookup can still succeed.
      For example, lookups for <code>MethodHandle.invokeExact</code> and
      <code>MethodHandle.invoke</code> will always succeed, regardless of requested type.
      </li><li>If there is a security manager installed, it can forbid the lookup
      on various grounds (<a href="MethodHandles.Lookup.html#secmgr">see below</a>).
      By contrast, the <code>ldc</code> instruction on a <code>CONSTANT_MethodHandle</code>
      constant is not subject to security manager checks.
      </li><li>If the looked-up method has a
      <a href="MethodHandle.html#maxarity">very large arity</a>,
      the method handle creation may fail, due to the method handle
      type having too many parameters.
      </li></ul>
      <h1><a name="access"></a>Access checking</h1>
      Access checks are applied in the factory methods of <code>Lookup</code>,
      when a method handle is created.
      This is a key difference from the Core Reflection API, since
      {@link java.lang.reflect.Method#invoke java.lang.reflect.Method.invoke}
      performs access checking against every caller, on every call.
      <p>
      All access checks start from a <code>Lookup</code> object, which
      compares its recorded lookup class against all requests to
      create method handles.
      A single <code>Lookup</code> object can be used to create any number
      of access-checked method handles, all checked against a single
      lookup class.
      </p><p>
      A <code>Lookup</code> object can be shared with other trusted code,
      such as a metaobject protocol.
      A shared <code>Lookup</code> object delegates the capability
      to create method handles on private members of the lookup class.
      Even if privileged code uses the <code>Lookup</code> object,
      the access checking is confined to the privileges of the
      original lookup class.
      </p><p>
      A lookup can fail, because
      the containing class is not accessible to the lookup class, or
      because the desired class member is missing, or because the
      desired class member is not accessible to the lookup class, or
      because the lookup object is not trusted enough to access the member.
      In any of these cases, a <code>ReflectiveOperationException</code> will be
      thrown from the attempted lookup.  The exact class will be one of
      the following:
      </p><ul><li>NoSuchMethodException — if a method is requested but does not exist
      </li><li>NoSuchFieldException — if a field is requested but does not exist
      </li><li>IllegalAccessException — if the member exists but an access check fails
      </li></ul>
      <p>
      In general, the conditions under which a method handle may be
      looked up for a method <code>M</code> are no more restrictive than the conditions
      under which the lookup class could have compiled, verified, and resolved a call to <code>M</code>.
      Where the JVM would raise exceptions like <code>NoSuchMethodError</code>,
      a method handle lookup will generally raise a corresponding
      checked exception, such as <code>NoSuchMethodException</code>.
      And the effect of invoking the method handle resulting from the lookup
      is <a href="MethodHandles.Lookup.html#equiv">exactly equivalent</a>
      to executing the compiled, verified, and resolved call to <code>M</code>.
      The same point is true of fields and constructors.
      </p><p style="font-size:smaller;">
      <em>Discussion:</em>
      Access checks only apply to named and reflected methods,
      constructors, and fields.
      Other method handle creation methods, such as
      {@link MethodHandle#asType MethodHandle.asType},
      do not require any access checks, and are used
      independently of any <code>Lookup</code> object.
      </p><p>
      If the desired member is <code>protected</code>, the usual JVM rules apply,
      including the requirement that the lookup class must be either be in the
      same package as the desired member, or must inherit that member.
      (See the Java Virtual Machine Specification, sections 4.9.2, 5.4.3.5, and 6.4.)
      In addition, if the desired member is a non-static field or method
      in a different package, the resulting method handle may only be applied
      to objects of the lookup class or one of its subclasses.
      This requirement is enforced by narrowing the type of the leading
      <code>this</code> parameter from <code>C</code>
      (which will necessarily be a superclass of the lookup class)
      to the lookup class itself.
      </p><p>
      The JVM imposes a similar requirement on <code>invokespecial</code> instruction,
      that the receiver argument must match both the resolved method <em>and</em>
      the current class.  Again, this requirement is enforced by narrowing the
      type of the leading parameter to the resulting method handle.
      (See the Java Virtual Machine Specification, section 4.10.1.9.)
      </p><p>
      The JVM represents constructors and static initializer blocks as internal methods
      with special names (<code>"<init>"</init></code> and <code>"<clinit>"</clinit></code>).
      The internal syntax of invocation instructions allows them to refer to such internal
      methods as if they were normal methods, but the JVM bytecode verifier rejects them.
      A lookup of such an internal method will produce a <code>NoSuchMethodException</code>.
      </p><p>
      In some cases, access between nested classes is obtained by the Java compiler by creating
      an wrapper method to access a private method of another class
      in the same top-level declaration.
      For example, a nested class <code>C.D</code>
      can access private members within other related classes such as
      <code>C</code>, <code>C.D.E</code>, or <code>C.B</code>,
      but the Java compiler may need to generate wrapper methods in
      those related classes.  In such cases, a <code>Lookup</code> object on
      <code>C.E</code> would be unable to those private members.
      A workaround for this limitation is the {@link Lookup#in Lookup.in} method,
      which can transform a lookup on <code>C.E</code> into one on any of those other
      classes, without special elevation of privilege.
      </p><p>
      The accesses permitted to a given lookup object may be limited,
      according to its set of <a href="#L591" title="Defined at 591.">lookupModes</a>,
      to a subset of members normally accessible to the lookup class.
      For example, the {@link MethodHandles#publicLookup publicLookup}
      method produces a lookup object which is only allowed to access
      public members in public classes.
      The caller sensitive method {@link MethodHandles#lookup lookup}
      produces a lookup object with full capabilities relative to
      its caller class, to emulate all supported bytecode behaviors.
      Also, the {@link Lookup#in Lookup.in} method may produce a lookup object
      with fewer access modes than the original lookup object.
      </p><p style="font-size:smaller;">
      <a name="privacc"></a>
      <em>Discussion of private access:</em>
      We say that a lookup has <em>private access</em>
      if its {@linkplain #lookupModes lookup modes}
      include the possibility of accessing <code>private</code> members.
      As documented in the relevant methods elsewhere,
      only lookups with private access possess the following capabilities:
      </p><ul style="font-size:smaller;">
      <li>access private fields, methods, and constructors of the lookup class
      </li><li>create method handles which invoke <a href="MethodHandles.Lookup.html#callsens">caller sensitive</a> methods,
          such as <code>Class.forName</code>
      </li><li>create method handles which {@link Lookup#findSpecial emulate invokespecial} instructions
      </li><li>avoid <a href="MethodHandles.Lookup.html#secmgr">package access checks</a>
          for classes accessible to the lookup class
      </li><li>create {@link Lookup#in delegated lookup objects} which have private access to other classes
          within the same package member
      </li></ul>
      <p style="font-size:smaller;">
      Each of these permissions is a consequence of the fact that a lookup object
      with private access can be securely traced back to an originating class,
      whose <a href="MethodHandles.Lookup.html#equiv">bytecode behaviors</a> and Java language access permissions
      can be reliably determined and emulated by method handles.
      </p><h1><a name="secmgr"></a>Security manager interactions</h1>
      Although bytecode instructions can only refer to classes in
      a related class loader, this API can search for methods in any
      class, as long as a reference to its <code>Class</code> object is
      available.  Such cross-loader references are also possible with the
      Core Reflection API, and are impossible to bytecode instructions
      such as <code>invokestatic</code> or <code>getfield</code>.
      There is a {@linkplain java.lang.SecurityManager security manager API}
      to allow applications to check such cross-loader references.
      These checks apply to both the <code>MethodHandles.Lookup</code> API
      and the Core Reflection API
      (as found on {@link java.lang.Class Class}).
      <p>
      If a security manager is present, member lookups are subject to
      additional checks.
      From one to three calls are made to the security manager.
      Any of these calls can refuse access by throwing a
      {@link java.lang.SecurityException SecurityException}.
      Define <code>smgr</code> as the security manager,
      <code>lookc</code> as the lookup class of the current lookup object,
      <code>refc</code> as the containing class in which the member
      is being sought, and <code>defc</code> as the class in which the
      member is actually defined.
      The value <code>lookc</code> is defined as <em>not present</em>
      if the current lookup object does not have
      <a href="MethodHandles.Lookup.html#privacc">private access</a>.
      The calls are made according to the following rules:
      </p><ul><li><b>Step 1:</b>
          If <code>lookc</code> is not present, or if its class loader is not
          the same as or an ancestor of the class loader of <code>refc</code>,
          then {@link SecurityManager#checkPackageAccess
          smgr.checkPackageAccess(refcPkg)} is called,
          where <code>refcPkg</code> is the package of <code>refc</code>.
      </li><li><b>Step 2:</b>
          If the retrieved member is not public and
          <code>lookc</code> is not present, then
          {@link SecurityManager#checkPermission smgr.checkPermission}
          with <code>RuntimePermission("accessDeclaredMembers")</code> is called.
      </li><li><b>Step 3:</b>
          If the retrieved member is not public,
          and if <code>lookc</code> is not present,
          and if <code>defc</code> and <code>refc</code> are different,
          then {@link SecurityManager#checkPackageAccess
          smgr.checkPackageAccess(defcPkg)} is called,
          where <code>defcPkg</code> is the package of <code>defc</code>.
      </li></ul>
      Security checks are performed after other access checks have passed.
      Therefore, the above rules presuppose a member that is public,
      or else that is being accessed from a lookup class that has
      rights to access the member.
      <h1><a name="callsens"></a>Caller sensitive methods</h1>
      A small number of Java methods have a special property called caller sensitivity.
      A <em>caller-sensitive</em> method can behave differently depending on the
      identity of its immediate caller.
      <p>
      If a method handle for a caller-sensitive method is requested,
      the general rules for <a href="MethodHandles.Lookup.html#equiv">bytecode behaviors</a> apply,
      but they take account of the lookup class in a special way.
      The resulting method handle behaves as if it were called
      from an instruction contained in the lookup class,
      so that the caller-sensitive method detects the lookup class.
      (By contrast, the invoker of the method handle is disregarded.)
      Thus, in the case of caller-sensitive methods,
      different lookup classes may give rise to
      differently behaving method handles.
      </p><p>
      In cases where the lookup object is
      {@link MethodHandles#publicLookup() publicLookup()},
      or some other lookup object without
      <a href="MethodHandles.Lookup.html#privacc">private access</a>,
      the lookup class is disregarded.
      In such cases, no caller-sensitive method handle can be created,
      access is forbidden, and the lookup fails with an
      <code>IllegalAccessException</code>.
      </p><p style="font-size:smaller;">
      <em>Discussion:</em>
      For example, the caller-sensitive method
      {@link java.lang.Class#forName(String) Class.forName(x)}
      can return varying classes or throw varying exceptions,
      depending on the class loader of the class that calls it.
      A public lookup of <code>Class.forName</code> will fail, because
      there is no reasonable way to determine its bytecode behavior.
      </p><p style="font-size:smaller;">
      If an application caches method handles for broad sharing,
      it should use <code>publicLookup()</code> to create them.
      If there is a lookup of <code>Class.forName</code>, it will fail,
      and the application must take appropriate action in that case.
      It may be that a later lookup, perhaps during the invocation of a
      bootstrap method, can incorporate the specific identity
      of the caller, making the method accessible.
      </p><p style="font-size:smaller;">
      The function <code>MethodHandles.lookup</code> is caller sensitive
      so that there can be a secure foundation for lookups.
      Nearly all other methods in the JSR 292 API rely on lookup
      objects to check access requests.</p></div>
<a id="L511" name="L511"></a> 511     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong>
<a id="L512" name="L512"></a> 512     <strong class="reserved">class</strong> <a href="../R/4792.html" title="Multiple referred from 36 places.">Lookup</a> <em class="brace">{</em>
<div class="comment">
         /** The class on behalf of whom the lookup is being performed. */</div>
<a id="L514" name="L514"></a> 514         <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L515" name="L515"></a> 515 
<div class="comment">
         /** The allowed sorts of members which may be looked up (PUBLIC, etc.). */</div>
<a id="L517" name="L517"></a> 517         <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> allowedModes;
<a id="L518" name="L518"></a> 518 
<div class="comment">
 A single-bit mask representing <code>public</code> access,
           which may contribute to the result of <a href="#L591" title="Defined at 591.">lookupModes</a>.
           The value, <code>0x01</code>, happens to be the same as the value of the
           <code>public</code> {@linkplain java.lang.reflect.Modifier#PUBLIC modifier bit}.</div>
<a id="L524" name="L524"></a> 524         <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PUBLIC = <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PUBLIC;
<a id="L525" name="L525"></a> 525 
<div class="comment">
 A single-bit mask representing <code>private</code> access,
           which may contribute to the result of <a href="#L591" title="Defined at 591.">lookupModes</a>.
           The value, <code>0x02</code>, happens to be the same as the value of the
           <code>private</code> {@linkplain java.lang.reflect.Modifier#PRIVATE modifier bit}.</div>
<a id="L531" name="L531"></a> 531         <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PRIVATE = <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PRIVATE;
<a id="L532" name="L532"></a> 532 
<div class="comment">
 A single-bit mask representing <code>protected</code> access,
           which may contribute to the result of <a href="#L591" title="Defined at 591.">lookupModes</a>.
           The value, <code>0x04</code>, happens to be the same as the value of the
           <code>protected</code> {@linkplain java.lang.reflect.Modifier#PROTECTED modifier bit}.</div>
<a id="L538" name="L538"></a> 538         <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PROTECTED = <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PROTECTED;
<a id="L539" name="L539"></a> 539 
<div class="comment">
 A single-bit mask representing <code>package</code> access (default access),
           which may contribute to the result of <a href="#L591" title="Defined at 591.">lookupModes</a>.
           The value is <code>0x08</code>, which does not correspond meaningfully to
           any particular {@linkplain java.lang.reflect.Modifier modifier bit}.</div>
<a id="L545" name="L545"></a> 545         <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PACKAGE = <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.STATIC;
<a id="L546" name="L546"></a> 546 
<a id="L547" name="L547"></a> 547         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> ALL_MODES = (PUBLIC | PRIVATE | PROTECTED | PACKAGE);
<a id="L548" name="L548"></a> 548         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> TRUSTED   = -1;
<a id="L549" name="L549"></a> 549 
<a id="L550" name="L550"></a> 550         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../S/1619.html#L1521" title="Referred from 1521 in src/java/lang/invoke/MethodHandles.java.">fixmods</a>(<strong class="reserved">int</strong> mods) <em class="brace">{</em>
<a id="L551" name="L551"></a> 551             mods &amp;= (ALL_MODES - PACKAGE);
<a id="L552" name="L552"></a> 552             <strong class="reserved">return</strong> (mods != 0) ? mods : PACKAGE;
<a id="L553" name="L553"></a> 553         <em class="brace">}</em>
<a id="L554" name="L554"></a> 554 
<div class="comment">
 Tells which class is performing the lookup.  It is this class against
           which checks are performed for visibility and access permissions.
           <p>
           The class implies a maximum level of access permission,
           but the permissions may be additionally limited by the bitmask
           <a href="#L591" title="Defined at 591.">lookupModes</a>, which controls whether non-public members
           can be accessed.
           @return the lookup class, on behalf of which this lookup object finds members</p></div>
<a id="L564" name="L564"></a> 564         <strong class="reserved">public</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../R/22730.html" title="Multiple referred from 80 places.">lookupClass</a>() <em class="brace">{</em>
<a id="L565" name="L565"></a> 565             <strong class="reserved">return</strong> <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L566" name="L566"></a> 566         <em class="brace">}</em>
<a id="L567" name="L567"></a> 567 
<a id="L568" name="L568"></a> 568         <em class="comment">// This is just for calling out to MethodHandleImpl.</em>
<a id="L569" name="L569"></a> 569         <strong class="reserved">private</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../R/22731.html" title="Multiple referred from 5 places.">lookupClassOrNull</a>() <em class="brace">{</em>
<a id="L570" name="L570"></a> 570             <strong class="reserved">return</strong> (allowedModes == TRUSTED) ? <strong class="reserved">null</strong> : <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L571" name="L571"></a> 571         <em class="brace">}</em>
<a id="L572" name="L572"></a> 572 
<div class="comment">
 Tells which access-protection classes of members this lookup object can produce.
           The result is a bit-mask of the bits
           {@linkplain #PUBLIC PUBLIC (0x01)},
           {@linkplain #PRIVATE PRIVATE (0x02)},
           {@linkplain #PROTECTED PROTECTED (0x04)},
           and {@linkplain #PACKAGE PACKAGE (0x08)}.
           <p>
           A freshly-created lookup object
           on the {@linkplain java.lang.invoke.MethodHandles#lookup() caller's class}
           has all possible bits set, since the caller class can access all its own members.
           A lookup object on a new lookup class
           {@linkplain java.lang.invoke.MethodHandles.Lookup#in created from a previous lookup object}
           may have some mode bits set to zero.
           The purpose of this is to restrict access via the new lookup object,
           so that it can access only names which can be reached by the original
           lookup object, and also by the new lookup class.
           @return the lookup modes, which limit the kinds of access performed by this lookup object</p></div>
<a id="L591" name="L591"></a> 591         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/1624.html#L117" title="Referred from 117 in src/java/lang/invoke/AbstractValidatingLambdaMetafactory.java.">lookupModes</a>() <em class="brace">{</em>
<a id="L592" name="L592"></a> 592             <strong class="reserved">return</strong> allowedModes &amp; ALL_MODES;
<a id="L593" name="L593"></a> 593         <em class="brace">}</em>
<a id="L594" name="L594"></a> 594 
<div class="comment">
 Embody the current class (the lookupClass) as a lookup class
          for method handle creation.
          Must be called by from a method in this package,
          which in turn is called by a method not in this package.</div>
<a id="L600" name="L600"></a> 600         Lookup(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>) <em class="brace">{</em>
<a id="L601" name="L601"></a> 601             <strong class="reserved">this</strong>(<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, ALL_MODES);
<a id="L602" name="L602"></a> 602             <em class="comment">// make sure we haven't accidentally picked up a privileged class:</em>
<a id="L603" name="L603"></a> 603             <a href="../S/1619.html#L673" title="Defined at 673 in src/java/lang/invoke/MethodHandles.java.">checkUnprivilegedlookupClass</a>(<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, ALL_MODES);
<a id="L604" name="L604"></a> 604         <em class="brace">}</em>
<a id="L605" name="L605"></a> 605 
<a id="L606" name="L606"></a> 606         <strong class="reserved">private</strong> Lookup(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, <strong class="reserved">int</strong> allowedModes) <em class="brace">{</em>
<a id="L607" name="L607"></a> 607             <strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a> = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L608" name="L608"></a> 608             <strong class="reserved">this</strong>.allowedModes = allowedModes;
<a id="L609" name="L609"></a> 609         <em class="brace">}</em>
<a id="L610" name="L610"></a> 610 
<div class="comment">
          Creates a lookup on the specified new lookup class.
          The resulting object will report the specified
          class as its own <a href="#L564" title="Defined at 564.">lookupClass</a>.
          <p>
          However, the resulting <code>Lookup</code> object is guaranteed
          to have no more access capabilities than the original.
          In particular, access capabilities can be lost as follows:</p><ul><li>If the new lookup class differs from the old one,
          protected members will not be accessible by virtue of inheritance.
          (Protected members may continue to be accessible because of package sharing.)
          </li><li>If the new lookup class is in a different package
          than the old one, protected and default (package) members will not be accessible.
          </li><li>If the new lookup class is not within the same package member
          as the old one, private members will not be accessible.
          </li><li>If the new lookup class is not accessible to the old lookup class,
          then no members, not even public members, will be accessible.
          (In all other cases, public members will continue to be accessible.)
          </li></ul>
          @param requestedLookupClass the desired lookup class for the new lookup object
          @return a lookup object which reports the desired lookup class
          @throws NullPointerException if the argument is null</div>
<a id="L635" name="L635"></a> 635         <strong class="reserved">public</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../R/20446.html" title="Multiple referred from 2320 places.">in</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; requestedLookupClass) <em class="brace">{</em>
<a id="L636" name="L636"></a> 636             requestedLookupClass.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// null check</em>
<a id="L637" name="L637"></a> 637             <strong class="reserved">if</strong> (allowedModes == TRUSTED)  <em class="comment">// IMPL_LOOKUP can make any lookup at all</em>
<a id="L638" name="L638"></a> 638                 <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(requestedLookupClass, ALL_MODES);
<a id="L639" name="L639"></a> 639             <strong class="reserved">if</strong> (requestedLookupClass == <strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>)
<a id="L640" name="L640"></a> 640                 <strong class="reserved">return</strong> <strong class="reserved">this</strong>;  <em class="comment">// keep same capabilities</em>
<a id="L641" name="L641"></a> 641             <strong class="reserved">int</strong> newModes = (allowedModes &amp; (ALL_MODES &amp; ~PROTECTED));
<a id="L642" name="L642"></a> 642             <strong class="reserved">if</strong> ((newModes &amp; PACKAGE) != 0
<a id="L643" name="L643"></a> 643                 &amp;&amp; !VerifyAccess.isSamePackage(<strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, requestedLookupClass)) <em class="brace">{</em>
<a id="L644" name="L644"></a> 644                 newModes &amp;= ~(PACKAGE|PRIVATE);
<a id="L645" name="L645"></a> 645             <em class="brace">}</em>
<a id="L646" name="L646"></a> 646             <em class="comment">// Allow nestmate lookups to be created without special privilege:</em>
<a id="L647" name="L647"></a> 647             <strong class="reserved">if</strong> ((newModes &amp; PRIVATE) != 0
<a id="L648" name="L648"></a> 648                 &amp;&amp; !VerifyAccess.isSamePackageMember(<strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, requestedLookupClass)) <em class="brace">{</em>
<a id="L649" name="L649"></a> 649                 newModes &amp;= ~PRIVATE;
<a id="L650" name="L650"></a> 650             <em class="brace">}</em>
<a id="L651" name="L651"></a> 651             <strong class="reserved">if</strong> ((newModes &amp; PUBLIC) != 0
<a id="L652" name="L652"></a> 652                 &amp;&amp; !VerifyAccess.isClassAccessible(requestedLookupClass, <strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, allowedModes)) <em class="brace">{</em>
<a id="L653" name="L653"></a> 653                 <em class="comment">// The requested class it not accessible from the lookup class.</em>
<a id="L654" name="L654"></a> 654                 <em class="comment">// No permissions.</em>
<a id="L655" name="L655"></a> 655                 newModes = 0;
<a id="L656" name="L656"></a> 656             <em class="brace">}</em>
<a id="L657" name="L657"></a> 657             <a href="../S/1619.html#L673" title="Defined at 673 in src/java/lang/invoke/MethodHandles.java.">checkUnprivilegedlookupClass</a>(requestedLookupClass, newModes);
<a id="L658" name="L658"></a> 658             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(requestedLookupClass, newModes);
<a id="L659" name="L659"></a> 659         <em class="brace">}</em>
<a id="L660" name="L660"></a> 660 
<a id="L661" name="L661"></a> 661         <em class="comment">// Make sure outer class is initialized first.</em>
<a id="L662" name="L662"></a> 662         <strong class="reserved">static</strong> <em class="brace">{</em> IMPL_NAMES.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>(); <em class="brace">}</em>
<a id="L663" name="L663"></a> 663 
<div class="comment">
 Version of lookup which is trusted minimally.
           It can only be used to create method handles to
           publicly accessible members.</div>
<a id="L668" name="L668"></a> 668         <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> PUBLIC_LOOKUP = <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>, PUBLIC);
<a id="L669" name="L669"></a> 669 
<div class="comment">
         /** Package-private version of lookup which is trusted. */</div>
<a id="L671" name="L671"></a> 671         <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> IMPL_LOOKUP = <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>, TRUSTED);
<a id="L672" name="L672"></a> 672 
<a id="L673" name="L673"></a> 673         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/11393.html" title="Multiple referred from 2 places.">checkUnprivilegedlookupClass</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, <strong class="reserved">int</strong> allowedModes) <em class="brace">{</em>
<a id="L674" name="L674"></a> 674             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L675" name="L675"></a> 675             <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("java.lang.invoke."))
<a id="L676" name="L676"></a> 676                 <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("illegal lookupClass: "+<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>);
<a id="L677" name="L677"></a> 677 
<a id="L678" name="L678"></a> 678             <em class="comment">// For caller-sensitive MethodHandles.lookup()</em>
<a id="L679" name="L679"></a> 679             <em class="comment">// disallow lookup more restricted packages</em>
<a id="L680" name="L680"></a> 680             <strong class="reserved">if</strong> (allowedModes == ALL_MODES &amp;&amp; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>.<a href="../D/17691.html" title="Multiple defined in 20 places.">getClassLoader</a>() == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L681" name="L681"></a> 681                 <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("java.") ||
<a id="L682" name="L682"></a> 682                         (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("sun.") &amp;&amp; !<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("sun.invoke."))) <em class="brace">{</em>
<a id="L683" name="L683"></a> 683                     <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("illegal lookupClass: " + <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>);
<a id="L684" name="L684"></a> 684                 <em class="brace">}</em>
<a id="L685" name="L685"></a> 685             <em class="brace">}</em>
<a id="L686" name="L686"></a> 686         <em class="brace">}</em>
<a id="L687" name="L687"></a> 687 
<div class="comment">
          Displays the name of the class from which lookups are to be made.
          (The name is the one reported by {@link java.lang.Class#getName() Class.getName}.)
          If there are restrictions on the access permitted to this lookup,
          this is indicated by adding a suffix to the class name, consisting
          of a slash and a keyword.  The keyword represents the strongest
          allowed access, and is chosen as follows:
          <ul><li>If no access is allowed, the suffix is "/noaccess".
          </li><li>If only public access is allowed, the suffix is "/public".
          </li><li>If only public and package access are allowed, the suffix is "/package".
          </li><li>If only public, package, and private access are allowed, the suffix is "/private".
          </li></ul>
          If none of the above cases apply, it is the case that full
          access (public, package, private, and protected) is allowed.
          In this case, no suffix is added.
          This is true only of an object obtained originally from
          {@link java.lang.invoke.MethodHandles#lookup MethodHandles.lookup}.
          Objects created by {@link java.lang.invoke.MethodHandles.Lookup#in Lookup.in}
          always have restricted access, and will display a suffix.
          <p>
          (It may seem strange that protected access should be
          stronger than private access.  Viewed independently from
          package access, protected access is the first to be lost,
          because it requires a direct subclass relationship between
          caller and callee.)
          @see #in</p></div>
<a id="L716" name="L716"></a> 716         @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L717" name="L717"></a> 717         <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L718" name="L718"></a> 718             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> cname = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L719" name="L719"></a> 719             <strong class="reserved">switch</strong> (allowedModes) <em class="brace">{</em>
<a id="L720" name="L720"></a> 720             <strong class="reserved">case</strong> 0:  <em class="comment">// no privileges</em>
<a id="L721" name="L721"></a> 721                 <strong class="reserved">return</strong> cname + "/noaccess";
<a id="L722" name="L722"></a> 722             <strong class="reserved">case</strong> PUBLIC:
<a id="L723" name="L723"></a> 723                 <strong class="reserved">return</strong> cname + "/public";
<a id="L724" name="L724"></a> 724             <strong class="reserved">case</strong> PUBLIC|PACKAGE:
<a id="L725" name="L725"></a> 725                 <strong class="reserved">return</strong> cname + "/package";
<a id="L726" name="L726"></a> 726             <strong class="reserved">case</strong> ALL_MODES &amp; ~PROTECTED:
<a id="L727" name="L727"></a> 727                 <strong class="reserved">return</strong> cname + "/private";
<a id="L728" name="L728"></a> 728             <strong class="reserved">case</strong> ALL_MODES:
<a id="L729" name="L729"></a> 729                 <strong class="reserved">return</strong> cname;
<a id="L730" name="L730"></a> 730             <strong class="reserved">case</strong> TRUSTED:
<a id="L731" name="L731"></a> 731                 <strong class="reserved">return</strong> "/trusted";  <em class="comment">// internal only; not exported</em>
<a id="L732" name="L732"></a> 732             <strong class="reserved">default</strong>:  <em class="comment">// Should not happen, but it's a bitfield...</em>
<a id="L733" name="L733"></a> 733                 cname = cname + "/" + <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35410.html" title="Multiple defined in 5 places.">toHexString</a>(allowedModes);
<a id="L734" name="L734"></a> 734                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<strong class="reserved">false</strong>) : cname;
<a id="L735" name="L735"></a> 735                 <strong class="reserved">return</strong> cname;
<a id="L736" name="L736"></a> 736             <em class="brace">}</em>
<a id="L737" name="L737"></a> 737         <em class="brace">}</em>
<a id="L738" name="L738"></a> 738 
<div class="comment">
          Produces a method handle for a static method.
          The type of the method handle will be that of the method.
          (Since static methods do not take receivers, there is no
          additional receiver argument inserted into the method handle type,
          as there would be with <a href="#L852" title="Defined at 852.">findVirtual</a> or <a href="#L996" title="Defined at 996.">findSpecial</a>.)
          The method and all its argument types must be accessible to the lookup object.
          <p>
          The returned method handle will have
          {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if
          the method's variable arity modifier bit (<code>0x0080</code>) is set.
          </p><p>
          If the returned method handle is invoked, the method's class will
          be initialized, if it has not already been initialized.
          </p><p><b>Example:</b>
          </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle MH_asList = publicLookup().findStatic(Arrays.class,
  "asList", methodType(List.class, Object[].class));
assertEquals("[x, y]", MH_asList.invoke("x", "y").toString());
          }</pre></blockquote>
          @param refc the class from which the method is accessed
          @param name the name of the method
          @param type the type of the method
          @return the desired method handle
          @throws NoSuchMethodException if the method does not exist
          @throws IllegalAccessException if access checking fails,
                                         or if the method is not <code>static</code>,
                                         or if the method's variable arity modifier bit
                                         is set and <code>asVarargsCollector</code> fails
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null</div>
<a id="L775" name="L775"></a> 775         <strong class="reserved">public</strong>
<a id="L776" name="L776"></a> 776         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14484.html" title="Multiple referred from 14 places.">findStatic</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L777" name="L777"></a> 777             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_invokeStatic, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L778" name="L778"></a> 778             <strong class="reserved">return</strong> <a href="../S/1619.html#L1598" title="Defined at 1598 in src/java/lang/invoke/MethodHandles.java.">getDirectMethod</a>(REF_invokeStatic, refc, method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L779" name="L779"></a> 779         <em class="brace">}</em>
<a id="L780" name="L780"></a> 780 
<div class="comment">
          Produces a method handle for a virtual method.
          The type of the method handle will be that of the method,
          with the receiver type (usually <code>refc</code>) prepended.
          The method and all its argument types must be accessible to the lookup object.
          <p>
          When called, the handle will treat the first argument as a receiver
          and dispatch on the receiver's type to determine which method
          implementation to enter.
          (The dispatching action is identical with that performed by an
          <code>invokevirtual</code> or <code>invokeinterface</code> instruction.)
          </p><p>
          The first argument will be of type <code>refc</code> if the lookup
          class has full privileges to access the member.  Otherwise
          the member must be <code>protected</code> and the first argument
          will be restricted in type to the lookup class.
          </p><p>
          The returned method handle will have
          {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if
          the method's variable arity modifier bit (<code>0x0080</code>) is set.
          </p><p>
          Because of the general <a href="MethodHandles.Lookup.html#equiv">equivalence</a> between <code>invokevirtual</code>
          instructions and method handles produced by <code>findVirtual</code>,
          if the class is <code>MethodHandle</code> and the name string is
          <code>invokeExact</code> or <code>invoke</code>, the resulting
          method handle is equivalent to one produced by
          {@link java.lang.invoke.MethodHandles#exactInvoker MethodHandles.exactInvoker} or
          {@link java.lang.invoke.MethodHandles#invoker MethodHandles.invoker}
          with the same <code>type</code> argument.
          <b>Example:</b>
          </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle MH_concat = publicLookup().findVirtual(String.class,
  "concat", methodType(String.class, String.class));
MethodHandle MH_hashCode = publicLookup().findVirtual(Object.class,
  "hashCode", methodType(int.class));
MethodHandle MH_hashCode_String = publicLookup().findVirtual(String.class,
  "hashCode", methodType(int.class));
assertEquals("xy", (String) MH_concat.invokeExact("x", "y"));
assertEquals("xy".hashCode(), (int) MH_hashCode.invokeExact((Object)"xy"));
assertEquals("xy".hashCode(), (int) MH_hashCode_String.invokeExact("xy"));
// interface method:
MethodHandle MH_subSequence = publicLookup().findVirtual(CharSequence.class,
  "subSequence", methodType(CharSequence.class, int.class, int.class));
assertEquals("def", MH_subSequence.invoke("abcdefghi", 3, 6).toString());
// constructor "internal method" must be accessed differently:
MethodType MT_newString = methodType(void.class); //()V for new String()
try { assertEquals("impossible", lookup()
        .findVirtual(String.class, "<init>", MT_newString));
 } catch (NoSuchMethodException ex) { } // OK
MethodHandle MH_newString = publicLookup()
  .findConstructor(String.class, MT_newString);
assertEquals("", (String) MH_newString.invokeExact());
          }</init></pre></blockquote>
          @param refc the class or interface from which the method is accessed
          @param name the name of the method
          @param type the type of the method, with the receiver argument omitted
          @return the desired method handle
          @throws NoSuchMethodException if the method does not exist
          @throws IllegalAccessException if access checking fails,
                                         or if the method is <code>static</code>
                                         or if the method's variable arity modifier bit
                                         is set and <code>asVarargsCollector</code> fails
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null</div>
<a id="L852" name="L852"></a> 852         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14501.html" title="Multiple referred from 2 places.">findVirtual</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L853" name="L853"></a> 853             <strong class="reserved">if</strong> (refc == <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L854" name="L854"></a> 854                 <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = <a href="../S/1619.html#L861" title="Defined at 861 in src/java/lang/invoke/MethodHandles.java.">findVirtualForMH</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L855" name="L855"></a> 855                 <strong class="reserved">if</strong> (mh != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> mh;
<a id="L856" name="L856"></a> 856             <em class="brace">}</em>
<a id="L857" name="L857"></a> 857             <strong class="reserved">byte</strong> refKind = (refc.<a href="../D/25735.html" title="Multiple defined in 6 places.">isInterface</a>() ? REF_invokeInterface : REF_invokeVirtual);
<a id="L858" name="L858"></a> 858             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L859" name="L859"></a> 859             <strong class="reserved">return</strong> <a href="../S/1619.html#L1598" title="Defined at 1598 in src/java/lang/invoke/MethodHandles.java.">getDirectMethod</a>(refKind, refc, method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L860" name="L860"></a> 860         <em class="brace">}</em>
<a id="L861" name="L861"></a> 861         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14502.html" title="Multiple referred from 2 places.">findVirtualForMH</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L862" name="L862"></a> 862             <em class="comment">// these names require special lookups because of the implicit MethodType argument</em>
<a id="L863" name="L863"></a> 863             <strong class="reserved">if</strong> ("invoke".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>))
<a id="L864" name="L864"></a> 864                 <strong class="reserved">return</strong> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L865" name="L865"></a> 865             <strong class="reserved">if</strong> ("invokeExact".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>))
<a id="L866" name="L866"></a> 866                 <strong class="reserved">return</strong> <a href="../D/15761.html" title="Multiple defined in 2 places.">exactInvoker</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L867" name="L867"></a> 867             <strong class="reserved">if</strong> ("invokeBasic".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>))
<a id="L868" name="L868"></a> 868                 <strong class="reserved">return</strong> <a href="../D/11784.html" title="Multiple defined in 2 places.">basicInvoker</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L869" name="L869"></a> 869             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../S/1611.html#L355" title="Defined at 355 in src/java/lang/invoke/MemberName.java.">isMethodHandleInvokeName</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>));
<a id="L870" name="L870"></a> 870             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L871" name="L871"></a> 871         <em class="brace">}</em>
<a id="L872" name="L872"></a> 872 
<div class="comment">
          Produces a method handle which creates an object and initializes it, using
          the constructor of the specified type.
          The parameter types of the method handle will be those of the constructor,
          while the return type will be a reference to the constructor's class.
          The constructor and all its argument types must be accessible to the lookup object.
          <p>
          The requested type must have a return type of <code>void</code>.
          (This is consistent with the JVM's treatment of constructor type descriptors.)
          </p><p>
          The returned method handle will have
          {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if
          the constructor's variable arity modifier bit (<code>0x0080</code>) is set.
          </p><p>
          If the returned method handle is invoked, the constructor's class will
          be initialized, if it has not already been initialized.
          </p><p><b>Example:</b>
          </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle MH_newArrayList = publicLookup().findConstructor(
  ArrayList.class, methodType(void.class, Collection.class));
Collection orig = Arrays.asList("x", "y");
Collection copy = (ArrayList) MH_newArrayList.invokeExact(orig);
assert(orig != copy);
assertEquals(orig, copy);
// a variable-arity constructor:
MethodHandle MH_newProcessBuilder = publicLookup().findConstructor(
  ProcessBuilder.class, methodType(void.class, String[].class));
ProcessBuilder pb = (ProcessBuilder)
  MH_newProcessBuilder.invoke("x", "y", "z");
assertEquals("[x, y, z]", pb.command().toString());
          }</pre></blockquote>
          @param refc the class or interface from which the method is accessed
          @param type the type of the method, with the receiver argument omitted, and a void return type
          @return the desired method handle
          @throws NoSuchMethodException if the constructor does not exist
          @throws IllegalAccessException if access checking fails
                                         or if the method's variable arity modifier bit
                                         is set and <code>asVarargsCollector</code> fails
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null</div>
<a id="L918" name="L918"></a> 918         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14364.html" title="Multiple referred from 3 places.">findConstructor</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L919" name="L919"></a> 919             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = "&lt;init&gt;";
<a id="L920" name="L920"></a> 920             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_newInvokeSpecial, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L921" name="L921"></a> 921             <strong class="reserved">return</strong> <a href="../S/1619.html#L1706" title="Defined at 1706 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructor</a>(refc, ctor);
<a id="L922" name="L922"></a> 922         <em class="brace">}</em>
<a id="L923" name="L923"></a> 923 
<div class="comment">
          Produces an early-bound method handle for a virtual method.
          It will bypass checks for overriding methods on the receiver,
          <a href="MethodHandles.Lookup.html#equiv">as if called</a> from an <code>invokespecial</code>
          instruction from within the explicitly specified <code>specialCaller</code>.
          The type of the method handle will be that of the method,
          with a suitably restricted receiver type prepended.
          (The receiver type will be <code>specialCaller</code> or a subtype.)
          The method and all its argument types must be accessible
          to the lookup object.
          <p>
          Before method resolution,
          if the explicitly specified caller class is not identical with the
          lookup class, or if this lookup object does not have
          <a href="MethodHandles.Lookup.html#privacc">private access</a>
          privileges, the access fails.
          </p><p>
          The returned method handle will have
          {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if
          the method's variable arity modifier bit (<code>0x0080</code>) is set.
          </p><p style="font-size:smaller;">
          <em>(Note:  JVM internal methods named <code>"<init>"</init></code> are not visible to this API,
          even though the <code>invokespecial</code> instruction can refer to them
          in special circumstances.  Use <a href="#L918" title="Defined at 918.">findConstructor</a>
          to access instance initialization methods in a safe manner.)</em>
          </p><p><b>Example:</b>
          </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
static class Listie extends ArrayList {
  public String toString() { return "[wee Listie]"; }
  static Lookup lookup() { return MethodHandles.lookup(); }
}
...
// no access to constructor via invokeSpecial:
MethodHandle MH_newListie = Listie.lookup()
  .findConstructor(Listie.class, methodType(void.class));
Listie l = (Listie) MH_newListie.invokeExact();
try { assertEquals("impossible", Listie.lookup().findSpecial(
        Listie.class, "<init>", methodType(void.class), Listie.class));
 } catch (NoSuchMethodException ex) { } // OK
// access to super and self methods via invokeSpecial:
MethodHandle MH_super = Listie.lookup().findSpecial(
  ArrayList.class, "toString" , methodType(String.class), Listie.class);
MethodHandle MH_this = Listie.lookup().findSpecial(
  Listie.class, "toString" , methodType(String.class), Listie.class);
MethodHandle MH_duper = Listie.lookup().findSpecial(
  Object.class, "toString" , methodType(String.class), Listie.class);
assertEquals("[]", (String) MH_super.invokeExact(l));
assertEquals(""+l, (String) MH_this.invokeExact(l));
assertEquals("[]", (String) MH_duper.invokeExact(l)); // ArrayList method
try { assertEquals("inaccessible", Listie.lookup().findSpecial(
        String.class, "toString", methodType(String.class), Listie.class));
 } catch (IllegalAccessException ex) { } // OK
Listie subl = new Listie() { public String toString() { return "[subclass]"; } };
assertEquals(""+l, (String) MH_this.invokeExact(subl)); // Listie method
          }</init></pre></blockquote>
          @param refc the class or interface from which the method is accessed
          @param name the name of the method (which must not be "&lt;init&gt;")
          @param type the type of the method, with the receiver argument omitted
          @param specialCaller the proposed calling class to perform the <code>invokespecial</code>
          @return the desired method handle
          @throws NoSuchMethodException if the method does not exist
          @throws IllegalAccessException if access checking fails
                                         or if the method's variable arity modifier bit
                                         is set and <code>asVarargsCollector</code> fails
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null</div>
<a id="L996" name="L996"></a> 996         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> findSpecial(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>,
<a id="L997" name="L997"></a> 997                                         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; specialCaller) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L998" name="L998"></a> 998             <a href="../S/1619.html#L1560" title="Defined at 1560 in src/java/lang/invoke/MethodHandles.java.">checkSpecialCaller</a>(specialCaller);
<a id="L999" name="L999"></a> 999             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> specialLookup = <strong class="reserved">this</strong>.<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>(specialCaller);
<a id="L1000" name="L1000"></a>1000             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = specialLookup.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_invokeSpecial, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1001" name="L1001"></a>1001             <strong class="reserved">return</strong> specialLookup.<a href="../S/1619.html#L1598" title="Defined at 1598 in src/java/lang/invoke/MethodHandles.java.">getDirectMethod</a>(REF_invokeSpecial, refc, method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L1002" name="L1002"></a>1002         <em class="brace">}</em>
<a id="L1003" name="L1003"></a>1003 
<div class="comment">
          Produces a method handle giving read access to a non-static field.
          The type of the method handle will have a return type of the field's
          value type.
          The method handle's single argument will be the instance containing
          the field.
          Access checking is performed immediately on behalf of the lookup class.
          @param refc the class or interface from which the method is accessed
          @param name the field's name
          @param type the field's type
          @return a method handle which can load values from the field
          @throws NoSuchFieldException if the field does not exist
          @throws IllegalAccessException if access checking fails, or if the field is <code>static</code>
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null</div>
<a id="L1021" name="L1021"></a>1021         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1606.html#L754" title="Referred from 754 in src/java/lang/invoke/BoundMethodHandle.java.">findGetter</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1022" name="L1022"></a>1022             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_getField, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1023" name="L1023"></a>1023             <strong class="reserved">return</strong> <a href="../S/1619.html#L1682" title="Defined at 1682 in src/java/lang/invoke/MethodHandles.java.">getDirectField</a>(REF_getField, refc, field);
<a id="L1024" name="L1024"></a>1024         <em class="brace">}</em>
<a id="L1025" name="L1025"></a>1025 
<div class="comment">
          Produces a method handle giving write access to a non-static field.
          The type of the method handle will have a void return type.
          The method handle will take two arguments, the instance containing
          the field, and the value to be stored.
          The second argument will be of the field's value type.
          Access checking is performed immediately on behalf of the lookup class.
          @param refc the class or interface from which the method is accessed
          @param name the field's name
          @param type the field's type
          @return a method handle which can store values into the field
          @throws NoSuchFieldException if the field does not exist
          @throws IllegalAccessException if access checking fails, or if the field is <code>static</code>
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null</div>
<a id="L1043" name="L1043"></a>1043         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> findSetter(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1044" name="L1044"></a>1044             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_putField, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1045" name="L1045"></a>1045             <strong class="reserved">return</strong> <a href="../S/1619.html#L1682" title="Defined at 1682 in src/java/lang/invoke/MethodHandles.java.">getDirectField</a>(REF_putField, refc, field);
<a id="L1046" name="L1046"></a>1046         <em class="brace">}</em>
<a id="L1047" name="L1047"></a>1047 
<div class="comment">
          Produces a method handle giving read access to a static field.
          The type of the method handle will have a return type of the field's
          value type.
          The method handle will take no arguments.
          Access checking is performed immediately on behalf of the lookup class.
          <p>
          If the returned method handle is invoked, the field's class will
          be initialized, if it has not already been initialized.
          @param refc the class or interface from which the method is accessed
          @param name the field's name
          @param type the field's type
          @return a method handle which can load values from the field
          @throws NoSuchFieldException if the field does not exist
          @throws IllegalAccessException if access checking fails, or if the field is not <code>static</code>
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null</p></div>
<a id="L1067" name="L1067"></a>1067         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> findStaticGetter(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1068" name="L1068"></a>1068             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_getStatic, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1069" name="L1069"></a>1069             <strong class="reserved">return</strong> <a href="../S/1619.html#L1682" title="Defined at 1682 in src/java/lang/invoke/MethodHandles.java.">getDirectField</a>(REF_getStatic, refc, field);
<a id="L1070" name="L1070"></a>1070         <em class="brace">}</em>
<a id="L1071" name="L1071"></a>1071 
<div class="comment">
          Produces a method handle giving write access to a static field.
          The type of the method handle will have a void return type.
          The method handle will take a single
          argument, of the field's value type, the value to be stored.
          Access checking is performed immediately on behalf of the lookup class.
          <p>
          If the returned method handle is invoked, the field's class will
          be initialized, if it has not already been initialized.
          @param refc the class or interface from which the method is accessed
          @param name the field's name
          @param type the field's type
          @return a method handle which can store values into the field
          @throws NoSuchFieldException if the field does not exist
          @throws IllegalAccessException if access checking fails, or if the field is not <code>static</code>
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null</p></div>
<a id="L1091" name="L1091"></a>1091         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> findStaticSetter(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1092" name="L1092"></a>1092             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_putStatic, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1093" name="L1093"></a>1093             <strong class="reserved">return</strong> <a href="../S/1619.html#L1682" title="Defined at 1682 in src/java/lang/invoke/MethodHandles.java.">getDirectField</a>(REF_putStatic, refc, field);
<a id="L1094" name="L1094"></a>1094         <em class="brace">}</em>
<a id="L1095" name="L1095"></a>1095 
<div class="comment">
          Produces an early-bound method handle for a non-static method.
          The receiver must have a supertype <code>defc</code> in which a method
          of the given name and type is accessible to the lookup class.
          The method and all its argument types must be accessible to the lookup object.
          The type of the method handle will be that of the method,
          without any insertion of an additional receiver parameter.
          The given receiver will be bound into the method handle,
          so that every call to the method handle will invoke the
          requested method on the given receiver.
          <p>
          The returned method handle will have
          {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if
          the method's variable arity modifier bit (<code>0x0080</code>) is set
          <em>and</em> the trailing array argument is not the only argument.
          (If the trailing array argument is the only argument,
          the given receiver value will be bound to it.)
          </p><p>
          This is equivalent to the following code:
          </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle mh0 = lookup().findVirtual(defc, name, type);
MethodHandle mh1 = mh0.bindTo(receiver);
MethodType mt1 = mh1.type();
if (mh0.isVarargsCollector())
  mh1 = mh1.asVarargsCollector(mt1.parameterType(mt1.parameterCount()-1));
return mh1;
          }</pre></blockquote>
          where <code>defc</code> is either <code>receiver.getClass()</code> or a super
          type of that class, in which the requested method is accessible
          to the lookup class.
          (Note that <code>bindTo</code> does not preserve variable arity.)
          @param receiver the object from which the method is accessed
          @param name the name of the method
          @param type the type of the method, with the receiver argument omitted
          @return the desired method handle
          @throws NoSuchMethodException if the method does not exist
          @throws IllegalAccessException if access checking fails
                                         or if the method's variable arity modifier bit
                                         is set and <code>asVarargsCollector</code> fails
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws NullPointerException if any argument is null
          @see MethodHandle#bindTo
          @see #findVirtual</div>
<a id="L1144" name="L1144"></a>1144         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/10598.html" title="Multiple referred from 221 places.">bind</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> receiver, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1145" name="L1145"></a>1145             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt; refc = receiver.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>(); <em class="comment">// may get NPE</em>
<a id="L1146" name="L1146"></a>1146             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_invokeSpecial, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1147" name="L1147"></a>1147             <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = <a href="../S/1619.html#L1604" title="Defined at 1604 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoRestrict</a>(REF_invokeSpecial, refc, method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L1148" name="L1148"></a>1148             <strong class="reserved">return</strong> mh.<a href="../D/11851.html" title="Multiple defined in 3 places.">bindArgumentL</a>(0, receiver).<a href="../D/34276.html" title="Multiple defined in 2 places.">setVarargs</a>(method);
<a id="L1149" name="L1149"></a>1149         <em class="brace">}</em>
<a id="L1150" name="L1150"></a>1150 
<div class="comment">
          Makes a <a href="MethodHandleInfo.html#directmh">direct method handle</a>
          to <i>m</i>, if the lookup class has permission.
          If <i>m</i> is non-static, the receiver argument is treated as an initial argument.
          If <i>m</i> is virtual, overriding is respected on every call.
          Unlike the Core Reflection API, exceptions are <em>not</em> wrapped.
          The type of the method handle will be that of the method,
          with the receiver type prepended (but only if it is non-static).
          If the method's <code>accessible</code> flag is not set,
          access checking is performed immediately on behalf of the lookup class.
          If <i>m</i> is not public, do not share the resulting handle with untrusted parties.
          <p>
          The returned method handle will have
          {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if
          the method's variable arity modifier bit (<code>0x0080</code>) is set.
          </p><p>
          If <i>m</i> is static, and
          if the returned method handle is invoked, the method's class will
          be initialized, if it has not already been initialized.
          @param m the reflected method
          @return a method handle which can invoke the reflected method
          @throws IllegalAccessException if access checking fails
                                         or if the method's variable arity modifier bit
                                         is set and <code>asVarargsCollector</code> fails
          @throws NullPointerException if the argument is null</p></div>
<a id="L1177" name="L1177"></a>1177         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflect(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1178" name="L1178"></a>1178             <strong class="reserved">if</strong> (m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>() == <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L1179" name="L1179"></a>1179                 <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = <a href="../S/1619.html#L1190" title="Defined at 1190 in src/java/lang/invoke/MethodHandles.java.">unreflectForMH</a>(m);
<a id="L1180" name="L1180"></a>1180                 <strong class="reserved">if</strong> (mh != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> mh;
<a id="L1181" name="L1181"></a>1181             <em class="brace">}</em>
<a id="L1182" name="L1182"></a>1182             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(m);
<a id="L1183" name="L1183"></a>1183             <strong class="reserved">byte</strong> refKind = method.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>();
<a id="L1184" name="L1184"></a>1184             <strong class="reserved">if</strong> (refKind == REF_invokeSpecial)
<a id="L1185" name="L1185"></a>1185                 refKind = REF_invokeVirtual;
<a id="L1186" name="L1186"></a>1186             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(method.<a href="../D/25874.html" title="Multiple defined in 3 places.">isMethod</a>());
<a id="L1187" name="L1187"></a>1187             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a> = m.<a href="../D/25151.html" title="Multiple defined in 4 places.">isAccessible</a>() ? IMPL_LOOKUP : <strong class="reserved">this</strong>;
<a id="L1188" name="L1188"></a>1188             <strong class="reserved">return</strong> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>.<a href="../S/1619.html#L1610" title="Defined at 1610 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoSecurityManager</a>(refKind, method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L1189" name="L1189"></a>1189         <em class="brace">}</em>
<a id="L1190" name="L1190"></a>1190         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L1179" title="Referred from 1179 in src/java/lang/invoke/MethodHandles.java.">unreflectForMH</a>(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a> m) <em class="brace">{</em>
<a id="L1191" name="L1191"></a>1191             <em class="comment">// these names require special lookups because they throw UnsupportedOperationException</em>
<a id="L1192" name="L1192"></a>1192             <strong class="reserved">if</strong> (<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../S/1611.html#L355" title="Defined at 355 in src/java/lang/invoke/MemberName.java.">isMethodHandleInvokeName</a>(m.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>()))
<a id="L1193" name="L1193"></a>1193                 <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L1084" title="Defined at 1084 in src/java/lang/invoke/MethodHandleImpl.java.">fakeMethodHandleInvoke</a>(<strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(m));
<a id="L1194" name="L1194"></a>1194             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1195" name="L1195"></a>1195         <em class="brace">}</em>
<a id="L1196" name="L1196"></a>1196 
<div class="comment">
          Produces a method handle for a reflected method.
          It will bypass checks for overriding methods on the receiver,
          <a href="MethodHandles.Lookup.html#equiv">as if called</a> from an <code>invokespecial</code>
          instruction from within the explicitly specified <code>specialCaller</code>.
          The type of the method handle will be that of the method,
          with a suitably restricted receiver type prepended.
          (The receiver type will be <code>specialCaller</code> or a subtype.)
          If the method's <code>accessible</code> flag is not set,
          access checking is performed immediately on behalf of the lookup class,
          as if <code>invokespecial</code> instruction were being linked.
          <p>
          Before method resolution,
          if the explicitly specified caller class is not identical with the
          lookup class, or if this lookup object does not have
          <a href="MethodHandles.Lookup.html#privacc">private access</a>
          privileges, the access fails.
          </p><p>
          The returned method handle will have
          {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if
          the method's variable arity modifier bit (<code>0x0080</code>) is set.
          @param m the reflected method
          @param specialCaller the class nominally calling the method
          @return a method handle which can invoke the reflected method
          @throws IllegalAccessException if access checking fails
                                         or if the method's variable arity modifier bit
                                         is set and <code>asVarargsCollector</code> fails
          @throws NullPointerException if any argument is null</p></div>
<a id="L1226" name="L1226"></a>1226         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflectSpecial(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a> m, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; specialCaller) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1227" name="L1227"></a>1227             <a href="../S/1619.html#L1560" title="Defined at 1560 in src/java/lang/invoke/MethodHandles.java.">checkSpecialCaller</a>(specialCaller);
<a id="L1228" name="L1228"></a>1228             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> specialLookup = <strong class="reserved">this</strong>.<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>(specialCaller);
<a id="L1229" name="L1229"></a>1229             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(m, <strong class="reserved">true</strong>);
<a id="L1230" name="L1230"></a>1230             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(method.<a href="../D/25874.html" title="Multiple defined in 3 places.">isMethod</a>());
<a id="L1231" name="L1231"></a>1231             <em class="comment">// ignore m.isAccessible:  this is a new kind of access</em>
<a id="L1232" name="L1232"></a>1232             <strong class="reserved">return</strong> specialLookup.<a href="../S/1619.html#L1610" title="Defined at 1610 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoSecurityManager</a>(REF_invokeSpecial, method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L1233" name="L1233"></a>1233         <em class="brace">}</em>
<a id="L1234" name="L1234"></a>1234 
<div class="comment">
          Produces a method handle for a reflected constructor.
          The type of the method handle will be that of the constructor,
          with the return type changed to the declaring class.
          The method handle will perform a <code>newInstance</code> operation,
          creating a new instance of the constructor's class on the
          arguments passed to the method handle.
          <p>
          If the constructor's <code>accessible</code> flag is not set,
          access checking is performed immediately on behalf of the lookup class.
          </p><p>
          The returned method handle will have
          {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if
          the constructor's variable arity modifier bit (<code>0x0080</code>) is set.
          </p><p>
          If the returned method handle is invoked, the constructor's class will
          be initialized, if it has not already been initialized.
          @param c the reflected constructor
          @return a method handle which can invoke the reflected constructor
          @throws IllegalAccessException if access checking fails
                                         or if the method's variable arity modifier bit
                                         is set and <code>asVarargsCollector</code> fails
          @throws NullPointerException if the argument is null</p></div>
<a id="L1259" name="L1259"></a>1259         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflectConstructor(<a href="../D/1833.html" title="Multiple defined in 2 places.">Constructor</a>&lt;?&gt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1260" name="L1260"></a>1260             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L1261" name="L1261"></a>1261             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(ctor.<a href="../D/25363.html" title="Multiple defined in 6 places.">isConstructor</a>());
<a id="L1262" name="L1262"></a>1262             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a> = <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>.<a href="../D/25151.html" title="Multiple defined in 4 places.">isAccessible</a>() ? IMPL_LOOKUP : <strong class="reserved">this</strong>;
<a id="L1263" name="L1263"></a>1263             <strong class="reserved">return</strong> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>.<a href="../S/1619.html#L1711" title="Defined at 1711 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructorNoSecurityManager</a>(ctor.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), ctor);
<a id="L1264" name="L1264"></a>1264         <em class="brace">}</em>
<a id="L1265" name="L1265"></a>1265 
<div class="comment">
          Produces a method handle giving read access to a reflected field.
          The type of the method handle will have a return type of the field's
          value type.
          If the field is static, the method handle will take no arguments.
          Otherwise, its single argument will be the instance containing
          the field.
          If the field's <code>accessible</code> flag is not set,
          access checking is performed immediately on behalf of the lookup class.
          <p>
          If the field is static, and
          if the returned method handle is invoked, the field's class will
          be initialized, if it has not already been initialized.
          @param f the reflected field
          @return a method handle which can load values from the reflected field
          @throws IllegalAccessException if access checking fails
          @throws NullPointerException if the argument is null</p></div>
<a id="L1284" name="L1284"></a>1284         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflectGetter(<a href="../D/3142.html" title="Multiple defined in 10 places.">Field</a> f) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1285" name="L1285"></a>1285             <strong class="reserved">return</strong> <a href="../S/1619.html#L1287" title="Defined at 1287 in src/java/lang/invoke/MethodHandles.java.">unreflectField</a>(f, <strong class="reserved">false</strong>);
<a id="L1286" name="L1286"></a>1286         <em class="brace">}</em>
<a id="L1287" name="L1287"></a>1287         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/29749.html" title="Multiple referred from 2 places.">unreflectField</a>(<a href="../D/3142.html" title="Multiple defined in 10 places.">Field</a> f, <strong class="reserved">boolean</strong> <a href="../S/1611.html#L634" title="Defined at 634 in src/java/lang/invoke/MemberName.java.">isSetter</a>) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1288" name="L1288"></a>1288             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(f, <a href="../S/1611.html#L634" title="Defined at 634 in src/java/lang/invoke/MemberName.java.">isSetter</a>);
<a id="L1289" name="L1289"></a>1289             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1611.html#L634" title="Defined at 634 in src/java/lang/invoke/MemberName.java.">isSetter</a>
<a id="L1290" name="L1290"></a>1290                     ? <a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L202" title="Defined at 202 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsSetter</a>(field.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>())
<a id="L1291" name="L1291"></a>1291                     : <a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L198" title="Defined at 198 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsGetter</a>(field.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>()));
<a id="L1292" name="L1292"></a>1292             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a> = f.<a href="../D/25151.html" title="Multiple defined in 4 places.">isAccessible</a>() ? IMPL_LOOKUP : <strong class="reserved">this</strong>;
<a id="L1293" name="L1293"></a>1293             <strong class="reserved">return</strong> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>.<a href="../S/1619.html#L1687" title="Defined at 1687 in src/java/lang/invoke/MethodHandles.java.">getDirectFieldNoSecurityManager</a>(field.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>(), f.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), field);
<a id="L1294" name="L1294"></a>1294         <em class="brace">}</em>
<a id="L1295" name="L1295"></a>1295 
<div class="comment">
          Produces a method handle giving write access to a reflected field.
          The type of the method handle will have a void return type.
          If the field is static, the method handle will take a single
          argument, of the field's value type, the value to be stored.
          Otherwise, the two arguments will be the instance containing
          the field, and the value to be stored.
          If the field's <code>accessible</code> flag is not set,
          access checking is performed immediately on behalf of the lookup class.
          <p>
          If the field is static, and
          if the returned method handle is invoked, the field's class will
          be initialized, if it has not already been initialized.
          @param f the reflected field
          @return a method handle which can store values into the reflected field
          @throws IllegalAccessException if access checking fails
          @throws NullPointerException if the argument is null</p></div>
<a id="L1314" name="L1314"></a>1314         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflectSetter(<a href="../D/3142.html" title="Multiple defined in 10 places.">Field</a> f) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1315" name="L1315"></a>1315             <strong class="reserved">return</strong> <a href="../S/1619.html#L1287" title="Defined at 1287 in src/java/lang/invoke/MethodHandles.java.">unreflectField</a>(f, <strong class="reserved">true</strong>);
<a id="L1316" name="L1316"></a>1316         <em class="brace">}</em>
<a id="L1317" name="L1317"></a>1317 
<div class="comment">
          Cracks a <a href="MethodHandleInfo.html#directmh">direct method handle</a>
          created by this lookup object or a similar one.
          Security and access checks are performed to ensure that this lookup object
          is capable of reproducing the target method handle.
          This means that the cracking may fail if target is a direct method handle
          but was created by an unrelated lookup object.
          This can happen if the method handle is <a href="MethodHandles.Lookup.html#callsens">caller sensitive</a>
          and was created by a lookup object for a different class.
          @param target a direct method handle to crack into symbolic reference components
          @return a symbolic reference which can be used to reconstruct this method handle from this lookup object
          @exception SecurityException if a security manager is present and it
                                       <a href="MethodHandles.Lookup.html#secmgr">refuses access</a>
          @throws IllegalArgumentException if the target is not a direct method handle or if access checking fails
          @exception NullPointerException if the target is <code>null</code>
          @see MethodHandleInfo
          @since 1.8</div>
<a id="L1336" name="L1336"></a>1336         <strong class="reserved">public</strong> <a href="../S/1607.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodHandleInfo.java.">MethodHandleInfo</a> <a href="../R/26478.html" title="Multiple referred from 2 places.">revealDirect</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>) <em class="brace">{</em>
<a id="L1337" name="L1337"></a>1337             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/24941.html" title="Multiple defined in 5 places.">internalMemberName</a>();
<a id="L1338" name="L1338"></a>1338             <strong class="reserved">if</strong> (<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a> == <strong class="reserved">null</strong> || (!<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../S/1611.html#L775" title="Defined at 775 in src/java/lang/invoke/MemberName.java.">isResolved</a>() &amp;&amp; !<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../S/1611.html#L346" title="Defined at 346 in src/java/lang/invoke/MemberName.java.">isMethodHandleInvoke</a>()))
<a id="L1339" name="L1339"></a>1339                 <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("not a direct method handle");
<a id="L1340" name="L1340"></a>1340             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc = <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>();
<a id="L1341" name="L1341"></a>1341             <strong class="reserved">byte</strong> refKind = <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>();
<a id="L1342" name="L1342"></a>1342             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L191" title="Defined at 191 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsValid</a>(refKind));
<a id="L1343" name="L1343"></a>1343             <strong class="reserved">if</strong> (refKind == REF_invokeSpecial &amp;&amp; !<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/25745.html" title="Multiple defined in 4 places.">isInvokeSpecial</a>())
<a id="L1344" name="L1344"></a>1344                 <em class="comment">// Devirtualized method invocation is usually formally virtual.</em>
<a id="L1345" name="L1345"></a>1345                 <em class="comment">// To avoid creating extra MemberName objects for this common case,</em>
<a id="L1346" name="L1346"></a>1346                 <em class="comment">// we encode this extra degree of freedom using MH.isInvokeSpecial.</em>
<a id="L1347" name="L1347"></a>1347                 refKind = REF_invokeVirtual;
<a id="L1348" name="L1348"></a>1348             <strong class="reserved">if</strong> (refKind == REF_invokeVirtual &amp;&amp; defc.<a href="../D/25735.html" title="Multiple defined in 6 places.">isInterface</a>())
<a id="L1349" name="L1349"></a>1349                 <em class="comment">// Symbolic reference is through interface but resolves to Object method (toString, etc.)</em>
<a id="L1350" name="L1350"></a>1350                 refKind = REF_invokeInterface;
<a id="L1351" name="L1351"></a>1351             <em class="comment">// Check SM permissions and member access before cracking.</em>
<a id="L1352" name="L1352"></a>1352             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1353" name="L1353"></a>1353                 <a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(refKind, defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1354" name="L1354"></a>1354                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1355" name="L1355"></a>1355             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L1356" name="L1356"></a>1356                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(<a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>);
<a id="L1357" name="L1357"></a>1357             <em class="brace">}</em>
<a id="L1358" name="L1358"></a>1358             <strong class="reserved">if</strong> (allowedModes != TRUSTED &amp;&amp; <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>()) <em class="brace">{</em>
<a id="L1359" name="L1359"></a>1359                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/24914.html" title="Multiple defined in 3 places.">internalCallerClass</a>();
<a id="L1360" name="L1360"></a>1360                 <strong class="reserved">if</strong> (!<a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>() || callerClass != <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>())
<a id="L1361" name="L1361"></a>1361                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("method handle is caller sensitive: "+callerClass);
<a id="L1362" name="L1362"></a>1362             <em class="brace">}</em>
<a id="L1363" name="L1363"></a>1363             <em class="comment">// Produce the handle to the results.</em>
<a id="L1364" name="L1364"></a>1364             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1636.html#L39" title="Defined at 39 in src/java/lang/invoke/InfoFromMemberName.java.">InfoFromMemberName</a>(<strong class="reserved">this</strong>, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>, refKind);
<a id="L1365" name="L1365"></a>1365         <em class="brace">}</em>
<a id="L1366" name="L1366"></a>1366 
<a id="L1367" name="L1367"></a>1367         <em class="comment">/// Helper methods, all package-private.</em>
<a id="L1368" name="L1368"></a>1368 
<a id="L1369" name="L1369"></a>1369         <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../R/26368.html" title="Multiple referred from 20 places.">resolveOrFail</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1370" name="L1370"></a>1370             <a href="../S/1619.html#L1394" title="Defined at 1394 in src/java/lang/invoke/MethodHandles.java.">checkSymbolicClass</a>(refc);  <em class="comment">// do this before attempting to resolve</em>
<a id="L1371" name="L1371"></a>1371             <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1372" name="L1372"></a>1372             <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1373" name="L1373"></a>1373             <strong class="reserved">return</strong> IMPL_NAMES.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, refKind), <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>(),
<a id="L1374" name="L1374"></a>1374                                             <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>.<strong class="reserved">class</strong>);
<a id="L1375" name="L1375"></a>1375         <em class="brace">}</em>
<a id="L1376" name="L1376"></a>1376 
<a id="L1377" name="L1377"></a>1377         <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../R/26368.html" title="Multiple referred from 20 places.">resolveOrFail</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1378" name="L1378"></a>1378             <a href="../S/1619.html#L1394" title="Defined at 1394 in src/java/lang/invoke/MethodHandles.java.">checkSymbolicClass</a>(refc);  <em class="comment">// do this before attempting to resolve</em>
<a id="L1379" name="L1379"></a>1379             <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1380" name="L1380"></a>1380             <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1381" name="L1381"></a>1381             <a href="../S/1619.html#L1402" title="Defined at 1402 in src/java/lang/invoke/MethodHandles.java.">checkMethodName</a>(refKind, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);  <em class="comment">// NPE check on name</em>
<a id="L1382" name="L1382"></a>1382             <strong class="reserved">return</strong> IMPL_NAMES.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, refKind), <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>(),
<a id="L1383" name="L1383"></a>1383                                             <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>.<strong class="reserved">class</strong>);
<a id="L1384" name="L1384"></a>1384         <em class="brace">}</em>
<a id="L1385" name="L1385"></a>1385 
<a id="L1386" name="L1386"></a>1386         <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../R/26368.html" title="Multiple referred from 20 places.">resolveOrFail</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>) <strong class="reserved">throws</strong> <a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <em class="brace">{</em>
<a id="L1387" name="L1387"></a>1387             <a href="../S/1619.html#L1394" title="Defined at 1394 in src/java/lang/invoke/MethodHandles.java.">checkSymbolicClass</a>(<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>());  <em class="comment">// do this before attempting to resolve</em>
<a id="L1388" name="L1388"></a>1388             <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1389" name="L1389"></a>1389             <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>().<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1390" name="L1390"></a>1390             <strong class="reserved">return</strong> IMPL_NAMES.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>, <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>(),
<a id="L1391" name="L1391"></a>1391                                             <a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a>.<strong class="reserved">class</strong>);
<a id="L1392" name="L1392"></a>1392         <em class="brace">}</em>
<a id="L1393" name="L1393"></a>1393 
<a id="L1394" name="L1394"></a>1394         <strong class="reserved">void</strong> <a href="../R/11378.html" title="Multiple referred from 4 places.">checkSymbolicClass</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1395" name="L1395"></a>1395             refc.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1396" name="L1396"></a>1396             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; caller = <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>();
<a id="L1397" name="L1397"></a>1397             <strong class="reserved">if</strong> (caller != <strong class="reserved">null</strong> &amp;&amp; !VerifyAccess.isClassAccessible(refc, caller, allowedModes))
<a id="L1398" name="L1398"></a>1398                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refc).<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>("symbolic reference class is not public", <strong class="reserved">this</strong>);
<a id="L1399" name="L1399"></a>1399         <em class="brace">}</em>
<a id="L1400" name="L1400"></a>1400 
<div class="comment">
         /** Check name for an illegal leading "&lt;" character. */</div>
<a id="L1402" name="L1402"></a>1402         <strong class="reserved">void</strong> <a href="../S/1619.html#L1381" title="Referred from 1381 in src/java/lang/invoke/MethodHandles.java.">checkMethodName</a>(<strong class="reserved">byte</strong> refKind, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a> <em class="brace">{</em>
<a id="L1403" name="L1403"></a>1403             <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("&lt;") &amp;&amp; refKind != REF_newInvokeSpecial)
<a id="L1404" name="L1404"></a>1404                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>("illegal method name: "+<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L1405" name="L1405"></a>1405         <em class="brace">}</em>
<a id="L1406" name="L1406"></a>1406 
<a id="L1407" name="L1407"></a>1407 
<div class="comment">
          Find my trustable caller class if m is a caller sensitive method.
          If this lookup object has private access, then the caller class is the lookupClass.
          Otherwise, if m is caller-sensitive, throw IllegalAccessException.</div>
<a id="L1413" name="L1413"></a>1413         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../R/14344.html" title="Multiple referred from 6 places.">findBoundCallerClass</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1414" name="L1414"></a>1414             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass = <strong class="reserved">null</strong>;
<a id="L1415" name="L1415"></a>1415             <strong class="reserved">if</strong> (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>(m)) <em class="brace">{</em>
<a id="L1416" name="L1416"></a>1416                 <em class="comment">// Only lookups with private access are allowed to resolve caller-sensitive methods</em>
<a id="L1417" name="L1417"></a>1417                 <strong class="reserved">if</strong> (<a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>()) <em class="brace">{</em>
<a id="L1418" name="L1418"></a>1418                     callerClass = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L1419" name="L1419"></a>1419                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1420" name="L1420"></a>1420                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a>("Attempt to lookup caller-sensitive method using restricted lookup object");
<a id="L1421" name="L1421"></a>1421                 <em class="brace">}</em>
<a id="L1422" name="L1422"></a>1422             <em class="brace">}</em>
<a id="L1423" name="L1423"></a>1423             <strong class="reserved">return</strong> callerClass;
<a id="L1424" name="L1424"></a>1424         <em class="brace">}</em>
<a id="L1425" name="L1425"></a>1425 
<a id="L1426" name="L1426"></a>1426         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/20256.html" title="Multiple referred from 5 places.">hasPrivateAccess</a>() <em class="brace">{</em>
<a id="L1427" name="L1427"></a>1427             <strong class="reserved">return</strong> (allowedModes &amp; PRIVATE) != 0;
<a id="L1428" name="L1428"></a>1428         <em class="brace">}</em>
<a id="L1429" name="L1429"></a>1429 
<div class="comment">
          Perform necessary <a href="MethodHandles.Lookup.html#secmgr">access checks</a>.
          Determines a trustable caller class to compare with refc, the symbolic reference class.
          If this lookup object has private access, then the caller class is the lookupClass.</div>
<a id="L1435" name="L1435"></a>1435         <strong class="reserved">void</strong> <a href="../R/11349.html" title="Multiple referred from 5 places.">checkSecurityManager</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <em class="brace">{</em>
<a id="L1436" name="L1436"></a>1436             <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> smgr = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>();
<a id="L1437" name="L1437"></a>1437             <strong class="reserved">if</strong> (smgr == <strong class="reserved">null</strong>)  <strong class="reserved">return</strong>;
<a id="L1438" name="L1438"></a>1438             <strong class="reserved">if</strong> (allowedModes == TRUSTED)  <strong class="reserved">return</strong>;
<a id="L1439" name="L1439"></a>1439 
<a id="L1440" name="L1440"></a>1440             <em class="comment">// Step 1:</em>
<a id="L1441" name="L1441"></a>1441             <strong class="reserved">boolean</strong> fullPowerLookup = <a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>();
<a id="L1442" name="L1442"></a>1442             <strong class="reserved">if</strong> (!fullPowerLookup ||
<a id="L1443" name="L1443"></a>1443                 !VerifyAccess.classLoaderIsAncestor(<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, refc)) <em class="brace">{</em>
<a id="L1444" name="L1444"></a>1444                 ReflectUtil.<a href="../D/12578.html" title="Multiple defined in 3 places.">checkPackageAccess</a>(refc);
<a id="L1445" name="L1445"></a>1445             <em class="brace">}</em>
<a id="L1446" name="L1446"></a>1446 
<a id="L1447" name="L1447"></a>1447             <em class="comment">// Step 2:</em>
<a id="L1448" name="L1448"></a>1448             <strong class="reserved">if</strong> (m.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>()) <strong class="reserved">return</strong>;
<a id="L1449" name="L1449"></a>1449             <strong class="reserved">if</strong> (!fullPowerLookup) <em class="brace">{</em>
<a id="L1450" name="L1450"></a>1450                 smgr.<a href="../D/12594.html" title="Multiple defined in 22 places.">checkPermission</a>(SecurityConstants.CHECK_MEMBER_ACCESS_PERMISSION);
<a id="L1451" name="L1451"></a>1451             <em class="brace">}</em>
<a id="L1452" name="L1452"></a>1452 
<a id="L1453" name="L1453"></a>1453             <em class="comment">// Step 3:</em>
<a id="L1454" name="L1454"></a>1454             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc = m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>();
<a id="L1455" name="L1455"></a>1455             <strong class="reserved">if</strong> (!fullPowerLookup &amp;&amp; defc != refc) <em class="brace">{</em>
<a id="L1456" name="L1456"></a>1456                 ReflectUtil.<a href="../D/12578.html" title="Multiple defined in 3 places.">checkPackageAccess</a>(defc);
<a id="L1457" name="L1457"></a>1457             <em class="brace">}</em>
<a id="L1458" name="L1458"></a>1458         <em class="brace">}</em>
<a id="L1459" name="L1459"></a>1459 
<a id="L1460" name="L1460"></a>1460         <strong class="reserved">void</strong> <a href="../R/11241.html" title="Multiple referred from 5 places.">checkMethod</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1461" name="L1461"></a>1461             <strong class="reserved">boolean</strong> wantStatic = (refKind == REF_invokeStatic);
<a id="L1462" name="L1462"></a>1462             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>;
<a id="L1463" name="L1463"></a>1463             <strong class="reserved">if</strong> (m.<a href="../D/25363.html" title="Multiple defined in 6 places.">isConstructor</a>())
<a id="L1464" name="L1464"></a>1464                 <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = "expected a method, not a constructor";
<a id="L1465" name="L1465"></a>1465             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!m.<a href="../D/25874.html" title="Multiple defined in 3 places.">isMethod</a>())
<a id="L1466" name="L1466"></a>1466                 <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = "expected a method";
<a id="L1467" name="L1467"></a>1467             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (wantStatic != m.<a href="../D/26281.html" title="Multiple defined in 7 places.">isStatic</a>())
<a id="L1468" name="L1468"></a>1468                 <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = wantStatic ? "expected a static method" : "expected a non-static method";
<a id="L1469" name="L1469"></a>1469             <strong class="reserved">else</strong>
<a id="L1470" name="L1470"></a>1470                 <em class="brace">{</em> <a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(refKind, refc, m); <strong class="reserved">return</strong>; <em class="brace">}</em>
<a id="L1471" name="L1471"></a>1471             <strong class="reserved">throw</strong> m.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>(<a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>, <strong class="reserved">this</strong>);
<a id="L1472" name="L1472"></a>1472         <em class="brace">}</em>
<a id="L1473" name="L1473"></a>1473 
<a id="L1474" name="L1474"></a>1474         <strong class="reserved">void</strong> <a href="../S/1619.html#L1694" title="Referred from 1694 in src/java/lang/invoke/MethodHandles.java.">checkField</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1475" name="L1475"></a>1475             <strong class="reserved">boolean</strong> wantStatic = !<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L211" title="Defined at 211 in src/java/lang/invoke/MethodHandleNatives.java.">refKindHasReceiver</a>(refKind);
<a id="L1476" name="L1476"></a>1476             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>;
<a id="L1477" name="L1477"></a>1477             <strong class="reserved">if</strong> (wantStatic != m.<a href="../D/26281.html" title="Multiple defined in 7 places.">isStatic</a>())
<a id="L1478" name="L1478"></a>1478                 <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = wantStatic ? "expected a static field" : "expected a non-static field";
<a id="L1479" name="L1479"></a>1479             <strong class="reserved">else</strong>
<a id="L1480" name="L1480"></a>1480                 <em class="brace">{</em> <a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(refKind, refc, m); <strong class="reserved">return</strong>; <em class="brace">}</em>
<a id="L1481" name="L1481"></a>1481             <strong class="reserved">throw</strong> m.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>(<a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>, <strong class="reserved">this</strong>);
<a id="L1482" name="L1482"></a>1482         <em class="brace">}</em>
<a id="L1483" name="L1483"></a>1483 
<div class="comment">
         /** Check public/protected/private bits on the symbolic reference class and its member. */</div>
<a id="L1485" name="L1485"></a>1485         <strong class="reserved">void</strong> <a href="../R/11068.html" title="Multiple referred from 112 places.">checkAccess</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1486" name="L1486"></a>1486             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(m.<a href="../S/1611.html#L284" title="Defined at 284 in src/java/lang/invoke/MemberName.java.">referenceKindIsConsistentWith</a>(refKind) &amp;&amp;
<a id="L1487" name="L1487"></a>1487                    <a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L191" title="Defined at 191 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsValid</a>(refKind) &amp;&amp;
<a id="L1488" name="L1488"></a>1488                    (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L194" title="Defined at 194 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsField</a>(refKind) == m.<a href="../D/25544.html" title="Multiple defined in 3 places.">isField</a>()));
<a id="L1489" name="L1489"></a>1489             <strong class="reserved">int</strong> allowedModes = <strong class="reserved">this</strong>.allowedModes;
<a id="L1490" name="L1490"></a>1490             <strong class="reserved">if</strong> (allowedModes == TRUSTED)  <strong class="reserved">return</strong>;
<a id="L1491" name="L1491"></a>1491             <strong class="reserved">int</strong> mods = m.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>();
<a id="L1492" name="L1492"></a>1492             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26106.html" title="Multiple defined in 5 places.">isProtected</a>(mods) &amp;&amp;
<a id="L1493" name="L1493"></a>1493                     refKind == REF_invokeVirtual &amp;&amp;
<a id="L1494" name="L1494"></a>1494                     m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>() == <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong> &amp;&amp;
<a id="L1495" name="L1495"></a>1495                     m.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("clone") &amp;&amp;
<a id="L1496" name="L1496"></a>1496                     refc.<a href="../D/25208.html" title="Multiple defined in 5 places.">isArray</a>()) <em class="brace">{</em>
<a id="L1497" name="L1497"></a>1497                 <em class="comment">// The JVM does this hack also.</em>
<a id="L1498" name="L1498"></a>1498                 <em class="comment">// (See ClassVerifier::verify_invoke_instructions</em>
<a id="L1499" name="L1499"></a>1499                 <em class="comment">// and LinkResolver::check_method_accessability.)</em>
<a id="L1500" name="L1500"></a>1500                 <em class="comment">// Because the JVM does not allow separate methods on array types,</em>
<a id="L1501" name="L1501"></a>1501                 <em class="comment">// there is no separate method for int[].clone.</em>
<a id="L1502" name="L1502"></a>1502                 <em class="comment">// All arrays simply inherit Object.clone.</em>
<a id="L1503" name="L1503"></a>1503                 <em class="comment">// But for access checking logic, we make Object.clone</em>
<a id="L1504" name="L1504"></a>1504                 <em class="comment">// (normally protected) appear to be public.</em>
<a id="L1505" name="L1505"></a>1505                 <em class="comment">// Later on, when the DirectMethodHandle is created,</em>
<a id="L1506" name="L1506"></a>1506                 <em class="comment">// its leading argument will be restricted to the</em>
<a id="L1507" name="L1507"></a>1507                 <em class="comment">// requested array type.</em>
<a id="L1508" name="L1508"></a>1508                 <em class="comment">// N.B. The return type is not adjusted, because</em>
<a id="L1509" name="L1509"></a>1509                 <em class="comment">// that is *not* the bytecode behavior.</em>
<a id="L1510" name="L1510"></a>1510                 mods ^= <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PROTECTED | <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PUBLIC;
<a id="L1511" name="L1511"></a>1511             <em class="brace">}</em>
<a id="L1512" name="L1512"></a>1512             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26106.html" title="Multiple defined in 5 places.">isProtected</a>(mods) &amp;&amp; refKind == REF_newInvokeSpecial) <em class="brace">{</em>
<a id="L1513" name="L1513"></a>1513                 <em class="comment">// cannot "new" a protected ctor in a different package</em>
<a id="L1514" name="L1514"></a>1514                 mods ^= <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PROTECTED;
<a id="L1515" name="L1515"></a>1515             <em class="brace">}</em>
<a id="L1516" name="L1516"></a>1516             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/25556.html" title="Multiple defined in 9 places.">isFinal</a>(mods) &amp;&amp;
<a id="L1517" name="L1517"></a>1517                     <a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L202" title="Defined at 202 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsSetter</a>(refKind))
<a id="L1518" name="L1518"></a>1518                 <strong class="reserved">throw</strong> m.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>("unexpected set of a final field", <strong class="reserved">this</strong>);
<a id="L1519" name="L1519"></a>1519             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(mods) &amp;&amp; <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(refc.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>()) &amp;&amp; allowedModes != 0)
<a id="L1520" name="L1520"></a>1520                 <strong class="reserved">return</strong>;  <em class="comment">// common case</em>
<a id="L1521" name="L1521"></a>1521             <strong class="reserved">int</strong> requestedModes = <a href="../S/1619.html#L550" title="Defined at 550 in src/java/lang/invoke/MethodHandles.java.">fixmods</a>(mods);  <em class="comment">// adjust 0 =&gt; PACKAGE</em>
<a id="L1522" name="L1522"></a>1522             <strong class="reserved">if</strong> ((requestedModes &amp; allowedModes) != 0) <em class="brace">{</em>
<a id="L1523" name="L1523"></a>1523                 <strong class="reserved">if</strong> (VerifyAccess.isMemberAccessible(refc, m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(),
<a id="L1524" name="L1524"></a>1524                                                     mods, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>(), allowedModes))
<a id="L1525" name="L1525"></a>1525                     <strong class="reserved">return</strong>;
<a id="L1526" name="L1526"></a>1526             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1527" name="L1527"></a>1527                 <em class="comment">// Protected members can also be checked as if they were package-private.</em>
<a id="L1528" name="L1528"></a>1528                 <strong class="reserved">if</strong> ((requestedModes &amp; PROTECTED) != 0 &amp;&amp; (allowedModes &amp; PACKAGE) != 0
<a id="L1529" name="L1529"></a>1529                         &amp;&amp; VerifyAccess.isSamePackage(m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>()))
<a id="L1530" name="L1530"></a>1530                     <strong class="reserved">return</strong>;
<a id="L1531" name="L1531"></a>1531             <em class="brace">}</em>
<a id="L1532" name="L1532"></a>1532             <strong class="reserved">throw</strong> m.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>(<a href="../S/1619.html#L1535" title="Defined at 1535 in src/java/lang/invoke/MethodHandles.java.">accessFailedMessage</a>(refc, m), <strong class="reserved">this</strong>);
<a id="L1533" name="L1533"></a>1533         <em class="brace">}</em>
<a id="L1534" name="L1534"></a>1534 
<a id="L1535" name="L1535"></a>1535         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1619.html#L1532" title="Referred from 1532 in src/java/lang/invoke/MethodHandles.java.">accessFailedMessage</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <em class="brace">{</em>
<a id="L1536" name="L1536"></a>1536             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc = m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>();
<a id="L1537" name="L1537"></a>1537             <strong class="reserved">int</strong> mods = m.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>();
<a id="L1538" name="L1538"></a>1538             <em class="comment">// check the class first:</em>
<a id="L1539" name="L1539"></a>1539             <strong class="reserved">boolean</strong> classOK = (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(defc.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>()) &amp;&amp;
<a id="L1540" name="L1540"></a>1540                                (defc == refc ||
<a id="L1541" name="L1541"></a>1541                                 <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(refc.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>())));
<a id="L1542" name="L1542"></a>1542             <strong class="reserved">if</strong> (!classOK &amp;&amp; (allowedModes &amp; PACKAGE) != 0) <em class="brace">{</em>
<a id="L1543" name="L1543"></a>1543                 classOK = (VerifyAccess.isClassAccessible(defc, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>(), ALL_MODES) &amp;&amp;
<a id="L1544" name="L1544"></a>1544                            (defc == refc ||
<a id="L1545" name="L1545"></a>1545                             VerifyAccess.isClassAccessible(refc, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>(), ALL_MODES)));
<a id="L1546" name="L1546"></a>1546             <em class="brace">}</em>
<a id="L1547" name="L1547"></a>1547             <strong class="reserved">if</strong> (!classOK)
<a id="L1548" name="L1548"></a>1548                 <strong class="reserved">return</strong> "class is not public";
<a id="L1549" name="L1549"></a>1549             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(mods))
<a id="L1550" name="L1550"></a>1550                 <strong class="reserved">return</strong> "access to public member failed";  <em class="comment">// (how?)</em>
<a id="L1551" name="L1551"></a>1551             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26092.html" title="Multiple defined in 5 places.">isPrivate</a>(mods))
<a id="L1552" name="L1552"></a>1552                 <strong class="reserved">return</strong> "member is private";
<a id="L1553" name="L1553"></a>1553             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26106.html" title="Multiple defined in 5 places.">isProtected</a>(mods))
<a id="L1554" name="L1554"></a>1554                 <strong class="reserved">return</strong> "member is protected";
<a id="L1555" name="L1555"></a>1555             <strong class="reserved">return</strong> "member is private to package";
<a id="L1556" name="L1556"></a>1556         <em class="brace">}</em>
<a id="L1557" name="L1557"></a>1557 
<a id="L1558" name="L1558"></a>1558         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> ALLOW_NESTMATE_ACCESS = <strong class="reserved">false</strong>;
<a id="L1559" name="L1559"></a>1559 
<a id="L1560" name="L1560"></a>1560         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/11366.html" title="Multiple referred from 2 places.">checkSpecialCaller</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; specialCaller) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1561" name="L1561"></a>1561             <strong class="reserved">int</strong> allowedModes = <strong class="reserved">this</strong>.allowedModes;
<a id="L1562" name="L1562"></a>1562             <strong class="reserved">if</strong> (allowedModes == TRUSTED)  <strong class="reserved">return</strong>;
<a id="L1563" name="L1563"></a>1563             <strong class="reserved">if</strong> (!<a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>()
<a id="L1564" name="L1564"></a>1564                 || (specialCaller != <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>()
<a id="L1565" name="L1565"></a>1565                     &amp;&amp; !(ALLOW_NESTMATE_ACCESS &amp;&amp;
<a id="L1566" name="L1566"></a>1566                          VerifyAccess.isSamePackageMember(specialCaller, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>()))))
<a id="L1567" name="L1567"></a>1567                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(specialCaller).
<a id="L1568" name="L1568"></a>1568                     <a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>("no private access for invokespecial", <strong class="reserved">this</strong>);
<a id="L1569" name="L1569"></a>1569         <em class="brace">}</em>
<a id="L1570" name="L1570"></a>1570 
<a id="L1571" name="L1571"></a>1571         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/26437.html" title="Multiple referred from 2 places.">restrictProtectedReceiver</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method) <em class="brace">{</em>
<a id="L1572" name="L1572"></a>1572             <em class="comment">// The accessing class only has the right to use a protected member</em>
<a id="L1573" name="L1573"></a>1573             <em class="comment">// on itself or a subclass.  Enforce that restriction, from JVMS 5.4.4, etc.</em>
<a id="L1574" name="L1574"></a>1574             <strong class="reserved">if</strong> (!method.<a href="../D/26106.html" title="Multiple defined in 5 places.">isProtected</a>() || method.<a href="../D/26281.html" title="Multiple defined in 7 places.">isStatic</a>()
<a id="L1575" name="L1575"></a>1575                 || allowedModes == TRUSTED
<a id="L1576" name="L1576"></a>1576                 || method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>() == <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>()
<a id="L1577" name="L1577"></a>1577                 || VerifyAccess.isSamePackage(method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>())
<a id="L1578" name="L1578"></a>1578                 || (ALLOW_NESTMATE_ACCESS &amp;&amp;
<a id="L1579" name="L1579"></a>1579                     VerifyAccess.isSamePackageMember(method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>())))
<a id="L1580" name="L1580"></a>1580                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1581" name="L1581"></a>1581             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1582" name="L1582"></a>1582         <em class="brace">}</em>
<a id="L1583" name="L1583"></a>1583         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/26438.html" title="Multiple referred from 2 places.">restrictReceiver</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a> mh, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; caller) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1584" name="L1584"></a>1584             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!method.<a href="../D/26281.html" title="Multiple defined in 7 places.">isStatic</a>());
<a id="L1585" name="L1585"></a>1585             <em class="comment">// receiver type of mh is too wide; narrow to caller</em>
<a id="L1586" name="L1586"></a>1586             <strong class="reserved">if</strong> (!method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>().<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(caller)) <em class="brace">{</em>
<a id="L1587" name="L1587"></a>1587                 <strong class="reserved">throw</strong> method.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>("caller class must be a subclass below the method", caller);
<a id="L1588" name="L1588"></a>1588             <em class="brace">}</em>
<a id="L1589" name="L1589"></a>1589             <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> rawType = mh.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L1590" name="L1590"></a>1590             <strong class="reserved">if</strong> (rawType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0) == caller)  <strong class="reserved">return</strong> mh;
<a id="L1591" name="L1591"></a>1591             <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> narrowType = rawType.<a href="../S/1616.html#L369" title="Defined at 369 in src/java/lang/invoke/MethodType.java.">changeParameterType</a>(0, caller);
<a id="L1592" name="L1592"></a>1592             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!mh.<a href="../D/26478.html" title="Multiple defined in 2 places.">isVarargsCollector</a>());  <em class="comment">// viewAsType will lose varargs-ness</em>
<a id="L1593" name="L1593"></a>1593             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(mh.<a href="../D/36413.html" title="Multiple defined in 2 places.">viewAsTypeChecks</a>(narrowType, <strong class="reserved">true</strong>));
<a id="L1594" name="L1594"></a>1594             <strong class="reserved">return</strong> mh.<a href="../D/13534.html" title="Multiple defined in 10 places.">copyWith</a>(narrowType, mh.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>);
<a id="L1595" name="L1595"></a>1595         <em class="brace">}</em>
<a id="L1596" name="L1596"></a>1596 
<div class="comment">
         /** Check access and get the requested method. */</div>
<a id="L1598" name="L1598"></a>1598         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16166.html" title="Multiple referred from 3 places.">getDirectMethod</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1599" name="L1599"></a>1599             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> doRestrict    = <strong class="reserved">true</strong>;
<a id="L1600" name="L1600"></a>1600             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">true</strong>;
<a id="L1601" name="L1601"></a>1601             <strong class="reserved">return</strong> <a href="../S/1619.html#L1616" title="Defined at 1616 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodCommon</a>(refKind, refc, method, checkSecurity, doRestrict, callerClass);
<a id="L1602" name="L1602"></a>1602         <em class="brace">}</em>
<div class="comment">
         /** Check access and get the requested method, eliding receiver narrowing rules. */</div>
<a id="L1604" name="L1604"></a>1604         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L1147" title="Referred from 1147 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoRestrict</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1605" name="L1605"></a>1605             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> doRestrict    = <strong class="reserved">false</strong>;
<a id="L1606" name="L1606"></a>1606             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">true</strong>;
<a id="L1607" name="L1607"></a>1607             <strong class="reserved">return</strong> <a href="../S/1619.html#L1616" title="Defined at 1616 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodCommon</a>(refKind, refc, method, checkSecurity, doRestrict, callerClass);
<a id="L1608" name="L1608"></a>1608         <em class="brace">}</em>
<div class="comment">
         /** Check access and get the requested method, eliding security manager checks. */</div>
<a id="L1610" name="L1610"></a>1610         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16170.html" title="Multiple referred from 3 places.">getDirectMethodNoSecurityManager</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1611" name="L1611"></a>1611             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> doRestrict    = <strong class="reserved">true</strong>;
<a id="L1612" name="L1612"></a>1612             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">false</strong>;  <em class="comment">// not needed for reflection or for linking CONSTANT_MH constants</em>
<a id="L1613" name="L1613"></a>1613             <strong class="reserved">return</strong> <a href="../S/1619.html#L1616" title="Defined at 1616 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodCommon</a>(refKind, refc, method, checkSecurity, doRestrict, callerClass);
<a id="L1614" name="L1614"></a>1614         <em class="brace">}</em>
<div class="comment">
         /** Common code for all methods; do not call directly except from immediately above. */</div>
<a id="L1616" name="L1616"></a>1616         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16167.html" title="Multiple referred from 3 places.">getDirectMethodCommon</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method,
<a id="L1617" name="L1617"></a>1617                                                    <strong class="reserved">boolean</strong> checkSecurity,
<a id="L1618" name="L1618"></a>1618                                                    <strong class="reserved">boolean</strong> doRestrict, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1619" name="L1619"></a>1619             <a href="../D/12536.html" title="Multiple defined in 4 places.">checkMethod</a>(refKind, refc, method);
<a id="L1620" name="L1620"></a>1620             <em class="comment">// Optionally check with the security manager; this isn't needed for unreflect* calls.</em>
<a id="L1621" name="L1621"></a>1621             <strong class="reserved">if</strong> (checkSecurity)
<a id="L1622" name="L1622"></a>1622                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(refc, method);
<a id="L1623" name="L1623"></a>1623             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!method.<a href="../S/1611.html#L346" title="Defined at 346 in src/java/lang/invoke/MemberName.java.">isMethodHandleInvoke</a>());
<a id="L1624" name="L1624"></a>1624 
<a id="L1625" name="L1625"></a>1625             <strong class="reserved">if</strong> (refKind == REF_invokeSpecial &amp;&amp;
<a id="L1626" name="L1626"></a>1626                 refc != <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>() &amp;&amp;
<a id="L1627" name="L1627"></a>1627                 !refc.<a href="../D/25735.html" title="Multiple defined in 6 places.">isInterface</a>() &amp;&amp;
<a id="L1628" name="L1628"></a>1628                 refc != <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>().<a href="../D/22863.html" title="Multiple defined in 4 places.">getSuperclass</a>() &amp;&amp;
<a id="L1629" name="L1629"></a>1629                 refc.<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>())) <em class="brace">{</em>
<a id="L1630" name="L1630"></a>1630                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!method.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("&lt;init&gt;"));  <em class="comment">// not this code path</em>
<a id="L1631" name="L1631"></a>1631                 <em class="comment">// Per JVMS 6.5, desc. of invokespecial instruction:</em>
<a id="L1632" name="L1632"></a>1632                 <em class="comment">// If the method is in a superclass of the LC,</em>
<a id="L1633" name="L1633"></a>1633                 <em class="comment">// and if our original search was above LC.super,</em>
<a id="L1634" name="L1634"></a>1634                 <em class="comment">// repeat the search (symbolic lookup) from LC.super</em>
<a id="L1635" name="L1635"></a>1635                 <em class="comment">// and continue with the direct superclass of that class,</em>
<a id="L1636" name="L1636"></a>1636                 <em class="comment">// and so forth, until a match is found or no further superclasses exist.</em>
<a id="L1637" name="L1637"></a>1637                 <em class="comment">// FIXME: MemberName.resolve should handle this instead.</em>
<a id="L1638" name="L1638"></a>1638                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refcAsSuper = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>();
<a id="L1639" name="L1639"></a>1639                 <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m2;
<a id="L1640" name="L1640"></a>1640                 <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L1641" name="L1641"></a>1641                     refcAsSuper = refcAsSuper.<a href="../D/22863.html" title="Multiple defined in 4 places.">getSuperclass</a>();
<a id="L1642" name="L1642"></a>1642                     m2 = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refcAsSuper,
<a id="L1643" name="L1643"></a>1643                                         method.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L1644" name="L1644"></a>1644                                         method.<a href="../D/20598.html" title="Multiple defined in 3 places.">getMethodType</a>(),
<a id="L1645" name="L1645"></a>1645                                         REF_invokeSpecial);
<a id="L1646" name="L1646"></a>1646                     m2 = IMPL_NAMES.<a href="../S/1611.html#L1001" title="Defined at 1001 in src/java/lang/invoke/MemberName.java.">resolveOrNull</a>(refKind, m2, <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>());
<a id="L1647" name="L1647"></a>1647                 <em class="brace">}</em> <strong class="reserved">while</strong> (m2 == <strong class="reserved">null</strong> &amp;&amp;         <em class="comment">// no method is found yet</em>
<a id="L1648" name="L1648"></a>1648                          refc != refcAsSuper); <em class="comment">// search up to refc</em>
<a id="L1649" name="L1649"></a>1649                 <strong class="reserved">if</strong> (m2 == <strong class="reserved">null</strong>)  <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>(method.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L1650" name="L1650"></a>1650                 method = m2;
<a id="L1651" name="L1651"></a>1651                 refc = refcAsSuper;
<a id="L1652" name="L1652"></a>1652                 <em class="comment">// redo basic checks</em>
<a id="L1653" name="L1653"></a>1653                 <a href="../D/12536.html" title="Multiple defined in 4 places.">checkMethod</a>(refKind, refc, method);
<a id="L1654" name="L1654"></a>1654             <em class="brace">}</em>
<a id="L1655" name="L1655"></a>1655 
<a id="L1656" name="L1656"></a>1656             <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a> dmh = <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>.<a href="../D/27195.html" title="Multiple defined in 13 places.">make</a>(refKind, refc, method);
<a id="L1657" name="L1657"></a>1657             <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = dmh;
<a id="L1658" name="L1658"></a>1658             <em class="comment">// Optionally narrow the receiver argument to refc using restrictReceiver.</em>
<a id="L1659" name="L1659"></a>1659             <strong class="reserved">if</strong> (doRestrict &amp;&amp;
<a id="L1660" name="L1660"></a>1660                    (refKind == REF_invokeSpecial ||
<a id="L1661" name="L1661"></a>1661                        (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L211" title="Defined at 211 in src/java/lang/invoke/MethodHandleNatives.java.">refKindHasReceiver</a>(refKind) &amp;&amp;
<a id="L1662" name="L1662"></a>1662                            <a href="../S/1619.html#L1571" title="Defined at 1571 in src/java/lang/invoke/MethodHandles.java.">restrictProtectedReceiver</a>(method)))) <em class="brace">{</em>
<a id="L1663" name="L1663"></a>1663                 mh = <a href="../S/1619.html#L1583" title="Defined at 1583 in src/java/lang/invoke/MethodHandles.java.">restrictReceiver</a>(method, dmh, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>());
<a id="L1664" name="L1664"></a>1664             <em class="brace">}</em>
<a id="L1665" name="L1665"></a>1665             mh = <a href="../S/1619.html#L1669" title="Defined at 1669 in src/java/lang/invoke/MethodHandles.java.">maybeBindCaller</a>(method, mh, callerClass);
<a id="L1666" name="L1666"></a>1666             mh = mh.<a href="../D/34276.html" title="Multiple defined in 2 places.">setVarargs</a>(method);
<a id="L1667" name="L1667"></a>1667             <strong class="reserved">return</strong> mh;
<a id="L1668" name="L1668"></a>1668         <em class="brace">}</em>
<a id="L1669" name="L1669"></a>1669         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L1665" title="Referred from 1665 in src/java/lang/invoke/MethodHandles.java.">maybeBindCaller</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh,
<a id="L1670" name="L1670"></a>1670                                              <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass)
<a id="L1671" name="L1671"></a>1671                                              <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1672" name="L1672"></a>1672             <strong class="reserved">if</strong> (allowedModes == TRUSTED || !<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>(method))
<a id="L1673" name="L1673"></a>1673                 <strong class="reserved">return</strong> mh;
<a id="L1674" name="L1674"></a>1674             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; hostClass = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L1675" name="L1675"></a>1675             <strong class="reserved">if</strong> (!<a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>())  <em class="comment">// caller must have private access</em>
<a id="L1676" name="L1676"></a>1676                 hostClass = callerClass;  <em class="comment">// callerClass came from a security manager style stack walk</em>
<a id="L1677" name="L1677"></a>1677             <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> cbmh = <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/11853.html" title="Multiple defined in 3 places.">bindCaller</a>(mh, hostClass);
<a id="L1678" name="L1678"></a>1678             <em class="comment">// Note: caller will apply varargs after this step happens.</em>
<a id="L1679" name="L1679"></a>1679             <strong class="reserved">return</strong> cbmh;
<a id="L1680" name="L1680"></a>1680         <em class="brace">}</em>
<div class="comment">
         /** Check access and get the requested field. */</div>
<a id="L1682" name="L1682"></a>1682         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16163.html" title="Multiple referred from 4 places.">getDirectField</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1683" name="L1683"></a>1683             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">true</strong>;
<a id="L1684" name="L1684"></a>1684             <strong class="reserved">return</strong> <a href="../S/1619.html#L1692" title="Defined at 1692 in src/java/lang/invoke/MethodHandles.java.">getDirectFieldCommon</a>(refKind, refc, field, checkSecurity);
<a id="L1685" name="L1685"></a>1685         <em class="brace">}</em>
<div class="comment">
         /** Check access and get the requested field, eliding security manager checks. */</div>
<a id="L1687" name="L1687"></a>1687         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16165.html" title="Multiple referred from 2 places.">getDirectFieldNoSecurityManager</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1688" name="L1688"></a>1688             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">false</strong>;  <em class="comment">// not needed for reflection or for linking CONSTANT_MH constants</em>
<a id="L1689" name="L1689"></a>1689             <strong class="reserved">return</strong> <a href="../S/1619.html#L1692" title="Defined at 1692 in src/java/lang/invoke/MethodHandles.java.">getDirectFieldCommon</a>(refKind, refc, field, checkSecurity);
<a id="L1690" name="L1690"></a>1690         <em class="brace">}</em>
<div class="comment">
         /** Common code for all fields; do not call directly except from immediately above. */</div>
<a id="L1692" name="L1692"></a>1692         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16164.html" title="Multiple referred from 2 places.">getDirectFieldCommon</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field,
<a id="L1693" name="L1693"></a>1693                                                   <strong class="reserved">boolean</strong> checkSecurity) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1694" name="L1694"></a>1694             <a href="../S/1619.html#L1474" title="Defined at 1474 in src/java/lang/invoke/MethodHandles.java.">checkField</a>(refKind, refc, field);
<a id="L1695" name="L1695"></a>1695             <em class="comment">// Optionally check with the security manager; this isn't needed for unreflect* calls.</em>
<a id="L1696" name="L1696"></a>1696             <strong class="reserved">if</strong> (checkSecurity)
<a id="L1697" name="L1697"></a>1697                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(refc, field);
<a id="L1698" name="L1698"></a>1698             <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a> dmh = <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>.<a href="../D/27195.html" title="Multiple defined in 13 places.">make</a>(refc, field);
<a id="L1699" name="L1699"></a>1699             <strong class="reserved">boolean</strong> doRestrict = (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L211" title="Defined at 211 in src/java/lang/invoke/MethodHandleNatives.java.">refKindHasReceiver</a>(refKind) &amp;&amp;
<a id="L1700" name="L1700"></a>1700                                     <a href="../S/1619.html#L1571" title="Defined at 1571 in src/java/lang/invoke/MethodHandles.java.">restrictProtectedReceiver</a>(field));
<a id="L1701" name="L1701"></a>1701             <strong class="reserved">if</strong> (doRestrict)
<a id="L1702" name="L1702"></a>1702                 <strong class="reserved">return</strong> <a href="../S/1619.html#L1583" title="Defined at 1583 in src/java/lang/invoke/MethodHandles.java.">restrictReceiver</a>(field, dmh, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>());
<a id="L1703" name="L1703"></a>1703             <strong class="reserved">return</strong> dmh;
<a id="L1704" name="L1704"></a>1704         <em class="brace">}</em>
<div class="comment">
         /** Check access and get the requested constructor. */</div>
<a id="L1706" name="L1706"></a>1706         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L921" title="Referred from 921 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructor</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1707" name="L1707"></a>1707             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">true</strong>;
<a id="L1708" name="L1708"></a>1708             <strong class="reserved">return</strong> <a href="../S/1619.html#L1716" title="Defined at 1716 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructorCommon</a>(refc, ctor, checkSecurity);
<a id="L1709" name="L1709"></a>1709         <em class="brace">}</em>
<div class="comment">
         /** Check access and get the requested constructor, eliding security manager checks. */</div>
<a id="L1711" name="L1711"></a>1711         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16162.html" title="Multiple referred from 2 places.">getDirectConstructorNoSecurityManager</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1712" name="L1712"></a>1712             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">false</strong>;  <em class="comment">// not needed for reflection or for linking CONSTANT_MH constants</em>
<a id="L1713" name="L1713"></a>1713             <strong class="reserved">return</strong> <a href="../S/1619.html#L1716" title="Defined at 1716 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructorCommon</a>(refc, ctor, checkSecurity);
<a id="L1714" name="L1714"></a>1714         <em class="brace">}</em>
<div class="comment">
         /** Common code for all constructors; do not call directly except from immediately above. */</div>
<a id="L1716" name="L1716"></a>1716         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16161.html" title="Multiple referred from 2 places.">getDirectConstructorCommon</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor,
<a id="L1717" name="L1717"></a>1717                                                   <strong class="reserved">boolean</strong> checkSecurity) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1718" name="L1718"></a>1718             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(ctor.<a href="../D/25363.html" title="Multiple defined in 6 places.">isConstructor</a>());
<a id="L1719" name="L1719"></a>1719             <a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(REF_newInvokeSpecial, refc, ctor);
<a id="L1720" name="L1720"></a>1720             <em class="comment">// Optionally check with the security manager; this isn't needed for unreflect* calls.</em>
<a id="L1721" name="L1721"></a>1721             <strong class="reserved">if</strong> (checkSecurity)
<a id="L1722" name="L1722"></a>1722                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(refc, ctor);
<a id="L1723" name="L1723"></a>1723             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>(ctor));  <em class="comment">// maybeBindCaller not relevant here</em>
<a id="L1724" name="L1724"></a>1724             <strong class="reserved">return</strong> <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>.<a href="../D/27195.html" title="Multiple defined in 13 places.">make</a>(ctor).<a href="../D/34276.html" title="Multiple defined in 2 places.">setVarargs</a>(ctor);
<a id="L1725" name="L1725"></a>1725         <em class="brace">}</em>
<a id="L1726" name="L1726"></a>1726 
<div class="comment">
 Hook called from the JVM (via MethodHandleNatives) to link MH constants:</div>
<div class="comment">
         /*non-public*/</div>
<a id="L1730" name="L1730"></a>1730         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1603.html#L477" title="Referred from 477 in src/java/lang/invoke/MethodHandleNatives.java.">linkMethodHandleConstant</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <em class="brace">{</em>
<a id="L1731" name="L1731"></a>1731             <strong class="reserved">if</strong> (!(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> <strong class="reserved">instanceof</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a> || <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> <strong class="reserved">instanceof</strong> <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>))
<a id="L1732" name="L1732"></a>1732                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>("unresolved MemberName");
<a id="L1733" name="L1733"></a>1733             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a> = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refKind, defc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1734" name="L1734"></a>1734             <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = LOOKASIDE_TABLE.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1735" name="L1735"></a>1735             <strong class="reserved">if</strong> (mh != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1736" name="L1736"></a>1736                 <a href="../S/1619.html#L1394" title="Defined at 1394 in src/java/lang/invoke/MethodHandles.java.">checkSymbolicClass</a>(defc);
<a id="L1737" name="L1737"></a>1737                 <strong class="reserved">return</strong> mh;
<a id="L1738" name="L1738"></a>1738             <em class="brace">}</em>
<a id="L1739" name="L1739"></a>1739             <em class="comment">// Treat MethodHandle.invoke and invokeExact specially.</em>
<a id="L1740" name="L1740"></a>1740             <strong class="reserved">if</strong> (defc == <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong> &amp;&amp; refKind == REF_invokeVirtual) <em class="brace">{</em>
<a id="L1741" name="L1741"></a>1741                 mh = <a href="../S/1619.html#L861" title="Defined at 861 in src/java/lang/invoke/MethodHandles.java.">findVirtualForMH</a>(<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(), <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/20598.html" title="Multiple defined in 3 places.">getMethodType</a>());
<a id="L1742" name="L1742"></a>1742                 <strong class="reserved">if</strong> (mh != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1743" name="L1743"></a>1743                     <strong class="reserved">return</strong> mh;
<a id="L1744" name="L1744"></a>1744                 <em class="brace">}</em>
<a id="L1745" name="L1745"></a>1745             <em class="brace">}</em>
<a id="L1746" name="L1746"></a>1746             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> resolved = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1747" name="L1747"></a>1747             mh = <a href="../S/1619.html#L1793" title="Defined at 1793 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodForConstant</a>(refKind, defc, resolved);
<a id="L1748" name="L1748"></a>1748             <strong class="reserved">if</strong> (mh <strong class="reserved">instanceof</strong> <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>
<a id="L1749" name="L1749"></a>1749                     &amp;&amp; <a href="../S/1619.html#L1761" title="Defined at 1761 in src/java/lang/invoke/MethodHandles.java.">canBeCached</a>(refKind, defc, resolved)) <em class="brace">{</em>
<a id="L1750" name="L1750"></a>1750                 <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> = mh.<a href="../D/24941.html" title="Multiple defined in 5 places.">internalMemberName</a>();
<a id="L1751" name="L1751"></a>1751                 <strong class="reserved">if</strong> (<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1752" name="L1752"></a>1752                     <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> = <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>.<a href="../S/1611.html#L582" title="Defined at 582 in src/java/lang/invoke/MemberName.java.">asNormalOriginal</a>();
<a id="L1753" name="L1753"></a>1753                 <em class="brace">}</em>
<a id="L1754" name="L1754"></a>1754                 <strong class="reserved">if</strong> (<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>)) <em class="brace">{</em>  <em class="comment">// better safe than sorry</em>
<a id="L1755" name="L1755"></a>1755                     LOOKASIDE_TABLE.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>, (<a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>) mh);
<a id="L1756" name="L1756"></a>1756                 <em class="brace">}</em>
<a id="L1757" name="L1757"></a>1757             <em class="brace">}</em>
<a id="L1758" name="L1758"></a>1758             <strong class="reserved">return</strong> mh;
<a id="L1759" name="L1759"></a>1759         <em class="brace">}</em>
<a id="L1760" name="L1760"></a>1760         <strong class="reserved">private</strong>
<a id="L1761" name="L1761"></a>1761         <strong class="reserved">boolean</strong> <a href="../S/1619.html#L1749" title="Referred from 1749 in src/java/lang/invoke/MethodHandles.java.">canBeCached</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>) <em class="brace">{</em>
<a id="L1762" name="L1762"></a>1762             <strong class="reserved">if</strong> (refKind == REF_invokeSpecial) <em class="brace">{</em>
<a id="L1763" name="L1763"></a>1763                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1764" name="L1764"></a>1764             <em class="brace">}</em>
<a id="L1765" name="L1765"></a>1765             <strong class="reserved">if</strong> (!<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(defc.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>()) ||
<a id="L1766" name="L1766"></a>1766                     !<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>().<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>()) ||
<a id="L1767" name="L1767"></a>1767                     !<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>() ||
<a id="L1768" name="L1768"></a>1768                     <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>()) <em class="brace">{</em>
<a id="L1769" name="L1769"></a>1769                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1770" name="L1770"></a>1770             <em class="brace">}</em>
<a id="L1771" name="L1771"></a>1771             <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> loader = defc.<a href="../D/17691.html" title="Multiple defined in 20 places.">getClassLoader</a>();
<a id="L1772" name="L1772"></a>1772             <strong class="reserved">if</strong> (!sun.misc.VM.isSystemDomainLoader(loader)) <em class="brace">{</em>
<a id="L1773" name="L1773"></a>1773                 <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> sysl = <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a>.<a href="../D/22895.html" title="Multiple defined in 7 places.">getSystemClassLoader</a>();
<a id="L1774" name="L1774"></a>1774                 <strong class="reserved">boolean</strong> found = <strong class="reserved">false</strong>;
<a id="L1775" name="L1775"></a>1775                 <strong class="reserved">while</strong> (sysl != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1776" name="L1776"></a>1776                     <strong class="reserved">if</strong> (loader == sysl) <em class="brace">{</em> found = <strong class="reserved">true</strong>; <strong class="reserved">break</strong>; <em class="brace">}</em>
<a id="L1777" name="L1777"></a>1777                     sysl = sysl.<a href="../D/21392.html" title="Multiple defined in 42 places.">getParent</a>();
<a id="L1778" name="L1778"></a>1778                 <em class="brace">}</em>
<a id="L1779" name="L1779"></a>1779                 <strong class="reserved">if</strong> (!found) <em class="brace">{</em>
<a id="L1780" name="L1780"></a>1780                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1781" name="L1781"></a>1781                 <em class="brace">}</em>
<a id="L1782" name="L1782"></a>1782             <em class="brace">}</em>
<a id="L1783" name="L1783"></a>1783             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1784" name="L1784"></a>1784                 <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> resolved2 = <a href="../S/1619.html#L116" title="Defined at 116 in src/java/lang/invoke/MethodHandles.java.">publicLookup</a>().<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind,
<a id="L1785" name="L1785"></a>1785                     <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refKind, defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(), <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>()));
<a id="L1786" name="L1786"></a>1786                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(defc, resolved2);
<a id="L1787" name="L1787"></a>1787             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> | <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L1788" name="L1788"></a>1788                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1789" name="L1789"></a>1789             <em class="brace">}</em>
<a id="L1790" name="L1790"></a>1790             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1791" name="L1791"></a>1791         <em class="brace">}</em>
<a id="L1792" name="L1792"></a>1792         <strong class="reserved">private</strong>
<a id="L1793" name="L1793"></a>1793         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L1747" title="Referred from 1747 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodForConstant</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>)
<a id="L1794" name="L1794"></a>1794                 <strong class="reserved">throws</strong> <a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <em class="brace">{</em>
<a id="L1795" name="L1795"></a>1795             <strong class="reserved">if</strong> (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L194" title="Defined at 194 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsField</a>(refKind)) <em class="brace">{</em>
<a id="L1796" name="L1796"></a>1796                 <strong class="reserved">return</strong> <a href="../S/1619.html#L1687" title="Defined at 1687 in src/java/lang/invoke/MethodHandles.java.">getDirectFieldNoSecurityManager</a>(refKind, defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1797" name="L1797"></a>1797             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L205" title="Defined at 205 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsMethod</a>(refKind)) <em class="brace">{</em>
<a id="L1798" name="L1798"></a>1798                 <strong class="reserved">return</strong> <a href="../S/1619.html#L1610" title="Defined at 1610 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoSecurityManager</a>(refKind, defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>);
<a id="L1799" name="L1799"></a>1799             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (refKind == REF_newInvokeSpecial) <em class="brace">{</em>
<a id="L1800" name="L1800"></a>1800                 <strong class="reserved">return</strong> <a href="../S/1619.html#L1711" title="Defined at 1711 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructorNoSecurityManager</a>(defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1801" name="L1801"></a>1801             <em class="brace">}</em>
<a id="L1802" name="L1802"></a>1802             <em class="comment">// oops</em>
<a id="L1803" name="L1803"></a>1803             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("bad MethodHandle constant #"+<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1804" name="L1804"></a>1804         <em class="brace">}</em>
<a id="L1805" name="L1805"></a>1805 
<a id="L1806" name="L1806"></a>1806         <strong class="reserved">static</strong> <a href="../S/1074.html#L267" title="Defined at 267 in src/java/util/concurrent/ConcurrentHashMap.java.">ConcurrentHashMap</a>&lt;<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>, <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>&gt; LOOKASIDE_TABLE = <strong class="reserved">new</strong> <a href="../S/1074.html#L267" title="Defined at 267 in src/java/util/concurrent/ConcurrentHashMap.java.">ConcurrentHashMap</a>&lt;&gt;();
<a id="L1807" name="L1807"></a>1807     <em class="brace">}</em>
<a id="L1808" name="L1808"></a>1808 
<div class="comment">
      Produces a method handle giving read access to elements of an array.
      The type of the method handle will have a return type of the array's
      element type.  Its first argument will be the array type,
      and the second will be <code>int</code>.
      @param arrayClass an array type
      @return a method handle which can load values from the given array type
      @throws NullPointerException if the argument is null
      @throws  IllegalArgumentException if arrayClass is not an array type</div>
<a id="L1819" name="L1819"></a>1819     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L1820" name="L1820"></a>1820     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/10316.html" title="Multiple referred from 2 places.">arrayElementGetter</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; arrayClass) <strong class="reserved">throws</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> <em class="brace">{</em>
<a id="L1821" name="L1821"></a>1821         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L71" title="Defined at 71 in src/java/lang/invoke/MethodHandleImpl.java.">makeArrayElementAccessor</a>(arrayClass, <strong class="reserved">false</strong>);
<a id="L1822" name="L1822"></a>1822     <em class="brace">}</em>
<a id="L1823" name="L1823"></a>1823 
<div class="comment">
      Produces a method handle giving write access to elements of an array.
      The type of the method handle will have a void return type.
      Its last argument will be the array's element type.
      The first and second arguments will be the array type and int.
      @param arrayClass the class of an array
      @return a method handle which can store values into the array type
      @throws NullPointerException if the argument is null
      @throws IllegalArgumentException if arrayClass is not an array type</div>
<a id="L1834" name="L1834"></a>1834     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L1835" name="L1835"></a>1835     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> arrayElementSetter(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; arrayClass) <strong class="reserved">throws</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> <em class="brace">{</em>
<a id="L1836" name="L1836"></a>1836         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L71" title="Defined at 71 in src/java/lang/invoke/MethodHandleImpl.java.">makeArrayElementAccessor</a>(arrayClass, <strong class="reserved">true</strong>);
<a id="L1837" name="L1837"></a>1837     <em class="brace">}</em>
<a id="L1838" name="L1838"></a>1838 
<a id="L1839" name="L1839"></a>1839     <em class="comment">/// method handle invocation (reflective style)</em>
<a id="L1840" name="L1840"></a>1840 
<div class="comment">
      Produces a method handle which will invoke any method handle of the
      given <code>type</code>, with a given number of trailing arguments replaced by
      a single trailing <code>Object[]</code> array.
      The resulting invoker will be a method handle with the following
      arguments:
      <ul><li>a single <code>MethodHandle</code> target
      </li><li>zero or more leading values (counted by <code>leadingArgCount</code>)
      </li><li>an <code>Object[]</code> array containing trailing arguments
      </li></ul>
      <p>
      The invoker will invoke its target like a call to {@link MethodHandle#invoke invoke} with
      the indicated <code>type</code>.
      That is, if the target is exactly of the given <code>type</code>, it will behave
      like <code>invokeExact</code>; otherwise it behave as if {@link MethodHandle#asType asType}
      is used to convert the target to the required <code>type</code>.
      </p><p>
      The type of the returned invoker will not be the given <code>type</code>, but rather
      will have all parameters except the first <code>leadingArgCount</code>
      replaced by a single array of type <code>Object[]</code>, which will be
      the final parameter.
      </p><p>
      Before invoking its target, the invoker will spread the final array, apply
      reference casts as necessary, and unbox and widen primitive arguments.
      If, when the invoker is called, the supplied array argument does
      not have the correct number of elements, the invoker will throw
      an <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> instead of invoking the target.
      </p><p>
      This method is equivalent to the following code (though it may be more efficient):
      </p><blockquote><pre>{@code
MethodHandle invoker = MethodHandles.invoker(type);
int spreadArgCount = type.parameterCount() - leadingArgCount;
invoker = invoker.asSpreader(Object[].class, spreadArgCount);
return invoker;
      }</pre></blockquote>
      This method throws no reflective or security exceptions.
      @param type the desired target type
      @param leadingArgCount number of fixed arguments, to be passed unchanged to the target
      @return a method handle suitable for invoking any method handle of the given type
      @throws NullPointerException if <code>type</code> is null
      @throws IllegalArgumentException if <code>leadingArgCount</code> is not in
                       the range from 0 to <code>type.parameterCount()</code> inclusive,
                       or if the resulting method handle's type would have
               <a href="MethodHandle.html#maxarity">too many parameters</a></div>
<a id="L1887" name="L1887"></a>1887     <strong class="reserved">static</strong> <strong class="reserved">public</strong>
<a id="L1888" name="L1888"></a>1888     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/28767.html" title="Multiple referred from 3 places.">spreadInvoker</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <strong class="reserved">int</strong> leadingArgCount) <em class="brace">{</em>
<a id="L1889" name="L1889"></a>1889         <strong class="reserved">if</strong> (leadingArgCount &lt; 0 || leadingArgCount &gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>())
<a id="L1890" name="L1890"></a>1890             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("bad argument count", leadingArgCount);
<a id="L1891" name="L1891"></a>1891         <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../R/29570.html" title="Multiple referred from 5977 places.">type</a>.<a href="../S/1616.html#L474" title="Defined at 474 in src/java/lang/invoke/MethodType.java.">asSpreaderType</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[].<strong class="reserved">class</strong>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() - leadingArgCount);
<a id="L1892" name="L1892"></a>1892         <strong class="reserved">return</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../D/34734.html" title="Multiple defined in 2 places.">spreadInvoker</a>(leadingArgCount);
<a id="L1893" name="L1893"></a>1893     <em class="brace">}</em>
<a id="L1894" name="L1894"></a>1894 
<div class="comment">
      Produces a special <em>invoker method handle</em> which can be used to
      invoke any method handle of the given type, as if by {@link MethodHandle#invokeExact invokeExact}.
      The resulting invoker will have a type which is
      exactly equal to the desired type, except that it will accept
      an additional leading argument of type <code>MethodHandle</code>.
      <p>
      This method is equivalent to the following code (though it may be more efficient):
      <code>publicLookup().findVirtual(MethodHandle.class, "invokeExact", type)</code>
      </p><p style="font-size:smaller;">
      <em>Discussion:</em>
      Invoker method handles can be useful when working with variable method handles
      of unknown types.
      For example, to emulate an <code>invokeExact</code> call to a variable method
      handle <code>M</code>, extract its type <code>T</code>,
      look up the invoker method <code>X</code> for <code>T</code>,
      and call the invoker method, as <code>X.invoke(T, A...)</code>.
      (It would not work to call <code>X.invokeExact</code>, since the type <code>T</code>
      is unknown.)
      If spreading, collecting, or other argument transformations are required,
      they can be applied once to the invoker <code>X</code> and reused on many <code>M</code>
      method handle values, as long as they are compatible with the type of <code>X</code>.
      </p><p style="font-size:smaller;">
      <em>(Note:  The invoker method is not available via the Core Reflection API.
      An attempt to call {@linkplain java.lang.reflect.Method#invoke java.lang.reflect.Method.invoke}
      on the declared <code>invokeExact</code> or <code>invoke</code> method will raise an
      {@link java.lang.UnsupportedOperationException UnsupportedOperationException}.)</em>
      </p><p>
      This method throws no reflective or security exceptions.
      @param type the desired target type
      @return a method handle suitable for invoking any method handle of the given type
      @throws IllegalArgumentException if the resulting method handle's type would have
               <a href="MethodHandle.html#maxarity">too many parameters</a></p></div>
<a id="L1930" name="L1930"></a>1930     <strong class="reserved">static</strong> <strong class="reserved">public</strong>
<a id="L1931" name="L1931"></a>1931     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14062.html" title="Multiple referred from 3 places.">exactInvoker</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L1932" name="L1932"></a>1932         <strong class="reserved">return</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../D/15761.html" title="Multiple defined in 2 places.">exactInvoker</a>();
<a id="L1933" name="L1933"></a>1933     <em class="brace">}</em>
<a id="L1934" name="L1934"></a>1934 
<div class="comment">
      Produces a special <em>invoker method handle</em> which can be used to
      invoke any method handle compatible with the given type, as if by {@link MethodHandle#invoke invoke}.
      The resulting invoker will have a type which is
      exactly equal to the desired type, except that it will accept
      an additional leading argument of type <code>MethodHandle</code>.
      <p>
      Before invoking its target, if the target differs from the expected type,
      the invoker will apply reference casts as
      necessary and box, unbox, or widen primitive values, as if by {@link MethodHandle#asType asType}.
      Similarly, the return value will be converted as necessary.
      If the target is a {@linkplain MethodHandle#asVarargsCollector variable arity method handle},
      the required arity conversion will be made, again as if by {@link MethodHandle#asType asType}.
      </p><p>
      This method is equivalent to the following code (though it may be more efficient):
      <code>publicLookup().findVirtual(MethodHandle.class, "invoke", type)</code>
      </p><p style="font-size:smaller;">
      <em>Discussion:</em>
      A {@linkplain MethodType#genericMethodType general method type} is one which
      mentions only <code>Object</code> arguments and return values.
      An invoker for such a type is capable of calling any method handle
      of the same arity as the general type.
      </p><p style="font-size:smaller;">
      <em>(Note:  The invoker method is not available via the Core Reflection API.
      An attempt to call {@linkplain java.lang.reflect.Method#invoke java.lang.reflect.Method.invoke}
      on the declared <code>invokeExact</code> or <code>invoke</code> method will raise an
      {@link java.lang.UnsupportedOperationException UnsupportedOperationException}.)</em>
      </p><p>
      This method throws no reflective or security exceptions.
      @param type the desired target type
      @return a method handle suitable for invoking any method handle convertible to the given type
      @throws IllegalArgumentException if the resulting method handle's type would have
               <a href="MethodHandle.html#maxarity">too many parameters</a></p></div>
<a id="L1969" name="L1969"></a>1969     <strong class="reserved">static</strong> <strong class="reserved">public</strong>
<a id="L1970" name="L1970"></a>1970     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/21099.html" title="Multiple referred from 96 places.">invoker</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L1971" name="L1971"></a>1971         <strong class="reserved">return</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../S/1599.html#L67" title="Defined at 67 in src/java/lang/invoke/Invokers.java.">genericInvoker</a>();
<a id="L1972" name="L1972"></a>1972     <em class="brace">}</em>
<a id="L1973" name="L1973"></a>1973 
<a id="L1974" name="L1974"></a>1974     <div class="comment">
/*non-public*/</div>
<a id="L1975" name="L1975"></a>1975     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/10542.html" title="Multiple referred from 6 places.">basicInvoker</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L1976" name="L1976"></a>1976         <strong class="reserved">return</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../D/11784.html" title="Multiple defined in 2 places.">basicInvoker</a>();
<a id="L1977" name="L1977"></a>1977     <em class="brace">}</em>
<a id="L1978" name="L1978"></a>1978 
<a id="L1979" name="L1979"></a>1979      <em class="comment">/// method handle modification (creation from other method handles)</em>
<a id="L1980" name="L1980"></a>1980 
<div class="comment">
      Produces a method handle which adapts the type of the
      given method handle to a new type by pairwise argument and return type conversion.
      The original type and new type must have the same number of arguments.
      The resulting method handle is guaranteed to report a type
      which is equal to the desired new type.
      <p>
      If the original type and new type are equal, returns target.
      </p><p>
      The same conversions are allowed as for {@link MethodHandle#asType MethodHandle.asType},
      and some additional conversions are also applied if those conversions fail.
      Given types <em>T0</em>, <em>T1</em>, one of the following conversions is applied
      if possible, before or instead of any conversions done by <code>asType</code>:
      </p><ul><li>If <em>T0</em> and <em>T1</em> are references, and <em>T1</em> is an interface type,
          then the value of type <em>T0</em> is passed as a <em>T1</em> without a cast.
          (This treatment of interfaces follows the usage of the bytecode verifier.)
      </li><li>If <em>T0</em> is boolean and <em>T1</em> is another primitive,
          the boolean is converted to a byte value, 1 for true, 0 for false.
          (This treatment follows the usage of the bytecode verifier.)
      </li><li>If <em>T1</em> is boolean and <em>T0</em> is another primitive,
          <em>T0</em> is converted to byte via Java casting conversion (JLS 5.5),
          and the low order bit of the result is tested, as if by <code>(x &amp; 1) != 0</code>.
      </li><li>If <em>T0</em> and <em>T1</em> are primitives other than boolean,
          then a Java casting conversion (JLS 5.5) is applied.
          (Specifically, <em>T0</em> will convert to <em>T1</em> by
          widening and/or narrowing.)
      </li><li>If <em>T0</em> is a reference and <em>T1</em> a primitive, an unboxing
          conversion will be applied at runtime, possibly followed
          by a Java casting conversion (JLS 5.5) on the primitive value,
          possibly followed by a conversion from byte to boolean by testing
          the low-order bit.
      </li><li>If <em>T0</em> is a reference and <em>T1</em> a primitive,
          and if the reference is null at runtime, a zero value is introduced.
      </li></ul>
      @param target the method handle to invoke after arguments are retyped
      @param newType the expected type of the new method handle
      @return a method handle which delegates to the target after performing
                any necessary argument conversions, and arranges for any
                necessary return value conversions
      @throws NullPointerException if either argument is null
      @throws WrongMethodTypeException if the conversion cannot be made
      @see MethodHandle#asType</div>
<a id="L2025" name="L2025"></a>2025     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2026" name="L2026"></a>2026     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> explicitCastArguments(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType) <em class="brace">{</em>
<a id="L2027" name="L2027"></a>2027         <a href="../S/1619.html#L2037" title="Defined at 2037 in src/java/lang/invoke/MethodHandles.java.">explicitCastArgumentsChecks</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, newType);
<a id="L2028" name="L2028"></a>2028         <em class="comment">// use the asTypeCache when possible:</em>
<a id="L2029" name="L2029"></a>2029         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2030" name="L2030"></a>2030         <strong class="reserved">if</strong> (oldType == newType)  <strong class="reserved">return</strong> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>;
<a id="L2031" name="L2031"></a>2031         <strong class="reserved">if</strong> (oldType.<a href="../D/15872.html" title="Multiple defined in 2 places.">explicitCastEquivalentToAsType</a>(newType)) <em class="brace">{</em>
<a id="L2032" name="L2032"></a>2032             <strong class="reserved">return</strong> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/11536.html" title="Multiple defined in 2 places.">asFixedArity</a>().<a href="../D/11568.html" title="Multiple defined in 2 places.">asType</a>(newType);
<a id="L2033" name="L2033"></a>2033         <em class="brace">}</em>
<a id="L2034" name="L2034"></a>2034         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/27364.html" title="Multiple defined in 2 places.">makePairwiseConvert</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, newType, <strong class="reserved">false</strong>);
<a id="L2035" name="L2035"></a>2035     <em class="brace">}</em>
<a id="L2036" name="L2036"></a>2036 
<a id="L2037" name="L2037"></a>2037     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/1619.html#L2027" title="Referred from 2027 in src/java/lang/invoke/MethodHandles.java.">explicitCastArgumentsChecks</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType) <em class="brace">{</em>
<a id="L2038" name="L2038"></a>2038         <strong class="reserved">if</strong> (<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>().<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() != newType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>()) <em class="brace">{</em>
<a id="L2039" name="L2039"></a>2039             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1605.html#L43" title="Defined at 43 in src/java/lang/invoke/WrongMethodTypeException.java.">WrongMethodTypeException</a>("cannot explicitly cast " + <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a> + " to " + newType);
<a id="L2040" name="L2040"></a>2040         <em class="brace">}</em>
<a id="L2041" name="L2041"></a>2041     <em class="brace">}</em>
<a id="L2042" name="L2042"></a>2042 
<div class="comment">
      Produces a method handle which adapts the calling sequence of the
      given method handle to a new type, by reordering the arguments.
      The resulting method handle is guaranteed to report a type
      which is equal to the desired new type.
      <p>
      The given array controls the reordering.
      Call <code>#I</code> the number of incoming parameters (the value
      <code>newType.parameterCount()</code>, and call <code>#O</code> the number
      of outgoing parameters (the value <code>target.type().parameterCount()</code>).
      Then the length of the reordering array must be <code>#O</code>,
      and each element must be a non-negative number less than <code>#I</code>.
      For every <code>N</code> less than <code>#O</code>, the <code>N</code>-th
      outgoing argument will be taken from the <code>I</code>-th incoming
      argument, where <code>I</code> is <code>reorder[N]</code>.
      </p><p>
      No argument or return value conversions are applied.
      The type of each incoming argument, as determined by <code>newType</code>,
      must be identical to the type of the corresponding outgoing parameter
      or parameters in the target method handle.
      The return type of <code>newType</code> must be identical to the return
      type of the original target.
      </p><p>
      The reordering array need not specify an actual permutation.
      An incoming argument will be duplicated if its index appears
      more than once in the array, and an incoming argument will be dropped
      if its index does not appear in the array.
      As in the case of {@link #dropArguments(MethodHandle,int,List) dropArguments},
      incoming arguments which are not mentioned in the reordering array
      are may be any type, as determined only by <code>newType</code>.
      </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodType intfn1 = methodType(int.class, int.class);
MethodType intfn2 = methodType(int.class, int.class, int.class);
MethodHandle sub = ... (int x, int y) -&gt; (x-y) ...;
assert(sub.type().equals(intfn2));
MethodHandle sub1 = permuteArguments(sub, intfn2, 0, 1);
MethodHandle rsub = permuteArguments(sub, intfn2, 1, 0);
assert((int)rsub.invokeExact(1, 100) == 99);
MethodHandle add = ... (int x, int y) -&gt; (x+y) ...;
assert(add.type().equals(intfn2));
MethodHandle twice = permuteArguments(add, intfn1, 0, 0);
assert(twice.type().equals(intfn1));
assert((int)twice.invokeExact(21) == 42);
      }</pre></blockquote>
      @param target the method handle to invoke after arguments are reordered
      @param newType the expected type of the new method handle
      @param reorder an index array which controls the reordering
      @return a method handle which delegates to the target after it
                drops unused arguments and moves and/or duplicates the other arguments
      @throws NullPointerException if any argument is null
      @throws IllegalArgumentException if the index array length is not equal to
                       the arity of the target, or if any index array element
                       not a valid index for a parameter of <code>newType</code>,
                       or if two corresponding parameter types in
                       <code>target.type()</code> and <code>newType</code> are not identical,</div>
<a id="L2102" name="L2102"></a>2102     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2103" name="L2103"></a>2103     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> permuteArguments(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType, <strong class="reserved">int</strong>... reorder) <em class="brace">{</em>
<a id="L2104" name="L2104"></a>2104         reorder = reorder.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();  <em class="comment">// get a private copy</em>
<a id="L2105" name="L2105"></a>2105         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2106" name="L2106"></a>2106         <a href="../S/1619.html#L2224" title="Defined at 2224 in src/java/lang/invoke/MethodHandles.java.">permuteArgumentChecks</a>(reorder, newType, oldType);
<a id="L2107" name="L2107"></a>2107         <em class="comment">// first detect dropped arguments and handle them separately</em>
<a id="L2108" name="L2108"></a>2108         <strong class="reserved">int</strong>[] originalReorder = reorder;
<a id="L2109" name="L2109"></a>2109         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2110" name="L2110"></a>2110         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>;
<a id="L2111" name="L2111"></a>2111         <strong class="reserved">int</strong> newArity = newType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2112" name="L2112"></a>2112         <em class="comment">// Normalize the reordering into a real permutation,</em>
<a id="L2113" name="L2113"></a>2113         <em class="comment">// by removing duplicates and adding dropped elements.</em>
<a id="L2114" name="L2114"></a>2114         <em class="comment">// This somewhat improves lambda form caching, as well</em>
<a id="L2115" name="L2115"></a>2115         <em class="comment">// as simplifying the transform by breaking it up into steps.</em>
<a id="L2116" name="L2116"></a>2116         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> ddIdx; (ddIdx = <a href="../S/1619.html#L2175" title="Defined at 2175 in src/java/lang/invoke/MethodHandles.java.">findFirstDupOrDrop</a>(reorder, newArity)) != 0; ) <em class="brace">{</em>
<a id="L2117" name="L2117"></a>2117             <strong class="reserved">if</strong> (ddIdx &gt; 0) <em class="brace">{</em>
<a id="L2118" name="L2118"></a>2118                 <em class="comment">// We found a duplicated entry at reorder[ddIdx].</em>
<a id="L2119" name="L2119"></a>2119                 <em class="comment">// Example:  (x,y,z)-&gt;asList(x,y,z)</em>
<a id="L2120" name="L2120"></a>2120                 <em class="comment">// permuted by [1*,0,1] =&gt; (a0,a1)=&gt;asList(a1,a0,a1)</em>
<a id="L2121" name="L2121"></a>2121                 <em class="comment">// permuted by [0,1,0*] =&gt; (a0,a1)=&gt;asList(a0,a1,a0)</em>
<a id="L2122" name="L2122"></a>2122                 <em class="comment">// The starred element corresponds to the argument</em>
<a id="L2123" name="L2123"></a>2123                 <em class="comment">// deleted by the dupArgumentForm transform.</em>
<a id="L2124" name="L2124"></a>2124                 <strong class="reserved">int</strong> srcPos = ddIdx, dstPos = srcPos, dupVal = reorder[srcPos];
<a id="L2125" name="L2125"></a>2125                 <strong class="reserved">boolean</strong> killFirst = <strong class="reserved">false</strong>;
<a id="L2126" name="L2126"></a>2126                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>; (<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a> = reorder[--dstPos]) != dupVal; ) <em class="brace">{</em>
<a id="L2127" name="L2127"></a>2127                     <em class="comment">// Set killFirst if the dup is larger than an intervening position.</em>
<a id="L2128" name="L2128"></a>2128                     <em class="comment">// This will remove at least one inversion from the permutation.</em>
<a id="L2129" name="L2129"></a>2129                     <strong class="reserved">if</strong> (dupVal &gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) killFirst = <strong class="reserved">true</strong>;
<a id="L2130" name="L2130"></a>2130                 <em class="brace">}</em>
<a id="L2131" name="L2131"></a>2131                 <strong class="reserved">if</strong> (!killFirst) <em class="brace">{</em>
<a id="L2132" name="L2132"></a>2132                     srcPos = dstPos;
<a id="L2133" name="L2133"></a>2133                     dstPos = ddIdx;
<a id="L2134" name="L2134"></a>2134                 <em class="brace">}</em>
<a id="L2135" name="L2135"></a>2135                 <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L500" title="Defined at 500 in src/java/lang/invoke/LambdaFormEditor.java.">dupArgumentForm</a>(1 + srcPos, 1 + dstPos);
<a id="L2136" name="L2136"></a>2136                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> (reorder[srcPos] == reorder[dstPos]);
<a id="L2137" name="L2137"></a>2137                 oldType = oldType.<a href="../S/1616.html#L548" title="Defined at 548 in src/java/lang/invoke/MethodType.java.">dropParameterTypes</a>(dstPos, dstPos + 1);
<a id="L2138" name="L2138"></a>2138                 <em class="comment">// contract the reordering by removing the element at dstPos</em>
<a id="L2139" name="L2139"></a>2139                 <strong class="reserved">int</strong> tailPos = dstPos + 1;
<a id="L2140" name="L2140"></a>2140                 <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(reorder, tailPos, reorder, dstPos, reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - tailPos);
<a id="L2141" name="L2141"></a>2141                 reorder = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13512.html" title="Multiple defined in 12 places.">copyOf</a>(reorder, reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - 1);
<a id="L2142" name="L2142"></a>2142             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2143" name="L2143"></a>2143                 <strong class="reserved">int</strong> dropVal = ~ddIdx, insPos = 0;
<a id="L2144" name="L2144"></a>2144                 <strong class="reserved">while</strong> (insPos &lt; reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &amp;&amp; reorder[insPos] &lt; dropVal) <em class="brace">{</em>
<a id="L2145" name="L2145"></a>2145                     <em class="comment">// Find first element of reorder larger than dropVal.</em>
<a id="L2146" name="L2146"></a>2146                     <em class="comment">// This is where we will insert the dropVal.</em>
<a id="L2147" name="L2147"></a>2147                     insPos += 1;
<a id="L2148" name="L2148"></a>2148                 <em class="brace">}</em>
<a id="L2149" name="L2149"></a>2149                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype = newType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(dropVal);
<a id="L2150" name="L2150"></a>2150                 <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L483" title="Defined at 483 in src/java/lang/invoke/LambdaFormEditor.java.">addArgumentForm</a>(1 + insPos, <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(ptype));
<a id="L2151" name="L2151"></a>2151                 oldType = oldType.<a href="../D/24768.html" title="Multiple defined in 2 places.">insertParameterTypes</a>(insPos, ptype);
<a id="L2152" name="L2152"></a>2152                 <em class="comment">// expand the reordering by inserting an element at insPos</em>
<a id="L2153" name="L2153"></a>2153                 <strong class="reserved">int</strong> tailPos = insPos + 1;
<a id="L2154" name="L2154"></a>2154                 reorder = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13512.html" title="Multiple defined in 12 places.">copyOf</a>(reorder, reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> + 1);
<a id="L2155" name="L2155"></a>2155                 <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(reorder, insPos, reorder, tailPos, reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - tailPos);
<a id="L2156" name="L2156"></a>2156                 reorder[insPos] = dropVal;
<a id="L2157" name="L2157"></a>2157             <em class="brace">}</em>
<a id="L2158" name="L2158"></a>2158             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> (<a href="../S/1619.html#L2224" title="Defined at 2224 in src/java/lang/invoke/MethodHandles.java.">permuteArgumentChecks</a>(reorder, newType, oldType));
<a id="L2159" name="L2159"></a>2159         <em class="brace">}</em>
<a id="L2160" name="L2160"></a>2160         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> (reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> == newArity);  <em class="comment">// a perfect permutation</em>
<a id="L2161" name="L2161"></a>2161         <em class="comment">// Note:  This may cache too many distinct LFs. Consider backing off to varargs code.</em>
<a id="L2162" name="L2162"></a>2162         <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L774" title="Defined at 774 in src/java/lang/invoke/LambdaFormEditor.java.">permuteArgumentsForm</a>(1, reorder);
<a id="L2163" name="L2163"></a>2163         <strong class="reserved">if</strong> (newType == <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>() &amp;&amp; <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> == <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../S/1623.html#L1357" title="Defined at 1357 in src/java/lang/invoke/MethodHandle.java.">internalForm</a>())
<a id="L2164" name="L2164"></a>2164             <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2165" name="L2165"></a>2165         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13534.html" title="Multiple defined in 10 places.">copyWith</a>(newType, <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>);
<a id="L2166" name="L2166"></a>2166     <em class="brace">}</em>
<a id="L2167" name="L2167"></a>2167 
<div class="comment">
      Return an indication of any duplicate or omission in reorder.
      If the reorder contains a duplicate entry, return the index of the second occurrence.
      Otherwise, return ~(n), for the first n in [0..newArity-1] that is not present in reorder.
      Otherwise, return zero.
      If an element not in [0..newArity-1] is encountered, return reorder.length.</div>
<a id="L2175" name="L2175"></a>2175     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../S/1619.html#L2116" title="Referred from 2116 in src/java/lang/invoke/MethodHandles.java.">findFirstDupOrDrop</a>(<strong class="reserved">int</strong>[] reorder, <strong class="reserved">int</strong> newArity) <em class="brace">{</em>
<a id="L2176" name="L2176"></a>2176         <strong class="reserved">final</strong> <strong class="reserved">int</strong> BIT_LIMIT = 63;  <em class="comment">// max number of bits in bit mask</em>
<a id="L2177" name="L2177"></a>2177         <strong class="reserved">if</strong> (newArity &lt; BIT_LIMIT) <em class="brace">{</em>
<a id="L2178" name="L2178"></a>2178             <strong class="reserved">long</strong> <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> = 0;
<a id="L2179" name="L2179"></a>2179             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L2180" name="L2180"></a>2180                 <strong class="reserved">int</strong> <a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a> = reorder[i];
<a id="L2181" name="L2181"></a>2181                 <strong class="reserved">if</strong> (<a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a> &gt;= newArity) <em class="brace">{</em>
<a id="L2182" name="L2182"></a>2182                     <strong class="reserved">return</strong> reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L2183" name="L2183"></a>2183                 <em class="brace">}</em>
<a id="L2184" name="L2184"></a>2184                 <strong class="reserved">long</strong> <a href="../D/11869.html" title="Multiple defined in 2 places.">bit</a> = 1L &lt;&lt; <a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a>;
<a id="L2185" name="L2185"></a>2185                 <strong class="reserved">if</strong> ((<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> &amp; <a href="../D/11869.html" title="Multiple defined in 2 places.">bit</a>) != 0) <em class="brace">{</em>
<a id="L2186" name="L2186"></a>2186                     <strong class="reserved">return</strong> i;  <em class="comment">// &gt;0 indicates a dup</em>
<a id="L2187" name="L2187"></a>2187                 <em class="brace">}</em>
<a id="L2188" name="L2188"></a>2188                 <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> |= <a href="../D/11869.html" title="Multiple defined in 2 places.">bit</a>;
<a id="L2189" name="L2189"></a>2189             <em class="brace">}</em>
<a id="L2190" name="L2190"></a>2190             <strong class="reserved">if</strong> (<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> == (1L &lt;&lt; newArity) - 1) <em class="brace">{</em>
<a id="L2191" name="L2191"></a>2191                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.<a href="../D/28379.html" title="Multiple defined in 2 places.">numberOfTrailingZeros</a>(<a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.<a href="../D/27183.html" title="Multiple defined in 2 places.">lowestOneBit</a>(~<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>)) == newArity);
<a id="L2192" name="L2192"></a>2192                 <strong class="reserved">return</strong> 0;
<a id="L2193" name="L2193"></a>2193             <em class="brace">}</em>
<a id="L2194" name="L2194"></a>2194             <em class="comment">// find first zero</em>
<a id="L2195" name="L2195"></a>2195             <strong class="reserved">long</strong> zeroBit = <a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.<a href="../D/27183.html" title="Multiple defined in 2 places.">lowestOneBit</a>(~<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>);
<a id="L2196" name="L2196"></a>2196             <strong class="reserved">int</strong> zeroPos = <a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.<a href="../D/28379.html" title="Multiple defined in 2 places.">numberOfTrailingZeros</a>(zeroBit);
<a id="L2197" name="L2197"></a>2197             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(zeroPos &lt;= newArity);
<a id="L2198" name="L2198"></a>2198             <strong class="reserved">if</strong> (zeroPos == newArity) <em class="brace">{</em>
<a id="L2199" name="L2199"></a>2199                 <strong class="reserved">return</strong> 0;
<a id="L2200" name="L2200"></a>2200             <em class="brace">}</em>
<a id="L2201" name="L2201"></a>2201             <strong class="reserved">return</strong> ~zeroPos;
<a id="L2202" name="L2202"></a>2202         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2203" name="L2203"></a>2203             <em class="comment">// same algorithm, different bit set</em>
<a id="L2204" name="L2204"></a>2204             <a href="../S/856.html#L65" title="Defined at 65 in src/java/util/BitSet.java.">BitSet</a> <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> = <strong class="reserved">new</strong> <a href="../S/856.html#L65" title="Defined at 65 in src/java/util/BitSet.java.">BitSet</a>(newArity);
<a id="L2205" name="L2205"></a>2205             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L2206" name="L2206"></a>2206                 <strong class="reserved">int</strong> <a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a> = reorder[i];
<a id="L2207" name="L2207"></a>2207                 <strong class="reserved">if</strong> (<a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a> &gt;= newArity) <em class="brace">{</em>
<a id="L2208" name="L2208"></a>2208                     <strong class="reserved">return</strong> reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L2209" name="L2209"></a>2209                 <em class="brace">}</em>
<a id="L2210" name="L2210"></a>2210                 <strong class="reserved">if</strong> (<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a>)) <em class="brace">{</em>
<a id="L2211" name="L2211"></a>2211                     <strong class="reserved">return</strong> i;  <em class="comment">// &gt;0 indicates a dup</em>
<a id="L2212" name="L2212"></a>2212                 <em class="brace">}</em>
<a id="L2213" name="L2213"></a>2213                 <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>.<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>(<a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a>);
<a id="L2214" name="L2214"></a>2214             <em class="brace">}</em>
<a id="L2215" name="L2215"></a>2215             <strong class="reserved">int</strong> zeroPos = <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>.nextClearBit(0);
<a id="L2216" name="L2216"></a>2216             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(zeroPos &lt;= newArity);
<a id="L2217" name="L2217"></a>2217             <strong class="reserved">if</strong> (zeroPos == newArity) <em class="brace">{</em>
<a id="L2218" name="L2218"></a>2218                 <strong class="reserved">return</strong> 0;
<a id="L2219" name="L2219"></a>2219             <em class="brace">}</em>
<a id="L2220" name="L2220"></a>2220             <strong class="reserved">return</strong> ~zeroPos;
<a id="L2221" name="L2221"></a>2221         <em class="brace">}</em>
<a id="L2222" name="L2222"></a>2222     <em class="brace">}</em>
<a id="L2223" name="L2223"></a>2223 
<a id="L2224" name="L2224"></a>2224     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/24727.html" title="Multiple referred from 2 places.">permuteArgumentChecks</a>(<strong class="reserved">int</strong>[] reorder, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType) <em class="brace">{</em>
<a id="L2225" name="L2225"></a>2225         <strong class="reserved">if</strong> (newType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != oldType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>())
<a id="L2226" name="L2226"></a>2226             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("return types do not match",
<a id="L2227" name="L2227"></a>2227                     oldType, newType);
<a id="L2228" name="L2228"></a>2228         <strong class="reserved">if</strong> (reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> == oldType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>()) <em class="brace">{</em>
<a id="L2229" name="L2229"></a>2229             <strong class="reserved">int</strong> <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a> = newType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2230" name="L2230"></a>2230             <strong class="reserved">boolean</strong> bad = <strong class="reserved">false</strong>;
<a id="L2231" name="L2231"></a>2231             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> j = 0; j &lt; reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; j++) <em class="brace">{</em>
<a id="L2232" name="L2232"></a>2232                 <strong class="reserved">int</strong> i = reorder[j];
<a id="L2233" name="L2233"></a>2233                 <strong class="reserved">if</strong> (i &lt; 0 || i &gt;= <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) <em class="brace">{</em>
<a id="L2234" name="L2234"></a>2234                     bad = <strong class="reserved">true</strong>; <strong class="reserved">break</strong>;
<a id="L2235" name="L2235"></a>2235                 <em class="brace">}</em>
<a id="L2236" name="L2236"></a>2236                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; src = newType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(i);
<a id="L2237" name="L2237"></a>2237                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; dst = oldType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(j);
<a id="L2238" name="L2238"></a>2238                 <strong class="reserved">if</strong> (src != dst)
<a id="L2239" name="L2239"></a>2239                     <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("parameter types do not match after reorder",
<a id="L2240" name="L2240"></a>2240                             oldType, newType);
<a id="L2241" name="L2241"></a>2241             <em class="brace">}</em>
<a id="L2242" name="L2242"></a>2242             <strong class="reserved">if</strong> (!bad)  <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2243" name="L2243"></a>2243         <em class="brace">}</em>
<a id="L2244" name="L2244"></a>2244         <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("bad reorder array: "+<a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(reorder));
<a id="L2245" name="L2245"></a>2245     <em class="brace">}</em>
<a id="L2246" name="L2246"></a>2246 
<div class="comment">
      Produces a method handle of the requested return type which returns the given
      constant value every time it is invoked.
      <p>
      Before the method handle is returned, the passed-in value is converted to the requested type.
      If the requested type is primitive, widening primitive conversions are attempted,
      else reference conversions are attempted.
      </p><p>The returned method handle is equivalent to <code>identity(type).bindTo(value)</code>.
      @param type the return type of the desired method handle
      @param value the value to return
      @return a method handle of the given return type and no arguments, which always returns the given value
      @throws NullPointerException if the <code>type</code> argument is null
      @throws ClassCastException if the value cannot be converted to the required return type
      @throws IllegalArgumentException if the given type is <code>void.class</code></p></div>
<a id="L2262" name="L2262"></a>2262     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2263" name="L2263"></a>2263     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/11916.html" title="Multiple referred from 68 places.">constant</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>) <em class="brace">{</em>
<a id="L2264" name="L2264"></a>2264         <strong class="reserved">if</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/26086.html" title="Multiple defined in 8 places.">isPrimitive</a>()) <em class="brace">{</em>
<a id="L2265" name="L2265"></a>2265             <strong class="reserved">if</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <strong class="reserved">void</strong>.<strong class="reserved">class</strong>)
<a id="L2266" name="L2266"></a>2266                 <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("void type");
<a id="L2267" name="L2267"></a>2267             <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a> w = <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.forPrimitiveType(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2268" name="L2268"></a>2268             <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = w.<a href="../D/13388.html" title="Multiple defined in 7 places.">convert</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2269" name="L2269"></a>2269             <strong class="reserved">if</strong> (w.<a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>))
<a id="L2270" name="L2270"></a>2270                 <strong class="reserved">return</strong> <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>(w, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2271" name="L2271"></a>2271             <strong class="reserved">return</strong> <a href="../S/1619.html#L2363" title="Defined at 2363 in src/java/lang/invoke/MethodHandles.java.">insertArguments</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>), 0, <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2272" name="L2272"></a>2272         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2273" name="L2273"></a>2273             <strong class="reserved">if</strong> (<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> == <strong class="reserved">null</strong>)
<a id="L2274" name="L2274"></a>2274                 <strong class="reserved">return</strong> <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>(<a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.OBJECT, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2275" name="L2275"></a>2275             <strong class="reserved">return</strong> <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>).<a href="../S/1623.html#L1275" title="Defined at 1275 in src/java/lang/invoke/MethodHandle.java.">bindTo</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2276" name="L2276"></a>2276         <em class="brace">}</em>
<a id="L2277" name="L2277"></a>2277     <em class="brace">}</em>
<a id="L2278" name="L2278"></a>2278 
<div class="comment">
      Produces a method handle which returns its sole argument when invoked.
      @param type the type of the sole parameter and return value of the desired method handle
      @return a unary method handle which accepts and returns the given type
      @throws NullPointerException if the argument is null
      @throws IllegalArgumentException if the given type is <code>void.class</code></div>
<a id="L2286" name="L2286"></a>2286     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2287" name="L2287"></a>2287     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/20368.html" title="Multiple referred from 354 places.">identity</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L2288" name="L2288"></a>2288         <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a> btw = (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/26086.html" title="Multiple defined in 8 places.">isPrimitive</a>() ? <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.forPrimitiveType(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) : <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.OBJECT);
<a id="L2289" name="L2289"></a>2289         <strong class="reserved">int</strong> pos = btw.<a href="../D/28579.html" title="Multiple defined in 2 places.">ordinal</a>();
<a id="L2290" name="L2290"></a>2290         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> ident = IDENTITY_MHS[pos];
<a id="L2291" name="L2291"></a>2291         <strong class="reserved">if</strong> (ident == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2292" name="L2292"></a>2292             ident = <a href="../D/32076.html" title="Multiple defined in 2 places.">setCachedMethodHandle</a>(IDENTITY_MHS, pos, <a href="../S/1619.html#L2301" title="Defined at 2301 in src/java/lang/invoke/MethodHandles.java.">makeIdentity</a>(btw.<a href="../S/3493.html#L58" title="Defined at 58 in src/javax/management/loading/MLetObjectInputStream.java.">primitiveType</a>()));
<a id="L2293" name="L2293"></a>2293         <em class="brace">}</em>
<a id="L2294" name="L2294"></a>2294         <strong class="reserved">if</strong> (ident.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>().<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L2295" name="L2295"></a>2295             <strong class="reserved">return</strong> ident;
<a id="L2296" name="L2296"></a>2296         <em class="comment">// something like identity(Foo.class); do not bother to intern these</em>
<a id="L2297" name="L2297"></a>2297         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(btw == <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.OBJECT);
<a id="L2298" name="L2298"></a>2298         <strong class="reserved">return</strong> <a href="../S/1619.html#L2301" title="Defined at 2301 in src/java/lang/invoke/MethodHandles.java.">makeIdentity</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2299" name="L2299"></a>2299     <em class="brace">}</em>
<a id="L2300" name="L2300"></a>2300     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] IDENTITY_MHS = <strong class="reserved">new</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[<a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.<a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>().<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L2301" name="L2301"></a>2301     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/22914.html" title="Multiple referred from 2 places.">makeIdentity</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype) <em class="brace">{</em>
<a id="L2302" name="L2302"></a>2302         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype = <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../D/27690.html" title="Multiple defined in 8 places.">methodType</a>(ptype, ptype);
<a id="L2303" name="L2303"></a>2303         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a>.<a href="../S/1626.html#L1706" title="Defined at 1706 in src/java/lang/invoke/LambdaForm.java.">identityForm</a>(<a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(ptype));
<a id="L2304" name="L2304"></a>2304         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/27315.html" title="Multiple defined in 2 places.">makeIntrinsic</a>(mtype, lform, <a href="../S/1634.html#L1313" title="Defined at 1313 in src/java/lang/invoke/MethodHandleImpl.java.">Intrinsic</a>.IDENTITY);
<a id="L2305" name="L2305"></a>2305     <em class="brace">}</em>
<a id="L2306" name="L2306"></a>2306 
<a id="L2307" name="L2307"></a>2307     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/30858.html" title="Multiple referred from 51 places.">zero</a>(<a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a> btw, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>) <em class="brace">{</em>
<a id="L2308" name="L2308"></a>2308         <strong class="reserved">int</strong> pos = btw.<a href="../D/28579.html" title="Multiple defined in 2 places.">ordinal</a>();
<a id="L2309" name="L2309"></a>2309         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a> = ZERO_MHS[pos];
<a id="L2310" name="L2310"></a>2310         <strong class="reserved">if</strong> (<a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2311" name="L2311"></a>2311             <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a> = <a href="../D/32076.html" title="Multiple defined in 2 places.">setCachedMethodHandle</a>(ZERO_MHS, pos, <a href="../S/1619.html#L2319" title="Defined at 2319 in src/java/lang/invoke/MethodHandles.java.">makeZero</a>(btw.<a href="../S/3493.html#L58" title="Defined at 58 in src/javax/management/loading/MLetObjectInputStream.java.">primitiveType</a>()));
<a id="L2312" name="L2312"></a>2312         <em class="brace">}</em>
<a id="L2313" name="L2313"></a>2313         <strong class="reserved">if</strong> (<a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>().<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() == <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>)
<a id="L2314" name="L2314"></a>2314             <strong class="reserved">return</strong> <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>;
<a id="L2315" name="L2315"></a>2315         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(btw == <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.OBJECT);
<a id="L2316" name="L2316"></a>2316         <strong class="reserved">return</strong> <a href="../S/1619.html#L2319" title="Defined at 2319 in src/java/lang/invoke/MethodHandles.java.">makeZero</a>(<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>);
<a id="L2317" name="L2317"></a>2317     <em class="brace">}</em>
<a id="L2318" name="L2318"></a>2318     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] ZERO_MHS = <strong class="reserved">new</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[<a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.<a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>().<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L2319" name="L2319"></a>2319     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/23027.html" title="Multiple referred from 2 places.">makeZero</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>) <em class="brace">{</em>
<a id="L2320" name="L2320"></a>2320         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype = <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../D/27690.html" title="Multiple defined in 8 places.">methodType</a>(<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>);
<a id="L2321" name="L2321"></a>2321         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a>.<a href="../S/1626.html#L1709" title="Defined at 1709 in src/java/lang/invoke/LambdaForm.java.">zeroForm</a>(<a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>));
<a id="L2322" name="L2322"></a>2322         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/27315.html" title="Multiple defined in 2 places.">makeIntrinsic</a>(mtype, lform, <a href="../S/1634.html#L1313" title="Defined at 1313 in src/java/lang/invoke/MethodHandleImpl.java.">Intrinsic</a>.ZERO);
<a id="L2323" name="L2323"></a>2323     <em class="brace">}</em>
<a id="L2324" name="L2324"></a>2324 
<a id="L2325" name="L2325"></a>2325     <strong class="reserved">synchronized</strong> <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/26991.html" title="Multiple referred from 6 places.">setCachedMethodHandle</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] <a href="../S/2005.html#L328" title="Defined at 328 in src/java/nio/charset/Charset.java.">cache</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>) <em class="brace">{</em>
<a id="L2326" name="L2326"></a>2326         <em class="comment">// Simulate a CAS, to avoid racy duplication of results.</em>
<a id="L2327" name="L2327"></a>2327         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> prev = <a href="../S/2005.html#L328" title="Defined at 328 in src/java/nio/charset/Charset.java.">cache</a>[pos];
<a id="L2328" name="L2328"></a>2328         <strong class="reserved">if</strong> (prev != <strong class="reserved">null</strong>) <strong class="reserved">return</strong> prev;
<a id="L2329" name="L2329"></a>2329         <strong class="reserved">return</strong> <a href="../S/2005.html#L328" title="Defined at 328 in src/java/nio/charset/Charset.java.">cache</a>[pos] = <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>;
<a id="L2330" name="L2330"></a>2330     <em class="brace">}</em>
<a id="L2331" name="L2331"></a>2331 
<div class="comment">
      Provides a target method handle with one or more <em>bound arguments</em>
      in advance of the method handle's invocation.
      The formal parameters to the target corresponding to the bound
      arguments are called <em>bound parameters</em>.
      Returns a new method handle which saves away the bound arguments.
      When it is invoked, it receives arguments for any non-bound parameters,
      binds the saved arguments to their corresponding parameters,
      and calls the original target.
      <p>
      The type of the new method handle will drop the types for the bound
      parameters from the original target type, since the new method handle
      will no longer require those arguments to be supplied by its callers.
      </p><p>
      Each given argument object must match the corresponding bound parameter type.
      If a bound parameter type is a primitive, the argument object
      must be a wrapper, and will be unboxed to produce the primitive value.
      </p><p>
      The <code>pos</code> argument selects which parameters are to be bound.
      It may range between zero and <i>N-L</i> (inclusively),
      where <i>N</i> is the arity of the target method handle
      and <i>L</i> is the length of the values array.
      @param target the method handle to invoke after the argument is inserted
      @param pos where to insert the argument (zero for the first)
      @param values the series of arguments to insert
      @return a method handle which inserts an additional argument,
              before calling the original method handle
      @throws NullPointerException if the target or the <code>values</code> array is null
      @see MethodHandle#bindTo</p></div>
<a id="L2362" name="L2362"></a>2362     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2363" name="L2363"></a>2363     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/20755.html" title="Multiple referred from 2 places.">insertArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>... <a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>) <em class="brace">{</em>
<a id="L2364" name="L2364"></a>2364         <strong class="reserved">int</strong> insCount = <a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L2365" name="L2365"></a>2365         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;[] <a href="../S/1616.html#L127" title="Defined at 127 in src/java/lang/invoke/MethodType.java.">ptypes</a> = <a href="../S/1619.html#L2395" title="Defined at 2395 in src/java/lang/invoke/MethodHandles.java.">insertArgumentsChecks</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, insCount, pos);
<a id="L2366" name="L2366"></a>2366         <strong class="reserved">if</strong> (insCount == 0)  <strong class="reserved">return</strong> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>;
<a id="L2367" name="L2367"></a>2367         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2368" name="L2368"></a>2368         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; insCount; i++) <em class="brace">{</em>
<a id="L2369" name="L2369"></a>2369             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = <a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>[i];
<a id="L2370" name="L2370"></a>2370             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype = <a href="../S/1616.html#L127" title="Defined at 127 in src/java/lang/invoke/MethodType.java.">ptypes</a>[pos+i];
<a id="L2371" name="L2371"></a>2371             <strong class="reserved">if</strong> (ptype.<a href="../D/26086.html" title="Multiple defined in 8 places.">isPrimitive</a>()) <em class="brace">{</em>
<a id="L2372" name="L2372"></a>2372                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/1619.html#L2381" title="Defined at 2381 in src/java/lang/invoke/MethodHandles.java.">insertArgumentPrimitive</a>(<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>, pos, ptype, <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2373" name="L2373"></a>2373             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2374" name="L2374"></a>2374                 <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = ptype.<a href="../D/12274.html" title="Multiple defined in 6 places.">cast</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);  <em class="comment">// throw CCE if needed</em>
<a id="L2375" name="L2375"></a>2375                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11851.html" title="Multiple defined in 3 places.">bindArgumentL</a>(pos, <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2376" name="L2376"></a>2376             <em class="brace">}</em>
<a id="L2377" name="L2377"></a>2377         <em class="brace">}</em>
<a id="L2378" name="L2378"></a>2378         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2379" name="L2379"></a>2379     <em class="brace">}</em>
<a id="L2380" name="L2380"></a>2380 
<a id="L2381" name="L2381"></a>2381     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../S/1619.html#L2372" title="Referred from 2372 in src/java/lang/invoke/MethodHandles.java.">insertArgumentPrimitive</a>(<a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>, <strong class="reserved">int</strong> pos,
<a id="L2382" name="L2382"></a>2382                                                              <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>) <em class="brace">{</em>
<a id="L2383" name="L2383"></a>2383         <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a> w = <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.forPrimitiveType(ptype);
<a id="L2384" name="L2384"></a>2384         <em class="comment">// perform unboxing and/or primitive conversion</em>
<a id="L2385" name="L2385"></a>2385         <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = w.<a href="../D/13388.html" title="Multiple defined in 7 places.">convert</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>, ptype);
<a id="L2386" name="L2386"></a>2386         <strong class="reserved">switch</strong> (w) <em class="brace">{</em>
<a id="L2387" name="L2387"></a>2387         <strong class="reserved">case</strong> INT:     <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11849.html" title="Multiple defined in 2 places.">bindArgumentI</a>(pos, (<strong class="reserved">int</strong>)<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2388" name="L2388"></a>2388         <strong class="reserved">case</strong> LONG:    <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11850.html" title="Multiple defined in 2 places.">bindArgumentJ</a>(pos, (<strong class="reserved">long</strong>)<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2389" name="L2389"></a>2389         <strong class="reserved">case</strong> <a href="../S/2603.html#L59" title="Defined at 59 in src/java/sql/JDBCType.java.">FLOAT</a>:   <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11847.html" title="Multiple defined in 2 places.">bindArgumentF</a>(pos, (<strong class="reserved">float</strong>)<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2390" name="L2390"></a>2390         <strong class="reserved">case</strong> <a href="../S/2603.html#L67" title="Defined at 67 in src/java/sql/JDBCType.java.">DOUBLE</a>:  <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11846.html" title="Multiple defined in 2 places.">bindArgumentD</a>(pos, (<strong class="reserved">double</strong>)<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2391" name="L2391"></a>2391         <strong class="reserved">default</strong>:      <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11849.html" title="Multiple defined in 2 places.">bindArgumentI</a>(pos, ValueConversions.widenSubword(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>));
<a id="L2392" name="L2392"></a>2392         <em class="brace">}</em>
<a id="L2393" name="L2393"></a>2393     <em class="brace">}</em>
<a id="L2394" name="L2394"></a>2394 
<a id="L2395" name="L2395"></a>2395     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;[] <a href="../S/1619.html#L2365" title="Referred from 2365 in src/java/lang/invoke/MethodHandles.java.">insertArgumentsChecks</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> insCount, <strong class="reserved">int</strong> pos) <strong class="reserved">throws</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <em class="brace">{</em>
<a id="L2396" name="L2396"></a>2396         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2397" name="L2397"></a>2397         <strong class="reserved">int</strong> outargs = oldType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2398" name="L2398"></a>2398         <strong class="reserved">int</strong> inargs  = outargs - insCount;
<a id="L2399" name="L2399"></a>2399         <strong class="reserved">if</strong> (inargs &lt; 0)
<a id="L2400" name="L2400"></a>2400             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("too many values to insert");
<a id="L2401" name="L2401"></a>2401         <strong class="reserved">if</strong> (pos &lt; 0 || pos &gt; inargs)
<a id="L2402" name="L2402"></a>2402             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("no argument type to append");
<a id="L2403" name="L2403"></a>2403         <strong class="reserved">return</strong> oldType.<a href="../S/1616.html#L127" title="Defined at 127 in src/java/lang/invoke/MethodType.java.">ptypes</a>();
<a id="L2404" name="L2404"></a>2404     <em class="brace">}</em>
<a id="L2405" name="L2405"></a>2405 
<div class="comment">
      Produces a method handle which will discard some dummy arguments
      before calling some other specified <i>target</i> method handle.
      The type of the new method handle will be the same as the target's type,
      except it will also include the dummy argument types,
      at some given position.
      <p>
      The <code>pos</code> argument may range between zero and <i>N</i>,
      where <i>N</i> is the arity of the target.
      If <code>pos</code> is zero, the dummy arguments will precede
      the target's real arguments; if <code>pos</code> is <i>N</i>
      they will come after.
      </p><p>
      <b>Example:</b>
      </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle cat = lookup().findVirtual(String.class,
  "concat", methodType(String.class, String.class));
assertEquals("xy", (String) cat.invokeExact("x", "y"));
MethodType bigType = cat.type().insertParameterTypes(0, int.class, String.class);
MethodHandle d0 = dropArguments(cat, 0, bigType.parameterList().subList(0,2));
assertEquals(bigType, d0.type());
assertEquals("yz", (String) d0.invokeExact(123, "x", "y", "z"));
      }</pre></blockquote>
      <p>
      This method is also equivalent to the following code:
      </p><blockquote><pre>      {@link #dropArguments(MethodHandle,int,Class...) dropArguments}<code>(target, pos, valueTypes.toArray(new Class[0]))</code>
      </pre></blockquote>
      @param target the method handle to invoke after the arguments are dropped
      @param valueTypes the type(s) of the argument(s) to drop
      @param pos position of first argument to drop (zero for the leftmost)
      @return a method handle which drops arguments of the given types,
              before calling the original method handle
      @throws NullPointerException if the target is null,
                                   or if the <code>valueTypes</code> list or any of its elements is null
      @throws IllegalArgumentException if any element of <code>valueTypes</code> is <code>void.class</code>,
                       or if <code>pos</code> is negative or greater than the arity of the target,
                       or if the new method handle's type would have too many parameters</div>
<a id="L2448" name="L2448"></a>2448     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2449" name="L2449"></a>2449     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/13584.html" title="Multiple referred from 4 places.">dropArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; valueTypes) <em class="brace">{</em>
<a id="L2450" name="L2450"></a>2450         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();  <em class="comment">// get NPE</em>
<a id="L2451" name="L2451"></a>2451         <strong class="reserved">int</strong> dropped = <a href="../S/1619.html#L2464" title="Defined at 2464 in src/java/lang/invoke/MethodHandles.java.">dropArgumentChecks</a>(oldType, pos, valueTypes);
<a id="L2452" name="L2452"></a>2452         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = oldType.<a href="../D/24768.html" title="Multiple defined in 2 places.">insertParameterTypes</a>(pos, valueTypes);
<a id="L2453" name="L2453"></a>2453         <strong class="reserved">if</strong> (dropped == 0)  <strong class="reserved">return</strong> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>;
<a id="L2454" name="L2454"></a>2454         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2455" name="L2455"></a>2455         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>;
<a id="L2456" name="L2456"></a>2456         <strong class="reserved">int</strong> insertFormArg = 1 + pos;
<a id="L2457" name="L2457"></a>2457         <strong class="reserved">for</strong> (<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype : valueTypes) <em class="brace">{</em>
<a id="L2458" name="L2458"></a>2458             lform = lform.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L483" title="Defined at 483 in src/java/lang/invoke/LambdaFormEditor.java.">addArgumentForm</a>(insertFormArg++, <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(ptype));
<a id="L2459" name="L2459"></a>2459         <em class="brace">}</em>
<a id="L2460" name="L2460"></a>2460         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13534.html" title="Multiple defined in 10 places.">copyWith</a>(newType, lform);
<a id="L2461" name="L2461"></a>2461         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2462" name="L2462"></a>2462     <em class="brace">}</em>
<a id="L2463" name="L2463"></a>2463 
<a id="L2464" name="L2464"></a>2464     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../S/1619.html#L2451" title="Referred from 2451 in src/java/lang/invoke/MethodHandles.java.">dropArgumentChecks</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType, <strong class="reserved">int</strong> pos, <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; valueTypes) <em class="brace">{</em>
<a id="L2465" name="L2465"></a>2465         <strong class="reserved">int</strong> dropped = valueTypes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L2466" name="L2466"></a>2466         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../S/1616.html#L181" title="Defined at 181 in src/java/lang/invoke/MethodType.java.">checkSlotCount</a>(dropped);
<a id="L2467" name="L2467"></a>2467         <strong class="reserved">int</strong> outargs = oldType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2468" name="L2468"></a>2468         <strong class="reserved">int</strong> inargs  = outargs + dropped;
<a id="L2469" name="L2469"></a>2469         <strong class="reserved">if</strong> (pos &lt; 0 || pos &gt; outargs)
<a id="L2470" name="L2470"></a>2470             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("no argument type to remove"
<a id="L2471" name="L2471"></a>2471                     + <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/11544.html" title="Multiple defined in 4 places.">asList</a>(oldType, pos, valueTypes, inargs, outargs)
<a id="L2472" name="L2472"></a>2472                     );
<a id="L2473" name="L2473"></a>2473         <strong class="reserved">return</strong> dropped;
<a id="L2474" name="L2474"></a>2474     <em class="brace">}</em>
<a id="L2475" name="L2475"></a>2475 
<div class="comment">
      Produces a method handle which will discard some dummy arguments
      before calling some other specified <i>target</i> method handle.
      The type of the new method handle will be the same as the target's type,
      except it will also include the dummy argument types,
      at some given position.
      <p>
      The <code>pos</code> argument may range between zero and <i>N</i>,
      where <i>N</i> is the arity of the target.
      If <code>pos</code> is zero, the dummy arguments will precede
      the target's real arguments; if <code>pos</code> is <i>N</i>
      they will come after.
      </p><p>
      <b>Example:</b>
      </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle cat = lookup().findVirtual(String.class,
  "concat", methodType(String.class, String.class));
assertEquals("xy", (String) cat.invokeExact("x", "y"));
MethodHandle d0 = dropArguments(cat, 0, String.class);
assertEquals("yz", (String) d0.invokeExact("x", "y", "z"));
MethodHandle d1 = dropArguments(cat, 1, String.class);
assertEquals("xz", (String) d1.invokeExact("x", "y", "z"));
MethodHandle d2 = dropArguments(cat, 2, String.class);
assertEquals("xy", (String) d2.invokeExact("x", "y", "z"));
MethodHandle d12 = dropArguments(cat, 1, int.class, boolean.class);
assertEquals("xz", (String) d12.invokeExact("x", 12, true, "z"));
      }</pre></blockquote>
      <p>
      This method is also equivalent to the following code:
      </p><blockquote><pre>      {@link #dropArguments(MethodHandle,int,List) dropArguments}<code>(target, pos, Arrays.asList(valueTypes))</code>
      </pre></blockquote>
      @param target the method handle to invoke after the arguments are dropped
      @param valueTypes the type(s) of the argument(s) to drop
      @param pos position of first argument to drop (zero for the leftmost)
      @return a method handle which drops arguments of the given types,
              before calling the original method handle
      @throws NullPointerException if the target is null,
                                   or if the <code>valueTypes</code> array or any of its elements is null
      @throws IllegalArgumentException if any element of <code>valueTypes</code> is <code>void.class</code>,
                       or if <code>pos</code> is negative or greater than the arity of the target,
                       or if the new method handle's type would have
                       <a href="MethodHandle.html#maxarity">too many parameters</a></div>
<a id="L2523" name="L2523"></a>2523     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2524" name="L2524"></a>2524     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/13584.html" title="Multiple referred from 4 places.">dropArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;... valueTypes) <em class="brace">{</em>
<a id="L2525" name="L2525"></a>2525         <strong class="reserved">return</strong> <a href="../D/15233.html" title="Multiple defined in 2 places.">dropArguments</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, pos, <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/11544.html" title="Multiple defined in 4 places.">asList</a>(valueTypes));
<a id="L2526" name="L2526"></a>2526     <em class="brace">}</em>
<a id="L2527" name="L2527"></a>2527 
<div class="comment">
      Adapts a target method handle by pre-processing
      one or more of its arguments, each with its own unary filter function,
      and then calling the target with each pre-processed argument
      replaced by the result of its corresponding filter function.
      <p>
      The pre-processing is performed by one or more method handles,
      specified in the elements of the <code>filters</code> array.
      The first element of the filter array corresponds to the <code>pos</code>
      argument of the target, and so on in sequence.
      </p><p>
      Null arguments in the array are treated as identity functions,
      and the corresponding arguments left unchanged.
      (If there are no non-null elements in the array, the original target is returned.)
      Each filter is applied to the corresponding argument of the adapter.
      </p><p>
      If a filter <code>F</code> applies to the <code>N</code>th argument of
      the target, then <code>F</code> must be a method handle which
      takes exactly one argument.  The type of <code>F</code>'s sole argument
      replaces the corresponding argument type of the target
      in the resulting adapted method handle.
      The return type of <code>F</code> must be identical to the corresponding
      parameter type of the target.
      </p><p>
      It is an error if there are elements of <code>filters</code>
      (null or not)
      which do not correspond to argument positions in the target.
      </p><p><b>Example:</b>
      </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle cat = lookup().findVirtual(String.class,
  "concat", methodType(String.class, String.class));
MethodHandle upcase = lookup().findVirtual(String.class,
  "toUpperCase", methodType(String.class));
assertEquals("xy", (String) cat.invokeExact("x", "y"));
MethodHandle f0 = filterArguments(cat, 0, upcase);
assertEquals("Xy", (String) f0.invokeExact("x", "y")); // Xy
MethodHandle f1 = filterArguments(cat, 1, upcase);
assertEquals("xY", (String) f1.invokeExact("x", "y")); // xY
MethodHandle f2 = filterArguments(cat, 0, upcase, upcase);
assertEquals("XY", (String) f2.invokeExact("x", "y")); // XY
      }</pre></blockquote>
      <p> Here is pseudocode for the resulting adapter:
      </p><blockquote><pre>{@code
      V target(P... p, A[i]... a[i], B... b);
      A[i] filter[i](V[i]);
      T adapter(P... p, V[i]... v[i], B... b) {
        return target(p..., f[i](v[i])..., b...);
      }
      }</pre></blockquote>
      @param target the method handle to invoke after arguments are filtered
      @param pos the position of the first argument to filter
      @param filters method handles to call initially on filtered arguments
      @return method handle which incorporates the specified argument filtering logic
      @throws NullPointerException if the target is null
                                   or if the <code>filters</code> array is null
      @throws IllegalArgumentException if a non-null element of <code>filters</code>
               does not match a corresponding argument type of target as described above,
               or if the <code>pos+filters.length</code> is greater than <code>target.type().parameterCount()</code>,
               or if the resulting method handle's type would have
               <a href="MethodHandle.html#maxarity">too many parameters</a></div>
<a id="L2593" name="L2593"></a>2593     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2594" name="L2594"></a>2594     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> filterArguments(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>... filters) <em class="brace">{</em>
<a id="L2595" name="L2595"></a>2595         <a href="../S/1619.html#L2619" title="Defined at 2619 in src/java/lang/invoke/MethodHandles.java.">filterArgumentsCheckArity</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, pos, filters);
<a id="L2596" name="L2596"></a>2596         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> adapter = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>;
<a id="L2597" name="L2597"></a>2597         <strong class="reserved">int</strong> curPos = pos-1;  <em class="comment">// pre-incremented</em>
<a id="L2598" name="L2598"></a>2598         <strong class="reserved">for</strong> (<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a> : filters) <em class="brace">{</em>
<a id="L2599" name="L2599"></a>2599             curPos += 1;
<a id="L2600" name="L2600"></a>2600             <strong class="reserved">if</strong> (<a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a> == <strong class="reserved">null</strong>)  <strong class="reserved">continue</strong>;  <em class="comment">// ignore null elements of filters</em>
<a id="L2601" name="L2601"></a>2601             adapter = <a href="../S/1619.html#L2607" title="Defined at 2607 in src/java/lang/invoke/MethodHandles.java.">filterArgument</a>(adapter, curPos, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2602" name="L2602"></a>2602         <em class="brace">}</em>
<a id="L2603" name="L2603"></a>2603         <strong class="reserved">return</strong> adapter;
<a id="L2604" name="L2604"></a>2604     <em class="brace">}</em>
<a id="L2605" name="L2605"></a>2605 
<div class="comment">
     /*non-public*/</div> <strong class="reserved">static</strong>
<a id="L2607" name="L2607"></a>2607     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14323.html" title="Multiple referred from 2 places.">filterArgument</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <em class="brace">{</em>
<a id="L2608" name="L2608"></a>2608         <a href="../S/1619.html#L2626" title="Defined at 2626 in src/java/lang/invoke/MethodHandles.java.">filterArgumentChecks</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, pos, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2609" name="L2609"></a>2609         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2610" name="L2610"></a>2610         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2611" name="L2611"></a>2611         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2612" name="L2612"></a>2612         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; newParamType = filterType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0);
<a id="L2613" name="L2613"></a>2613         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L633" title="Defined at 633 in src/java/lang/invoke/LambdaFormEditor.java.">filterArgumentForm</a>(1 + pos, <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(newParamType));
<a id="L2614" name="L2614"></a>2614         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = targetType.<a href="../S/1616.html#L369" title="Defined at 369 in src/java/lang/invoke/MethodType.java.">changeParameterType</a>(pos, newParamType);
<a id="L2615" name="L2615"></a>2615         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13539.html" title="Multiple defined in 3 places.">copyWithExtendL</a>(newType, lform, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2616" name="L2616"></a>2616         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2617" name="L2617"></a>2617     <em class="brace">}</em>
<a id="L2618" name="L2618"></a>2618 
<a id="L2619" name="L2619"></a>2619     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/1619.html#L2595" title="Referred from 2595 in src/java/lang/invoke/MethodHandles.java.">filterArgumentsCheckArity</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] filters) <em class="brace">{</em>
<a id="L2620" name="L2620"></a>2620         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2621" name="L2621"></a>2621         <strong class="reserved">int</strong> maxPos = targetType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2622" name="L2622"></a>2622         <strong class="reserved">if</strong> (pos + filters.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; maxPos)
<a id="L2623" name="L2623"></a>2623             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("too many filters");
<a id="L2624" name="L2624"></a>2624     <em class="brace">}</em>
<a id="L2625" name="L2625"></a>2625 
<a id="L2626" name="L2626"></a>2626     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/1619.html#L2608" title="Referred from 2608 in src/java/lang/invoke/MethodHandles.java.">filterArgumentChecks</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <strong class="reserved">throws</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <em class="brace">{</em>
<a id="L2627" name="L2627"></a>2627         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2628" name="L2628"></a>2628         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2629" name="L2629"></a>2629         <strong class="reserved">if</strong> (filterType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() != 1
<a id="L2630" name="L2630"></a>2630             || filterType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != targetType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(pos))
<a id="L2631" name="L2631"></a>2631             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("target and filter types do not match", targetType, filterType);
<a id="L2632" name="L2632"></a>2632     <em class="brace">}</em>
<a id="L2633" name="L2633"></a>2633 
<div class="comment">
      Adapts a target method handle by pre-processing
      a sub-sequence of its arguments with a filter (another method handle).
      The pre-processed arguments are replaced by the result (if any) of the
      filter function.
      The target is then called on the modified (usually shortened) argument list.
      <p>
      If the filter returns a value, the target must accept that value as
      its argument in position <code>pos</code>, preceded and/or followed by
      any arguments not passed to the filter.
      If the filter returns void, the target must accept all arguments
      not passed to the filter.
      No arguments are reordered, and a result returned from the filter
      replaces (in order) the whole subsequence of arguments originally
      passed to the adapter.
      </p><p>
      The argument types (if any) of the filter
      replace zero or one argument types of the target, at position <code>pos</code>,
      in the resulting adapted method handle.
      The return type of the filter (if any) must be identical to the
      argument type of the target at position <code>pos</code>, and that target argument
      is supplied by the return value of the filter.
      </p><p>
      In all cases, <code>pos</code> must be greater than or equal to zero, and
      <code>pos</code> must also be less than or equal to the target's arity.
      </p><p><b>Example:</b>
      </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle deepToString = publicLookup()
  .findStatic(Arrays.class, "deepToString", methodType(String.class, Object[].class));
MethodHandle ts1 = deepToString.asCollector(String[].class, 1);
assertEquals("[strange]", (String) ts1.invokeExact("strange"));
MethodHandle ts2 = deepToString.asCollector(String[].class, 2);
assertEquals("[up, down]", (String) ts2.invokeExact("up", "down"));
MethodHandle ts3 = deepToString.asCollector(String[].class, 3);
MethodHandle ts3_ts2 = collectArguments(ts3, 1, ts2);
assertEquals("[top, [up, down], strange]",
             (String) ts3_ts2.invokeExact("top", "up", "down", "strange"));
MethodHandle ts3_ts2_ts1 = collectArguments(ts3_ts2, 3, ts1);
assertEquals("[top, [up, down], [strange]]",
             (String) ts3_ts2_ts1.invokeExact("top", "up", "down", "strange"));
MethodHandle ts3_ts2_ts3 = collectArguments(ts3_ts2, 1, ts3);
assertEquals("[top, [[up, down, strange], charm], bottom]",
             (String) ts3_ts2_ts3.invokeExact("top", "up", "down", "strange", "charm", "bottom"));
      }</pre></blockquote>
      <p> Here is pseudocode for the resulting adapter:
      </p><blockquote><pre>{@code
      T target(A...,V,C...);
      V filter(B...);
      T adapter(A... a,B... b,C... c) {
        V v = filter(b...);
        return target(a...,v,c...);
      }
      // and if the filter has no arguments:
      T target2(A...,V,C...);
      V filter2();
      T adapter2(A... a,C... c) {
        V v = filter2();
        return target2(a...,v,c...);
      }
      // and if the filter has a void return:
      T target3(A...,C...);
      void filter3(B...);
      void adapter3(A... a,B... b,C... c) {
        filter3(b...);
        return target3(a...,c...);
      }
      }</pre></blockquote>
      <p>
      A collection adapter <code>collectArguments(mh, 0, coll)</code> is equivalent to
      one which first "folds" the affected arguments, and then drops them, in separate
      steps as follows:
      </p><blockquote><pre>{@code
      mh = MethodHandles.dropArguments(mh, 1, coll.type().parameterList()); //step 2
      mh = MethodHandles.foldArguments(mh, coll); //step 1
      }</pre></blockquote>
      If the target method handle consumes no arguments besides than the result
      (if any) of the filter <code>coll</code>, then <code>collectArguments(mh, 0, coll)</code>
      is equivalent to <code>filterReturnValue(coll, mh)</code>.
      If the filter method handle <code>coll</code> consumes one argument and produces
      a non-void result, then <code>collectArguments(mh, N, coll)</code>
      is equivalent to <code>filterArguments(mh, N, coll)</code>.
      Other equivalences are possible but would require argument permutation.
      @param target the method handle to invoke after filtering the subsequence of arguments
      @param pos the position of the first adapter argument to pass to the filter,
                 and/or the target argument which receives the result of the filter
      @param filter method handle to call on the subsequence of arguments
      @return method handle which incorporates the specified argument subsequence filtering logic
      @throws NullPointerException if either argument is null
      @throws IllegalArgumentException if the return type of <code>filter</code>
               is non-void and is not the same as the <code>pos</code> argument of the target,
               or if <code>pos</code> is not between 0 and the target's arity, inclusive,
               or if the resulting method handle's type would have
               <a href="MethodHandle.html#maxarity">too many parameters</a>
      @see MethodHandles#foldArguments
      @see MethodHandles#filterArguments
      @see MethodHandles#filterReturnValue</div>
<a id="L2740" name="L2740"></a>2740     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2741" name="L2741"></a>2741     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/11640.html" title="Multiple referred from 3 places.">collectArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <em class="brace">{</em>
<a id="L2742" name="L2742"></a>2742         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = <a href="../S/1619.html#L2756" title="Defined at 2756 in src/java/lang/invoke/MethodHandles.java.">collectArgumentsChecks</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, pos, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2743" name="L2743"></a>2743         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> collectorType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2744" name="L2744"></a>2744         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2745" name="L2745"></a>2745         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform;
<a id="L2746" name="L2746"></a>2746         <strong class="reserved">if</strong> (collectorType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>().<a href="../D/25208.html" title="Multiple defined in 5 places.">isArray</a>() &amp;&amp; <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/24987.html" title="Multiple defined in 3 places.">intrinsicName</a>() == <a href="../S/1634.html#L1313" title="Defined at 1313 in src/java/lang/invoke/MethodHandleImpl.java.">Intrinsic</a>.<a href="../S/6524.html#L198" title="Defined at 198 in src/com/sun/source/tree/Tree.java.">NEW_ARRAY</a>) <em class="brace">{</em>
<a id="L2747" name="L2747"></a>2747             lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L583" title="Defined at 583 in src/java/lang/invoke/LambdaFormEditor.java.">collectArgumentArrayForm</a>(1 + pos, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2748" name="L2748"></a>2748             <strong class="reserved">if</strong> (lform != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2749" name="L2749"></a>2749                 <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13534.html" title="Multiple defined in 10 places.">copyWith</a>(newType, lform);
<a id="L2750" name="L2750"></a>2750             <em class="brace">}</em>
<a id="L2751" name="L2751"></a>2751         <em class="brace">}</em>
<a id="L2752" name="L2752"></a>2752         lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L562" title="Defined at 562 in src/java/lang/invoke/LambdaFormEditor.java.">collectArgumentsForm</a>(1 + pos, collectorType.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>());
<a id="L2753" name="L2753"></a>2753         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13539.html" title="Multiple defined in 3 places.">copyWithExtendL</a>(newType, lform, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2754" name="L2754"></a>2754     <em class="brace">}</em>
<a id="L2755" name="L2755"></a>2755 
<a id="L2756" name="L2756"></a>2756     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../S/1619.html#L2742" title="Referred from 2742 in src/java/lang/invoke/MethodHandles.java.">collectArgumentsChecks</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <strong class="reserved">throws</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <em class="brace">{</em>
<a id="L2757" name="L2757"></a>2757         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2758" name="L2758"></a>2758         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2759" name="L2759"></a>2759         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = filterType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>();
<a id="L2760" name="L2760"></a>2760         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; <a href="../S/1.html#L1411" title="Defined at 1411 in src/launcher/java_md.c.">filterArgs</a> = filterType.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L2761" name="L2761"></a>2761         <strong class="reserved">if</strong> (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> == <strong class="reserved">void</strong>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L2762" name="L2762"></a>2762             <strong class="reserved">return</strong> targetType.<a href="../D/24768.html" title="Multiple defined in 2 places.">insertParameterTypes</a>(pos, <a href="../S/1.html#L1411" title="Defined at 1411 in src/launcher/java_md.c.">filterArgs</a>);
<a id="L2763" name="L2763"></a>2763         <em class="brace">}</em>
<a id="L2764" name="L2764"></a>2764         <strong class="reserved">if</strong> (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> != targetType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(pos)) <em class="brace">{</em>
<a id="L2765" name="L2765"></a>2765             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("target and filter types do not match", targetType, filterType);
<a id="L2766" name="L2766"></a>2766         <em class="brace">}</em>
<a id="L2767" name="L2767"></a>2767         <strong class="reserved">return</strong> targetType.<a href="../S/1616.html#L548" title="Defined at 548 in src/java/lang/invoke/MethodType.java.">dropParameterTypes</a>(pos, pos+1).<a href="../D/24768.html" title="Multiple defined in 2 places.">insertParameterTypes</a>(pos, <a href="../S/1.html#L1411" title="Defined at 1411 in src/launcher/java_md.c.">filterArgs</a>);
<a id="L2768" name="L2768"></a>2768     <em class="brace">}</em>
<a id="L2769" name="L2769"></a>2769 
<div class="comment">
      Adapts a target method handle by post-processing
      its return value (if any) with a filter (another method handle).
      The result of the filter is returned from the adapter.
      <p>
      If the target returns a value, the filter must accept that value as
      its only argument.
      If the target returns void, the filter must accept no arguments.
      </p><p>
      The return type of the filter
      replaces the return type of the target
      in the resulting adapted method handle.
      The argument type of the filter (if any) must be identical to the
      return type of the target.
      </p><p><b>Example:</b>
      </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle cat = lookup().findVirtual(String.class,
  "concat", methodType(String.class, String.class));
MethodHandle length = lookup().findVirtual(String.class,
  "length", methodType(int.class));
System.out.println((String) cat.invokeExact("x", "y")); // xy
MethodHandle f0 = filterReturnValue(cat, length);
System.out.println((int) f0.invokeExact("x", "y")); // 2
      }</pre></blockquote>
      <p> Here is pseudocode for the resulting adapter:
      </p><blockquote><pre>{@code
      V target(A...);
      T filter(V);
      T adapter(A... a) {
        V v = target(a...);
        return filter(v);
      }
      // and if the target has a void return:
      void target2(A...);
      T filter2();
      T adapter2(A... a) {
        target2(a...);
        return filter2();
      }
      // and if the filter has a void return:
      V target3(A...);
      void filter3(V);
      void adapter3(A... a) {
        V v = target3(a...);
        filter3(v);
      }
      }</pre></blockquote>
      @param target the method handle to invoke before filtering the return value
      @param filter method handle to call on the return value
      @return method handle which incorporates the specified return value filtering logic
      @throws NullPointerException if either argument is null
      @throws IllegalArgumentException if the argument list of <code>filter</code>
               does not match the return type of target as described above</div>
<a id="L2827" name="L2827"></a>2827     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2828" name="L2828"></a>2828     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> filterReturnValue(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <em class="brace">{</em>
<a id="L2829" name="L2829"></a>2829         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2830" name="L2830"></a>2830         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2831" name="L2831"></a>2831         <a href="../S/1619.html#L2840" title="Defined at 2840 in src/java/lang/invoke/MethodHandles.java.">filterReturnValueChecks</a>(targetType, filterType);
<a id="L2832" name="L2832"></a>2832         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2833" name="L2833"></a>2833         <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a> <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(filterType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>());
<a id="L2834" name="L2834"></a>2834         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L710" title="Defined at 710 in src/java/lang/invoke/LambdaFormEditor.java.">filterReturnForm</a>(<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>, <strong class="reserved">false</strong>);
<a id="L2835" name="L2835"></a>2835         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = targetType.<a href="../S/1616.html#L582" title="Defined at 582 in src/java/lang/invoke/MethodType.java.">changeReturnType</a>(filterType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>());
<a id="L2836" name="L2836"></a>2836         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13539.html" title="Multiple defined in 3 places.">copyWithExtendL</a>(newType, lform, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2837" name="L2837"></a>2837         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2838" name="L2838"></a>2838     <em class="brace">}</em>
<a id="L2839" name="L2839"></a>2839 
<a id="L2840" name="L2840"></a>2840     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/1619.html#L2831" title="Referred from 2831 in src/java/lang/invoke/MethodHandles.java.">filterReturnValueChecks</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType) <strong class="reserved">throws</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <em class="brace">{</em>
<a id="L2841" name="L2841"></a>2841         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = targetType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>();
<a id="L2842" name="L2842"></a>2842         <strong class="reserved">int</strong> filterValues = filterType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2843" name="L2843"></a>2843         <strong class="reserved">if</strong> (filterValues == 0
<a id="L2844" name="L2844"></a>2844                 ? (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> != <strong class="reserved">void</strong>.<strong class="reserved">class</strong>)
<a id="L2845" name="L2845"></a>2845                 : (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> != filterType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0)))
<a id="L2846" name="L2846"></a>2846             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("target and filter types do not match", targetType, filterType);
<a id="L2847" name="L2847"></a>2847     <em class="brace">}</em>
<a id="L2848" name="L2848"></a>2848 
<div class="comment">
      Adapts a target method handle by pre-processing
      some of its arguments, and then calling the target with
      the result of the pre-processing, inserted into the original
      sequence of arguments.
      <p>
      The pre-processing is performed by <code>combiner</code>, a second method handle.
      Of the arguments passed to the adapter, the first <code>N</code> arguments
      are copied to the combiner, which is then called.
      (Here, <code>N</code> is defined as the parameter count of the combiner.)
      After this, control passes to the target, with any result
      from the combiner inserted before the original <code>N</code> incoming
      arguments.
      </p><p>
      If the combiner returns a value, the first parameter type of the target
      must be identical with the return type of the combiner, and the next
      <code>N</code> parameter types of the target must exactly match the parameters
      of the combiner.
      </p><p>
      If the combiner has a void return, no result will be inserted,
      and the first <code>N</code> parameter types of the target
      must exactly match the parameters of the combiner.
      </p><p>
      The resulting adapter is the same type as the target, except that the
      first parameter type is dropped,
      if it corresponds to the result of the combiner.
      </p><p>
      (Note that {@link #dropArguments(MethodHandle,int,List) dropArguments} can be used to remove any arguments
      that either the combiner or the target does not wish to receive.
      If some of the incoming arguments are destined only for the combiner,
      consider using {@link MethodHandle#asCollector asCollector} instead, since those
      arguments will not need to be live on the stack on entry to the
      target.)
      </p><p><b>Example:</b>
      </p><blockquote><pre>{@code
import static java.lang.invoke.MethodHandles.*;
import static java.lang.invoke.MethodType.*;
...
MethodHandle trace = publicLookup().findVirtual(java.io.PrintStream.class,
  "println", methodType(void.class, String.class))
    .bindTo(System.out);
MethodHandle cat = lookup().findVirtual(String.class,
  "concat", methodType(String.class, String.class));
assertEquals("boojum", (String) cat.invokeExact("boo", "jum"));
MethodHandle catTrace = foldArguments(cat, trace);
// also prints "boo":
assertEquals("boojum", (String) catTrace.invokeExact("boo", "jum"));
      }</pre></blockquote>
      <p> Here is pseudocode for the resulting adapter:
      </p><blockquote><pre>{@code
      // there are N arguments in A...
      T target(V, A[N]..., B...);
      V combiner(A...);
      T adapter(A... a, B... b) {
        V v = combiner(a...);
        return target(v, a..., b...);
      }
      // and if the combiner has a void return:
      T target2(A[N]..., B...);
      void combiner2(A...);
      T adapter2(A... a, B... b) {
        combiner2(a...);
        return target2(a..., b...);
      }
      }</pre></blockquote>
      @param target the method handle to invoke after arguments are combined
      @param combiner method handle to call initially on the incoming arguments
      @return method handle which incorporates the specified argument folding logic
      @throws NullPointerException if either argument is null
      @throws IllegalArgumentException if <code>combiner</code>'s return type
               is non-void and not the same as the first argument type of
               the target, or if the initial <code>N</code> argument types
               of the target
               (skipping one matching the <code>combiner</code>'s return type)
               are not identical with the argument types of <code>combiner</code></div>
<a id="L2925" name="L2925"></a>2925     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2926" name="L2926"></a>2926     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1601.html#L216" title="Referred from 216 in src/java/lang/invoke/CallSite.java.">foldArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>) <em class="brace">{</em>
<a id="L2927" name="L2927"></a>2927         <strong class="reserved">int</strong> foldPos = 0;
<a id="L2928" name="L2928"></a>2928         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2929" name="L2929"></a>2929         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> combinerType = <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2930" name="L2930"></a>2930         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = <a href="../S/1619.html#L2942" title="Defined at 2942 in src/java/lang/invoke/MethodHandles.java.">foldArgumentChecks</a>(foldPos, targetType, combinerType);
<a id="L2931" name="L2931"></a>2931         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2932" name="L2932"></a>2932         <strong class="reserved">boolean</strong> dropResult = (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> == <strong class="reserved">void</strong>.<strong class="reserved">class</strong>);
<a id="L2933" name="L2933"></a>2933         <em class="comment">// Note:  This may cache too many distinct LFs. Consider backing off to varargs code.</em>
<a id="L2934" name="L2934"></a>2934         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L761" title="Defined at 761 in src/java/lang/invoke/LambdaFormEditor.java.">foldArgumentsForm</a>(1 + foldPos, dropResult, combinerType.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>());
<a id="L2935" name="L2935"></a>2935         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = targetType;
<a id="L2936" name="L2936"></a>2936         <strong class="reserved">if</strong> (!dropResult)
<a id="L2937" name="L2937"></a>2937             newType = newType.<a href="../S/1616.html#L548" title="Defined at 548 in src/java/lang/invoke/MethodType.java.">dropParameterTypes</a>(foldPos, foldPos + 1);
<a id="L2938" name="L2938"></a>2938         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13539.html" title="Multiple defined in 3 places.">copyWithExtendL</a>(newType, lform, <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>);
<a id="L2939" name="L2939"></a>2939         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2940" name="L2940"></a>2940     <em class="brace">}</em>
<a id="L2941" name="L2941"></a>2941 
<a id="L2942" name="L2942"></a>2942     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1619.html#L2930" title="Referred from 2930 in src/java/lang/invoke/MethodHandles.java.">foldArgumentChecks</a>(<strong class="reserved">int</strong> foldPos, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> combinerType) <em class="brace">{</em>
<a id="L2943" name="L2943"></a>2943         <strong class="reserved">int</strong> foldArgs   = combinerType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2944" name="L2944"></a>2944         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = combinerType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>();
<a id="L2945" name="L2945"></a>2945         <strong class="reserved">int</strong> foldVals = <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> == <strong class="reserved">void</strong>.<strong class="reserved">class</strong> ? 0 : 1;
<a id="L2946" name="L2946"></a>2946         <strong class="reserved">int</strong> afterInsertPos = foldPos + foldVals;
<a id="L2947" name="L2947"></a>2947         <strong class="reserved">boolean</strong> ok = (targetType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() &gt;= afterInsertPos + foldArgs);
<a id="L2948" name="L2948"></a>2948         <strong class="reserved">if</strong> (ok &amp;&amp; !(combinerType.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>()
<a id="L2949" name="L2949"></a>2949                     .<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(targetType.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>().<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(afterInsertPos,
<a id="L2950" name="L2950"></a>2950                                                                afterInsertPos + foldArgs))))
<a id="L2951" name="L2951"></a>2951             ok = <strong class="reserved">false</strong>;
<a id="L2952" name="L2952"></a>2952         <strong class="reserved">if</strong> (ok &amp;&amp; foldVals != 0 &amp;&amp; combinerType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != targetType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0))
<a id="L2953" name="L2953"></a>2953             ok = <strong class="reserved">false</strong>;
<a id="L2954" name="L2954"></a>2954         <strong class="reserved">if</strong> (!ok)
<a id="L2955" name="L2955"></a>2955             <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and combiner types", targetType, combinerType);
<a id="L2956" name="L2956"></a>2956         <strong class="reserved">return</strong> <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>;
<a id="L2957" name="L2957"></a>2957     <em class="brace">}</em>
<a id="L2958" name="L2958"></a>2958 
<div class="comment">
      Makes a method handle which adapts a target method handle,
      by guarding it with a test, a boolean-valued method handle.
      If the guard fails, a fallback handle is called instead.
      All three method handles must have the same corresponding
      argument and return types, except that the return type
      of the test must be boolean, and the test is allowed
      to have fewer arguments than the other two method handles.
      <p> Here is pseudocode for the resulting adapter:
      </p><blockquote><pre>{@code
      boolean test(A...);
      T target(A...,B...);
      T fallback(A...,B...);
      T adapter(A... a,B... b) {
        if (test(a...))
          return target(a..., b...);
        else
          return fallback(a..., b...);
      }
      }</pre></blockquote>
      Note that the test arguments (<code>a...</code> in the pseudocode) cannot
      be modified by execution of the test, and so are passed unchanged
      from the caller to the target or fallback as appropriate.
      @param test method handle used for test, must return boolean
      @param target method handle to call if test passes
      @param fallback method handle to call if test fails
      @return method handle which incorporates the specified if/then/else logic
      @throws NullPointerException if any argument is null
      @throws IllegalArgumentException if <code>test</code> does not return boolean,
               or if all three method types do not match (with the return
               type of <code>test</code> changed to match that of the target).</div>
<a id="L2991" name="L2991"></a>2991     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2992" name="L2992"></a>2992     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1622.html#L173" title="Referred from 173 in src/java/lang/invoke/SwitchPoint.java.">guardWithTest</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>,
<a id="L2993" name="L2993"></a>2993                                <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>,
<a id="L2994" name="L2994"></a>2994                                <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> fallback) <em class="brace">{</em>
<a id="L2995" name="L2995"></a>2995         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> gtype = <a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2996" name="L2996"></a>2996         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> ttype = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2997" name="L2997"></a>2997         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> ftype = fallback.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2998" name="L2998"></a>2998         <strong class="reserved">if</strong> (!ttype.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(ftype))
<a id="L2999" name="L2999"></a>2999             <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and fallback types", ttype, ftype);
<a id="L3000" name="L3000"></a>3000         <strong class="reserved">if</strong> (gtype.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != <strong class="reserved">boolean</strong>.<strong class="reserved">class</strong>)
<a id="L3001" name="L3001"></a>3001             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("guard type is not a predicate "+gtype);
<a id="L3002" name="L3002"></a>3002         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; targs = ttype.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L3003" name="L3003"></a>3003         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; gargs = gtype.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L3004" name="L3004"></a>3004         <strong class="reserved">if</strong> (!targs.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(gargs)) <em class="brace">{</em>
<a id="L3005" name="L3005"></a>3005             <strong class="reserved">int</strong> gpc = gargs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>(), tpc = targs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L3006" name="L3006"></a>3006             <strong class="reserved">if</strong> (gpc &gt;= tpc || !targs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(0, gpc).<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(gargs))
<a id="L3007" name="L3007"></a>3007                 <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and test types", ttype, gtype);
<a id="L3008" name="L3008"></a>3008             <a href="../D/35234.html" title="Multiple defined in 11 places.">test</a> = <a href="../D/15233.html" title="Multiple defined in 2 places.">dropArguments</a>(<a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>, gpc, targs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(gpc, tpc));
<a id="L3009" name="L3009"></a>3009             gtype = <a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L3010" name="L3010"></a>3010         <em class="brace">}</em>
<a id="L3011" name="L3011"></a>3011         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L726" title="Defined at 726 in src/java/lang/invoke/MethodHandleImpl.java.">makeGuardWithTest</a>(<a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>, <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, fallback);
<a id="L3012" name="L3012"></a>3012     <em class="brace">}</em>
<a id="L3013" name="L3013"></a>3013 
<a id="L3014" name="L3014"></a>3014     <strong class="reserved">static</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <a href="../R/23307.html" title="Multiple referred from 5 places.">misMatchedTypes</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> what, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> t1, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> t2) <em class="brace">{</em>
<a id="L3015" name="L3015"></a>3015         <strong class="reserved">return</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>(what + " must match: " + t1 + " != " + t2);
<a id="L3016" name="L3016"></a>3016     <em class="brace">}</em>
<a id="L3017" name="L3017"></a>3017 
<div class="comment">
      Makes a method handle which adapts a target method handle,
      by running it inside an exception handler.
      If the target returns normally, the adapter returns that value.
      If an exception matching the specified type is thrown, the fallback
      handle is called instead on the exception, plus the original arguments.
      <p>
      The target and handler must have the same corresponding
      argument and return types, except that handler may omit trailing arguments
      (similarly to the predicate in <a href="#L2992" title="Defined at 2992.">guardWithTest</a>).
      Also, the handler must have an extra leading parameter of <code>exType</code> or a supertype.
      </p><p> Here is pseudocode for the resulting adapter:
      </p><blockquote><pre>{@code
      T target(A..., B...);
      T handler(ExType, A...);
      T adapter(A... a, B... b) {
        try {
          return target(a..., b...);
        } catch (ExType ex) {
          return handler(ex, a...);
        }
      }
      }</pre></blockquote>
      Note that the saved arguments (<code>a...</code> in the pseudocode) cannot
      be modified by execution of the target, and so are passed unchanged
      from the caller to the handler, if the handler is invoked.
      <p>
      The target and handler must return the same type, even if the handler
      always throws.  (This might happen, for instance, because the handler
      is simulating a <code>finally</code> clause).
      To create such a throwing handler, compose the handler creation logic
      with <a href="#L3098" title="Defined at 3098.">throwException</a>,
      in order to create a method handle of the correct return type.
      @param target method handle to call
      @param exType the type of exception which the handler will catch
      @param handler method handle to call if a matching exception is thrown
      @return method handle which incorporates the specified try/catch logic
      @throws NullPointerException if any argument is null
      @throws IllegalArgumentException if <code>handler</code> does not accept
               the given exception type, or if the method handle types do
               not match in their return types and their
               corresponding parameters</p></div>
<a id="L3061" name="L3061"></a>3061     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L3062" name="L3062"></a>3062     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> catchException(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>,
<a id="L3063" name="L3063"></a>3063                                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;? <strong class="reserved">extends</strong> <a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a>&gt; exType,
<a id="L3064" name="L3064"></a>3064                                 <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>) <em class="brace">{</em>
<a id="L3065" name="L3065"></a>3065         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> ttype = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L3066" name="L3066"></a>3066         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> htype = <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L3067" name="L3067"></a>3067         <strong class="reserved">if</strong> (htype.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() &lt; 1 ||
<a id="L3068" name="L3068"></a>3068             !htype.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0).<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(exType))
<a id="L3069" name="L3069"></a>3069             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("handler does not accept exception type "+exType);
<a id="L3070" name="L3070"></a>3070         <strong class="reserved">if</strong> (htype.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != ttype.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>())
<a id="L3071" name="L3071"></a>3071             <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and handler return types", ttype, htype);
<a id="L3072" name="L3072"></a>3072         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; targs = ttype.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L3073" name="L3073"></a>3073         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; hargs = htype.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L3074" name="L3074"></a>3074         hargs = hargs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(1, hargs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>());  <em class="comment">// omit leading parameter from handler</em>
<a id="L3075" name="L3075"></a>3075         <strong class="reserved">if</strong> (!targs.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(hargs)) <em class="brace">{</em>
<a id="L3076" name="L3076"></a>3076             <strong class="reserved">int</strong> hpc = hargs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>(), tpc = targs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L3077" name="L3077"></a>3077             <strong class="reserved">if</strong> (hpc &gt;= tpc || !targs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(0, hpc).<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(hargs))
<a id="L3078" name="L3078"></a>3078                 <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and handler types", ttype, htype);
<a id="L3079" name="L3079"></a>3079             <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a> = <a href="../D/15233.html" title="Multiple defined in 2 places.">dropArguments</a>(<a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>, 1+hpc, targs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(hpc, tpc));
<a id="L3080" name="L3080"></a>3080             htype = <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L3081" name="L3081"></a>3081         <em class="brace">}</em>
<a id="L3082" name="L3082"></a>3082         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L1007" title="Defined at 1007 in src/java/lang/invoke/MethodHandleImpl.java.">makeGuardWithCatch</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, exType, <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>);
<a id="L3083" name="L3083"></a>3083     <em class="brace">}</em>
<a id="L3084" name="L3084"></a>3084 
<div class="comment">
      Produces a method handle which will throw exceptions of the given <code>exType</code>.
      The method handle will accept a single argument of <code>exType</code>,
      and immediately throw it as an exception.
      The method type will nominally specify a return of <code>returnType</code>.
      The return type may be anything convenient:  It doesn't matter to the
      method handle's behavior, since it will never return normally.
      @param returnType the return type of the desired method handle
      @param exType the parameter type of the desired method handle
      @return method handle which can throw the given exceptions
      @throws NullPointerException if either argument is null</div>
<a id="L3097" name="L3097"></a>3097     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L3098" name="L3098"></a>3098     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/29172.html" title="Multiple referred from 38 places.">throwException</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;? <strong class="reserved">extends</strong> <a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a>&gt; exType) <em class="brace">{</em>
<a id="L3099" name="L3099"></a>3099         <strong class="reserved">if</strong> (!<a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a>.<strong class="reserved">class</strong>.<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(exType))
<a id="L3100" name="L3100"></a>3100             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1727.html#L41" title="Defined at 41 in src/java/lang/ClassCastException.java.">ClassCastException</a>(exType.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>());
<a id="L3101" name="L3101"></a>3101         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/35296.html" title="Multiple defined in 6 places.">throwException</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../D/27690.html" title="Multiple defined in 8 places.">methodType</a>(<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>, exType));
<a id="L3102" name="L3102"></a>3102     <em class="brace">}</em>
<a id="L3103" name="L3103"></a>3103 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L92">[^]</a><a href="#L3098">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>