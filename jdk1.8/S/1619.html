<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/lang/invoke/MethodHandles.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><h2 class="header"><a href="../mains.html">root</a>/<a href="../files/7725.html">src</a>/<a href="../files/7984.html">java</a>/<a href="../files/8003.html">lang</a>/<a href="../files/8006.html">invoke</a>/MethodHandles.java</h2>
<em class="comment">/* [&lt;][&gt;]<a href="#L92">[^]</a><a href="#L3098">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</em>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L92" title="Defined at 92.">lookup</a></li>
<li><a href="#L116" title="Defined at 116.">publicLookup</a></li>
<li><a href="#L143" title="Defined at 143.">reflectAs</a></li>
<li><a href="#L550" title="Defined at 550.">fixmods</a></li>
<li><a href="#L564" title="Defined at 564.">lookupClass</a></li>
<li><a href="#L569" title="Defined at 569.">lookupClassOrNull</a></li>
<li><a href="#L591" title="Defined at 591.">lookupModes</a></li>
<li><a href="#L635" title="Defined at 635.">in</a></li>
<li><a href="#L673" title="Defined at 673.">checkUnprivilegedlookupClass</a></li>
<li><a href="#L717" title="Defined at 717.">toString</a></li>
<li><a href="#L776" title="Defined at 776.">findStatic</a></li>
<li><a href="#L852" title="Defined at 852.">findVirtual</a></li>
<li><a href="#L861" title="Defined at 861.">findVirtualForMH</a></li>
<li><a href="#L918" title="Defined at 918.">findConstructor</a></li>
<li><a href="#L996" title="Defined at 996.">findSpecial</a></li>
<li><a href="#L1021" title="Defined at 1021.">findGetter</a></li>
<li><a href="#L1043" title="Defined at 1043.">findSetter</a></li>
<li><a href="#L1067" title="Defined at 1067.">findStaticGetter</a></li>
<li><a href="#L1091" title="Defined at 1091.">findStaticSetter</a></li>
<li><a href="#L1144" title="Defined at 1144.">bind</a></li>
<li><a href="#L1177" title="Defined at 1177.">unreflect</a></li>
<li><a href="#L1190" title="Defined at 1190.">unreflectForMH</a></li>
<li><a href="#L1226" title="Defined at 1226.">unreflectSpecial</a></li>
<li><a href="#L1259" title="Defined at 1259.">unreflectConstructor</a></li>
<li><a href="#L1284" title="Defined at 1284.">unreflectGetter</a></li>
<li><a href="#L1287" title="Defined at 1287.">unreflectField</a></li>
<li><a href="#L1314" title="Defined at 1314.">unreflectSetter</a></li>
<li><a href="#L1336" title="Defined at 1336.">revealDirect</a></li>
<li><a href="#L1369" title="Defined at 1369.">resolveOrFail</a></li>
<li><a href="#L1377" title="Defined at 1377.">resolveOrFail</a></li>
<li><a href="#L1386" title="Defined at 1386.">resolveOrFail</a></li>
<li><a href="#L1394" title="Defined at 1394.">checkSymbolicClass</a></li>
<li><a href="#L1402" title="Defined at 1402.">checkMethodName</a></li>
<li><a href="#L1413" title="Defined at 1413.">findBoundCallerClass</a></li>
<li><a href="#L1426" title="Defined at 1426.">hasPrivateAccess</a></li>
<li><a href="#L1435" title="Defined at 1435.">checkSecurityManager</a></li>
<li><a href="#L1460" title="Defined at 1460.">checkMethod</a></li>
<li><a href="#L1474" title="Defined at 1474.">checkField</a></li>
<li><a href="#L1485" title="Defined at 1485.">checkAccess</a></li>
<li><a href="#L1535" title="Defined at 1535.">accessFailedMessage</a></li>
<li><a href="#L1560" title="Defined at 1560.">checkSpecialCaller</a></li>
<li><a href="#L1571" title="Defined at 1571.">restrictProtectedReceiver</a></li>
<li><a href="#L1583" title="Defined at 1583.">restrictReceiver</a></li>
<li><a href="#L1598" title="Defined at 1598.">getDirectMethod</a></li>
<li><a href="#L1604" title="Defined at 1604.">getDirectMethodNoRestrict</a></li>
<li><a href="#L1610" title="Defined at 1610.">getDirectMethodNoSecurityManager</a></li>
<li><a href="#L1616" title="Defined at 1616.">getDirectMethodCommon</a></li>
<li><a href="#L1669" title="Defined at 1669.">maybeBindCaller</a></li>
<li><a href="#L1682" title="Defined at 1682.">getDirectField</a></li>
<li><a href="#L1687" title="Defined at 1687.">getDirectFieldNoSecurityManager</a></li>
<li><a href="#L1692" title="Defined at 1692.">getDirectFieldCommon</a></li>
<li><a href="#L1706" title="Defined at 1706.">getDirectConstructor</a></li>
<li><a href="#L1711" title="Defined at 1711.">getDirectConstructorNoSecurityManager</a></li>
<li><a href="#L1716" title="Defined at 1716.">getDirectConstructorCommon</a></li>
<li><a href="#L1730" title="Defined at 1730.">linkMethodHandleConstant</a></li>
<li><a href="#L1761" title="Defined at 1761.">canBeCached</a></li>
<li><a href="#L1793" title="Defined at 1793.">getDirectMethodForConstant</a></li>
<li><a href="#L1820" title="Defined at 1820.">arrayElementGetter</a></li>
<li><a href="#L1835" title="Defined at 1835.">arrayElementSetter</a></li>
<li><a href="#L1888" title="Defined at 1888.">spreadInvoker</a></li>
<li><a href="#L1931" title="Defined at 1931.">exactInvoker</a></li>
<li><a href="#L1970" title="Defined at 1970.">invoker</a></li>
<li><a href="#L1975" title="Defined at 1975.">basicInvoker</a></li>
<li><a href="#L2026" title="Defined at 2026.">explicitCastArguments</a></li>
<li><a href="#L2037" title="Defined at 2037.">explicitCastArgumentsChecks</a></li>
<li><a href="#L2103" title="Defined at 2103.">permuteArguments</a></li>
<li><a href="#L2175" title="Defined at 2175.">findFirstDupOrDrop</a></li>
<li><a href="#L2224" title="Defined at 2224.">permuteArgumentChecks</a></li>
<li><a href="#L2263" title="Defined at 2263.">constant</a></li>
<li><a href="#L2287" title="Defined at 2287.">identity</a></li>
<li><a href="#L2301" title="Defined at 2301.">makeIdentity</a></li>
<li><a href="#L2307" title="Defined at 2307.">zero</a></li>
<li><a href="#L2319" title="Defined at 2319.">makeZero</a></li>
<li><a href="#L2325" title="Defined at 2325.">setCachedMethodHandle</a></li>
<li><a href="#L2363" title="Defined at 2363.">insertArguments</a></li>
<li><a href="#L2381" title="Defined at 2381.">insertArgumentPrimitive</a></li>
<li><a href="#L2395" title="Defined at 2395.">insertArgumentsChecks</a></li>
<li><a href="#L2449" title="Defined at 2449.">dropArguments</a></li>
<li><a href="#L2464" title="Defined at 2464.">dropArgumentChecks</a></li>
<li><a href="#L2524" title="Defined at 2524.">dropArguments</a></li>
<li><a href="#L2594" title="Defined at 2594.">filterArguments</a></li>
<li><a href="#L2607" title="Defined at 2607.">filterArgument</a></li>
<li><a href="#L2619" title="Defined at 2619.">filterArgumentsCheckArity</a></li>
<li><a href="#L2626" title="Defined at 2626.">filterArgumentChecks</a></li>
<li><a href="#L2741" title="Defined at 2741.">collectArguments</a></li>
<li><a href="#L2756" title="Defined at 2756.">collectArgumentsChecks</a></li>
<li><a href="#L2828" title="Defined at 2828.">filterReturnValue</a></li>
<li><a href="#L2840" title="Defined at 2840.">filterReturnValueChecks</a></li>
<li><a href="#L2926" title="Defined at 2926.">foldArguments</a></li>
<li><a href="#L2942" title="Defined at 2942.">foldArgumentChecks</a></li>
<li><a href="#L2992" title="Defined at 2992.">guardWithTest</a></li>
<li><a href="#L3014" title="Defined at 3014.">misMatchedTypes</a></li>
<li><a href="#L3062" title="Defined at 3062.">catchException</a></li>
<li><a href="#L3098" title="Defined at 3098.">throwException</a></li>
</ol>
<hr>
<pre><a id="L1" name="L1"></a>   1 <em class="comment">/*</em>
<a id="L2" name="L2"></a>   2 <em class="comment"> * Copyright (c) 2008, 2013, Oracle and/or its affiliates. All rights reserved.</em>
<a id="L3" name="L3"></a>   3 <em class="comment"> * ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</em>
<a id="L4" name="L4"></a>   4 <em class="comment"> *</em>
<a id="L5" name="L5"></a>   5 <em class="comment"> *</em>
<a id="L6" name="L6"></a>   6 <em class="comment"> *</em>
<a id="L7" name="L7"></a>   7 <em class="comment"> *</em>
<a id="L8" name="L8"></a>   8 <em class="comment"> *</em>
<a id="L9" name="L9"></a>   9 <em class="comment"> *</em>
<a id="L10" name="L10"></a>  10 <em class="comment"> *</em>
<a id="L11" name="L11"></a>  11 <em class="comment"> *</em>
<a id="L12" name="L12"></a>  12 <em class="comment"> *</em>
<a id="L13" name="L13"></a>  13 <em class="comment"> *</em>
<a id="L14" name="L14"></a>  14 <em class="comment"> *</em>
<a id="L15" name="L15"></a>  15 <em class="comment"> *</em>
<a id="L16" name="L16"></a>  16 <em class="comment"> *</em>
<a id="L17" name="L17"></a>  17 <em class="comment"> *</em>
<a id="L18" name="L18"></a>  18 <em class="comment"> *</em>
<a id="L19" name="L19"></a>  19 <em class="comment"> *</em>
<a id="L20" name="L20"></a>  20 <em class="comment"> *</em>
<a id="L21" name="L21"></a>  21 <em class="comment"> *</em>
<a id="L22" name="L22"></a>  22 <em class="comment"> *</em>
<a id="L23" name="L23"></a>  23 <em class="comment"> *</em>
<a id="L24" name="L24"></a>  24 <em class="comment"> */</em>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../D/25050.html" title="Multiple defined in 52 places.">invoke</a>;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.lang.reflect.*;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.util.BitSet;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.util.List;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.util.Arrays;
<a id="L32" name="L32"></a>  32 
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> sun.invoke.util.ValueConversions;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> sun.invoke.util.VerifyAccess;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> sun.invoke.util.Wrapper;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> sun.reflect.CallerSensitive;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> sun.reflect.Reflection;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> sun.reflect.misc.ReflectUtil;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> sun.security.util.SecurityConstants;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.lang.invoke.LambdaForm.BasicType;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> static java.lang.invoke.LambdaForm.BasicType.*;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandleStatics.*;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandleImpl.Intrinsic;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandleNatives.Constants.*;
<a id="L45" name="L45"></a>  45 
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> java.util.concurrent.ConcurrentHashMap;
<a id="L47" name="L47"></a>  47 
<a id="L48" name="L48"></a>  48 <em class="comment">/**</em>
<a id="L49" name="L49"></a>  49 <em class="comment"> * This class consists exclusively of static methods that operate on or return</em>
<a id="L50" name="L50"></a>  50 <em class="comment"> * method handles. They fall into several categories:</em>
<a id="L51" name="L51"></a>  51 <em class="comment"> * <ul></ul></em>
<a id="L52" name="L52"></a>  52 <em class="comment"> * <li>Lookup methods which help create method handles for methods and fields.</li></em>
<a id="L53" name="L53"></a>  53 <em class="comment"> * <li>Combinator methods, which combine or transform pre-existing method handles into new ones.</li></em>
<a id="L54" name="L54"></a>  54 <em class="comment"> * <li>Other factory methods to create method handles that emulate other common JVM operations or control flow patterns.</li></em>
<a id="L55" name="L55"></a>  55 <em class="comment"> * </em>
<a id="L56" name="L56"></a>  56 <em class="comment"> * </em>
<a id="L57" name="L57"></a>  57 <em class="comment"> * @author John Rose, JSR 292 EG</em>
<a id="L58" name="L58"></a>  58 <em class="comment"> * @since 1.7</em>
<a id="L59" name="L59"></a>  59 <em class="comment"> */</em>
<a id="L60" name="L60"></a>  60 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/5120.html" title="Multiple referred from 35 places.">MethodHandles</a> <em class="brace">{</em>
<a id="L61" name="L61"></a>  61 
<a id="L62" name="L62"></a>  62     <strong class="reserved">private</strong> MethodHandles() <em class="brace">{</em> <em class="brace">}</em>  <em class="comment">// do not instantiate</em>
<a id="L63" name="L63"></a>  63 
<a id="L64" name="L64"></a>  64     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../D/3122.html" title="Multiple defined in 4 places.">Factory</a> IMPL_NAMES = <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../D/18981.html" title="Multiple defined in 13 places.">getFactory</a>();
<a id="L65" name="L65"></a>  65     <strong class="reserved">static</strong> <em class="brace">{</em> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L66" title="Defined at 66 in src/java/lang/invoke/MethodHandleImpl.java.">initStatics</a>(); <em class="brace">}</em>
<a id="L66" name="L66"></a>  66     <em class="comment">// See IMPL_LOOKUP below.</em>
<a id="L67" name="L67"></a>  67 
<a id="L68" name="L68"></a>  68     <em class="comment">//// Method handle creation from ordinary methods.</em>
<a id="L69" name="L69"></a>  69 
<a id="L70" name="L70"></a>  70     <em class="comment">/**</em>
<a id="L71" name="L71"></a>  71 <em class="comment">     * Returns a {@link Lookup lookup object} with</em>
<a id="L72" name="L72"></a>  72 <em class="comment">     * full capabilities to emulate all supported bytecode behaviors of the caller.</em>
<a id="L73" name="L73"></a>  73 <em class="comment">     * These capabilities include <a href="MethodHandles.Lookup.html#privacc">private access</a> to the caller.</em>
<a id="L74" name="L74"></a>  74 <em class="comment">     * Factory methods on the lookup object can create</em>
<a id="L75" name="L75"></a>  75 <em class="comment">     * <a href="MethodHandleInfo.html#directmh">direct method handles</a></em>
<a id="L76" name="L76"></a>  76 <em class="comment">     * for any member that the caller has access to via bytecodes,</em>
<a id="L77" name="L77"></a>  77 <em class="comment">     * including protected and private fields and methods.</em>
<a id="L78" name="L78"></a>  78 <em class="comment">     * This lookup object is a <em>capability</em> which may be delegated to trusted agents.</em>
<a id="L79" name="L79"></a>  79 <em class="comment">     * Do not store it in place where untrusted code can access it.</em>
<a id="L80" name="L80"></a>  80 <em class="comment">     * </em>
<a id="L81" name="L81"></a>  81 <em class="comment">     * This method is caller sensitive, which means that it may return different</em>
<a id="L82" name="L82"></a>  82 <em class="comment">     * values to different callers.</em>
<a id="L83" name="L83"></a>  83 <em class="comment">     * </em>
<a id="L84" name="L84"></a>  84 <em class="comment">     * For any given caller class {@code C}, the lookup object returned by this call</em>
<a id="L85" name="L85"></a>  85 <em class="comment">     * has equivalent capabilities to any lookup object</em>
<a id="L86" name="L86"></a>  86 <em class="comment">     * supplied by the JVM to the bootstrap method of an</em>
<a id="L87" name="L87"></a>  87 <em class="comment">     * <a href="package-summary.html#indyinsn">invokedynamic instruction</a></em>
<a id="L88" name="L88"></a>  88 <em class="comment">     * executing in the same caller class {@code C}.</em>
<a id="L89" name="L89"></a>  89 <em class="comment">     * @return a lookup object for the caller of this method, with private access</em>
<a id="L90" name="L90"></a>  90 <em class="comment">     */</em>
<a id="L91" name="L91"></a>  91     @CallerSensitive
<a id="L92" name="L92"></a>  92     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../R/22724.html" title="Multiple referred from 149 places.">lookup</a>() <em class="brace">{</em>
<a id="L93" name="L93"></a>  93         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(Reflection.getCallerClass());
<a id="L94" name="L94"></a>  94     <em class="brace">}</em>
<a id="L95" name="L95"></a>  95 
<a id="L96" name="L96"></a>  96     <em class="comment">/**</em>
<a id="L97" name="L97"></a>  97 <em class="comment">     * Returns a {@link Lookup lookup object} which is trusted minimally.</em>
<a id="L98" name="L98"></a>  98 <em class="comment">     * It can only be used to create method handles to</em>
<a id="L99" name="L99"></a>  99 <em class="comment">     * publicly accessible fields and methods.</em>
<a id="L100" name="L100"></a> 100 <em class="comment">     * </em>
<a id="L101" name="L101"></a> 101 <em class="comment">     * As a matter of pure convention, the {@linkplain Lookup#lookupClass lookup class}</em>
<a id="L102" name="L102"></a> 102 <em class="comment">     * of this lookup object will be {@link java.lang.Object}.</em>
<a id="L103" name="L103"></a> 103 <em class="comment">     *</em>
<a id="L104" name="L104"></a> 104 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L105" name="L105"></a> 105 <em class="comment">     * <em>Discussion:</em></em>
<a id="L106" name="L106"></a> 106 <em class="comment">     * The lookup class can be changed to any other class {@code C} using an expression of the form</em>
<a id="L107" name="L107"></a> 107 <em class="comment">     * {@link Lookup#in publicLookup().in(C.class)}.</em>
<a id="L108" name="L108"></a> 108 <em class="comment">     * Since all classes have equal access to public names,</em>
<a id="L109" name="L109"></a> 109 <em class="comment">     * such a change would confer no new access rights.</em>
<a id="L110" name="L110"></a> 110 <em class="comment">     * A public lookup object is always subject to</em>
<a id="L111" name="L111"></a> 111 <em class="comment">     * <a href="MethodHandles.Lookup.html#secmgr">security manager checks</a>.</em>
<a id="L112" name="L112"></a> 112 <em class="comment">     * Also, it cannot access</em>
<a id="L113" name="L113"></a> 113 <em class="comment">     * <a href="MethodHandles.Lookup.html#callsens">caller sensitive methods</a>.</em>
<a id="L114" name="L114"></a> 114 <em class="comment">     * @return a lookup object which is trusted minimally</em>
<a id="L115" name="L115"></a> 115 <em class="comment">     */</em>
<a id="L116" name="L116"></a> 116     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../S/1619.html#L1784" title="Referred from 1784 in src/java/lang/invoke/MethodHandles.java.">publicLookup</a>() <em class="brace">{</em>
<a id="L117" name="L117"></a> 117         <strong class="reserved">return</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>.PUBLIC_LOOKUP;
<a id="L118" name="L118"></a> 118     <em class="brace">}</em>
<a id="L119" name="L119"></a> 119 
<a id="L120" name="L120"></a> 120     <em class="comment">/**</em>
<a id="L121" name="L121"></a> 121 <em class="comment">     * Performs an unchecked "crack" of a</em>
<a id="L122" name="L122"></a> 122 <em class="comment">     * <a href="MethodHandleInfo.html#directmh">direct method handle</a>.</em>
<a id="L123" name="L123"></a> 123 <em class="comment">     * The result is as if the user had obtained a lookup object capable enough</em>
<a id="L124" name="L124"></a> 124 <em class="comment">     * to crack the target method handle, called</em>
<a id="L125" name="L125"></a> 125 <em class="comment">     * {@link java.lang.invoke.MethodHandles.Lookup#revealDirect Lookup.revealDirect}</em>
<a id="L126" name="L126"></a> 126 <em class="comment">     * on the target to obtain its symbolic reference, and then called</em>
<a id="L127" name="L127"></a> 127 <em class="comment">     * {@link java.lang.invoke.MethodHandleInfo#reflectAs MethodHandleInfo.reflectAs}</em>
<a id="L128" name="L128"></a> 128 <em class="comment">     * to resolve the symbolic reference to a member.</em>
<a id="L129" name="L129"></a> 129 <em class="comment">     * </em>
<a id="L130" name="L130"></a> 130 <em class="comment">     * If there is a security manager, its {@code checkPermission} method</em>
<a id="L131" name="L131"></a> 131 <em class="comment">     * is called with a {@code ReflectPermission("suppressAccessChecks")} permission.</em>
<a id="L132" name="L132"></a> 132 <em class="comment">     * @param <t> the desired type of the result, either {@link Member} or a subtype</t></em>
<a id="L133" name="L133"></a> 133 <em class="comment">     * @param target a direct method handle to crack into symbolic reference components</em>
<a id="L134" name="L134"></a> 134 <em class="comment">     * @param expected a class object representing the desired result type {@code T}</em>
<a id="L135" name="L135"></a> 135 <em class="comment">     * @return a reference to the method, constructor, or field object</em>
<a id="L136" name="L136"></a> 136 <em class="comment">     * @exception SecurityException if the caller is not privileged to call {@code setAccessible}</em>
<a id="L137" name="L137"></a> 137 <em class="comment">     * @exception NullPointerException if either argument is {@code null}</em>
<a id="L138" name="L138"></a> 138 <em class="comment">     * @exception IllegalArgumentException if the target is not a direct method handle</em>
<a id="L139" name="L139"></a> 139 <em class="comment">     * @exception ClassCastException if the member is not of the expected type</em>
<a id="L140" name="L140"></a> 140 <em class="comment">     * @since 1.8</em>
<a id="L141" name="L141"></a> 141 <em class="comment">     */</em>
<a id="L142" name="L142"></a> 142     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> <strong class="reserved">extends</strong> <a href="../S/1664.html#L40" title="Defined at 40 in src/java/lang/reflect/Member.java.">Member</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>
<a id="L143" name="L143"></a> 143     <a href="../S/1619.html#L147" title="Referred from 147 in src/java/lang/invoke/MethodHandles.java.">reflectAs</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; expected, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>) <em class="brace">{</em>
<a id="L144" name="L144"></a> 144         <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> smgr = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>();
<a id="L145" name="L145"></a> 145         <strong class="reserved">if</strong> (smgr != <strong class="reserved">null</strong>)  smgr.<a href="../D/12594.html" title="Multiple defined in 22 places.">checkPermission</a>(ACCESS_PERMISSION);
<a id="L146" name="L146"></a> 146         <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a> = <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>.IMPL_LOOKUP;  <em class="comment">// use maximally privileged lookup</em>
<a id="L147" name="L147"></a> 147         <strong class="reserved">return</strong> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>.<a href="../S/1619.html#L1336" title="Defined at 1336 in src/java/lang/invoke/MethodHandles.java.">revealDirect</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>).<a href="../D/30502.html" title="Multiple defined in 3 places.">reflectAs</a>(expected, <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>);
<a id="L148" name="L148"></a> 148     <em class="brace">}</em>
<a id="L149" name="L149"></a> 149     <em class="comment">// Copied from AccessibleObject, as used by Method.setAccessible, etc.:</em>
<a id="L150" name="L150"></a> 150     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">private</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.<a href="../D/6689.html" title="Multiple defined in 2 places.">Permission</a> ACCESS_PERMISSION =
<a id="L151" name="L151"></a> 151         <strong class="reserved">new</strong> <a href="../S/1669.html#L75" title="Defined at 75 in src/java/lang/reflect/ReflectPermission.java.">ReflectPermission</a>("suppressAccessChecks");
<a id="L152" name="L152"></a> 152 
<a id="L153" name="L153"></a> 153     <em class="comment">/**</em>
<a id="L154" name="L154"></a> 154 <em class="comment">     * A <em>lookup object</em> is a factory for creating method handles,</em>
<a id="L155" name="L155"></a> 155 <em class="comment">     * when the creation requires access checking.</em>
<a id="L156" name="L156"></a> 156 <em class="comment">     * Method handles do not perform</em>
<a id="L157" name="L157"></a> 157 <em class="comment">     * access checks when they are called, but rather when they are created.</em>
<a id="L158" name="L158"></a> 158 <em class="comment">     * Therefore, method handle access</em>
<a id="L159" name="L159"></a> 159 <em class="comment">     * restrictions must be enforced when a method handle is created.</em>
<a id="L160" name="L160"></a> 160 <em class="comment">     * The caller class against which those restrictions are enforced</em>
<a id="L161" name="L161"></a> 161 <em class="comment">     * is known as the {@linkplain #lookupClass lookup class}.</em>
<a id="L162" name="L162"></a> 162 <em class="comment">     * </em>
<a id="L163" name="L163"></a> 163 <em class="comment">     * A lookup class which needs to create method handles will call</em>
<a id="L164" name="L164"></a> 164 <em class="comment">     * {@link MethodHandles#lookup MethodHandles.lookup} to create a factory for itself.</em>
<a id="L165" name="L165"></a> 165 <em class="comment">     * When the {@code Lookup} factory object is created, the identity of the lookup class is</em>
<a id="L166" name="L166"></a> 166 <em class="comment">     * determined, and securely stored in the {@code Lookup} object.</em>
<a id="L167" name="L167"></a> 167 <em class="comment">     * The lookup class (or its delegates) may then use factory methods</em>
<a id="L168" name="L168"></a> 168 <em class="comment">     * on the {@code Lookup} object to create method handles for access-checked members.</em>
<a id="L169" name="L169"></a> 169 <em class="comment">     * This includes all methods, constructors, and fields which are allowed to the lookup class,</em>
<a id="L170" name="L170"></a> 170 <em class="comment">     * even private ones.</em>
<a id="L171" name="L171"></a> 171 <em class="comment">     *</em>
<a id="L172" name="L172"></a> 172 <em class="comment">     * <h1><a name="lookups"></a>Lookup Factory Methods</h1></em>
<a id="L173" name="L173"></a> 173 <em class="comment">     * The factory methods on a {@code Lookup} object correspond to all major</em>
<a id="L174" name="L174"></a> 174 <em class="comment">     * use cases for methods, constructors, and fields.</em>
<a id="L175" name="L175"></a> 175 <em class="comment">     * Each method handle created by a factory method is the functional</em>
<a id="L176" name="L176"></a> 176 <em class="comment">     * equivalent of a particular <em>bytecode behavior</em>.</em>
<a id="L177" name="L177"></a> 177 <em class="comment">     * (Bytecode behaviors are described in section 5.4.3.5 of the Java Virtual Machine Specification.)</em>
<a id="L178" name="L178"></a> 178 <em class="comment">     * Here is a summary of the correspondence between these factory methods and</em>
<a id="L179" name="L179"></a> 179 <em class="comment">     * the behavior the resulting method handles:</em>
<a id="L180" name="L180"></a> 180 <em class="comment">     * <table border="1" cellpadding="5" summary="lookup method behaviors"></table></em>
<a id="L181" name="L181"></a> 181 <em class="comment">     * </em>
<a id="L182" name="L182"></a> 182 <em class="comment">     *     <a name="equiv"></a>lookup expression</em>
<a id="L183" name="L183"></a> 183 <em class="comment">     *     member</em>
<a id="L184" name="L184"></a> 184 <em class="comment">     *     bytecode behavior</em>
<a id="L185" name="L185"></a> 185 <em class="comment">     * </em>
<a id="L186" name="L186"></a> 186 <em class="comment">     * </em>
<a id="L187" name="L187"></a> 187 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#findGetter lookup.findGetter(C.class,"f",FT.class)}</em>
<a id="L188" name="L188"></a> 188 <em class="comment">     *     {@code FT f;}{@code (T) this.f;}</em>
<a id="L189" name="L189"></a> 189 <em class="comment">     * </em>
<a id="L190" name="L190"></a> 190 <em class="comment">     * </em>
<a id="L191" name="L191"></a> 191 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#findStaticGetter lookup.findStaticGetter(C.class,"f",FT.class)}</em>
<a id="L192" name="L192"></a> 192 <em class="comment">     *     {@code static}<br>{@code FT f;}{@code (T) C.f;}</em>
<a id="L193" name="L193"></a> 193 <em class="comment">     * </em>
<a id="L194" name="L194"></a> 194 <em class="comment">     * </em>
<a id="L195" name="L195"></a> 195 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#findSetter lookup.findSetter(C.class,"f",FT.class)}</em>
<a id="L196" name="L196"></a> 196 <em class="comment">     *     {@code FT f;}{@code this.f = x;}</em>
<a id="L197" name="L197"></a> 197 <em class="comment">     * </em>
<a id="L198" name="L198"></a> 198 <em class="comment">     * </em>
<a id="L199" name="L199"></a> 199 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#findStaticSetter lookup.findStaticSetter(C.class,"f",FT.class)}</em>
<a id="L200" name="L200"></a> 200 <em class="comment">     *     {@code static}<br>{@code FT f;}{@code C.f = arg;}</em>
<a id="L201" name="L201"></a> 201 <em class="comment">     * </em>
<a id="L202" name="L202"></a> 202 <em class="comment">     * </em>
<a id="L203" name="L203"></a> 203 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#findVirtual lookup.findVirtual(C.class,"m",MT)}</em>
<a id="L204" name="L204"></a> 204 <em class="comment">     *     {@code T m(A*);}{@code (T) this.m(arg*);}</em>
<a id="L205" name="L205"></a> 205 <em class="comment">     * </em>
<a id="L206" name="L206"></a> 206 <em class="comment">     * </em>
<a id="L207" name="L207"></a> 207 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#findStatic lookup.findStatic(C.class,"m",MT)}</em>
<a id="L208" name="L208"></a> 208 <em class="comment">     *     {@code static}<br>{@code T m(A*);}{@code (T) C.m(arg*);}</em>
<a id="L209" name="L209"></a> 209 <em class="comment">     * </em>
<a id="L210" name="L210"></a> 210 <em class="comment">     * </em>
<a id="L211" name="L211"></a> 211 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#findSpecial lookup.findSpecial(C.class,"m",MT,this.class)}</em>
<a id="L212" name="L212"></a> 212 <em class="comment">     *     {@code T m(A*);}{@code (T) super.m(arg*);}</em>
<a id="L213" name="L213"></a> 213 <em class="comment">     * </em>
<a id="L214" name="L214"></a> 214 <em class="comment">     * </em>
<a id="L215" name="L215"></a> 215 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#findConstructor lookup.findConstructor(C.class,MT)}</em>
<a id="L216" name="L216"></a> 216 <em class="comment">     *     {@code C(A*);}{@code new C(arg*);}</em>
<a id="L217" name="L217"></a> 217 <em class="comment">     * </em>
<a id="L218" name="L218"></a> 218 <em class="comment">     * </em>
<a id="L219" name="L219"></a> 219 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#unreflectGetter lookup.unreflectGetter(aField)}</em>
<a id="L220" name="L220"></a> 220 <em class="comment">     *     ({@code static})?<br>{@code FT f;}{@code (FT) aField.get(thisOrNull);}</em>
<a id="L221" name="L221"></a> 221 <em class="comment">     * </em>
<a id="L222" name="L222"></a> 222 <em class="comment">     * </em>
<a id="L223" name="L223"></a> 223 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#unreflectSetter lookup.unreflectSetter(aField)}</em>
<a id="L224" name="L224"></a> 224 <em class="comment">     *     ({@code static})?<br>{@code FT f;}{@code aField.set(thisOrNull, arg);}</em>
<a id="L225" name="L225"></a> 225 <em class="comment">     * </em>
<a id="L226" name="L226"></a> 226 <em class="comment">     * </em>
<a id="L227" name="L227"></a> 227 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#unreflect lookup.unreflect(aMethod)}</em>
<a id="L228" name="L228"></a> 228 <em class="comment">     *     ({@code static})?<br>{@code T m(A*);}{@code (T) aMethod.invoke(thisOrNull, arg*);}</em>
<a id="L229" name="L229"></a> 229 <em class="comment">     * </em>
<a id="L230" name="L230"></a> 230 <em class="comment">     * </em>
<a id="L231" name="L231"></a> 231 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#unreflectConstructor lookup.unreflectConstructor(aConstructor)}</em>
<a id="L232" name="L232"></a> 232 <em class="comment">     *     {@code C(A*);}{@code (C) aConstructor.newInstance(arg*);}</em>
<a id="L233" name="L233"></a> 233 <em class="comment">     * </em>
<a id="L234" name="L234"></a> 234 <em class="comment">     * </em>
<a id="L235" name="L235"></a> 235 <em class="comment">     *     {@link java.lang.invoke.MethodHandles.Lookup#unreflect lookup.unreflect(aMethod)}</em>
<a id="L236" name="L236"></a> 236 <em class="comment">     *     ({@code static})?<br>{@code T m(A*);}{@code (T) aMethod.invoke(thisOrNull, arg*);}</em>
<a id="L237" name="L237"></a> 237 <em class="comment">     * </em>
<a id="L238" name="L238"></a> 238 <em class="comment">     * </em>
<a id="L239" name="L239"></a> 239 <em class="comment">     *</em>
<a id="L240" name="L240"></a> 240 <em class="comment">     * Here, the type {@code C} is the class or interface being searched for a member,</em>
<a id="L241" name="L241"></a> 241 <em class="comment">     * documented as a parameter named {@code refc} in the lookup methods.</em>
<a id="L242" name="L242"></a> 242 <em class="comment">     * The method type {@code MT} is composed from the return type {@code T}</em>
<a id="L243" name="L243"></a> 243 <em class="comment">     * and the sequence of argument types {@code A*}.</em>
<a id="L244" name="L244"></a> 244 <em class="comment">     * The constructor also has a sequence of argument types {@code A*} and</em>
<a id="L245" name="L245"></a> 245 <em class="comment">     * is deemed to return the newly-created object of type {@code C}.</em>
<a id="L246" name="L246"></a> 246 <em class="comment">     * Both {@code MT} and the field type {@code FT} are documented as a parameter named {@code type}.</em>
<a id="L247" name="L247"></a> 247 <em class="comment">     * The formal parameter {@code this} stands for the self-reference of type {@code C};</em>
<a id="L248" name="L248"></a> 248 <em class="comment">     * if it is present, it is always the leading argument to the method handle invocation.</em>
<a id="L249" name="L249"></a> 249 <em class="comment">     * (In the case of some {@code protected} members, {@code this} may be</em>
<a id="L250" name="L250"></a> 250 <em class="comment">     * restricted in type to the lookup class; see below.)</em>
<a id="L251" name="L251"></a> 251 <em class="comment">     * The name {@code arg} stands for all the other method handle arguments.</em>
<a id="L252" name="L252"></a> 252 <em class="comment">     * In the code examples for the Core Reflection API, the name {@code thisOrNull}</em>
<a id="L253" name="L253"></a> 253 <em class="comment">     * stands for a null reference if the accessed method or field is static,</em>
<a id="L254" name="L254"></a> 254 <em class="comment">     * and {@code this} otherwise.</em>
<a id="L255" name="L255"></a> 255 <em class="comment">     * The names {@code aMethod}, {@code aField}, and {@code aConstructor} stand</em>
<a id="L256" name="L256"></a> 256 <em class="comment">     * for reflective objects corresponding to the given members.</em>
<a id="L257" name="L257"></a> 257 <em class="comment">     * </em>
<a id="L258" name="L258"></a> 258 <em class="comment">     * In cases where the given member is of variable arity (i.e., a method or constructor)</em>
<a id="L259" name="L259"></a> 259 <em class="comment">     * the returned method handle will also be of {@linkplain MethodHandle#asVarargsCollector variable arity}.</em>
<a id="L260" name="L260"></a> 260 <em class="comment">     * In all other cases, the returned method handle will be of fixed arity.</em>
<a id="L261" name="L261"></a> 261 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L262" name="L262"></a> 262 <em class="comment">     * <em>Discussion:</em></em>
<a id="L263" name="L263"></a> 263 <em class="comment">     * The equivalence between looked-up method handles and underlying</em>
<a id="L264" name="L264"></a> 264 <em class="comment">     * class members and bytecode behaviors</em>
<a id="L265" name="L265"></a> 265 <em class="comment">     * can break down in a few ways:</em>
<a id="L266" name="L266"></a> 266 <em class="comment">     * <ul style="font-size:smaller;"></ul></em>
<a id="L267" name="L267"></a> 267 <em class="comment">     * <li>If {@code C} is not symbolically accessible from the lookup class's loader,</li></em>
<a id="L268" name="L268"></a> 268 <em class="comment">     * the lookup can still succeed, even when there is no equivalent</em>
<a id="L269" name="L269"></a> 269 <em class="comment">     * Java expression or bytecoded constant.</em>
<a id="L270" name="L270"></a> 270 <em class="comment">     * <li>Likewise, if {@code T} or {@code MT}</li></em>
<a id="L271" name="L271"></a> 271 <em class="comment">     * is not symbolically accessible from the lookup class's loader,</em>
<a id="L272" name="L272"></a> 272 <em class="comment">     * the lookup can still succeed.</em>
<a id="L273" name="L273"></a> 273 <em class="comment">     * For example, lookups for {@code MethodHandle.invokeExact} and</em>
<a id="L274" name="L274"></a> 274 <em class="comment">     * {@code MethodHandle.invoke} will always succeed, regardless of requested type.</em>
<a id="L275" name="L275"></a> 275 <em class="comment">     * <li>If there is a security manager installed, it can forbid the lookup</li></em>
<a id="L276" name="L276"></a> 276 <em class="comment">     * on various grounds (<a href="MethodHandles.Lookup.html#secmgr">see below</a>).</em>
<a id="L277" name="L277"></a> 277 <em class="comment">     * By contrast, the {@code ldc} instruction on a {@code CONSTANT_MethodHandle}</em>
<a id="L278" name="L278"></a> 278 <em class="comment">     * constant is not subject to security manager checks.</em>
<a id="L279" name="L279"></a> 279 <em class="comment">     * <li>If the looked-up method has a</li></em>
<a id="L280" name="L280"></a> 280 <em class="comment">     * <a href="MethodHandle.html#maxarity">very large arity</a>,</em>
<a id="L281" name="L281"></a> 281 <em class="comment">     * the method handle creation may fail, due to the method handle</em>
<a id="L282" name="L282"></a> 282 <em class="comment">     * type having too many parameters.</em>
<a id="L283" name="L283"></a> 283 <em class="comment">     * </em>
<a id="L284" name="L284"></a> 284 <em class="comment">     *</em>
<a id="L285" name="L285"></a> 285 <em class="comment">     * <h1><a name="access"></a>Access checking</h1></em>
<a id="L286" name="L286"></a> 286 <em class="comment">     * Access checks are applied in the factory methods of {@code Lookup},</em>
<a id="L287" name="L287"></a> 287 <em class="comment">     * when a method handle is created.</em>
<a id="L288" name="L288"></a> 288 <em class="comment">     * This is a key difference from the Core Reflection API, since</em>
<a id="L289" name="L289"></a> 289 <em class="comment">     * {@link java.lang.reflect.Method#invoke java.lang.reflect.Method.invoke}</em>
<a id="L290" name="L290"></a> 290 <em class="comment">     * performs access checking against every caller, on every call.</em>
<a id="L291" name="L291"></a> 291 <em class="comment">     * </em>
<a id="L292" name="L292"></a> 292 <em class="comment">     * All access checks start from a {@code Lookup} object, which</em>
<a id="L293" name="L293"></a> 293 <em class="comment">     * compares its recorded lookup class against all requests to</em>
<a id="L294" name="L294"></a> 294 <em class="comment">     * create method handles.</em>
<a id="L295" name="L295"></a> 295 <em class="comment">     * A single {@code Lookup} object can be used to create any number</em>
<a id="L296" name="L296"></a> 296 <em class="comment">     * of access-checked method handles, all checked against a single</em>
<a id="L297" name="L297"></a> 297 <em class="comment">     * lookup class.</em>
<a id="L298" name="L298"></a> 298 <em class="comment">     * </em>
<a id="L299" name="L299"></a> 299 <em class="comment">     * A {@code Lookup} object can be shared with other trusted code,</em>
<a id="L300" name="L300"></a> 300 <em class="comment">     * such as a metaobject protocol.</em>
<a id="L301" name="L301"></a> 301 <em class="comment">     * A shared {@code Lookup} object delegates the capability</em>
<a id="L302" name="L302"></a> 302 <em class="comment">     * to create method handles on private members of the lookup class.</em>
<a id="L303" name="L303"></a> 303 <em class="comment">     * Even if privileged code uses the {@code Lookup} object,</em>
<a id="L304" name="L304"></a> 304 <em class="comment">     * the access checking is confined to the privileges of the</em>
<a id="L305" name="L305"></a> 305 <em class="comment">     * original lookup class.</em>
<a id="L306" name="L306"></a> 306 <em class="comment">     * </em>
<a id="L307" name="L307"></a> 307 <em class="comment">     * A lookup can fail, because</em>
<a id="L308" name="L308"></a> 308 <em class="comment">     * the containing class is not accessible to the lookup class, or</em>
<a id="L309" name="L309"></a> 309 <em class="comment">     * because the desired class member is missing, or because the</em>
<a id="L310" name="L310"></a> 310 <em class="comment">     * desired class member is not accessible to the lookup class, or</em>
<a id="L311" name="L311"></a> 311 <em class="comment">     * because the lookup object is not trusted enough to access the member.</em>
<a id="L312" name="L312"></a> 312 <em class="comment">     * In any of these cases, a {@code ReflectiveOperationException} will be</em>
<a id="L313" name="L313"></a> 313 <em class="comment">     * thrown from the attempted lookup.  The exact class will be one of</em>
<a id="L314" name="L314"></a> 314 <em class="comment">     * the following:</em>
<a id="L315" name="L315"></a> 315 <em class="comment">     * <ul></ul></em>
<a id="L316" name="L316"></a> 316 <em class="comment">     * <li>NoSuchMethodException — if a method is requested but does not exist</li></em>
<a id="L317" name="L317"></a> 317 <em class="comment">     * <li>NoSuchFieldException — if a field is requested but does not exist</li></em>
<a id="L318" name="L318"></a> 318 <em class="comment">     * <li>IllegalAccessException — if the member exists but an access check fails</li></em>
<a id="L319" name="L319"></a> 319 <em class="comment">     * </em>
<a id="L320" name="L320"></a> 320 <em class="comment">     * </em>
<a id="L321" name="L321"></a> 321 <em class="comment">     * In general, the conditions under which a method handle may be</em>
<a id="L322" name="L322"></a> 322 <em class="comment">     * looked up for a method {@code M} are no more restrictive than the conditions</em>
<a id="L323" name="L323"></a> 323 <em class="comment">     * under which the lookup class could have compiled, verified, and resolved a call to {@code M}.</em>
<a id="L324" name="L324"></a> 324 <em class="comment">     * Where the JVM would raise exceptions like {@code NoSuchMethodError},</em>
<a id="L325" name="L325"></a> 325 <em class="comment">     * a method handle lookup will generally raise a corresponding</em>
<a id="L326" name="L326"></a> 326 <em class="comment">     * checked exception, such as {@code NoSuchMethodException}.</em>
<a id="L327" name="L327"></a> 327 <em class="comment">     * And the effect of invoking the method handle resulting from the lookup</em>
<a id="L328" name="L328"></a> 328 <em class="comment">     * is <a href="MethodHandles.Lookup.html#equiv">exactly equivalent</a></em>
<a id="L329" name="L329"></a> 329 <em class="comment">     * to executing the compiled, verified, and resolved call to {@code M}.</em>
<a id="L330" name="L330"></a> 330 <em class="comment">     * The same point is true of fields and constructors.</em>
<a id="L331" name="L331"></a> 331 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L332" name="L332"></a> 332 <em class="comment">     * <em>Discussion:</em></em>
<a id="L333" name="L333"></a> 333 <em class="comment">     * Access checks only apply to named and reflected methods,</em>
<a id="L334" name="L334"></a> 334 <em class="comment">     * constructors, and fields.</em>
<a id="L335" name="L335"></a> 335 <em class="comment">     * Other method handle creation methods, such as</em>
<a id="L336" name="L336"></a> 336 <em class="comment">     * {@link MethodHandle#asType MethodHandle.asType},</em>
<a id="L337" name="L337"></a> 337 <em class="comment">     * do not require any access checks, and are used</em>
<a id="L338" name="L338"></a> 338 <em class="comment">     * independently of any {@code Lookup} object.</em>
<a id="L339" name="L339"></a> 339 <em class="comment">     * </em>
<a id="L340" name="L340"></a> 340 <em class="comment">     * If the desired member is {@code protected}, the usual JVM rules apply,</em>
<a id="L341" name="L341"></a> 341 <em class="comment">     * including the requirement that the lookup class must be either be in the</em>
<a id="L342" name="L342"></a> 342 <em class="comment">     * same package as the desired member, or must inherit that member.</em>
<a id="L343" name="L343"></a> 343 <em class="comment">     * (See the Java Virtual Machine Specification, sections 4.9.2, 5.4.3.5, and 6.4.)</em>
<a id="L344" name="L344"></a> 344 <em class="comment">     * In addition, if the desired member is a non-static field or method</em>
<a id="L345" name="L345"></a> 345 <em class="comment">     * in a different package, the resulting method handle may only be applied</em>
<a id="L346" name="L346"></a> 346 <em class="comment">     * to objects of the lookup class or one of its subclasses.</em>
<a id="L347" name="L347"></a> 347 <em class="comment">     * This requirement is enforced by narrowing the type of the leading</em>
<a id="L348" name="L348"></a> 348 <em class="comment">     * {@code this} parameter from {@code C}</em>
<a id="L349" name="L349"></a> 349 <em class="comment">     * (which will necessarily be a superclass of the lookup class)</em>
<a id="L350" name="L350"></a> 350 <em class="comment">     * to the lookup class itself.</em>
<a id="L351" name="L351"></a> 351 <em class="comment">     * </em>
<a id="L352" name="L352"></a> 352 <em class="comment">     * The JVM imposes a similar requirement on {@code invokespecial} instruction,</em>
<a id="L353" name="L353"></a> 353 <em class="comment">     * that the receiver argument must match both the resolved method <em>and</em></em>
<a id="L354" name="L354"></a> 354 <em class="comment">     * the current class.  Again, this requirement is enforced by narrowing the</em>
<a id="L355" name="L355"></a> 355 <em class="comment">     * type of the leading parameter to the resulting method handle.</em>
<a id="L356" name="L356"></a> 356 <em class="comment">     * (See the Java Virtual Machine Specification, section 4.10.1.9.)</em>
<a id="L357" name="L357"></a> 357 <em class="comment">     * </em>
<a id="L358" name="L358"></a> 358 <em class="comment">     * The JVM represents constructors and static initializer blocks as internal methods</em>
<a id="L359" name="L359"></a> 359 <em class="comment">     * with special names ({@code "<init>"} and {@code "<clinit>"}).</clinit></init></em>
<a id="L360" name="L360"></a> 360 <em class="comment">     * The internal syntax of invocation instructions allows them to refer to such internal</em>
<a id="L361" name="L361"></a> 361 <em class="comment">     * methods as if they were normal methods, but the JVM bytecode verifier rejects them.</em>
<a id="L362" name="L362"></a> 362 <em class="comment">     * A lookup of such an internal method will produce a {@code NoSuchMethodException}.</em>
<a id="L363" name="L363"></a> 363 <em class="comment">     * </em>
<a id="L364" name="L364"></a> 364 <em class="comment">     * In some cases, access between nested classes is obtained by the Java compiler by creating</em>
<a id="L365" name="L365"></a> 365 <em class="comment">     * an wrapper method to access a private method of another class</em>
<a id="L366" name="L366"></a> 366 <em class="comment">     * in the same top-level declaration.</em>
<a id="L367" name="L367"></a> 367 <em class="comment">     * For example, a nested class {@code C.D}</em>
<a id="L368" name="L368"></a> 368 <em class="comment">     * can access private members within other related classes such as</em>
<a id="L369" name="L369"></a> 369 <em class="comment">     * {@code C}, {@code C.D.E}, or {@code C.B},</em>
<a id="L370" name="L370"></a> 370 <em class="comment">     * but the Java compiler may need to generate wrapper methods in</em>
<a id="L371" name="L371"></a> 371 <em class="comment">     * those related classes.  In such cases, a {@code Lookup} object on</em>
<a id="L372" name="L372"></a> 372 <em class="comment">     * {@code C.E} would be unable to those private members.</em>
<a id="L373" name="L373"></a> 373 <em class="comment">     * A workaround for this limitation is the {@link Lookup#in Lookup.in} method,</em>
<a id="L374" name="L374"></a> 374 <em class="comment">     * which can transform a lookup on {@code C.E} into one on any of those other</em>
<a id="L375" name="L375"></a> 375 <em class="comment">     * classes, without special elevation of privilege.</em>
<a id="L376" name="L376"></a> 376 <em class="comment">     * </em>
<a id="L377" name="L377"></a> 377 <em class="comment">     * The accesses permitted to a given lookup object may be limited,</em>
<a id="L378" name="L378"></a> 378 <em class="comment">     * according to its set of {@link #lookupModes lookupModes},</em>
<a id="L379" name="L379"></a> 379 <em class="comment">     * to a subset of members normally accessible to the lookup class.</em>
<a id="L380" name="L380"></a> 380 <em class="comment">     * For example, the {@link MethodHandles#publicLookup publicLookup}</em>
<a id="L381" name="L381"></a> 381 <em class="comment">     * method produces a lookup object which is only allowed to access</em>
<a id="L382" name="L382"></a> 382 <em class="comment">     * public members in public classes.</em>
<a id="L383" name="L383"></a> 383 <em class="comment">     * The caller sensitive method {@link MethodHandles#lookup lookup}</em>
<a id="L384" name="L384"></a> 384 <em class="comment">     * produces a lookup object with full capabilities relative to</em>
<a id="L385" name="L385"></a> 385 <em class="comment">     * its caller class, to emulate all supported bytecode behaviors.</em>
<a id="L386" name="L386"></a> 386 <em class="comment">     * Also, the {@link Lookup#in Lookup.in} method may produce a lookup object</em>
<a id="L387" name="L387"></a> 387 <em class="comment">     * with fewer access modes than the original lookup object.</em>
<a id="L388" name="L388"></a> 388 <em class="comment">     *</em>
<a id="L389" name="L389"></a> 389 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L390" name="L390"></a> 390 <em class="comment">     * <a name="privacc"></a></em>
<a id="L391" name="L391"></a> 391 <em class="comment">     * <em>Discussion of private access:</em></em>
<a id="L392" name="L392"></a> 392 <em class="comment">     * We say that a lookup has <em>private access</em></em>
<a id="L393" name="L393"></a> 393 <em class="comment">     * if its {@linkplain #lookupModes lookup modes}</em>
<a id="L394" name="L394"></a> 394 <em class="comment">     * include the possibility of accessing {@code private} members.</em>
<a id="L395" name="L395"></a> 395 <em class="comment">     * As documented in the relevant methods elsewhere,</em>
<a id="L396" name="L396"></a> 396 <em class="comment">     * only lookups with private access possess the following capabilities:</em>
<a id="L397" name="L397"></a> 397 <em class="comment">     * <ul style="font-size:smaller;"></ul></em>
<a id="L398" name="L398"></a> 398 <em class="comment">     * <li>access private fields, methods, and constructors of the lookup class</li></em>
<a id="L399" name="L399"></a> 399 <em class="comment">     * <li>create method handles which invoke <a href="MethodHandles.Lookup.html#callsens">caller sensitive</a> methods,</li></em>
<a id="L400" name="L400"></a> 400 <em class="comment">     *     such as {@code Class.forName}</em>
<a id="L401" name="L401"></a> 401 <em class="comment">     * <li>create method handles which {@link Lookup#findSpecial emulate invokespecial} instructions</li></em>
<a id="L402" name="L402"></a> 402 <em class="comment">     * <li>avoid <a href="MethodHandles.Lookup.html#secmgr">package access checks</a></li></em>
<a id="L403" name="L403"></a> 403 <em class="comment">     *     for classes accessible to the lookup class</em>
<a id="L404" name="L404"></a> 404 <em class="comment">     * <li>create {@link Lookup#in delegated lookup objects} which have private access to other classes</li></em>
<a id="L405" name="L405"></a> 405 <em class="comment">     *     within the same package member</em>
<a id="L406" name="L406"></a> 406 <em class="comment">     * </em>
<a id="L407" name="L407"></a> 407 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L408" name="L408"></a> 408 <em class="comment">     * Each of these permissions is a consequence of the fact that a lookup object</em>
<a id="L409" name="L409"></a> 409 <em class="comment">     * with private access can be securely traced back to an originating class,</em>
<a id="L410" name="L410"></a> 410 <em class="comment">     * whose <a href="MethodHandles.Lookup.html#equiv">bytecode behaviors</a> and Java language access permissions</em>
<a id="L411" name="L411"></a> 411 <em class="comment">     * can be reliably determined and emulated by method handles.</em>
<a id="L412" name="L412"></a> 412 <em class="comment">     *</em>
<a id="L413" name="L413"></a> 413 <em class="comment">     * <h1><a name="secmgr"></a>Security manager interactions</h1></em>
<a id="L414" name="L414"></a> 414 <em class="comment">     * Although bytecode instructions can only refer to classes in</em>
<a id="L415" name="L415"></a> 415 <em class="comment">     * a related class loader, this API can search for methods in any</em>
<a id="L416" name="L416"></a> 416 <em class="comment">     * class, as long as a reference to its {@code Class} object is</em>
<a id="L417" name="L417"></a> 417 <em class="comment">     * available.  Such cross-loader references are also possible with the</em>
<a id="L418" name="L418"></a> 418 <em class="comment">     * Core Reflection API, and are impossible to bytecode instructions</em>
<a id="L419" name="L419"></a> 419 <em class="comment">     * such as {@code invokestatic} or {@code getfield}.</em>
<a id="L420" name="L420"></a> 420 <em class="comment">     * There is a {@linkplain java.lang.SecurityManager security manager API}</em>
<a id="L421" name="L421"></a> 421 <em class="comment">     * to allow applications to check such cross-loader references.</em>
<a id="L422" name="L422"></a> 422 <em class="comment">     * These checks apply to both the {@code MethodHandles.Lookup} API</em>
<a id="L423" name="L423"></a> 423 <em class="comment">     * and the Core Reflection API</em>
<a id="L424" name="L424"></a> 424 <em class="comment">     * (as found on {@link java.lang.Class Class}).</em>
<a id="L425" name="L425"></a> 425 <em class="comment">     * </em>
<a id="L426" name="L426"></a> 426 <em class="comment">     * If a security manager is present, member lookups are subject to</em>
<a id="L427" name="L427"></a> 427 <em class="comment">     * additional checks.</em>
<a id="L428" name="L428"></a> 428 <em class="comment">     * From one to three calls are made to the security manager.</em>
<a id="L429" name="L429"></a> 429 <em class="comment">     * Any of these calls can refuse access by throwing a</em>
<a id="L430" name="L430"></a> 430 <em class="comment">     * {@link java.lang.SecurityException SecurityException}.</em>
<a id="L431" name="L431"></a> 431 <em class="comment">     * Define {@code smgr} as the security manager,</em>
<a id="L432" name="L432"></a> 432 <em class="comment">     * {@code lookc} as the lookup class of the current lookup object,</em>
<a id="L433" name="L433"></a> 433 <em class="comment">     * {@code refc} as the containing class in which the member</em>
<a id="L434" name="L434"></a> 434 <em class="comment">     * is being sought, and {@code defc} as the class in which the</em>
<a id="L435" name="L435"></a> 435 <em class="comment">     * member is actually defined.</em>
<a id="L436" name="L436"></a> 436 <em class="comment">     * The value {@code lookc} is defined as <em>not present</em></em>
<a id="L437" name="L437"></a> 437 <em class="comment">     * if the current lookup object does not have</em>
<a id="L438" name="L438"></a> 438 <em class="comment">     * <a href="MethodHandles.Lookup.html#privacc">private access</a>.</em>
<a id="L439" name="L439"></a> 439 <em class="comment">     * The calls are made according to the following rules:</em>
<a id="L440" name="L440"></a> 440 <em class="comment">     * <ul></ul></em>
<a id="L441" name="L441"></a> 441 <em class="comment">     * <li><b>Step 1:</b></li></em>
<a id="L442" name="L442"></a> 442 <em class="comment">     *     If {@code lookc} is not present, or if its class loader is not</em>
<a id="L443" name="L443"></a> 443 <em class="comment">     *     the same as or an ancestor of the class loader of {@code refc},</em>
<a id="L444" name="L444"></a> 444 <em class="comment">     *     then {@link SecurityManager#checkPackageAccess</em>
<a id="L445" name="L445"></a> 445 <em class="comment">     *     smgr.checkPackageAccess(refcPkg)} is called,</em>
<a id="L446" name="L446"></a> 446 <em class="comment">     *     where {@code refcPkg} is the package of {@code refc}.</em>
<a id="L447" name="L447"></a> 447 <em class="comment">     * <li><b>Step 2:</b></li></em>
<a id="L448" name="L448"></a> 448 <em class="comment">     *     If the retrieved member is not public and</em>
<a id="L449" name="L449"></a> 449 <em class="comment">     *     {@code lookc} is not present, then</em>
<a id="L450" name="L450"></a> 450 <em class="comment">     *     {@link SecurityManager#checkPermission smgr.checkPermission}</em>
<a id="L451" name="L451"></a> 451 <em class="comment">     *     with {@code RuntimePermission("accessDeclaredMembers")} is called.</em>
<a id="L452" name="L452"></a> 452 <em class="comment">     * <li><b>Step 3:</b></li></em>
<a id="L453" name="L453"></a> 453 <em class="comment">     *     If the retrieved member is not public,</em>
<a id="L454" name="L454"></a> 454 <em class="comment">     *     and if {@code lookc} is not present,</em>
<a id="L455" name="L455"></a> 455 <em class="comment">     *     and if {@code defc} and {@code refc} are different,</em>
<a id="L456" name="L456"></a> 456 <em class="comment">     *     then {@link SecurityManager#checkPackageAccess</em>
<a id="L457" name="L457"></a> 457 <em class="comment">     *     smgr.checkPackageAccess(defcPkg)} is called,</em>
<a id="L458" name="L458"></a> 458 <em class="comment">     *     where {@code defcPkg} is the package of {@code defc}.</em>
<a id="L459" name="L459"></a> 459 <em class="comment">     * </em>
<a id="L460" name="L460"></a> 460 <em class="comment">     * Security checks are performed after other access checks have passed.</em>
<a id="L461" name="L461"></a> 461 <em class="comment">     * Therefore, the above rules presuppose a member that is public,</em>
<a id="L462" name="L462"></a> 462 <em class="comment">     * or else that is being accessed from a lookup class that has</em>
<a id="L463" name="L463"></a> 463 <em class="comment">     * rights to access the member.</em>
<a id="L464" name="L464"></a> 464 <em class="comment">     *</em>
<a id="L465" name="L465"></a> 465 <em class="comment">     * <h1><a name="callsens"></a>Caller sensitive methods</h1></em>
<a id="L466" name="L466"></a> 466 <em class="comment">     * A small number of Java methods have a special property called caller sensitivity.</em>
<a id="L467" name="L467"></a> 467 <em class="comment">     * A <em>caller-sensitive</em> method can behave differently depending on the</em>
<a id="L468" name="L468"></a> 468 <em class="comment">     * identity of its immediate caller.</em>
<a id="L469" name="L469"></a> 469 <em class="comment">     * </em>
<a id="L470" name="L470"></a> 470 <em class="comment">     * If a method handle for a caller-sensitive method is requested,</em>
<a id="L471" name="L471"></a> 471 <em class="comment">     * the general rules for <a href="MethodHandles.Lookup.html#equiv">bytecode behaviors</a> apply,</em>
<a id="L472" name="L472"></a> 472 <em class="comment">     * but they take account of the lookup class in a special way.</em>
<a id="L473" name="L473"></a> 473 <em class="comment">     * The resulting method handle behaves as if it were called</em>
<a id="L474" name="L474"></a> 474 <em class="comment">     * from an instruction contained in the lookup class,</em>
<a id="L475" name="L475"></a> 475 <em class="comment">     * so that the caller-sensitive method detects the lookup class.</em>
<a id="L476" name="L476"></a> 476 <em class="comment">     * (By contrast, the invoker of the method handle is disregarded.)</em>
<a id="L477" name="L477"></a> 477 <em class="comment">     * Thus, in the case of caller-sensitive methods,</em>
<a id="L478" name="L478"></a> 478 <em class="comment">     * different lookup classes may give rise to</em>
<a id="L479" name="L479"></a> 479 <em class="comment">     * differently behaving method handles.</em>
<a id="L480" name="L480"></a> 480 <em class="comment">     * </em>
<a id="L481" name="L481"></a> 481 <em class="comment">     * In cases where the lookup object is</em>
<a id="L482" name="L482"></a> 482 <em class="comment">     * {@link MethodHandles#publicLookup() publicLookup()},</em>
<a id="L483" name="L483"></a> 483 <em class="comment">     * or some other lookup object without</em>
<a id="L484" name="L484"></a> 484 <em class="comment">     * <a href="MethodHandles.Lookup.html#privacc">private access</a>,</em>
<a id="L485" name="L485"></a> 485 <em class="comment">     * the lookup class is disregarded.</em>
<a id="L486" name="L486"></a> 486 <em class="comment">     * In such cases, no caller-sensitive method handle can be created,</em>
<a id="L487" name="L487"></a> 487 <em class="comment">     * access is forbidden, and the lookup fails with an</em>
<a id="L488" name="L488"></a> 488 <em class="comment">     * {@code IllegalAccessException}.</em>
<a id="L489" name="L489"></a> 489 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L490" name="L490"></a> 490 <em class="comment">     * <em>Discussion:</em></em>
<a id="L491" name="L491"></a> 491 <em class="comment">     * For example, the caller-sensitive method</em>
<a id="L492" name="L492"></a> 492 <em class="comment">     * {@link java.lang.Class#forName(String) Class.forName(x)}</em>
<a id="L493" name="L493"></a> 493 <em class="comment">     * can return varying classes or throw varying exceptions,</em>
<a id="L494" name="L494"></a> 494 <em class="comment">     * depending on the class loader of the class that calls it.</em>
<a id="L495" name="L495"></a> 495 <em class="comment">     * A public lookup of {@code Class.forName} will fail, because</em>
<a id="L496" name="L496"></a> 496 <em class="comment">     * there is no reasonable way to determine its bytecode behavior.</em>
<a id="L497" name="L497"></a> 497 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L498" name="L498"></a> 498 <em class="comment">     * If an application caches method handles for broad sharing,</em>
<a id="L499" name="L499"></a> 499 <em class="comment">     * it should use {@code publicLookup()} to create them.</em>
<a id="L500" name="L500"></a> 500 <em class="comment">     * If there is a lookup of {@code Class.forName}, it will fail,</em>
<a id="L501" name="L501"></a> 501 <em class="comment">     * and the application must take appropriate action in that case.</em>
<a id="L502" name="L502"></a> 502 <em class="comment">     * It may be that a later lookup, perhaps during the invocation of a</em>
<a id="L503" name="L503"></a> 503 <em class="comment">     * bootstrap method, can incorporate the specific identity</em>
<a id="L504" name="L504"></a> 504 <em class="comment">     * of the caller, making the method accessible.</em>
<a id="L505" name="L505"></a> 505 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L506" name="L506"></a> 506 <em class="comment">     * The function {@code MethodHandles.lookup} is caller sensitive</em>
<a id="L507" name="L507"></a> 507 <em class="comment">     * so that there can be a secure foundation for lookups.</em>
<a id="L508" name="L508"></a> 508 <em class="comment">     * Nearly all other methods in the JSR 292 API rely on lookup</em>
<a id="L509" name="L509"></a> 509 <em class="comment">     * objects to check access requests.</em>
<a id="L510" name="L510"></a> 510 <em class="comment">     */</em>
<a id="L511" name="L511"></a> 511     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong>
<a id="L512" name="L512"></a> 512     <strong class="reserved">class</strong> <a href="../R/4792.html" title="Multiple referred from 36 places.">Lookup</a> <em class="brace">{</em>
<a id="L513" name="L513"></a> 513         <em class="comment">/** The class on behalf of whom the lookup is being performed. */</em>
<a id="L514" name="L514"></a> 514         <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L515" name="L515"></a> 515 
<a id="L516" name="L516"></a> 516         <em class="comment">/** The allowed sorts of members which may be looked up (PUBLIC, etc.). */</em>
<a id="L517" name="L517"></a> 517         <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> allowedModes;
<a id="L518" name="L518"></a> 518 
<a id="L519" name="L519"></a> 519         <em class="comment">/** A single-bit mask representing {@code public} access,</em>
<a id="L520" name="L520"></a> 520 <em class="comment">         *  which may contribute to the result of {@link #lookupModes lookupModes}.</em>
<a id="L521" name="L521"></a> 521 <em class="comment">         *  The value, {@code 0x01}, happens to be the same as the value of the</em>
<a id="L522" name="L522"></a> 522 <em class="comment">         *  {@code public} {@linkplain java.lang.reflect.Modifier#PUBLIC modifier bit}.</em>
<a id="L523" name="L523"></a> 523 <em class="comment">         */</em>
<a id="L524" name="L524"></a> 524         <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PUBLIC = <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PUBLIC;
<a id="L525" name="L525"></a> 525 
<a id="L526" name="L526"></a> 526         <em class="comment">/** A single-bit mask representing {@code private} access,</em>
<a id="L527" name="L527"></a> 527 <em class="comment">         *  which may contribute to the result of {@link #lookupModes lookupModes}.</em>
<a id="L528" name="L528"></a> 528 <em class="comment">         *  The value, {@code 0x02}, happens to be the same as the value of the</em>
<a id="L529" name="L529"></a> 529 <em class="comment">         *  {@code private} {@linkplain java.lang.reflect.Modifier#PRIVATE modifier bit}.</em>
<a id="L530" name="L530"></a> 530 <em class="comment">         */</em>
<a id="L531" name="L531"></a> 531         <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PRIVATE = <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PRIVATE;
<a id="L532" name="L532"></a> 532 
<a id="L533" name="L533"></a> 533         <em class="comment">/** A single-bit mask representing {@code protected} access,</em>
<a id="L534" name="L534"></a> 534 <em class="comment">         *  which may contribute to the result of {@link #lookupModes lookupModes}.</em>
<a id="L535" name="L535"></a> 535 <em class="comment">         *  The value, {@code 0x04}, happens to be the same as the value of the</em>
<a id="L536" name="L536"></a> 536 <em class="comment">         *  {@code protected} {@linkplain java.lang.reflect.Modifier#PROTECTED modifier bit}.</em>
<a id="L537" name="L537"></a> 537 <em class="comment">         */</em>
<a id="L538" name="L538"></a> 538         <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PROTECTED = <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PROTECTED;
<a id="L539" name="L539"></a> 539 
<a id="L540" name="L540"></a> 540         <em class="comment">/** A single-bit mask representing {@code package} access (default access),</em>
<a id="L541" name="L541"></a> 541 <em class="comment">         *  which may contribute to the result of {@link #lookupModes lookupModes}.</em>
<a id="L542" name="L542"></a> 542 <em class="comment">         *  The value is {@code 0x08}, which does not correspond meaningfully to</em>
<a id="L543" name="L543"></a> 543 <em class="comment">         *  any particular {@linkplain java.lang.reflect.Modifier modifier bit}.</em>
<a id="L544" name="L544"></a> 544 <em class="comment">         */</em>
<a id="L545" name="L545"></a> 545         <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PACKAGE = <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.STATIC;
<a id="L546" name="L546"></a> 546 
<a id="L547" name="L547"></a> 547         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> ALL_MODES = (PUBLIC | PRIVATE | PROTECTED | PACKAGE);
<a id="L548" name="L548"></a> 548         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> TRUSTED   = -1;
<a id="L549" name="L549"></a> 549 
<a id="L550" name="L550"></a> 550         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../S/1619.html#L1521" title="Referred from 1521 in src/java/lang/invoke/MethodHandles.java.">fixmods</a>(<strong class="reserved">int</strong> mods) <em class="brace">{</em>
<a id="L551" name="L551"></a> 551             mods &amp;= (ALL_MODES - PACKAGE);
<a id="L552" name="L552"></a> 552             <strong class="reserved">return</strong> (mods != 0) ? mods : PACKAGE;
<a id="L553" name="L553"></a> 553         <em class="brace">}</em>
<a id="L554" name="L554"></a> 554 
<a id="L555" name="L555"></a> 555         <em class="comment">/** Tells which class is performing the lookup.  It is this class against</em>
<a id="L556" name="L556"></a> 556 <em class="comment">         *  which checks are performed for visibility and access permissions.</em>
<a id="L557" name="L557"></a> 557 <em class="comment">         *  </em>
<a id="L558" name="L558"></a> 558 <em class="comment">         *  The class implies a maximum level of access permission,</em>
<a id="L559" name="L559"></a> 559 <em class="comment">         *  but the permissions may be additionally limited by the bitmask</em>
<a id="L560" name="L560"></a> 560 <em class="comment">         *  {@link #lookupModes lookupModes}, which controls whether non-public members</em>
<a id="L561" name="L561"></a> 561 <em class="comment">         *  can be accessed.</em>
<a id="L562" name="L562"></a> 562 <em class="comment">         *  @return the lookup class, on behalf of which this lookup object finds members</em>
<a id="L563" name="L563"></a> 563 <em class="comment">         */</em>
<a id="L564" name="L564"></a> 564         <strong class="reserved">public</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../R/22730.html" title="Multiple referred from 80 places.">lookupClass</a>() <em class="brace">{</em>
<a id="L565" name="L565"></a> 565             <strong class="reserved">return</strong> <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L566" name="L566"></a> 566         <em class="brace">}</em>
<a id="L567" name="L567"></a> 567 
<a id="L568" name="L568"></a> 568         <em class="comment">// This is just for calling out to MethodHandleImpl.</em>
<a id="L569" name="L569"></a> 569         <strong class="reserved">private</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../R/22731.html" title="Multiple referred from 5 places.">lookupClassOrNull</a>() <em class="brace">{</em>
<a id="L570" name="L570"></a> 570             <strong class="reserved">return</strong> (allowedModes == TRUSTED) ? <strong class="reserved">null</strong> : <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L571" name="L571"></a> 571         <em class="brace">}</em>
<a id="L572" name="L572"></a> 572 
<a id="L573" name="L573"></a> 573         <em class="comment">/** Tells which access-protection classes of members this lookup object can produce.</em>
<a id="L574" name="L574"></a> 574 <em class="comment">         *  The result is a bit-mask of the bits</em>
<a id="L575" name="L575"></a> 575 <em class="comment">         *  {@linkplain #PUBLIC PUBLIC (0x01)},</em>
<a id="L576" name="L576"></a> 576 <em class="comment">         *  {@linkplain #PRIVATE PRIVATE (0x02)},</em>
<a id="L577" name="L577"></a> 577 <em class="comment">         *  {@linkplain #PROTECTED PROTECTED (0x04)},</em>
<a id="L578" name="L578"></a> 578 <em class="comment">         *  and {@linkplain #PACKAGE PACKAGE (0x08)}.</em>
<a id="L579" name="L579"></a> 579 <em class="comment">         *  </em>
<a id="L580" name="L580"></a> 580 <em class="comment">         *  A freshly-created lookup object</em>
<a id="L581" name="L581"></a> 581 <em class="comment">         *  on the {@linkplain java.lang.invoke.MethodHandles#lookup() caller's class}</em>
<a id="L582" name="L582"></a> 582 <em class="comment">         *  has all possible bits set, since the caller class can access all its own members.</em>
<a id="L583" name="L583"></a> 583 <em class="comment">         *  A lookup object on a new lookup class</em>
<a id="L584" name="L584"></a> 584 <em class="comment">         *  {@linkplain java.lang.invoke.MethodHandles.Lookup#in created from a previous lookup object}</em>
<a id="L585" name="L585"></a> 585 <em class="comment">         *  may have some mode bits set to zero.</em>
<a id="L586" name="L586"></a> 586 <em class="comment">         *  The purpose of this is to restrict access via the new lookup object,</em>
<a id="L587" name="L587"></a> 587 <em class="comment">         *  so that it can access only names which can be reached by the original</em>
<a id="L588" name="L588"></a> 588 <em class="comment">         *  lookup object, and also by the new lookup class.</em>
<a id="L589" name="L589"></a> 589 <em class="comment">         *  @return the lookup modes, which limit the kinds of access performed by this lookup object</em>
<a id="L590" name="L590"></a> 590 <em class="comment">         */</em>
<a id="L591" name="L591"></a> 591         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/1624.html#L117" title="Referred from 117 in src/java/lang/invoke/AbstractValidatingLambdaMetafactory.java.">lookupModes</a>() <em class="brace">{</em>
<a id="L592" name="L592"></a> 592             <strong class="reserved">return</strong> allowedModes &amp; ALL_MODES;
<a id="L593" name="L593"></a> 593         <em class="brace">}</em>
<a id="L594" name="L594"></a> 594 
<a id="L595" name="L595"></a> 595         <em class="comment">/** Embody the current class (the lookupClass) as a lookup class</em>
<a id="L596" name="L596"></a> 596 <em class="comment">         * for method handle creation.</em>
<a id="L597" name="L597"></a> 597 <em class="comment">         * Must be called by from a method in this package,</em>
<a id="L598" name="L598"></a> 598 <em class="comment">         * which in turn is called by a method not in this package.</em>
<a id="L599" name="L599"></a> 599 <em class="comment">         */</em>
<a id="L600" name="L600"></a> 600         Lookup(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>) <em class="brace">{</em>
<a id="L601" name="L601"></a> 601             <strong class="reserved">this</strong>(<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, ALL_MODES);
<a id="L602" name="L602"></a> 602             <em class="comment">// make sure we haven't accidentally picked up a privileged class:</em>
<a id="L603" name="L603"></a> 603             <a href="../S/1619.html#L673" title="Defined at 673 in src/java/lang/invoke/MethodHandles.java.">checkUnprivilegedlookupClass</a>(<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, ALL_MODES);
<a id="L604" name="L604"></a> 604         <em class="brace">}</em>
<a id="L605" name="L605"></a> 605 
<a id="L606" name="L606"></a> 606         <strong class="reserved">private</strong> Lookup(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, <strong class="reserved">int</strong> allowedModes) <em class="brace">{</em>
<a id="L607" name="L607"></a> 607             <strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a> = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L608" name="L608"></a> 608             <strong class="reserved">this</strong>.allowedModes = allowedModes;
<a id="L609" name="L609"></a> 609         <em class="brace">}</em>
<a id="L610" name="L610"></a> 610 
<a id="L611" name="L611"></a> 611         <em class="comment">/**</em>
<a id="L612" name="L612"></a> 612 <em class="comment">         * Creates a lookup on the specified new lookup class.</em>
<a id="L613" name="L613"></a> 613 <em class="comment">         * The resulting object will report the specified</em>
<a id="L614" name="L614"></a> 614 <em class="comment">         * class as its own {@link #lookupClass lookupClass}.</em>
<a id="L615" name="L615"></a> 615 <em class="comment">         * </em>
<a id="L616" name="L616"></a> 616 <em class="comment">         * However, the resulting {@code Lookup} object is guaranteed</em>
<a id="L617" name="L617"></a> 617 <em class="comment">         * to have no more access capabilities than the original.</em>
<a id="L618" name="L618"></a> 618 <em class="comment">         * In particular, access capabilities can be lost as follows:<ul></ul></em>
<a id="L619" name="L619"></a> 619 <em class="comment">         * <li>If the new lookup class differs from the old one,</li></em>
<a id="L620" name="L620"></a> 620 <em class="comment">         * protected members will not be accessible by virtue of inheritance.</em>
<a id="L621" name="L621"></a> 621 <em class="comment">         * (Protected members may continue to be accessible because of package sharing.)</em>
<a id="L622" name="L622"></a> 622 <em class="comment">         * <li>If the new lookup class is in a different package</li></em>
<a id="L623" name="L623"></a> 623 <em class="comment">         * than the old one, protected and default (package) members will not be accessible.</em>
<a id="L624" name="L624"></a> 624 <em class="comment">         * <li>If the new lookup class is not within the same package member</li></em>
<a id="L625" name="L625"></a> 625 <em class="comment">         * as the old one, private members will not be accessible.</em>
<a id="L626" name="L626"></a> 626 <em class="comment">         * <li>If the new lookup class is not accessible to the old lookup class,</li></em>
<a id="L627" name="L627"></a> 627 <em class="comment">         * then no members, not even public members, will be accessible.</em>
<a id="L628" name="L628"></a> 628 <em class="comment">         * (In all other cases, public members will continue to be accessible.)</em>
<a id="L629" name="L629"></a> 629 <em class="comment">         * </em>
<a id="L630" name="L630"></a> 630 <em class="comment">         *</em>
<a id="L631" name="L631"></a> 631 <em class="comment">         * @param requestedLookupClass the desired lookup class for the new lookup object</em>
<a id="L632" name="L632"></a> 632 <em class="comment">         * @return a lookup object which reports the desired lookup class</em>
<a id="L633" name="L633"></a> 633 <em class="comment">         * @throws NullPointerException if the argument is null</em>
<a id="L634" name="L634"></a> 634 <em class="comment">         */</em>
<a id="L635" name="L635"></a> 635         <strong class="reserved">public</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../R/20446.html" title="Multiple referred from 2320 places.">in</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; requestedLookupClass) <em class="brace">{</em>
<a id="L636" name="L636"></a> 636             requestedLookupClass.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// null check</em>
<a id="L637" name="L637"></a> 637             <strong class="reserved">if</strong> (allowedModes == TRUSTED)  <em class="comment">// IMPL_LOOKUP can make any lookup at all</em>
<a id="L638" name="L638"></a> 638                 <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(requestedLookupClass, ALL_MODES);
<a id="L639" name="L639"></a> 639             <strong class="reserved">if</strong> (requestedLookupClass == <strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>)
<a id="L640" name="L640"></a> 640                 <strong class="reserved">return</strong> <strong class="reserved">this</strong>;  <em class="comment">// keep same capabilities</em>
<a id="L641" name="L641"></a> 641             <strong class="reserved">int</strong> newModes = (allowedModes &amp; (ALL_MODES &amp; ~PROTECTED));
<a id="L642" name="L642"></a> 642             <strong class="reserved">if</strong> ((newModes &amp; PACKAGE) != 0
<a id="L643" name="L643"></a> 643                 &amp;&amp; !VerifyAccess.isSamePackage(<strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, requestedLookupClass)) <em class="brace">{</em>
<a id="L644" name="L644"></a> 644                 newModes &amp;= ~(PACKAGE|PRIVATE);
<a id="L645" name="L645"></a> 645             <em class="brace">}</em>
<a id="L646" name="L646"></a> 646             <em class="comment">// Allow nestmate lookups to be created without special privilege:</em>
<a id="L647" name="L647"></a> 647             <strong class="reserved">if</strong> ((newModes &amp; PRIVATE) != 0
<a id="L648" name="L648"></a> 648                 &amp;&amp; !VerifyAccess.isSamePackageMember(<strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, requestedLookupClass)) <em class="brace">{</em>
<a id="L649" name="L649"></a> 649                 newModes &amp;= ~PRIVATE;
<a id="L650" name="L650"></a> 650             <em class="brace">}</em>
<a id="L651" name="L651"></a> 651             <strong class="reserved">if</strong> ((newModes &amp; PUBLIC) != 0
<a id="L652" name="L652"></a> 652                 &amp;&amp; !VerifyAccess.isClassAccessible(requestedLookupClass, <strong class="reserved">this</strong>.<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, allowedModes)) <em class="brace">{</em>
<a id="L653" name="L653"></a> 653                 <em class="comment">// The requested class it not accessible from the lookup class.</em>
<a id="L654" name="L654"></a> 654                 <em class="comment">// No permissions.</em>
<a id="L655" name="L655"></a> 655                 newModes = 0;
<a id="L656" name="L656"></a> 656             <em class="brace">}</em>
<a id="L657" name="L657"></a> 657             <a href="../S/1619.html#L673" title="Defined at 673 in src/java/lang/invoke/MethodHandles.java.">checkUnprivilegedlookupClass</a>(requestedLookupClass, newModes);
<a id="L658" name="L658"></a> 658             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(requestedLookupClass, newModes);
<a id="L659" name="L659"></a> 659         <em class="brace">}</em>
<a id="L660" name="L660"></a> 660 
<a id="L661" name="L661"></a> 661         <em class="comment">// Make sure outer class is initialized first.</em>
<a id="L662" name="L662"></a> 662         <strong class="reserved">static</strong> <em class="brace">{</em> IMPL_NAMES.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>(); <em class="brace">}</em>
<a id="L663" name="L663"></a> 663 
<a id="L664" name="L664"></a> 664         <em class="comment">/** Version of lookup which is trusted minimally.</em>
<a id="L665" name="L665"></a> 665 <em class="comment">         *  It can only be used to create method handles to</em>
<a id="L666" name="L666"></a> 666 <em class="comment">         *  publicly accessible members.</em>
<a id="L667" name="L667"></a> 667 <em class="comment">         */</em>
<a id="L668" name="L668"></a> 668         <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> PUBLIC_LOOKUP = <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>, PUBLIC);
<a id="L669" name="L669"></a> 669 
<a id="L670" name="L670"></a> 670         <em class="comment">/** Package-private version of lookup which is trusted. */</em>
<a id="L671" name="L671"></a> 671         <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> IMPL_LOOKUP = <strong class="reserved">new</strong> <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>, TRUSTED);
<a id="L672" name="L672"></a> 672 
<a id="L673" name="L673"></a> 673         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/11393.html" title="Multiple referred from 2 places.">checkUnprivilegedlookupClass</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, <strong class="reserved">int</strong> allowedModes) <em class="brace">{</em>
<a id="L674" name="L674"></a> 674             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L675" name="L675"></a> 675             <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("java.lang.invoke."))
<a id="L676" name="L676"></a> 676                 <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("illegal lookupClass: "+<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>);
<a id="L677" name="L677"></a> 677 
<a id="L678" name="L678"></a> 678             <em class="comment">// For caller-sensitive MethodHandles.lookup()</em>
<a id="L679" name="L679"></a> 679             <em class="comment">// disallow lookup more restricted packages</em>
<a id="L680" name="L680"></a> 680             <strong class="reserved">if</strong> (allowedModes == ALL_MODES &amp;&amp; <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>.<a href="../D/17691.html" title="Multiple defined in 20 places.">getClassLoader</a>() == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L681" name="L681"></a> 681                 <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("java.") ||
<a id="L682" name="L682"></a> 682                         (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("sun.") &amp;&amp; !<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("sun.invoke."))) <em class="brace">{</em>
<a id="L683" name="L683"></a> 683                     <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("illegal lookupClass: " + <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>);
<a id="L684" name="L684"></a> 684                 <em class="brace">}</em>
<a id="L685" name="L685"></a> 685             <em class="brace">}</em>
<a id="L686" name="L686"></a> 686         <em class="brace">}</em>
<a id="L687" name="L687"></a> 687 
<a id="L688" name="L688"></a> 688         <em class="comment">/**</em>
<a id="L689" name="L689"></a> 689 <em class="comment">         * Displays the name of the class from which lookups are to be made.</em>
<a id="L690" name="L690"></a> 690 <em class="comment">         * (The name is the one reported by {@link java.lang.Class#getName() Class.getName}.)</em>
<a id="L691" name="L691"></a> 691 <em class="comment">         * If there are restrictions on the access permitted to this lookup,</em>
<a id="L692" name="L692"></a> 692 <em class="comment">         * this is indicated by adding a suffix to the class name, consisting</em>
<a id="L693" name="L693"></a> 693 <em class="comment">         * of a slash and a keyword.  The keyword represents the strongest</em>
<a id="L694" name="L694"></a> 694 <em class="comment">         * allowed access, and is chosen as follows:</em>
<a id="L695" name="L695"></a> 695 <em class="comment">         * <ul></ul></em>
<a id="L696" name="L696"></a> 696 <em class="comment">         * <li>If no access is allowed, the suffix is "/noaccess".</li></em>
<a id="L697" name="L697"></a> 697 <em class="comment">         * <li>If only public access is allowed, the suffix is "/public".</li></em>
<a id="L698" name="L698"></a> 698 <em class="comment">         * <li>If only public and package access are allowed, the suffix is "/package".</li></em>
<a id="L699" name="L699"></a> 699 <em class="comment">         * <li>If only public, package, and private access are allowed, the suffix is "/private".</li></em>
<a id="L700" name="L700"></a> 700 <em class="comment">         * </em>
<a id="L701" name="L701"></a> 701 <em class="comment">         * If none of the above cases apply, it is the case that full</em>
<a id="L702" name="L702"></a> 702 <em class="comment">         * access (public, package, private, and protected) is allowed.</em>
<a id="L703" name="L703"></a> 703 <em class="comment">         * In this case, no suffix is added.</em>
<a id="L704" name="L704"></a> 704 <em class="comment">         * This is true only of an object obtained originally from</em>
<a id="L705" name="L705"></a> 705 <em class="comment">         * {@link java.lang.invoke.MethodHandles#lookup MethodHandles.lookup}.</em>
<a id="L706" name="L706"></a> 706 <em class="comment">         * Objects created by {@link java.lang.invoke.MethodHandles.Lookup#in Lookup.in}</em>
<a id="L707" name="L707"></a> 707 <em class="comment">         * always have restricted access, and will display a suffix.</em>
<a id="L708" name="L708"></a> 708 <em class="comment">         * </em>
<a id="L709" name="L709"></a> 709 <em class="comment">         * (It may seem strange that protected access should be</em>
<a id="L710" name="L710"></a> 710 <em class="comment">         * stronger than private access.  Viewed independently from</em>
<a id="L711" name="L711"></a> 711 <em class="comment">         * package access, protected access is the first to be lost,</em>
<a id="L712" name="L712"></a> 712 <em class="comment">         * because it requires a direct subclass relationship between</em>
<a id="L713" name="L713"></a> 713 <em class="comment">         * caller and callee.)</em>
<a id="L714" name="L714"></a> 714 <em class="comment">         * @see #in</em>
<a id="L715" name="L715"></a> 715 <em class="comment">         */</em>
<a id="L716" name="L716"></a> 716         @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L717" name="L717"></a> 717         <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L718" name="L718"></a> 718             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> cname = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L719" name="L719"></a> 719             <strong class="reserved">switch</strong> (allowedModes) <em class="brace">{</em>
<a id="L720" name="L720"></a> 720             <strong class="reserved">case</strong> 0:  <em class="comment">// no privileges</em>
<a id="L721" name="L721"></a> 721                 <strong class="reserved">return</strong> cname + "/noaccess";
<a id="L722" name="L722"></a> 722             <strong class="reserved">case</strong> PUBLIC:
<a id="L723" name="L723"></a> 723                 <strong class="reserved">return</strong> cname + "/public";
<a id="L724" name="L724"></a> 724             <strong class="reserved">case</strong> PUBLIC|PACKAGE:
<a id="L725" name="L725"></a> 725                 <strong class="reserved">return</strong> cname + "/package";
<a id="L726" name="L726"></a> 726             <strong class="reserved">case</strong> ALL_MODES &amp; ~PROTECTED:
<a id="L727" name="L727"></a> 727                 <strong class="reserved">return</strong> cname + "/private";
<a id="L728" name="L728"></a> 728             <strong class="reserved">case</strong> ALL_MODES:
<a id="L729" name="L729"></a> 729                 <strong class="reserved">return</strong> cname;
<a id="L730" name="L730"></a> 730             <strong class="reserved">case</strong> TRUSTED:
<a id="L731" name="L731"></a> 731                 <strong class="reserved">return</strong> "/trusted";  <em class="comment">// internal only; not exported</em>
<a id="L732" name="L732"></a> 732             <strong class="reserved">default</strong>:  <em class="comment">// Should not happen, but it's a bitfield...</em>
<a id="L733" name="L733"></a> 733                 cname = cname + "/" + <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35410.html" title="Multiple defined in 5 places.">toHexString</a>(allowedModes);
<a id="L734" name="L734"></a> 734                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<strong class="reserved">false</strong>) : cname;
<a id="L735" name="L735"></a> 735                 <strong class="reserved">return</strong> cname;
<a id="L736" name="L736"></a> 736             <em class="brace">}</em>
<a id="L737" name="L737"></a> 737         <em class="brace">}</em>
<a id="L738" name="L738"></a> 738 
<a id="L739" name="L739"></a> 739         <em class="comment">/**</em>
<a id="L740" name="L740"></a> 740 <em class="comment">         * Produces a method handle for a static method.</em>
<a id="L741" name="L741"></a> 741 <em class="comment">         * The type of the method handle will be that of the method.</em>
<a id="L742" name="L742"></a> 742 <em class="comment">         * (Since static methods do not take receivers, there is no</em>
<a id="L743" name="L743"></a> 743 <em class="comment">         * additional receiver argument inserted into the method handle type,</em>
<a id="L744" name="L744"></a> 744 <em class="comment">         * as there would be with {@link #findVirtual findVirtual} or {@link #findSpecial findSpecial}.)</em>
<a id="L745" name="L745"></a> 745 <em class="comment">         * The method and all its argument types must be accessible to the lookup object.</em>
<a id="L746" name="L746"></a> 746 <em class="comment">         * </em>
<a id="L747" name="L747"></a> 747 <em class="comment">         * The returned method handle will have</em>
<a id="L748" name="L748"></a> 748 <em class="comment">         * {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if</em>
<a id="L749" name="L749"></a> 749 <em class="comment">         * the method's variable arity modifier bit ({@code 0x0080}) is set.</em>
<a id="L750" name="L750"></a> 750 <em class="comment">         * </em>
<a id="L751" name="L751"></a> 751 <em class="comment">         * If the returned method handle is invoked, the method's class will</em>
<a id="L752" name="L752"></a> 752 <em class="comment">         * be initialized, if it has not already been initialized.</em>
<a id="L753" name="L753"></a> 753 <em class="comment">         * <b>Example:</b></em>
<a id="L754" name="L754"></a> 754 <em class="comment">         * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L755" name="L755"></a> 755 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L756" name="L756"></a> 756 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L757" name="L757"></a> 757 <em class="comment">...</em>
<a id="L758" name="L758"></a> 758 <em class="comment">MethodHandle MH_asList = publicLookup().findStatic(Arrays.class,</em>
<a id="L759" name="L759"></a> 759 <em class="comment">  "asList", methodType(List.class, Object[].class));</em>
<a id="L760" name="L760"></a> 760 <em class="comment">assertEquals("[x, y]", MH_asList.invoke("x", "y").toString());</em>
<a id="L761" name="L761"></a> 761 <em class="comment">         * }</em>
<a id="L762" name="L762"></a> 762 <em class="comment">         * @param refc the class from which the method is accessed</em>
<a id="L763" name="L763"></a> 763 <em class="comment">         * @param name the name of the method</em>
<a id="L764" name="L764"></a> 764 <em class="comment">         * @param type the type of the method</em>
<a id="L765" name="L765"></a> 765 <em class="comment">         * @return the desired method handle</em>
<a id="L766" name="L766"></a> 766 <em class="comment">         * @throws NoSuchMethodException if the method does not exist</em>
<a id="L767" name="L767"></a> 767 <em class="comment">         * @throws IllegalAccessException if access checking fails,</em>
<a id="L768" name="L768"></a> 768 <em class="comment">         *                                or if the method is not {@code static},</em>
<a id="L769" name="L769"></a> 769 <em class="comment">         *                                or if the method's variable arity modifier bit</em>
<a id="L770" name="L770"></a> 770 <em class="comment">         *                                is set and {@code asVarargsCollector} fails</em>
<a id="L771" name="L771"></a> 771 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L772" name="L772"></a> 772 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L773" name="L773"></a> 773 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L774" name="L774"></a> 774 <em class="comment">         */</em>
<a id="L775" name="L775"></a> 775         <strong class="reserved">public</strong>
<a id="L776" name="L776"></a> 776         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14484.html" title="Multiple referred from 14 places.">findStatic</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L777" name="L777"></a> 777             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_invokeStatic, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L778" name="L778"></a> 778             <strong class="reserved">return</strong> <a href="../S/1619.html#L1598" title="Defined at 1598 in src/java/lang/invoke/MethodHandles.java.">getDirectMethod</a>(REF_invokeStatic, refc, method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L779" name="L779"></a> 779         <em class="brace">}</em>
<a id="L780" name="L780"></a> 780 
<a id="L781" name="L781"></a> 781         <em class="comment">/**</em>
<a id="L782" name="L782"></a> 782 <em class="comment">         * Produces a method handle for a virtual method.</em>
<a id="L783" name="L783"></a> 783 <em class="comment">         * The type of the method handle will be that of the method,</em>
<a id="L784" name="L784"></a> 784 <em class="comment">         * with the receiver type (usually {@code refc}) prepended.</em>
<a id="L785" name="L785"></a> 785 <em class="comment">         * The method and all its argument types must be accessible to the lookup object.</em>
<a id="L786" name="L786"></a> 786 <em class="comment">         * </em>
<a id="L787" name="L787"></a> 787 <em class="comment">         * When called, the handle will treat the first argument as a receiver</em>
<a id="L788" name="L788"></a> 788 <em class="comment">         * and dispatch on the receiver's type to determine which method</em>
<a id="L789" name="L789"></a> 789 <em class="comment">         * implementation to enter.</em>
<a id="L790" name="L790"></a> 790 <em class="comment">         * (The dispatching action is identical with that performed by an</em>
<a id="L791" name="L791"></a> 791 <em class="comment">         * {@code invokevirtual} or {@code invokeinterface} instruction.)</em>
<a id="L792" name="L792"></a> 792 <em class="comment">         * </em>
<a id="L793" name="L793"></a> 793 <em class="comment">         * The first argument will be of type {@code refc} if the lookup</em>
<a id="L794" name="L794"></a> 794 <em class="comment">         * class has full privileges to access the member.  Otherwise</em>
<a id="L795" name="L795"></a> 795 <em class="comment">         * the member must be {@code protected} and the first argument</em>
<a id="L796" name="L796"></a> 796 <em class="comment">         * will be restricted in type to the lookup class.</em>
<a id="L797" name="L797"></a> 797 <em class="comment">         * </em>
<a id="L798" name="L798"></a> 798 <em class="comment">         * The returned method handle will have</em>
<a id="L799" name="L799"></a> 799 <em class="comment">         * {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if</em>
<a id="L800" name="L800"></a> 800 <em class="comment">         * the method's variable arity modifier bit ({@code 0x0080}) is set.</em>
<a id="L801" name="L801"></a> 801 <em class="comment">         * </em>
<a id="L802" name="L802"></a> 802 <em class="comment">         * Because of the general <a href="MethodHandles.Lookup.html#equiv">equivalence</a> between {@code invokevirtual}</em>
<a id="L803" name="L803"></a> 803 <em class="comment">         * instructions and method handles produced by {@code findVirtual},</em>
<a id="L804" name="L804"></a> 804 <em class="comment">         * if the class is {@code MethodHandle} and the name string is</em>
<a id="L805" name="L805"></a> 805 <em class="comment">         * {@code invokeExact} or {@code invoke}, the resulting</em>
<a id="L806" name="L806"></a> 806 <em class="comment">         * method handle is equivalent to one produced by</em>
<a id="L807" name="L807"></a> 807 <em class="comment">         * {@link java.lang.invoke.MethodHandles#exactInvoker MethodHandles.exactInvoker} or</em>
<a id="L808" name="L808"></a> 808 <em class="comment">         * {@link java.lang.invoke.MethodHandles#invoker MethodHandles.invoker}</em>
<a id="L809" name="L809"></a> 809 <em class="comment">         * with the same {@code type} argument.</em>
<a id="L810" name="L810"></a> 810 <em class="comment">         *</em>
<a id="L811" name="L811"></a> 811 <em class="comment">         * <b>Example:</b></em>
<a id="L812" name="L812"></a> 812 <em class="comment">         * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L813" name="L813"></a> 813 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L814" name="L814"></a> 814 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L815" name="L815"></a> 815 <em class="comment">...</em>
<a id="L816" name="L816"></a> 816 <em class="comment">MethodHandle MH_concat = publicLookup().findVirtual(String.class,</em>
<a id="L817" name="L817"></a> 817 <em class="comment">  "concat", methodType(String.class, String.class));</em>
<a id="L818" name="L818"></a> 818 <em class="comment">MethodHandle MH_hashCode = publicLookup().findVirtual(Object.class,</em>
<a id="L819" name="L819"></a> 819 <em class="comment">  "hashCode", methodType(int.class));</em>
<a id="L820" name="L820"></a> 820 <em class="comment">MethodHandle MH_hashCode_String = publicLookup().findVirtual(String.class,</em>
<a id="L821" name="L821"></a> 821 <em class="comment">  "hashCode", methodType(int.class));</em>
<a id="L822" name="L822"></a> 822 <em class="comment">assertEquals("xy", (String) MH_concat.invokeExact("x", "y"));</em>
<a id="L823" name="L823"></a> 823 <em class="comment">assertEquals("xy".hashCode(), (int) MH_hashCode.invokeExact((Object)"xy"));</em>
<a id="L824" name="L824"></a> 824 <em class="comment">assertEquals("xy".hashCode(), (int) MH_hashCode_String.invokeExact("xy"));</em>
<a id="L825" name="L825"></a> 825 <em class="comment">// interface method:</em>
<a id="L826" name="L826"></a> 826 <em class="comment">MethodHandle MH_subSequence = publicLookup().findVirtual(CharSequence.class,</em>
<a id="L827" name="L827"></a> 827 <em class="comment">  "subSequence", methodType(CharSequence.class, int.class, int.class));</em>
<a id="L828" name="L828"></a> 828 <em class="comment">assertEquals("def", MH_subSequence.invoke("abcdefghi", 3, 6).toString());</em>
<a id="L829" name="L829"></a> 829 <em class="comment">// constructor "internal method" must be accessed differently:</em>
<a id="L830" name="L830"></a> 830 <em class="comment">MethodType MT_newString = methodType(void.class); //()V for new String()</em>
<a id="L831" name="L831"></a> 831 <em class="comment">try { assertEquals("impossible", lookup()</em>
<a id="L832" name="L832"></a> 832 <em class="comment">        .findVirtual(String.class, "<init>", MT_newString));</init></em>
<a id="L833" name="L833"></a> 833 <em class="comment"> } catch (NoSuchMethodException ex) { } // OK</em>
<a id="L834" name="L834"></a> 834 <em class="comment">MethodHandle MH_newString = publicLookup()</em>
<a id="L835" name="L835"></a> 835 <em class="comment">  .findConstructor(String.class, MT_newString);</em>
<a id="L836" name="L836"></a> 836 <em class="comment">assertEquals("", (String) MH_newString.invokeExact());</em>
<a id="L837" name="L837"></a> 837 <em class="comment">         * }</em>
<a id="L838" name="L838"></a> 838 <em class="comment">         *</em>
<a id="L839" name="L839"></a> 839 <em class="comment">         * @param refc the class or interface from which the method is accessed</em>
<a id="L840" name="L840"></a> 840 <em class="comment">         * @param name the name of the method</em>
<a id="L841" name="L841"></a> 841 <em class="comment">         * @param type the type of the method, with the receiver argument omitted</em>
<a id="L842" name="L842"></a> 842 <em class="comment">         * @return the desired method handle</em>
<a id="L843" name="L843"></a> 843 <em class="comment">         * @throws NoSuchMethodException if the method does not exist</em>
<a id="L844" name="L844"></a> 844 <em class="comment">         * @throws IllegalAccessException if access checking fails,</em>
<a id="L845" name="L845"></a> 845 <em class="comment">         *                                or if the method is {@code static}</em>
<a id="L846" name="L846"></a> 846 <em class="comment">         *                                or if the method's variable arity modifier bit</em>
<a id="L847" name="L847"></a> 847 <em class="comment">         *                                is set and {@code asVarargsCollector} fails</em>
<a id="L848" name="L848"></a> 848 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L849" name="L849"></a> 849 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L850" name="L850"></a> 850 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L851" name="L851"></a> 851 <em class="comment">         */</em>
<a id="L852" name="L852"></a> 852         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14501.html" title="Multiple referred from 2 places.">findVirtual</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L853" name="L853"></a> 853             <strong class="reserved">if</strong> (refc == <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L854" name="L854"></a> 854                 <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = <a href="../S/1619.html#L861" title="Defined at 861 in src/java/lang/invoke/MethodHandles.java.">findVirtualForMH</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L855" name="L855"></a> 855                 <strong class="reserved">if</strong> (mh != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> mh;
<a id="L856" name="L856"></a> 856             <em class="brace">}</em>
<a id="L857" name="L857"></a> 857             <strong class="reserved">byte</strong> refKind = (refc.<a href="../D/25735.html" title="Multiple defined in 6 places.">isInterface</a>() ? REF_invokeInterface : REF_invokeVirtual);
<a id="L858" name="L858"></a> 858             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L859" name="L859"></a> 859             <strong class="reserved">return</strong> <a href="../S/1619.html#L1598" title="Defined at 1598 in src/java/lang/invoke/MethodHandles.java.">getDirectMethod</a>(refKind, refc, method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L860" name="L860"></a> 860         <em class="brace">}</em>
<a id="L861" name="L861"></a> 861         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14502.html" title="Multiple referred from 2 places.">findVirtualForMH</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L862" name="L862"></a> 862             <em class="comment">// these names require special lookups because of the implicit MethodType argument</em>
<a id="L863" name="L863"></a> 863             <strong class="reserved">if</strong> ("invoke".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>))
<a id="L864" name="L864"></a> 864                 <strong class="reserved">return</strong> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L865" name="L865"></a> 865             <strong class="reserved">if</strong> ("invokeExact".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>))
<a id="L866" name="L866"></a> 866                 <strong class="reserved">return</strong> <a href="../D/15761.html" title="Multiple defined in 2 places.">exactInvoker</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L867" name="L867"></a> 867             <strong class="reserved">if</strong> ("invokeBasic".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>))
<a id="L868" name="L868"></a> 868                 <strong class="reserved">return</strong> <a href="../D/11784.html" title="Multiple defined in 2 places.">basicInvoker</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L869" name="L869"></a> 869             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../S/1611.html#L355" title="Defined at 355 in src/java/lang/invoke/MemberName.java.">isMethodHandleInvokeName</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>));
<a id="L870" name="L870"></a> 870             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L871" name="L871"></a> 871         <em class="brace">}</em>
<a id="L872" name="L872"></a> 872 
<a id="L873" name="L873"></a> 873         <em class="comment">/**</em>
<a id="L874" name="L874"></a> 874 <em class="comment">         * Produces a method handle which creates an object and initializes it, using</em>
<a id="L875" name="L875"></a> 875 <em class="comment">         * the constructor of the specified type.</em>
<a id="L876" name="L876"></a> 876 <em class="comment">         * The parameter types of the method handle will be those of the constructor,</em>
<a id="L877" name="L877"></a> 877 <em class="comment">         * while the return type will be a reference to the constructor's class.</em>
<a id="L878" name="L878"></a> 878 <em class="comment">         * The constructor and all its argument types must be accessible to the lookup object.</em>
<a id="L879" name="L879"></a> 879 <em class="comment">         * </em>
<a id="L880" name="L880"></a> 880 <em class="comment">         * The requested type must have a return type of {@code void}.</em>
<a id="L881" name="L881"></a> 881 <em class="comment">         * (This is consistent with the JVM's treatment of constructor type descriptors.)</em>
<a id="L882" name="L882"></a> 882 <em class="comment">         * </em>
<a id="L883" name="L883"></a> 883 <em class="comment">         * The returned method handle will have</em>
<a id="L884" name="L884"></a> 884 <em class="comment">         * {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if</em>
<a id="L885" name="L885"></a> 885 <em class="comment">         * the constructor's variable arity modifier bit ({@code 0x0080}) is set.</em>
<a id="L886" name="L886"></a> 886 <em class="comment">         * </em>
<a id="L887" name="L887"></a> 887 <em class="comment">         * If the returned method handle is invoked, the constructor's class will</em>
<a id="L888" name="L888"></a> 888 <em class="comment">         * be initialized, if it has not already been initialized.</em>
<a id="L889" name="L889"></a> 889 <em class="comment">         * <b>Example:</b></em>
<a id="L890" name="L890"></a> 890 <em class="comment">         * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L891" name="L891"></a> 891 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L892" name="L892"></a> 892 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L893" name="L893"></a> 893 <em class="comment">...</em>
<a id="L894" name="L894"></a> 894 <em class="comment">MethodHandle MH_newArrayList = publicLookup().findConstructor(</em>
<a id="L895" name="L895"></a> 895 <em class="comment">  ArrayList.class, methodType(void.class, Collection.class));</em>
<a id="L896" name="L896"></a> 896 <em class="comment">Collection orig = Arrays.asList("x", "y");</em>
<a id="L897" name="L897"></a> 897 <em class="comment">Collection copy = (ArrayList) MH_newArrayList.invokeExact(orig);</em>
<a id="L898" name="L898"></a> 898 <em class="comment">assert(orig != copy);</em>
<a id="L899" name="L899"></a> 899 <em class="comment">assertEquals(orig, copy);</em>
<a id="L900" name="L900"></a> 900 <em class="comment">// a variable-arity constructor:</em>
<a id="L901" name="L901"></a> 901 <em class="comment">MethodHandle MH_newProcessBuilder = publicLookup().findConstructor(</em>
<a id="L902" name="L902"></a> 902 <em class="comment">  ProcessBuilder.class, methodType(void.class, String[].class));</em>
<a id="L903" name="L903"></a> 903 <em class="comment">ProcessBuilder pb = (ProcessBuilder)</em>
<a id="L904" name="L904"></a> 904 <em class="comment">  MH_newProcessBuilder.invoke("x", "y", "z");</em>
<a id="L905" name="L905"></a> 905 <em class="comment">assertEquals("[x, y, z]", pb.command().toString());</em>
<a id="L906" name="L906"></a> 906 <em class="comment">         * }</em>
<a id="L907" name="L907"></a> 907 <em class="comment">         * @param refc the class or interface from which the method is accessed</em>
<a id="L908" name="L908"></a> 908 <em class="comment">         * @param type the type of the method, with the receiver argument omitted, and a void return type</em>
<a id="L909" name="L909"></a> 909 <em class="comment">         * @return the desired method handle</em>
<a id="L910" name="L910"></a> 910 <em class="comment">         * @throws NoSuchMethodException if the constructor does not exist</em>
<a id="L911" name="L911"></a> 911 <em class="comment">         * @throws IllegalAccessException if access checking fails</em>
<a id="L912" name="L912"></a> 912 <em class="comment">         *                                or if the method's variable arity modifier bit</em>
<a id="L913" name="L913"></a> 913 <em class="comment">         *                                is set and {@code asVarargsCollector} fails</em>
<a id="L914" name="L914"></a> 914 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L915" name="L915"></a> 915 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L916" name="L916"></a> 916 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L917" name="L917"></a> 917 <em class="comment">         */</em>
<a id="L918" name="L918"></a> 918         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14364.html" title="Multiple referred from 3 places.">findConstructor</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L919" name="L919"></a> 919             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = "&lt;init&gt;";
<a id="L920" name="L920"></a> 920             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_newInvokeSpecial, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L921" name="L921"></a> 921             <strong class="reserved">return</strong> <a href="../S/1619.html#L1706" title="Defined at 1706 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructor</a>(refc, ctor);
<a id="L922" name="L922"></a> 922         <em class="brace">}</em>
<a id="L923" name="L923"></a> 923 
<a id="L924" name="L924"></a> 924         <em class="comment">/**</em>
<a id="L925" name="L925"></a> 925 <em class="comment">         * Produces an early-bound method handle for a virtual method.</em>
<a id="L926" name="L926"></a> 926 <em class="comment">         * It will bypass checks for overriding methods on the receiver,</em>
<a id="L927" name="L927"></a> 927 <em class="comment">         * <a href="MethodHandles.Lookup.html#equiv">as if called</a> from an {@code invokespecial}</em>
<a id="L928" name="L928"></a> 928 <em class="comment">         * instruction from within the explicitly specified {@code specialCaller}.</em>
<a id="L929" name="L929"></a> 929 <em class="comment">         * The type of the method handle will be that of the method,</em>
<a id="L930" name="L930"></a> 930 <em class="comment">         * with a suitably restricted receiver type prepended.</em>
<a id="L931" name="L931"></a> 931 <em class="comment">         * (The receiver type will be {@code specialCaller} or a subtype.)</em>
<a id="L932" name="L932"></a> 932 <em class="comment">         * The method and all its argument types must be accessible</em>
<a id="L933" name="L933"></a> 933 <em class="comment">         * to the lookup object.</em>
<a id="L934" name="L934"></a> 934 <em class="comment">         * </em>
<a id="L935" name="L935"></a> 935 <em class="comment">         * Before method resolution,</em>
<a id="L936" name="L936"></a> 936 <em class="comment">         * if the explicitly specified caller class is not identical with the</em>
<a id="L937" name="L937"></a> 937 <em class="comment">         * lookup class, or if this lookup object does not have</em>
<a id="L938" name="L938"></a> 938 <em class="comment">         * <a href="MethodHandles.Lookup.html#privacc">private access</a></em>
<a id="L939" name="L939"></a> 939 <em class="comment">         * privileges, the access fails.</em>
<a id="L940" name="L940"></a> 940 <em class="comment">         * </em>
<a id="L941" name="L941"></a> 941 <em class="comment">         * The returned method handle will have</em>
<a id="L942" name="L942"></a> 942 <em class="comment">         * {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if</em>
<a id="L943" name="L943"></a> 943 <em class="comment">         * the method's variable arity modifier bit ({@code 0x0080}) is set.</em>
<a id="L944" name="L944"></a> 944 <em class="comment">         * <p style="font-size:smaller;"></p></em>
<a id="L945" name="L945"></a> 945 <em class="comment">         * <em>(Note:  JVM internal methods named {@code "<init>"} are not visible to this API,</init></em></em>
<a id="L946" name="L946"></a> 946 <em class="comment">         * even though the {@code invokespecial} instruction can refer to them</em>
<a id="L947" name="L947"></a> 947 <em class="comment">         * in special circumstances.  Use {@link #findConstructor findConstructor}</em>
<a id="L948" name="L948"></a> 948 <em class="comment">         * to access instance initialization methods in a safe manner.)</em>
<a id="L949" name="L949"></a> 949 <em class="comment">         * <b>Example:</b></em>
<a id="L950" name="L950"></a> 950 <em class="comment">         * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L951" name="L951"></a> 951 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L952" name="L952"></a> 952 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L953" name="L953"></a> 953 <em class="comment">...</em>
<a id="L954" name="L954"></a> 954 <em class="comment">static class Listie extends ArrayList {</em>
<a id="L955" name="L955"></a> 955 <em class="comment">  public String toString() { return "[wee Listie]"; }</em>
<a id="L956" name="L956"></a> 956 <em class="comment">  static Lookup lookup() { return MethodHandles.lookup(); }</em>
<a id="L957" name="L957"></a> 957 <em class="comment">}</em>
<a id="L958" name="L958"></a> 958 <em class="comment">...</em>
<a id="L959" name="L959"></a> 959 <em class="comment">// no access to constructor via invokeSpecial:</em>
<a id="L960" name="L960"></a> 960 <em class="comment">MethodHandle MH_newListie = Listie.lookup()</em>
<a id="L961" name="L961"></a> 961 <em class="comment">  .findConstructor(Listie.class, methodType(void.class));</em>
<a id="L962" name="L962"></a> 962 <em class="comment">Listie l = (Listie) MH_newListie.invokeExact();</em>
<a id="L963" name="L963"></a> 963 <em class="comment">try { assertEquals("impossible", Listie.lookup().findSpecial(</em>
<a id="L964" name="L964"></a> 964 <em class="comment">        Listie.class, "<init>", methodType(void.class), Listie.class));</init></em>
<a id="L965" name="L965"></a> 965 <em class="comment"> } catch (NoSuchMethodException ex) { } // OK</em>
<a id="L966" name="L966"></a> 966 <em class="comment">// access to super and self methods via invokeSpecial:</em>
<a id="L967" name="L967"></a> 967 <em class="comment">MethodHandle MH_super = Listie.lookup().findSpecial(</em>
<a id="L968" name="L968"></a> 968 <em class="comment">  ArrayList.class, "toString" , methodType(String.class), Listie.class);</em>
<a id="L969" name="L969"></a> 969 <em class="comment">MethodHandle MH_this = Listie.lookup().findSpecial(</em>
<a id="L970" name="L970"></a> 970 <em class="comment">  Listie.class, "toString" , methodType(String.class), Listie.class);</em>
<a id="L971" name="L971"></a> 971 <em class="comment">MethodHandle MH_duper = Listie.lookup().findSpecial(</em>
<a id="L972" name="L972"></a> 972 <em class="comment">  Object.class, "toString" , methodType(String.class), Listie.class);</em>
<a id="L973" name="L973"></a> 973 <em class="comment">assertEquals("[]", (String) MH_super.invokeExact(l));</em>
<a id="L974" name="L974"></a> 974 <em class="comment">assertEquals(""+l, (String) MH_this.invokeExact(l));</em>
<a id="L975" name="L975"></a> 975 <em class="comment">assertEquals("[]", (String) MH_duper.invokeExact(l)); // ArrayList method</em>
<a id="L976" name="L976"></a> 976 <em class="comment">try { assertEquals("inaccessible", Listie.lookup().findSpecial(</em>
<a id="L977" name="L977"></a> 977 <em class="comment">        String.class, "toString", methodType(String.class), Listie.class));</em>
<a id="L978" name="L978"></a> 978 <em class="comment"> } catch (IllegalAccessException ex) { } // OK</em>
<a id="L979" name="L979"></a> 979 <em class="comment">Listie subl = new Listie() { public String toString() { return "[subclass]"; } };</em>
<a id="L980" name="L980"></a> 980 <em class="comment">assertEquals(""+l, (String) MH_this.invokeExact(subl)); // Listie method</em>
<a id="L981" name="L981"></a> 981 <em class="comment">         * }</em>
<a id="L982" name="L982"></a> 982 <em class="comment">         *</em>
<a id="L983" name="L983"></a> 983 <em class="comment">         * @param refc the class or interface from which the method is accessed</em>
<a id="L984" name="L984"></a> 984 <em class="comment">         * @param name the name of the method (which must not be "&lt;init&gt;")</em>
<a id="L985" name="L985"></a> 985 <em class="comment">         * @param type the type of the method, with the receiver argument omitted</em>
<a id="L986" name="L986"></a> 986 <em class="comment">         * @param specialCaller the proposed calling class to perform the {@code invokespecial}</em>
<a id="L987" name="L987"></a> 987 <em class="comment">         * @return the desired method handle</em>
<a id="L988" name="L988"></a> 988 <em class="comment">         * @throws NoSuchMethodException if the method does not exist</em>
<a id="L989" name="L989"></a> 989 <em class="comment">         * @throws IllegalAccessException if access checking fails</em>
<a id="L990" name="L990"></a> 990 <em class="comment">         *                                or if the method's variable arity modifier bit</em>
<a id="L991" name="L991"></a> 991 <em class="comment">         *                                is set and {@code asVarargsCollector} fails</em>
<a id="L992" name="L992"></a> 992 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L993" name="L993"></a> 993 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L994" name="L994"></a> 994 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L995" name="L995"></a> 995 <em class="comment">         */</em>
<a id="L996" name="L996"></a> 996         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> findSpecial(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>,
<a id="L997" name="L997"></a> 997                                         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; specialCaller) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L998" name="L998"></a> 998             <a href="../S/1619.html#L1560" title="Defined at 1560 in src/java/lang/invoke/MethodHandles.java.">checkSpecialCaller</a>(specialCaller);
<a id="L999" name="L999"></a> 999             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> specialLookup = <strong class="reserved">this</strong>.<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>(specialCaller);
<a id="L1000" name="L1000"></a>1000             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = specialLookup.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_invokeSpecial, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1001" name="L1001"></a>1001             <strong class="reserved">return</strong> specialLookup.<a href="../S/1619.html#L1598" title="Defined at 1598 in src/java/lang/invoke/MethodHandles.java.">getDirectMethod</a>(REF_invokeSpecial, refc, method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L1002" name="L1002"></a>1002         <em class="brace">}</em>
<a id="L1003" name="L1003"></a>1003 
<a id="L1004" name="L1004"></a>1004         <em class="comment">/**</em>
<a id="L1005" name="L1005"></a>1005 <em class="comment">         * Produces a method handle giving read access to a non-static field.</em>
<a id="L1006" name="L1006"></a>1006 <em class="comment">         * The type of the method handle will have a return type of the field's</em>
<a id="L1007" name="L1007"></a>1007 <em class="comment">         * value type.</em>
<a id="L1008" name="L1008"></a>1008 <em class="comment">         * The method handle's single argument will be the instance containing</em>
<a id="L1009" name="L1009"></a>1009 <em class="comment">         * the field.</em>
<a id="L1010" name="L1010"></a>1010 <em class="comment">         * Access checking is performed immediately on behalf of the lookup class.</em>
<a id="L1011" name="L1011"></a>1011 <em class="comment">         * @param refc the class or interface from which the method is accessed</em>
<a id="L1012" name="L1012"></a>1012 <em class="comment">         * @param name the field's name</em>
<a id="L1013" name="L1013"></a>1013 <em class="comment">         * @param type the field's type</em>
<a id="L1014" name="L1014"></a>1014 <em class="comment">         * @return a method handle which can load values from the field</em>
<a id="L1015" name="L1015"></a>1015 <em class="comment">         * @throws NoSuchFieldException if the field does not exist</em>
<a id="L1016" name="L1016"></a>1016 <em class="comment">         * @throws IllegalAccessException if access checking fails, or if the field is {@code static}</em>
<a id="L1017" name="L1017"></a>1017 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L1018" name="L1018"></a>1018 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L1019" name="L1019"></a>1019 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L1020" name="L1020"></a>1020 <em class="comment">         */</em>
<a id="L1021" name="L1021"></a>1021         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1606.html#L754" title="Referred from 754 in src/java/lang/invoke/BoundMethodHandle.java.">findGetter</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1022" name="L1022"></a>1022             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_getField, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1023" name="L1023"></a>1023             <strong class="reserved">return</strong> <a href="../S/1619.html#L1682" title="Defined at 1682 in src/java/lang/invoke/MethodHandles.java.">getDirectField</a>(REF_getField, refc, field);
<a id="L1024" name="L1024"></a>1024         <em class="brace">}</em>
<a id="L1025" name="L1025"></a>1025 
<a id="L1026" name="L1026"></a>1026         <em class="comment">/**</em>
<a id="L1027" name="L1027"></a>1027 <em class="comment">         * Produces a method handle giving write access to a non-static field.</em>
<a id="L1028" name="L1028"></a>1028 <em class="comment">         * The type of the method handle will have a void return type.</em>
<a id="L1029" name="L1029"></a>1029 <em class="comment">         * The method handle will take two arguments, the instance containing</em>
<a id="L1030" name="L1030"></a>1030 <em class="comment">         * the field, and the value to be stored.</em>
<a id="L1031" name="L1031"></a>1031 <em class="comment">         * The second argument will be of the field's value type.</em>
<a id="L1032" name="L1032"></a>1032 <em class="comment">         * Access checking is performed immediately on behalf of the lookup class.</em>
<a id="L1033" name="L1033"></a>1033 <em class="comment">         * @param refc the class or interface from which the method is accessed</em>
<a id="L1034" name="L1034"></a>1034 <em class="comment">         * @param name the field's name</em>
<a id="L1035" name="L1035"></a>1035 <em class="comment">         * @param type the field's type</em>
<a id="L1036" name="L1036"></a>1036 <em class="comment">         * @return a method handle which can store values into the field</em>
<a id="L1037" name="L1037"></a>1037 <em class="comment">         * @throws NoSuchFieldException if the field does not exist</em>
<a id="L1038" name="L1038"></a>1038 <em class="comment">         * @throws IllegalAccessException if access checking fails, or if the field is {@code static}</em>
<a id="L1039" name="L1039"></a>1039 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L1040" name="L1040"></a>1040 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L1041" name="L1041"></a>1041 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L1042" name="L1042"></a>1042 <em class="comment">         */</em>
<a id="L1043" name="L1043"></a>1043         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> findSetter(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1044" name="L1044"></a>1044             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_putField, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1045" name="L1045"></a>1045             <strong class="reserved">return</strong> <a href="../S/1619.html#L1682" title="Defined at 1682 in src/java/lang/invoke/MethodHandles.java.">getDirectField</a>(REF_putField, refc, field);
<a id="L1046" name="L1046"></a>1046         <em class="brace">}</em>
<a id="L1047" name="L1047"></a>1047 
<a id="L1048" name="L1048"></a>1048         <em class="comment">/**</em>
<a id="L1049" name="L1049"></a>1049 <em class="comment">         * Produces a method handle giving read access to a static field.</em>
<a id="L1050" name="L1050"></a>1050 <em class="comment">         * The type of the method handle will have a return type of the field's</em>
<a id="L1051" name="L1051"></a>1051 <em class="comment">         * value type.</em>
<a id="L1052" name="L1052"></a>1052 <em class="comment">         * The method handle will take no arguments.</em>
<a id="L1053" name="L1053"></a>1053 <em class="comment">         * Access checking is performed immediately on behalf of the lookup class.</em>
<a id="L1054" name="L1054"></a>1054 <em class="comment">         * </em>
<a id="L1055" name="L1055"></a>1055 <em class="comment">         * If the returned method handle is invoked, the field's class will</em>
<a id="L1056" name="L1056"></a>1056 <em class="comment">         * be initialized, if it has not already been initialized.</em>
<a id="L1057" name="L1057"></a>1057 <em class="comment">         * @param refc the class or interface from which the method is accessed</em>
<a id="L1058" name="L1058"></a>1058 <em class="comment">         * @param name the field's name</em>
<a id="L1059" name="L1059"></a>1059 <em class="comment">         * @param type the field's type</em>
<a id="L1060" name="L1060"></a>1060 <em class="comment">         * @return a method handle which can load values from the field</em>
<a id="L1061" name="L1061"></a>1061 <em class="comment">         * @throws NoSuchFieldException if the field does not exist</em>
<a id="L1062" name="L1062"></a>1062 <em class="comment">         * @throws IllegalAccessException if access checking fails, or if the field is not {@code static}</em>
<a id="L1063" name="L1063"></a>1063 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L1064" name="L1064"></a>1064 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L1065" name="L1065"></a>1065 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L1066" name="L1066"></a>1066 <em class="comment">         */</em>
<a id="L1067" name="L1067"></a>1067         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> findStaticGetter(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1068" name="L1068"></a>1068             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_getStatic, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1069" name="L1069"></a>1069             <strong class="reserved">return</strong> <a href="../S/1619.html#L1682" title="Defined at 1682 in src/java/lang/invoke/MethodHandles.java.">getDirectField</a>(REF_getStatic, refc, field);
<a id="L1070" name="L1070"></a>1070         <em class="brace">}</em>
<a id="L1071" name="L1071"></a>1071 
<a id="L1072" name="L1072"></a>1072         <em class="comment">/**</em>
<a id="L1073" name="L1073"></a>1073 <em class="comment">         * Produces a method handle giving write access to a static field.</em>
<a id="L1074" name="L1074"></a>1074 <em class="comment">         * The type of the method handle will have a void return type.</em>
<a id="L1075" name="L1075"></a>1075 <em class="comment">         * The method handle will take a single</em>
<a id="L1076" name="L1076"></a>1076 <em class="comment">         * argument, of the field's value type, the value to be stored.</em>
<a id="L1077" name="L1077"></a>1077 <em class="comment">         * Access checking is performed immediately on behalf of the lookup class.</em>
<a id="L1078" name="L1078"></a>1078 <em class="comment">         * </em>
<a id="L1079" name="L1079"></a>1079 <em class="comment">         * If the returned method handle is invoked, the field's class will</em>
<a id="L1080" name="L1080"></a>1080 <em class="comment">         * be initialized, if it has not already been initialized.</em>
<a id="L1081" name="L1081"></a>1081 <em class="comment">         * @param refc the class or interface from which the method is accessed</em>
<a id="L1082" name="L1082"></a>1082 <em class="comment">         * @param name the field's name</em>
<a id="L1083" name="L1083"></a>1083 <em class="comment">         * @param type the field's type</em>
<a id="L1084" name="L1084"></a>1084 <em class="comment">         * @return a method handle which can store values into the field</em>
<a id="L1085" name="L1085"></a>1085 <em class="comment">         * @throws NoSuchFieldException if the field does not exist</em>
<a id="L1086" name="L1086"></a>1086 <em class="comment">         * @throws IllegalAccessException if access checking fails, or if the field is not {@code static}</em>
<a id="L1087" name="L1087"></a>1087 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L1088" name="L1088"></a>1088 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L1089" name="L1089"></a>1089 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L1090" name="L1090"></a>1090 <em class="comment">         */</em>
<a id="L1091" name="L1091"></a>1091         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> findStaticSetter(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1092" name="L1092"></a>1092             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_putStatic, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1093" name="L1093"></a>1093             <strong class="reserved">return</strong> <a href="../S/1619.html#L1682" title="Defined at 1682 in src/java/lang/invoke/MethodHandles.java.">getDirectField</a>(REF_putStatic, refc, field);
<a id="L1094" name="L1094"></a>1094         <em class="brace">}</em>
<a id="L1095" name="L1095"></a>1095 
<a id="L1096" name="L1096"></a>1096         <em class="comment">/**</em>
<a id="L1097" name="L1097"></a>1097 <em class="comment">         * Produces an early-bound method handle for a non-static method.</em>
<a id="L1098" name="L1098"></a>1098 <em class="comment">         * The receiver must have a supertype {@code defc} in which a method</em>
<a id="L1099" name="L1099"></a>1099 <em class="comment">         * of the given name and type is accessible to the lookup class.</em>
<a id="L1100" name="L1100"></a>1100 <em class="comment">         * The method and all its argument types must be accessible to the lookup object.</em>
<a id="L1101" name="L1101"></a>1101 <em class="comment">         * The type of the method handle will be that of the method,</em>
<a id="L1102" name="L1102"></a>1102 <em class="comment">         * without any insertion of an additional receiver parameter.</em>
<a id="L1103" name="L1103"></a>1103 <em class="comment">         * The given receiver will be bound into the method handle,</em>
<a id="L1104" name="L1104"></a>1104 <em class="comment">         * so that every call to the method handle will invoke the</em>
<a id="L1105" name="L1105"></a>1105 <em class="comment">         * requested method on the given receiver.</em>
<a id="L1106" name="L1106"></a>1106 <em class="comment">         * </em>
<a id="L1107" name="L1107"></a>1107 <em class="comment">         * The returned method handle will have</em>
<a id="L1108" name="L1108"></a>1108 <em class="comment">         * {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if</em>
<a id="L1109" name="L1109"></a>1109 <em class="comment">         * the method's variable arity modifier bit ({@code 0x0080}) is set</em>
<a id="L1110" name="L1110"></a>1110 <em class="comment">         * <em>and</em> the trailing array argument is not the only argument.</em>
<a id="L1111" name="L1111"></a>1111 <em class="comment">         * (If the trailing array argument is the only argument,</em>
<a id="L1112" name="L1112"></a>1112 <em class="comment">         * the given receiver value will be bound to it.)</em>
<a id="L1113" name="L1113"></a>1113 <em class="comment">         * </em>
<a id="L1114" name="L1114"></a>1114 <em class="comment">         * This is equivalent to the following code:</em>
<a id="L1115" name="L1115"></a>1115 <em class="comment">         * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L1116" name="L1116"></a>1116 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L1117" name="L1117"></a>1117 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L1118" name="L1118"></a>1118 <em class="comment">...</em>
<a id="L1119" name="L1119"></a>1119 <em class="comment">MethodHandle mh0 = lookup().findVirtual(defc, name, type);</em>
<a id="L1120" name="L1120"></a>1120 <em class="comment">MethodHandle mh1 = mh0.bindTo(receiver);</em>
<a id="L1121" name="L1121"></a>1121 <em class="comment">MethodType mt1 = mh1.type();</em>
<a id="L1122" name="L1122"></a>1122 <em class="comment">if (mh0.isVarargsCollector())</em>
<a id="L1123" name="L1123"></a>1123 <em class="comment">  mh1 = mh1.asVarargsCollector(mt1.parameterType(mt1.parameterCount()-1));</em>
<a id="L1124" name="L1124"></a>1124 <em class="comment">return mh1;</em>
<a id="L1125" name="L1125"></a>1125 <em class="comment">         * }</em>
<a id="L1126" name="L1126"></a>1126 <em class="comment">         * where {@code defc} is either {@code receiver.getClass()} or a super</em>
<a id="L1127" name="L1127"></a>1127 <em class="comment">         * type of that class, in which the requested method is accessible</em>
<a id="L1128" name="L1128"></a>1128 <em class="comment">         * to the lookup class.</em>
<a id="L1129" name="L1129"></a>1129 <em class="comment">         * (Note that {@code bindTo} does not preserve variable arity.)</em>
<a id="L1130" name="L1130"></a>1130 <em class="comment">         * @param receiver the object from which the method is accessed</em>
<a id="L1131" name="L1131"></a>1131 <em class="comment">         * @param name the name of the method</em>
<a id="L1132" name="L1132"></a>1132 <em class="comment">         * @param type the type of the method, with the receiver argument omitted</em>
<a id="L1133" name="L1133"></a>1133 <em class="comment">         * @return the desired method handle</em>
<a id="L1134" name="L1134"></a>1134 <em class="comment">         * @throws NoSuchMethodException if the method does not exist</em>
<a id="L1135" name="L1135"></a>1135 <em class="comment">         * @throws IllegalAccessException if access checking fails</em>
<a id="L1136" name="L1136"></a>1136 <em class="comment">         *                                or if the method's variable arity modifier bit</em>
<a id="L1137" name="L1137"></a>1137 <em class="comment">         *                                is set and {@code asVarargsCollector} fails</em>
<a id="L1138" name="L1138"></a>1138 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L1139" name="L1139"></a>1139 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L1140" name="L1140"></a>1140 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L1141" name="L1141"></a>1141 <em class="comment">         * @see MethodHandle#bindTo</em>
<a id="L1142" name="L1142"></a>1142 <em class="comment">         * @see #findVirtual</em>
<a id="L1143" name="L1143"></a>1143 <em class="comment">         */</em>
<a id="L1144" name="L1144"></a>1144         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/10598.html" title="Multiple referred from 221 places.">bind</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> receiver, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1145" name="L1145"></a>1145             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt; refc = receiver.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>(); <em class="comment">// may get NPE</em>
<a id="L1146" name="L1146"></a>1146             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_invokeSpecial, refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1147" name="L1147"></a>1147             <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = <a href="../S/1619.html#L1604" title="Defined at 1604 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoRestrict</a>(REF_invokeSpecial, refc, method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L1148" name="L1148"></a>1148             <strong class="reserved">return</strong> mh.<a href="../D/11851.html" title="Multiple defined in 3 places.">bindArgumentL</a>(0, receiver).<a href="../D/34276.html" title="Multiple defined in 2 places.">setVarargs</a>(method);
<a id="L1149" name="L1149"></a>1149         <em class="brace">}</em>
<a id="L1150" name="L1150"></a>1150 
<a id="L1151" name="L1151"></a>1151         <em class="comment">/**</em>
<a id="L1152" name="L1152"></a>1152 <em class="comment">         * Makes a <a href="MethodHandleInfo.html#directmh">direct method handle</a></em>
<a id="L1153" name="L1153"></a>1153 <em class="comment">         * to <i>m</i>, if the lookup class has permission.</em>
<a id="L1154" name="L1154"></a>1154 <em class="comment">         * If <i>m</i> is non-static, the receiver argument is treated as an initial argument.</em>
<a id="L1155" name="L1155"></a>1155 <em class="comment">         * If <i>m</i> is virtual, overriding is respected on every call.</em>
<a id="L1156" name="L1156"></a>1156 <em class="comment">         * Unlike the Core Reflection API, exceptions are <em>not</em> wrapped.</em>
<a id="L1157" name="L1157"></a>1157 <em class="comment">         * The type of the method handle will be that of the method,</em>
<a id="L1158" name="L1158"></a>1158 <em class="comment">         * with the receiver type prepended (but only if it is non-static).</em>
<a id="L1159" name="L1159"></a>1159 <em class="comment">         * If the method's {@code accessible} flag is not set,</em>
<a id="L1160" name="L1160"></a>1160 <em class="comment">         * access checking is performed immediately on behalf of the lookup class.</em>
<a id="L1161" name="L1161"></a>1161 <em class="comment">         * If <i>m</i> is not public, do not share the resulting handle with untrusted parties.</em>
<a id="L1162" name="L1162"></a>1162 <em class="comment">         * </em>
<a id="L1163" name="L1163"></a>1163 <em class="comment">         * The returned method handle will have</em>
<a id="L1164" name="L1164"></a>1164 <em class="comment">         * {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if</em>
<a id="L1165" name="L1165"></a>1165 <em class="comment">         * the method's variable arity modifier bit ({@code 0x0080}) is set.</em>
<a id="L1166" name="L1166"></a>1166 <em class="comment">         * </em>
<a id="L1167" name="L1167"></a>1167 <em class="comment">         * If <i>m</i> is static, and</em>
<a id="L1168" name="L1168"></a>1168 <em class="comment">         * if the returned method handle is invoked, the method's class will</em>
<a id="L1169" name="L1169"></a>1169 <em class="comment">         * be initialized, if it has not already been initialized.</em>
<a id="L1170" name="L1170"></a>1170 <em class="comment">         * @param m the reflected method</em>
<a id="L1171" name="L1171"></a>1171 <em class="comment">         * @return a method handle which can invoke the reflected method</em>
<a id="L1172" name="L1172"></a>1172 <em class="comment">         * @throws IllegalAccessException if access checking fails</em>
<a id="L1173" name="L1173"></a>1173 <em class="comment">         *                                or if the method's variable arity modifier bit</em>
<a id="L1174" name="L1174"></a>1174 <em class="comment">         *                                is set and {@code asVarargsCollector} fails</em>
<a id="L1175" name="L1175"></a>1175 <em class="comment">         * @throws NullPointerException if the argument is null</em>
<a id="L1176" name="L1176"></a>1176 <em class="comment">         */</em>
<a id="L1177" name="L1177"></a>1177         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflect(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1178" name="L1178"></a>1178             <strong class="reserved">if</strong> (m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>() == <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L1179" name="L1179"></a>1179                 <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = <a href="../S/1619.html#L1190" title="Defined at 1190 in src/java/lang/invoke/MethodHandles.java.">unreflectForMH</a>(m);
<a id="L1180" name="L1180"></a>1180                 <strong class="reserved">if</strong> (mh != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> mh;
<a id="L1181" name="L1181"></a>1181             <em class="brace">}</em>
<a id="L1182" name="L1182"></a>1182             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(m);
<a id="L1183" name="L1183"></a>1183             <strong class="reserved">byte</strong> refKind = method.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>();
<a id="L1184" name="L1184"></a>1184             <strong class="reserved">if</strong> (refKind == REF_invokeSpecial)
<a id="L1185" name="L1185"></a>1185                 refKind = REF_invokeVirtual;
<a id="L1186" name="L1186"></a>1186             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(method.<a href="../D/25874.html" title="Multiple defined in 3 places.">isMethod</a>());
<a id="L1187" name="L1187"></a>1187             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a> = m.<a href="../D/25151.html" title="Multiple defined in 4 places.">isAccessible</a>() ? IMPL_LOOKUP : <strong class="reserved">this</strong>;
<a id="L1188" name="L1188"></a>1188             <strong class="reserved">return</strong> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>.<a href="../S/1619.html#L1610" title="Defined at 1610 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoSecurityManager</a>(refKind, method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L1189" name="L1189"></a>1189         <em class="brace">}</em>
<a id="L1190" name="L1190"></a>1190         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L1179" title="Referred from 1179 in src/java/lang/invoke/MethodHandles.java.">unreflectForMH</a>(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a> m) <em class="brace">{</em>
<a id="L1191" name="L1191"></a>1191             <em class="comment">// these names require special lookups because they throw UnsupportedOperationException</em>
<a id="L1192" name="L1192"></a>1192             <strong class="reserved">if</strong> (<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../S/1611.html#L355" title="Defined at 355 in src/java/lang/invoke/MemberName.java.">isMethodHandleInvokeName</a>(m.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>()))
<a id="L1193" name="L1193"></a>1193                 <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L1084" title="Defined at 1084 in src/java/lang/invoke/MethodHandleImpl.java.">fakeMethodHandleInvoke</a>(<strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(m));
<a id="L1194" name="L1194"></a>1194             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1195" name="L1195"></a>1195         <em class="brace">}</em>
<a id="L1196" name="L1196"></a>1196 
<a id="L1197" name="L1197"></a>1197         <em class="comment">/**</em>
<a id="L1198" name="L1198"></a>1198 <em class="comment">         * Produces a method handle for a reflected method.</em>
<a id="L1199" name="L1199"></a>1199 <em class="comment">         * It will bypass checks for overriding methods on the receiver,</em>
<a id="L1200" name="L1200"></a>1200 <em class="comment">         * <a href="MethodHandles.Lookup.html#equiv">as if called</a> from an {@code invokespecial}</em>
<a id="L1201" name="L1201"></a>1201 <em class="comment">         * instruction from within the explicitly specified {@code specialCaller}.</em>
<a id="L1202" name="L1202"></a>1202 <em class="comment">         * The type of the method handle will be that of the method,</em>
<a id="L1203" name="L1203"></a>1203 <em class="comment">         * with a suitably restricted receiver type prepended.</em>
<a id="L1204" name="L1204"></a>1204 <em class="comment">         * (The receiver type will be {@code specialCaller} or a subtype.)</em>
<a id="L1205" name="L1205"></a>1205 <em class="comment">         * If the method's {@code accessible} flag is not set,</em>
<a id="L1206" name="L1206"></a>1206 <em class="comment">         * access checking is performed immediately on behalf of the lookup class,</em>
<a id="L1207" name="L1207"></a>1207 <em class="comment">         * as if {@code invokespecial} instruction were being linked.</em>
<a id="L1208" name="L1208"></a>1208 <em class="comment">         * </em>
<a id="L1209" name="L1209"></a>1209 <em class="comment">         * Before method resolution,</em>
<a id="L1210" name="L1210"></a>1210 <em class="comment">         * if the explicitly specified caller class is not identical with the</em>
<a id="L1211" name="L1211"></a>1211 <em class="comment">         * lookup class, or if this lookup object does not have</em>
<a id="L1212" name="L1212"></a>1212 <em class="comment">         * <a href="MethodHandles.Lookup.html#privacc">private access</a></em>
<a id="L1213" name="L1213"></a>1213 <em class="comment">         * privileges, the access fails.</em>
<a id="L1214" name="L1214"></a>1214 <em class="comment">         * </em>
<a id="L1215" name="L1215"></a>1215 <em class="comment">         * The returned method handle will have</em>
<a id="L1216" name="L1216"></a>1216 <em class="comment">         * {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if</em>
<a id="L1217" name="L1217"></a>1217 <em class="comment">         * the method's variable arity modifier bit ({@code 0x0080}) is set.</em>
<a id="L1218" name="L1218"></a>1218 <em class="comment">         * @param m the reflected method</em>
<a id="L1219" name="L1219"></a>1219 <em class="comment">         * @param specialCaller the class nominally calling the method</em>
<a id="L1220" name="L1220"></a>1220 <em class="comment">         * @return a method handle which can invoke the reflected method</em>
<a id="L1221" name="L1221"></a>1221 <em class="comment">         * @throws IllegalAccessException if access checking fails</em>
<a id="L1222" name="L1222"></a>1222 <em class="comment">         *                                or if the method's variable arity modifier bit</em>
<a id="L1223" name="L1223"></a>1223 <em class="comment">         *                                is set and {@code asVarargsCollector} fails</em>
<a id="L1224" name="L1224"></a>1224 <em class="comment">         * @throws NullPointerException if any argument is null</em>
<a id="L1225" name="L1225"></a>1225 <em class="comment">         */</em>
<a id="L1226" name="L1226"></a>1226         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflectSpecial(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a> m, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; specialCaller) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1227" name="L1227"></a>1227             <a href="../S/1619.html#L1560" title="Defined at 1560 in src/java/lang/invoke/MethodHandles.java.">checkSpecialCaller</a>(specialCaller);
<a id="L1228" name="L1228"></a>1228             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> specialLookup = <strong class="reserved">this</strong>.<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>(specialCaller);
<a id="L1229" name="L1229"></a>1229             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(m, <strong class="reserved">true</strong>);
<a id="L1230" name="L1230"></a>1230             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(method.<a href="../D/25874.html" title="Multiple defined in 3 places.">isMethod</a>());
<a id="L1231" name="L1231"></a>1231             <em class="comment">// ignore m.isAccessible:  this is a new kind of access</em>
<a id="L1232" name="L1232"></a>1232             <strong class="reserved">return</strong> specialLookup.<a href="../S/1619.html#L1610" title="Defined at 1610 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoSecurityManager</a>(REF_invokeSpecial, method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), method, <a href="../S/1619.html#L1413" title="Defined at 1413 in src/java/lang/invoke/MethodHandles.java.">findBoundCallerClass</a>(method));
<a id="L1233" name="L1233"></a>1233         <em class="brace">}</em>
<a id="L1234" name="L1234"></a>1234 
<a id="L1235" name="L1235"></a>1235         <em class="comment">/**</em>
<a id="L1236" name="L1236"></a>1236 <em class="comment">         * Produces a method handle for a reflected constructor.</em>
<a id="L1237" name="L1237"></a>1237 <em class="comment">         * The type of the method handle will be that of the constructor,</em>
<a id="L1238" name="L1238"></a>1238 <em class="comment">         * with the return type changed to the declaring class.</em>
<a id="L1239" name="L1239"></a>1239 <em class="comment">         * The method handle will perform a {@code newInstance} operation,</em>
<a id="L1240" name="L1240"></a>1240 <em class="comment">         * creating a new instance of the constructor's class on the</em>
<a id="L1241" name="L1241"></a>1241 <em class="comment">         * arguments passed to the method handle.</em>
<a id="L1242" name="L1242"></a>1242 <em class="comment">         * </em>
<a id="L1243" name="L1243"></a>1243 <em class="comment">         * If the constructor's {@code accessible} flag is not set,</em>
<a id="L1244" name="L1244"></a>1244 <em class="comment">         * access checking is performed immediately on behalf of the lookup class.</em>
<a id="L1245" name="L1245"></a>1245 <em class="comment">         * </em>
<a id="L1246" name="L1246"></a>1246 <em class="comment">         * The returned method handle will have</em>
<a id="L1247" name="L1247"></a>1247 <em class="comment">         * {@linkplain MethodHandle#asVarargsCollector variable arity} if and only if</em>
<a id="L1248" name="L1248"></a>1248 <em class="comment">         * the constructor's variable arity modifier bit ({@code 0x0080}) is set.</em>
<a id="L1249" name="L1249"></a>1249 <em class="comment">         * </em>
<a id="L1250" name="L1250"></a>1250 <em class="comment">         * If the returned method handle is invoked, the constructor's class will</em>
<a id="L1251" name="L1251"></a>1251 <em class="comment">         * be initialized, if it has not already been initialized.</em>
<a id="L1252" name="L1252"></a>1252 <em class="comment">         * @param c the reflected constructor</em>
<a id="L1253" name="L1253"></a>1253 <em class="comment">         * @return a method handle which can invoke the reflected constructor</em>
<a id="L1254" name="L1254"></a>1254 <em class="comment">         * @throws IllegalAccessException if access checking fails</em>
<a id="L1255" name="L1255"></a>1255 <em class="comment">         *                                or if the method's variable arity modifier bit</em>
<a id="L1256" name="L1256"></a>1256 <em class="comment">         *                                is set and {@code asVarargsCollector} fails</em>
<a id="L1257" name="L1257"></a>1257 <em class="comment">         * @throws NullPointerException if the argument is null</em>
<a id="L1258" name="L1258"></a>1258 <em class="comment">         */</em>
<a id="L1259" name="L1259"></a>1259         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflectConstructor(<a href="../D/1833.html" title="Multiple defined in 2 places.">Constructor</a>&lt;?&gt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1260" name="L1260"></a>1260             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L1261" name="L1261"></a>1261             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(ctor.<a href="../D/25363.html" title="Multiple defined in 6 places.">isConstructor</a>());
<a id="L1262" name="L1262"></a>1262             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a> = <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>.<a href="../D/25151.html" title="Multiple defined in 4 places.">isAccessible</a>() ? IMPL_LOOKUP : <strong class="reserved">this</strong>;
<a id="L1263" name="L1263"></a>1263             <strong class="reserved">return</strong> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>.<a href="../S/1619.html#L1711" title="Defined at 1711 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructorNoSecurityManager</a>(ctor.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), ctor);
<a id="L1264" name="L1264"></a>1264         <em class="brace">}</em>
<a id="L1265" name="L1265"></a>1265 
<a id="L1266" name="L1266"></a>1266         <em class="comment">/**</em>
<a id="L1267" name="L1267"></a>1267 <em class="comment">         * Produces a method handle giving read access to a reflected field.</em>
<a id="L1268" name="L1268"></a>1268 <em class="comment">         * The type of the method handle will have a return type of the field's</em>
<a id="L1269" name="L1269"></a>1269 <em class="comment">         * value type.</em>
<a id="L1270" name="L1270"></a>1270 <em class="comment">         * If the field is static, the method handle will take no arguments.</em>
<a id="L1271" name="L1271"></a>1271 <em class="comment">         * Otherwise, its single argument will be the instance containing</em>
<a id="L1272" name="L1272"></a>1272 <em class="comment">         * the field.</em>
<a id="L1273" name="L1273"></a>1273 <em class="comment">         * If the field's {@code accessible} flag is not set,</em>
<a id="L1274" name="L1274"></a>1274 <em class="comment">         * access checking is performed immediately on behalf of the lookup class.</em>
<a id="L1275" name="L1275"></a>1275 <em class="comment">         * </em>
<a id="L1276" name="L1276"></a>1276 <em class="comment">         * If the field is static, and</em>
<a id="L1277" name="L1277"></a>1277 <em class="comment">         * if the returned method handle is invoked, the field's class will</em>
<a id="L1278" name="L1278"></a>1278 <em class="comment">         * be initialized, if it has not already been initialized.</em>
<a id="L1279" name="L1279"></a>1279 <em class="comment">         * @param f the reflected field</em>
<a id="L1280" name="L1280"></a>1280 <em class="comment">         * @return a method handle which can load values from the reflected field</em>
<a id="L1281" name="L1281"></a>1281 <em class="comment">         * @throws IllegalAccessException if access checking fails</em>
<a id="L1282" name="L1282"></a>1282 <em class="comment">         * @throws NullPointerException if the argument is null</em>
<a id="L1283" name="L1283"></a>1283 <em class="comment">         */</em>
<a id="L1284" name="L1284"></a>1284         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflectGetter(<a href="../D/3142.html" title="Multiple defined in 10 places.">Field</a> f) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1285" name="L1285"></a>1285             <strong class="reserved">return</strong> <a href="../S/1619.html#L1287" title="Defined at 1287 in src/java/lang/invoke/MethodHandles.java.">unreflectField</a>(f, <strong class="reserved">false</strong>);
<a id="L1286" name="L1286"></a>1286         <em class="brace">}</em>
<a id="L1287" name="L1287"></a>1287         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/29749.html" title="Multiple referred from 2 places.">unreflectField</a>(<a href="../D/3142.html" title="Multiple defined in 10 places.">Field</a> f, <strong class="reserved">boolean</strong> <a href="../S/1611.html#L634" title="Defined at 634 in src/java/lang/invoke/MemberName.java.">isSetter</a>) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1288" name="L1288"></a>1288             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(f, <a href="../S/1611.html#L634" title="Defined at 634 in src/java/lang/invoke/MemberName.java.">isSetter</a>);
<a id="L1289" name="L1289"></a>1289             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1611.html#L634" title="Defined at 634 in src/java/lang/invoke/MemberName.java.">isSetter</a>
<a id="L1290" name="L1290"></a>1290                     ? <a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L202" title="Defined at 202 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsSetter</a>(field.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>())
<a id="L1291" name="L1291"></a>1291                     : <a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L198" title="Defined at 198 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsGetter</a>(field.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>()));
<a id="L1292" name="L1292"></a>1292             <a href="../S/1619.html#L512" title="Defined at 512 in src/java/lang/invoke/MethodHandles.java.">Lookup</a> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a> = f.<a href="../D/25151.html" title="Multiple defined in 4 places.">isAccessible</a>() ? IMPL_LOOKUP : <strong class="reserved">this</strong>;
<a id="L1293" name="L1293"></a>1293             <strong class="reserved">return</strong> <a href="../D/27095.html" title="Multiple defined in 22 places.">lookup</a>.<a href="../S/1619.html#L1687" title="Defined at 1687 in src/java/lang/invoke/MethodHandles.java.">getDirectFieldNoSecurityManager</a>(field.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>(), f.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), field);
<a id="L1294" name="L1294"></a>1294         <em class="brace">}</em>
<a id="L1295" name="L1295"></a>1295 
<a id="L1296" name="L1296"></a>1296         <em class="comment">/**</em>
<a id="L1297" name="L1297"></a>1297 <em class="comment">         * Produces a method handle giving write access to a reflected field.</em>
<a id="L1298" name="L1298"></a>1298 <em class="comment">         * The type of the method handle will have a void return type.</em>
<a id="L1299" name="L1299"></a>1299 <em class="comment">         * If the field is static, the method handle will take a single</em>
<a id="L1300" name="L1300"></a>1300 <em class="comment">         * argument, of the field's value type, the value to be stored.</em>
<a id="L1301" name="L1301"></a>1301 <em class="comment">         * Otherwise, the two arguments will be the instance containing</em>
<a id="L1302" name="L1302"></a>1302 <em class="comment">         * the field, and the value to be stored.</em>
<a id="L1303" name="L1303"></a>1303 <em class="comment">         * If the field's {@code accessible} flag is not set,</em>
<a id="L1304" name="L1304"></a>1304 <em class="comment">         * access checking is performed immediately on behalf of the lookup class.</em>
<a id="L1305" name="L1305"></a>1305 <em class="comment">         * </em>
<a id="L1306" name="L1306"></a>1306 <em class="comment">         * If the field is static, and</em>
<a id="L1307" name="L1307"></a>1307 <em class="comment">         * if the returned method handle is invoked, the field's class will</em>
<a id="L1308" name="L1308"></a>1308 <em class="comment">         * be initialized, if it has not already been initialized.</em>
<a id="L1309" name="L1309"></a>1309 <em class="comment">         * @param f the reflected field</em>
<a id="L1310" name="L1310"></a>1310 <em class="comment">         * @return a method handle which can store values into the reflected field</em>
<a id="L1311" name="L1311"></a>1311 <em class="comment">         * @throws IllegalAccessException if access checking fails</em>
<a id="L1312" name="L1312"></a>1312 <em class="comment">         * @throws NullPointerException if the argument is null</em>
<a id="L1313" name="L1313"></a>1313 <em class="comment">         */</em>
<a id="L1314" name="L1314"></a>1314         <strong class="reserved">public</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> unreflectSetter(<a href="../D/3142.html" title="Multiple defined in 10 places.">Field</a> f) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1315" name="L1315"></a>1315             <strong class="reserved">return</strong> <a href="../S/1619.html#L1287" title="Defined at 1287 in src/java/lang/invoke/MethodHandles.java.">unreflectField</a>(f, <strong class="reserved">true</strong>);
<a id="L1316" name="L1316"></a>1316         <em class="brace">}</em>
<a id="L1317" name="L1317"></a>1317 
<a id="L1318" name="L1318"></a>1318         <em class="comment">/**</em>
<a id="L1319" name="L1319"></a>1319 <em class="comment">         * Cracks a <a href="MethodHandleInfo.html#directmh">direct method handle</a></em>
<a id="L1320" name="L1320"></a>1320 <em class="comment">         * created by this lookup object or a similar one.</em>
<a id="L1321" name="L1321"></a>1321 <em class="comment">         * Security and access checks are performed to ensure that this lookup object</em>
<a id="L1322" name="L1322"></a>1322 <em class="comment">         * is capable of reproducing the target method handle.</em>
<a id="L1323" name="L1323"></a>1323 <em class="comment">         * This means that the cracking may fail if target is a direct method handle</em>
<a id="L1324" name="L1324"></a>1324 <em class="comment">         * but was created by an unrelated lookup object.</em>
<a id="L1325" name="L1325"></a>1325 <em class="comment">         * This can happen if the method handle is <a href="MethodHandles.Lookup.html#callsens">caller sensitive</a></em>
<a id="L1326" name="L1326"></a>1326 <em class="comment">         * and was created by a lookup object for a different class.</em>
<a id="L1327" name="L1327"></a>1327 <em class="comment">         * @param target a direct method handle to crack into symbolic reference components</em>
<a id="L1328" name="L1328"></a>1328 <em class="comment">         * @return a symbolic reference which can be used to reconstruct this method handle from this lookup object</em>
<a id="L1329" name="L1329"></a>1329 <em class="comment">         * @exception SecurityException if a security manager is present and it</em>
<a id="L1330" name="L1330"></a>1330 <em class="comment">         *                              <a href="MethodHandles.Lookup.html#secmgr">refuses access</a></em>
<a id="L1331" name="L1331"></a>1331 <em class="comment">         * @throws IllegalArgumentException if the target is not a direct method handle or if access checking fails</em>
<a id="L1332" name="L1332"></a>1332 <em class="comment">         * @exception NullPointerException if the target is {@code null}</em>
<a id="L1333" name="L1333"></a>1333 <em class="comment">         * @see MethodHandleInfo</em>
<a id="L1334" name="L1334"></a>1334 <em class="comment">         * @since 1.8</em>
<a id="L1335" name="L1335"></a>1335 <em class="comment">         */</em>
<a id="L1336" name="L1336"></a>1336         <strong class="reserved">public</strong> <a href="../S/1607.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodHandleInfo.java.">MethodHandleInfo</a> <a href="../R/26478.html" title="Multiple referred from 2 places.">revealDirect</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>) <em class="brace">{</em>
<a id="L1337" name="L1337"></a>1337             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/24941.html" title="Multiple defined in 5 places.">internalMemberName</a>();
<a id="L1338" name="L1338"></a>1338             <strong class="reserved">if</strong> (<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a> == <strong class="reserved">null</strong> || (!<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../S/1611.html#L775" title="Defined at 775 in src/java/lang/invoke/MemberName.java.">isResolved</a>() &amp;&amp; !<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../S/1611.html#L346" title="Defined at 346 in src/java/lang/invoke/MemberName.java.">isMethodHandleInvoke</a>()))
<a id="L1339" name="L1339"></a>1339                 <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("not a direct method handle");
<a id="L1340" name="L1340"></a>1340             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc = <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>();
<a id="L1341" name="L1341"></a>1341             <strong class="reserved">byte</strong> refKind = <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/21916.html" title="Multiple defined in 3 places.">getReferenceKind</a>();
<a id="L1342" name="L1342"></a>1342             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L191" title="Defined at 191 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsValid</a>(refKind));
<a id="L1343" name="L1343"></a>1343             <strong class="reserved">if</strong> (refKind == REF_invokeSpecial &amp;&amp; !<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/25745.html" title="Multiple defined in 4 places.">isInvokeSpecial</a>())
<a id="L1344" name="L1344"></a>1344                 <em class="comment">// Devirtualized method invocation is usually formally virtual.</em>
<a id="L1345" name="L1345"></a>1345                 <em class="comment">// To avoid creating extra MemberName objects for this common case,</em>
<a id="L1346" name="L1346"></a>1346                 <em class="comment">// we encode this extra degree of freedom using MH.isInvokeSpecial.</em>
<a id="L1347" name="L1347"></a>1347                 refKind = REF_invokeVirtual;
<a id="L1348" name="L1348"></a>1348             <strong class="reserved">if</strong> (refKind == REF_invokeVirtual &amp;&amp; defc.<a href="../D/25735.html" title="Multiple defined in 6 places.">isInterface</a>())
<a id="L1349" name="L1349"></a>1349                 <em class="comment">// Symbolic reference is through interface but resolves to Object method (toString, etc.)</em>
<a id="L1350" name="L1350"></a>1350                 refKind = REF_invokeInterface;
<a id="L1351" name="L1351"></a>1351             <em class="comment">// Check SM permissions and member access before cracking.</em>
<a id="L1352" name="L1352"></a>1352             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1353" name="L1353"></a>1353                 <a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(refKind, defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1354" name="L1354"></a>1354                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1355" name="L1355"></a>1355             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L1356" name="L1356"></a>1356                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(<a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>);
<a id="L1357" name="L1357"></a>1357             <em class="brace">}</em>
<a id="L1358" name="L1358"></a>1358             <strong class="reserved">if</strong> (allowedModes != TRUSTED &amp;&amp; <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>()) <em class="brace">{</em>
<a id="L1359" name="L1359"></a>1359                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/24914.html" title="Multiple defined in 3 places.">internalCallerClass</a>();
<a id="L1360" name="L1360"></a>1360                 <strong class="reserved">if</strong> (!<a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>() || callerClass != <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>())
<a id="L1361" name="L1361"></a>1361                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("method handle is caller sensitive: "+callerClass);
<a id="L1362" name="L1362"></a>1362             <em class="brace">}</em>
<a id="L1363" name="L1363"></a>1363             <em class="comment">// Produce the handle to the results.</em>
<a id="L1364" name="L1364"></a>1364             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1636.html#L39" title="Defined at 39 in src/java/lang/invoke/InfoFromMemberName.java.">InfoFromMemberName</a>(<strong class="reserved">this</strong>, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>, refKind);
<a id="L1365" name="L1365"></a>1365         <em class="brace">}</em>
<a id="L1366" name="L1366"></a>1366 
<a id="L1367" name="L1367"></a>1367         <em class="comment">/// Helper methods, all package-private.</em>
<a id="L1368" name="L1368"></a>1368 
<a id="L1369" name="L1369"></a>1369         <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../R/26368.html" title="Multiple referred from 20 places.">resolveOrFail</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1370" name="L1370"></a>1370             <a href="../S/1619.html#L1394" title="Defined at 1394 in src/java/lang/invoke/MethodHandles.java.">checkSymbolicClass</a>(refc);  <em class="comment">// do this before attempting to resolve</em>
<a id="L1371" name="L1371"></a>1371             <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1372" name="L1372"></a>1372             <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1373" name="L1373"></a>1373             <strong class="reserved">return</strong> IMPL_NAMES.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, refKind), <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>(),
<a id="L1374" name="L1374"></a>1374                                             <a href="../S/1573.html#L34" title="Defined at 34 in src/java/lang/NoSuchFieldException.java.">NoSuchFieldException</a>.<strong class="reserved">class</strong>);
<a id="L1375" name="L1375"></a>1375         <em class="brace">}</em>
<a id="L1376" name="L1376"></a>1376 
<a id="L1377" name="L1377"></a>1377         <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../R/26368.html" title="Multiple referred from 20 places.">resolveOrFail</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>, <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1378" name="L1378"></a>1378             <a href="../S/1619.html#L1394" title="Defined at 1394 in src/java/lang/invoke/MethodHandles.java.">checkSymbolicClass</a>(refc);  <em class="comment">// do this before attempting to resolve</em>
<a id="L1379" name="L1379"></a>1379             <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1380" name="L1380"></a>1380             <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1381" name="L1381"></a>1381             <a href="../S/1619.html#L1402" title="Defined at 1402 in src/java/lang/invoke/MethodHandles.java.">checkMethodName</a>(refKind, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);  <em class="comment">// NPE check on name</em>
<a id="L1382" name="L1382"></a>1382             <strong class="reserved">return</strong> IMPL_NAMES.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, refKind), <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>(),
<a id="L1383" name="L1383"></a>1383                                             <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>.<strong class="reserved">class</strong>);
<a id="L1384" name="L1384"></a>1384         <em class="brace">}</em>
<a id="L1385" name="L1385"></a>1385 
<a id="L1386" name="L1386"></a>1386         <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../R/26368.html" title="Multiple referred from 20 places.">resolveOrFail</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>) <strong class="reserved">throws</strong> <a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <em class="brace">{</em>
<a id="L1387" name="L1387"></a>1387             <a href="../S/1619.html#L1394" title="Defined at 1394 in src/java/lang/invoke/MethodHandles.java.">checkSymbolicClass</a>(<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>());  <em class="comment">// do this before attempting to resolve</em>
<a id="L1388" name="L1388"></a>1388             <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1389" name="L1389"></a>1389             <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>().<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1390" name="L1390"></a>1390             <strong class="reserved">return</strong> IMPL_NAMES.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>, <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>(),
<a id="L1391" name="L1391"></a>1391                                             <a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a>.<strong class="reserved">class</strong>);
<a id="L1392" name="L1392"></a>1392         <em class="brace">}</em>
<a id="L1393" name="L1393"></a>1393 
<a id="L1394" name="L1394"></a>1394         <strong class="reserved">void</strong> <a href="../R/11378.html" title="Multiple referred from 4 places.">checkSymbolicClass</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1395" name="L1395"></a>1395             refc.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();  <em class="comment">// NPE</em>
<a id="L1396" name="L1396"></a>1396             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; caller = <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>();
<a id="L1397" name="L1397"></a>1397             <strong class="reserved">if</strong> (caller != <strong class="reserved">null</strong> &amp;&amp; !VerifyAccess.isClassAccessible(refc, caller, allowedModes))
<a id="L1398" name="L1398"></a>1398                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refc).<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>("symbolic reference class is not public", <strong class="reserved">this</strong>);
<a id="L1399" name="L1399"></a>1399         <em class="brace">}</em>
<a id="L1400" name="L1400"></a>1400 
<a id="L1401" name="L1401"></a>1401         <em class="comment">/** Check name for an illegal leading "&lt;" character. */</em>
<a id="L1402" name="L1402"></a>1402         <strong class="reserved">void</strong> <a href="../S/1619.html#L1381" title="Referred from 1381 in src/java/lang/invoke/MethodHandles.java.">checkMethodName</a>(<strong class="reserved">byte</strong> refKind, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>) <strong class="reserved">throws</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a> <em class="brace">{</em>
<a id="L1403" name="L1403"></a>1403             <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("&lt;") &amp;&amp; refKind != REF_newInvokeSpecial)
<a id="L1404" name="L1404"></a>1404                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1776.html#L35" title="Defined at 35 in src/java/lang/NoSuchMethodException.java.">NoSuchMethodException</a>("illegal method name: "+<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L1405" name="L1405"></a>1405         <em class="brace">}</em>
<a id="L1406" name="L1406"></a>1406 
<a id="L1407" name="L1407"></a>1407 
<a id="L1408" name="L1408"></a>1408         <em class="comment">/**</em>
<a id="L1409" name="L1409"></a>1409 <em class="comment">         * Find my trustable caller class if m is a caller sensitive method.</em>
<a id="L1410" name="L1410"></a>1410 <em class="comment">         * If this lookup object has private access, then the caller class is the lookupClass.</em>
<a id="L1411" name="L1411"></a>1411 <em class="comment">         * Otherwise, if m is caller-sensitive, throw IllegalAccessException.</em>
<a id="L1412" name="L1412"></a>1412 <em class="comment">         */</em>
<a id="L1413" name="L1413"></a>1413         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../R/14344.html" title="Multiple referred from 6 places.">findBoundCallerClass</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1414" name="L1414"></a>1414             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass = <strong class="reserved">null</strong>;
<a id="L1415" name="L1415"></a>1415             <strong class="reserved">if</strong> (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>(m)) <em class="brace">{</em>
<a id="L1416" name="L1416"></a>1416                 <em class="comment">// Only lookups with private access are allowed to resolve caller-sensitive methods</em>
<a id="L1417" name="L1417"></a>1417                 <strong class="reserved">if</strong> (<a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>()) <em class="brace">{</em>
<a id="L1418" name="L1418"></a>1418                     callerClass = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L1419" name="L1419"></a>1419                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1420" name="L1420"></a>1420                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a>("Attempt to lookup caller-sensitive method using restricted lookup object");
<a id="L1421" name="L1421"></a>1421                 <em class="brace">}</em>
<a id="L1422" name="L1422"></a>1422             <em class="brace">}</em>
<a id="L1423" name="L1423"></a>1423             <strong class="reserved">return</strong> callerClass;
<a id="L1424" name="L1424"></a>1424         <em class="brace">}</em>
<a id="L1425" name="L1425"></a>1425 
<a id="L1426" name="L1426"></a>1426         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/20256.html" title="Multiple referred from 5 places.">hasPrivateAccess</a>() <em class="brace">{</em>
<a id="L1427" name="L1427"></a>1427             <strong class="reserved">return</strong> (allowedModes &amp; PRIVATE) != 0;
<a id="L1428" name="L1428"></a>1428         <em class="brace">}</em>
<a id="L1429" name="L1429"></a>1429 
<a id="L1430" name="L1430"></a>1430         <em class="comment">/**</em>
<a id="L1431" name="L1431"></a>1431 <em class="comment">         * Perform necessary <a href="MethodHandles.Lookup.html#secmgr">access checks</a>.</em>
<a id="L1432" name="L1432"></a>1432 <em class="comment">         * Determines a trustable caller class to compare with refc, the symbolic reference class.</em>
<a id="L1433" name="L1433"></a>1433 <em class="comment">         * If this lookup object has private access, then the caller class is the lookupClass.</em>
<a id="L1434" name="L1434"></a>1434 <em class="comment">         */</em>
<a id="L1435" name="L1435"></a>1435         <strong class="reserved">void</strong> <a href="../R/11349.html" title="Multiple referred from 5 places.">checkSecurityManager</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <em class="brace">{</em>
<a id="L1436" name="L1436"></a>1436             <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> smgr = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>();
<a id="L1437" name="L1437"></a>1437             <strong class="reserved">if</strong> (smgr == <strong class="reserved">null</strong>)  <strong class="reserved">return</strong>;
<a id="L1438" name="L1438"></a>1438             <strong class="reserved">if</strong> (allowedModes == TRUSTED)  <strong class="reserved">return</strong>;
<a id="L1439" name="L1439"></a>1439 
<a id="L1440" name="L1440"></a>1440             <em class="comment">// Step 1:</em>
<a id="L1441" name="L1441"></a>1441             <strong class="reserved">boolean</strong> fullPowerLookup = <a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>();
<a id="L1442" name="L1442"></a>1442             <strong class="reserved">if</strong> (!fullPowerLookup ||
<a id="L1443" name="L1443"></a>1443                 !VerifyAccess.classLoaderIsAncestor(<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>, refc)) <em class="brace">{</em>
<a id="L1444" name="L1444"></a>1444                 ReflectUtil.<a href="../D/12578.html" title="Multiple defined in 3 places.">checkPackageAccess</a>(refc);
<a id="L1445" name="L1445"></a>1445             <em class="brace">}</em>
<a id="L1446" name="L1446"></a>1446 
<a id="L1447" name="L1447"></a>1447             <em class="comment">// Step 2:</em>
<a id="L1448" name="L1448"></a>1448             <strong class="reserved">if</strong> (m.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>()) <strong class="reserved">return</strong>;
<a id="L1449" name="L1449"></a>1449             <strong class="reserved">if</strong> (!fullPowerLookup) <em class="brace">{</em>
<a id="L1450" name="L1450"></a>1450                 smgr.<a href="../D/12594.html" title="Multiple defined in 22 places.">checkPermission</a>(SecurityConstants.CHECK_MEMBER_ACCESS_PERMISSION);
<a id="L1451" name="L1451"></a>1451             <em class="brace">}</em>
<a id="L1452" name="L1452"></a>1452 
<a id="L1453" name="L1453"></a>1453             <em class="comment">// Step 3:</em>
<a id="L1454" name="L1454"></a>1454             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc = m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>();
<a id="L1455" name="L1455"></a>1455             <strong class="reserved">if</strong> (!fullPowerLookup &amp;&amp; defc != refc) <em class="brace">{</em>
<a id="L1456" name="L1456"></a>1456                 ReflectUtil.<a href="../D/12578.html" title="Multiple defined in 3 places.">checkPackageAccess</a>(defc);
<a id="L1457" name="L1457"></a>1457             <em class="brace">}</em>
<a id="L1458" name="L1458"></a>1458         <em class="brace">}</em>
<a id="L1459" name="L1459"></a>1459 
<a id="L1460" name="L1460"></a>1460         <strong class="reserved">void</strong> <a href="../R/11241.html" title="Multiple referred from 5 places.">checkMethod</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1461" name="L1461"></a>1461             <strong class="reserved">boolean</strong> wantStatic = (refKind == REF_invokeStatic);
<a id="L1462" name="L1462"></a>1462             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>;
<a id="L1463" name="L1463"></a>1463             <strong class="reserved">if</strong> (m.<a href="../D/25363.html" title="Multiple defined in 6 places.">isConstructor</a>())
<a id="L1464" name="L1464"></a>1464                 <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = "expected a method, not a constructor";
<a id="L1465" name="L1465"></a>1465             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!m.<a href="../D/25874.html" title="Multiple defined in 3 places.">isMethod</a>())
<a id="L1466" name="L1466"></a>1466                 <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = "expected a method";
<a id="L1467" name="L1467"></a>1467             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (wantStatic != m.<a href="../D/26281.html" title="Multiple defined in 7 places.">isStatic</a>())
<a id="L1468" name="L1468"></a>1468                 <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = wantStatic ? "expected a static method" : "expected a non-static method";
<a id="L1469" name="L1469"></a>1469             <strong class="reserved">else</strong>
<a id="L1470" name="L1470"></a>1470                 <em class="brace">{</em> <a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(refKind, refc, m); <strong class="reserved">return</strong>; <em class="brace">}</em>
<a id="L1471" name="L1471"></a>1471             <strong class="reserved">throw</strong> m.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>(<a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>, <strong class="reserved">this</strong>);
<a id="L1472" name="L1472"></a>1472         <em class="brace">}</em>
<a id="L1473" name="L1473"></a>1473 
<a id="L1474" name="L1474"></a>1474         <strong class="reserved">void</strong> <a href="../S/1619.html#L1694" title="Referred from 1694 in src/java/lang/invoke/MethodHandles.java.">checkField</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1475" name="L1475"></a>1475             <strong class="reserved">boolean</strong> wantStatic = !<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L211" title="Defined at 211 in src/java/lang/invoke/MethodHandleNatives.java.">refKindHasReceiver</a>(refKind);
<a id="L1476" name="L1476"></a>1476             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>;
<a id="L1477" name="L1477"></a>1477             <strong class="reserved">if</strong> (wantStatic != m.<a href="../D/26281.html" title="Multiple defined in 7 places.">isStatic</a>())
<a id="L1478" name="L1478"></a>1478                 <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = wantStatic ? "expected a static field" : "expected a non-static field";
<a id="L1479" name="L1479"></a>1479             <strong class="reserved">else</strong>
<a id="L1480" name="L1480"></a>1480                 <em class="brace">{</em> <a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(refKind, refc, m); <strong class="reserved">return</strong>; <em class="brace">}</em>
<a id="L1481" name="L1481"></a>1481             <strong class="reserved">throw</strong> m.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>(<a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>, <strong class="reserved">this</strong>);
<a id="L1482" name="L1482"></a>1482         <em class="brace">}</em>
<a id="L1483" name="L1483"></a>1483 
<a id="L1484" name="L1484"></a>1484         <em class="comment">/** Check public/protected/private bits on the symbolic reference class and its member. */</em>
<a id="L1485" name="L1485"></a>1485         <strong class="reserved">void</strong> <a href="../R/11068.html" title="Multiple referred from 112 places.">checkAccess</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1486" name="L1486"></a>1486             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(m.<a href="../S/1611.html#L284" title="Defined at 284 in src/java/lang/invoke/MemberName.java.">referenceKindIsConsistentWith</a>(refKind) &amp;&amp;
<a id="L1487" name="L1487"></a>1487                    <a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L191" title="Defined at 191 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsValid</a>(refKind) &amp;&amp;
<a id="L1488" name="L1488"></a>1488                    (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L194" title="Defined at 194 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsField</a>(refKind) == m.<a href="../D/25544.html" title="Multiple defined in 3 places.">isField</a>()));
<a id="L1489" name="L1489"></a>1489             <strong class="reserved">int</strong> allowedModes = <strong class="reserved">this</strong>.allowedModes;
<a id="L1490" name="L1490"></a>1490             <strong class="reserved">if</strong> (allowedModes == TRUSTED)  <strong class="reserved">return</strong>;
<a id="L1491" name="L1491"></a>1491             <strong class="reserved">int</strong> mods = m.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>();
<a id="L1492" name="L1492"></a>1492             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26106.html" title="Multiple defined in 5 places.">isProtected</a>(mods) &amp;&amp;
<a id="L1493" name="L1493"></a>1493                     refKind == REF_invokeVirtual &amp;&amp;
<a id="L1494" name="L1494"></a>1494                     m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>() == <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong> &amp;&amp;
<a id="L1495" name="L1495"></a>1495                     m.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("clone") &amp;&amp;
<a id="L1496" name="L1496"></a>1496                     refc.<a href="../D/25208.html" title="Multiple defined in 5 places.">isArray</a>()) <em class="brace">{</em>
<a id="L1497" name="L1497"></a>1497                 <em class="comment">// The JVM does this hack also.</em>
<a id="L1498" name="L1498"></a>1498                 <em class="comment">// (See ClassVerifier::verify_invoke_instructions</em>
<a id="L1499" name="L1499"></a>1499                 <em class="comment">// and LinkResolver::check_method_accessability.)</em>
<a id="L1500" name="L1500"></a>1500                 <em class="comment">// Because the JVM does not allow separate methods on array types,</em>
<a id="L1501" name="L1501"></a>1501                 <em class="comment">// there is no separate method for int[].clone.</em>
<a id="L1502" name="L1502"></a>1502                 <em class="comment">// All arrays simply inherit Object.clone.</em>
<a id="L1503" name="L1503"></a>1503                 <em class="comment">// But for access checking logic, we make Object.clone</em>
<a id="L1504" name="L1504"></a>1504                 <em class="comment">// (normally protected) appear to be public.</em>
<a id="L1505" name="L1505"></a>1505                 <em class="comment">// Later on, when the DirectMethodHandle is created,</em>
<a id="L1506" name="L1506"></a>1506                 <em class="comment">// its leading argument will be restricted to the</em>
<a id="L1507" name="L1507"></a>1507                 <em class="comment">// requested array type.</em>
<a id="L1508" name="L1508"></a>1508                 <em class="comment">// N.B. The return type is not adjusted, because</em>
<a id="L1509" name="L1509"></a>1509                 <em class="comment">// that is *not* the bytecode behavior.</em>
<a id="L1510" name="L1510"></a>1510                 mods ^= <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PROTECTED | <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PUBLIC;
<a id="L1511" name="L1511"></a>1511             <em class="brace">}</em>
<a id="L1512" name="L1512"></a>1512             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26106.html" title="Multiple defined in 5 places.">isProtected</a>(mods) &amp;&amp; refKind == REF_newInvokeSpecial) <em class="brace">{</em>
<a id="L1513" name="L1513"></a>1513                 <em class="comment">// cannot "new" a protected ctor in a different package</em>
<a id="L1514" name="L1514"></a>1514                 mods ^= <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.PROTECTED;
<a id="L1515" name="L1515"></a>1515             <em class="brace">}</em>
<a id="L1516" name="L1516"></a>1516             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/25556.html" title="Multiple defined in 9 places.">isFinal</a>(mods) &amp;&amp;
<a id="L1517" name="L1517"></a>1517                     <a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L202" title="Defined at 202 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsSetter</a>(refKind))
<a id="L1518" name="L1518"></a>1518                 <strong class="reserved">throw</strong> m.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>("unexpected set of a final field", <strong class="reserved">this</strong>);
<a id="L1519" name="L1519"></a>1519             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(mods) &amp;&amp; <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(refc.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>()) &amp;&amp; allowedModes != 0)
<a id="L1520" name="L1520"></a>1520                 <strong class="reserved">return</strong>;  <em class="comment">// common case</em>
<a id="L1521" name="L1521"></a>1521             <strong class="reserved">int</strong> requestedModes = <a href="../S/1619.html#L550" title="Defined at 550 in src/java/lang/invoke/MethodHandles.java.">fixmods</a>(mods);  <em class="comment">// adjust 0 =&gt; PACKAGE</em>
<a id="L1522" name="L1522"></a>1522             <strong class="reserved">if</strong> ((requestedModes &amp; allowedModes) != 0) <em class="brace">{</em>
<a id="L1523" name="L1523"></a>1523                 <strong class="reserved">if</strong> (VerifyAccess.isMemberAccessible(refc, m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(),
<a id="L1524" name="L1524"></a>1524                                                     mods, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>(), allowedModes))
<a id="L1525" name="L1525"></a>1525                     <strong class="reserved">return</strong>;
<a id="L1526" name="L1526"></a>1526             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1527" name="L1527"></a>1527                 <em class="comment">// Protected members can also be checked as if they were package-private.</em>
<a id="L1528" name="L1528"></a>1528                 <strong class="reserved">if</strong> ((requestedModes &amp; PROTECTED) != 0 &amp;&amp; (allowedModes &amp; PACKAGE) != 0
<a id="L1529" name="L1529"></a>1529                         &amp;&amp; VerifyAccess.isSamePackage(m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>()))
<a id="L1530" name="L1530"></a>1530                     <strong class="reserved">return</strong>;
<a id="L1531" name="L1531"></a>1531             <em class="brace">}</em>
<a id="L1532" name="L1532"></a>1532             <strong class="reserved">throw</strong> m.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>(<a href="../S/1619.html#L1535" title="Defined at 1535 in src/java/lang/invoke/MethodHandles.java.">accessFailedMessage</a>(refc, m), <strong class="reserved">this</strong>);
<a id="L1533" name="L1533"></a>1533         <em class="brace">}</em>
<a id="L1534" name="L1534"></a>1534 
<a id="L1535" name="L1535"></a>1535         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1619.html#L1532" title="Referred from 1532 in src/java/lang/invoke/MethodHandles.java.">accessFailedMessage</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m) <em class="brace">{</em>
<a id="L1536" name="L1536"></a>1536             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc = m.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>();
<a id="L1537" name="L1537"></a>1537             <strong class="reserved">int</strong> mods = m.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>();
<a id="L1538" name="L1538"></a>1538             <em class="comment">// check the class first:</em>
<a id="L1539" name="L1539"></a>1539             <strong class="reserved">boolean</strong> classOK = (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(defc.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>()) &amp;&amp;
<a id="L1540" name="L1540"></a>1540                                (defc == refc ||
<a id="L1541" name="L1541"></a>1541                                 <a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(refc.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>())));
<a id="L1542" name="L1542"></a>1542             <strong class="reserved">if</strong> (!classOK &amp;&amp; (allowedModes &amp; PACKAGE) != 0) <em class="brace">{</em>
<a id="L1543" name="L1543"></a>1543                 classOK = (VerifyAccess.isClassAccessible(defc, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>(), ALL_MODES) &amp;&amp;
<a id="L1544" name="L1544"></a>1544                            (defc == refc ||
<a id="L1545" name="L1545"></a>1545                             VerifyAccess.isClassAccessible(refc, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>(), ALL_MODES)));
<a id="L1546" name="L1546"></a>1546             <em class="brace">}</em>
<a id="L1547" name="L1547"></a>1547             <strong class="reserved">if</strong> (!classOK)
<a id="L1548" name="L1548"></a>1548                 <strong class="reserved">return</strong> "class is not public";
<a id="L1549" name="L1549"></a>1549             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(mods))
<a id="L1550" name="L1550"></a>1550                 <strong class="reserved">return</strong> "access to public member failed";  <em class="comment">// (how?)</em>
<a id="L1551" name="L1551"></a>1551             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26092.html" title="Multiple defined in 5 places.">isPrivate</a>(mods))
<a id="L1552" name="L1552"></a>1552                 <strong class="reserved">return</strong> "member is private";
<a id="L1553" name="L1553"></a>1553             <strong class="reserved">if</strong> (<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26106.html" title="Multiple defined in 5 places.">isProtected</a>(mods))
<a id="L1554" name="L1554"></a>1554                 <strong class="reserved">return</strong> "member is protected";
<a id="L1555" name="L1555"></a>1555             <strong class="reserved">return</strong> "member is private to package";
<a id="L1556" name="L1556"></a>1556         <em class="brace">}</em>
<a id="L1557" name="L1557"></a>1557 
<a id="L1558" name="L1558"></a>1558         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> ALLOW_NESTMATE_ACCESS = <strong class="reserved">false</strong>;
<a id="L1559" name="L1559"></a>1559 
<a id="L1560" name="L1560"></a>1560         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/11366.html" title="Multiple referred from 2 places.">checkSpecialCaller</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; specialCaller) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1561" name="L1561"></a>1561             <strong class="reserved">int</strong> allowedModes = <strong class="reserved">this</strong>.allowedModes;
<a id="L1562" name="L1562"></a>1562             <strong class="reserved">if</strong> (allowedModes == TRUSTED)  <strong class="reserved">return</strong>;
<a id="L1563" name="L1563"></a>1563             <strong class="reserved">if</strong> (!<a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>()
<a id="L1564" name="L1564"></a>1564                 || (specialCaller != <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>()
<a id="L1565" name="L1565"></a>1565                     &amp;&amp; !(ALLOW_NESTMATE_ACCESS &amp;&amp;
<a id="L1566" name="L1566"></a>1566                          VerifyAccess.isSamePackageMember(specialCaller, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>()))))
<a id="L1567" name="L1567"></a>1567                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(specialCaller).
<a id="L1568" name="L1568"></a>1568                     <a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>("no private access for invokespecial", <strong class="reserved">this</strong>);
<a id="L1569" name="L1569"></a>1569         <em class="brace">}</em>
<a id="L1570" name="L1570"></a>1570 
<a id="L1571" name="L1571"></a>1571         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/26437.html" title="Multiple referred from 2 places.">restrictProtectedReceiver</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method) <em class="brace">{</em>
<a id="L1572" name="L1572"></a>1572             <em class="comment">// The accessing class only has the right to use a protected member</em>
<a id="L1573" name="L1573"></a>1573             <em class="comment">// on itself or a subclass.  Enforce that restriction, from JVMS 5.4.4, etc.</em>
<a id="L1574" name="L1574"></a>1574             <strong class="reserved">if</strong> (!method.<a href="../D/26106.html" title="Multiple defined in 5 places.">isProtected</a>() || method.<a href="../D/26281.html" title="Multiple defined in 7 places.">isStatic</a>()
<a id="L1575" name="L1575"></a>1575                 || allowedModes == TRUSTED
<a id="L1576" name="L1576"></a>1576                 || method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>() == <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>()
<a id="L1577" name="L1577"></a>1577                 || VerifyAccess.isSamePackage(method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>())
<a id="L1578" name="L1578"></a>1578                 || (ALLOW_NESTMATE_ACCESS &amp;&amp;
<a id="L1579" name="L1579"></a>1579                     VerifyAccess.isSamePackageMember(method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>(), <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>())))
<a id="L1580" name="L1580"></a>1580                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1581" name="L1581"></a>1581             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1582" name="L1582"></a>1582         <em class="brace">}</em>
<a id="L1583" name="L1583"></a>1583         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/26438.html" title="Multiple referred from 2 places.">restrictReceiver</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a> mh, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; caller) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1584" name="L1584"></a>1584             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!method.<a href="../D/26281.html" title="Multiple defined in 7 places.">isStatic</a>());
<a id="L1585" name="L1585"></a>1585             <em class="comment">// receiver type of mh is too wide; narrow to caller</em>
<a id="L1586" name="L1586"></a>1586             <strong class="reserved">if</strong> (!method.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>().<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(caller)) <em class="brace">{</em>
<a id="L1587" name="L1587"></a>1587                 <strong class="reserved">throw</strong> method.<a href="../D/27201.html" title="Multiple defined in 2 places.">makeAccessException</a>("caller class must be a subclass below the method", caller);
<a id="L1588" name="L1588"></a>1588             <em class="brace">}</em>
<a id="L1589" name="L1589"></a>1589             <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> rawType = mh.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L1590" name="L1590"></a>1590             <strong class="reserved">if</strong> (rawType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0) == caller)  <strong class="reserved">return</strong> mh;
<a id="L1591" name="L1591"></a>1591             <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> narrowType = rawType.<a href="../S/1616.html#L369" title="Defined at 369 in src/java/lang/invoke/MethodType.java.">changeParameterType</a>(0, caller);
<a id="L1592" name="L1592"></a>1592             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!mh.<a href="../D/26478.html" title="Multiple defined in 2 places.">isVarargsCollector</a>());  <em class="comment">// viewAsType will lose varargs-ness</em>
<a id="L1593" name="L1593"></a>1593             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(mh.<a href="../D/36413.html" title="Multiple defined in 2 places.">viewAsTypeChecks</a>(narrowType, <strong class="reserved">true</strong>));
<a id="L1594" name="L1594"></a>1594             <strong class="reserved">return</strong> mh.<a href="../D/13534.html" title="Multiple defined in 10 places.">copyWith</a>(narrowType, mh.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>);
<a id="L1595" name="L1595"></a>1595         <em class="brace">}</em>
<a id="L1596" name="L1596"></a>1596 
<a id="L1597" name="L1597"></a>1597         <em class="comment">/** Check access and get the requested method. */</em>
<a id="L1598" name="L1598"></a>1598         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16166.html" title="Multiple referred from 3 places.">getDirectMethod</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1599" name="L1599"></a>1599             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> doRestrict    = <strong class="reserved">true</strong>;
<a id="L1600" name="L1600"></a>1600             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">true</strong>;
<a id="L1601" name="L1601"></a>1601             <strong class="reserved">return</strong> <a href="../S/1619.html#L1616" title="Defined at 1616 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodCommon</a>(refKind, refc, method, checkSecurity, doRestrict, callerClass);
<a id="L1602" name="L1602"></a>1602         <em class="brace">}</em>
<a id="L1603" name="L1603"></a>1603         <em class="comment">/** Check access and get the requested method, eliding receiver narrowing rules. */</em>
<a id="L1604" name="L1604"></a>1604         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L1147" title="Referred from 1147 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoRestrict</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1605" name="L1605"></a>1605             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> doRestrict    = <strong class="reserved">false</strong>;
<a id="L1606" name="L1606"></a>1606             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">true</strong>;
<a id="L1607" name="L1607"></a>1607             <strong class="reserved">return</strong> <a href="../S/1619.html#L1616" title="Defined at 1616 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodCommon</a>(refKind, refc, method, checkSecurity, doRestrict, callerClass);
<a id="L1608" name="L1608"></a>1608         <em class="brace">}</em>
<a id="L1609" name="L1609"></a>1609         <em class="comment">/** Check access and get the requested method, eliding security manager checks. */</em>
<a id="L1610" name="L1610"></a>1610         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16170.html" title="Multiple referred from 3 places.">getDirectMethodNoSecurityManager</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1611" name="L1611"></a>1611             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> doRestrict    = <strong class="reserved">true</strong>;
<a id="L1612" name="L1612"></a>1612             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">false</strong>;  <em class="comment">// not needed for reflection or for linking CONSTANT_MH constants</em>
<a id="L1613" name="L1613"></a>1613             <strong class="reserved">return</strong> <a href="../S/1619.html#L1616" title="Defined at 1616 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodCommon</a>(refKind, refc, method, checkSecurity, doRestrict, callerClass);
<a id="L1614" name="L1614"></a>1614         <em class="brace">}</em>
<a id="L1615" name="L1615"></a>1615         <em class="comment">/** Common code for all methods; do not call directly except from immediately above. */</em>
<a id="L1616" name="L1616"></a>1616         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16167.html" title="Multiple referred from 3 places.">getDirectMethodCommon</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method,
<a id="L1617" name="L1617"></a>1617                                                    <strong class="reserved">boolean</strong> checkSecurity,
<a id="L1618" name="L1618"></a>1618                                                    <strong class="reserved">boolean</strong> doRestrict, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1619" name="L1619"></a>1619             <a href="../D/12536.html" title="Multiple defined in 4 places.">checkMethod</a>(refKind, refc, method);
<a id="L1620" name="L1620"></a>1620             <em class="comment">// Optionally check with the security manager; this isn't needed for unreflect* calls.</em>
<a id="L1621" name="L1621"></a>1621             <strong class="reserved">if</strong> (checkSecurity)
<a id="L1622" name="L1622"></a>1622                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(refc, method);
<a id="L1623" name="L1623"></a>1623             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!method.<a href="../S/1611.html#L346" title="Defined at 346 in src/java/lang/invoke/MemberName.java.">isMethodHandleInvoke</a>());
<a id="L1624" name="L1624"></a>1624 
<a id="L1625" name="L1625"></a>1625             <strong class="reserved">if</strong> (refKind == REF_invokeSpecial &amp;&amp;
<a id="L1626" name="L1626"></a>1626                 refc != <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>() &amp;&amp;
<a id="L1627" name="L1627"></a>1627                 !refc.<a href="../D/25735.html" title="Multiple defined in 6 places.">isInterface</a>() &amp;&amp;
<a id="L1628" name="L1628"></a>1628                 refc != <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>().<a href="../D/22863.html" title="Multiple defined in 4 places.">getSuperclass</a>() &amp;&amp;
<a id="L1629" name="L1629"></a>1629                 refc.<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(<a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>())) <em class="brace">{</em>
<a id="L1630" name="L1630"></a>1630                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!method.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("&lt;init&gt;"));  <em class="comment">// not this code path</em>
<a id="L1631" name="L1631"></a>1631                 <em class="comment">// Per JVMS 6.5, desc. of invokespecial instruction:</em>
<a id="L1632" name="L1632"></a>1632                 <em class="comment">// If the method is in a superclass of the LC,</em>
<a id="L1633" name="L1633"></a>1633                 <em class="comment">// and if our original search was above LC.super,</em>
<a id="L1634" name="L1634"></a>1634                 <em class="comment">// repeat the search (symbolic lookup) from LC.super</em>
<a id="L1635" name="L1635"></a>1635                 <em class="comment">// and continue with the direct superclass of that class,</em>
<a id="L1636" name="L1636"></a>1636                 <em class="comment">// and so forth, until a match is found or no further superclasses exist.</em>
<a id="L1637" name="L1637"></a>1637                 <em class="comment">// FIXME: MemberName.resolve should handle this instead.</em>
<a id="L1638" name="L1638"></a>1638                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refcAsSuper = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>();
<a id="L1639" name="L1639"></a>1639                 <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> m2;
<a id="L1640" name="L1640"></a>1640                 <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L1641" name="L1641"></a>1641                     refcAsSuper = refcAsSuper.<a href="../D/22863.html" title="Multiple defined in 4 places.">getSuperclass</a>();
<a id="L1642" name="L1642"></a>1642                     m2 = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refcAsSuper,
<a id="L1643" name="L1643"></a>1643                                         method.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L1644" name="L1644"></a>1644                                         method.<a href="../D/20598.html" title="Multiple defined in 3 places.">getMethodType</a>(),
<a id="L1645" name="L1645"></a>1645                                         REF_invokeSpecial);
<a id="L1646" name="L1646"></a>1646                     m2 = IMPL_NAMES.<a href="../S/1611.html#L1001" title="Defined at 1001 in src/java/lang/invoke/MemberName.java.">resolveOrNull</a>(refKind, m2, <a href="../S/1619.html#L569" title="Defined at 569 in src/java/lang/invoke/MethodHandles.java.">lookupClassOrNull</a>());
<a id="L1647" name="L1647"></a>1647                 <em class="brace">}</em> <strong class="reserved">while</strong> (m2 == <strong class="reserved">null</strong> &amp;&amp;         <em class="comment">// no method is found yet</em>
<a id="L1648" name="L1648"></a>1648                          refc != refcAsSuper); <em class="comment">// search up to refc</em>
<a id="L1649" name="L1649"></a>1649                 <strong class="reserved">if</strong> (m2 == <strong class="reserved">null</strong>)  <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>(method.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L1650" name="L1650"></a>1650                 method = m2;
<a id="L1651" name="L1651"></a>1651                 refc = refcAsSuper;
<a id="L1652" name="L1652"></a>1652                 <em class="comment">// redo basic checks</em>
<a id="L1653" name="L1653"></a>1653                 <a href="../D/12536.html" title="Multiple defined in 4 places.">checkMethod</a>(refKind, refc, method);
<a id="L1654" name="L1654"></a>1654             <em class="brace">}</em>
<a id="L1655" name="L1655"></a>1655 
<a id="L1656" name="L1656"></a>1656             <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a> dmh = <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>.<a href="../D/27195.html" title="Multiple defined in 13 places.">make</a>(refKind, refc, method);
<a id="L1657" name="L1657"></a>1657             <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = dmh;
<a id="L1658" name="L1658"></a>1658             <em class="comment">// Optionally narrow the receiver argument to refc using restrictReceiver.</em>
<a id="L1659" name="L1659"></a>1659             <strong class="reserved">if</strong> (doRestrict &amp;&amp;
<a id="L1660" name="L1660"></a>1660                    (refKind == REF_invokeSpecial ||
<a id="L1661" name="L1661"></a>1661                        (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L211" title="Defined at 211 in src/java/lang/invoke/MethodHandleNatives.java.">refKindHasReceiver</a>(refKind) &amp;&amp;
<a id="L1662" name="L1662"></a>1662                            <a href="../S/1619.html#L1571" title="Defined at 1571 in src/java/lang/invoke/MethodHandles.java.">restrictProtectedReceiver</a>(method)))) <em class="brace">{</em>
<a id="L1663" name="L1663"></a>1663                 mh = <a href="../S/1619.html#L1583" title="Defined at 1583 in src/java/lang/invoke/MethodHandles.java.">restrictReceiver</a>(method, dmh, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>());
<a id="L1664" name="L1664"></a>1664             <em class="brace">}</em>
<a id="L1665" name="L1665"></a>1665             mh = <a href="../S/1619.html#L1669" title="Defined at 1669 in src/java/lang/invoke/MethodHandles.java.">maybeBindCaller</a>(method, mh, callerClass);
<a id="L1666" name="L1666"></a>1666             mh = mh.<a href="../D/34276.html" title="Multiple defined in 2 places.">setVarargs</a>(method);
<a id="L1667" name="L1667"></a>1667             <strong class="reserved">return</strong> mh;
<a id="L1668" name="L1668"></a>1668         <em class="brace">}</em>
<a id="L1669" name="L1669"></a>1669         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L1665" title="Referred from 1665 in src/java/lang/invoke/MethodHandles.java.">maybeBindCaller</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh,
<a id="L1670" name="L1670"></a>1670                                              <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; callerClass)
<a id="L1671" name="L1671"></a>1671                                              <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1672" name="L1672"></a>1672             <strong class="reserved">if</strong> (allowedModes == TRUSTED || !<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>(method))
<a id="L1673" name="L1673"></a>1673                 <strong class="reserved">return</strong> mh;
<a id="L1674" name="L1674"></a>1674             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; hostClass = <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>;
<a id="L1675" name="L1675"></a>1675             <strong class="reserved">if</strong> (!<a href="../S/1619.html#L1426" title="Defined at 1426 in src/java/lang/invoke/MethodHandles.java.">hasPrivateAccess</a>())  <em class="comment">// caller must have private access</em>
<a id="L1676" name="L1676"></a>1676                 hostClass = callerClass;  <em class="comment">// callerClass came from a security manager style stack walk</em>
<a id="L1677" name="L1677"></a>1677             <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> cbmh = <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/11853.html" title="Multiple defined in 3 places.">bindCaller</a>(mh, hostClass);
<a id="L1678" name="L1678"></a>1678             <em class="comment">// Note: caller will apply varargs after this step happens.</em>
<a id="L1679" name="L1679"></a>1679             <strong class="reserved">return</strong> cbmh;
<a id="L1680" name="L1680"></a>1680         <em class="brace">}</em>
<a id="L1681" name="L1681"></a>1681         <em class="comment">/** Check access and get the requested field. */</em>
<a id="L1682" name="L1682"></a>1682         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16163.html" title="Multiple referred from 4 places.">getDirectField</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1683" name="L1683"></a>1683             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">true</strong>;
<a id="L1684" name="L1684"></a>1684             <strong class="reserved">return</strong> <a href="../S/1619.html#L1692" title="Defined at 1692 in src/java/lang/invoke/MethodHandles.java.">getDirectFieldCommon</a>(refKind, refc, field, checkSecurity);
<a id="L1685" name="L1685"></a>1685         <em class="brace">}</em>
<a id="L1686" name="L1686"></a>1686         <em class="comment">/** Check access and get the requested field, eliding security manager checks. */</em>
<a id="L1687" name="L1687"></a>1687         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16165.html" title="Multiple referred from 2 places.">getDirectFieldNoSecurityManager</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1688" name="L1688"></a>1688             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">false</strong>;  <em class="comment">// not needed for reflection or for linking CONSTANT_MH constants</em>
<a id="L1689" name="L1689"></a>1689             <strong class="reserved">return</strong> <a href="../S/1619.html#L1692" title="Defined at 1692 in src/java/lang/invoke/MethodHandles.java.">getDirectFieldCommon</a>(refKind, refc, field, checkSecurity);
<a id="L1690" name="L1690"></a>1690         <em class="brace">}</em>
<a id="L1691" name="L1691"></a>1691         <em class="comment">/** Common code for all fields; do not call directly except from immediately above. */</em>
<a id="L1692" name="L1692"></a>1692         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16164.html" title="Multiple referred from 2 places.">getDirectFieldCommon</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> field,
<a id="L1693" name="L1693"></a>1693                                                   <strong class="reserved">boolean</strong> checkSecurity) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1694" name="L1694"></a>1694             <a href="../S/1619.html#L1474" title="Defined at 1474 in src/java/lang/invoke/MethodHandles.java.">checkField</a>(refKind, refc, field);
<a id="L1695" name="L1695"></a>1695             <em class="comment">// Optionally check with the security manager; this isn't needed for unreflect* calls.</em>
<a id="L1696" name="L1696"></a>1696             <strong class="reserved">if</strong> (checkSecurity)
<a id="L1697" name="L1697"></a>1697                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(refc, field);
<a id="L1698" name="L1698"></a>1698             <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a> dmh = <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>.<a href="../D/27195.html" title="Multiple defined in 13 places.">make</a>(refc, field);
<a id="L1699" name="L1699"></a>1699             <strong class="reserved">boolean</strong> doRestrict = (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L211" title="Defined at 211 in src/java/lang/invoke/MethodHandleNatives.java.">refKindHasReceiver</a>(refKind) &amp;&amp;
<a id="L1700" name="L1700"></a>1700                                     <a href="../S/1619.html#L1571" title="Defined at 1571 in src/java/lang/invoke/MethodHandles.java.">restrictProtectedReceiver</a>(field));
<a id="L1701" name="L1701"></a>1701             <strong class="reserved">if</strong> (doRestrict)
<a id="L1702" name="L1702"></a>1702                 <strong class="reserved">return</strong> <a href="../S/1619.html#L1583" title="Defined at 1583 in src/java/lang/invoke/MethodHandles.java.">restrictReceiver</a>(field, dmh, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>());
<a id="L1703" name="L1703"></a>1703             <strong class="reserved">return</strong> dmh;
<a id="L1704" name="L1704"></a>1704         <em class="brace">}</em>
<a id="L1705" name="L1705"></a>1705         <em class="comment">/** Check access and get the requested constructor. */</em>
<a id="L1706" name="L1706"></a>1706         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L921" title="Referred from 921 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructor</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1707" name="L1707"></a>1707             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">true</strong>;
<a id="L1708" name="L1708"></a>1708             <strong class="reserved">return</strong> <a href="../S/1619.html#L1716" title="Defined at 1716 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructorCommon</a>(refc, ctor, checkSecurity);
<a id="L1709" name="L1709"></a>1709         <em class="brace">}</em>
<a id="L1710" name="L1710"></a>1710         <em class="comment">/** Check access and get the requested constructor, eliding security manager checks. */</em>
<a id="L1711" name="L1711"></a>1711         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16162.html" title="Multiple referred from 2 places.">getDirectConstructorNoSecurityManager</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1712" name="L1712"></a>1712             <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> checkSecurity = <strong class="reserved">false</strong>;  <em class="comment">// not needed for reflection or for linking CONSTANT_MH constants</em>
<a id="L1713" name="L1713"></a>1713             <strong class="reserved">return</strong> <a href="../S/1619.html#L1716" title="Defined at 1716 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructorCommon</a>(refc, ctor, checkSecurity);
<a id="L1714" name="L1714"></a>1714         <em class="brace">}</em>
<a id="L1715" name="L1715"></a>1715         <em class="comment">/** Common code for all constructors; do not call directly except from immediately above. */</em>
<a id="L1716" name="L1716"></a>1716         <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/16161.html" title="Multiple referred from 2 places.">getDirectConstructorCommon</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; refc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> ctor,
<a id="L1717" name="L1717"></a>1717                                                   <strong class="reserved">boolean</strong> checkSecurity) <strong class="reserved">throws</strong> <a href="../S/1574.html#L59" title="Defined at 59 in src/java/lang/IllegalAccessException.java.">IllegalAccessException</a> <em class="brace">{</em>
<a id="L1718" name="L1718"></a>1718             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(ctor.<a href="../D/25363.html" title="Multiple defined in 6 places.">isConstructor</a>());
<a id="L1719" name="L1719"></a>1719             <a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(REF_newInvokeSpecial, refc, ctor);
<a id="L1720" name="L1720"></a>1720             <em class="comment">// Optionally check with the security manager; this isn't needed for unreflect* calls.</em>
<a id="L1721" name="L1721"></a>1721             <strong class="reserved">if</strong> (checkSecurity)
<a id="L1722" name="L1722"></a>1722                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(refc, ctor);
<a id="L1723" name="L1723"></a>1723             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>(ctor));  <em class="comment">// maybeBindCaller not relevant here</em>
<a id="L1724" name="L1724"></a>1724             <strong class="reserved">return</strong> <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>.<a href="../D/27195.html" title="Multiple defined in 13 places.">make</a>(ctor).<a href="../D/34276.html" title="Multiple defined in 2 places.">setVarargs</a>(ctor);
<a id="L1725" name="L1725"></a>1725         <em class="brace">}</em>
<a id="L1726" name="L1726"></a>1726 
<a id="L1727" name="L1727"></a>1727         <em class="comment">/** Hook called from the JVM (via MethodHandleNatives) to link MH constants:</em>
<a id="L1728" name="L1728"></a>1728 <em class="comment">         */</em>
<a id="L1729" name="L1729"></a>1729         <em class="comment">/*non-public*/</em>
<a id="L1730" name="L1730"></a>1730         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1603.html#L477" title="Referred from 477 in src/java/lang/invoke/MethodHandleNatives.java.">linkMethodHandleConstant</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <strong class="reserved">throws</strong> <a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <em class="brace">{</em>
<a id="L1731" name="L1731"></a>1731             <strong class="reserved">if</strong> (!(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> <strong class="reserved">instanceof</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a> || <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> <strong class="reserved">instanceof</strong> <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>))
<a id="L1732" name="L1732"></a>1732                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>("unresolved MemberName");
<a id="L1733" name="L1733"></a>1733             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a> = <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refKind, defc, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L1734" name="L1734"></a>1734             <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = LOOKASIDE_TABLE.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1735" name="L1735"></a>1735             <strong class="reserved">if</strong> (mh != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1736" name="L1736"></a>1736                 <a href="../S/1619.html#L1394" title="Defined at 1394 in src/java/lang/invoke/MethodHandles.java.">checkSymbolicClass</a>(defc);
<a id="L1737" name="L1737"></a>1737                 <strong class="reserved">return</strong> mh;
<a id="L1738" name="L1738"></a>1738             <em class="brace">}</em>
<a id="L1739" name="L1739"></a>1739             <em class="comment">// Treat MethodHandle.invoke and invokeExact specially.</em>
<a id="L1740" name="L1740"></a>1740             <strong class="reserved">if</strong> (defc == <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong> &amp;&amp; refKind == REF_invokeVirtual) <em class="brace">{</em>
<a id="L1741" name="L1741"></a>1741                 mh = <a href="../S/1619.html#L861" title="Defined at 861 in src/java/lang/invoke/MethodHandles.java.">findVirtualForMH</a>(<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(), <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/20598.html" title="Multiple defined in 3 places.">getMethodType</a>());
<a id="L1742" name="L1742"></a>1742                 <strong class="reserved">if</strong> (mh != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1743" name="L1743"></a>1743                     <strong class="reserved">return</strong> mh;
<a id="L1744" name="L1744"></a>1744                 <em class="brace">}</em>
<a id="L1745" name="L1745"></a>1745             <em class="brace">}</em>
<a id="L1746" name="L1746"></a>1746             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> resolved = <a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1747" name="L1747"></a>1747             mh = <a href="../S/1619.html#L1793" title="Defined at 1793 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodForConstant</a>(refKind, defc, resolved);
<a id="L1748" name="L1748"></a>1748             <strong class="reserved">if</strong> (mh <strong class="reserved">instanceof</strong> <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>
<a id="L1749" name="L1749"></a>1749                     &amp;&amp; <a href="../S/1619.html#L1761" title="Defined at 1761 in src/java/lang/invoke/MethodHandles.java.">canBeCached</a>(refKind, defc, resolved)) <em class="brace">{</em>
<a id="L1750" name="L1750"></a>1750                 <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> = mh.<a href="../D/24941.html" title="Multiple defined in 5 places.">internalMemberName</a>();
<a id="L1751" name="L1751"></a>1751                 <strong class="reserved">if</strong> (<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1752" name="L1752"></a>1752                     <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> = <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>.<a href="../S/1611.html#L582" title="Defined at 582 in src/java/lang/invoke/MemberName.java.">asNormalOriginal</a>();
<a id="L1753" name="L1753"></a>1753                 <em class="brace">}</em>
<a id="L1754" name="L1754"></a>1754                 <strong class="reserved">if</strong> (<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>)) <em class="brace">{</em>  <em class="comment">// better safe than sorry</em>
<a id="L1755" name="L1755"></a>1755                     LOOKASIDE_TABLE.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>, (<a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>) mh);
<a id="L1756" name="L1756"></a>1756                 <em class="brace">}</em>
<a id="L1757" name="L1757"></a>1757             <em class="brace">}</em>
<a id="L1758" name="L1758"></a>1758             <strong class="reserved">return</strong> mh;
<a id="L1759" name="L1759"></a>1759         <em class="brace">}</em>
<a id="L1760" name="L1760"></a>1760         <strong class="reserved">private</strong>
<a id="L1761" name="L1761"></a>1761         <strong class="reserved">boolean</strong> <a href="../S/1619.html#L1749" title="Referred from 1749 in src/java/lang/invoke/MethodHandles.java.">canBeCached</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>) <em class="brace">{</em>
<a id="L1762" name="L1762"></a>1762             <strong class="reserved">if</strong> (refKind == REF_invokeSpecial) <em class="brace">{</em>
<a id="L1763" name="L1763"></a>1763                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1764" name="L1764"></a>1764             <em class="brace">}</em>
<a id="L1765" name="L1765"></a>1765             <strong class="reserved">if</strong> (!<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(defc.<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>()) ||
<a id="L1766" name="L1766"></a>1766                     !<a href="../D/5688.html" title="Multiple defined in 3 places.">Modifier</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>(<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/18264.html" title="Multiple defined in 10 places.">getDeclaringClass</a>().<a href="../D/20712.html" title="Multiple defined in 18 places.">getModifiers</a>()) ||
<a id="L1767" name="L1767"></a>1767                     !<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/26117.html" title="Multiple defined in 5 places.">isPublic</a>() ||
<a id="L1768" name="L1768"></a>1768                     <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/25278.html" title="Multiple defined in 2 places.">isCallerSensitive</a>()) <em class="brace">{</em>
<a id="L1769" name="L1769"></a>1769                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1770" name="L1770"></a>1770             <em class="brace">}</em>
<a id="L1771" name="L1771"></a>1771             <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> loader = defc.<a href="../D/17691.html" title="Multiple defined in 20 places.">getClassLoader</a>();
<a id="L1772" name="L1772"></a>1772             <strong class="reserved">if</strong> (!sun.misc.VM.isSystemDomainLoader(loader)) <em class="brace">{</em>
<a id="L1773" name="L1773"></a>1773                 <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> sysl = <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a>.<a href="../D/22895.html" title="Multiple defined in 7 places.">getSystemClassLoader</a>();
<a id="L1774" name="L1774"></a>1774                 <strong class="reserved">boolean</strong> found = <strong class="reserved">false</strong>;
<a id="L1775" name="L1775"></a>1775                 <strong class="reserved">while</strong> (sysl != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1776" name="L1776"></a>1776                     <strong class="reserved">if</strong> (loader == sysl) <em class="brace">{</em> found = <strong class="reserved">true</strong>; <strong class="reserved">break</strong>; <em class="brace">}</em>
<a id="L1777" name="L1777"></a>1777                     sysl = sysl.<a href="../D/21392.html" title="Multiple defined in 42 places.">getParent</a>();
<a id="L1778" name="L1778"></a>1778                 <em class="brace">}</em>
<a id="L1779" name="L1779"></a>1779                 <strong class="reserved">if</strong> (!found) <em class="brace">{</em>
<a id="L1780" name="L1780"></a>1780                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1781" name="L1781"></a>1781                 <em class="brace">}</em>
<a id="L1782" name="L1782"></a>1782             <em class="brace">}</em>
<a id="L1783" name="L1783"></a>1783             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1784" name="L1784"></a>1784                 <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> resolved2 = <a href="../S/1619.html#L116" title="Defined at 116 in src/java/lang/invoke/MethodHandles.java.">publicLookup</a>().<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(refKind,
<a id="L1785" name="L1785"></a>1785                     <strong class="reserved">new</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>(refKind, defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(), <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>()));
<a id="L1786" name="L1786"></a>1786                 <a href="../S/1619.html#L1435" title="Defined at 1435 in src/java/lang/invoke/MethodHandles.java.">checkSecurityManager</a>(defc, resolved2);
<a id="L1787" name="L1787"></a>1787             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> | <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L1788" name="L1788"></a>1788                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1789" name="L1789"></a>1789             <em class="brace">}</em>
<a id="L1790" name="L1790"></a>1790             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1791" name="L1791"></a>1791         <em class="brace">}</em>
<a id="L1792" name="L1792"></a>1792         <strong class="reserved">private</strong>
<a id="L1793" name="L1793"></a>1793         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L1747" title="Referred from 1747 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodForConstant</a>(<strong class="reserved">byte</strong> refKind, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; defc, <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>)
<a id="L1794" name="L1794"></a>1794                 <strong class="reserved">throws</strong> <a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <em class="brace">{</em>
<a id="L1795" name="L1795"></a>1795             <strong class="reserved">if</strong> (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L194" title="Defined at 194 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsField</a>(refKind)) <em class="brace">{</em>
<a id="L1796" name="L1796"></a>1796                 <strong class="reserved">return</strong> <a href="../S/1619.html#L1687" title="Defined at 1687 in src/java/lang/invoke/MethodHandles.java.">getDirectFieldNoSecurityManager</a>(refKind, defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1797" name="L1797"></a>1797             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/1603.html#L40" title="Defined at 40 in src/java/lang/invoke/MethodHandleNatives.java.">MethodHandleNatives</a>.<a href="../S/1603.html#L205" title="Defined at 205 in src/java/lang/invoke/MethodHandleNatives.java.">refKindIsMethod</a>(refKind)) <em class="brace">{</em>
<a id="L1798" name="L1798"></a>1798                 <strong class="reserved">return</strong> <a href="../S/1619.html#L1610" title="Defined at 1610 in src/java/lang/invoke/MethodHandles.java.">getDirectMethodNoSecurityManager</a>(refKind, defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>, <a href="../D/27102.html" title="Multiple defined in 4 places.">lookupClass</a>);
<a id="L1799" name="L1799"></a>1799             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (refKind == REF_newInvokeSpecial) <em class="brace">{</em>
<a id="L1800" name="L1800"></a>1800                 <strong class="reserved">return</strong> <a href="../S/1619.html#L1711" title="Defined at 1711 in src/java/lang/invoke/MethodHandles.java.">getDirectConstructorNoSecurityManager</a>(defc, <a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1801" name="L1801"></a>1801             <em class="brace">}</em>
<a id="L1802" name="L1802"></a>1802             <em class="comment">// oops</em>
<a id="L1803" name="L1803"></a>1803             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("bad MethodHandle constant #"+<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>);
<a id="L1804" name="L1804"></a>1804         <em class="brace">}</em>
<a id="L1805" name="L1805"></a>1805 
<a id="L1806" name="L1806"></a>1806         <strong class="reserved">static</strong> <a href="../S/1074.html#L267" title="Defined at 267 in src/java/util/concurrent/ConcurrentHashMap.java.">ConcurrentHashMap</a>&lt;<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>, <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>&gt; LOOKASIDE_TABLE = <strong class="reserved">new</strong> <a href="../S/1074.html#L267" title="Defined at 267 in src/java/util/concurrent/ConcurrentHashMap.java.">ConcurrentHashMap</a>&lt;&gt;();
<a id="L1807" name="L1807"></a>1807     <em class="brace">}</em>
<a id="L1808" name="L1808"></a>1808 
<a id="L1809" name="L1809"></a>1809     <em class="comment">/**</em>
<a id="L1810" name="L1810"></a>1810 <em class="comment">     * Produces a method handle giving read access to elements of an array.</em>
<a id="L1811" name="L1811"></a>1811 <em class="comment">     * The type of the method handle will have a return type of the array's</em>
<a id="L1812" name="L1812"></a>1812 <em class="comment">     * element type.  Its first argument will be the array type,</em>
<a id="L1813" name="L1813"></a>1813 <em class="comment">     * and the second will be {@code int}.</em>
<a id="L1814" name="L1814"></a>1814 <em class="comment">     * @param arrayClass an array type</em>
<a id="L1815" name="L1815"></a>1815 <em class="comment">     * @return a method handle which can load values from the given array type</em>
<a id="L1816" name="L1816"></a>1816 <em class="comment">     * @throws NullPointerException if the argument is null</em>
<a id="L1817" name="L1817"></a>1817 <em class="comment">     * @throws  IllegalArgumentException if arrayClass is not an array type</em>
<a id="L1818" name="L1818"></a>1818 <em class="comment">     */</em>
<a id="L1819" name="L1819"></a>1819     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L1820" name="L1820"></a>1820     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/10316.html" title="Multiple referred from 2 places.">arrayElementGetter</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; arrayClass) <strong class="reserved">throws</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> <em class="brace">{</em>
<a id="L1821" name="L1821"></a>1821         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L71" title="Defined at 71 in src/java/lang/invoke/MethodHandleImpl.java.">makeArrayElementAccessor</a>(arrayClass, <strong class="reserved">false</strong>);
<a id="L1822" name="L1822"></a>1822     <em class="brace">}</em>
<a id="L1823" name="L1823"></a>1823 
<a id="L1824" name="L1824"></a>1824     <em class="comment">/**</em>
<a id="L1825" name="L1825"></a>1825 <em class="comment">     * Produces a method handle giving write access to elements of an array.</em>
<a id="L1826" name="L1826"></a>1826 <em class="comment">     * The type of the method handle will have a void return type.</em>
<a id="L1827" name="L1827"></a>1827 <em class="comment">     * Its last argument will be the array's element type.</em>
<a id="L1828" name="L1828"></a>1828 <em class="comment">     * The first and second arguments will be the array type and int.</em>
<a id="L1829" name="L1829"></a>1829 <em class="comment">     * @param arrayClass the class of an array</em>
<a id="L1830" name="L1830"></a>1830 <em class="comment">     * @return a method handle which can store values into the array type</em>
<a id="L1831" name="L1831"></a>1831 <em class="comment">     * @throws NullPointerException if the argument is null</em>
<a id="L1832" name="L1832"></a>1832 <em class="comment">     * @throws IllegalArgumentException if arrayClass is not an array type</em>
<a id="L1833" name="L1833"></a>1833 <em class="comment">     */</em>
<a id="L1834" name="L1834"></a>1834     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L1835" name="L1835"></a>1835     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> arrayElementSetter(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; arrayClass) <strong class="reserved">throws</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> <em class="brace">{</em>
<a id="L1836" name="L1836"></a>1836         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L71" title="Defined at 71 in src/java/lang/invoke/MethodHandleImpl.java.">makeArrayElementAccessor</a>(arrayClass, <strong class="reserved">true</strong>);
<a id="L1837" name="L1837"></a>1837     <em class="brace">}</em>
<a id="L1838" name="L1838"></a>1838 
<a id="L1839" name="L1839"></a>1839     <em class="comment">/// method handle invocation (reflective style)</em>
<a id="L1840" name="L1840"></a>1840 
<a id="L1841" name="L1841"></a>1841     <em class="comment">/**</em>
<a id="L1842" name="L1842"></a>1842 <em class="comment">     * Produces a method handle which will invoke any method handle of the</em>
<a id="L1843" name="L1843"></a>1843 <em class="comment">     * given {@code type}, with a given number of trailing arguments replaced by</em>
<a id="L1844" name="L1844"></a>1844 <em class="comment">     * a single trailing {@code Object[]} array.</em>
<a id="L1845" name="L1845"></a>1845 <em class="comment">     * The resulting invoker will be a method handle with the following</em>
<a id="L1846" name="L1846"></a>1846 <em class="comment">     * arguments:</em>
<a id="L1847" name="L1847"></a>1847 <em class="comment">     * <ul></ul></em>
<a id="L1848" name="L1848"></a>1848 <em class="comment">     * <li>a single {@code MethodHandle} target</li></em>
<a id="L1849" name="L1849"></a>1849 <em class="comment">     * <li>zero or more leading values (counted by {@code leadingArgCount})</li></em>
<a id="L1850" name="L1850"></a>1850 <em class="comment">     * <li>an {@code Object[]} array containing trailing arguments</li></em>
<a id="L1851" name="L1851"></a>1851 <em class="comment">     * </em>
<a id="L1852" name="L1852"></a>1852 <em class="comment">     * </em>
<a id="L1853" name="L1853"></a>1853 <em class="comment">     * The invoker will invoke its target like a call to {@link MethodHandle#invoke invoke} with</em>
<a id="L1854" name="L1854"></a>1854 <em class="comment">     * the indicated {@code type}.</em>
<a id="L1855" name="L1855"></a>1855 <em class="comment">     * That is, if the target is exactly of the given {@code type}, it will behave</em>
<a id="L1856" name="L1856"></a>1856 <em class="comment">     * like {@code invokeExact}; otherwise it behave as if {@link MethodHandle#asType asType}</em>
<a id="L1857" name="L1857"></a>1857 <em class="comment">     * is used to convert the target to the required {@code type}.</em>
<a id="L1858" name="L1858"></a>1858 <em class="comment">     * </em>
<a id="L1859" name="L1859"></a>1859 <em class="comment">     * The type of the returned invoker will not be the given {@code type}, but rather</em>
<a id="L1860" name="L1860"></a>1860 <em class="comment">     * will have all parameters except the first {@code leadingArgCount}</em>
<a id="L1861" name="L1861"></a>1861 <em class="comment">     * replaced by a single array of type {@code Object[]}, which will be</em>
<a id="L1862" name="L1862"></a>1862 <em class="comment">     * the final parameter.</em>
<a id="L1863" name="L1863"></a>1863 <em class="comment">     * </em>
<a id="L1864" name="L1864"></a>1864 <em class="comment">     * Before invoking its target, the invoker will spread the final array, apply</em>
<a id="L1865" name="L1865"></a>1865 <em class="comment">     * reference casts as necessary, and unbox and widen primitive arguments.</em>
<a id="L1866" name="L1866"></a>1866 <em class="comment">     * If, when the invoker is called, the supplied array argument does</em>
<a id="L1867" name="L1867"></a>1867 <em class="comment">     * not have the correct number of elements, the invoker will throw</em>
<a id="L1868" name="L1868"></a>1868 <em class="comment">     * an {@link IllegalArgumentException} instead of invoking the target.</em>
<a id="L1869" name="L1869"></a>1869 <em class="comment">     * </em>
<a id="L1870" name="L1870"></a>1870 <em class="comment">     * This method is equivalent to the following code (though it may be more efficient):</em>
<a id="L1871" name="L1871"></a>1871 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L1872" name="L1872"></a>1872 <em class="comment">MethodHandle invoker = MethodHandles.invoker(type);</em>
<a id="L1873" name="L1873"></a>1873 <em class="comment">int spreadArgCount = type.parameterCount() - leadingArgCount;</em>
<a id="L1874" name="L1874"></a>1874 <em class="comment">invoker = invoker.asSpreader(Object[].class, spreadArgCount);</em>
<a id="L1875" name="L1875"></a>1875 <em class="comment">return invoker;</em>
<a id="L1876" name="L1876"></a>1876 <em class="comment">     * }</em>
<a id="L1877" name="L1877"></a>1877 <em class="comment">     * This method throws no reflective or security exceptions.</em>
<a id="L1878" name="L1878"></a>1878 <em class="comment">     * @param type the desired target type</em>
<a id="L1879" name="L1879"></a>1879 <em class="comment">     * @param leadingArgCount number of fixed arguments, to be passed unchanged to the target</em>
<a id="L1880" name="L1880"></a>1880 <em class="comment">     * @return a method handle suitable for invoking any method handle of the given type</em>
<a id="L1881" name="L1881"></a>1881 <em class="comment">     * @throws NullPointerException if {@code type} is null</em>
<a id="L1882" name="L1882"></a>1882 <em class="comment">     * @throws IllegalArgumentException if {@code leadingArgCount} is not in</em>
<a id="L1883" name="L1883"></a>1883 <em class="comment">     *                  the range from 0 to {@code type.parameterCount()} inclusive,</em>
<a id="L1884" name="L1884"></a>1884 <em class="comment">     *                  or if the resulting method handle's type would have</em>
<a id="L1885" name="L1885"></a>1885 <em class="comment">     *          <a href="MethodHandle.html#maxarity">too many parameters</a></em>
<a id="L1886" name="L1886"></a>1886 <em class="comment">     */</em>
<a id="L1887" name="L1887"></a>1887     <strong class="reserved">static</strong> <strong class="reserved">public</strong>
<a id="L1888" name="L1888"></a>1888     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/28767.html" title="Multiple referred from 3 places.">spreadInvoker</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <strong class="reserved">int</strong> leadingArgCount) <em class="brace">{</em>
<a id="L1889" name="L1889"></a>1889         <strong class="reserved">if</strong> (leadingArgCount &lt; 0 || leadingArgCount &gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>())
<a id="L1890" name="L1890"></a>1890             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("bad argument count", leadingArgCount);
<a id="L1891" name="L1891"></a>1891         <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../R/29570.html" title="Multiple referred from 5977 places.">type</a>.<a href="../S/1616.html#L474" title="Defined at 474 in src/java/lang/invoke/MethodType.java.">asSpreaderType</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[].<strong class="reserved">class</strong>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() - leadingArgCount);
<a id="L1892" name="L1892"></a>1892         <strong class="reserved">return</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../D/34734.html" title="Multiple defined in 2 places.">spreadInvoker</a>(leadingArgCount);
<a id="L1893" name="L1893"></a>1893     <em class="brace">}</em>
<a id="L1894" name="L1894"></a>1894 
<a id="L1895" name="L1895"></a>1895     <em class="comment">/**</em>
<a id="L1896" name="L1896"></a>1896 <em class="comment">     * Produces a special <em>invoker method handle</em> which can be used to</em>
<a id="L1897" name="L1897"></a>1897 <em class="comment">     * invoke any method handle of the given type, as if by {@link MethodHandle#invokeExact invokeExact}.</em>
<a id="L1898" name="L1898"></a>1898 <em class="comment">     * The resulting invoker will have a type which is</em>
<a id="L1899" name="L1899"></a>1899 <em class="comment">     * exactly equal to the desired type, except that it will accept</em>
<a id="L1900" name="L1900"></a>1900 <em class="comment">     * an additional leading argument of type {@code MethodHandle}.</em>
<a id="L1901" name="L1901"></a>1901 <em class="comment">     * </em>
<a id="L1902" name="L1902"></a>1902 <em class="comment">     * This method is equivalent to the following code (though it may be more efficient):</em>
<a id="L1903" name="L1903"></a>1903 <em class="comment">     * {@code publicLookup().findVirtual(MethodHandle.class, "invokeExact", type)}</em>
<a id="L1904" name="L1904"></a>1904 <em class="comment">     *</em>
<a id="L1905" name="L1905"></a>1905 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L1906" name="L1906"></a>1906 <em class="comment">     * <em>Discussion:</em></em>
<a id="L1907" name="L1907"></a>1907 <em class="comment">     * Invoker method handles can be useful when working with variable method handles</em>
<a id="L1908" name="L1908"></a>1908 <em class="comment">     * of unknown types.</em>
<a id="L1909" name="L1909"></a>1909 <em class="comment">     * For example, to emulate an {@code invokeExact} call to a variable method</em>
<a id="L1910" name="L1910"></a>1910 <em class="comment">     * handle {@code M}, extract its type {@code T},</em>
<a id="L1911" name="L1911"></a>1911 <em class="comment">     * look up the invoker method {@code X} for {@code T},</em>
<a id="L1912" name="L1912"></a>1912 <em class="comment">     * and call the invoker method, as {@code X.invoke(T, A...)}.</em>
<a id="L1913" name="L1913"></a>1913 <em class="comment">     * (It would not work to call {@code X.invokeExact}, since the type {@code T}</em>
<a id="L1914" name="L1914"></a>1914 <em class="comment">     * is unknown.)</em>
<a id="L1915" name="L1915"></a>1915 <em class="comment">     * If spreading, collecting, or other argument transformations are required,</em>
<a id="L1916" name="L1916"></a>1916 <em class="comment">     * they can be applied once to the invoker {@code X} and reused on many {@code M}</em>
<a id="L1917" name="L1917"></a>1917 <em class="comment">     * method handle values, as long as they are compatible with the type of {@code X}.</em>
<a id="L1918" name="L1918"></a>1918 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L1919" name="L1919"></a>1919 <em class="comment">     * <em>(Note:  The invoker method is not available via the Core Reflection API.</em></em>
<a id="L1920" name="L1920"></a>1920 <em class="comment">     * An attempt to call {@linkplain java.lang.reflect.Method#invoke java.lang.reflect.Method.invoke}</em>
<a id="L1921" name="L1921"></a>1921 <em class="comment">     * on the declared {@code invokeExact} or {@code invoke} method will raise an</em>
<a id="L1922" name="L1922"></a>1922 <em class="comment">     * {@link java.lang.UnsupportedOperationException UnsupportedOperationException}.)</em>
<a id="L1923" name="L1923"></a>1923 <em class="comment">     * </em>
<a id="L1924" name="L1924"></a>1924 <em class="comment">     * This method throws no reflective or security exceptions.</em>
<a id="L1925" name="L1925"></a>1925 <em class="comment">     * @param type the desired target type</em>
<a id="L1926" name="L1926"></a>1926 <em class="comment">     * @return a method handle suitable for invoking any method handle of the given type</em>
<a id="L1927" name="L1927"></a>1927 <em class="comment">     * @throws IllegalArgumentException if the resulting method handle's type would have</em>
<a id="L1928" name="L1928"></a>1928 <em class="comment">     *          <a href="MethodHandle.html#maxarity">too many parameters</a></em>
<a id="L1929" name="L1929"></a>1929 <em class="comment">     */</em>
<a id="L1930" name="L1930"></a>1930     <strong class="reserved">static</strong> <strong class="reserved">public</strong>
<a id="L1931" name="L1931"></a>1931     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14062.html" title="Multiple referred from 3 places.">exactInvoker</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L1932" name="L1932"></a>1932         <strong class="reserved">return</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../D/15761.html" title="Multiple defined in 2 places.">exactInvoker</a>();
<a id="L1933" name="L1933"></a>1933     <em class="brace">}</em>
<a id="L1934" name="L1934"></a>1934 
<a id="L1935" name="L1935"></a>1935     <em class="comment">/**</em>
<a id="L1936" name="L1936"></a>1936 <em class="comment">     * Produces a special <em>invoker method handle</em> which can be used to</em>
<a id="L1937" name="L1937"></a>1937 <em class="comment">     * invoke any method handle compatible with the given type, as if by {@link MethodHandle#invoke invoke}.</em>
<a id="L1938" name="L1938"></a>1938 <em class="comment">     * The resulting invoker will have a type which is</em>
<a id="L1939" name="L1939"></a>1939 <em class="comment">     * exactly equal to the desired type, except that it will accept</em>
<a id="L1940" name="L1940"></a>1940 <em class="comment">     * an additional leading argument of type {@code MethodHandle}.</em>
<a id="L1941" name="L1941"></a>1941 <em class="comment">     * </em>
<a id="L1942" name="L1942"></a>1942 <em class="comment">     * Before invoking its target, if the target differs from the expected type,</em>
<a id="L1943" name="L1943"></a>1943 <em class="comment">     * the invoker will apply reference casts as</em>
<a id="L1944" name="L1944"></a>1944 <em class="comment">     * necessary and box, unbox, or widen primitive values, as if by {@link MethodHandle#asType asType}.</em>
<a id="L1945" name="L1945"></a>1945 <em class="comment">     * Similarly, the return value will be converted as necessary.</em>
<a id="L1946" name="L1946"></a>1946 <em class="comment">     * If the target is a {@linkplain MethodHandle#asVarargsCollector variable arity method handle},</em>
<a id="L1947" name="L1947"></a>1947 <em class="comment">     * the required arity conversion will be made, again as if by {@link MethodHandle#asType asType}.</em>
<a id="L1948" name="L1948"></a>1948 <em class="comment">     * </em>
<a id="L1949" name="L1949"></a>1949 <em class="comment">     * This method is equivalent to the following code (though it may be more efficient):</em>
<a id="L1950" name="L1950"></a>1950 <em class="comment">     * {@code publicLookup().findVirtual(MethodHandle.class, "invoke", type)}</em>
<a id="L1951" name="L1951"></a>1951 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L1952" name="L1952"></a>1952 <em class="comment">     * <em>Discussion:</em></em>
<a id="L1953" name="L1953"></a>1953 <em class="comment">     * A {@linkplain MethodType#genericMethodType general method type} is one which</em>
<a id="L1954" name="L1954"></a>1954 <em class="comment">     * mentions only {@code Object} arguments and return values.</em>
<a id="L1955" name="L1955"></a>1955 <em class="comment">     * An invoker for such a type is capable of calling any method handle</em>
<a id="L1956" name="L1956"></a>1956 <em class="comment">     * of the same arity as the general type.</em>
<a id="L1957" name="L1957"></a>1957 <em class="comment">     * <p style="font-size:smaller;"></p></em>
<a id="L1958" name="L1958"></a>1958 <em class="comment">     * <em>(Note:  The invoker method is not available via the Core Reflection API.</em></em>
<a id="L1959" name="L1959"></a>1959 <em class="comment">     * An attempt to call {@linkplain java.lang.reflect.Method#invoke java.lang.reflect.Method.invoke}</em>
<a id="L1960" name="L1960"></a>1960 <em class="comment">     * on the declared {@code invokeExact} or {@code invoke} method will raise an</em>
<a id="L1961" name="L1961"></a>1961 <em class="comment">     * {@link java.lang.UnsupportedOperationException UnsupportedOperationException}.)</em>
<a id="L1962" name="L1962"></a>1962 <em class="comment">     * </em>
<a id="L1963" name="L1963"></a>1963 <em class="comment">     * This method throws no reflective or security exceptions.</em>
<a id="L1964" name="L1964"></a>1964 <em class="comment">     * @param type the desired target type</em>
<a id="L1965" name="L1965"></a>1965 <em class="comment">     * @return a method handle suitable for invoking any method handle convertible to the given type</em>
<a id="L1966" name="L1966"></a>1966 <em class="comment">     * @throws IllegalArgumentException if the resulting method handle's type would have</em>
<a id="L1967" name="L1967"></a>1967 <em class="comment">     *          <a href="MethodHandle.html#maxarity">too many parameters</a></em>
<a id="L1968" name="L1968"></a>1968 <em class="comment">     */</em>
<a id="L1969" name="L1969"></a>1969     <strong class="reserved">static</strong> <strong class="reserved">public</strong>
<a id="L1970" name="L1970"></a>1970     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/21099.html" title="Multiple referred from 96 places.">invoker</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L1971" name="L1971"></a>1971         <strong class="reserved">return</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../S/1599.html#L67" title="Defined at 67 in src/java/lang/invoke/Invokers.java.">genericInvoker</a>();
<a id="L1972" name="L1972"></a>1972     <em class="brace">}</em>
<a id="L1973" name="L1973"></a>1973 
<a id="L1974" name="L1974"></a>1974     <strong class="reserved">static</strong> <em class="comment">/*non-public*/</em>
<a id="L1975" name="L1975"></a>1975     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/10542.html" title="Multiple referred from 6 places.">basicInvoker</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L1976" name="L1976"></a>1976         <strong class="reserved">return</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../D/11784.html" title="Multiple defined in 2 places.">basicInvoker</a>();
<a id="L1977" name="L1977"></a>1977     <em class="brace">}</em>
<a id="L1978" name="L1978"></a>1978 
<a id="L1979" name="L1979"></a>1979      <em class="comment">/// method handle modification (creation from other method handles)</em>
<a id="L1980" name="L1980"></a>1980 
<a id="L1981" name="L1981"></a>1981     <em class="comment">/**</em>
<a id="L1982" name="L1982"></a>1982 <em class="comment">     * Produces a method handle which adapts the type of the</em>
<a id="L1983" name="L1983"></a>1983 <em class="comment">     * given method handle to a new type by pairwise argument and return type conversion.</em>
<a id="L1984" name="L1984"></a>1984 <em class="comment">     * The original type and new type must have the same number of arguments.</em>
<a id="L1985" name="L1985"></a>1985 <em class="comment">     * The resulting method handle is guaranteed to report a type</em>
<a id="L1986" name="L1986"></a>1986 <em class="comment">     * which is equal to the desired new type.</em>
<a id="L1987" name="L1987"></a>1987 <em class="comment">     * </em>
<a id="L1988" name="L1988"></a>1988 <em class="comment">     * If the original type and new type are equal, returns target.</em>
<a id="L1989" name="L1989"></a>1989 <em class="comment">     * </em>
<a id="L1990" name="L1990"></a>1990 <em class="comment">     * The same conversions are allowed as for {@link MethodHandle#asType MethodHandle.asType},</em>
<a id="L1991" name="L1991"></a>1991 <em class="comment">     * and some additional conversions are also applied if those conversions fail.</em>
<a id="L1992" name="L1992"></a>1992 <em class="comment">     * Given types <em>T0</em>, <em>T1</em>, one of the following conversions is applied</em>
<a id="L1993" name="L1993"></a>1993 <em class="comment">     * if possible, before or instead of any conversions done by {@code asType}:</em>
<a id="L1994" name="L1994"></a>1994 <em class="comment">     * <ul></ul></em>
<a id="L1995" name="L1995"></a>1995 <em class="comment">     * <li>If <em>T0</em> and <em>T1</em> are references, and <em>T1</em> is an interface type,</li></em>
<a id="L1996" name="L1996"></a>1996 <em class="comment">     *     then the value of type <em>T0</em> is passed as a <em>T1</em> without a cast.</em>
<a id="L1997" name="L1997"></a>1997 <em class="comment">     *     (This treatment of interfaces follows the usage of the bytecode verifier.)</em>
<a id="L1998" name="L1998"></a>1998 <em class="comment">     * <li>If <em>T0</em> is boolean and <em>T1</em> is another primitive,</li></em>
<a id="L1999" name="L1999"></a>1999 <em class="comment">     *     the boolean is converted to a byte value, 1 for true, 0 for false.</em>
<a id="L2000" name="L2000"></a>2000 <em class="comment">     *     (This treatment follows the usage of the bytecode verifier.)</em>
<a id="L2001" name="L2001"></a>2001 <em class="comment">     * <li>If <em>T1</em> is boolean and <em>T0</em> is another primitive,</li></em>
<a id="L2002" name="L2002"></a>2002 <em class="comment">     *     <em>T0</em> is converted to byte via Java casting conversion (JLS 5.5),</em>
<a id="L2003" name="L2003"></a>2003 <em class="comment">     *     and the low order bit of the result is tested, as if by {@code (x &amp; 1) != 0}.</em>
<a id="L2004" name="L2004"></a>2004 <em class="comment">     * <li>If <em>T0</em> and <em>T1</em> are primitives other than boolean,</li></em>
<a id="L2005" name="L2005"></a>2005 <em class="comment">     *     then a Java casting conversion (JLS 5.5) is applied.</em>
<a id="L2006" name="L2006"></a>2006 <em class="comment">     *     (Specifically, <em>T0</em> will convert to <em>T1</em> by</em>
<a id="L2007" name="L2007"></a>2007 <em class="comment">     *     widening and/or narrowing.)</em>
<a id="L2008" name="L2008"></a>2008 <em class="comment">     * <li>If <em>T0</em> is a reference and <em>T1</em> a primitive, an unboxing</li></em>
<a id="L2009" name="L2009"></a>2009 <em class="comment">     *     conversion will be applied at runtime, possibly followed</em>
<a id="L2010" name="L2010"></a>2010 <em class="comment">     *     by a Java casting conversion (JLS 5.5) on the primitive value,</em>
<a id="L2011" name="L2011"></a>2011 <em class="comment">     *     possibly followed by a conversion from byte to boolean by testing</em>
<a id="L2012" name="L2012"></a>2012 <em class="comment">     *     the low-order bit.</em>
<a id="L2013" name="L2013"></a>2013 <em class="comment">     * <li>If <em>T0</em> is a reference and <em>T1</em> a primitive,</li></em>
<a id="L2014" name="L2014"></a>2014 <em class="comment">     *     and if the reference is null at runtime, a zero value is introduced.</em>
<a id="L2015" name="L2015"></a>2015 <em class="comment">     * </em>
<a id="L2016" name="L2016"></a>2016 <em class="comment">     * @param target the method handle to invoke after arguments are retyped</em>
<a id="L2017" name="L2017"></a>2017 <em class="comment">     * @param newType the expected type of the new method handle</em>
<a id="L2018" name="L2018"></a>2018 <em class="comment">     * @return a method handle which delegates to the target after performing</em>
<a id="L2019" name="L2019"></a>2019 <em class="comment">     *           any necessary argument conversions, and arranges for any</em>
<a id="L2020" name="L2020"></a>2020 <em class="comment">     *           necessary return value conversions</em>
<a id="L2021" name="L2021"></a>2021 <em class="comment">     * @throws NullPointerException if either argument is null</em>
<a id="L2022" name="L2022"></a>2022 <em class="comment">     * @throws WrongMethodTypeException if the conversion cannot be made</em>
<a id="L2023" name="L2023"></a>2023 <em class="comment">     * @see MethodHandle#asType</em>
<a id="L2024" name="L2024"></a>2024 <em class="comment">     */</em>
<a id="L2025" name="L2025"></a>2025     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2026" name="L2026"></a>2026     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> explicitCastArguments(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType) <em class="brace">{</em>
<a id="L2027" name="L2027"></a>2027         <a href="../S/1619.html#L2037" title="Defined at 2037 in src/java/lang/invoke/MethodHandles.java.">explicitCastArgumentsChecks</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, newType);
<a id="L2028" name="L2028"></a>2028         <em class="comment">// use the asTypeCache when possible:</em>
<a id="L2029" name="L2029"></a>2029         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2030" name="L2030"></a>2030         <strong class="reserved">if</strong> (oldType == newType)  <strong class="reserved">return</strong> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>;
<a id="L2031" name="L2031"></a>2031         <strong class="reserved">if</strong> (oldType.<a href="../D/15872.html" title="Multiple defined in 2 places.">explicitCastEquivalentToAsType</a>(newType)) <em class="brace">{</em>
<a id="L2032" name="L2032"></a>2032             <strong class="reserved">return</strong> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/11536.html" title="Multiple defined in 2 places.">asFixedArity</a>().<a href="../D/11568.html" title="Multiple defined in 2 places.">asType</a>(newType);
<a id="L2033" name="L2033"></a>2033         <em class="brace">}</em>
<a id="L2034" name="L2034"></a>2034         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/27364.html" title="Multiple defined in 2 places.">makePairwiseConvert</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, newType, <strong class="reserved">false</strong>);
<a id="L2035" name="L2035"></a>2035     <em class="brace">}</em>
<a id="L2036" name="L2036"></a>2036 
<a id="L2037" name="L2037"></a>2037     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/1619.html#L2027" title="Referred from 2027 in src/java/lang/invoke/MethodHandles.java.">explicitCastArgumentsChecks</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType) <em class="brace">{</em>
<a id="L2038" name="L2038"></a>2038         <strong class="reserved">if</strong> (<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>().<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() != newType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>()) <em class="brace">{</em>
<a id="L2039" name="L2039"></a>2039             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1605.html#L43" title="Defined at 43 in src/java/lang/invoke/WrongMethodTypeException.java.">WrongMethodTypeException</a>("cannot explicitly cast " + <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a> + " to " + newType);
<a id="L2040" name="L2040"></a>2040         <em class="brace">}</em>
<a id="L2041" name="L2041"></a>2041     <em class="brace">}</em>
<a id="L2042" name="L2042"></a>2042 
<a id="L2043" name="L2043"></a>2043     <em class="comment">/**</em>
<a id="L2044" name="L2044"></a>2044 <em class="comment">     * Produces a method handle which adapts the calling sequence of the</em>
<a id="L2045" name="L2045"></a>2045 <em class="comment">     * given method handle to a new type, by reordering the arguments.</em>
<a id="L2046" name="L2046"></a>2046 <em class="comment">     * The resulting method handle is guaranteed to report a type</em>
<a id="L2047" name="L2047"></a>2047 <em class="comment">     * which is equal to the desired new type.</em>
<a id="L2048" name="L2048"></a>2048 <em class="comment">     * </em>
<a id="L2049" name="L2049"></a>2049 <em class="comment">     * The given array controls the reordering.</em>
<a id="L2050" name="L2050"></a>2050 <em class="comment">     * Call {@code #I} the number of incoming parameters (the value</em>
<a id="L2051" name="L2051"></a>2051 <em class="comment">     * {@code newType.parameterCount()}, and call {@code #O} the number</em>
<a id="L2052" name="L2052"></a>2052 <em class="comment">     * of outgoing parameters (the value {@code target.type().parameterCount()}).</em>
<a id="L2053" name="L2053"></a>2053 <em class="comment">     * Then the length of the reordering array must be {@code #O},</em>
<a id="L2054" name="L2054"></a>2054 <em class="comment">     * and each element must be a non-negative number less than {@code #I}.</em>
<a id="L2055" name="L2055"></a>2055 <em class="comment">     * For every {@code N} less than {@code #O}, the {@code N}-th</em>
<a id="L2056" name="L2056"></a>2056 <em class="comment">     * outgoing argument will be taken from the {@code I}-th incoming</em>
<a id="L2057" name="L2057"></a>2057 <em class="comment">     * argument, where {@code I} is {@code reorder[N]}.</em>
<a id="L2058" name="L2058"></a>2058 <em class="comment">     * </em>
<a id="L2059" name="L2059"></a>2059 <em class="comment">     * No argument or return value conversions are applied.</em>
<a id="L2060" name="L2060"></a>2060 <em class="comment">     * The type of each incoming argument, as determined by {@code newType},</em>
<a id="L2061" name="L2061"></a>2061 <em class="comment">     * must be identical to the type of the corresponding outgoing parameter</em>
<a id="L2062" name="L2062"></a>2062 <em class="comment">     * or parameters in the target method handle.</em>
<a id="L2063" name="L2063"></a>2063 <em class="comment">     * The return type of {@code newType} must be identical to the return</em>
<a id="L2064" name="L2064"></a>2064 <em class="comment">     * type of the original target.</em>
<a id="L2065" name="L2065"></a>2065 <em class="comment">     * </em>
<a id="L2066" name="L2066"></a>2066 <em class="comment">     * The reordering array need not specify an actual permutation.</em>
<a id="L2067" name="L2067"></a>2067 <em class="comment">     * An incoming argument will be duplicated if its index appears</em>
<a id="L2068" name="L2068"></a>2068 <em class="comment">     * more than once in the array, and an incoming argument will be dropped</em>
<a id="L2069" name="L2069"></a>2069 <em class="comment">     * if its index does not appear in the array.</em>
<a id="L2070" name="L2070"></a>2070 <em class="comment">     * As in the case of {@link #dropArguments(MethodHandle,int,List) dropArguments},</em>
<a id="L2071" name="L2071"></a>2071 <em class="comment">     * incoming arguments which are not mentioned in the reordering array</em>
<a id="L2072" name="L2072"></a>2072 <em class="comment">     * are may be any type, as determined only by {@code newType}.</em>
<a id="L2073" name="L2073"></a>2073 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2074" name="L2074"></a>2074 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L2075" name="L2075"></a>2075 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L2076" name="L2076"></a>2076 <em class="comment">...</em>
<a id="L2077" name="L2077"></a>2077 <em class="comment">MethodType intfn1 = methodType(int.class, int.class);</em>
<a id="L2078" name="L2078"></a>2078 <em class="comment">MethodType intfn2 = methodType(int.class, int.class, int.class);</em>
<a id="L2079" name="L2079"></a>2079 <em class="comment">MethodHandle sub = ... (int x, int y) -&gt; (x-y) ...;</em>
<a id="L2080" name="L2080"></a>2080 <em class="comment">assert(sub.type().equals(intfn2));</em>
<a id="L2081" name="L2081"></a>2081 <em class="comment">MethodHandle sub1 = permuteArguments(sub, intfn2, 0, 1);</em>
<a id="L2082" name="L2082"></a>2082 <em class="comment">MethodHandle rsub = permuteArguments(sub, intfn2, 1, 0);</em>
<a id="L2083" name="L2083"></a>2083 <em class="comment">assert((int)rsub.invokeExact(1, 100) == 99);</em>
<a id="L2084" name="L2084"></a>2084 <em class="comment">MethodHandle add = ... (int x, int y) -&gt; (x+y) ...;</em>
<a id="L2085" name="L2085"></a>2085 <em class="comment">assert(add.type().equals(intfn2));</em>
<a id="L2086" name="L2086"></a>2086 <em class="comment">MethodHandle twice = permuteArguments(add, intfn1, 0, 0);</em>
<a id="L2087" name="L2087"></a>2087 <em class="comment">assert(twice.type().equals(intfn1));</em>
<a id="L2088" name="L2088"></a>2088 <em class="comment">assert((int)twice.invokeExact(21) == 42);</em>
<a id="L2089" name="L2089"></a>2089 <em class="comment">     * }</em>
<a id="L2090" name="L2090"></a>2090 <em class="comment">     * @param target the method handle to invoke after arguments are reordered</em>
<a id="L2091" name="L2091"></a>2091 <em class="comment">     * @param newType the expected type of the new method handle</em>
<a id="L2092" name="L2092"></a>2092 <em class="comment">     * @param reorder an index array which controls the reordering</em>
<a id="L2093" name="L2093"></a>2093 <em class="comment">     * @return a method handle which delegates to the target after it</em>
<a id="L2094" name="L2094"></a>2094 <em class="comment">     *           drops unused arguments and moves and/or duplicates the other arguments</em>
<a id="L2095" name="L2095"></a>2095 <em class="comment">     * @throws NullPointerException if any argument is null</em>
<a id="L2096" name="L2096"></a>2096 <em class="comment">     * @throws IllegalArgumentException if the index array length is not equal to</em>
<a id="L2097" name="L2097"></a>2097 <em class="comment">     *                  the arity of the target, or if any index array element</em>
<a id="L2098" name="L2098"></a>2098 <em class="comment">     *                  not a valid index for a parameter of {@code newType},</em>
<a id="L2099" name="L2099"></a>2099 <em class="comment">     *                  or if two corresponding parameter types in</em>
<a id="L2100" name="L2100"></a>2100 <em class="comment">     *                  {@code target.type()} and {@code newType} are not identical,</em>
<a id="L2101" name="L2101"></a>2101 <em class="comment">     */</em>
<a id="L2102" name="L2102"></a>2102     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2103" name="L2103"></a>2103     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> permuteArguments(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType, <strong class="reserved">int</strong>... reorder) <em class="brace">{</em>
<a id="L2104" name="L2104"></a>2104         reorder = reorder.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();  <em class="comment">// get a private copy</em>
<a id="L2105" name="L2105"></a>2105         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2106" name="L2106"></a>2106         <a href="../S/1619.html#L2224" title="Defined at 2224 in src/java/lang/invoke/MethodHandles.java.">permuteArgumentChecks</a>(reorder, newType, oldType);
<a id="L2107" name="L2107"></a>2107         <em class="comment">// first detect dropped arguments and handle them separately</em>
<a id="L2108" name="L2108"></a>2108         <strong class="reserved">int</strong>[] originalReorder = reorder;
<a id="L2109" name="L2109"></a>2109         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2110" name="L2110"></a>2110         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>;
<a id="L2111" name="L2111"></a>2111         <strong class="reserved">int</strong> newArity = newType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2112" name="L2112"></a>2112         <em class="comment">// Normalize the reordering into a real permutation,</em>
<a id="L2113" name="L2113"></a>2113         <em class="comment">// by removing duplicates and adding dropped elements.</em>
<a id="L2114" name="L2114"></a>2114         <em class="comment">// This somewhat improves lambda form caching, as well</em>
<a id="L2115" name="L2115"></a>2115         <em class="comment">// as simplifying the transform by breaking it up into steps.</em>
<a id="L2116" name="L2116"></a>2116         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> ddIdx; (ddIdx = <a href="../S/1619.html#L2175" title="Defined at 2175 in src/java/lang/invoke/MethodHandles.java.">findFirstDupOrDrop</a>(reorder, newArity)) != 0; ) <em class="brace">{</em>
<a id="L2117" name="L2117"></a>2117             <strong class="reserved">if</strong> (ddIdx &gt; 0) <em class="brace">{</em>
<a id="L2118" name="L2118"></a>2118                 <em class="comment">// We found a duplicated entry at reorder[ddIdx].</em>
<a id="L2119" name="L2119"></a>2119                 <em class="comment">// Example:  (x,y,z)-&gt;asList(x,y,z)</em>
<a id="L2120" name="L2120"></a>2120                 <em class="comment">// permuted by [1*,0,1] =&gt; (a0,a1)=&gt;asList(a1,a0,a1)</em>
<a id="L2121" name="L2121"></a>2121                 <em class="comment">// permuted by [0,1,0*] =&gt; (a0,a1)=&gt;asList(a0,a1,a0)</em>
<a id="L2122" name="L2122"></a>2122                 <em class="comment">// The starred element corresponds to the argument</em>
<a id="L2123" name="L2123"></a>2123                 <em class="comment">// deleted by the dupArgumentForm transform.</em>
<a id="L2124" name="L2124"></a>2124                 <strong class="reserved">int</strong> srcPos = ddIdx, dstPos = srcPos, dupVal = reorder[srcPos];
<a id="L2125" name="L2125"></a>2125                 <strong class="reserved">boolean</strong> killFirst = <strong class="reserved">false</strong>;
<a id="L2126" name="L2126"></a>2126                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>; (<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a> = reorder[--dstPos]) != dupVal; ) <em class="brace">{</em>
<a id="L2127" name="L2127"></a>2127                     <em class="comment">// Set killFirst if the dup is larger than an intervening position.</em>
<a id="L2128" name="L2128"></a>2128                     <em class="comment">// This will remove at least one inversion from the permutation.</em>
<a id="L2129" name="L2129"></a>2129                     <strong class="reserved">if</strong> (dupVal &gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) killFirst = <strong class="reserved">true</strong>;
<a id="L2130" name="L2130"></a>2130                 <em class="brace">}</em>
<a id="L2131" name="L2131"></a>2131                 <strong class="reserved">if</strong> (!killFirst) <em class="brace">{</em>
<a id="L2132" name="L2132"></a>2132                     srcPos = dstPos;
<a id="L2133" name="L2133"></a>2133                     dstPos = ddIdx;
<a id="L2134" name="L2134"></a>2134                 <em class="brace">}</em>
<a id="L2135" name="L2135"></a>2135                 <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L500" title="Defined at 500 in src/java/lang/invoke/LambdaFormEditor.java.">dupArgumentForm</a>(1 + srcPos, 1 + dstPos);
<a id="L2136" name="L2136"></a>2136                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> (reorder[srcPos] == reorder[dstPos]);
<a id="L2137" name="L2137"></a>2137                 oldType = oldType.<a href="../S/1616.html#L548" title="Defined at 548 in src/java/lang/invoke/MethodType.java.">dropParameterTypes</a>(dstPos, dstPos + 1);
<a id="L2138" name="L2138"></a>2138                 <em class="comment">// contract the reordering by removing the element at dstPos</em>
<a id="L2139" name="L2139"></a>2139                 <strong class="reserved">int</strong> tailPos = dstPos + 1;
<a id="L2140" name="L2140"></a>2140                 <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(reorder, tailPos, reorder, dstPos, reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - tailPos);
<a id="L2141" name="L2141"></a>2141                 reorder = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13512.html" title="Multiple defined in 12 places.">copyOf</a>(reorder, reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - 1);
<a id="L2142" name="L2142"></a>2142             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2143" name="L2143"></a>2143                 <strong class="reserved">int</strong> dropVal = ~ddIdx, insPos = 0;
<a id="L2144" name="L2144"></a>2144                 <strong class="reserved">while</strong> (insPos &lt; reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &amp;&amp; reorder[insPos] &lt; dropVal) <em class="brace">{</em>
<a id="L2145" name="L2145"></a>2145                     <em class="comment">// Find first element of reorder larger than dropVal.</em>
<a id="L2146" name="L2146"></a>2146                     <em class="comment">// This is where we will insert the dropVal.</em>
<a id="L2147" name="L2147"></a>2147                     insPos += 1;
<a id="L2148" name="L2148"></a>2148                 <em class="brace">}</em>
<a id="L2149" name="L2149"></a>2149                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype = newType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(dropVal);
<a id="L2150" name="L2150"></a>2150                 <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L483" title="Defined at 483 in src/java/lang/invoke/LambdaFormEditor.java.">addArgumentForm</a>(1 + insPos, <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(ptype));
<a id="L2151" name="L2151"></a>2151                 oldType = oldType.<a href="../D/24768.html" title="Multiple defined in 2 places.">insertParameterTypes</a>(insPos, ptype);
<a id="L2152" name="L2152"></a>2152                 <em class="comment">// expand the reordering by inserting an element at insPos</em>
<a id="L2153" name="L2153"></a>2153                 <strong class="reserved">int</strong> tailPos = insPos + 1;
<a id="L2154" name="L2154"></a>2154                 reorder = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13512.html" title="Multiple defined in 12 places.">copyOf</a>(reorder, reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> + 1);
<a id="L2155" name="L2155"></a>2155                 <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(reorder, insPos, reorder, tailPos, reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - tailPos);
<a id="L2156" name="L2156"></a>2156                 reorder[insPos] = dropVal;
<a id="L2157" name="L2157"></a>2157             <em class="brace">}</em>
<a id="L2158" name="L2158"></a>2158             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> (<a href="../S/1619.html#L2224" title="Defined at 2224 in src/java/lang/invoke/MethodHandles.java.">permuteArgumentChecks</a>(reorder, newType, oldType));
<a id="L2159" name="L2159"></a>2159         <em class="brace">}</em>
<a id="L2160" name="L2160"></a>2160         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> (reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> == newArity);  <em class="comment">// a perfect permutation</em>
<a id="L2161" name="L2161"></a>2161         <em class="comment">// Note:  This may cache too many distinct LFs. Consider backing off to varargs code.</em>
<a id="L2162" name="L2162"></a>2162         <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L774" title="Defined at 774 in src/java/lang/invoke/LambdaFormEditor.java.">permuteArgumentsForm</a>(1, reorder);
<a id="L2163" name="L2163"></a>2163         <strong class="reserved">if</strong> (newType == <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>() &amp;&amp; <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> == <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../S/1623.html#L1357" title="Defined at 1357 in src/java/lang/invoke/MethodHandle.java.">internalForm</a>())
<a id="L2164" name="L2164"></a>2164             <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2165" name="L2165"></a>2165         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13534.html" title="Multiple defined in 10 places.">copyWith</a>(newType, <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>);
<a id="L2166" name="L2166"></a>2166     <em class="brace">}</em>
<a id="L2167" name="L2167"></a>2167 
<a id="L2168" name="L2168"></a>2168     <em class="comment">/**</em>
<a id="L2169" name="L2169"></a>2169 <em class="comment">     * Return an indication of any duplicate or omission in reorder.</em>
<a id="L2170" name="L2170"></a>2170 <em class="comment">     * If the reorder contains a duplicate entry, return the index of the second occurrence.</em>
<a id="L2171" name="L2171"></a>2171 <em class="comment">     * Otherwise, return ~(n), for the first n in [0..newArity-1] that is not present in reorder.</em>
<a id="L2172" name="L2172"></a>2172 <em class="comment">     * Otherwise, return zero.</em>
<a id="L2173" name="L2173"></a>2173 <em class="comment">     * If an element not in [0..newArity-1] is encountered, return reorder.length.</em>
<a id="L2174" name="L2174"></a>2174 <em class="comment">     */</em>
<a id="L2175" name="L2175"></a>2175     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../S/1619.html#L2116" title="Referred from 2116 in src/java/lang/invoke/MethodHandles.java.">findFirstDupOrDrop</a>(<strong class="reserved">int</strong>[] reorder, <strong class="reserved">int</strong> newArity) <em class="brace">{</em>
<a id="L2176" name="L2176"></a>2176         <strong class="reserved">final</strong> <strong class="reserved">int</strong> BIT_LIMIT = 63;  <em class="comment">// max number of bits in bit mask</em>
<a id="L2177" name="L2177"></a>2177         <strong class="reserved">if</strong> (newArity &lt; BIT_LIMIT) <em class="brace">{</em>
<a id="L2178" name="L2178"></a>2178             <strong class="reserved">long</strong> <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> = 0;
<a id="L2179" name="L2179"></a>2179             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L2180" name="L2180"></a>2180                 <strong class="reserved">int</strong> <a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a> = reorder[i];
<a id="L2181" name="L2181"></a>2181                 <strong class="reserved">if</strong> (<a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a> &gt;= newArity) <em class="brace">{</em>
<a id="L2182" name="L2182"></a>2182                     <strong class="reserved">return</strong> reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L2183" name="L2183"></a>2183                 <em class="brace">}</em>
<a id="L2184" name="L2184"></a>2184                 <strong class="reserved">long</strong> <a href="../D/11869.html" title="Multiple defined in 2 places.">bit</a> = 1L &lt;&lt; <a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a>;
<a id="L2185" name="L2185"></a>2185                 <strong class="reserved">if</strong> ((<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> &amp; <a href="../D/11869.html" title="Multiple defined in 2 places.">bit</a>) != 0) <em class="brace">{</em>
<a id="L2186" name="L2186"></a>2186                     <strong class="reserved">return</strong> i;  <em class="comment">// &gt;0 indicates a dup</em>
<a id="L2187" name="L2187"></a>2187                 <em class="brace">}</em>
<a id="L2188" name="L2188"></a>2188                 <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> |= <a href="../D/11869.html" title="Multiple defined in 2 places.">bit</a>;
<a id="L2189" name="L2189"></a>2189             <em class="brace">}</em>
<a id="L2190" name="L2190"></a>2190             <strong class="reserved">if</strong> (<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> == (1L &lt;&lt; newArity) - 1) <em class="brace">{</em>
<a id="L2191" name="L2191"></a>2191                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.<a href="../D/28379.html" title="Multiple defined in 2 places.">numberOfTrailingZeros</a>(<a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.<a href="../D/27183.html" title="Multiple defined in 2 places.">lowestOneBit</a>(~<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>)) == newArity);
<a id="L2192" name="L2192"></a>2192                 <strong class="reserved">return</strong> 0;
<a id="L2193" name="L2193"></a>2193             <em class="brace">}</em>
<a id="L2194" name="L2194"></a>2194             <em class="comment">// find first zero</em>
<a id="L2195" name="L2195"></a>2195             <strong class="reserved">long</strong> zeroBit = <a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.<a href="../D/27183.html" title="Multiple defined in 2 places.">lowestOneBit</a>(~<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>);
<a id="L2196" name="L2196"></a>2196             <strong class="reserved">int</strong> zeroPos = <a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.<a href="../D/28379.html" title="Multiple defined in 2 places.">numberOfTrailingZeros</a>(zeroBit);
<a id="L2197" name="L2197"></a>2197             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(zeroPos &lt;= newArity);
<a id="L2198" name="L2198"></a>2198             <strong class="reserved">if</strong> (zeroPos == newArity) <em class="brace">{</em>
<a id="L2199" name="L2199"></a>2199                 <strong class="reserved">return</strong> 0;
<a id="L2200" name="L2200"></a>2200             <em class="brace">}</em>
<a id="L2201" name="L2201"></a>2201             <strong class="reserved">return</strong> ~zeroPos;
<a id="L2202" name="L2202"></a>2202         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2203" name="L2203"></a>2203             <em class="comment">// same algorithm, different bit set</em>
<a id="L2204" name="L2204"></a>2204             <a href="../S/856.html#L65" title="Defined at 65 in src/java/util/BitSet.java.">BitSet</a> <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a> = <strong class="reserved">new</strong> <a href="../S/856.html#L65" title="Defined at 65 in src/java/util/BitSet.java.">BitSet</a>(newArity);
<a id="L2205" name="L2205"></a>2205             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L2206" name="L2206"></a>2206                 <strong class="reserved">int</strong> <a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a> = reorder[i];
<a id="L2207" name="L2207"></a>2207                 <strong class="reserved">if</strong> (<a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a> &gt;= newArity) <em class="brace">{</em>
<a id="L2208" name="L2208"></a>2208                     <strong class="reserved">return</strong> reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L2209" name="L2209"></a>2209                 <em class="brace">}</em>
<a id="L2210" name="L2210"></a>2210                 <strong class="reserved">if</strong> (<a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a>)) <em class="brace">{</em>
<a id="L2211" name="L2211"></a>2211                     <strong class="reserved">return</strong> i;  <em class="comment">// &gt;0 indicates a dup</em>
<a id="L2212" name="L2212"></a>2212                 <em class="brace">}</em>
<a id="L2213" name="L2213"></a>2213                 <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>.<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>(<a href="../D/11479.html" title="Multiple defined in 2 places.">arg</a>);
<a id="L2214" name="L2214"></a>2214             <em class="brace">}</em>
<a id="L2215" name="L2215"></a>2215             <strong class="reserved">int</strong> zeroPos = <a href="../S/915.html#L394" title="Defined at 394 in src/java/util/stream/StreamOpFlag.java.">mask</a>.nextClearBit(0);
<a id="L2216" name="L2216"></a>2216             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(zeroPos &lt;= newArity);
<a id="L2217" name="L2217"></a>2217             <strong class="reserved">if</strong> (zeroPos == newArity) <em class="brace">{</em>
<a id="L2218" name="L2218"></a>2218                 <strong class="reserved">return</strong> 0;
<a id="L2219" name="L2219"></a>2219             <em class="brace">}</em>
<a id="L2220" name="L2220"></a>2220             <strong class="reserved">return</strong> ~zeroPos;
<a id="L2221" name="L2221"></a>2221         <em class="brace">}</em>
<a id="L2222" name="L2222"></a>2222     <em class="brace">}</em>
<a id="L2223" name="L2223"></a>2223 
<a id="L2224" name="L2224"></a>2224     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/24727.html" title="Multiple referred from 2 places.">permuteArgumentChecks</a>(<strong class="reserved">int</strong>[] reorder, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType) <em class="brace">{</em>
<a id="L2225" name="L2225"></a>2225         <strong class="reserved">if</strong> (newType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != oldType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>())
<a id="L2226" name="L2226"></a>2226             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("return types do not match",
<a id="L2227" name="L2227"></a>2227                     oldType, newType);
<a id="L2228" name="L2228"></a>2228         <strong class="reserved">if</strong> (reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> == oldType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>()) <em class="brace">{</em>
<a id="L2229" name="L2229"></a>2229             <strong class="reserved">int</strong> <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a> = newType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2230" name="L2230"></a>2230             <strong class="reserved">boolean</strong> bad = <strong class="reserved">false</strong>;
<a id="L2231" name="L2231"></a>2231             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> j = 0; j &lt; reorder.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; j++) <em class="brace">{</em>
<a id="L2232" name="L2232"></a>2232                 <strong class="reserved">int</strong> i = reorder[j];
<a id="L2233" name="L2233"></a>2233                 <strong class="reserved">if</strong> (i &lt; 0 || i &gt;= <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) <em class="brace">{</em>
<a id="L2234" name="L2234"></a>2234                     bad = <strong class="reserved">true</strong>; <strong class="reserved">break</strong>;
<a id="L2235" name="L2235"></a>2235                 <em class="brace">}</em>
<a id="L2236" name="L2236"></a>2236                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; src = newType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(i);
<a id="L2237" name="L2237"></a>2237                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; dst = oldType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(j);
<a id="L2238" name="L2238"></a>2238                 <strong class="reserved">if</strong> (src != dst)
<a id="L2239" name="L2239"></a>2239                     <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("parameter types do not match after reorder",
<a id="L2240" name="L2240"></a>2240                             oldType, newType);
<a id="L2241" name="L2241"></a>2241             <em class="brace">}</em>
<a id="L2242" name="L2242"></a>2242             <strong class="reserved">if</strong> (!bad)  <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2243" name="L2243"></a>2243         <em class="brace">}</em>
<a id="L2244" name="L2244"></a>2244         <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("bad reorder array: "+<a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(reorder));
<a id="L2245" name="L2245"></a>2245     <em class="brace">}</em>
<a id="L2246" name="L2246"></a>2246 
<a id="L2247" name="L2247"></a>2247     <em class="comment">/**</em>
<a id="L2248" name="L2248"></a>2248 <em class="comment">     * Produces a method handle of the requested return type which returns the given</em>
<a id="L2249" name="L2249"></a>2249 <em class="comment">     * constant value every time it is invoked.</em>
<a id="L2250" name="L2250"></a>2250 <em class="comment">     * </em>
<a id="L2251" name="L2251"></a>2251 <em class="comment">     * Before the method handle is returned, the passed-in value is converted to the requested type.</em>
<a id="L2252" name="L2252"></a>2252 <em class="comment">     * If the requested type is primitive, widening primitive conversions are attempted,</em>
<a id="L2253" name="L2253"></a>2253 <em class="comment">     * else reference conversions are attempted.</em>
<a id="L2254" name="L2254"></a>2254 <em class="comment">     * The returned method handle is equivalent to {@code identity(type).bindTo(value)}.</em>
<a id="L2255" name="L2255"></a>2255 <em class="comment">     * @param type the return type of the desired method handle</em>
<a id="L2256" name="L2256"></a>2256 <em class="comment">     * @param value the value to return</em>
<a id="L2257" name="L2257"></a>2257 <em class="comment">     * @return a method handle of the given return type and no arguments, which always returns the given value</em>
<a id="L2258" name="L2258"></a>2258 <em class="comment">     * @throws NullPointerException if the {@code type} argument is null</em>
<a id="L2259" name="L2259"></a>2259 <em class="comment">     * @throws ClassCastException if the value cannot be converted to the required return type</em>
<a id="L2260" name="L2260"></a>2260 <em class="comment">     * @throws IllegalArgumentException if the given type is {@code void.class}</em>
<a id="L2261" name="L2261"></a>2261 <em class="comment">     */</em>
<a id="L2262" name="L2262"></a>2262     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2263" name="L2263"></a>2263     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/11916.html" title="Multiple referred from 68 places.">constant</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>) <em class="brace">{</em>
<a id="L2264" name="L2264"></a>2264         <strong class="reserved">if</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/26086.html" title="Multiple defined in 8 places.">isPrimitive</a>()) <em class="brace">{</em>
<a id="L2265" name="L2265"></a>2265             <strong class="reserved">if</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <strong class="reserved">void</strong>.<strong class="reserved">class</strong>)
<a id="L2266" name="L2266"></a>2266                 <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("void type");
<a id="L2267" name="L2267"></a>2267             <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a> w = <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.forPrimitiveType(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2268" name="L2268"></a>2268             <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = w.<a href="../D/13388.html" title="Multiple defined in 7 places.">convert</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2269" name="L2269"></a>2269             <strong class="reserved">if</strong> (w.<a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>))
<a id="L2270" name="L2270"></a>2270                 <strong class="reserved">return</strong> <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>(w, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2271" name="L2271"></a>2271             <strong class="reserved">return</strong> <a href="../S/1619.html#L2363" title="Defined at 2363 in src/java/lang/invoke/MethodHandles.java.">insertArguments</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>), 0, <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2272" name="L2272"></a>2272         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2273" name="L2273"></a>2273             <strong class="reserved">if</strong> (<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> == <strong class="reserved">null</strong>)
<a id="L2274" name="L2274"></a>2274                 <strong class="reserved">return</strong> <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>(<a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.OBJECT, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2275" name="L2275"></a>2275             <strong class="reserved">return</strong> <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>).<a href="../S/1623.html#L1275" title="Defined at 1275 in src/java/lang/invoke/MethodHandle.java.">bindTo</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2276" name="L2276"></a>2276         <em class="brace">}</em>
<a id="L2277" name="L2277"></a>2277     <em class="brace">}</em>
<a id="L2278" name="L2278"></a>2278 
<a id="L2279" name="L2279"></a>2279     <em class="comment">/**</em>
<a id="L2280" name="L2280"></a>2280 <em class="comment">     * Produces a method handle which returns its sole argument when invoked.</em>
<a id="L2281" name="L2281"></a>2281 <em class="comment">     * @param type the type of the sole parameter and return value of the desired method handle</em>
<a id="L2282" name="L2282"></a>2282 <em class="comment">     * @return a unary method handle which accepts and returns the given type</em>
<a id="L2283" name="L2283"></a>2283 <em class="comment">     * @throws NullPointerException if the argument is null</em>
<a id="L2284" name="L2284"></a>2284 <em class="comment">     * @throws IllegalArgumentException if the given type is {@code void.class}</em>
<a id="L2285" name="L2285"></a>2285 <em class="comment">     */</em>
<a id="L2286" name="L2286"></a>2286     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2287" name="L2287"></a>2287     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/20368.html" title="Multiple referred from 354 places.">identity</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L2288" name="L2288"></a>2288         <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a> btw = (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>.<a href="../D/26086.html" title="Multiple defined in 8 places.">isPrimitive</a>() ? <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.forPrimitiveType(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) : <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.OBJECT);
<a id="L2289" name="L2289"></a>2289         <strong class="reserved">int</strong> pos = btw.<a href="../D/28579.html" title="Multiple defined in 2 places.">ordinal</a>();
<a id="L2290" name="L2290"></a>2290         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> ident = IDENTITY_MHS[pos];
<a id="L2291" name="L2291"></a>2291         <strong class="reserved">if</strong> (ident == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2292" name="L2292"></a>2292             ident = <a href="../D/32076.html" title="Multiple defined in 2 places.">setCachedMethodHandle</a>(IDENTITY_MHS, pos, <a href="../S/1619.html#L2301" title="Defined at 2301 in src/java/lang/invoke/MethodHandles.java.">makeIdentity</a>(btw.<a href="../S/3493.html#L58" title="Defined at 58 in src/javax/management/loading/MLetObjectInputStream.java.">primitiveType</a>()));
<a id="L2293" name="L2293"></a>2293         <em class="brace">}</em>
<a id="L2294" name="L2294"></a>2294         <strong class="reserved">if</strong> (ident.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>().<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L2295" name="L2295"></a>2295             <strong class="reserved">return</strong> ident;
<a id="L2296" name="L2296"></a>2296         <em class="comment">// something like identity(Foo.class); do not bother to intern these</em>
<a id="L2297" name="L2297"></a>2297         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(btw == <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.OBJECT);
<a id="L2298" name="L2298"></a>2298         <strong class="reserved">return</strong> <a href="../S/1619.html#L2301" title="Defined at 2301 in src/java/lang/invoke/MethodHandles.java.">makeIdentity</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L2299" name="L2299"></a>2299     <em class="brace">}</em>
<a id="L2300" name="L2300"></a>2300     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] IDENTITY_MHS = <strong class="reserved">new</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[<a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.<a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>().<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L2301" name="L2301"></a>2301     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/22914.html" title="Multiple referred from 2 places.">makeIdentity</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype) <em class="brace">{</em>
<a id="L2302" name="L2302"></a>2302         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype = <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../D/27690.html" title="Multiple defined in 8 places.">methodType</a>(ptype, ptype);
<a id="L2303" name="L2303"></a>2303         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a>.<a href="../S/1626.html#L1706" title="Defined at 1706 in src/java/lang/invoke/LambdaForm.java.">identityForm</a>(<a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(ptype));
<a id="L2304" name="L2304"></a>2304         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/27315.html" title="Multiple defined in 2 places.">makeIntrinsic</a>(mtype, lform, <a href="../S/1634.html#L1313" title="Defined at 1313 in src/java/lang/invoke/MethodHandleImpl.java.">Intrinsic</a>.IDENTITY);
<a id="L2305" name="L2305"></a>2305     <em class="brace">}</em>
<a id="L2306" name="L2306"></a>2306 
<a id="L2307" name="L2307"></a>2307     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/30858.html" title="Multiple referred from 51 places.">zero</a>(<a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a> btw, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>) <em class="brace">{</em>
<a id="L2308" name="L2308"></a>2308         <strong class="reserved">int</strong> pos = btw.<a href="../D/28579.html" title="Multiple defined in 2 places.">ordinal</a>();
<a id="L2309" name="L2309"></a>2309         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a> = ZERO_MHS[pos];
<a id="L2310" name="L2310"></a>2310         <strong class="reserved">if</strong> (<a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2311" name="L2311"></a>2311             <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a> = <a href="../D/32076.html" title="Multiple defined in 2 places.">setCachedMethodHandle</a>(ZERO_MHS, pos, <a href="../S/1619.html#L2319" title="Defined at 2319 in src/java/lang/invoke/MethodHandles.java.">makeZero</a>(btw.<a href="../S/3493.html#L58" title="Defined at 58 in src/javax/management/loading/MLetObjectInputStream.java.">primitiveType</a>()));
<a id="L2312" name="L2312"></a>2312         <em class="brace">}</em>
<a id="L2313" name="L2313"></a>2313         <strong class="reserved">if</strong> (<a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>().<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() == <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>)
<a id="L2314" name="L2314"></a>2314             <strong class="reserved">return</strong> <a href="../S/1619.html#L2307" title="Defined at 2307 in src/java/lang/invoke/MethodHandles.java.">zero</a>;
<a id="L2315" name="L2315"></a>2315         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(btw == <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.OBJECT);
<a id="L2316" name="L2316"></a>2316         <strong class="reserved">return</strong> <a href="../S/1619.html#L2319" title="Defined at 2319 in src/java/lang/invoke/MethodHandles.java.">makeZero</a>(<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>);
<a id="L2317" name="L2317"></a>2317     <em class="brace">}</em>
<a id="L2318" name="L2318"></a>2318     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] ZERO_MHS = <strong class="reserved">new</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[<a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.<a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>().<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L2319" name="L2319"></a>2319     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/23027.html" title="Multiple referred from 2 places.">makeZero</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>) <em class="brace">{</em>
<a id="L2320" name="L2320"></a>2320         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype = <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../D/27690.html" title="Multiple defined in 8 places.">methodType</a>(<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>);
<a id="L2321" name="L2321"></a>2321         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a>.<a href="../S/1626.html#L1709" title="Defined at 1709 in src/java/lang/invoke/LambdaForm.java.">zeroForm</a>(<a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>));
<a id="L2322" name="L2322"></a>2322         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/27315.html" title="Multiple defined in 2 places.">makeIntrinsic</a>(mtype, lform, <a href="../S/1634.html#L1313" title="Defined at 1313 in src/java/lang/invoke/MethodHandleImpl.java.">Intrinsic</a>.ZERO);
<a id="L2323" name="L2323"></a>2323     <em class="brace">}</em>
<a id="L2324" name="L2324"></a>2324 
<a id="L2325" name="L2325"></a>2325     <strong class="reserved">synchronized</strong> <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/26991.html" title="Multiple referred from 6 places.">setCachedMethodHandle</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] <a href="../S/2005.html#L328" title="Defined at 328 in src/java/nio/charset/Charset.java.">cache</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>) <em class="brace">{</em>
<a id="L2326" name="L2326"></a>2326         <em class="comment">// Simulate a CAS, to avoid racy duplication of results.</em>
<a id="L2327" name="L2327"></a>2327         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> prev = <a href="../S/2005.html#L328" title="Defined at 328 in src/java/nio/charset/Charset.java.">cache</a>[pos];
<a id="L2328" name="L2328"></a>2328         <strong class="reserved">if</strong> (prev != <strong class="reserved">null</strong>) <strong class="reserved">return</strong> prev;
<a id="L2329" name="L2329"></a>2329         <strong class="reserved">return</strong> <a href="../S/2005.html#L328" title="Defined at 328 in src/java/nio/charset/Charset.java.">cache</a>[pos] = <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>;
<a id="L2330" name="L2330"></a>2330     <em class="brace">}</em>
<a id="L2331" name="L2331"></a>2331 
<a id="L2332" name="L2332"></a>2332     <em class="comment">/**</em>
<a id="L2333" name="L2333"></a>2333 <em class="comment">     * Provides a target method handle with one or more <em>bound arguments</em></em>
<a id="L2334" name="L2334"></a>2334 <em class="comment">     * in advance of the method handle's invocation.</em>
<a id="L2335" name="L2335"></a>2335 <em class="comment">     * The formal parameters to the target corresponding to the bound</em>
<a id="L2336" name="L2336"></a>2336 <em class="comment">     * arguments are called <em>bound parameters</em>.</em>
<a id="L2337" name="L2337"></a>2337 <em class="comment">     * Returns a new method handle which saves away the bound arguments.</em>
<a id="L2338" name="L2338"></a>2338 <em class="comment">     * When it is invoked, it receives arguments for any non-bound parameters,</em>
<a id="L2339" name="L2339"></a>2339 <em class="comment">     * binds the saved arguments to their corresponding parameters,</em>
<a id="L2340" name="L2340"></a>2340 <em class="comment">     * and calls the original target.</em>
<a id="L2341" name="L2341"></a>2341 <em class="comment">     * </em>
<a id="L2342" name="L2342"></a>2342 <em class="comment">     * The type of the new method handle will drop the types for the bound</em>
<a id="L2343" name="L2343"></a>2343 <em class="comment">     * parameters from the original target type, since the new method handle</em>
<a id="L2344" name="L2344"></a>2344 <em class="comment">     * will no longer require those arguments to be supplied by its callers.</em>
<a id="L2345" name="L2345"></a>2345 <em class="comment">     * </em>
<a id="L2346" name="L2346"></a>2346 <em class="comment">     * Each given argument object must match the corresponding bound parameter type.</em>
<a id="L2347" name="L2347"></a>2347 <em class="comment">     * If a bound parameter type is a primitive, the argument object</em>
<a id="L2348" name="L2348"></a>2348 <em class="comment">     * must be a wrapper, and will be unboxed to produce the primitive value.</em>
<a id="L2349" name="L2349"></a>2349 <em class="comment">     * </em>
<a id="L2350" name="L2350"></a>2350 <em class="comment">     * The {@code pos} argument selects which parameters are to be bound.</em>
<a id="L2351" name="L2351"></a>2351 <em class="comment">     * It may range between zero and <i>N-L</i> (inclusively),</em>
<a id="L2352" name="L2352"></a>2352 <em class="comment">     * where <i>N</i> is the arity of the target method handle</em>
<a id="L2353" name="L2353"></a>2353 <em class="comment">     * and <i>L</i> is the length of the values array.</em>
<a id="L2354" name="L2354"></a>2354 <em class="comment">     * @param target the method handle to invoke after the argument is inserted</em>
<a id="L2355" name="L2355"></a>2355 <em class="comment">     * @param pos where to insert the argument (zero for the first)</em>
<a id="L2356" name="L2356"></a>2356 <em class="comment">     * @param values the series of arguments to insert</em>
<a id="L2357" name="L2357"></a>2357 <em class="comment">     * @return a method handle which inserts an additional argument,</em>
<a id="L2358" name="L2358"></a>2358 <em class="comment">     *         before calling the original method handle</em>
<a id="L2359" name="L2359"></a>2359 <em class="comment">     * @throws NullPointerException if the target or the {@code values} array is null</em>
<a id="L2360" name="L2360"></a>2360 <em class="comment">     * @see MethodHandle#bindTo</em>
<a id="L2361" name="L2361"></a>2361 <em class="comment">     */</em>
<a id="L2362" name="L2362"></a>2362     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2363" name="L2363"></a>2363     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/20755.html" title="Multiple referred from 2 places.">insertArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>... <a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>) <em class="brace">{</em>
<a id="L2364" name="L2364"></a>2364         <strong class="reserved">int</strong> insCount = <a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L2365" name="L2365"></a>2365         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;[] <a href="../S/1616.html#L127" title="Defined at 127 in src/java/lang/invoke/MethodType.java.">ptypes</a> = <a href="../S/1619.html#L2395" title="Defined at 2395 in src/java/lang/invoke/MethodHandles.java.">insertArgumentsChecks</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, insCount, pos);
<a id="L2366" name="L2366"></a>2366         <strong class="reserved">if</strong> (insCount == 0)  <strong class="reserved">return</strong> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>;
<a id="L2367" name="L2367"></a>2367         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2368" name="L2368"></a>2368         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; insCount; i++) <em class="brace">{</em>
<a id="L2369" name="L2369"></a>2369             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = <a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>[i];
<a id="L2370" name="L2370"></a>2370             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype = <a href="../S/1616.html#L127" title="Defined at 127 in src/java/lang/invoke/MethodType.java.">ptypes</a>[pos+i];
<a id="L2371" name="L2371"></a>2371             <strong class="reserved">if</strong> (ptype.<a href="../D/26086.html" title="Multiple defined in 8 places.">isPrimitive</a>()) <em class="brace">{</em>
<a id="L2372" name="L2372"></a>2372                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/1619.html#L2381" title="Defined at 2381 in src/java/lang/invoke/MethodHandles.java.">insertArgumentPrimitive</a>(<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>, pos, ptype, <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2373" name="L2373"></a>2373             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2374" name="L2374"></a>2374                 <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = ptype.<a href="../D/12274.html" title="Multiple defined in 6 places.">cast</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);  <em class="comment">// throw CCE if needed</em>
<a id="L2375" name="L2375"></a>2375                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11851.html" title="Multiple defined in 3 places.">bindArgumentL</a>(pos, <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2376" name="L2376"></a>2376             <em class="brace">}</em>
<a id="L2377" name="L2377"></a>2377         <em class="brace">}</em>
<a id="L2378" name="L2378"></a>2378         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2379" name="L2379"></a>2379     <em class="brace">}</em>
<a id="L2380" name="L2380"></a>2380 
<a id="L2381" name="L2381"></a>2381     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../S/1619.html#L2372" title="Referred from 2372 in src/java/lang/invoke/MethodHandles.java.">insertArgumentPrimitive</a>(<a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>, <strong class="reserved">int</strong> pos,
<a id="L2382" name="L2382"></a>2382                                                              <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>) <em class="brace">{</em>
<a id="L2383" name="L2383"></a>2383         <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a> w = <a href="../S/2566.html#L42" title="Defined at 42 in src/java/sql/Wrapper.java.">Wrapper</a>.forPrimitiveType(ptype);
<a id="L2384" name="L2384"></a>2384         <em class="comment">// perform unboxing and/or primitive conversion</em>
<a id="L2385" name="L2385"></a>2385         <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = w.<a href="../D/13388.html" title="Multiple defined in 7 places.">convert</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>, ptype);
<a id="L2386" name="L2386"></a>2386         <strong class="reserved">switch</strong> (w) <em class="brace">{</em>
<a id="L2387" name="L2387"></a>2387         <strong class="reserved">case</strong> INT:     <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11849.html" title="Multiple defined in 2 places.">bindArgumentI</a>(pos, (<strong class="reserved">int</strong>)<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2388" name="L2388"></a>2388         <strong class="reserved">case</strong> LONG:    <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11850.html" title="Multiple defined in 2 places.">bindArgumentJ</a>(pos, (<strong class="reserved">long</strong>)<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2389" name="L2389"></a>2389         <strong class="reserved">case</strong> <a href="../S/2603.html#L59" title="Defined at 59 in src/java/sql/JDBCType.java.">FLOAT</a>:   <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11847.html" title="Multiple defined in 2 places.">bindArgumentF</a>(pos, (<strong class="reserved">float</strong>)<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2390" name="L2390"></a>2390         <strong class="reserved">case</strong> <a href="../S/2603.html#L67" title="Defined at 67 in src/java/sql/JDBCType.java.">DOUBLE</a>:  <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11846.html" title="Multiple defined in 2 places.">bindArgumentD</a>(pos, (<strong class="reserved">double</strong>)<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>);
<a id="L2391" name="L2391"></a>2391         <strong class="reserved">default</strong>:      <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11849.html" title="Multiple defined in 2 places.">bindArgumentI</a>(pos, ValueConversions.widenSubword(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>));
<a id="L2392" name="L2392"></a>2392         <em class="brace">}</em>
<a id="L2393" name="L2393"></a>2393     <em class="brace">}</em>
<a id="L2394" name="L2394"></a>2394 
<a id="L2395" name="L2395"></a>2395     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;[] <a href="../S/1619.html#L2365" title="Referred from 2365 in src/java/lang/invoke/MethodHandles.java.">insertArgumentsChecks</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> insCount, <strong class="reserved">int</strong> pos) <strong class="reserved">throws</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <em class="brace">{</em>
<a id="L2396" name="L2396"></a>2396         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2397" name="L2397"></a>2397         <strong class="reserved">int</strong> outargs = oldType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2398" name="L2398"></a>2398         <strong class="reserved">int</strong> inargs  = outargs - insCount;
<a id="L2399" name="L2399"></a>2399         <strong class="reserved">if</strong> (inargs &lt; 0)
<a id="L2400" name="L2400"></a>2400             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("too many values to insert");
<a id="L2401" name="L2401"></a>2401         <strong class="reserved">if</strong> (pos &lt; 0 || pos &gt; inargs)
<a id="L2402" name="L2402"></a>2402             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("no argument type to append");
<a id="L2403" name="L2403"></a>2403         <strong class="reserved">return</strong> oldType.<a href="../S/1616.html#L127" title="Defined at 127 in src/java/lang/invoke/MethodType.java.">ptypes</a>();
<a id="L2404" name="L2404"></a>2404     <em class="brace">}</em>
<a id="L2405" name="L2405"></a>2405 
<a id="L2406" name="L2406"></a>2406     <em class="comment">/**</em>
<a id="L2407" name="L2407"></a>2407 <em class="comment">     * Produces a method handle which will discard some dummy arguments</em>
<a id="L2408" name="L2408"></a>2408 <em class="comment">     * before calling some other specified <i>target</i> method handle.</em>
<a id="L2409" name="L2409"></a>2409 <em class="comment">     * The type of the new method handle will be the same as the target's type,</em>
<a id="L2410" name="L2410"></a>2410 <em class="comment">     * except it will also include the dummy argument types,</em>
<a id="L2411" name="L2411"></a>2411 <em class="comment">     * at some given position.</em>
<a id="L2412" name="L2412"></a>2412 <em class="comment">     * </em>
<a id="L2413" name="L2413"></a>2413 <em class="comment">     * The {@code pos} argument may range between zero and <i>N</i>,</em>
<a id="L2414" name="L2414"></a>2414 <em class="comment">     * where <i>N</i> is the arity of the target.</em>
<a id="L2415" name="L2415"></a>2415 <em class="comment">     * If {@code pos} is zero, the dummy arguments will precede</em>
<a id="L2416" name="L2416"></a>2416 <em class="comment">     * the target's real arguments; if {@code pos} is <i>N</i></em>
<a id="L2417" name="L2417"></a>2417 <em class="comment">     * they will come after.</em>
<a id="L2418" name="L2418"></a>2418 <em class="comment">     * </em>
<a id="L2419" name="L2419"></a>2419 <em class="comment">     * <b>Example:</b></em>
<a id="L2420" name="L2420"></a>2420 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2421" name="L2421"></a>2421 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L2422" name="L2422"></a>2422 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L2423" name="L2423"></a>2423 <em class="comment">...</em>
<a id="L2424" name="L2424"></a>2424 <em class="comment">MethodHandle cat = lookup().findVirtual(String.class,</em>
<a id="L2425" name="L2425"></a>2425 <em class="comment">  "concat", methodType(String.class, String.class));</em>
<a id="L2426" name="L2426"></a>2426 <em class="comment">assertEquals("xy", (String) cat.invokeExact("x", "y"));</em>
<a id="L2427" name="L2427"></a>2427 <em class="comment">MethodType bigType = cat.type().insertParameterTypes(0, int.class, String.class);</em>
<a id="L2428" name="L2428"></a>2428 <em class="comment">MethodHandle d0 = dropArguments(cat, 0, bigType.parameterList().subList(0,2));</em>
<a id="L2429" name="L2429"></a>2429 <em class="comment">assertEquals(bigType, d0.type());</em>
<a id="L2430" name="L2430"></a>2430 <em class="comment">assertEquals("yz", (String) d0.invokeExact(123, "x", "y", "z"));</em>
<a id="L2431" name="L2431"></a>2431 <em class="comment">     * }</em>
<a id="L2432" name="L2432"></a>2432 <em class="comment">     * </em>
<a id="L2433" name="L2433"></a>2433 <em class="comment">     * This method is also equivalent to the following code:</em>
<a id="L2434" name="L2434"></a>2434 <em class="comment">     * <blockquote><pre></pre></blockquote></em>
<a id="L2435" name="L2435"></a>2435 <em class="comment">     * {@link #dropArguments(MethodHandle,int,Class...) dropArguments}{@code (target, pos, valueTypes.toArray(new Class[0]))}</em>
<a id="L2436" name="L2436"></a>2436 <em class="comment">     * </em>
<a id="L2437" name="L2437"></a>2437 <em class="comment">     * @param target the method handle to invoke after the arguments are dropped</em>
<a id="L2438" name="L2438"></a>2438 <em class="comment">     * @param valueTypes the type(s) of the argument(s) to drop</em>
<a id="L2439" name="L2439"></a>2439 <em class="comment">     * @param pos position of first argument to drop (zero for the leftmost)</em>
<a id="L2440" name="L2440"></a>2440 <em class="comment">     * @return a method handle which drops arguments of the given types,</em>
<a id="L2441" name="L2441"></a>2441 <em class="comment">     *         before calling the original method handle</em>
<a id="L2442" name="L2442"></a>2442 <em class="comment">     * @throws NullPointerException if the target is null,</em>
<a id="L2443" name="L2443"></a>2443 <em class="comment">     *                              or if the {@code valueTypes} list or any of its elements is null</em>
<a id="L2444" name="L2444"></a>2444 <em class="comment">     * @throws IllegalArgumentException if any element of {@code valueTypes} is {@code void.class},</em>
<a id="L2445" name="L2445"></a>2445 <em class="comment">     *                  or if {@code pos} is negative or greater than the arity of the target,</em>
<a id="L2446" name="L2446"></a>2446 <em class="comment">     *                  or if the new method handle's type would have too many parameters</em>
<a id="L2447" name="L2447"></a>2447 <em class="comment">     */</em>
<a id="L2448" name="L2448"></a>2448     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2449" name="L2449"></a>2449     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/13584.html" title="Multiple referred from 4 places.">dropArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; valueTypes) <em class="brace">{</em>
<a id="L2450" name="L2450"></a>2450         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();  <em class="comment">// get NPE</em>
<a id="L2451" name="L2451"></a>2451         <strong class="reserved">int</strong> dropped = <a href="../S/1619.html#L2464" title="Defined at 2464 in src/java/lang/invoke/MethodHandles.java.">dropArgumentChecks</a>(oldType, pos, valueTypes);
<a id="L2452" name="L2452"></a>2452         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = oldType.<a href="../D/24768.html" title="Multiple defined in 2 places.">insertParameterTypes</a>(pos, valueTypes);
<a id="L2453" name="L2453"></a>2453         <strong class="reserved">if</strong> (dropped == 0)  <strong class="reserved">return</strong> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>;
<a id="L2454" name="L2454"></a>2454         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2455" name="L2455"></a>2455         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>;
<a id="L2456" name="L2456"></a>2456         <strong class="reserved">int</strong> insertFormArg = 1 + pos;
<a id="L2457" name="L2457"></a>2457         <strong class="reserved">for</strong> (<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; ptype : valueTypes) <em class="brace">{</em>
<a id="L2458" name="L2458"></a>2458             lform = lform.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L483" title="Defined at 483 in src/java/lang/invoke/LambdaFormEditor.java.">addArgumentForm</a>(insertFormArg++, <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(ptype));
<a id="L2459" name="L2459"></a>2459         <em class="brace">}</em>
<a id="L2460" name="L2460"></a>2460         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13534.html" title="Multiple defined in 10 places.">copyWith</a>(newType, lform);
<a id="L2461" name="L2461"></a>2461         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2462" name="L2462"></a>2462     <em class="brace">}</em>
<a id="L2463" name="L2463"></a>2463 
<a id="L2464" name="L2464"></a>2464     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../S/1619.html#L2451" title="Referred from 2451 in src/java/lang/invoke/MethodHandles.java.">dropArgumentChecks</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> oldType, <strong class="reserved">int</strong> pos, <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; valueTypes) <em class="brace">{</em>
<a id="L2465" name="L2465"></a>2465         <strong class="reserved">int</strong> dropped = valueTypes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L2466" name="L2466"></a>2466         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../S/1616.html#L181" title="Defined at 181 in src/java/lang/invoke/MethodType.java.">checkSlotCount</a>(dropped);
<a id="L2467" name="L2467"></a>2467         <strong class="reserved">int</strong> outargs = oldType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2468" name="L2468"></a>2468         <strong class="reserved">int</strong> inargs  = outargs + dropped;
<a id="L2469" name="L2469"></a>2469         <strong class="reserved">if</strong> (pos &lt; 0 || pos &gt; outargs)
<a id="L2470" name="L2470"></a>2470             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("no argument type to remove"
<a id="L2471" name="L2471"></a>2471                     + <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/11544.html" title="Multiple defined in 4 places.">asList</a>(oldType, pos, valueTypes, inargs, outargs)
<a id="L2472" name="L2472"></a>2472                     );
<a id="L2473" name="L2473"></a>2473         <strong class="reserved">return</strong> dropped;
<a id="L2474" name="L2474"></a>2474     <em class="brace">}</em>
<a id="L2475" name="L2475"></a>2475 
<a id="L2476" name="L2476"></a>2476     <em class="comment">/**</em>
<a id="L2477" name="L2477"></a>2477 <em class="comment">     * Produces a method handle which will discard some dummy arguments</em>
<a id="L2478" name="L2478"></a>2478 <em class="comment">     * before calling some other specified <i>target</i> method handle.</em>
<a id="L2479" name="L2479"></a>2479 <em class="comment">     * The type of the new method handle will be the same as the target's type,</em>
<a id="L2480" name="L2480"></a>2480 <em class="comment">     * except it will also include the dummy argument types,</em>
<a id="L2481" name="L2481"></a>2481 <em class="comment">     * at some given position.</em>
<a id="L2482" name="L2482"></a>2482 <em class="comment">     * </em>
<a id="L2483" name="L2483"></a>2483 <em class="comment">     * The {@code pos} argument may range between zero and <i>N</i>,</em>
<a id="L2484" name="L2484"></a>2484 <em class="comment">     * where <i>N</i> is the arity of the target.</em>
<a id="L2485" name="L2485"></a>2485 <em class="comment">     * If {@code pos} is zero, the dummy arguments will precede</em>
<a id="L2486" name="L2486"></a>2486 <em class="comment">     * the target's real arguments; if {@code pos} is <i>N</i></em>
<a id="L2487" name="L2487"></a>2487 <em class="comment">     * they will come after.</em>
<a id="L2488" name="L2488"></a>2488 <em class="comment">     * </em>
<a id="L2489" name="L2489"></a>2489 <em class="comment">     * <b>Example:</b></em>
<a id="L2490" name="L2490"></a>2490 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2491" name="L2491"></a>2491 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L2492" name="L2492"></a>2492 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L2493" name="L2493"></a>2493 <em class="comment">...</em>
<a id="L2494" name="L2494"></a>2494 <em class="comment">MethodHandle cat = lookup().findVirtual(String.class,</em>
<a id="L2495" name="L2495"></a>2495 <em class="comment">  "concat", methodType(String.class, String.class));</em>
<a id="L2496" name="L2496"></a>2496 <em class="comment">assertEquals("xy", (String) cat.invokeExact("x", "y"));</em>
<a id="L2497" name="L2497"></a>2497 <em class="comment">MethodHandle d0 = dropArguments(cat, 0, String.class);</em>
<a id="L2498" name="L2498"></a>2498 <em class="comment">assertEquals("yz", (String) d0.invokeExact("x", "y", "z"));</em>
<a id="L2499" name="L2499"></a>2499 <em class="comment">MethodHandle d1 = dropArguments(cat, 1, String.class);</em>
<a id="L2500" name="L2500"></a>2500 <em class="comment">assertEquals("xz", (String) d1.invokeExact("x", "y", "z"));</em>
<a id="L2501" name="L2501"></a>2501 <em class="comment">MethodHandle d2 = dropArguments(cat, 2, String.class);</em>
<a id="L2502" name="L2502"></a>2502 <em class="comment">assertEquals("xy", (String) d2.invokeExact("x", "y", "z"));</em>
<a id="L2503" name="L2503"></a>2503 <em class="comment">MethodHandle d12 = dropArguments(cat, 1, int.class, boolean.class);</em>
<a id="L2504" name="L2504"></a>2504 <em class="comment">assertEquals("xz", (String) d12.invokeExact("x", 12, true, "z"));</em>
<a id="L2505" name="L2505"></a>2505 <em class="comment">     * }</em>
<a id="L2506" name="L2506"></a>2506 <em class="comment">     * </em>
<a id="L2507" name="L2507"></a>2507 <em class="comment">     * This method is also equivalent to the following code:</em>
<a id="L2508" name="L2508"></a>2508 <em class="comment">     * <blockquote><pre></pre></blockquote></em>
<a id="L2509" name="L2509"></a>2509 <em class="comment">     * {@link #dropArguments(MethodHandle,int,List) dropArguments}{@code (target, pos, Arrays.asList(valueTypes))}</em>
<a id="L2510" name="L2510"></a>2510 <em class="comment">     * </em>
<a id="L2511" name="L2511"></a>2511 <em class="comment">     * @param target the method handle to invoke after the arguments are dropped</em>
<a id="L2512" name="L2512"></a>2512 <em class="comment">     * @param valueTypes the type(s) of the argument(s) to drop</em>
<a id="L2513" name="L2513"></a>2513 <em class="comment">     * @param pos position of first argument to drop (zero for the leftmost)</em>
<a id="L2514" name="L2514"></a>2514 <em class="comment">     * @return a method handle which drops arguments of the given types,</em>
<a id="L2515" name="L2515"></a>2515 <em class="comment">     *         before calling the original method handle</em>
<a id="L2516" name="L2516"></a>2516 <em class="comment">     * @throws NullPointerException if the target is null,</em>
<a id="L2517" name="L2517"></a>2517 <em class="comment">     *                              or if the {@code valueTypes} array or any of its elements is null</em>
<a id="L2518" name="L2518"></a>2518 <em class="comment">     * @throws IllegalArgumentException if any element of {@code valueTypes} is {@code void.class},</em>
<a id="L2519" name="L2519"></a>2519 <em class="comment">     *                  or if {@code pos} is negative or greater than the arity of the target,</em>
<a id="L2520" name="L2520"></a>2520 <em class="comment">     *                  or if the new method handle's type would have</em>
<a id="L2521" name="L2521"></a>2521 <em class="comment">     *                  <a href="MethodHandle.html#maxarity">too many parameters</a></em>
<a id="L2522" name="L2522"></a>2522 <em class="comment">     */</em>
<a id="L2523" name="L2523"></a>2523     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2524" name="L2524"></a>2524     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/13584.html" title="Multiple referred from 4 places.">dropArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;... valueTypes) <em class="brace">{</em>
<a id="L2525" name="L2525"></a>2525         <strong class="reserved">return</strong> <a href="../D/15233.html" title="Multiple defined in 2 places.">dropArguments</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, pos, <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/11544.html" title="Multiple defined in 4 places.">asList</a>(valueTypes));
<a id="L2526" name="L2526"></a>2526     <em class="brace">}</em>
<a id="L2527" name="L2527"></a>2527 
<a id="L2528" name="L2528"></a>2528     <em class="comment">/**</em>
<a id="L2529" name="L2529"></a>2529 <em class="comment">     * Adapts a target method handle by pre-processing</em>
<a id="L2530" name="L2530"></a>2530 <em class="comment">     * one or more of its arguments, each with its own unary filter function,</em>
<a id="L2531" name="L2531"></a>2531 <em class="comment">     * and then calling the target with each pre-processed argument</em>
<a id="L2532" name="L2532"></a>2532 <em class="comment">     * replaced by the result of its corresponding filter function.</em>
<a id="L2533" name="L2533"></a>2533 <em class="comment">     * </em>
<a id="L2534" name="L2534"></a>2534 <em class="comment">     * The pre-processing is performed by one or more method handles,</em>
<a id="L2535" name="L2535"></a>2535 <em class="comment">     * specified in the elements of the {@code filters} array.</em>
<a id="L2536" name="L2536"></a>2536 <em class="comment">     * The first element of the filter array corresponds to the {@code pos}</em>
<a id="L2537" name="L2537"></a>2537 <em class="comment">     * argument of the target, and so on in sequence.</em>
<a id="L2538" name="L2538"></a>2538 <em class="comment">     * </em>
<a id="L2539" name="L2539"></a>2539 <em class="comment">     * Null arguments in the array are treated as identity functions,</em>
<a id="L2540" name="L2540"></a>2540 <em class="comment">     * and the corresponding arguments left unchanged.</em>
<a id="L2541" name="L2541"></a>2541 <em class="comment">     * (If there are no non-null elements in the array, the original target is returned.)</em>
<a id="L2542" name="L2542"></a>2542 <em class="comment">     * Each filter is applied to the corresponding argument of the adapter.</em>
<a id="L2543" name="L2543"></a>2543 <em class="comment">     * </em>
<a id="L2544" name="L2544"></a>2544 <em class="comment">     * If a filter {@code F} applies to the {@code N}th argument of</em>
<a id="L2545" name="L2545"></a>2545 <em class="comment">     * the target, then {@code F} must be a method handle which</em>
<a id="L2546" name="L2546"></a>2546 <em class="comment">     * takes exactly one argument.  The type of {@code F}'s sole argument</em>
<a id="L2547" name="L2547"></a>2547 <em class="comment">     * replaces the corresponding argument type of the target</em>
<a id="L2548" name="L2548"></a>2548 <em class="comment">     * in the resulting adapted method handle.</em>
<a id="L2549" name="L2549"></a>2549 <em class="comment">     * The return type of {@code F} must be identical to the corresponding</em>
<a id="L2550" name="L2550"></a>2550 <em class="comment">     * parameter type of the target.</em>
<a id="L2551" name="L2551"></a>2551 <em class="comment">     * </em>
<a id="L2552" name="L2552"></a>2552 <em class="comment">     * It is an error if there are elements of {@code filters}</em>
<a id="L2553" name="L2553"></a>2553 <em class="comment">     * (null or not)</em>
<a id="L2554" name="L2554"></a>2554 <em class="comment">     * which do not correspond to argument positions in the target.</em>
<a id="L2555" name="L2555"></a>2555 <em class="comment">     * <b>Example:</b></em>
<a id="L2556" name="L2556"></a>2556 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2557" name="L2557"></a>2557 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L2558" name="L2558"></a>2558 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L2559" name="L2559"></a>2559 <em class="comment">...</em>
<a id="L2560" name="L2560"></a>2560 <em class="comment">MethodHandle cat = lookup().findVirtual(String.class,</em>
<a id="L2561" name="L2561"></a>2561 <em class="comment">  "concat", methodType(String.class, String.class));</em>
<a id="L2562" name="L2562"></a>2562 <em class="comment">MethodHandle upcase = lookup().findVirtual(String.class,</em>
<a id="L2563" name="L2563"></a>2563 <em class="comment">  "toUpperCase", methodType(String.class));</em>
<a id="L2564" name="L2564"></a>2564 <em class="comment">assertEquals("xy", (String) cat.invokeExact("x", "y"));</em>
<a id="L2565" name="L2565"></a>2565 <em class="comment">MethodHandle f0 = filterArguments(cat, 0, upcase);</em>
<a id="L2566" name="L2566"></a>2566 <em class="comment">assertEquals("Xy", (String) f0.invokeExact("x", "y")); // Xy</em>
<a id="L2567" name="L2567"></a>2567 <em class="comment">MethodHandle f1 = filterArguments(cat, 1, upcase);</em>
<a id="L2568" name="L2568"></a>2568 <em class="comment">assertEquals("xY", (String) f1.invokeExact("x", "y")); // xY</em>
<a id="L2569" name="L2569"></a>2569 <em class="comment">MethodHandle f2 = filterArguments(cat, 0, upcase, upcase);</em>
<a id="L2570" name="L2570"></a>2570 <em class="comment">assertEquals("XY", (String) f2.invokeExact("x", "y")); // XY</em>
<a id="L2571" name="L2571"></a>2571 <em class="comment">     * }</em>
<a id="L2572" name="L2572"></a>2572 <em class="comment">     *  Here is pseudocode for the resulting adapter:</em>
<a id="L2573" name="L2573"></a>2573 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2574" name="L2574"></a>2574 <em class="comment">     * V target(P... p, A[i]... a[i], B... b);</em>
<a id="L2575" name="L2575"></a>2575 <em class="comment">     * A[i] filter[i](V[i]);</em>
<a id="L2576" name="L2576"></a>2576 <em class="comment">     * T adapter(P... p, V[i]... v[i], B... b) {</em>
<a id="L2577" name="L2577"></a>2577 <em class="comment">     *   return target(p..., f[i](v[i])..., b...);</em>
<a id="L2578" name="L2578"></a>2578 <em class="comment">     * }</em>
<a id="L2579" name="L2579"></a>2579 <em class="comment">     * }</em>
<a id="L2580" name="L2580"></a>2580 <em class="comment">     *</em>
<a id="L2581" name="L2581"></a>2581 <em class="comment">     * @param target the method handle to invoke after arguments are filtered</em>
<a id="L2582" name="L2582"></a>2582 <em class="comment">     * @param pos the position of the first argument to filter</em>
<a id="L2583" name="L2583"></a>2583 <em class="comment">     * @param filters method handles to call initially on filtered arguments</em>
<a id="L2584" name="L2584"></a>2584 <em class="comment">     * @return method handle which incorporates the specified argument filtering logic</em>
<a id="L2585" name="L2585"></a>2585 <em class="comment">     * @throws NullPointerException if the target is null</em>
<a id="L2586" name="L2586"></a>2586 <em class="comment">     *                              or if the {@code filters} array is null</em>
<a id="L2587" name="L2587"></a>2587 <em class="comment">     * @throws IllegalArgumentException if a non-null element of {@code filters}</em>
<a id="L2588" name="L2588"></a>2588 <em class="comment">     *          does not match a corresponding argument type of target as described above,</em>
<a id="L2589" name="L2589"></a>2589 <em class="comment">     *          or if the {@code pos+filters.length} is greater than {@code target.type().parameterCount()},</em>
<a id="L2590" name="L2590"></a>2590 <em class="comment">     *          or if the resulting method handle's type would have</em>
<a id="L2591" name="L2591"></a>2591 <em class="comment">     *          <a href="MethodHandle.html#maxarity">too many parameters</a></em>
<a id="L2592" name="L2592"></a>2592 <em class="comment">     */</em>
<a id="L2593" name="L2593"></a>2593     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2594" name="L2594"></a>2594     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> filterArguments(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>... filters) <em class="brace">{</em>
<a id="L2595" name="L2595"></a>2595         <a href="../S/1619.html#L2619" title="Defined at 2619 in src/java/lang/invoke/MethodHandles.java.">filterArgumentsCheckArity</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, pos, filters);
<a id="L2596" name="L2596"></a>2596         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> adapter = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>;
<a id="L2597" name="L2597"></a>2597         <strong class="reserved">int</strong> curPos = pos-1;  <em class="comment">// pre-incremented</em>
<a id="L2598" name="L2598"></a>2598         <strong class="reserved">for</strong> (<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a> : filters) <em class="brace">{</em>
<a id="L2599" name="L2599"></a>2599             curPos += 1;
<a id="L2600" name="L2600"></a>2600             <strong class="reserved">if</strong> (<a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a> == <strong class="reserved">null</strong>)  <strong class="reserved">continue</strong>;  <em class="comment">// ignore null elements of filters</em>
<a id="L2601" name="L2601"></a>2601             adapter = <a href="../S/1619.html#L2607" title="Defined at 2607 in src/java/lang/invoke/MethodHandles.java.">filterArgument</a>(adapter, curPos, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2602" name="L2602"></a>2602         <em class="brace">}</em>
<a id="L2603" name="L2603"></a>2603         <strong class="reserved">return</strong> adapter;
<a id="L2604" name="L2604"></a>2604     <em class="brace">}</em>
<a id="L2605" name="L2605"></a>2605 
<a id="L2606" name="L2606"></a>2606     <em class="comment">/*non-public*/</em> <strong class="reserved">static</strong>
<a id="L2607" name="L2607"></a>2607     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14323.html" title="Multiple referred from 2 places.">filterArgument</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <em class="brace">{</em>
<a id="L2608" name="L2608"></a>2608         <a href="../S/1619.html#L2626" title="Defined at 2626 in src/java/lang/invoke/MethodHandles.java.">filterArgumentChecks</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, pos, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2609" name="L2609"></a>2609         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2610" name="L2610"></a>2610         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2611" name="L2611"></a>2611         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2612" name="L2612"></a>2612         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; newParamType = filterType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0);
<a id="L2613" name="L2613"></a>2613         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L633" title="Defined at 633 in src/java/lang/invoke/LambdaFormEditor.java.">filterArgumentForm</a>(1 + pos, <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(newParamType));
<a id="L2614" name="L2614"></a>2614         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = targetType.<a href="../S/1616.html#L369" title="Defined at 369 in src/java/lang/invoke/MethodType.java.">changeParameterType</a>(pos, newParamType);
<a id="L2615" name="L2615"></a>2615         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13539.html" title="Multiple defined in 3 places.">copyWithExtendL</a>(newType, lform, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2616" name="L2616"></a>2616         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2617" name="L2617"></a>2617     <em class="brace">}</em>
<a id="L2618" name="L2618"></a>2618 
<a id="L2619" name="L2619"></a>2619     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/1619.html#L2595" title="Referred from 2595 in src/java/lang/invoke/MethodHandles.java.">filterArgumentsCheckArity</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] filters) <em class="brace">{</em>
<a id="L2620" name="L2620"></a>2620         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2621" name="L2621"></a>2621         <strong class="reserved">int</strong> maxPos = targetType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2622" name="L2622"></a>2622         <strong class="reserved">if</strong> (pos + filters.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; maxPos)
<a id="L2623" name="L2623"></a>2623             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("too many filters");
<a id="L2624" name="L2624"></a>2624     <em class="brace">}</em>
<a id="L2625" name="L2625"></a>2625 
<a id="L2626" name="L2626"></a>2626     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/1619.html#L2608" title="Referred from 2608 in src/java/lang/invoke/MethodHandles.java.">filterArgumentChecks</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <strong class="reserved">throws</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <em class="brace">{</em>
<a id="L2627" name="L2627"></a>2627         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2628" name="L2628"></a>2628         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2629" name="L2629"></a>2629         <strong class="reserved">if</strong> (filterType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() != 1
<a id="L2630" name="L2630"></a>2630             || filterType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != targetType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(pos))
<a id="L2631" name="L2631"></a>2631             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("target and filter types do not match", targetType, filterType);
<a id="L2632" name="L2632"></a>2632     <em class="brace">}</em>
<a id="L2633" name="L2633"></a>2633 
<a id="L2634" name="L2634"></a>2634     <em class="comment">/**</em>
<a id="L2635" name="L2635"></a>2635 <em class="comment">     * Adapts a target method handle by pre-processing</em>
<a id="L2636" name="L2636"></a>2636 <em class="comment">     * a sub-sequence of its arguments with a filter (another method handle).</em>
<a id="L2637" name="L2637"></a>2637 <em class="comment">     * The pre-processed arguments are replaced by the result (if any) of the</em>
<a id="L2638" name="L2638"></a>2638 <em class="comment">     * filter function.</em>
<a id="L2639" name="L2639"></a>2639 <em class="comment">     * The target is then called on the modified (usually shortened) argument list.</em>
<a id="L2640" name="L2640"></a>2640 <em class="comment">     * </em>
<a id="L2641" name="L2641"></a>2641 <em class="comment">     * If the filter returns a value, the target must accept that value as</em>
<a id="L2642" name="L2642"></a>2642 <em class="comment">     * its argument in position {@code pos}, preceded and/or followed by</em>
<a id="L2643" name="L2643"></a>2643 <em class="comment">     * any arguments not passed to the filter.</em>
<a id="L2644" name="L2644"></a>2644 <em class="comment">     * If the filter returns void, the target must accept all arguments</em>
<a id="L2645" name="L2645"></a>2645 <em class="comment">     * not passed to the filter.</em>
<a id="L2646" name="L2646"></a>2646 <em class="comment">     * No arguments are reordered, and a result returned from the filter</em>
<a id="L2647" name="L2647"></a>2647 <em class="comment">     * replaces (in order) the whole subsequence of arguments originally</em>
<a id="L2648" name="L2648"></a>2648 <em class="comment">     * passed to the adapter.</em>
<a id="L2649" name="L2649"></a>2649 <em class="comment">     * </em>
<a id="L2650" name="L2650"></a>2650 <em class="comment">     * The argument types (if any) of the filter</em>
<a id="L2651" name="L2651"></a>2651 <em class="comment">     * replace zero or one argument types of the target, at position {@code pos},</em>
<a id="L2652" name="L2652"></a>2652 <em class="comment">     * in the resulting adapted method handle.</em>
<a id="L2653" name="L2653"></a>2653 <em class="comment">     * The return type of the filter (if any) must be identical to the</em>
<a id="L2654" name="L2654"></a>2654 <em class="comment">     * argument type of the target at position {@code pos}, and that target argument</em>
<a id="L2655" name="L2655"></a>2655 <em class="comment">     * is supplied by the return value of the filter.</em>
<a id="L2656" name="L2656"></a>2656 <em class="comment">     * </em>
<a id="L2657" name="L2657"></a>2657 <em class="comment">     * In all cases, {@code pos} must be greater than or equal to zero, and</em>
<a id="L2658" name="L2658"></a>2658 <em class="comment">     * {@code pos} must also be less than or equal to the target's arity.</em>
<a id="L2659" name="L2659"></a>2659 <em class="comment">     * <b>Example:</b></em>
<a id="L2660" name="L2660"></a>2660 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2661" name="L2661"></a>2661 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L2662" name="L2662"></a>2662 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L2663" name="L2663"></a>2663 <em class="comment">...</em>
<a id="L2664" name="L2664"></a>2664 <em class="comment">MethodHandle deepToString = publicLookup()</em>
<a id="L2665" name="L2665"></a>2665 <em class="comment">  .findStatic(Arrays.class, "deepToString", methodType(String.class, Object[].class));</em>
<a id="L2666" name="L2666"></a>2666 <em class="comment"></em>
<a id="L2667" name="L2667"></a>2667 <em class="comment">MethodHandle ts1 = deepToString.asCollector(String[].class, 1);</em>
<a id="L2668" name="L2668"></a>2668 <em class="comment">assertEquals("[strange]", (String) ts1.invokeExact("strange"));</em>
<a id="L2669" name="L2669"></a>2669 <em class="comment"></em>
<a id="L2670" name="L2670"></a>2670 <em class="comment">MethodHandle ts2 = deepToString.asCollector(String[].class, 2);</em>
<a id="L2671" name="L2671"></a>2671 <em class="comment">assertEquals("[up, down]", (String) ts2.invokeExact("up", "down"));</em>
<a id="L2672" name="L2672"></a>2672 <em class="comment"></em>
<a id="L2673" name="L2673"></a>2673 <em class="comment">MethodHandle ts3 = deepToString.asCollector(String[].class, 3);</em>
<a id="L2674" name="L2674"></a>2674 <em class="comment">MethodHandle ts3_ts2 = collectArguments(ts3, 1, ts2);</em>
<a id="L2675" name="L2675"></a>2675 <em class="comment">assertEquals("[top, [up, down], strange]",</em>
<a id="L2676" name="L2676"></a>2676 <em class="comment">             (String) ts3_ts2.invokeExact("top", "up", "down", "strange"));</em>
<a id="L2677" name="L2677"></a>2677 <em class="comment"></em>
<a id="L2678" name="L2678"></a>2678 <em class="comment">MethodHandle ts3_ts2_ts1 = collectArguments(ts3_ts2, 3, ts1);</em>
<a id="L2679" name="L2679"></a>2679 <em class="comment">assertEquals("[top, [up, down], [strange]]",</em>
<a id="L2680" name="L2680"></a>2680 <em class="comment">             (String) ts3_ts2_ts1.invokeExact("top", "up", "down", "strange"));</em>
<a id="L2681" name="L2681"></a>2681 <em class="comment"></em>
<a id="L2682" name="L2682"></a>2682 <em class="comment">MethodHandle ts3_ts2_ts3 = collectArguments(ts3_ts2, 1, ts3);</em>
<a id="L2683" name="L2683"></a>2683 <em class="comment">assertEquals("[top, [[up, down, strange], charm], bottom]",</em>
<a id="L2684" name="L2684"></a>2684 <em class="comment">             (String) ts3_ts2_ts3.invokeExact("top", "up", "down", "strange", "charm", "bottom"));</em>
<a id="L2685" name="L2685"></a>2685 <em class="comment">     * }</em>
<a id="L2686" name="L2686"></a>2686 <em class="comment">     *  Here is pseudocode for the resulting adapter:</em>
<a id="L2687" name="L2687"></a>2687 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2688" name="L2688"></a>2688 <em class="comment">     * T target(A...,V,C...);</em>
<a id="L2689" name="L2689"></a>2689 <em class="comment">     * V filter(B...);</em>
<a id="L2690" name="L2690"></a>2690 <em class="comment">     * T adapter(A... a,B... b,C... c) {</em>
<a id="L2691" name="L2691"></a>2691 <em class="comment">     *   V v = filter(b...);</em>
<a id="L2692" name="L2692"></a>2692 <em class="comment">     *   return target(a...,v,c...);</em>
<a id="L2693" name="L2693"></a>2693 <em class="comment">     * }</em>
<a id="L2694" name="L2694"></a>2694 <em class="comment">     * // and if the filter has no arguments:</em>
<a id="L2695" name="L2695"></a>2695 <em class="comment">     * T target2(A...,V,C...);</em>
<a id="L2696" name="L2696"></a>2696 <em class="comment">     * V filter2();</em>
<a id="L2697" name="L2697"></a>2697 <em class="comment">     * T adapter2(A... a,C... c) {</em>
<a id="L2698" name="L2698"></a>2698 <em class="comment">     *   V v = filter2();</em>
<a id="L2699" name="L2699"></a>2699 <em class="comment">     *   return target2(a...,v,c...);</em>
<a id="L2700" name="L2700"></a>2700 <em class="comment">     * }</em>
<a id="L2701" name="L2701"></a>2701 <em class="comment">     * // and if the filter has a void return:</em>
<a id="L2702" name="L2702"></a>2702 <em class="comment">     * T target3(A...,C...);</em>
<a id="L2703" name="L2703"></a>2703 <em class="comment">     * void filter3(B...);</em>
<a id="L2704" name="L2704"></a>2704 <em class="comment">     * void adapter3(A... a,B... b,C... c) {</em>
<a id="L2705" name="L2705"></a>2705 <em class="comment">     *   filter3(b...);</em>
<a id="L2706" name="L2706"></a>2706 <em class="comment">     *   return target3(a...,c...);</em>
<a id="L2707" name="L2707"></a>2707 <em class="comment">     * }</em>
<a id="L2708" name="L2708"></a>2708 <em class="comment">     * }</em>
<a id="L2709" name="L2709"></a>2709 <em class="comment">     * </em>
<a id="L2710" name="L2710"></a>2710 <em class="comment">     * A collection adapter {@code collectArguments(mh, 0, coll)} is equivalent to</em>
<a id="L2711" name="L2711"></a>2711 <em class="comment">     * one which first "folds" the affected arguments, and then drops them, in separate</em>
<a id="L2712" name="L2712"></a>2712 <em class="comment">     * steps as follows:</em>
<a id="L2713" name="L2713"></a>2713 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2714" name="L2714"></a>2714 <em class="comment">     * mh = MethodHandles.dropArguments(mh, 1, coll.type().parameterList()); //step 2</em>
<a id="L2715" name="L2715"></a>2715 <em class="comment">     * mh = MethodHandles.foldArguments(mh, coll); //step 1</em>
<a id="L2716" name="L2716"></a>2716 <em class="comment">     * }</em>
<a id="L2717" name="L2717"></a>2717 <em class="comment">     * If the target method handle consumes no arguments besides than the result</em>
<a id="L2718" name="L2718"></a>2718 <em class="comment">     * (if any) of the filter {@code coll}, then {@code collectArguments(mh, 0, coll)}</em>
<a id="L2719" name="L2719"></a>2719 <em class="comment">     * is equivalent to {@code filterReturnValue(coll, mh)}.</em>
<a id="L2720" name="L2720"></a>2720 <em class="comment">     * If the filter method handle {@code coll} consumes one argument and produces</em>
<a id="L2721" name="L2721"></a>2721 <em class="comment">     * a non-void result, then {@code collectArguments(mh, N, coll)}</em>
<a id="L2722" name="L2722"></a>2722 <em class="comment">     * is equivalent to {@code filterArguments(mh, N, coll)}.</em>
<a id="L2723" name="L2723"></a>2723 <em class="comment">     * Other equivalences are possible but would require argument permutation.</em>
<a id="L2724" name="L2724"></a>2724 <em class="comment">     *</em>
<a id="L2725" name="L2725"></a>2725 <em class="comment">     * @param target the method handle to invoke after filtering the subsequence of arguments</em>
<a id="L2726" name="L2726"></a>2726 <em class="comment">     * @param pos the position of the first adapter argument to pass to the filter,</em>
<a id="L2727" name="L2727"></a>2727 <em class="comment">     *            and/or the target argument which receives the result of the filter</em>
<a id="L2728" name="L2728"></a>2728 <em class="comment">     * @param filter method handle to call on the subsequence of arguments</em>
<a id="L2729" name="L2729"></a>2729 <em class="comment">     * @return method handle which incorporates the specified argument subsequence filtering logic</em>
<a id="L2730" name="L2730"></a>2730 <em class="comment">     * @throws NullPointerException if either argument is null</em>
<a id="L2731" name="L2731"></a>2731 <em class="comment">     * @throws IllegalArgumentException if the return type of {@code filter}</em>
<a id="L2732" name="L2732"></a>2732 <em class="comment">     *          is non-void and is not the same as the {@code pos} argument of the target,</em>
<a id="L2733" name="L2733"></a>2733 <em class="comment">     *          or if {@code pos} is not between 0 and the target's arity, inclusive,</em>
<a id="L2734" name="L2734"></a>2734 <em class="comment">     *          or if the resulting method handle's type would have</em>
<a id="L2735" name="L2735"></a>2735 <em class="comment">     *          <a href="MethodHandle.html#maxarity">too many parameters</a></em>
<a id="L2736" name="L2736"></a>2736 <em class="comment">     * @see MethodHandles#foldArguments</em>
<a id="L2737" name="L2737"></a>2737 <em class="comment">     * @see MethodHandles#filterArguments</em>
<a id="L2738" name="L2738"></a>2738 <em class="comment">     * @see MethodHandles#filterReturnValue</em>
<a id="L2739" name="L2739"></a>2739 <em class="comment">     */</em>
<a id="L2740" name="L2740"></a>2740     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2741" name="L2741"></a>2741     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/11640.html" title="Multiple referred from 3 places.">collectArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <em class="brace">{</em>
<a id="L2742" name="L2742"></a>2742         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = <a href="../S/1619.html#L2756" title="Defined at 2756 in src/java/lang/invoke/MethodHandles.java.">collectArgumentsChecks</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, pos, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2743" name="L2743"></a>2743         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> collectorType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2744" name="L2744"></a>2744         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2745" name="L2745"></a>2745         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform;
<a id="L2746" name="L2746"></a>2746         <strong class="reserved">if</strong> (collectorType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>().<a href="../D/25208.html" title="Multiple defined in 5 places.">isArray</a>() &amp;&amp; <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/24987.html" title="Multiple defined in 3 places.">intrinsicName</a>() == <a href="../S/1634.html#L1313" title="Defined at 1313 in src/java/lang/invoke/MethodHandleImpl.java.">Intrinsic</a>.<a href="../S/6524.html#L198" title="Defined at 198 in src/com/sun/source/tree/Tree.java.">NEW_ARRAY</a>) <em class="brace">{</em>
<a id="L2747" name="L2747"></a>2747             lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L583" title="Defined at 583 in src/java/lang/invoke/LambdaFormEditor.java.">collectArgumentArrayForm</a>(1 + pos, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2748" name="L2748"></a>2748             <strong class="reserved">if</strong> (lform != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2749" name="L2749"></a>2749                 <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13534.html" title="Multiple defined in 10 places.">copyWith</a>(newType, lform);
<a id="L2750" name="L2750"></a>2750             <em class="brace">}</em>
<a id="L2751" name="L2751"></a>2751         <em class="brace">}</em>
<a id="L2752" name="L2752"></a>2752         lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L562" title="Defined at 562 in src/java/lang/invoke/LambdaFormEditor.java.">collectArgumentsForm</a>(1 + pos, collectorType.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>());
<a id="L2753" name="L2753"></a>2753         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13539.html" title="Multiple defined in 3 places.">copyWithExtendL</a>(newType, lform, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2754" name="L2754"></a>2754     <em class="brace">}</em>
<a id="L2755" name="L2755"></a>2755 
<a id="L2756" name="L2756"></a>2756     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../S/1619.html#L2742" title="Referred from 2742 in src/java/lang/invoke/MethodHandles.java.">collectArgumentsChecks</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <strong class="reserved">int</strong> pos, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <strong class="reserved">throws</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <em class="brace">{</em>
<a id="L2757" name="L2757"></a>2757         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2758" name="L2758"></a>2758         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2759" name="L2759"></a>2759         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = filterType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>();
<a id="L2760" name="L2760"></a>2760         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; <a href="../S/1.html#L1411" title="Defined at 1411 in src/launcher/java_md.c.">filterArgs</a> = filterType.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L2761" name="L2761"></a>2761         <strong class="reserved">if</strong> (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> == <strong class="reserved">void</strong>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L2762" name="L2762"></a>2762             <strong class="reserved">return</strong> targetType.<a href="../D/24768.html" title="Multiple defined in 2 places.">insertParameterTypes</a>(pos, <a href="../S/1.html#L1411" title="Defined at 1411 in src/launcher/java_md.c.">filterArgs</a>);
<a id="L2763" name="L2763"></a>2763         <em class="brace">}</em>
<a id="L2764" name="L2764"></a>2764         <strong class="reserved">if</strong> (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> != targetType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(pos)) <em class="brace">{</em>
<a id="L2765" name="L2765"></a>2765             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("target and filter types do not match", targetType, filterType);
<a id="L2766" name="L2766"></a>2766         <em class="brace">}</em>
<a id="L2767" name="L2767"></a>2767         <strong class="reserved">return</strong> targetType.<a href="../S/1616.html#L548" title="Defined at 548 in src/java/lang/invoke/MethodType.java.">dropParameterTypes</a>(pos, pos+1).<a href="../D/24768.html" title="Multiple defined in 2 places.">insertParameterTypes</a>(pos, <a href="../S/1.html#L1411" title="Defined at 1411 in src/launcher/java_md.c.">filterArgs</a>);
<a id="L2768" name="L2768"></a>2768     <em class="brace">}</em>
<a id="L2769" name="L2769"></a>2769 
<a id="L2770" name="L2770"></a>2770     <em class="comment">/**</em>
<a id="L2771" name="L2771"></a>2771 <em class="comment">     * Adapts a target method handle by post-processing</em>
<a id="L2772" name="L2772"></a>2772 <em class="comment">     * its return value (if any) with a filter (another method handle).</em>
<a id="L2773" name="L2773"></a>2773 <em class="comment">     * The result of the filter is returned from the adapter.</em>
<a id="L2774" name="L2774"></a>2774 <em class="comment">     * </em>
<a id="L2775" name="L2775"></a>2775 <em class="comment">     * If the target returns a value, the filter must accept that value as</em>
<a id="L2776" name="L2776"></a>2776 <em class="comment">     * its only argument.</em>
<a id="L2777" name="L2777"></a>2777 <em class="comment">     * If the target returns void, the filter must accept no arguments.</em>
<a id="L2778" name="L2778"></a>2778 <em class="comment">     * </em>
<a id="L2779" name="L2779"></a>2779 <em class="comment">     * The return type of the filter</em>
<a id="L2780" name="L2780"></a>2780 <em class="comment">     * replaces the return type of the target</em>
<a id="L2781" name="L2781"></a>2781 <em class="comment">     * in the resulting adapted method handle.</em>
<a id="L2782" name="L2782"></a>2782 <em class="comment">     * The argument type of the filter (if any) must be identical to the</em>
<a id="L2783" name="L2783"></a>2783 <em class="comment">     * return type of the target.</em>
<a id="L2784" name="L2784"></a>2784 <em class="comment">     * <b>Example:</b></em>
<a id="L2785" name="L2785"></a>2785 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2786" name="L2786"></a>2786 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L2787" name="L2787"></a>2787 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L2788" name="L2788"></a>2788 <em class="comment">...</em>
<a id="L2789" name="L2789"></a>2789 <em class="comment">MethodHandle cat = lookup().findVirtual(String.class,</em>
<a id="L2790" name="L2790"></a>2790 <em class="comment">  "concat", methodType(String.class, String.class));</em>
<a id="L2791" name="L2791"></a>2791 <em class="comment">MethodHandle length = lookup().findVirtual(String.class,</em>
<a id="L2792" name="L2792"></a>2792 <em class="comment">  "length", methodType(int.class));</em>
<a id="L2793" name="L2793"></a>2793 <em class="comment">System.out.println((String) cat.invokeExact("x", "y")); // xy</em>
<a id="L2794" name="L2794"></a>2794 <em class="comment">MethodHandle f0 = filterReturnValue(cat, length);</em>
<a id="L2795" name="L2795"></a>2795 <em class="comment">System.out.println((int) f0.invokeExact("x", "y")); // 2</em>
<a id="L2796" name="L2796"></a>2796 <em class="comment">     * }</em>
<a id="L2797" name="L2797"></a>2797 <em class="comment">     *  Here is pseudocode for the resulting adapter:</em>
<a id="L2798" name="L2798"></a>2798 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2799" name="L2799"></a>2799 <em class="comment">     * V target(A...);</em>
<a id="L2800" name="L2800"></a>2800 <em class="comment">     * T filter(V);</em>
<a id="L2801" name="L2801"></a>2801 <em class="comment">     * T adapter(A... a) {</em>
<a id="L2802" name="L2802"></a>2802 <em class="comment">     *   V v = target(a...);</em>
<a id="L2803" name="L2803"></a>2803 <em class="comment">     *   return filter(v);</em>
<a id="L2804" name="L2804"></a>2804 <em class="comment">     * }</em>
<a id="L2805" name="L2805"></a>2805 <em class="comment">     * // and if the target has a void return:</em>
<a id="L2806" name="L2806"></a>2806 <em class="comment">     * void target2(A...);</em>
<a id="L2807" name="L2807"></a>2807 <em class="comment">     * T filter2();</em>
<a id="L2808" name="L2808"></a>2808 <em class="comment">     * T adapter2(A... a) {</em>
<a id="L2809" name="L2809"></a>2809 <em class="comment">     *   target2(a...);</em>
<a id="L2810" name="L2810"></a>2810 <em class="comment">     *   return filter2();</em>
<a id="L2811" name="L2811"></a>2811 <em class="comment">     * }</em>
<a id="L2812" name="L2812"></a>2812 <em class="comment">     * // and if the filter has a void return:</em>
<a id="L2813" name="L2813"></a>2813 <em class="comment">     * V target3(A...);</em>
<a id="L2814" name="L2814"></a>2814 <em class="comment">     * void filter3(V);</em>
<a id="L2815" name="L2815"></a>2815 <em class="comment">     * void adapter3(A... a) {</em>
<a id="L2816" name="L2816"></a>2816 <em class="comment">     *   V v = target3(a...);</em>
<a id="L2817" name="L2817"></a>2817 <em class="comment">     *   filter3(v);</em>
<a id="L2818" name="L2818"></a>2818 <em class="comment">     * }</em>
<a id="L2819" name="L2819"></a>2819 <em class="comment">     * }</em>
<a id="L2820" name="L2820"></a>2820 <em class="comment">     * @param target the method handle to invoke before filtering the return value</em>
<a id="L2821" name="L2821"></a>2821 <em class="comment">     * @param filter method handle to call on the return value</em>
<a id="L2822" name="L2822"></a>2822 <em class="comment">     * @return method handle which incorporates the specified return value filtering logic</em>
<a id="L2823" name="L2823"></a>2823 <em class="comment">     * @throws NullPointerException if either argument is null</em>
<a id="L2824" name="L2824"></a>2824 <em class="comment">     * @throws IllegalArgumentException if the argument list of {@code filter}</em>
<a id="L2825" name="L2825"></a>2825 <em class="comment">     *          does not match the return type of target as described above</em>
<a id="L2826" name="L2826"></a>2826 <em class="comment">     */</em>
<a id="L2827" name="L2827"></a>2827     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2828" name="L2828"></a>2828     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> filterReturnValue(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>) <em class="brace">{</em>
<a id="L2829" name="L2829"></a>2829         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2830" name="L2830"></a>2830         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType = <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2831" name="L2831"></a>2831         <a href="../S/1619.html#L2840" title="Defined at 2840 in src/java/lang/invoke/MethodHandles.java.">filterReturnValueChecks</a>(targetType, filterType);
<a id="L2832" name="L2832"></a>2832         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2833" name="L2833"></a>2833         <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a> <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = <a href="../D/813.html" title="Multiple defined in 2 places.">BasicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>(filterType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>());
<a id="L2834" name="L2834"></a>2834         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L710" title="Defined at 710 in src/java/lang/invoke/LambdaFormEditor.java.">filterReturnForm</a>(<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>, <strong class="reserved">false</strong>);
<a id="L2835" name="L2835"></a>2835         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = targetType.<a href="../S/1616.html#L582" title="Defined at 582 in src/java/lang/invoke/MethodType.java.">changeReturnType</a>(filterType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>());
<a id="L2836" name="L2836"></a>2836         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13539.html" title="Multiple defined in 3 places.">copyWithExtendL</a>(newType, lform, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>);
<a id="L2837" name="L2837"></a>2837         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2838" name="L2838"></a>2838     <em class="brace">}</em>
<a id="L2839" name="L2839"></a>2839 
<a id="L2840" name="L2840"></a>2840     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/1619.html#L2831" title="Referred from 2831 in src/java/lang/invoke/MethodHandles.java.">filterReturnValueChecks</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> filterType) <strong class="reserved">throws</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <em class="brace">{</em>
<a id="L2841" name="L2841"></a>2841         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = targetType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>();
<a id="L2842" name="L2842"></a>2842         <strong class="reserved">int</strong> filterValues = filterType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2843" name="L2843"></a>2843         <strong class="reserved">if</strong> (filterValues == 0
<a id="L2844" name="L2844"></a>2844                 ? (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> != <strong class="reserved">void</strong>.<strong class="reserved">class</strong>)
<a id="L2845" name="L2845"></a>2845                 : (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> != filterType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0)))
<a id="L2846" name="L2846"></a>2846             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("target and filter types do not match", targetType, filterType);
<a id="L2847" name="L2847"></a>2847     <em class="brace">}</em>
<a id="L2848" name="L2848"></a>2848 
<a id="L2849" name="L2849"></a>2849     <em class="comment">/**</em>
<a id="L2850" name="L2850"></a>2850 <em class="comment">     * Adapts a target method handle by pre-processing</em>
<a id="L2851" name="L2851"></a>2851 <em class="comment">     * some of its arguments, and then calling the target with</em>
<a id="L2852" name="L2852"></a>2852 <em class="comment">     * the result of the pre-processing, inserted into the original</em>
<a id="L2853" name="L2853"></a>2853 <em class="comment">     * sequence of arguments.</em>
<a id="L2854" name="L2854"></a>2854 <em class="comment">     * </em>
<a id="L2855" name="L2855"></a>2855 <em class="comment">     * The pre-processing is performed by {@code combiner}, a second method handle.</em>
<a id="L2856" name="L2856"></a>2856 <em class="comment">     * Of the arguments passed to the adapter, the first {@code N} arguments</em>
<a id="L2857" name="L2857"></a>2857 <em class="comment">     * are copied to the combiner, which is then called.</em>
<a id="L2858" name="L2858"></a>2858 <em class="comment">     * (Here, {@code N} is defined as the parameter count of the combiner.)</em>
<a id="L2859" name="L2859"></a>2859 <em class="comment">     * After this, control passes to the target, with any result</em>
<a id="L2860" name="L2860"></a>2860 <em class="comment">     * from the combiner inserted before the original {@code N} incoming</em>
<a id="L2861" name="L2861"></a>2861 <em class="comment">     * arguments.</em>
<a id="L2862" name="L2862"></a>2862 <em class="comment">     * </em>
<a id="L2863" name="L2863"></a>2863 <em class="comment">     * If the combiner returns a value, the first parameter type of the target</em>
<a id="L2864" name="L2864"></a>2864 <em class="comment">     * must be identical with the return type of the combiner, and the next</em>
<a id="L2865" name="L2865"></a>2865 <em class="comment">     * {@code N} parameter types of the target must exactly match the parameters</em>
<a id="L2866" name="L2866"></a>2866 <em class="comment">     * of the combiner.</em>
<a id="L2867" name="L2867"></a>2867 <em class="comment">     * </em>
<a id="L2868" name="L2868"></a>2868 <em class="comment">     * If the combiner has a void return, no result will be inserted,</em>
<a id="L2869" name="L2869"></a>2869 <em class="comment">     * and the first {@code N} parameter types of the target</em>
<a id="L2870" name="L2870"></a>2870 <em class="comment">     * must exactly match the parameters of the combiner.</em>
<a id="L2871" name="L2871"></a>2871 <em class="comment">     * </em>
<a id="L2872" name="L2872"></a>2872 <em class="comment">     * The resulting adapter is the same type as the target, except that the</em>
<a id="L2873" name="L2873"></a>2873 <em class="comment">     * first parameter type is dropped,</em>
<a id="L2874" name="L2874"></a>2874 <em class="comment">     * if it corresponds to the result of the combiner.</em>
<a id="L2875" name="L2875"></a>2875 <em class="comment">     * </em>
<a id="L2876" name="L2876"></a>2876 <em class="comment">     * (Note that {@link #dropArguments(MethodHandle,int,List) dropArguments} can be used to remove any arguments</em>
<a id="L2877" name="L2877"></a>2877 <em class="comment">     * that either the combiner or the target does not wish to receive.</em>
<a id="L2878" name="L2878"></a>2878 <em class="comment">     * If some of the incoming arguments are destined only for the combiner,</em>
<a id="L2879" name="L2879"></a>2879 <em class="comment">     * consider using {@link MethodHandle#asCollector asCollector} instead, since those</em>
<a id="L2880" name="L2880"></a>2880 <em class="comment">     * arguments will not need to be live on the stack on entry to the</em>
<a id="L2881" name="L2881"></a>2881 <em class="comment">     * target.)</em>
<a id="L2882" name="L2882"></a>2882 <em class="comment">     * <b>Example:</b></em>
<a id="L2883" name="L2883"></a>2883 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2884" name="L2884"></a>2884 <em class="comment">import static java.lang.invoke.MethodHandles.*;</em>
<a id="L2885" name="L2885"></a>2885 <em class="comment">import static java.lang.invoke.MethodType.*;</em>
<a id="L2886" name="L2886"></a>2886 <em class="comment">...</em>
<a id="L2887" name="L2887"></a>2887 <em class="comment">MethodHandle trace = publicLookup().findVirtual(java.io.PrintStream.class,</em>
<a id="L2888" name="L2888"></a>2888 <em class="comment">  "println", methodType(void.class, String.class))</em>
<a id="L2889" name="L2889"></a>2889 <em class="comment">    .bindTo(System.out);</em>
<a id="L2890" name="L2890"></a>2890 <em class="comment">MethodHandle cat = lookup().findVirtual(String.class,</em>
<a id="L2891" name="L2891"></a>2891 <em class="comment">  "concat", methodType(String.class, String.class));</em>
<a id="L2892" name="L2892"></a>2892 <em class="comment">assertEquals("boojum", (String) cat.invokeExact("boo", "jum"));</em>
<a id="L2893" name="L2893"></a>2893 <em class="comment">MethodHandle catTrace = foldArguments(cat, trace);</em>
<a id="L2894" name="L2894"></a>2894 <em class="comment">// also prints "boo":</em>
<a id="L2895" name="L2895"></a>2895 <em class="comment">assertEquals("boojum", (String) catTrace.invokeExact("boo", "jum"));</em>
<a id="L2896" name="L2896"></a>2896 <em class="comment">     * }</em>
<a id="L2897" name="L2897"></a>2897 <em class="comment">     *  Here is pseudocode for the resulting adapter:</em>
<a id="L2898" name="L2898"></a>2898 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2899" name="L2899"></a>2899 <em class="comment">     * // there are N arguments in A...</em>
<a id="L2900" name="L2900"></a>2900 <em class="comment">     * T target(V, A[N]..., B...);</em>
<a id="L2901" name="L2901"></a>2901 <em class="comment">     * V combiner(A...);</em>
<a id="L2902" name="L2902"></a>2902 <em class="comment">     * T adapter(A... a, B... b) {</em>
<a id="L2903" name="L2903"></a>2903 <em class="comment">     *   V v = combiner(a...);</em>
<a id="L2904" name="L2904"></a>2904 <em class="comment">     *   return target(v, a..., b...);</em>
<a id="L2905" name="L2905"></a>2905 <em class="comment">     * }</em>
<a id="L2906" name="L2906"></a>2906 <em class="comment">     * // and if the combiner has a void return:</em>
<a id="L2907" name="L2907"></a>2907 <em class="comment">     * T target2(A[N]..., B...);</em>
<a id="L2908" name="L2908"></a>2908 <em class="comment">     * void combiner2(A...);</em>
<a id="L2909" name="L2909"></a>2909 <em class="comment">     * T adapter2(A... a, B... b) {</em>
<a id="L2910" name="L2910"></a>2910 <em class="comment">     *   combiner2(a...);</em>
<a id="L2911" name="L2911"></a>2911 <em class="comment">     *   return target2(a..., b...);</em>
<a id="L2912" name="L2912"></a>2912 <em class="comment">     * }</em>
<a id="L2913" name="L2913"></a>2913 <em class="comment">     * }</em>
<a id="L2914" name="L2914"></a>2914 <em class="comment">     * @param target the method handle to invoke after arguments are combined</em>
<a id="L2915" name="L2915"></a>2915 <em class="comment">     * @param combiner method handle to call initially on the incoming arguments</em>
<a id="L2916" name="L2916"></a>2916 <em class="comment">     * @return method handle which incorporates the specified argument folding logic</em>
<a id="L2917" name="L2917"></a>2917 <em class="comment">     * @throws NullPointerException if either argument is null</em>
<a id="L2918" name="L2918"></a>2918 <em class="comment">     * @throws IllegalArgumentException if {@code combiner}'s return type</em>
<a id="L2919" name="L2919"></a>2919 <em class="comment">     *          is non-void and not the same as the first argument type of</em>
<a id="L2920" name="L2920"></a>2920 <em class="comment">     *          the target, or if the initial {@code N} argument types</em>
<a id="L2921" name="L2921"></a>2921 <em class="comment">     *          of the target</em>
<a id="L2922" name="L2922"></a>2922 <em class="comment">     *          (skipping one matching the {@code combiner}'s return type)</em>
<a id="L2923" name="L2923"></a>2923 <em class="comment">     *          are not identical with the argument types of {@code combiner}</em>
<a id="L2924" name="L2924"></a>2924 <em class="comment">     */</em>
<a id="L2925" name="L2925"></a>2925     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2926" name="L2926"></a>2926     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1601.html#L216" title="Referred from 216 in src/java/lang/invoke/CallSite.java.">foldArguments</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>) <em class="brace">{</em>
<a id="L2927" name="L2927"></a>2927         <strong class="reserved">int</strong> foldPos = 0;
<a id="L2928" name="L2928"></a>2928         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2929" name="L2929"></a>2929         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> combinerType = <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2930" name="L2930"></a>2930         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = <a href="../S/1619.html#L2942" title="Defined at 2942 in src/java/lang/invoke/MethodHandles.java.">foldArgumentChecks</a>(foldPos, targetType, combinerType);
<a id="L2931" name="L2931"></a>2931         <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/30364.html" title="Multiple defined in 23 places.">rebind</a>();
<a id="L2932" name="L2932"></a>2932         <strong class="reserved">boolean</strong> dropResult = (<a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> == <strong class="reserved">void</strong>.<strong class="reserved">class</strong>);
<a id="L2933" name="L2933"></a>2933         <em class="comment">// Note:  This may cache too many distinct LFs. Consider backing off to varargs code.</em>
<a id="L2934" name="L2934"></a>2934         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/15284.html" title="Multiple defined in 2 places.">editor</a>().<a href="../S/1629.html#L761" title="Defined at 761 in src/java/lang/invoke/LambdaFormEditor.java.">foldArgumentsForm</a>(1 + foldPos, dropResult, combinerType.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>());
<a id="L2935" name="L2935"></a>2935         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> newType = targetType;
<a id="L2936" name="L2936"></a>2936         <strong class="reserved">if</strong> (!dropResult)
<a id="L2937" name="L2937"></a>2937             newType = newType.<a href="../S/1616.html#L548" title="Defined at 548 in src/java/lang/invoke/MethodType.java.">dropParameterTypes</a>(foldPos, foldPos + 1);
<a id="L2938" name="L2938"></a>2938         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/13539.html" title="Multiple defined in 3 places.">copyWithExtendL</a>(newType, lform, <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>);
<a id="L2939" name="L2939"></a>2939         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2940" name="L2940"></a>2940     <em class="brace">}</em>
<a id="L2941" name="L2941"></a>2941 
<a id="L2942" name="L2942"></a>2942     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1619.html#L2930" title="Referred from 2930 in src/java/lang/invoke/MethodHandles.java.">foldArgumentChecks</a>(<strong class="reserved">int</strong> foldPos, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> combinerType) <em class="brace">{</em>
<a id="L2943" name="L2943"></a>2943         <strong class="reserved">int</strong> foldArgs   = combinerType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L2944" name="L2944"></a>2944         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> = combinerType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>();
<a id="L2945" name="L2945"></a>2945         <strong class="reserved">int</strong> foldVals = <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a> == <strong class="reserved">void</strong>.<strong class="reserved">class</strong> ? 0 : 1;
<a id="L2946" name="L2946"></a>2946         <strong class="reserved">int</strong> afterInsertPos = foldPos + foldVals;
<a id="L2947" name="L2947"></a>2947         <strong class="reserved">boolean</strong> ok = (targetType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() &gt;= afterInsertPos + foldArgs);
<a id="L2948" name="L2948"></a>2948         <strong class="reserved">if</strong> (ok &amp;&amp; !(combinerType.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>()
<a id="L2949" name="L2949"></a>2949                     .<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(targetType.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>().<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(afterInsertPos,
<a id="L2950" name="L2950"></a>2950                                                                afterInsertPos + foldArgs))))
<a id="L2951" name="L2951"></a>2951             ok = <strong class="reserved">false</strong>;
<a id="L2952" name="L2952"></a>2952         <strong class="reserved">if</strong> (ok &amp;&amp; foldVals != 0 &amp;&amp; combinerType.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != targetType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0))
<a id="L2953" name="L2953"></a>2953             ok = <strong class="reserved">false</strong>;
<a id="L2954" name="L2954"></a>2954         <strong class="reserved">if</strong> (!ok)
<a id="L2955" name="L2955"></a>2955             <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and combiner types", targetType, combinerType);
<a id="L2956" name="L2956"></a>2956         <strong class="reserved">return</strong> <a href="../S/1616.html#L126" title="Defined at 126 in src/java/lang/invoke/MethodType.java.">rtype</a>;
<a id="L2957" name="L2957"></a>2957     <em class="brace">}</em>
<a id="L2958" name="L2958"></a>2958 
<a id="L2959" name="L2959"></a>2959     <em class="comment">/**</em>
<a id="L2960" name="L2960"></a>2960 <em class="comment">     * Makes a method handle which adapts a target method handle,</em>
<a id="L2961" name="L2961"></a>2961 <em class="comment">     * by guarding it with a test, a boolean-valued method handle.</em>
<a id="L2962" name="L2962"></a>2962 <em class="comment">     * If the guard fails, a fallback handle is called instead.</em>
<a id="L2963" name="L2963"></a>2963 <em class="comment">     * All three method handles must have the same corresponding</em>
<a id="L2964" name="L2964"></a>2964 <em class="comment">     * argument and return types, except that the return type</em>
<a id="L2965" name="L2965"></a>2965 <em class="comment">     * of the test must be boolean, and the test is allowed</em>
<a id="L2966" name="L2966"></a>2966 <em class="comment">     * to have fewer arguments than the other two method handles.</em>
<a id="L2967" name="L2967"></a>2967 <em class="comment">     *  Here is pseudocode for the resulting adapter:</em>
<a id="L2968" name="L2968"></a>2968 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L2969" name="L2969"></a>2969 <em class="comment">     * boolean test(A...);</em>
<a id="L2970" name="L2970"></a>2970 <em class="comment">     * T target(A...,B...);</em>
<a id="L2971" name="L2971"></a>2971 <em class="comment">     * T fallback(A...,B...);</em>
<a id="L2972" name="L2972"></a>2972 <em class="comment">     * T adapter(A... a,B... b) {</em>
<a id="L2973" name="L2973"></a>2973 <em class="comment">     *   if (test(a...))</em>
<a id="L2974" name="L2974"></a>2974 <em class="comment">     *     return target(a..., b...);</em>
<a id="L2975" name="L2975"></a>2975 <em class="comment">     *   else</em>
<a id="L2976" name="L2976"></a>2976 <em class="comment">     *     return fallback(a..., b...);</em>
<a id="L2977" name="L2977"></a>2977 <em class="comment">     * }</em>
<a id="L2978" name="L2978"></a>2978 <em class="comment">     * }</em>
<a id="L2979" name="L2979"></a>2979 <em class="comment">     * Note that the test arguments ({@code a...} in the pseudocode) cannot</em>
<a id="L2980" name="L2980"></a>2980 <em class="comment">     * be modified by execution of the test, and so are passed unchanged</em>
<a id="L2981" name="L2981"></a>2981 <em class="comment">     * from the caller to the target or fallback as appropriate.</em>
<a id="L2982" name="L2982"></a>2982 <em class="comment">     * @param test method handle used for test, must return boolean</em>
<a id="L2983" name="L2983"></a>2983 <em class="comment">     * @param target method handle to call if test passes</em>
<a id="L2984" name="L2984"></a>2984 <em class="comment">     * @param fallback method handle to call if test fails</em>
<a id="L2985" name="L2985"></a>2985 <em class="comment">     * @return method handle which incorporates the specified if/then/else logic</em>
<a id="L2986" name="L2986"></a>2986 <em class="comment">     * @throws NullPointerException if any argument is null</em>
<a id="L2987" name="L2987"></a>2987 <em class="comment">     * @throws IllegalArgumentException if {@code test} does not return boolean,</em>
<a id="L2988" name="L2988"></a>2988 <em class="comment">     *          or if all three method types do not match (with the return</em>
<a id="L2989" name="L2989"></a>2989 <em class="comment">     *          type of {@code test} changed to match that of the target).</em>
<a id="L2990" name="L2990"></a>2990 <em class="comment">     */</em>
<a id="L2991" name="L2991"></a>2991     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L2992" name="L2992"></a>2992     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/1622.html#L173" title="Referred from 173 in src/java/lang/invoke/SwitchPoint.java.">guardWithTest</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>,
<a id="L2993" name="L2993"></a>2993                                <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>,
<a id="L2994" name="L2994"></a>2994                                <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> fallback) <em class="brace">{</em>
<a id="L2995" name="L2995"></a>2995         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> gtype = <a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2996" name="L2996"></a>2996         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> ttype = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2997" name="L2997"></a>2997         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> ftype = fallback.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L2998" name="L2998"></a>2998         <strong class="reserved">if</strong> (!ttype.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(ftype))
<a id="L2999" name="L2999"></a>2999             <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and fallback types", ttype, ftype);
<a id="L3000" name="L3000"></a>3000         <strong class="reserved">if</strong> (gtype.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != <strong class="reserved">boolean</strong>.<strong class="reserved">class</strong>)
<a id="L3001" name="L3001"></a>3001             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("guard type is not a predicate "+gtype);
<a id="L3002" name="L3002"></a>3002         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; targs = ttype.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L3003" name="L3003"></a>3003         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; gargs = gtype.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L3004" name="L3004"></a>3004         <strong class="reserved">if</strong> (!targs.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(gargs)) <em class="brace">{</em>
<a id="L3005" name="L3005"></a>3005             <strong class="reserved">int</strong> gpc = gargs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>(), tpc = targs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L3006" name="L3006"></a>3006             <strong class="reserved">if</strong> (gpc &gt;= tpc || !targs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(0, gpc).<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(gargs))
<a id="L3007" name="L3007"></a>3007                 <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and test types", ttype, gtype);
<a id="L3008" name="L3008"></a>3008             <a href="../D/35234.html" title="Multiple defined in 11 places.">test</a> = <a href="../D/15233.html" title="Multiple defined in 2 places.">dropArguments</a>(<a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>, gpc, targs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(gpc, tpc));
<a id="L3009" name="L3009"></a>3009             gtype = <a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L3010" name="L3010"></a>3010         <em class="brace">}</em>
<a id="L3011" name="L3011"></a>3011         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L726" title="Defined at 726 in src/java/lang/invoke/MethodHandleImpl.java.">makeGuardWithTest</a>(<a href="../D/35234.html" title="Multiple defined in 11 places.">test</a>, <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, fallback);
<a id="L3012" name="L3012"></a>3012     <em class="brace">}</em>
<a id="L3013" name="L3013"></a>3013 
<a id="L3014" name="L3014"></a>3014     <strong class="reserved">static</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <a href="../R/23307.html" title="Multiple referred from 5 places.">misMatchedTypes</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> what, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> t1, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> t2) <em class="brace">{</em>
<a id="L3015" name="L3015"></a>3015         <strong class="reserved">return</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>(what + " must match: " + t1 + " != " + t2);
<a id="L3016" name="L3016"></a>3016     <em class="brace">}</em>
<a id="L3017" name="L3017"></a>3017 
<a id="L3018" name="L3018"></a>3018     <em class="comment">/**</em>
<a id="L3019" name="L3019"></a>3019 <em class="comment">     * Makes a method handle which adapts a target method handle,</em>
<a id="L3020" name="L3020"></a>3020 <em class="comment">     * by running it inside an exception handler.</em>
<a id="L3021" name="L3021"></a>3021 <em class="comment">     * If the target returns normally, the adapter returns that value.</em>
<a id="L3022" name="L3022"></a>3022 <em class="comment">     * If an exception matching the specified type is thrown, the fallback</em>
<a id="L3023" name="L3023"></a>3023 <em class="comment">     * handle is called instead on the exception, plus the original arguments.</em>
<a id="L3024" name="L3024"></a>3024 <em class="comment">     * </em>
<a id="L3025" name="L3025"></a>3025 <em class="comment">     * The target and handler must have the same corresponding</em>
<a id="L3026" name="L3026"></a>3026 <em class="comment">     * argument and return types, except that handler may omit trailing arguments</em>
<a id="L3027" name="L3027"></a>3027 <em class="comment">     * (similarly to the predicate in {@link #guardWithTest guardWithTest}).</em>
<a id="L3028" name="L3028"></a>3028 <em class="comment">     * Also, the handler must have an extra leading parameter of {@code exType} or a supertype.</em>
<a id="L3029" name="L3029"></a>3029 <em class="comment">     *  Here is pseudocode for the resulting adapter:</em>
<a id="L3030" name="L3030"></a>3030 <em class="comment">     * <blockquote><pre>{@code</pre></blockquote></em>
<a id="L3031" name="L3031"></a>3031 <em class="comment">     * T target(A..., B...);</em>
<a id="L3032" name="L3032"></a>3032 <em class="comment">     * T handler(ExType, A...);</em>
<a id="L3033" name="L3033"></a>3033 <em class="comment">     * T adapter(A... a, B... b) {</em>
<a id="L3034" name="L3034"></a>3034 <em class="comment">     *   try {</em>
<a id="L3035" name="L3035"></a>3035 <em class="comment">     *     return target(a..., b...);</em>
<a id="L3036" name="L3036"></a>3036 <em class="comment">     *   } catch (ExType ex) {</em>
<a id="L3037" name="L3037"></a>3037 <em class="comment">     *     return handler(ex, a...);</em>
<a id="L3038" name="L3038"></a>3038 <em class="comment">     *   }</em>
<a id="L3039" name="L3039"></a>3039 <em class="comment">     * }</em>
<a id="L3040" name="L3040"></a>3040 <em class="comment">     * }</em>
<a id="L3041" name="L3041"></a>3041 <em class="comment">     * Note that the saved arguments ({@code a...} in the pseudocode) cannot</em>
<a id="L3042" name="L3042"></a>3042 <em class="comment">     * be modified by execution of the target, and so are passed unchanged</em>
<a id="L3043" name="L3043"></a>3043 <em class="comment">     * from the caller to the handler, if the handler is invoked.</em>
<a id="L3044" name="L3044"></a>3044 <em class="comment">     * </em>
<a id="L3045" name="L3045"></a>3045 <em class="comment">     * The target and handler must return the same type, even if the handler</em>
<a id="L3046" name="L3046"></a>3046 <em class="comment">     * always throws.  (This might happen, for instance, because the handler</em>
<a id="L3047" name="L3047"></a>3047 <em class="comment">     * is simulating a {@code finally} clause).</em>
<a id="L3048" name="L3048"></a>3048 <em class="comment">     * To create such a throwing handler, compose the handler creation logic</em>
<a id="L3049" name="L3049"></a>3049 <em class="comment">     * with {@link #throwException throwException},</em>
<a id="L3050" name="L3050"></a>3050 <em class="comment">     * in order to create a method handle of the correct return type.</em>
<a id="L3051" name="L3051"></a>3051 <em class="comment">     * @param target method handle to call</em>
<a id="L3052" name="L3052"></a>3052 <em class="comment">     * @param exType the type of exception which the handler will catch</em>
<a id="L3053" name="L3053"></a>3053 <em class="comment">     * @param handler method handle to call if a matching exception is thrown</em>
<a id="L3054" name="L3054"></a>3054 <em class="comment">     * @return method handle which incorporates the specified try/catch logic</em>
<a id="L3055" name="L3055"></a>3055 <em class="comment">     * @throws NullPointerException if any argument is null</em>
<a id="L3056" name="L3056"></a>3056 <em class="comment">     * @throws IllegalArgumentException if {@code handler} does not accept</em>
<a id="L3057" name="L3057"></a>3057 <em class="comment">     *          the given exception type, or if the method handle types do</em>
<a id="L3058" name="L3058"></a>3058 <em class="comment">     *          not match in their return types and their</em>
<a id="L3059" name="L3059"></a>3059 <em class="comment">     *          corresponding parameters</em>
<a id="L3060" name="L3060"></a>3060 <em class="comment">     */</em>
<a id="L3061" name="L3061"></a>3061     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L3062" name="L3062"></a>3062     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> catchException(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>,
<a id="L3063" name="L3063"></a>3063                                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;? <strong class="reserved">extends</strong> <a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a>&gt; exType,
<a id="L3064" name="L3064"></a>3064                                 <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>) <em class="brace">{</em>
<a id="L3065" name="L3065"></a>3065         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> ttype = <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L3066" name="L3066"></a>3066         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> htype = <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L3067" name="L3067"></a>3067         <strong class="reserved">if</strong> (htype.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() &lt; 1 ||
<a id="L3068" name="L3068"></a>3068             !htype.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(0).<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(exType))
<a id="L3069" name="L3069"></a>3069             <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("handler does not accept exception type "+exType);
<a id="L3070" name="L3070"></a>3070         <strong class="reserved">if</strong> (htype.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>() != ttype.<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>())
<a id="L3071" name="L3071"></a>3071             <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and handler return types", ttype, htype);
<a id="L3072" name="L3072"></a>3072         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; targs = ttype.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L3073" name="L3073"></a>3073         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt;&gt; hargs = htype.<a href="../S/1616.html#L728" title="Defined at 728 in src/java/lang/invoke/MethodType.java.">parameterList</a>();
<a id="L3074" name="L3074"></a>3074         hargs = hargs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(1, hargs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>());  <em class="comment">// omit leading parameter from handler</em>
<a id="L3075" name="L3075"></a>3075         <strong class="reserved">if</strong> (!targs.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(hargs)) <em class="brace">{</em>
<a id="L3076" name="L3076"></a>3076             <strong class="reserved">int</strong> hpc = hargs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>(), tpc = targs.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L3077" name="L3077"></a>3077             <strong class="reserved">if</strong> (hpc &gt;= tpc || !targs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(0, hpc).<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(hargs))
<a id="L3078" name="L3078"></a>3078                 <strong class="reserved">throw</strong> <a href="../S/1619.html#L3014" title="Defined at 3014 in src/java/lang/invoke/MethodHandles.java.">misMatchedTypes</a>("target and handler types", ttype, htype);
<a id="L3079" name="L3079"></a>3079             <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a> = <a href="../D/15233.html" title="Multiple defined in 2 places.">dropArguments</a>(<a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>, 1+hpc, targs.<a href="../D/34984.html" title="Multiple defined in 17 places.">subList</a>(hpc, tpc));
<a id="L3080" name="L3080"></a>3080             htype = <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L3081" name="L3081"></a>3081         <em class="brace">}</em>
<a id="L3082" name="L3082"></a>3082         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../S/1634.html#L1007" title="Defined at 1007 in src/java/lang/invoke/MethodHandleImpl.java.">makeGuardWithCatch</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, exType, <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>);
<a id="L3083" name="L3083"></a>3083     <em class="brace">}</em>
<a id="L3084" name="L3084"></a>3084 
<a id="L3085" name="L3085"></a>3085     <em class="comment">/**</em>
<a id="L3086" name="L3086"></a>3086 <em class="comment">     * Produces a method handle which will throw exceptions of the given {@code exType}.</em>
<a id="L3087" name="L3087"></a>3087 <em class="comment">     * The method handle will accept a single argument of {@code exType},</em>
<a id="L3088" name="L3088"></a>3088 <em class="comment">     * and immediately throw it as an exception.</em>
<a id="L3089" name="L3089"></a>3089 <em class="comment">     * The method type will nominally specify a return of {@code returnType}.</em>
<a id="L3090" name="L3090"></a>3090 <em class="comment">     * The return type may be anything convenient:  It doesn't matter to the</em>
<a id="L3091" name="L3091"></a>3091 <em class="comment">     * method handle's behavior, since it will never return normally.</em>
<a id="L3092" name="L3092"></a>3092 <em class="comment">     * @param returnType the return type of the desired method handle</em>
<a id="L3093" name="L3093"></a>3093 <em class="comment">     * @param exType the parameter type of the desired method handle</em>
<a id="L3094" name="L3094"></a>3094 <em class="comment">     * @return method handle which can throw the given exceptions</em>
<a id="L3095" name="L3095"></a>3095 <em class="comment">     * @throws NullPointerException if either argument is null</em>
<a id="L3096" name="L3096"></a>3096 <em class="comment">     */</em>
<a id="L3097" name="L3097"></a>3097     <strong class="reserved">public</strong> <strong class="reserved">static</strong>
<a id="L3098" name="L3098"></a>3098     <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/29172.html" title="Multiple referred from 38 places.">throwException</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;? <strong class="reserved">extends</strong> <a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a>&gt; exType) <em class="brace">{</em>
<a id="L3099" name="L3099"></a>3099         <strong class="reserved">if</strong> (!<a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a>.<strong class="reserved">class</strong>.<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(exType))
<a id="L3100" name="L3100"></a>3100             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1727.html#L41" title="Defined at 41 in src/java/lang/ClassCastException.java.">ClassCastException</a>(exType.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>());
<a id="L3101" name="L3101"></a>3101         <strong class="reserved">return</strong> <a href="../S/1634.html#L49" title="Defined at 49 in src/java/lang/invoke/MethodHandleImpl.java.">MethodHandleImpl</a>.<a href="../D/35296.html" title="Multiple defined in 6 places.">throwException</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../D/27690.html" title="Multiple defined in 8 places.">methodType</a>(<a href="../D/31403.html" title="Multiple defined in 4 places.">returnType</a>, exType));
<a id="L3102" name="L3102"></a>3102     <em class="brace">}</em>
<a id="L3103" name="L3103"></a>3103 <em class="brace">}</em>
</pre>
<hr>
<a id="BOTTOM" name="BOTTOM"></a>
<em class="comment">/* [&lt;][&gt;]<a href="#L92">[^]</a><a href="#L3098">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</em>


</body></html>