<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xpath/internal/axes/DescendantIterator.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L152">[^]</a><a href="#L371">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L152" title="Defined at 152.">cloneWithReset</a></li>
<li><a href="#L175" title="Defined at 175.">nextNode</a></li>
<li><a href="#L264" title="Defined at 264.">setRoot</a></li>
<li><a href="#L296" title="Defined at 296.">asNode</a></li>
<li><a href="#L336" title="Defined at 336.">detach</a></li>
<li><a href="#L353" title="Defined at 353.">getAxis</a></li>
<li><a href="#L371" title="Defined at 371.">deepEquals</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: DescendantIterator.java,v 1.2.4.2 2005/09/14 19:45:21 jeffsuttor Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xpath.internal.axes;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.Axis;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTM;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMAxisTraverser;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMFilter;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMIterator;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.Expression;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.XPathContext;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.compiler.Compiler;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.compiler.OpCodes;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.compiler.OpMap;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.patterns.NodeTest;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> org.w3c.dom.DOMException;
<a id="L37" name="L37"></a>  37 
<div class="comment">
  This class implements an optimized iterator for
  descendant, descendant-or-self, or "//foo" patterns.
  @see com.sun.org.apache.xpath.internal.axes.LocPathIterator
  @xsl.usage advanced</div>
<a id="L44" name="L44"></a>  44 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/2200.html" title="Multiple referred from 10 places.">DescendantIterator</a> <strong class="reserved">extends</strong> <a href="../S/4876.html#L51" title="Defined at 51 in src/com/sun/org/apache/xpath/internal/axes/LocPathIterator.java.">LocPathIterator</a>
<a id="L45" name="L45"></a>  45 <em class="brace">{</em>
<a id="L46" name="L46"></a>  46     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = -1190338607743976938L;
<div class="comment">
    Create a DescendantIterator object.
    @param compiler A reference to the Compiler that contains the op map.
    @param opPos The position within the op map, which contains the
    location path expression for this itterator.
    @throws javax.xml.transform.TransformerException</div>
<a id="L56" name="L56"></a>  56   DescendantIterator(<a href="../D/1702.html" title="Multiple defined in 2 places.">Compiler</a> compiler, <strong class="reserved">int</strong> opPos, <strong class="reserved">int</strong> analysis)
<a id="L57" name="L57"></a>  57           <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L58" name="L58"></a>  58   <em class="brace">{</em>
<a id="L59" name="L59"></a>  59 
<a id="L60" name="L60"></a>  60     <strong class="reserved">super</strong>(compiler, opPos, analysis, <strong class="reserved">false</strong>);
<a id="L61" name="L61"></a>  61 
<a id="L62" name="L62"></a>  62     <strong class="reserved">int</strong> firstStepPos = <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.<a href="../S/4996.html#L333" title="Defined at 333 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getFirstChildPos</a>(opPos);
<a id="L63" name="L63"></a>  63     <strong class="reserved">int</strong> stepType = compiler.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(firstStepPos);
<a id="L64" name="L64"></a>  64 
<a id="L65" name="L65"></a>  65     <strong class="reserved">boolean</strong> orSelf = (<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_DESCENDANTS_OR_SELF == stepType);
<a id="L66" name="L66"></a>  66     <strong class="reserved">boolean</strong> fromRoot = <strong class="reserved">false</strong>;
<a id="L67" name="L67"></a>  67     <strong class="reserved">if</strong> (<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_SELF == stepType)
<a id="L68" name="L68"></a>  68     <em class="brace">{</em>
<a id="L69" name="L69"></a>  69       orSelf = <strong class="reserved">true</strong>;
<a id="L70" name="L70"></a>  70       <em class="comment">// firstStepPos += 8;</em>
<a id="L71" name="L71"></a>  71     <em class="brace">}</em>
<a id="L72" name="L72"></a>  72     <strong class="reserved">else</strong> <strong class="reserved">if</strong>(<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_ROOT == stepType)
<a id="L73" name="L73"></a>  73     <em class="brace">{</em>
<a id="L74" name="L74"></a>  74       fromRoot = <strong class="reserved">true</strong>;
<a id="L75" name="L75"></a>  75       <em class="comment">// Ugly code... will go away when AST work is done.</em>
<a id="L76" name="L76"></a>  76       <strong class="reserved">int</strong> nextStepPos = compiler.<a href="../S/4996.html#L212" title="Defined at 212 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getNextStepPos</a>(firstStepPos);
<a id="L77" name="L77"></a>  77       <strong class="reserved">if</strong>(compiler.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(nextStepPos) == <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_DESCENDANTS_OR_SELF)
<a id="L78" name="L78"></a>  78         orSelf = <strong class="reserved">true</strong>;
<a id="L79" name="L79"></a>  79       <em class="comment">// firstStepPos += 8;</em>
<a id="L80" name="L80"></a>  80     <em class="brace">}</em>
<a id="L81" name="L81"></a>  81 
<a id="L82" name="L82"></a>  82     <em class="comment">// Find the position of the last step.</em>
<a id="L83" name="L83"></a>  83     <strong class="reserved">int</strong> nextStepPos = firstStepPos;
<a id="L84" name="L84"></a>  84     <strong class="reserved">while</strong>(<strong class="reserved">true</strong>)
<a id="L85" name="L85"></a>  85     <em class="brace">{</em>
<a id="L86" name="L86"></a>  86       nextStepPos = compiler.<a href="../S/4996.html#L212" title="Defined at 212 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getNextStepPos</a>(nextStepPos);
<a id="L87" name="L87"></a>  87       <strong class="reserved">if</strong>(nextStepPos &gt; 0)
<a id="L88" name="L88"></a>  88       <em class="brace">{</em>
<a id="L89" name="L89"></a>  89         <strong class="reserved">int</strong> stepOp = compiler.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(nextStepPos);
<a id="L90" name="L90"></a>  90         <strong class="reserved">if</strong>(<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ENDOP != stepOp)
<a id="L91" name="L91"></a>  91           firstStepPos = nextStepPos;
<a id="L92" name="L92"></a>  92         <strong class="reserved">else</strong>
<a id="L93" name="L93"></a>  93           <strong class="reserved">break</strong>;
<a id="L94" name="L94"></a>  94       <em class="brace">}</em>
<a id="L95" name="L95"></a>  95       <strong class="reserved">else</strong>
<a id="L96" name="L96"></a>  96         <strong class="reserved">break</strong>;
<a id="L97" name="L97"></a>  97 
<a id="L98" name="L98"></a>  98     <em class="brace">}</em>
<a id="L99" name="L99"></a>  99 
<a id="L100" name="L100"></a> 100     <em class="comment">// Fix for http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1336</em>
<a id="L101" name="L101"></a> 101     <strong class="reserved">if</strong>((analysis &amp; <a href="../S/4868.html#L46" title="Defined at 46 in src/com/sun/org/apache/xpath/internal/axes/WalkerFactory.java.">WalkerFactory</a>.BIT_CHILD) != 0)
<a id="L102" name="L102"></a> 102       orSelf = <strong class="reserved">false</strong>;
<a id="L103" name="L103"></a> 103 
<a id="L104" name="L104"></a> 104     <strong class="reserved">if</strong>(fromRoot)
<a id="L105" name="L105"></a> 105     <em class="brace">{</em>
<a id="L106" name="L106"></a> 106       <strong class="reserved">if</strong>(orSelf)
<a id="L107" name="L107"></a> 107         m_axis = <a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.DESCENDANTSORSELFFROMROOT;
<a id="L108" name="L108"></a> 108       <strong class="reserved">else</strong>
<a id="L109" name="L109"></a> 109         m_axis = <a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.DESCENDANTSFROMROOT;
<a id="L110" name="L110"></a> 110     <em class="brace">}</em>
<a id="L111" name="L111"></a> 111     <strong class="reserved">else</strong> <strong class="reserved">if</strong>(orSelf)
<a id="L112" name="L112"></a> 112       m_axis = <a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.DESCENDANTORSELF;
<a id="L113" name="L113"></a> 113     <strong class="reserved">else</strong>
<a id="L114" name="L114"></a> 114       m_axis = <a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.DESCENDANT;
<a id="L115" name="L115"></a> 115 
<a id="L116" name="L116"></a> 116     <strong class="reserved">int</strong> whatToShow = compiler.<a href="../D/23670.html" title="Multiple defined in 14 places.">getWhatToShow</a>(firstStepPos);
<a id="L117" name="L117"></a> 117 
<a id="L118" name="L118"></a> 118     <strong class="reserved">if</strong> ((0 == (whatToShow
<a id="L119" name="L119"></a> 119                &amp; (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ATTRIBUTE | <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ELEMENT
<a id="L120" name="L120"></a> 120                   | <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_PROCESSING_INSTRUCTION))) ||
<a id="L121" name="L121"></a> 121                    (whatToShow == <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ALL))
<a id="L122" name="L122"></a> 122       <a href="../D/24578.html" title="Multiple defined in 2 places.">initNodeTest</a>(whatToShow);
<a id="L123" name="L123"></a> 123     <strong class="reserved">else</strong>
<a id="L124" name="L124"></a> 124     <em class="brace">{</em>
<a id="L125" name="L125"></a> 125       <a href="../D/24578.html" title="Multiple defined in 2 places.">initNodeTest</a>(whatToShow, compiler.<a href="../S/4996.html#L393" title="Defined at 393 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getStepNS</a>(firstStepPos),
<a id="L126" name="L126"></a> 126                               compiler.<a href="../S/4996.html#L420" title="Defined at 420 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getStepLocalName</a>(firstStepPos));
<a id="L127" name="L127"></a> 127     <em class="brace">}</em>
<a id="L128" name="L128"></a> 128     <a href="../S/4867.html#L161" title="Defined at 161 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">initPredicateInfo</a>(compiler, firstStepPos);
<a id="L129" name="L129"></a> 129   <em class="brace">}</em>
<a id="L130" name="L130"></a> 130 
<div class="comment">
    Create a DescendantIterator object.</div>
<a id="L135" name="L135"></a> 135   <strong class="reserved">public</strong> DescendantIterator()
<a id="L136" name="L136"></a> 136   <em class="brace">{</em>
<a id="L137" name="L137"></a> 137     <strong class="reserved">super</strong>(<strong class="reserved">null</strong>);
<a id="L138" name="L138"></a> 138     m_axis = <a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.DESCENDANTSORSELFFROMROOT;
<a id="L139" name="L139"></a> 139     <strong class="reserved">int</strong> whatToShow = <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ALL;
<a id="L140" name="L140"></a> 140     <a href="../D/24578.html" title="Multiple defined in 2 places.">initNodeTest</a>(whatToShow);
<a id="L141" name="L141"></a> 141   <em class="brace">}</em>
<a id="L142" name="L142"></a> 142 
<a id="L143" name="L143"></a> 143 
<div class="comment">
     Get a cloned Iterator that is reset to the beginning
     of the query.
     @return A cloned NodeIterator set of the start of the query.
     @throws CloneNotSupportedException</div>
<a id="L152" name="L152"></a> 152   <strong class="reserved">public</strong> <a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a> <a href="../R/11583.html" title="Multiple referred from 10 places.">cloneWithReset</a>() <strong class="reserved">throws</strong> <a href="../S/1725.html#L45" title="Defined at 45 in src/java/lang/CloneNotSupportedException.java.">CloneNotSupportedException</a>
<a id="L153" name="L153"></a> 153   <em class="brace">{</em>
<a id="L154" name="L154"></a> 154 
<a id="L155" name="L155"></a> 155     <a href="../D/2391.html" title="Multiple defined in 3 places.">DescendantIterator</a> <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a> = (<a href="../D/2391.html" title="Multiple defined in 3 places.">DescendantIterator</a>) <strong class="reserved">super</strong>.<a href="../D/12918.html" title="Multiple defined in 10 places.">cloneWithReset</a>();
<a id="L156" name="L156"></a> 156     <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>.m_traverser = m_traverser;
<a id="L157" name="L157"></a> 157 
<a id="L158" name="L158"></a> 158     <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>.<a href="../S/4867.html#L243" title="Defined at 243 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">resetProximityPositions</a>();
<a id="L159" name="L159"></a> 159 
<a id="L160" name="L160"></a> 160     <strong class="reserved">return</strong> <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>;
<a id="L161" name="L161"></a> 161   <em class="brace">}</em>
<a id="L162" name="L162"></a> 162 
<div class="comment">
     Returns the next node in the set and advances the position of the
    iterator in the set. After a NodeIterator is created, the first call
    to nextNode() returns the first node in the set.
    @return  The next <code>Node</code> in the set being iterated over, or
      <code>null</code> if there are no more members in that set.
    @throws DOMException
       INVALID_STATE_ERR: Raised if this method is called after the
      <code>detach</code> method was invoked.</div>
<a id="L175" name="L175"></a> 175   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/23682.html" title="Multiple referred from 192 places.">nextNode</a>()
<a id="L176" name="L176"></a> 176   <em class="brace">{</em>
<a id="L177" name="L177"></a> 177         <strong class="reserved">if</strong>(m_foundLast)
<a id="L178" name="L178"></a> 178                 <strong class="reserved">return</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L179" name="L179"></a> 179 
<a id="L180" name="L180"></a> 180     <strong class="reserved">if</strong>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> == m_lastFetched)
<a id="L181" name="L181"></a> 181     <em class="brace">{</em>
<a id="L182" name="L182"></a> 182       <a href="../S/4867.html#L243" title="Defined at 243 in src/com/sun/org/apache/xpath/internal/axes/PredicatedNodeTest.java.">resetProximityPositions</a>();
<a id="L183" name="L183"></a> 183     <em class="brace">}</em>
<a id="L184" name="L184"></a> 184 
<a id="L185" name="L185"></a> 185     <strong class="reserved">int</strong> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L186" name="L186"></a> 186 
<a id="L187" name="L187"></a> 187     com.sun.org.apache.xpath.internal.<a href="../S/4856.html#L39" title="Defined at 39 in src/com/sun/org/apache/xpath/internal/VariableStack.java.">VariableStack</a> vars;
<a id="L188" name="L188"></a> 188     <strong class="reserved">int</strong> savedStart;
<a id="L189" name="L189"></a> 189     <strong class="reserved">if</strong> (-1 != m_stackFrame)
<a id="L190" name="L190"></a> 190     <em class="brace">{</em>
<a id="L191" name="L191"></a> 191       vars = m_execContext.<a href="../S/4946.html#L467" title="Defined at 467 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">getVarStack</a>();
<a id="L192" name="L192"></a> 192 
<a id="L193" name="L193"></a> 193       <em class="comment">// These three statements need to be combined into one operation.</em>
<a id="L194" name="L194"></a> 194       savedStart = vars.<a href="../S/4856.html#L161" title="Defined at 161 in src/com/sun/org/apache/xpath/internal/VariableStack.java.">getStackFrame</a>();
<a id="L195" name="L195"></a> 195 
<a id="L196" name="L196"></a> 196       vars.<a href="../S/4856.html#L149" title="Defined at 149 in src/com/sun/org/apache/xpath/internal/VariableStack.java.">setStackFrame</a>(m_stackFrame);
<a id="L197" name="L197"></a> 197     <em class="brace">}</em>
<a id="L198" name="L198"></a> 198     <strong class="reserved">else</strong>
<a id="L199" name="L199"></a> 199     <em class="brace">{</em>
<a id="L200" name="L200"></a> 200       <em class="comment">// Yuck.  Just to shut up the compiler!</em>
<a id="L201" name="L201"></a> 201       vars = <strong class="reserved">null</strong>;
<a id="L202" name="L202"></a> 202       savedStart = 0;
<a id="L203" name="L203"></a> 203     <em class="brace">}</em>
<a id="L204" name="L204"></a> 204 
<a id="L205" name="L205"></a> 205     <strong class="reserved">try</strong>
<a id="L206" name="L206"></a> 206     <em class="brace">{</em>
<a id="L207" name="L207"></a> 207       <strong class="reserved">do</strong>
<a id="L208" name="L208"></a> 208       <em class="brace">{</em>
<a id="L209" name="L209"></a> 209         <strong class="reserved">if</strong>(0 == m_extendedTypeID)
<a id="L210" name="L210"></a> 210         <em class="brace">{</em>
<a id="L211" name="L211"></a> 211           <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = m_lastFetched = (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> == m_lastFetched)
<a id="L212" name="L212"></a> 212                        ? m_traverser.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(m_context)
<a id="L213" name="L213"></a> 213                        : m_traverser.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>(m_context, m_lastFetched);
<a id="L214" name="L214"></a> 214         <em class="brace">}</em>
<a id="L215" name="L215"></a> 215         <strong class="reserved">else</strong>
<a id="L216" name="L216"></a> 216         <em class="brace">{</em>
<a id="L217" name="L217"></a> 217           <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = m_lastFetched = (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> == m_lastFetched)
<a id="L218" name="L218"></a> 218                        ? m_traverser.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(m_context, m_extendedTypeID)
<a id="L219" name="L219"></a> 219                        : m_traverser.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>(m_context, m_lastFetched,
<a id="L220" name="L220"></a> 220                                           m_extendedTypeID);
<a id="L221" name="L221"></a> 221         <em class="brace">}</em>
<a id="L222" name="L222"></a> 222 
<a id="L223" name="L223"></a> 223         <strong class="reserved">if</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>)
<a id="L224" name="L224"></a> 224         <em class="brace">{</em>
<a id="L225" name="L225"></a> 225           <strong class="reserved">if</strong>(<a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a>.FILTER_ACCEPT == <a href="../D/10547.html" title="Multiple defined in 10 places.">acceptNode</a>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>))
<a id="L226" name="L226"></a> 226             <strong class="reserved">break</strong>;
<a id="L227" name="L227"></a> 227           <strong class="reserved">else</strong>
<a id="L228" name="L228"></a> 228             <strong class="reserved">continue</strong>;
<a id="L229" name="L229"></a> 229         <em class="brace">}</em>
<a id="L230" name="L230"></a> 230         <strong class="reserved">else</strong>
<a id="L231" name="L231"></a> 231           <strong class="reserved">break</strong>;
<a id="L232" name="L232"></a> 232       <em class="brace">}</em>
<a id="L233" name="L233"></a> 233       <strong class="reserved">while</strong> (<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> != <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L234" name="L234"></a> 234 
<a id="L235" name="L235"></a> 235       <strong class="reserved">if</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>)
<a id="L236" name="L236"></a> 236       <em class="brace">{</em>
<a id="L237" name="L237"></a> 237         m_pos++;
<a id="L238" name="L238"></a> 238         <strong class="reserved">return</strong> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L239" name="L239"></a> 239       <em class="brace">}</em>
<a id="L240" name="L240"></a> 240       <strong class="reserved">else</strong>
<a id="L241" name="L241"></a> 241       <em class="brace">{</em>
<a id="L242" name="L242"></a> 242         m_foundLast = <strong class="reserved">true</strong>;
<a id="L243" name="L243"></a> 243 
<a id="L244" name="L244"></a> 244         <strong class="reserved">return</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L245" name="L245"></a> 245       <em class="brace">}</em>
<a id="L246" name="L246"></a> 246     <em class="brace">}</em>
<a id="L247" name="L247"></a> 247     <strong class="reserved">finally</strong>
<a id="L248" name="L248"></a> 248     <em class="brace">{</em>
<a id="L249" name="L249"></a> 249       <strong class="reserved">if</strong> (-1 != m_stackFrame)
<a id="L250" name="L250"></a> 250       <em class="brace">{</em>
<a id="L251" name="L251"></a> 251         <em class="comment">// These two statements need to be combined into one operation.</em>
<a id="L252" name="L252"></a> 252         vars.<a href="../S/4856.html#L149" title="Defined at 149 in src/com/sun/org/apache/xpath/internal/VariableStack.java.">setStackFrame</a>(savedStart);
<a id="L253" name="L253"></a> 253       <em class="brace">}</em>
<a id="L254" name="L254"></a> 254     <em class="brace">}</em>
<a id="L255" name="L255"></a> 255   <em class="brace">}</em>
<a id="L256" name="L256"></a> 256 
<div class="comment">
    Initialize the context values for this expression
    after it is cloned.
    @param context The XPath runtime context for this
    transformation.</div>
<a id="L264" name="L264"></a> 264   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28067.html" title="Multiple referred from 27 places.">setRoot</a>(<strong class="reserved">int</strong> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/15666.html" title="Multiple defined in 3 places.">environment</a>)
<a id="L265" name="L265"></a> 265   <em class="brace">{</em>
<a id="L266" name="L266"></a> 266     <strong class="reserved">super</strong>.<a href="../D/33763.html" title="Multiple defined in 17 places.">setRoot</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, <a href="../D/15666.html" title="Multiple defined in 3 places.">environment</a>);
<a id="L267" name="L267"></a> 267     m_traverser = m_cdtm.<a href="../D/17166.html" title="Multiple defined in 5 places.">getAxisTraverser</a>(m_axis);
<a id="L268" name="L268"></a> 268 
<a id="L269" name="L269"></a> 269     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a> = <a href="../D/20201.html" title="Multiple defined in 44 places.">getLocalName</a>();
<a id="L270" name="L270"></a> 270     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a> = <a href="../D/20808.html" title="Multiple defined in 28 places.">getNamespace</a>();
<a id="L271" name="L271"></a> 271     <strong class="reserved">int</strong> what = m_whatToShow;
<a id="L272" name="L272"></a> 272     <em class="comment">// System.out.println("what: ");</em>
<a id="L273" name="L273"></a> 273     <em class="comment">// NodeTest.debugWhatToShow(what);</em>
<a id="L274" name="L274"></a> 274     <strong class="reserved">if</strong>(<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ALL == what
<a id="L275" name="L275"></a> 275        || <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.WILD.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a>)
<a id="L276" name="L276"></a> 276        || <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.WILD.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a>))
<a id="L277" name="L277"></a> 277     <em class="brace">{</em>
<a id="L278" name="L278"></a> 278       m_extendedTypeID = 0;
<a id="L279" name="L279"></a> 279     <em class="brace">}</em>
<a id="L280" name="L280"></a> 280     <strong class="reserved">else</strong>
<a id="L281" name="L281"></a> 281     <em class="brace">{</em>
<a id="L282" name="L282"></a> 282       <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../S/4860.html#L361" title="Defined at 361 in src/com/sun/org/apache/xpath/internal/patterns/NodeTest.java.">getNodeTypeTest</a>(what);
<a id="L283" name="L283"></a> 283       m_extendedTypeID = m_cdtm.<a href="../D/18929.html" title="Multiple defined in 16 places.">getExpandedTypeID</a>(<a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a>, <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L284" name="L284"></a> 284     <em class="brace">}</em>
<a id="L285" name="L285"></a> 285 
<a id="L286" name="L286"></a> 286   <em class="brace">}</em>
<a id="L287" name="L287"></a> 287 
<div class="comment">
    Return the first node out of the nodeset, if this expression is
    a nodeset expression.  This is the default implementation for
    nodesets.
    <p>WARNING: Do not mutate this class from this function!</p>
    @param xctxt The XPath runtime context.
    @return the first node out of the nodeset, or DTM.NULL.</div>
<a id="L296" name="L296"></a> 296   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/10344.html" title="Multiple referred from 3 places.">asNode</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L297" name="L297"></a> 297     <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L298" name="L298"></a> 298   <em class="brace">{</em>
<a id="L299" name="L299"></a> 299     <strong class="reserved">if</strong>(<a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>() &gt; 0)
<a id="L300" name="L300"></a> 300       <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/11548.html" title="Multiple defined in 5 places.">asNode</a>(xctxt);
<a id="L301" name="L301"></a> 301 
<a id="L302" name="L302"></a> 302     <strong class="reserved">int</strong> <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a> = xctxt.<a href="../D/18114.html" title="Multiple defined in 11 places.">getCurrentNode</a>();
<a id="L303" name="L303"></a> 303 
<a id="L304" name="L304"></a> 304     <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm = xctxt.<a href="../D/18175.html" title="Multiple defined in 19 places.">getDTM</a>(<a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>);
<a id="L305" name="L305"></a> 305     <a href="../S/5919.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/DTMAxisTraverser.java.">DTMAxisTraverser</a> traverser = dtm.<a href="../D/17166.html" title="Multiple defined in 5 places.">getAxisTraverser</a>(m_axis);
<a id="L306" name="L306"></a> 306 
<a id="L307" name="L307"></a> 307     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a> = <a href="../D/20201.html" title="Multiple defined in 44 places.">getLocalName</a>();
<a id="L308" name="L308"></a> 308     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a> = <a href="../D/20808.html" title="Multiple defined in 28 places.">getNamespace</a>();
<a id="L309" name="L309"></a> 309     <strong class="reserved">int</strong> what = m_whatToShow;
<a id="L310" name="L310"></a> 310 
<a id="L311" name="L311"></a> 311     <em class="comment">// System.out.print(" (DescendantIterator) ");</em>
<a id="L312" name="L312"></a> 312 
<a id="L313" name="L313"></a> 313     <em class="comment">// System.out.println("what: ");</em>
<a id="L314" name="L314"></a> 314     <em class="comment">// NodeTest.debugWhatToShow(what);</em>
<a id="L315" name="L315"></a> 315     <strong class="reserved">if</strong>(<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ALL == what
<a id="L316" name="L316"></a> 316        || <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a> == <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.WILD
<a id="L317" name="L317"></a> 317        || <a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a> == <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.WILD)
<a id="L318" name="L318"></a> 318     <em class="brace">{</em>
<a id="L319" name="L319"></a> 319       <strong class="reserved">return</strong> traverser.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(<a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>);
<a id="L320" name="L320"></a> 320     <em class="brace">}</em>
<a id="L321" name="L321"></a> 321     <strong class="reserved">else</strong>
<a id="L322" name="L322"></a> 322     <em class="brace">{</em>
<a id="L323" name="L323"></a> 323       <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../S/4860.html#L361" title="Defined at 361 in src/com/sun/org/apache/xpath/internal/patterns/NodeTest.java.">getNodeTypeTest</a>(what);
<a id="L324" name="L324"></a> 324       <strong class="reserved">int</strong> extendedType = dtm.<a href="../D/18929.html" title="Multiple defined in 16 places.">getExpandedTypeID</a>(<a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a>, <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L325" name="L325"></a> 325       <strong class="reserved">return</strong> traverser.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(<a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>, extendedType);
<a id="L326" name="L326"></a> 326     <em class="brace">}</em>
<a id="L327" name="L327"></a> 327   <em class="brace">}</em>
<a id="L328" name="L328"></a> 328 
<div class="comment">
     Detaches the iterator from the set which it iterated over, releasing
    any computational resources and placing the iterator in the INVALID
    state. After<code>detach</code> has been invoked, calls to
    <code>nextNode</code> or<code>previousNode</code> will raise the
    exception INVALID_STATE_ERR.</div>
<a id="L336" name="L336"></a> 336   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/13275.html" title="Multiple referred from 37 places.">detach</a>()
<a id="L337" name="L337"></a> 337   <em class="brace">{</em>
<a id="L338" name="L338"></a> 338     <strong class="reserved">if</strong> (m_allowDetach) <em class="brace">{</em>
<a id="L339" name="L339"></a> 339       m_traverser = <strong class="reserved">null</strong>;
<a id="L340" name="L340"></a> 340       m_extendedTypeID = 0;
<a id="L341" name="L341"></a> 341 
<a id="L342" name="L342"></a> 342       <em class="comment">// Always call the superclass detach last!</em>
<a id="L343" name="L343"></a> 343       <strong class="reserved">super</strong>.<a href="../D/14888.html" title="Multiple defined in 26 places.">detach</a>();
<a id="L344" name="L344"></a> 344     <em class="brace">}</em>
<a id="L345" name="L345"></a> 345   <em class="brace">}</em>
<a id="L346" name="L346"></a> 346 
<div class="comment">
    Returns the axis being iterated, if it is known.
    @return Axis.CHILD, etc., or -1 if the axis is not known or is of multiple
    types.</div>
<a id="L353" name="L353"></a> 353   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/15203.html" title="Multiple referred from 33 places.">getAxis</a>()
<a id="L354" name="L354"></a> 354   <em class="brace">{</em>
<a id="L355" name="L355"></a> 355     <strong class="reserved">return</strong> m_axis;
<a id="L356" name="L356"></a> 356   <em class="brace">}</em>
<a id="L357" name="L357"></a> 357 
<a id="L358" name="L358"></a> 358 
<div class="comment">
   /** The traverser to use to navigate over the descendants. */</div>
<a id="L360" name="L360"></a> 360   <strong class="reserved">transient</strong> <strong class="reserved">protected</strong> <a href="../S/5919.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/DTMAxisTraverser.java.">DTMAxisTraverser</a> m_traverser;
<a id="L361" name="L361"></a> 361 
<div class="comment">
   /** The axis that we are traversing. */</div>
<a id="L363" name="L363"></a> 363   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> m_axis;
<a id="L364" name="L364"></a> 364 
<div class="comment">
   /** The extended type ID, not set until setRoot. */</div>
<a id="L366" name="L366"></a> 366   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> m_extendedTypeID;
<a id="L367" name="L367"></a> 367 
<div class="comment">
    @see Expression#deepEquals(Expression)</div>
<a id="L371" name="L371"></a> 371   <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13134.html" title="Multiple referred from 37 places.">deepEquals</a>(<a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>)
<a id="L372" name="L372"></a> 372   <em class="brace">{</em>
<a id="L373" name="L373"></a> 373         <strong class="reserved">if</strong>(!<strong class="reserved">super</strong>.<a href="../D/14718.html" title="Multiple defined in 25 places.">deepEquals</a>(<a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>))
<a id="L374" name="L374"></a> 374                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L375" name="L375"></a> 375 
<a id="L376" name="L376"></a> 376         <strong class="reserved">if</strong>(m_axis != ((<a href="../D/2391.html" title="Multiple defined in 3 places.">DescendantIterator</a>)<a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>).m_axis)
<a id="L377" name="L377"></a> 377                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L378" name="L378"></a> 378 
<a id="L379" name="L379"></a> 379         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L380" name="L380"></a> 380   <em class="brace">}</em>
<a id="L381" name="L381"></a> 381 
<a id="L382" name="L382"></a> 382 
<a id="L383" name="L383"></a> 383 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L152">[^]</a><a href="#L371">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>