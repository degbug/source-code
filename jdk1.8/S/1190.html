<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/util/ServiceLoader.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L217">[^]</a><a href="#L582">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L217" title="Defined at 217.">reload</a></li>
<li><a href="#L229" title="Defined at 229.">fail</a></li>
<li><a href="#L236" title="Defined at 236.">fail</a></li>
<li><a href="#L242" title="Defined at 242.">fail</a></li>
<li><a href="#L251" title="Defined at 251.">parseLine</a></li>
<li><a href="#L297" title="Defined at 297.">parse</a></li>
<li><a href="#L338" title="Defined at 338.">hasNextService</a></li>
<li><a href="#L363" title="Defined at 363.">nextService</a></li>
<li><a href="#L391" title="Defined at 391.">hasNext</a></li>
<li><a href="#L402" title="Defined at 402.">next</a></li>
<li><a href="#L413" title="Defined at 413.">remove</a></li>
<li><a href="#L465" title="Defined at 465.">iterator</a></li>
<li><a href="#L507" title="Defined at 507.">load</a></li>
<li><a href="#L536" title="Defined at 536.">load</a></li>
<li><a href="#L567" title="Defined at 567.">loadInstalled</a></li>
<li><a href="#L582" title="Defined at 582.">toString</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2005, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.BufferedReader;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.io.IOException;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.io.InputStream;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.io.InputStreamReader;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> java.net.URL;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> java.security.AccessController;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> java.security.AccessControlContext;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> java.security.PrivilegedAction;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> java.util.ArrayList;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> java.util.Enumeration;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> java.util.Iterator;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> java.util.List;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.util.NoSuchElementException;
<a id="L41" name="L41"></a>  41 
<a id="L42" name="L42"></a>  42 
<div class="comment">
  A simple service-provider loading facility.
  <p> A <i>service</i> is a well-known set of interfaces and (usually
  abstract) classes.  A <i>service provider</i> is a specific implementation
  of a service.  The classes in a provider typically implement the interfaces
  and subclass the classes defined in the service itself.  Service providers
  can be installed in an implementation of the Java platform in the form of
  extensions, that is, jar files placed into any of the usual extension
  directories.  Providers can also be made available by adding them to the
  application's class path or by some other platform-specific means.
  </p><p> For the purpose of loading, a service is represented by a single type,
  that is, a single interface or abstract class.  (A concrete class can be
  used, but this is not recommended.)  A provider of a given service contains
  one or more concrete classes that extend this <i>service type</i> with data
  and code specific to the provider.  The <i>provider class</i> is typically
  not the entire provider itself but rather a proxy which contains enough
  information to decide whether the provider is able to satisfy a particular
  request together with code that can create the actual provider on demand.
  The details of provider classes tend to be highly service-specific; no
  single class or interface could possibly unify them, so no such type is
  defined here.  The only requirement enforced by this facility is that
  provider classes must have a zero-argument constructor so that they can be
  instantiated during loading.
  </p><p><a name="format"> A service provider is identified by placing a
  <i>provider-configuration file</i> in the resource directory
  <tt>META-INF/services</tt>.</a>  The file's name is the fully-qualified <a href="../lang/ClassLoader.html#name">binary name</a> of the service's type.
  The file contains a list of fully-qualified binary names of concrete
  provider classes, one per line.  Space and tab characters surrounding each
  name, as well as blank lines, are ignored.  The comment character is
  <tt>'#'</tt> (<tt>'\u0023'</tt>,
  <font style="font-size:smaller;">NUMBER SIGN</font>); on
  each line all characters following the first comment character are ignored.
  The file must be encoded in UTF-8.
  </p><p> If a particular concrete provider class is named in more than one
  configuration file, or is named in the same configuration file more than
  once, then the duplicates are ignored.  The configuration file naming a
  particular provider need not be in the same jar file or other distribution
  unit as the provider itself.  The provider must be accessible from the same
  class loader that was initially queried to locate the configuration file;
  note that this is not necessarily the class loader from which the file was
  actually loaded.
  </p><p> Providers are located and instantiated lazily, that is, on demand.  A
  service loader maintains a cache of the providers that have been loaded so
  far.  Each invocation of the {@link #iterator iterator} method returns an
  iterator that first yields all of the elements of the cache, in
  instantiation order, and then lazily locates and instantiates any remaining
  providers, adding each one to the cache in turn.  The cache can be cleared
  via the {@link #reload reload} method.
  </p><p> Service loaders always execute in the security context of the caller.
  Trusted system code should typically invoke the methods in this class, and
  the methods of the iterators which they return, from within a privileged
  security context.
  </p><p> Instances of this class are not safe for use by multiple concurrent
  threads.
  </p><p> Unless otherwise specified, passing a <tt>null</tt> argument to any
  method in this class will cause a {@link NullPointerException} to be thrown.
  </p><p><span style="font-weight: bold; padding-right: 1em">Example</span>
  Suppose we have a service type <tt>com.example.CodecSet</tt> which is
  intended to represent sets of encoder/decoder pairs for some protocol.  In
  this case it is an abstract class with two abstract methods:
  </p><blockquote><pre>  public abstract Encoder getEncoder(String encodingName);
  public abstract Decoder getDecoder(String encodingName);</pre></blockquote>
  Each method returns an appropriate object or <tt>null</tt> if the provider
  does not support the given encoding.  Typical providers support more than
  one encoding.
  <p> If <tt>com.example.impl.StandardCodecs</tt> is an implementation of the
  <tt>CodecSet</tt> service then its jar file also contains a file named
  </p><blockquote><pre>  META-INF/services/com.example.CodecSet</pre></blockquote>
  <p> This file contains the single line:
  </p><blockquote><pre>  com.example.impl.StandardCodecs    # Standard codecs</pre></blockquote>
  <p> The <tt>CodecSet</tt> class creates and saves a single service instance
  at initialization:
  </p><blockquote><pre>  private static ServiceLoader&lt;CodecSet&gt; codecSetLoader
      = ServiceLoader.load(CodecSet.class);</pre></blockquote>
  <p> To locate an encoder for a given encoding name it defines a static
  factory method which iterates through the known and available providers,
  returning only when it has located a suitable encoder or has run out of
  providers.
  </p><blockquote><pre>  public static Encoder getEncoder(String encodingName) {
      for (CodecSet cp : codecSetLoader) {
          Encoder enc = cp.getEncoder(encodingName);
          if (enc != null)
              return enc;
      }
      return null;
  }</pre></blockquote>
  <p> A <tt>getDecoder</tt> method is defined similarly.
  </p><p><span style="font-weight: bold; padding-right: 1em">Usage Note</span> If
  the class path of a class loader that is used for provider loading includes
  remote network URLs then those URLs will be dereferenced in the process of
  searching for provider-configuration files.
  </p><p> This activity is normal, although it may cause puzzling entries to be
  created in web-server logs.  If a web server is not configured correctly,
  however, then this activity may cause the provider-loading algorithm to fail
  spuriously.
  </p><p> A web server should return an HTTP 404 (Not Found) response when a
  requested resource does not exist.  Sometimes, however, web servers are
  erroneously configured to return an HTTP 200 (OK) response along with a
  helpful HTML error page in such cases.  This will cause a {@link
  ServiceConfigurationError} to be thrown when this class attempts to parse
  the HTML page as a provider-configuration file.  The best solution to this
  problem is to fix the misconfigured web server to return the correct
  response code (HTTP 404) along with the HTML error page.
  @param  <s>
          The type of the service to be loaded by this loader
  @author Mark Reinhold
  @since 1.6</s></p></div>
<a id="L184" name="L184"></a> 184 
<a id="L185" name="L185"></a> 185 <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/7154.html" title="Multiple referred from 79 places.">ServiceLoader</a>&lt;S&gt;
<a id="L186" name="L186"></a> 186     <strong class="reserved">implements</strong> <a href="../S/1577.html#L45" title="Defined at 45 in src/java/lang/Iterable.java.">Iterable</a>&lt;S&gt;
<a id="L187" name="L187"></a> 187 <em class="brace">{</em>
<a id="L188" name="L188"></a> 188 
<a id="L189" name="L189"></a> 189     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> PREFIX = "META-INF/services/";
<a id="L190" name="L190"></a> 190 
<a id="L191" name="L191"></a> 191     <em class="comment">// The class or interface representing the service being loaded</em>
<a id="L192" name="L192"></a> 192     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;S&gt; service;
<a id="L193" name="L193"></a> 193 
<a id="L194" name="L194"></a> 194     <em class="comment">// The class loader used to locate, load, and instantiate providers</em>
<a id="L195" name="L195"></a> 195     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> loader;
<a id="L196" name="L196"></a> 196 
<a id="L197" name="L197"></a> 197     <em class="comment">// The access control context taken when the ServiceLoader is created</em>
<a id="L198" name="L198"></a> 198     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> acc;
<a id="L199" name="L199"></a> 199 
<a id="L200" name="L200"></a> 200     <em class="comment">// Cached providers, in instantiation order</em>
<a id="L201" name="L201"></a> 201     <strong class="reserved">private</strong> <a href="../S/860.html#L163" title="Defined at 163 in src/java/util/LinkedHashMap.java.">LinkedHashMap</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>,S&gt; <a href="../S/2005.html#L337" title="Defined at 337 in src/java/nio/charset/Charset.java.">providers</a> = <strong class="reserved">new</strong> <a href="../S/860.html#L163" title="Defined at 163 in src/java/util/LinkedHashMap.java.">LinkedHashMap</a>&lt;&gt;();
<a id="L202" name="L202"></a> 202 
<a id="L203" name="L203"></a> 203     <em class="comment">// The current lazy-lookup iterator</em>
<a id="L204" name="L204"></a> 204     <strong class="reserved">private</strong> <a href="../S/1190.html#L323" title="Defined at 323 in src/java/util/ServiceLoader.java.">LazyIterator</a> lookupIterator;
<a id="L205" name="L205"></a> 205 
<div class="comment">
      Clear this loader's provider cache so that all providers will be
      reloaded.
      <p> After invoking this method, subsequent invocations of the {@link
      #iterator() iterator} method will lazily look up and instantiate
      providers from scratch, just as is done by a newly-created loader.
      </p><p> This method is intended for use in situations in which new providers
      can be installed into a running Java virtual machine.</p></div>
<a id="L217" name="L217"></a> 217     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25871.html" title="Multiple referred from 6 places.">reload</a>() <em class="brace">{</em>
<a id="L218" name="L218"></a> 218         <a href="../S/2005.html#L337" title="Defined at 337 in src/java/nio/charset/Charset.java.">providers</a>.<a href="../D/12817.html" title="Multiple defined in 199 places.">clear</a>();
<a id="L219" name="L219"></a> 219         lookupIterator = <strong class="reserved">new</strong> <a href="../S/1190.html#L323" title="Defined at 323 in src/java/util/ServiceLoader.java.">LazyIterator</a>(service, loader);
<a id="L220" name="L220"></a> 220     <em class="brace">}</em>
<a id="L221" name="L221"></a> 221 
<a id="L222" name="L222"></a> 222     <strong class="reserved">private</strong> ServiceLoader(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;S&gt; svc, <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> cl) <em class="brace">{</em>
<a id="L223" name="L223"></a> 223         service = <a href="../S/859.html#L38" title="Defined at 38 in src/java/util/Objects.java.">Objects</a>.<a href="../D/31141.html" title="Multiple defined in 4 places.">requireNonNull</a>(svc, "Service interface cannot be null");
<a id="L224" name="L224"></a> 224         loader = (cl == <strong class="reserved">null</strong>) ? <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a>.<a href="../D/22895.html" title="Multiple defined in 7 places.">getSystemClassLoader</a>() : cl;
<a id="L225" name="L225"></a> 225         acc = (<a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>() != <strong class="reserved">null</strong>) ? <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/17976.html" title="Multiple defined in 99 places.">getContext</a>() : <strong class="reserved">null</strong>;
<a id="L226" name="L226"></a> 226         <a href="../D/30663.html" title="Multiple defined in 3 places.">reload</a>();
<a id="L227" name="L227"></a> 227     <em class="brace">}</em>
<a id="L228" name="L228"></a> 228 
<a id="L229" name="L229"></a> 229     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/14235.html" title="Multiple referred from 75 places.">fail</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; service, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, <a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a> cause)
<a id="L230" name="L230"></a> 230         <strong class="reserved">throws</strong> <a href="../S/1155.html#L59" title="Defined at 59 in src/java/util/ServiceConfigurationError.java.">ServiceConfigurationError</a>
<a id="L231" name="L231"></a> 231     <em class="brace">{</em>
<a id="L232" name="L232"></a> 232         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1155.html#L59" title="Defined at 59 in src/java/util/ServiceConfigurationError.java.">ServiceConfigurationError</a>(service.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>() + ": " + <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>,
<a id="L233" name="L233"></a> 233                                             cause);
<a id="L234" name="L234"></a> 234     <em class="brace">}</em>
<a id="L235" name="L235"></a> 235 
<a id="L236" name="L236"></a> 236     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/14235.html" title="Multiple referred from 75 places.">fail</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; service, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>)
<a id="L237" name="L237"></a> 237         <strong class="reserved">throws</strong> <a href="../S/1155.html#L59" title="Defined at 59 in src/java/util/ServiceConfigurationError.java.">ServiceConfigurationError</a>
<a id="L238" name="L238"></a> 238     <em class="brace">{</em>
<a id="L239" name="L239"></a> 239         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1155.html#L59" title="Defined at 59 in src/java/util/ServiceConfigurationError.java.">ServiceConfigurationError</a>(service.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>() + ": " + <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>);
<a id="L240" name="L240"></a> 240     <em class="brace">}</em>
<a id="L241" name="L241"></a> 241 
<a id="L242" name="L242"></a> 242     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/14235.html" title="Multiple referred from 75 places.">fail</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; service, <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>, <strong class="reserved">int</strong> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>)
<a id="L243" name="L243"></a> 243         <strong class="reserved">throws</strong> <a href="../S/1155.html#L59" title="Defined at 59 in src/java/util/ServiceConfigurationError.java.">ServiceConfigurationError</a>
<a id="L244" name="L244"></a> 244     <em class="brace">{</em>
<a id="L245" name="L245"></a> 245         <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service, <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a> + ":" + <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> + ": " + <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>);
<a id="L246" name="L246"></a> 246     <em class="brace">}</em>
<a id="L247" name="L247"></a> 247 
<a id="L248" name="L248"></a> 248     <em class="comment">// Parse a single line from the given configuration file, adding the name</em>
<a id="L249" name="L249"></a> 249     <em class="comment">// on the line to the names list.</em>
<a id="L250" name="L250"></a> 250     <em class="comment">//</em>
<a id="L251" name="L251"></a> 251     <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../S/1190.html#L307" title="Referred from 307 in src/java/util/ServiceLoader.java.">parseLine</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; service, <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>, <a href="../S/1395.html#L70" title="Defined at 70 in src/java/io/BufferedReader.java.">BufferedReader</a> r, <strong class="reserved">int</strong> lc,
<a id="L252" name="L252"></a> 252                           <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; names)
<a id="L253" name="L253"></a> 253         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/1155.html#L59" title="Defined at 59 in src/java/util/ServiceConfigurationError.java.">ServiceConfigurationError</a>
<a id="L254" name="L254"></a> 254     <em class="brace">{</em>
<a id="L255" name="L255"></a> 255         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> ln = r.<a href="../D/30213.html" title="Multiple defined in 17 places.">readLine</a>();
<a id="L256" name="L256"></a> 256         <strong class="reserved">if</strong> (ln == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L257" name="L257"></a> 257             <strong class="reserved">return</strong> -1;
<a id="L258" name="L258"></a> 258         <em class="brace">}</em>
<a id="L259" name="L259"></a> 259         <strong class="reserved">int</strong> ci = ln.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('#');
<a id="L260" name="L260"></a> 260         <strong class="reserved">if</strong> (ci &gt;= 0) ln = ln.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, ci);
<a id="L261" name="L261"></a> 261         ln = ln.<a href="../D/35698.html" title="Multiple defined in 9 places.">trim</a>();
<a id="L262" name="L262"></a> 262         <strong class="reserved">int</strong> n = ln.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L263" name="L263"></a> 263         <strong class="reserved">if</strong> (n != 0) <em class="brace">{</em>
<a id="L264" name="L264"></a> 264             <strong class="reserved">if</strong> ((ln.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(' ') &gt;= 0) || (ln.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('\t') &gt;= 0))
<a id="L265" name="L265"></a> 265                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service, <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>, lc, "Illegal configuration-file syntax");
<a id="L266" name="L266"></a> 266             <strong class="reserved">int</strong> cp = ln.<a href="../D/12960.html" title="Multiple defined in 6 places.">codePointAt</a>(0);
<a id="L267" name="L267"></a> 267             <strong class="reserved">if</strong> (!<a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25754.html" title="Multiple defined in 10 places.">isJavaIdentifierStart</a>(cp))
<a id="L268" name="L268"></a> 268                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service, <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>, lc, "Illegal provider-class name: " + ln);
<a id="L269" name="L269"></a> 269             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../S/1732.html#L4817" title="Defined at 4817 in src/java/lang/Character.java.">charCount</a>(cp); i &lt; n; i += <a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../S/1732.html#L4817" title="Defined at 4817 in src/java/lang/Character.java.">charCount</a>(cp)) <em class="brace">{</em>
<a id="L270" name="L270"></a> 270                 cp = ln.<a href="../D/12960.html" title="Multiple defined in 6 places.">codePointAt</a>(i);
<a id="L271" name="L271"></a> 271                 <strong class="reserved">if</strong> (!<a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25753.html" title="Multiple defined in 11 places.">isJavaIdentifierPart</a>(cp) &amp;&amp; (cp != '.'))
<a id="L272" name="L272"></a> 272                     <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service, <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>, lc, "Illegal provider-class name: " + ln);
<a id="L273" name="L273"></a> 273             <em class="brace">}</em>
<a id="L274" name="L274"></a> 274             <strong class="reserved">if</strong> (!<a href="../S/2005.html#L337" title="Defined at 337 in src/java/nio/charset/Charset.java.">providers</a>.<a href="../D/13333.html" title="Multiple defined in 42 places.">containsKey</a>(ln) &amp;&amp; !names.<a href="../D/13313.html" title="Multiple defined in 245 places.">contains</a>(ln))
<a id="L275" name="L275"></a> 275                 names.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(ln);
<a id="L276" name="L276"></a> 276         <em class="brace">}</em>
<a id="L277" name="L277"></a> 277         <strong class="reserved">return</strong> lc + 1;
<a id="L278" name="L278"></a> 278     <em class="brace">}</em>
<a id="L279" name="L279"></a> 279 
<a id="L280" name="L280"></a> 280     <em class="comment">// Parse the content of the given URL as a provider-configuration file.</em>
<a id="L281" name="L281"></a> 281     <em class="comment">//</em>
<a id="L282" name="L282"></a> 282     <em class="comment">// @param  service</em>
<a id="L283" name="L283"></a> 283     <em class="comment">//         The service type for which providers are being sought;</em>
<a id="L284" name="L284"></a> 284     <em class="comment">//         used to construct error detail strings</em>
<a id="L285" name="L285"></a> 285     <em class="comment">//</em>
<a id="L286" name="L286"></a> 286     <em class="comment">// @param  u</em>
<a id="L287" name="L287"></a> 287     <em class="comment">//         The URL naming the configuration file to be parsed</em>
<a id="L288" name="L288"></a> 288     <em class="comment">//</em>
<a id="L289" name="L289"></a> 289     <em class="comment">// @return A (possibly empty) iterator that will yield the provider-class</em>
<a id="L290" name="L290"></a> 290     <em class="comment">//         names in the given configuration file that are not yet members</em>
<a id="L291" name="L291"></a> 291     <em class="comment">//         of the returned set</em>
<a id="L292" name="L292"></a> 292     <em class="comment">//</em>
<a id="L293" name="L293"></a> 293     <em class="comment">// @throws ServiceConfigurationError</em>
<a id="L294" name="L294"></a> 294     <em class="comment">//         If an I/O error occurs while reading from the given URL, or</em>
<a id="L295" name="L295"></a> 295     <em class="comment">//         if a configuration-file format error is detected</em>
<a id="L296" name="L296"></a> 296     <em class="comment">//</em>
<a id="L297" name="L297"></a> 297     <strong class="reserved">private</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; <a href="../R/24493.html" title="Multiple referred from 256 places.">parse</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; service, <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>)
<a id="L298" name="L298"></a> 298         <strong class="reserved">throws</strong> <a href="../S/1155.html#L59" title="Defined at 59 in src/java/util/ServiceConfigurationError.java.">ServiceConfigurationError</a>
<a id="L299" name="L299"></a> 299     <em class="brace">{</em>
<a id="L300" name="L300"></a> 300         <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> = <strong class="reserved">null</strong>;
<a id="L301" name="L301"></a> 301         <a href="../S/1395.html#L70" title="Defined at 70 in src/java/io/BufferedReader.java.">BufferedReader</a> r = <strong class="reserved">null</strong>;
<a id="L302" name="L302"></a> 302         <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; names = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;&gt;();
<a id="L303" name="L303"></a> 303         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L304" name="L304"></a> 304             <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> = <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.<a href="../S/768.html#L1037" title="Defined at 1037 in src/java/net/URL.java.">openStream</a>();
<a id="L305" name="L305"></a> 305             r = <strong class="reserved">new</strong> <a href="../S/1395.html#L70" title="Defined at 70 in src/java/io/BufferedReader.java.">BufferedReader</a>(<strong class="reserved">new</strong> <a href="../S/1416.html#L62" title="Defined at 62 in src/java/io/InputStreamReader.java.">InputStreamReader</a>(<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>, "utf-8"));
<a id="L306" name="L306"></a> 306             <strong class="reserved">int</strong> lc = 1;
<a id="L307" name="L307"></a> 307             <strong class="reserved">while</strong> ((lc = <a href="../S/1190.html#L251" title="Defined at 251 in src/java/util/ServiceLoader.java.">parseLine</a>(service, <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>, r, lc, names)) &gt;= 0);
<a id="L308" name="L308"></a> 308         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L309" name="L309"></a> 309             <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service, "Error reading configuration file", <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L310" name="L310"></a> 310         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L311" name="L311"></a> 311             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L312" name="L312"></a> 312                 <strong class="reserved">if</strong> (r != <strong class="reserved">null</strong>) r.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L313" name="L313"></a> 313                 <strong class="reserved">if</strong> (<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> != <strong class="reserved">null</strong>) <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L314" name="L314"></a> 314             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> y) <em class="brace">{</em>
<a id="L315" name="L315"></a> 315                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service, "Error closing configuration file", y);
<a id="L316" name="L316"></a> 316             <em class="brace">}</em>
<a id="L317" name="L317"></a> 317         <em class="brace">}</em>
<a id="L318" name="L318"></a> 318         <strong class="reserved">return</strong> names.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L319" name="L319"></a> 319     <em class="brace">}</em>
<a id="L320" name="L320"></a> 320 
<a id="L321" name="L321"></a> 321     <em class="comment">// Private inner class implementing fully-lazy provider lookup</em>
<a id="L322" name="L322"></a> 322     <em class="comment">//</em>
<a id="L323" name="L323"></a> 323     <strong class="reserved">private</strong> <strong class="reserved">class</strong> <a href="../R/4541.html" title="Multiple referred from 2 places.">LazyIterator</a>
<a id="L324" name="L324"></a> 324         <strong class="reserved">implements</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;S&gt;
<a id="L325" name="L325"></a> 325     <em class="brace">{</em>
<a id="L326" name="L326"></a> 326 
<a id="L327" name="L327"></a> 327         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;S&gt; service;
<a id="L328" name="L328"></a> 328         <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> loader;
<a id="L329" name="L329"></a> 329         <a href="../S/1134.html#L61" title="Defined at 61 in src/java/util/Enumeration.java.">Enumeration</a>&lt;<a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a>&gt; configs = <strong class="reserved">null</strong>;
<a id="L330" name="L330"></a> 330         <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; pending = <strong class="reserved">null</strong>;
<a id="L331" name="L331"></a> 331         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> nextName = <strong class="reserved">null</strong>;
<a id="L332" name="L332"></a> 332 
<a id="L333" name="L333"></a> 333         <strong class="reserved">private</strong> LazyIterator(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;S&gt; service, <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> loader) <em class="brace">{</em>
<a id="L334" name="L334"></a> 334             <strong class="reserved">this</strong>.service = service;
<a id="L335" name="L335"></a> 335             <strong class="reserved">this</strong>.loader = loader;
<a id="L336" name="L336"></a> 336         <em class="brace">}</em>
<a id="L337" name="L337"></a> 337 
<a id="L338" name="L338"></a> 338         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/20239.html" title="Multiple referred from 3 places.">hasNextService</a>() <em class="brace">{</em>
<a id="L339" name="L339"></a> 339             <strong class="reserved">if</strong> (nextName != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L340" name="L340"></a> 340                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L341" name="L341"></a> 341             <em class="brace">}</em>
<a id="L342" name="L342"></a> 342             <strong class="reserved">if</strong> (configs == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L343" name="L343"></a> 343                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L344" name="L344"></a> 344                     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1252.html#L381" title="Defined at 381 in src/java/security/Identity.java.">fullName</a> = PREFIX + service.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L345" name="L345"></a> 345                     <strong class="reserved">if</strong> (loader == <strong class="reserved">null</strong>)
<a id="L346" name="L346"></a> 346                         configs = <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a>.<a href="../S/1745.html#L1246" title="Defined at 1246 in src/java/lang/ClassLoader.java.">getSystemResources</a>(<a href="../S/1252.html#L381" title="Defined at 381 in src/java/security/Identity.java.">fullName</a>);
<a id="L347" name="L347"></a> 347                     <strong class="reserved">else</strong>
<a id="L348" name="L348"></a> 348                         configs = loader.<a href="../D/22052.html" title="Multiple defined in 11 places.">getResources</a>(<a href="../S/1252.html#L381" title="Defined at 381 in src/java/security/Identity.java.">fullName</a>);
<a id="L349" name="L349"></a> 349                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L350" name="L350"></a> 350                     <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service, "Error locating configuration files", <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L351" name="L351"></a> 351                 <em class="brace">}</em>
<a id="L352" name="L352"></a> 352             <em class="brace">}</em>
<a id="L353" name="L353"></a> 353             <strong class="reserved">while</strong> ((pending == <strong class="reserved">null</strong>) || !pending.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L354" name="L354"></a> 354                 <strong class="reserved">if</strong> (!configs.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>()) <em class="brace">{</em>
<a id="L355" name="L355"></a> 355                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L356" name="L356"></a> 356                 <em class="brace">}</em>
<a id="L357" name="L357"></a> 357                 pending = <a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(service, configs.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>());
<a id="L358" name="L358"></a> 358             <em class="brace">}</em>
<a id="L359" name="L359"></a> 359             nextName = pending.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L360" name="L360"></a> 360             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L361" name="L361"></a> 361         <em class="brace">}</em>
<a id="L362" name="L362"></a> 362 
<a id="L363" name="L363"></a> 363         <strong class="reserved">private</strong> S <a href="../R/23691.html" title="Multiple referred from 2 places.">nextService</a>() <em class="brace">{</em>
<a id="L364" name="L364"></a> 364             <strong class="reserved">if</strong> (!<a href="../S/1190.html#L338" title="Defined at 338 in src/java/util/ServiceLoader.java.">hasNextService</a>())
<a id="L365" name="L365"></a> 365                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1128.html#L38" title="Defined at 38 in src/java/util/NoSuchElementException.java.">NoSuchElementException</a>();
<a id="L366" name="L366"></a> 366             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> cn = nextName;
<a id="L367" name="L367"></a> 367             nextName = <strong class="reserved">null</strong>;
<a id="L368" name="L368"></a> 368             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <strong class="reserved">null</strong>;
<a id="L369" name="L369"></a> 369             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L370" name="L370"></a> 370                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>.<a href="../D/16518.html" title="Multiple defined in 6 places.">forName</a>(cn, <strong class="reserved">false</strong>, loader);
<a id="L371" name="L371"></a> 371             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L372" name="L372"></a> 372                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service,
<a id="L373" name="L373"></a> 373                      "Provider " + cn + " not found");
<a id="L374" name="L374"></a> 374             <em class="brace">}</em>
<a id="L375" name="L375"></a> 375             <strong class="reserved">if</strong> (!service.<a href="../D/25213.html" title="Multiple defined in 7 places.">isAssignableFrom</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)) <em class="brace">{</em>
<a id="L376" name="L376"></a> 376                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service,
<a id="L377" name="L377"></a> 377                      "Provider " + cn  + " not a subtype");
<a id="L378" name="L378"></a> 378             <em class="brace">}</em>
<a id="L379" name="L379"></a> 379             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L380" name="L380"></a> 380                 S p = service.<a href="../D/12274.html" title="Multiple defined in 6 places.">cast</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>.<a href="../D/28016.html" title="Multiple defined in 74 places.">newInstance</a>());
<a id="L381" name="L381"></a> 381                 <a href="../S/2005.html#L337" title="Defined at 337 in src/java/nio/charset/Charset.java.">providers</a>.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(cn, p);
<a id="L382" name="L382"></a> 382                 <strong class="reserved">return</strong> p;
<a id="L383" name="L383"></a> 383             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L384" name="L384"></a> 384                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>(service,
<a id="L385" name="L385"></a> 385                      "Provider " + cn + " could not be instantiated",
<a id="L386" name="L386"></a> 386                      <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L387" name="L387"></a> 387             <em class="brace">}</em>
<a id="L388" name="L388"></a> 388             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>();          <em class="comment">// This cannot happen</em>
<a id="L389" name="L389"></a> 389         <em class="brace">}</em>
<a id="L390" name="L390"></a> 390 
<a id="L391" name="L391"></a> 391         <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/20233.html" title="Multiple referred from 653 places.">hasNext</a>() <em class="brace">{</em>
<a id="L392" name="L392"></a> 392             <strong class="reserved">if</strong> (acc == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L393" name="L393"></a> 393                 <strong class="reserved">return</strong> <a href="../S/1190.html#L338" title="Defined at 338 in src/java/util/ServiceLoader.java.">hasNextService</a>();
<a id="L394" name="L394"></a> 394             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L395" name="L395"></a> 395                 <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../S/1770.html#L43" title="Defined at 43 in src/java/lang/Boolean.java.">Boolean</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a> = <strong class="reserved">new</strong> <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../S/1770.html#L43" title="Defined at 43 in src/java/lang/Boolean.java.">Boolean</a>&gt;() <em class="brace">{</em>
<a id="L396" name="L396"></a> 396                     <strong class="reserved">public</strong> <a href="../S/1770.html#L43" title="Defined at 43 in src/java/lang/Boolean.java.">Boolean</a> <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>() <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../S/1190.html#L338" title="Defined at 338 in src/java/util/ServiceLoader.java.">hasNextService</a>(); <em class="brace">}</em>
<a id="L397" name="L397"></a> 397                 <em class="brace">}</em>;
<a id="L398" name="L398"></a> 398                 <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>, acc);
<a id="L399" name="L399"></a> 399             <em class="brace">}</em>
<a id="L400" name="L400"></a> 400         <em class="brace">}</em>
<a id="L401" name="L401"></a> 401 
<a id="L402" name="L402"></a> 402         <strong class="reserved">public</strong> S <a href="../R/23650.html" title="Multiple referred from 3301 places.">next</a>() <em class="brace">{</em>
<a id="L403" name="L403"></a> 403             <strong class="reserved">if</strong> (acc == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L404" name="L404"></a> 404                 <strong class="reserved">return</strong> <a href="../S/1190.html#L363" title="Defined at 363 in src/java/util/ServiceLoader.java.">nextService</a>();
<a id="L405" name="L405"></a> 405             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L406" name="L406"></a> 406                 <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;S&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a> = <strong class="reserved">new</strong> <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;S&gt;() <em class="brace">{</em>
<a id="L407" name="L407"></a> 407                     <strong class="reserved">public</strong> S <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>() <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../S/1190.html#L363" title="Defined at 363 in src/java/util/ServiceLoader.java.">nextService</a>(); <em class="brace">}</em>
<a id="L408" name="L408"></a> 408                 <em class="brace">}</em>;
<a id="L409" name="L409"></a> 409                 <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>, acc);
<a id="L410" name="L410"></a> 410             <em class="brace">}</em>
<a id="L411" name="L411"></a> 411         <em class="brace">}</em>
<a id="L412" name="L412"></a> 412 
<a id="L413" name="L413"></a> 413         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25882.html" title="Multiple referred from 1115 places.">remove</a>() <em class="brace">{</em>
<a id="L414" name="L414"></a> 414             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1777.html#L38" title="Defined at 38 in src/java/lang/UnsupportedOperationException.java.">UnsupportedOperationException</a>();
<a id="L415" name="L415"></a> 415         <em class="brace">}</em>
<a id="L416" name="L416"></a> 416 
<a id="L417" name="L417"></a> 417     <em class="brace">}</em>
<a id="L418" name="L418"></a> 418 
<div class="comment">
      Lazily loads the available providers of this loader's service.
      <p> The iterator returned by this method first yields all of the
      elements of the provider cache, in instantiation order.  It then lazily
      loads and instantiates any remaining providers, adding each one to the
      cache in turn.
      </p><p> To achieve laziness the actual work of parsing the available
      provider-configuration files and instantiating providers must be done by
      the iterator itself.  Its {@link java.util.Iterator#hasNext hasNext} and
      {@link java.util.Iterator#next next} methods can therefore throw a
      {@link ServiceConfigurationError} if a provider-configuration file
      violates the specified format, or if it names a provider class that
      cannot be found and instantiated, or if the result of instantiating the
      class is not assignable to the service type, or if any other kind of
      exception or error is thrown as the next provider is located and
      instantiated.  To write robust code it is only necessary to catch {@link
      ServiceConfigurationError} when using a service iterator.
      </p><p> If such an error is thrown then subsequent invocations of the
      iterator will make a best effort to locate and instantiate the next
      available provider, but in general such recovery cannot be guaranteed.
      </p><blockquote style="font-size: smaller; line-height: 1.2"><span style="padding-right: 1em; font-weight: bold">Design Note</span>
      Throwing an error in these cases may seem extreme.  The rationale for
      this behavior is that a malformed provider-configuration file, like a
      malformed class file, indicates a serious problem with the way the Java
      virtual machine is configured or is being used.  As such it is
      preferable to throw an error rather than try to recover or, even worse,
      fail silently.</blockquote>
      <p> The iterator returned by this method does not support removal.
      Invoking its {@link java.util.Iterator#remove() remove} method will
      cause an {@link UnsupportedOperationException} to be thrown.
      @implNote When adding providers to the cache, the {@link #iterator
      Iterator} processes resources in the order that the {@link
      java.lang.ClassLoader#getResources(java.lang.String)
      ClassLoader.getResources(String)} method finds the service configuration
      files.
      @return  An iterator that lazily loads providers for this loader's
               service</p></div>
<a id="L465" name="L465"></a> 465     <strong class="reserved">public</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;S&gt; <a href="../R/22304.html" title="Multiple referred from 905 places.">iterator</a>() <em class="brace">{</em>
<a id="L466" name="L466"></a> 466         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;S&gt;() <em class="brace">{</em>
<a id="L467" name="L467"></a> 467 
<a id="L468" name="L468"></a> 468             <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;<a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>.<a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>,S&gt;&gt; knownProviders
<a id="L469" name="L469"></a> 469                 = <a href="../S/2005.html#L337" title="Defined at 337 in src/java/nio/charset/Charset.java.">providers</a>.<a href="../D/15653.html" title="Multiple defined in 34 places.">entrySet</a>().<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L470" name="L470"></a> 470 
<a id="L471" name="L471"></a> 471             <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>() <em class="brace">{</em>
<a id="L472" name="L472"></a> 472                 <strong class="reserved">if</strong> (knownProviders.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>())
<a id="L473" name="L473"></a> 473                     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L474" name="L474"></a> 474                 <strong class="reserved">return</strong> lookupIterator.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>();
<a id="L475" name="L475"></a> 475             <em class="brace">}</em>
<a id="L476" name="L476"></a> 476 
<a id="L477" name="L477"></a> 477             <strong class="reserved">public</strong> S <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>() <em class="brace">{</em>
<a id="L478" name="L478"></a> 478                 <strong class="reserved">if</strong> (knownProviders.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>())
<a id="L479" name="L479"></a> 479                     <strong class="reserved">return</strong> knownProviders.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>().<a href="../D/23531.html" title="Multiple defined in 212 places.">getValue</a>();
<a id="L480" name="L480"></a> 480                 <strong class="reserved">return</strong> lookupIterator.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L481" name="L481"></a> 481             <em class="brace">}</em>
<a id="L482" name="L482"></a> 482 
<a id="L483" name="L483"></a> 483             <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>() <em class="brace">{</em>
<a id="L484" name="L484"></a> 484                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1777.html#L38" title="Defined at 38 in src/java/lang/UnsupportedOperationException.java.">UnsupportedOperationException</a>();
<a id="L485" name="L485"></a> 485             <em class="brace">}</em>
<a id="L486" name="L486"></a> 486 
<a id="L487" name="L487"></a> 487         <em class="brace">}</em>;
<a id="L488" name="L488"></a> 488     <em class="brace">}</em>
<a id="L489" name="L489"></a> 489 
<div class="comment">
      Creates a new service loader for the given service type and class
      loader.
      @param  <s> the class of the service type
      @param  service
              The interface or abstract class representing the service
      @param  loader
              The class loader to be used to load provider-configuration files
              and provider classes, or <tt>null</tt> if the system class
              loader (or, failing that, the bootstrap class loader) is to be
              used
      @return A new service loader</s></div>
<a id="L507" name="L507"></a> 507     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;S&gt; <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a>&lt;S&gt; <a href="../R/22543.html" title="Multiple referred from 196 places.">load</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;S&gt; service,
<a id="L508" name="L508"></a> 508                                             <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> loader)
<a id="L509" name="L509"></a> 509     <em class="brace">{</em>
<a id="L510" name="L510"></a> 510         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a>&lt;&gt;(service, loader);
<a id="L511" name="L511"></a> 511     <em class="brace">}</em>
<a id="L512" name="L512"></a> 512 
<div class="comment">
      Creates a new service loader for the given service type, using the
      current thread's {@linkplain java.lang.Thread#getContextClassLoader
      context class loader}.
      <p> An invocation of this convenience method of the form
      </p><blockquote><pre>      ServiceLoader.load(<i>service</i>)</pre></blockquote>
      is equivalent to
      <blockquote><pre>      ServiceLoader.load(<i>service</i>,
                         Thread.currentThread().getContextClassLoader())</pre></blockquote>
      @param  <s> the class of the service type
      @param  service
              The interface or abstract class representing the service
      @return A new service loader</s></div>
<a id="L536" name="L536"></a> 536     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;S&gt; <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a>&lt;S&gt; <a href="../R/22543.html" title="Multiple referred from 196 places.">load</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;S&gt; service) <em class="brace">{</em>
<a id="L537" name="L537"></a> 537         <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> cl = <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L264" title="Defined at 264 in src/java/lang/Thread.java.">currentThread</a>().<a href="../D/17977.html" title="Multiple defined in 21 places.">getContextClassLoader</a>();
<a id="L538" name="L538"></a> 538         <strong class="reserved">return</strong> <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a>.<a href="../D/26888.html" title="Multiple defined in 27 places.">load</a>(service, cl);
<a id="L539" name="L539"></a> 539     <em class="brace">}</em>
<a id="L540" name="L540"></a> 540 
<div class="comment">
      Creates a new service loader for the given service type, using the
      extension class loader.
      <p> This convenience method simply locates the extension class loader,
      call it <tt><i>extClassLoader</i></tt>, and then returns
      </p><blockquote><pre>      ServiceLoader.load(<i>service</i>, <i>extClassLoader</i>)</pre></blockquote>
      <p> If the extension class loader cannot be found then the system class
      loader is used; if there is no system class loader then the bootstrap
      class loader is used.
      </p><p> This method is intended for use when only installed providers are
      desired.  The resulting service will only find and load providers that
      have been installed into the current Java virtual machine; providers on
      the application's class path will be ignored.
      @param  <s> the class of the service type
      @param  service
              The interface or abstract class representing the service
      @return A new service loader</s></p></div>
<a id="L567" name="L567"></a> 567     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;S&gt; <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a>&lt;S&gt; <a href="../R/22587.html" title="Multiple referred from 3 places.">loadInstalled</a>(<a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;S&gt; service) <em class="brace">{</em>
<a id="L568" name="L568"></a> 568         <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> cl = <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a>.<a href="../D/22895.html" title="Multiple defined in 7 places.">getSystemClassLoader</a>();
<a id="L569" name="L569"></a> 569         <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a> prev = <strong class="reserved">null</strong>;
<a id="L570" name="L570"></a> 570         <strong class="reserved">while</strong> (cl != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L571" name="L571"></a> 571             prev = cl;
<a id="L572" name="L572"></a> 572             cl = cl.<a href="../D/21392.html" title="Multiple defined in 42 places.">getParent</a>();
<a id="L573" name="L573"></a> 573         <em class="brace">}</em>
<a id="L574" name="L574"></a> 574         <strong class="reserved">return</strong> <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a>.<a href="../D/26888.html" title="Multiple defined in 27 places.">load</a>(service, prev);
<a id="L575" name="L575"></a> 575     <em class="brace">}</em>
<a id="L576" name="L576"></a> 576 
<div class="comment">
      Returns a string describing this service.
      @return  A descriptive string</div>
<a id="L582" name="L582"></a> 582     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L583" name="L583"></a> 583         <strong class="reserved">return</strong> "java.util.ServiceLoader[" + service.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>() + "]";
<a id="L584" name="L584"></a> 584     <em class="brace">}</em>
<a id="L585" name="L585"></a> 585 
<a id="L586" name="L586"></a> 586 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L217">[^]</a><a href="#L582">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>