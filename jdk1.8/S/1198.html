<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/security/SecureRandom.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L193">[^]</a><a href="#L614">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L193" title="Defined at 193.">getDefaultPRNG</a></li>
<li><a href="#L286" title="Defined at 286.">getInstance</a></li>
<li><a href="#L337" title="Defined at 337.">getInstance</a></li>
<li><a href="#L381" title="Defined at 381.">getInstance</a></li>
<li><a href="#L392" title="Defined at 392.">getSecureRandomSpi</a></li>
<li><a href="#L401" title="Defined at 401.">getProvider</a></li>
<li><a href="#L413" title="Defined at 413.">getAlgorithm</a></li>
<li><a href="#L426" title="Defined at 426.">setSeed</a></li>
<li><a href="#L444" title="Defined at 444.">setSeed</a></li>
<li><a href="#L467" title="Defined at 467.">nextBytes</a></li>
<li><a href="#L486" title="Defined at 486.">next</a></li>
<li><a href="#L516" title="Defined at 516.">getSeed</a></li>
<li><a href="#L532" title="Defined at 532.">generateSeed</a></li>
<li><a href="#L540" title="Defined at 540.">longToByteArray</a></li>
<li><a href="#L557" title="Defined at 557.">getPrngAlgorithm</a></li>
<li><a href="#L614" title="Defined at 614.">getInstanceStrong</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1996, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.util.*;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.util.regex.*;
<a id="L30" name="L30"></a>  30 
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.security.Provider.Service;
<a id="L32" name="L32"></a>  32 
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> sun.security.jca.*;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> sun.security.jca.GetInstance.Instance;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> sun.security.util.Debug;
<a id="L36" name="L36"></a>  36 
<div class="comment">
  This class provides a cryptographically strong random number
  generator (RNG).
  <p>A cryptographically strong random number
  minimally complies with the statistical random number generator tests
  specified in <a href="http://csrc.nist.gov/cryptval/140-2.htm">
  <i>FIPS 140-2, Security Requirements for Cryptographic Modules</i></a>,
  section 4.9.1.
  Additionally, SecureRandom must produce non-deterministic output.
  Therefore any seed material passed to a SecureRandom object must be
  unpredictable, and all SecureRandom output sequences must be
  cryptographically strong, as described in
  <a href="http://www.ietf.org/rfc/rfc1750.txt">
  <i>RFC 1750: Randomness Recommendations for Security</i></a>.
  </p><p>A caller obtains a SecureRandom instance via the
  no-argument constructor or one of the <code>getInstance</code> methods:
  </p><pre>       SecureRandom random = new SecureRandom();
  </pre>
  <p> Many SecureRandom implementations are in the form of a pseudo-random
  number generator (PRNG), which means they use a deterministic algorithm
  to produce a pseudo-random sequence from a true random seed.
  Other implementations may produce true random numbers,
  and yet others may use a combination of both techniques.
  </p><p> Typical callers of SecureRandom invoke the following methods
  to retrieve random bytes:
  </p><pre>       SecureRandom random = new SecureRandom();
       byte bytes[] = new byte[20];
       random.nextBytes(bytes);
  </pre>
  <p> Callers may also invoke the <code>generateSeed</code> method
  to generate a given number of seed bytes (to seed other random number
  generators, for example):
  </p><pre>       byte seed[] = random.generateSeed(20);
  </pre>
  Note: Depending on the implementation, the <code>generateSeed</code> and
  <code>nextBytes</code> methods may block as entropy is being gathered,
  for example, if they need to read from /dev/random on various Unix-like
  operating systems.
  @see java.security.SecureRandomSpi
  @see java.util.Random
  @author Benjamin Renaud
  @author Josh Bloch</div>
<a id="L93" name="L93"></a>  93 
<a id="L94" name="L94"></a>  94 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/6986.html" title="Multiple referred from 65 places.">SecureRandom</a> <strong class="reserved">extends</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util.<a href="../S/1000.html#L77" title="Defined at 77 in src/java/util/Random.java.">Random</a> <em class="brace">{</em>
<a id="L95" name="L95"></a>  95 
<a id="L96" name="L96"></a>  96     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a> pdebug =
<a id="L97" name="L97"></a>  97                         <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>("provider", "Provider");
<a id="L98" name="L98"></a>  98     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> skipDebug =
<a id="L99" name="L99"></a>  99         <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.isOn("engine=") &amp;&amp; !<a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.isOn("securerandom");
<a id="L100" name="L100"></a> 100 
<div class="comment">
      The provider.
      @serial
      @since 1.2</div>
<a id="L107" name="L107"></a> 107     <strong class="reserved">private</strong> <a href="../D/6950.html" title="Multiple defined in 4 places.">Provider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> = <strong class="reserved">null</strong>;
<a id="L108" name="L108"></a> 108 
<div class="comment">
      The provider implementation.
      @serial
      @since 1.2</div>
<a id="L115" name="L115"></a> 115     <strong class="reserved">private</strong> <a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a> secureRandomSpi = <strong class="reserved">null</strong>;
<a id="L116" name="L116"></a> 116 
<div class="comment">
      The algorithm name of null if unknown.
      @serial
      @since 1.5</div>
<a id="L123" name="L123"></a> 123     <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> algorithm;
<a id="L124" name="L124"></a> 124 
<a id="L125" name="L125"></a> 125     <em class="comment">// Seed Generator</em>
<a id="L126" name="L126"></a> 126     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">volatile</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a> seedGenerator = <strong class="reserved">null</strong>;
<a id="L127" name="L127"></a> 127 
<div class="comment">
      Constructs a secure random number generator (RNG) implementing the
      default random number algorithm.
      <p> This constructor traverses the list of registered security Providers,
      starting with the most preferred Provider.
      A new SecureRandom object encapsulating the
      SecureRandomSpi implementation from the first
      Provider that supports a SecureRandom (RNG) algorithm is returned.
      If none of the Providers support a RNG algorithm,
      then an implementation-specific default is returned.
      </p><p> Note that the list of registered providers may be retrieved via
      the {@link Security#getProviders() Security.getProviders()} method.
      </p><p> See the SecureRandom section in the <a href="{@docRoot}/../technotes/guides/security/StandardNames.html#SecureRandom">
      Java Cryptography Architecture Standard Algorithm Name Documentation</a>
      for information about standard RNG algorithm names.
      </p><p> The returned SecureRandom object has not been seeded.  To seed the
      returned object, call the <code>setSeed</code> method.
      If <code>setSeed</code> is not called, the first call to
      <code>nextBytes</code> will force the SecureRandom object to seed itself.
      This self-seeding will not occur if <code>setSeed</code> was
      previously called.</p></div>
<a id="L155" name="L155"></a> 155     <strong class="reserved">public</strong> SecureRandom() <em class="brace">{</em>
<div class="comment">
          This call to our superclass constructor will result in a call
          to our own <code>setSeed</code> method, which will return
          immediately when it is passed zero.</div>
<a id="L161" name="L161"></a> 161         <strong class="reserved">super</strong>(0);
<a id="L162" name="L162"></a> 162         <a href="../S/1198.html#L193" title="Defined at 193 in src/java/security/SecureRandom.java.">getDefaultPRNG</a>(<strong class="reserved">false</strong>, <strong class="reserved">null</strong>);
<a id="L163" name="L163"></a> 163     <em class="brace">}</em>
<a id="L164" name="L164"></a> 164 
<div class="comment">
      Constructs a secure random number generator (RNG) implementing the
      default random number algorithm.
      The SecureRandom instance is seeded with the specified seed bytes.
      <p> This constructor traverses the list of registered security Providers,
      starting with the most preferred Provider.
      A new SecureRandom object encapsulating the
      SecureRandomSpi implementation from the first
      Provider that supports a SecureRandom (RNG) algorithm is returned.
      If none of the Providers support a RNG algorithm,
      then an implementation-specific default is returned.
      </p><p> Note that the list of registered providers may be retrieved via
      the {@link Security#getProviders() Security.getProviders()} method.
      </p><p> See the SecureRandom section in the <a href="{@docRoot}/../technotes/guides/security/StandardNames.html#SecureRandom">
      Java Cryptography Architecture Standard Algorithm Name Documentation</a>
      for information about standard RNG algorithm names.
      @param seed the seed.</p></div>
<a id="L188" name="L188"></a> 188     <strong class="reserved">public</strong> SecureRandom(<strong class="reserved">byte</strong> seed[]) <em class="brace">{</em>
<a id="L189" name="L189"></a> 189         <strong class="reserved">super</strong>(0);
<a id="L190" name="L190"></a> 190         <a href="../S/1198.html#L193" title="Defined at 193 in src/java/security/SecureRandom.java.">getDefaultPRNG</a>(<strong class="reserved">true</strong>, seed);
<a id="L191" name="L191"></a> 191     <em class="brace">}</em>
<a id="L192" name="L192"></a> 192 
<a id="L193" name="L193"></a> 193     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/16054.html" title="Multiple referred from 2 places.">getDefaultPRNG</a>(<strong class="reserved">boolean</strong> <a href="../D/33840.html" title="Multiple defined in 4 places.">setSeed</a>, <strong class="reserved">byte</strong>[] seed) <em class="brace">{</em>
<a id="L194" name="L194"></a> 194         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> prng = <a href="../S/1198.html#L557" title="Defined at 557 in src/java/security/SecureRandom.java.">getPrngAlgorithm</a>();
<a id="L195" name="L195"></a> 195         <strong class="reserved">if</strong> (prng == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L196" name="L196"></a> 196             <em class="comment">// bummer, get the SUN implementation</em>
<a id="L197" name="L197"></a> 197             prng = "SHA1PRNG";
<a id="L198" name="L198"></a> 198             <strong class="reserved">this</strong>.secureRandomSpi = <strong class="reserved">new</strong> sun.security.<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>.<a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>();
<a id="L199" name="L199"></a> 199             <strong class="reserved">this</strong>.<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> = Providers.getSunProvider();
<a id="L200" name="L200"></a> 200             <strong class="reserved">if</strong> (<a href="../D/33840.html" title="Multiple defined in 4 places.">setSeed</a>) <em class="brace">{</em>
<a id="L201" name="L201"></a> 201                 <strong class="reserved">this</strong>.secureRandomSpi.<a href="../S/1215.html#L51" title="Defined at 51 in src/java/security/SecureRandomSpi.java.">engineSetSeed</a>(seed);
<a id="L202" name="L202"></a> 202             <em class="brace">}</em>
<a id="L203" name="L203"></a> 203         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L204" name="L204"></a> 204             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L205" name="L205"></a> 205                 <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a> <a href="../D/30092.html" title="Multiple defined in 3 places.">random</a> = <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>(prng);
<a id="L206" name="L206"></a> 206                 <strong class="reserved">this</strong>.secureRandomSpi = <a href="../D/30092.html" title="Multiple defined in 3 places.">random</a>.<a href="../S/1198.html#L392" title="Defined at 392 in src/java/security/SecureRandom.java.">getSecureRandomSpi</a>();
<a id="L207" name="L207"></a> 207                 <strong class="reserved">this</strong>.<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> = <a href="../D/30092.html" title="Multiple defined in 3 places.">random</a>.<a href="../D/21756.html" title="Multiple defined in 24 places.">getProvider</a>();
<a id="L208" name="L208"></a> 208                 <strong class="reserved">if</strong> (<a href="../D/33840.html" title="Multiple defined in 4 places.">setSeed</a>) <em class="brace">{</em>
<a id="L209" name="L209"></a> 209                     <strong class="reserved">this</strong>.secureRandomSpi.<a href="../S/1215.html#L51" title="Defined at 51 in src/java/security/SecureRandomSpi.java.">engineSetSeed</a>(seed);
<a id="L210" name="L210"></a> 210                 <em class="brace">}</em>
<a id="L211" name="L211"></a> 211             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1319.html#L35" title="Defined at 35 in src/java/security/NoSuchAlgorithmException.java.">NoSuchAlgorithmException</a> nsae) <em class="brace">{</em>
<a id="L212" name="L212"></a> 212                 <em class="comment">// never happens, because we made sure the algorithm exists</em>
<a id="L213" name="L213"></a> 213                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>(nsae);
<a id="L214" name="L214"></a> 214             <em class="brace">}</em>
<a id="L215" name="L215"></a> 215         <em class="brace">}</em>
<a id="L216" name="L216"></a> 216         <em class="comment">// JDK 1.1 based implementations subclass SecureRandom instead of</em>
<a id="L217" name="L217"></a> 217         <em class="comment">// SecureRandomSpi. They will also go through this code path because</em>
<a id="L218" name="L218"></a> 218         <em class="comment">// they must call a SecureRandom constructor as it is their superclass.</em>
<a id="L219" name="L219"></a> 219         <em class="comment">// If we are dealing with such an implementation, do not set the</em>
<a id="L220" name="L220"></a> 220         <em class="comment">// algorithm value as it would be inaccurate.</em>
<a id="L221" name="L221"></a> 221         <strong class="reserved">if</strong> (<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>() == <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L222" name="L222"></a> 222             <strong class="reserved">this</strong>.algorithm = prng;
<a id="L223" name="L223"></a> 223         <em class="brace">}</em>
<a id="L224" name="L224"></a> 224     <em class="brace">}</em>
<a id="L225" name="L225"></a> 225 
<div class="comment">
      Creates a SecureRandom object.
      @param secureRandomSpi the SecureRandom implementation.
      @param provider the provider.</div>
<a id="L232" name="L232"></a> 232     <strong class="reserved">protected</strong> SecureRandom(<a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a> secureRandomSpi,
<a id="L233" name="L233"></a> 233                            <a href="../D/6950.html" title="Multiple defined in 4 places.">Provider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>) <em class="brace">{</em>
<a id="L234" name="L234"></a> 234         <strong class="reserved">this</strong>(secureRandomSpi, <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>, <strong class="reserved">null</strong>);
<a id="L235" name="L235"></a> 235     <em class="brace">}</em>
<a id="L236" name="L236"></a> 236 
<a id="L237" name="L237"></a> 237     <strong class="reserved">private</strong> SecureRandom(<a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a> secureRandomSpi, <a href="../D/6950.html" title="Multiple defined in 4 places.">Provider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>,
<a id="L238" name="L238"></a> 238             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> algorithm) <em class="brace">{</em>
<a id="L239" name="L239"></a> 239         <strong class="reserved">super</strong>(0);
<a id="L240" name="L240"></a> 240         <strong class="reserved">this</strong>.secureRandomSpi = secureRandomSpi;
<a id="L241" name="L241"></a> 241         <strong class="reserved">this</strong>.<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> = <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>;
<a id="L242" name="L242"></a> 242         <strong class="reserved">this</strong>.algorithm = algorithm;
<a id="L243" name="L243"></a> 243 
<a id="L244" name="L244"></a> 244         <strong class="reserved">if</strong> (!skipDebug &amp;&amp; pdebug != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L245" name="L245"></a> 245             pdebug.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("SecureRandom." + algorithm +
<a id="L246" name="L246"></a> 246                 " algorithm from: " + <strong class="reserved">this</strong>.<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>());
<a id="L247" name="L247"></a> 247         <em class="brace">}</em>
<a id="L248" name="L248"></a> 248     <em class="brace">}</em>
<a id="L249" name="L249"></a> 249 
<div class="comment">
      Returns a SecureRandom object that implements the specified
      Random Number Generator (RNG) algorithm.
      <p> This method traverses the list of registered security Providers,
      starting with the most preferred Provider.
      A new SecureRandom object encapsulating the
      SecureRandomSpi implementation from the first
      Provider that supports the specified algorithm is returned.
      </p><p> Note that the list of registered providers may be retrieved via
      the {@link Security#getProviders() Security.getProviders()} method.
      </p><p> The returned SecureRandom object has not been seeded.  To seed the
      returned object, call the <code>setSeed</code> method.
      If <code>setSeed</code> is not called, the first call to
      <code>nextBytes</code> will force the SecureRandom object to seed itself.
      This self-seeding will not occur if <code>setSeed</code> was
      previously called.
      @param algorithm the name of the RNG algorithm.
      See the SecureRandom section in the <a href="{@docRoot}/../technotes/guides/security/StandardNames.html#SecureRandom">
      Java Cryptography Architecture Standard Algorithm Name Documentation</a>
      for information about standard RNG algorithm names.
      @return the new SecureRandom object.
      @exception NoSuchAlgorithmException if no Provider supports a
               SecureRandomSpi implementation for the
               specified algorithm.
      @see Provider
      @since 1.2</p></div>
<a id="L286" name="L286"></a> 286     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a> <a href="../R/17115.html" title="Multiple referred from 459 places.">getInstance</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> algorithm)
<a id="L287" name="L287"></a> 287             <strong class="reserved">throws</strong> <a href="../S/1319.html#L35" title="Defined at 35 in src/java/security/NoSuchAlgorithmException.java.">NoSuchAlgorithmException</a> <em class="brace">{</em>
<a id="L288" name="L288"></a> 288         Instance <a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a> = GetInstance.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>("SecureRandom",
<a id="L289" name="L289"></a> 289             <a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a>.<strong class="reserved">class</strong>, algorithm);
<a id="L290" name="L290"></a> 290         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>((<a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a>)<a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a>.<a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>,
<a id="L291" name="L291"></a> 291             <a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a>.<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>, algorithm);
<a id="L292" name="L292"></a> 292     <em class="brace">}</em>
<a id="L293" name="L293"></a> 293 
<div class="comment">
      Returns a SecureRandom object that implements the specified
      Random Number Generator (RNG) algorithm.
      <p> A new SecureRandom object encapsulating the
      SecureRandomSpi implementation from the specified provider
      is returned.  The specified provider must be registered
      in the security provider list.
      </p><p> Note that the list of registered providers may be retrieved via
      the {@link Security#getProviders() Security.getProviders()} method.
      </p><p> The returned SecureRandom object has not been seeded.  To seed the
      returned object, call the <code>setSeed</code> method.
      If <code>setSeed</code> is not called, the first call to
      <code>nextBytes</code> will force the SecureRandom object to seed itself.
      This self-seeding will not occur if <code>setSeed</code> was
      previously called.
      @param algorithm the name of the RNG algorithm.
      See the SecureRandom section in the <a href="{@docRoot}/../technotes/guides/security/StandardNames.html#SecureRandom">
      Java Cryptography Architecture Standard Algorithm Name Documentation</a>
      for information about standard RNG algorithm names.
      @param provider the name of the provider.
      @return the new SecureRandom object.
      @exception NoSuchAlgorithmException if a SecureRandomSpi
               implementation for the specified algorithm is not
               available from the specified provider.
      @exception NoSuchProviderException if the specified provider is not
               registered in the security provider list.
      @exception IllegalArgumentException if the provider name is null
               or empty.
      @see Provider
      @since 1.2</p></div>
<a id="L337" name="L337"></a> 337     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a> <a href="../R/17115.html" title="Multiple referred from 459 places.">getInstance</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> algorithm, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>)
<a id="L338" name="L338"></a> 338             <strong class="reserved">throws</strong> <a href="../S/1319.html#L35" title="Defined at 35 in src/java/security/NoSuchAlgorithmException.java.">NoSuchAlgorithmException</a>, <a href="../S/1205.html#L35" title="Defined at 35 in src/java/security/NoSuchProviderException.java.">NoSuchProviderException</a> <em class="brace">{</em>
<a id="L339" name="L339"></a> 339         Instance <a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a> = GetInstance.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>("SecureRandom",
<a id="L340" name="L340"></a> 340             <a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a>.<strong class="reserved">class</strong>, algorithm, <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L341" name="L341"></a> 341         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>((<a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a>)<a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a>.<a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>,
<a id="L342" name="L342"></a> 342             <a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a>.<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>, algorithm);
<a id="L343" name="L343"></a> 343     <em class="brace">}</em>
<a id="L344" name="L344"></a> 344 
<div class="comment">
      Returns a SecureRandom object that implements the specified
      Random Number Generator (RNG) algorithm.
      <p> A new SecureRandom object encapsulating the
      SecureRandomSpi implementation from the specified Provider
      object is returned.  Note that the specified Provider object
      does not have to be registered in the provider list.
      </p><p> The returned SecureRandom object has not been seeded.  To seed the
      returned object, call the <code>setSeed</code> method.
      If <code>setSeed</code> is not called, the first call to
      <code>nextBytes</code> will force the SecureRandom object to seed itself.
      This self-seeding will not occur if <code>setSeed</code> was
      previously called.
      @param algorithm the name of the RNG algorithm.
      See the SecureRandom section in the <a href="{@docRoot}/../technotes/guides/security/StandardNames.html#SecureRandom">
      Java Cryptography Architecture Standard Algorithm Name Documentation</a>
      for information about standard RNG algorithm names.
      @param provider the provider.
      @return the new SecureRandom object.
      @exception NoSuchAlgorithmException if a SecureRandomSpi
               implementation for the specified algorithm is not available
               from the specified Provider object.
      @exception IllegalArgumentException if the specified provider is null.
      @see Provider
      @since 1.4</p></div>
<a id="L381" name="L381"></a> 381     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a> <a href="../R/17115.html" title="Multiple referred from 459 places.">getInstance</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> algorithm,
<a id="L382" name="L382"></a> 382             <a href="../D/6950.html" title="Multiple defined in 4 places.">Provider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>) <strong class="reserved">throws</strong> <a href="../S/1319.html#L35" title="Defined at 35 in src/java/security/NoSuchAlgorithmException.java.">NoSuchAlgorithmException</a> <em class="brace">{</em>
<a id="L383" name="L383"></a> 383         Instance <a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a> = GetInstance.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>("SecureRandom",
<a id="L384" name="L384"></a> 384             <a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a>.<strong class="reserved">class</strong>, algorithm, <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L385" name="L385"></a> 385         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>((<a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a>)<a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a>.<a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>,
<a id="L386" name="L386"></a> 386             <a href="../D/24872.html" title="Multiple defined in 6 places.">instance</a>.<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>, algorithm);
<a id="L387" name="L387"></a> 387     <em class="brace">}</em>
<a id="L388" name="L388"></a> 388 
<div class="comment">
      Returns the SecureRandomSpi of this SecureRandom object.</div>
<a id="L392" name="L392"></a> 392     <a href="../S/1215.html#L40" title="Defined at 40 in src/java/security/SecureRandomSpi.java.">SecureRandomSpi</a> <a href="../S/1198.html#L206" title="Referred from 206 in src/java/security/SecureRandom.java.">getSecureRandomSpi</a>() <em class="brace">{</em>
<a id="L393" name="L393"></a> 393         <strong class="reserved">return</strong> secureRandomSpi;
<a id="L394" name="L394"></a> 394     <em class="brace">}</em>
<a id="L395" name="L395"></a> 395 
<div class="comment">
      Returns the provider of this SecureRandom object.
      @return the provider of this SecureRandom object.</div>
<a id="L401" name="L401"></a> 401     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../D/6950.html" title="Multiple defined in 4 places.">Provider</a> <a href="../R/18534.html" title="Multiple referred from 23 places.">getProvider</a>() <em class="brace">{</em>
<a id="L402" name="L402"></a> 402         <strong class="reserved">return</strong> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>;
<a id="L403" name="L403"></a> 403     <em class="brace">}</em>
<a id="L404" name="L404"></a> 404 
<div class="comment">
      Returns the name of the algorithm implemented by this SecureRandom
      object.
      @return the name of the algorithm or <code>unknown</code>
               if the algorithm name cannot be determined.
      @since 1.5</div>
<a id="L413" name="L413"></a> 413     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/14999.html" title="Multiple referred from 32 places.">getAlgorithm</a>() <em class="brace">{</em>
<a id="L414" name="L414"></a> 414         <strong class="reserved">return</strong> (algorithm != <strong class="reserved">null</strong>) ? algorithm : "unknown";
<a id="L415" name="L415"></a> 415     <em class="brace">}</em>
<a id="L416" name="L416"></a> 416 
<div class="comment">
      Reseeds this random object. The given seed supplements, rather than
      replaces, the existing seed. Thus, repeated calls are guaranteed
      never to reduce randomness.
      @param seed the seed.
      @see #getSeed</div>
<a id="L426" name="L426"></a> 426     <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28123.html" title="Multiple referred from 4 places.">setSeed</a>(<strong class="reserved">byte</strong>[] seed) <em class="brace">{</em>
<a id="L427" name="L427"></a> 427         secureRandomSpi.<a href="../S/1215.html#L51" title="Defined at 51 in src/java/security/SecureRandomSpi.java.">engineSetSeed</a>(seed);
<a id="L428" name="L428"></a> 428     <em class="brace">}</em>
<a id="L429" name="L429"></a> 429 
<div class="comment">
      Reseeds this random object, using the eight bytes contained
      in the given <code>long seed</code>. The given seed supplements,
      rather than replaces, the existing seed. Thus, repeated calls
      are guaranteed never to reduce randomness.
      <p>This method is defined for compatibility with
      <code>java.util.Random</code>.
      @param seed the seed.
      @see #getSeed</p></div>
<a id="L443" name="L443"></a> 443     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L444" name="L444"></a> 444     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28123.html" title="Multiple referred from 4 places.">setSeed</a>(<strong class="reserved">long</strong> seed) <em class="brace">{</em>
<div class="comment">
          Ignore call from super constructor (as well as any other calls
          unfortunate enough to be passing 0).  It's critical that we
          ignore call from superclass constructor, as digest has not
          yet been initialized at that point.</div>
<a id="L451" name="L451"></a> 451         <strong class="reserved">if</strong> (seed != 0) <em class="brace">{</em>
<a id="L452" name="L452"></a> 452             secureRandomSpi.<a href="../S/1215.html#L51" title="Defined at 51 in src/java/security/SecureRandomSpi.java.">engineSetSeed</a>(<a href="../S/1198.html#L540" title="Defined at 540 in src/java/security/SecureRandom.java.">longToByteArray</a>(seed));
<a id="L453" name="L453"></a> 453         <em class="brace">}</em>
<a id="L454" name="L454"></a> 454     <em class="brace">}</em>
<a id="L455" name="L455"></a> 455 
<div class="comment">
      Generates a user-specified number of random bytes.
      <p> If a call to <code>setSeed</code> had not occurred previously,
      the first call to this method forces this SecureRandom object
      to seed itself.  This self-seeding will not occur if
      <code>setSeed</code> was previously called.
      @param bytes the array to be filled in with random bytes.</p></div>
<a id="L466" name="L466"></a> 466     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L467" name="L467"></a> 467     <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/23655.html" title="Multiple referred from 5 places.">nextBytes</a>(<strong class="reserved">byte</strong>[] bytes) <em class="brace">{</em>
<a id="L468" name="L468"></a> 468         secureRandomSpi.<a href="../S/1215.html#L63" title="Defined at 63 in src/java/security/SecureRandomSpi.java.">engineNextBytes</a>(bytes);
<a id="L469" name="L469"></a> 469     <em class="brace">}</em>
<a id="L470" name="L470"></a> 470 
<div class="comment">
      Generates an integer containing the user-specified number of
      pseudo-random bits (right justified, with leading zeros).  This
      method overrides a <code>java.util.Random</code> method, and serves
      to provide a source of random bits to all of the methods inherited
      from that class (for example, <code>nextInt</code>,
      <code>nextLong</code>, and <code>nextFloat</code>).
      @param numBits number of pseudo-random bits to be generated, where
      <code>0 &lt;= numBits &lt;= 32</code>.
      @return an <code>int</code> containing the user-specified number
      of pseudo-random bits (right justified, with leading zeros).</div>
<a id="L485" name="L485"></a> 485     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L486" name="L486"></a> 486     <strong class="reserved">final</strong> <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/23650.html" title="Multiple referred from 3301 places.">next</a>(<strong class="reserved">int</strong> numBits) <em class="brace">{</em>
<a id="L487" name="L487"></a> 487         <strong class="reserved">int</strong> numBytes = (numBits+7)/8;
<a id="L488" name="L488"></a> 488         <strong class="reserved">byte</strong> b[] = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[numBytes];
<a id="L489" name="L489"></a> 489         <strong class="reserved">int</strong> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = 0;
<a id="L490" name="L490"></a> 490 
<a id="L491" name="L491"></a> 491         <a href="../D/28138.html" title="Multiple defined in 2 places.">nextBytes</a>(b);
<a id="L492" name="L492"></a> 492         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; numBytes; i++) <em class="brace">{</em>
<a id="L493" name="L493"></a> 493             <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = (<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> &lt;&lt; 8) + (b[i] &amp; 0xFF);
<a id="L494" name="L494"></a> 494         <em class="brace">}</em>
<a id="L495" name="L495"></a> 495 
<a id="L496" name="L496"></a> 496         <strong class="reserved">return</strong> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> &gt;&gt;&gt; (numBytes*8 - numBits);
<a id="L497" name="L497"></a> 497     <em class="brace">}</em>
<a id="L498" name="L498"></a> 498 
<div class="comment">
      Returns the given number of seed bytes, computed using the seed
      generation algorithm that this class uses to seed itself.  This
      call may be used to seed other random number generators.
      <p>This method is only included for backwards compatibility.
      The caller is encouraged to use one of the alternative
      <code>getInstance</code> methods to obtain a SecureRandom object, and
      then call the <code>generateSeed</code> method to obtain seed bytes
      from that object.
      @param numBytes the number of seed bytes to generate.
      @return the seed bytes.
      @see #setSeed</p></div>
<a id="L516" name="L516"></a> 516     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">byte</strong>[] <a href="../R/18902.html" title="Multiple referred from 2 places.">getSeed</a>(<strong class="reserved">int</strong> numBytes) <em class="brace">{</em>
<a id="L517" name="L517"></a> 517         <strong class="reserved">if</strong> (seedGenerator == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L518" name="L518"></a> 518             seedGenerator = <strong class="reserved">new</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>();
<a id="L519" name="L519"></a> 519         <em class="brace">}</em>
<a id="L520" name="L520"></a> 520         <strong class="reserved">return</strong> seedGenerator.<a href="../S/1198.html#L532" title="Defined at 532 in src/java/security/SecureRandom.java.">generateSeed</a>(numBytes);
<a id="L521" name="L521"></a> 521     <em class="brace">}</em>
<a id="L522" name="L522"></a> 522 
<div class="comment">
      Returns the given number of seed bytes, computed using the seed
      generation algorithm that this class uses to seed itself.  This
      call may be used to seed other random number generators.
      @param numBytes the number of seed bytes to generate.
      @return the seed bytes.</div>
<a id="L532" name="L532"></a> 532     <strong class="reserved">public</strong> <strong class="reserved">byte</strong>[] <a href="../S/1198.html#L520" title="Referred from 520 in src/java/security/SecureRandom.java.">generateSeed</a>(<strong class="reserved">int</strong> numBytes) <em class="brace">{</em>
<a id="L533" name="L533"></a> 533         <strong class="reserved">return</strong> secureRandomSpi.<a href="../S/1215.html#L73" title="Defined at 73 in src/java/security/SecureRandomSpi.java.">engineGenerateSeed</a>(numBytes);
<a id="L534" name="L534"></a> 534     <em class="brace">}</em>
<a id="L535" name="L535"></a> 535 
<div class="comment">
      Helper function to convert a long into a byte array (least significant
      byte first).</div>
<a id="L540" name="L540"></a> 540     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">byte</strong>[] <a href="../S/1198.html#L452" title="Referred from 452 in src/java/security/SecureRandom.java.">longToByteArray</a>(<strong class="reserved">long</strong> l) <em class="brace">{</em>
<a id="L541" name="L541"></a> 541         <strong class="reserved">byte</strong>[] retVal = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[8];
<a id="L542" name="L542"></a> 542 
<a id="L543" name="L543"></a> 543         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; 8; i++) <em class="brace">{</em>
<a id="L544" name="L544"></a> 544             retVal[i] = (<strong class="reserved">byte</strong>) l;
<a id="L545" name="L545"></a> 545             l &gt;&gt;= 8;
<a id="L546" name="L546"></a> 546         <em class="brace">}</em>
<a id="L547" name="L547"></a> 547 
<a id="L548" name="L548"></a> 548         <strong class="reserved">return</strong> retVal;
<a id="L549" name="L549"></a> 549     <em class="brace">}</em>
<a id="L550" name="L550"></a> 550 
<div class="comment">
      Gets a default PRNG algorithm by looking through all registered
      providers. Returns the first PRNG algorithm of the first provider that
      has registered a SecureRandom implementation, or null if none of the
      registered providers supplies a SecureRandom implementation.</div>
<a id="L557" name="L557"></a> 557     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1198.html#L194" title="Referred from 194 in src/java/security/SecureRandom.java.">getPrngAlgorithm</a>() <em class="brace">{</em>
<a id="L558" name="L558"></a> 558         <strong class="reserved">for</strong> (<a href="../D/6950.html" title="Multiple defined in 4 places.">Provider</a> p : Providers.getProviderList().<a href="../S/2005.html#L337" title="Defined at 337 in src/java/nio/charset/Charset.java.">providers</a>()) <em class="brace">{</em>
<a id="L559" name="L559"></a> 559             <strong class="reserved">for</strong> (<a href="../D/7863.html" title="Multiple defined in 2 places.">Service</a> s : p.<a href="../D/22449.html" title="Multiple defined in 3 places.">getServices</a>()) <em class="brace">{</em>
<a id="L560" name="L560"></a> 560                 <strong class="reserved">if</strong> (s.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("SecureRandom")) <em class="brace">{</em>
<a id="L561" name="L561"></a> 561                     <strong class="reserved">return</strong> s.<a href="../D/16849.html" title="Multiple defined in 22 places.">getAlgorithm</a>();
<a id="L562" name="L562"></a> 562                 <em class="brace">}</em>
<a id="L563" name="L563"></a> 563             <em class="brace">}</em>
<a id="L564" name="L564"></a> 564         <em class="brace">}</em>
<a id="L565" name="L565"></a> 565         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L566" name="L566"></a> 566     <em class="brace">}</em>
<a id="L567" name="L567"></a> 567 
<div class="comment">
      Lazily initialize since Pattern.compile() is heavy.
      Effective Java (2nd Edition), Item 71.</div>
<a id="L572" name="L572"></a> 572     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../S/1198.html#L634" title="Referred from 634 in src/java/security/SecureRandom.java.">StrongPatternHolder</a> <em class="brace">{</em>
<div class="comment">
          Entries are alg:prov separated by ,
          Allow for prepended/appended whitespace between entries.
          Capture groups:
              1 - alg
              2 - :prov (optional)
              3 - prov (optional)
              4 - ,nextEntry (optional)
              5 - nextEntry (optional)</div>
<a id="L584" name="L584"></a> 584         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/6677.html" title="Multiple defined in 3 places.">Pattern</a> <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> =
<a id="L585" name="L585"></a> 585             <a href="../D/6677.html" title="Multiple defined in 3 places.">Pattern</a>.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(
<a id="L586" name="L586"></a> 586                 "\\s*([\\S&amp;&amp;[^:,]]*)(\\:([\\S&amp;&amp;[^,]]*))?\\s*(\\,(.*))?");
<a id="L587" name="L587"></a> 587     <em class="brace">}</em>
<a id="L588" name="L588"></a> 588 
<div class="comment">
      Returns a <code>SecureRandom</code> object that was selected by using
      the algorithms/providers specified in the {@code
      securerandom.strongAlgorithms} <a href="../S/1265.html#L49" title="Defined at 49 in src/java/security/Security.java.">Security</a> property.
      <p>
      Some situations require strong random values, such as when
      creating high-value/long-lived secrets like RSA public/private
      keys.  To help guide applications in selecting a suitable strong
      <code>SecureRandom</code> implementation, Java distributions
      include a list of known strong <code>SecureRandom</code>
      implementations in the <code>securerandom.strongAlgorithms</code>
      Security property.
      </p><p>
      Every implementation of the Java platform is required to
      support at least one strong <code>SecureRandom</code> implementation.
      @return a strong <code>SecureRandom</code> implementation as indicated
      by the <code>securerandom.strongAlgorithms</code> Security property
      @throws NoSuchAlgorithmException if no algorithm is available
      @see Security#getProperty(String)
      @since 1.8</p></div>
<a id="L614" name="L614"></a> 614     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a> getInstanceStrong()
<a id="L615" name="L615"></a> 615             <strong class="reserved">throws</strong> <a href="../S/1319.html#L35" title="Defined at 35 in src/java/security/NoSuchAlgorithmException.java.">NoSuchAlgorithmException</a> <em class="brace">{</em>
<a id="L616" name="L616"></a> 616 
<a id="L617" name="L617"></a> 617         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> property = <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(
<a id="L618" name="L618"></a> 618             <strong class="reserved">new</strong> <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt;() <em class="brace">{</em>
<a id="L619" name="L619"></a> 619                 @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L620" name="L620"></a> 620                 <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>() <em class="brace">{</em>
<a id="L621" name="L621"></a> 621                     <strong class="reserved">return</strong> <a href="../S/1265.html#L49" title="Defined at 49 in src/java/security/Security.java.">Security</a>.<a href="../D/21720.html" title="Multiple defined in 77 places.">getProperty</a>(
<a id="L622" name="L622"></a> 622                         "securerandom.strongAlgorithms");
<a id="L623" name="L623"></a> 623                 <em class="brace">}</em>
<a id="L624" name="L624"></a> 624             <em class="brace">}</em>);
<a id="L625" name="L625"></a> 625 
<a id="L626" name="L626"></a> 626         <strong class="reserved">if</strong> ((property == <strong class="reserved">null</strong>) || (property.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 0)) <em class="brace">{</em>
<a id="L627" name="L627"></a> 627             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1319.html#L35" title="Defined at 35 in src/java/security/NoSuchAlgorithmException.java.">NoSuchAlgorithmException</a>(
<a id="L628" name="L628"></a> 628                 "Null/empty securerandom.strongAlgorithms Security Property");
<a id="L629" name="L629"></a> 629         <em class="brace">}</em>
<a id="L630" name="L630"></a> 630 
<a id="L631" name="L631"></a> 631         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/30665.html" title="Multiple defined in 3 places.">remainder</a> = property;
<a id="L632" name="L632"></a> 632         <strong class="reserved">while</strong> (<a href="../D/30665.html" title="Multiple defined in 3 places.">remainder</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L633" name="L633"></a> 633             <a href="../D/5451.html" title="Multiple defined in 3 places.">Matcher</a> m;
<a id="L634" name="L634"></a> 634             <strong class="reserved">if</strong> ((m = <a href="../S/1198.html#L572" title="Defined at 572 in src/java/security/SecureRandom.java.">StrongPatternHolder</a>.<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>.<a href="../S/986.html#L1086" title="Defined at 1086 in src/java/util/regex/Pattern.java.">matcher</a>(
<a id="L635" name="L635"></a> 635                     <a href="../D/30665.html" title="Multiple defined in 3 places.">remainder</a>)).<a href="../D/27563.html" title="Multiple defined in 31 places.">matches</a>()) <em class="brace">{</em>
<a id="L636" name="L636"></a> 636 
<a id="L637" name="L637"></a> 637                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> alg = m.<a href="../D/23914.html" title="Multiple defined in 8 places.">group</a>(1);
<a id="L638" name="L638"></a> 638                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> prov = m.<a href="../D/23914.html" title="Multiple defined in 8 places.">group</a>(3);
<a id="L639" name="L639"></a> 639 
<a id="L640" name="L640"></a> 640                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L641" name="L641"></a> 641                     <strong class="reserved">if</strong> (prov == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L642" name="L642"></a> 642                         <strong class="reserved">return</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>(alg);
<a id="L643" name="L643"></a> 643                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L644" name="L644"></a> 644                         <strong class="reserved">return</strong> <a href="../S/1198.html#L94" title="Defined at 94 in src/java/security/SecureRandom.java.">SecureRandom</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>(alg, prov);
<a id="L645" name="L645"></a> 645                     <em class="brace">}</em>
<a id="L646" name="L646"></a> 646                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1319.html#L35" title="Defined at 35 in src/java/security/NoSuchAlgorithmException.java.">NoSuchAlgorithmException</a> |
<a id="L647" name="L647"></a> 647                         <a href="../S/1205.html#L35" title="Defined at 35 in src/java/security/NoSuchProviderException.java.">NoSuchProviderException</a> e) <em class="brace">{</em>
<a id="L648" name="L648"></a> 648                 <em class="brace">}</em>
<a id="L649" name="L649"></a> 649                 <a href="../D/30665.html" title="Multiple defined in 3 places.">remainder</a> = m.<a href="../D/23914.html" title="Multiple defined in 8 places.">group</a>(5);
<a id="L650" name="L650"></a> 650             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L651" name="L651"></a> 651                 <a href="../D/30665.html" title="Multiple defined in 3 places.">remainder</a> = <strong class="reserved">null</strong>;
<a id="L652" name="L652"></a> 652             <em class="brace">}</em>
<a id="L653" name="L653"></a> 653         <em class="brace">}</em>
<a id="L654" name="L654"></a> 654 
<a id="L655" name="L655"></a> 655         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1319.html#L35" title="Defined at 35 in src/java/security/NoSuchAlgorithmException.java.">NoSuchAlgorithmException</a>(
<a id="L656" name="L656"></a> 656             "No strong SecureRandom impls available: " + property);
<a id="L657" name="L657"></a> 657     <em class="brace">}</em>
<a id="L658" name="L658"></a> 658 
<a id="L659" name="L659"></a> 659     <em class="comment">// Declare serialVersionUID to be compatible with JDK1.1</em>
<a id="L660" name="L660"></a> 660     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = 4940670005562187L;
<a id="L661" name="L661"></a> 661 
<a id="L662" name="L662"></a> 662     <em class="comment">// Retain unused values serialized from JDK1.1</em>
<div class="comment">
      @serial</div>
<a id="L666" name="L666"></a> 666     <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] <a href="../D/34848.html" title="Multiple defined in 2 places.">state</a>;
<div class="comment">
      @serial</div>
<a id="L670" name="L670"></a> 670     <strong class="reserved">private</strong> <a href="../S/1208.html#L106" title="Defined at 106 in src/java/security/MessageDigest.java.">MessageDigest</a> <a href="../D/14901.html" title="Multiple defined in 6 places.">digest</a> = <strong class="reserved">null</strong>;
<div class="comment">
      @serial
      We know that the MessageDigest class does not implement
      java.io.Serializable.  However, since this field is no longer
      used, it will always be NULL and won't affect the serialization
      of the SecureRandom class itself.</div>
<a id="L679" name="L679"></a> 679     <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] randomBytes;
<div class="comment">
      @serial</div>
<a id="L683" name="L683"></a> 683     <strong class="reserved">private</strong> <strong class="reserved">int</strong> randomBytesUsed;
<div class="comment">
      @serial</div>
<a id="L687" name="L687"></a> 687     <strong class="reserved">private</strong> <strong class="reserved">long</strong> counter;
<a id="L688" name="L688"></a> 688 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L193">[^]</a><a href="#L614">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>