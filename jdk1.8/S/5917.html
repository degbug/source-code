<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xml/internal/dtm/ref/DTMSafeStringPool.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L37">[^]</a><a href="#L62">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L37" title="Defined at 37.">removeAllElements</a></li>
<li><a href="#L46" title="Defined at 46.">indexToString</a></li>
<li><a href="#L53" title="Defined at 53.">stringToIndex</a></li>
<li><a href="#L62" title="Defined at 62.">_main</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: DTMSafeStringPool.java,v 1.2.4.1 2005/09/15 08:15:04 suresh_emailid Exp $</div>
<a id="L23" name="L23"></a>  23 
<a id="L24" name="L24"></a>  24 <strong class="reserved">package</strong> com.sun.org.apache.xml.internal.dtm.<a href="../S/986.html#L2252" title="Defined at 2252 in src/java/util/regex/Pattern.java.">ref</a>;
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 
<div class="comment">
 <p>Like DTMStringPool, but threadsafe. It's been proposed that DTMs
  share their string pool(s); that raises threadsafety issues which
  this addresses. Of course performance is inferior to that of the
  bare-bones version.</p>
  <p>Status: Passed basic test in main().</p>
 * </div>
<a id="L34" name="L34"></a>  34 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../S/5917.html#L75" title="Referred from 75 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMSafeStringPool.java.">DTMSafeStringPool</a>
<a id="L35" name="L35"></a>  35 <strong class="reserved">extends</strong> <a href="../S/5913.html#L59" title="Defined at 59 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMStringPool.java.">DTMStringPool</a>
<a id="L36" name="L36"></a>  36 <em class="brace">{</em>
<a id="L37" name="L37"></a>  37   <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../R/25892.html" title="Multiple referred from 90 places.">removeAllElements</a>()
<a id="L38" name="L38"></a>  38     <em class="brace">{</em>
<a id="L39" name="L39"></a>  39       <strong class="reserved">super</strong>.<a href="../D/30689.html" title="Multiple defined in 14 places.">removeAllElements</a>();
<a id="L40" name="L40"></a>  40     <em class="brace">}</em>
<a id="L41" name="L41"></a>  41 
<div class="comment">
 @return string whose value is uniquely identified by this integer index.
    @throws java.lang.ArrayIndexOutOfBoundsException
     if index doesn't map to a string.
   * </div>
<a id="L46" name="L46"></a>  46   <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/20522.html" title="Multiple referred from 25 places.">indexToString</a>(<strong class="reserved">int</strong> i)
<a id="L47" name="L47"></a>  47     <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../S/1761.html#L37" title="Defined at 37 in src/java/lang/ArrayIndexOutOfBoundsException.java.">ArrayIndexOutOfBoundsException</a>
<a id="L48" name="L48"></a>  48     <em class="brace">{</em>
<a id="L49" name="L49"></a>  49       <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/24479.html" title="Multiple defined in 3 places.">indexToString</a>(i);
<a id="L50" name="L50"></a>  50     <em class="brace">}</em>
<a id="L51" name="L51"></a>  51 
<div class="comment">
   /** @return integer index uniquely identifying the value of this string. */</div>
<a id="L53" name="L53"></a>  53   <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">int</strong> <a href="../R/28953.html" title="Multiple referred from 32 places.">stringToIndex</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s)
<a id="L54" name="L54"></a>  54     <em class="brace">{</em>
<a id="L55" name="L55"></a>  55       <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/34939.html" title="Multiple defined in 3 places.">stringToIndex</a>(s);
<a id="L56" name="L56"></a>  56     <em class="brace">}</em>
<a id="L57" name="L57"></a>  57 
<div class="comment">
 Command-line unit test driver. This test relies on the fact that
    this version of the pool assigns indices consecutively, starting
    from zero, as new unique strings are encountered.</div>
<a id="L62" name="L62"></a>  62   <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/9433.html" title="Multiple referred from 15 places.">_main</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] args)
<a id="L63" name="L63"></a>  63   <em class="brace">{</em>
<a id="L64" name="L64"></a>  64     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] word=<em class="brace">{</em>
<a id="L65" name="L65"></a>  65       "Zero","One","Two","Three","Four","Five",
<a id="L66" name="L66"></a>  66       "Six","Seven","Eight","Nine","Ten",
<a id="L67" name="L67"></a>  67       "Eleven","Twelve","Thirteen","Fourteen","Fifteen",
<a id="L68" name="L68"></a>  68       "Sixteen","Seventeen","Eighteen","Nineteen","Twenty",
<a id="L69" name="L69"></a>  69       "Twenty-One","Twenty-Two","Twenty-Three","Twenty-Four",
<a id="L70" name="L70"></a>  70       "Twenty-Five","Twenty-Six","Twenty-Seven","Twenty-Eight",
<a id="L71" name="L71"></a>  71       "Twenty-Nine","Thirty","Thirty-One","Thirty-Two",
<a id="L72" name="L72"></a>  72       "Thirty-Three","Thirty-Four","Thirty-Five","Thirty-Six",
<a id="L73" name="L73"></a>  73       "Thirty-Seven","Thirty-Eight","Thirty-Nine"<em class="brace">}</em>;
<a id="L74" name="L74"></a>  74 
<a id="L75" name="L75"></a>  75     <a href="../S/5913.html#L59" title="Defined at 59 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMStringPool.java.">DTMStringPool</a> pool=<strong class="reserved">new</strong> <a href="../S/5917.html#L34" title="Defined at 34 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMSafeStringPool.java.">DTMSafeStringPool</a>();
<a id="L76" name="L76"></a>  76 
<a id="L77" name="L77"></a>  77     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("If no complaints are printed below, we passed initial test.");
<a id="L78" name="L78"></a>  78 
<a id="L79" name="L79"></a>  79     <strong class="reserved">for</strong>(<strong class="reserved">int</strong> pass=0;pass&lt;=1;++pass)
<a id="L80" name="L80"></a>  80       <em class="brace">{</em>
<a id="L81" name="L81"></a>  81         <strong class="reserved">int</strong> i;
<a id="L82" name="L82"></a>  82 
<a id="L83" name="L83"></a>  83         <strong class="reserved">for</strong>(i=0;i&lt;word.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;++i)
<a id="L84" name="L84"></a>  84           <em class="brace">{</em>
<a id="L85" name="L85"></a>  85             <strong class="reserved">int</strong> j=pool.<a href="../D/34939.html" title="Multiple defined in 3 places.">stringToIndex</a>(word[i]);
<a id="L86" name="L86"></a>  86             <strong class="reserved">if</strong>(j!=i)
<a id="L87" name="L87"></a>  87               <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\tMismatch populating pool: assigned "+
<a id="L88" name="L88"></a>  88                                  j+" for create "+i);
<a id="L89" name="L89"></a>  89           <em class="brace">}</em>
<a id="L90" name="L90"></a>  90 
<a id="L91" name="L91"></a>  91         <strong class="reserved">for</strong>(i=0;i&lt;word.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;++i)
<a id="L92" name="L92"></a>  92           <em class="brace">{</em>
<a id="L93" name="L93"></a>  93             <strong class="reserved">int</strong> j=pool.<a href="../D/34939.html" title="Multiple defined in 3 places.">stringToIndex</a>(word[i]);
<a id="L94" name="L94"></a>  94             <strong class="reserved">if</strong>(j!=i)
<a id="L95" name="L95"></a>  95               <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\tMismatch in stringToIndex: returned "+
<a id="L96" name="L96"></a>  96                                  j+" for lookup "+i);
<a id="L97" name="L97"></a>  97           <em class="brace">}</em>
<a id="L98" name="L98"></a>  98 
<a id="L99" name="L99"></a>  99         <strong class="reserved">for</strong>(i=0;i&lt;word.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;++i)
<a id="L100" name="L100"></a> 100           <em class="brace">{</em>
<a id="L101" name="L101"></a> 101             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> w=pool.<a href="../D/24479.html" title="Multiple defined in 3 places.">indexToString</a>(i);
<a id="L102" name="L102"></a> 102             <strong class="reserved">if</strong>(!word[i].<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(w))
<a id="L103" name="L103"></a> 103               <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\tMismatch in indexToString: returned"+
<a id="L104" name="L104"></a> 104                                  w+" for lookup "+i);
<a id="L105" name="L105"></a> 105           <em class="brace">}</em>
<a id="L106" name="L106"></a> 106 
<a id="L107" name="L107"></a> 107         pool.<a href="../D/30689.html" title="Multiple defined in 14 places.">removeAllElements</a>();
<a id="L108" name="L108"></a> 108 
<a id="L109" name="L109"></a> 109         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("\nPass "+pass+" complete\n");
<a id="L110" name="L110"></a> 110       <em class="brace">}</em> <em class="comment">// end pass loop</em>
<a id="L111" name="L111"></a> 111   <em class="brace">}</em>
<a id="L112" name="L112"></a> 112 <em class="brace">}</em> <em class="comment">// DTMSafeStringPool</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L37">[^]</a><a href="#L62">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>