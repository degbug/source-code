<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/jmx/snmp/daemon/SnmpSession.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L108">[^]</a><a href="#L456">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L108" title="Defined at 108.">initialize</a></li>
<li><a href="#L121" title="Defined at 121.">isSessionActive</a></li>
<li><a href="#L130" title="Defined at 130.">getSocket</a></li>
<li><a href="#L138" title="Defined at 138.">getSnmpQManager</a></li>
<li><a href="#L146" title="Defined at 146.">syncInProgress</a></li>
<li><a href="#L150" title="Defined at 150.">setSyncMode</a></li>
<li><a href="#L154" title="Defined at 154.">resetSyncMode</a></li>
<li><a href="#L170" title="Defined at 170.">thisSessionContext</a></li>
<li><a href="#L183" title="Defined at 183.">makeAsyncRequest</a></li>
<li><a href="#L201" title="Defined at 201.">waitForResponse</a></li>
<li><a href="#L247" title="Defined at 247.">run</a></li>
<li><a href="#L274" title="Defined at 274.">processResponse</a></li>
<li><a href="#L309" title="Defined at 309.">addInformRequest</a></li>
<li><a href="#L323" title="Defined at 323.">removeInformRequest</a></li>
<li><a href="#L337" title="Defined at 337.">cancelAllRequests</a></li>
<li><a href="#L369" title="Defined at 369.">addResponse</a></li>
<li><a href="#L385" title="Defined at 385.">nextResponse</a></li>
<li><a href="#L404" title="Defined at 404.">cancelAllResponses</a></li>
<li><a href="#L416" title="Defined at 416.">destroySession</a></li>
<li><a href="#L433" title="Defined at 433.">killSessionThread</a></li>
<li><a href="#L456" title="Defined at 456.">finalize</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L6" name="L6"></a>   6 <em class="comment">// Copyright (c) 1995-96 by Cisco Systems, Inc.</em>
<a id="L7" name="L7"></a>   7 
<a id="L8" name="L8"></a>   8 <strong class="reserved">package</strong> com.sun.jmx.snmp.daemon;
<a id="L9" name="L9"></a>   9 
<a id="L10" name="L10"></a>  10 <em class="comment">// java imports</em>
<a id="L11" name="L11"></a>  11 <em class="comment">//</em>
<a id="L12" name="L12"></a>  12 <strong class="reserved">import</strong> java.util.Hashtable;
<a id="L13" name="L13"></a>  13 <strong class="reserved">import</strong> java.util.logging.Level;
<a id="L14" name="L14"></a>  14 <strong class="reserved">import</strong> java.util.Stack;
<a id="L15" name="L15"></a>  15 <strong class="reserved">import</strong> java.net.InetAddress;
<a id="L16" name="L16"></a>  16 <strong class="reserved">import</strong> java.net.SocketException;
<a id="L17" name="L17"></a>  17 
<a id="L18" name="L18"></a>  18 <em class="comment">// jmx imports</em>
<a id="L19" name="L19"></a>  19 <em class="comment">//</em>
<a id="L20" name="L20"></a>  20 <strong class="reserved">import</strong> static com.sun.jmx.defaults.JmxProperties.SNMP_ADAPTOR_LOGGER;
<a id="L21" name="L21"></a>  21 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpDefinitions;
<a id="L22" name="L22"></a>  22 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpStatusException;
<a id="L23" name="L23"></a>  23 <strong class="reserved">import</strong> com.sun.jmx.snmp.SnmpVarBindList;
<a id="L24" name="L24"></a>  24 
<div class="comment">
  This class is used for sending INFORM REQUESTS from an agent to a manager.
  Creates, controls, and manages one or more inform requests.
  The SnmpSession maintains the list of all active inform requests and inform responses.
  Each SnmpSession has a dispatcher that is a thread used to service all the inform requests it creates
  and each SnmpSession uses a separate socket for sending/receiving inform requests/responses.
  An SnmpSession object is associated with an SNMP adaptor server.
  It is created the first time an inform request is sent by the SNMP adaptor server
  and is destroyed (with its associated SnmpSocket) when the SNMP adaptor server is stopped.</div>
<a id="L39" name="L39"></a>  39 
<a id="L40" name="L40"></a>  40 <strong class="reserved">class</strong> <a href="../R/7412.html" title="Multiple referred from 15 places.">SnmpSession</a> <strong class="reserved">implements</strong> <a href="../S/6476.html#L19" title="Defined at 19 in src/com/sun/jmx/snmp/SnmpDefinitions.java.">SnmpDefinitions</a>, <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> <em class="brace">{</em>
<a id="L41" name="L41"></a>  41 
<a id="L42" name="L42"></a>  42     <em class="comment">// PRIVATE VARIABLES</em>
<a id="L43" name="L43"></a>  43     <em class="comment">//------------------</em>
<a id="L44" name="L44"></a>  44 
<div class="comment">
      The SNMP adaptor associated with this SnmpSession.</div>
<a id="L48" name="L48"></a>  48     <strong class="reserved">protected</strong> <strong class="reserved">transient</strong> <a href="../S/6449.html#L130" title="Defined at 130 in src/com/sun/jmx/snmp/daemon/SnmpAdaptorServer.java.">SnmpAdaptorServer</a> adaptor;
<div class="comment">
      The SnmpSocket to be used to communicate with the manager
      by all inform requests created in this session.</div>
<a id="L53" name="L53"></a>  53     <strong class="reserved">protected</strong> <strong class="reserved">transient</strong> <a href="../S/6459.html#L33" title="Defined at 33 in src/com/sun/jmx/snmp/daemon/SnmpSocket.java.">SnmpSocket</a> informSocket = <strong class="reserved">null</strong>;
<div class="comment">
      This table maintains the list of inform requests.</div>
<a id="L57" name="L57"></a>  57     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>&lt;<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a>, <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a>&gt; informRequestList =
<a id="L58" name="L58"></a>  58             <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>&lt;&gt;();
<div class="comment">
      This table maintains the list of inform responses.
      A FIFO queue is needed here.</div>
<a id="L63" name="L63"></a>  63     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/1186.html#L49" title="Defined at 49 in src/java/util/Stack.java.">Stack</a>&lt;<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a>&gt; informRespq =
<a id="L64" name="L64"></a>  64             <strong class="reserved">new</strong> <a href="../S/1186.html#L49" title="Defined at 49 in src/java/util/Stack.java.">Stack</a>&lt;&gt;();
<div class="comment">
      The dispatcher that will service all inform responses to inform requests generated
      using this session object. An SnmpSession object creates one or more inform requests.
      Thus it services all inform requests, which are created by this session object,
      when an inform response arrives for an inform request generated by the session.</div>
<a id="L71" name="L71"></a>  71     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> myThread = <strong class="reserved">null</strong>;
<div class="comment">
      Request being synchronized from session thread. This happens when
      a user does sync operation from a callback.</div>
<a id="L76" name="L76"></a>  76     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> syncInformReq ;
<a id="L77" name="L77"></a>  77 
<a id="L78" name="L78"></a>  78     <a href="../S/6461.html#L22" title="Defined at 22 in src/com/sun/jmx/snmp/daemon/SnmpQManager.java.">SnmpQManager</a> snmpQman = <strong class="reserved">null</strong>;
<a id="L79" name="L79"></a>  79 
<a id="L80" name="L80"></a>  80     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> isBeingCancelled = <strong class="reserved">false</strong>;
<a id="L81" name="L81"></a>  81 
<a id="L82" name="L82"></a>  82     <em class="comment">// PUBLIC CONSTRUCTORS</em>
<a id="L83" name="L83"></a>  83     <em class="comment">//--------------------</em>
<a id="L84" name="L84"></a>  84 
<div class="comment">
      Constructor for creating a new session.
      @param adp The SNMP adaptor associated with this SnmpSession.
      @exception SocketException Unable to initialize the SnmpSocket.</div>
<a id="L90" name="L90"></a>  90     <strong class="reserved">public</strong> SnmpSession(<a href="../S/6449.html#L130" title="Defined at 130 in src/com/sun/jmx/snmp/daemon/SnmpAdaptorServer.java.">SnmpAdaptorServer</a> adp) <strong class="reserved">throws</strong> <a href="../S/808.html#L37" title="Defined at 37 in src/java/net/SocketException.java.">SocketException</a> <em class="brace">{</em>
<a id="L91" name="L91"></a>  91         adaptor = adp;
<a id="L92" name="L92"></a>  92         snmpQman = <strong class="reserved">new</strong> <a href="../S/6461.html#L22" title="Defined at 22 in src/com/sun/jmx/snmp/daemon/SnmpQManager.java.">SnmpQManager</a>();
<a id="L93" name="L93"></a>  93         <a href="../S/6453.html#L28" title="Defined at 28 in src/com/sun/jmx/snmp/daemon/SnmpResponseHandler.java.">SnmpResponseHandler</a> snmpRespHdlr = <strong class="reserved">new</strong> <a href="../S/6453.html#L28" title="Defined at 28 in src/com/sun/jmx/snmp/daemon/SnmpResponseHandler.java.">SnmpResponseHandler</a>(adp, snmpQman);
<a id="L94" name="L94"></a>  94         <a href="../D/24646.html" title="Multiple defined in 91 places.">initialize</a>(adp, snmpRespHdlr);
<a id="L95" name="L95"></a>  95     <em class="brace">}</em>
<div class="comment">
      Constructor for creating a new session. Allows subclassing.</div>
<a id="L99" name="L99"></a>  99     <strong class="reserved">public</strong> SnmpSession() <strong class="reserved">throws</strong> <a href="../S/808.html#L37" title="Defined at 37 in src/java/net/SocketException.java.">SocketException</a> <em class="brace">{</em>
<a id="L100" name="L100"></a> 100     <em class="brace">}</em>
<a id="L101" name="L101"></a> 101     <em class="comment">// OTHER METHODS</em>
<a id="L102" name="L102"></a> 102     <em class="comment">//--------------</em>
<div class="comment">
      Initializes the SnmpSession.
      @param adp The SNMP adaptor associated with this SnmpSession.
      @exception SocketException Unable to initialize the SnmpSocket.</div>
<a id="L108" name="L108"></a> 108     <strong class="reserved">protected</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../R/20681.html" title="Multiple referred from 99 places.">initialize</a>(<a href="../S/6449.html#L130" title="Defined at 130 in src/com/sun/jmx/snmp/daemon/SnmpAdaptorServer.java.">SnmpAdaptorServer</a> adp,
<a id="L109" name="L109"></a> 109                                            <a href="../S/6453.html#L28" title="Defined at 28 in src/com/sun/jmx/snmp/daemon/SnmpResponseHandler.java.">SnmpResponseHandler</a> snmpRespHdlr)
<a id="L110" name="L110"></a> 110         <strong class="reserved">throws</strong> <a href="../S/808.html#L37" title="Defined at 37 in src/java/net/SocketException.java.">SocketException</a> <em class="brace">{</em>
<a id="L111" name="L111"></a> 111         informSocket = <strong class="reserved">new</strong> <a href="../S/6459.html#L33" title="Defined at 33 in src/com/sun/jmx/snmp/daemon/SnmpSocket.java.">SnmpSocket</a>(snmpRespHdlr, adp.<a href="../D/16826.html" title="Multiple defined in 18 places.">getAddress</a>(), adp.<a href="../D/17362.html" title="Multiple defined in 9 places.">getBufferSize</a>().<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>());
<a id="L112" name="L112"></a> 112 
<a id="L113" name="L113"></a> 113         myThread = <strong class="reserved">new</strong> <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>(<strong class="reserved">this</strong>, "SnmpSession");
<a id="L114" name="L114"></a> 114         myThread.<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>();
<a id="L115" name="L115"></a> 115     <em class="brace">}</em>
<a id="L116" name="L116"></a> 116 
<div class="comment">
      Indicates whether the thread for this session is active and the SNMP adaptor server ONLINE.
      @return true if active, false otherwise.</div>
<a id="L121" name="L121"></a> 121     <strong class="reserved">synchronized</strong> <strong class="reserved">boolean</strong> <a href="../R/22009.html" title="Multiple referred from 3 places.">isSessionActive</a>() <em class="brace">{</em>
<a id="L122" name="L122"></a> 122         <em class="comment">//return ((myThread != null) &amp;&amp; (myThread.isAlive()));</em>
<a id="L123" name="L123"></a> 123         <strong class="reserved">return</strong> ((adaptor.<a href="../D/25158.html" title="Multiple defined in 19 places.">isActive</a>()) &amp;&amp; (myThread != <strong class="reserved">null</strong>) &amp;&amp; (myThread.<a href="../D/25173.html" title="Multiple defined in 3 places.">isAlive</a>()));
<a id="L124" name="L124"></a> 124     <em class="brace">}</em>
<a id="L125" name="L125"></a> 125 
<div class="comment">
      Gets the SnmpSocket which will be used by inform requests created in this session.
      @return The socket which will be used in this session.</div>
<a id="L130" name="L130"></a> 130     <a href="../S/6459.html#L33" title="Defined at 33 in src/com/sun/jmx/snmp/daemon/SnmpSocket.java.">SnmpSocket</a> <a href="../R/19074.html" title="Multiple referred from 9 places.">getSocket</a>() <em class="brace">{</em>
<a id="L131" name="L131"></a> 131         <strong class="reserved">return</strong> informSocket;
<a id="L132" name="L132"></a> 132     <em class="brace">}</em>
<a id="L133" name="L133"></a> 133 
<div class="comment">
      Gets the SnmpQManager which will be used by inform requests created in this session.
      @return The SnmpQManager which will be used in this session.</div>
<a id="L138" name="L138"></a> 138     <a href="../S/6461.html#L22" title="Defined at 22 in src/com/sun/jmx/snmp/daemon/SnmpQManager.java.">SnmpQManager</a> <a href="../R/19072.html" title="Multiple referred from 3 places.">getSnmpQManager</a>() <em class="brace">{</em>
<a id="L139" name="L139"></a> 139         <strong class="reserved">return</strong> snmpQman;
<a id="L140" name="L140"></a> 140     <em class="brace">}</em>
<a id="L141" name="L141"></a> 141 
<div class="comment">
      Indicates whether this session is performing synchronous operation for an inform request.
      @return <code>true</code> if the session is performing synchronous operation, <code>false</code> otherwise.</div>
<a id="L146" name="L146"></a> 146     <strong class="reserved">private</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">boolean</strong> <a href="../S/6455.html#L216" title="Referred from 216 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">syncInProgress</a>() <em class="brace">{</em>
<a id="L147" name="L147"></a> 147         <strong class="reserved">return</strong> syncInformReq != <strong class="reserved">null</strong> ;
<a id="L148" name="L148"></a> 148     <em class="brace">}</em>
<a id="L149" name="L149"></a> 149 
<a id="L150" name="L150"></a> 150     <strong class="reserved">private</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../S/6455.html#L205" title="Referred from 205 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">setSyncMode</a>(<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> req) <em class="brace">{</em>
<a id="L151" name="L151"></a> 151         syncInformReq = req ;
<a id="L152" name="L152"></a> 152     <em class="brace">}</em>
<a id="L153" name="L153"></a> 153 
<a id="L154" name="L154"></a> 154     <strong class="reserved">private</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../R/26293.html" title="Multiple referred from 2 places.">resetSyncMode</a>() <em class="brace">{</em>
<a id="L155" name="L155"></a> 155         <strong class="reserved">if</strong> (syncInformReq == <strong class="reserved">null</strong>)
<a id="L156" name="L156"></a> 156             <strong class="reserved">return</strong> ;
<a id="L157" name="L157"></a> 157         syncInformReq = <strong class="reserved">null</strong> ;
<a id="L158" name="L158"></a> 158         <strong class="reserved">if</strong> (<a href="../S/6455.html#L170" title="Defined at 170 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">thisSessionContext</a>())
<a id="L159" name="L159"></a> 159             <strong class="reserved">return</strong> ;
<a id="L160" name="L160"></a> 160         <strong class="reserved">this</strong>.<a href="../S/1724.html#L295" title="Defined at 295 in src/java/lang/Object.java.">notifyAll</a>() ;
<a id="L161" name="L161"></a> 161     <em class="brace">}</em>
<a id="L162" name="L162"></a> 162 
<div class="comment">
      Returns <code>true</code> if the current executing thread is this session's dispatcher.
      Typically used to detect whether the user is doing a sync operation from
      this dispatcher context. For instance, a user gives a sync command
      from within a request callback using its associated session.
      @return <code>true</code> if current thread is this session's dispatcher, <code>false</code> otherwise.</div>
<a id="L170" name="L170"></a> 170     <strong class="reserved">boolean</strong> <a href="../R/29160.html" title="Multiple referred from 3 places.">thisSessionContext</a>() <em class="brace">{</em>
<a id="L171" name="L171"></a> 171         <strong class="reserved">return</strong> (<a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L264" title="Defined at 264 in src/java/lang/Thread.java.">currentThread</a>() == myThread) ;
<a id="L172" name="L172"></a> 172     <em class="brace">}</em>
<a id="L173" name="L173"></a> 173 
<div class="comment">
      Sends an inform request to the specified InetAddress destination using the specified community string.
      @param addr The InetAddress destination for this inform request.
      @param cs The community string to be used for the inform request.
      @param cb The callback that is invoked when a request is complete.
      @param vblst A list of SnmpVarBind instances or null.
      @exception SnmpStatusException SNMP adaptor is not ONLINE or session
                 is dead.</div>
<a id="L183" name="L183"></a> 183     <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> <a href="../R/22828.html" title="Multiple referred from 2 places.">makeAsyncRequest</a>(<a href="../S/826.html#L189" title="Defined at 189 in src/java/net/InetAddress.java.">InetAddress</a> addr, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> cs,
<a id="L184" name="L184"></a> 184                                        <a href="../S/6451.html#L52" title="Defined at 52 in src/com/sun/jmx/snmp/daemon/SnmpInformHandler.java.">SnmpInformHandler</a> cb,
<a id="L185" name="L185"></a> 185                                        <a href="../S/6437.html#L22" title="Defined at 22 in src/com/sun/jmx/snmp/SnmpVarBindList.java.">SnmpVarBindList</a> vblst, <strong class="reserved">int</strong> port)
<a id="L186" name="L186"></a> 186         <strong class="reserved">throws</strong> <a href="../S/6312.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/SnmpStatusException.java.">SnmpStatusException</a> <em class="brace">{</em>
<a id="L187" name="L187"></a> 187 
<a id="L188" name="L188"></a> 188         <strong class="reserved">if</strong> (!<a href="../S/6455.html#L121" title="Defined at 121 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">isSessionActive</a>()) <em class="brace">{</em>
<a id="L189" name="L189"></a> 189             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/6312.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/SnmpStatusException.java.">SnmpStatusException</a>("SNMP adaptor server not ONLINE");
<a id="L190" name="L190"></a> 190         <em class="brace">}</em>
<a id="L191" name="L191"></a> 191         <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> snmpreq = <strong class="reserved">new</strong> <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a>(<strong class="reserved">this</strong>, adaptor, addr, cs, port, cb);
<a id="L192" name="L192"></a> 192         snmpreq.<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>(vblst);
<a id="L193" name="L193"></a> 193         <strong class="reserved">return</strong> snmpreq;
<a id="L194" name="L194"></a> 194     <em class="brace">}</em>
<a id="L195" name="L195"></a> 195 
<div class="comment">
      Performs sync operations on active requests. Any number of inform requests
      can be done in sync mode but only one per thread.
      The user can do synchronous operation using the request handle only.</div>
<a id="L201" name="L201"></a> 201     <strong class="reserved">void</strong> <a href="../R/30414.html" title="Multiple referred from 4 places.">waitForResponse</a>(<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> req, <strong class="reserved">long</strong> waitTime) <em class="brace">{</em>
<a id="L202" name="L202"></a> 202 
<a id="L203" name="L203"></a> 203         <strong class="reserved">if</strong> (! req.<a href="../S/6457.html#L281" title="Defined at 281 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">inProgress</a>())
<a id="L204" name="L204"></a> 204             <strong class="reserved">return</strong> ;
<a id="L205" name="L205"></a> 205         <a href="../S/6455.html#L150" title="Defined at 150 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">setSyncMode</a>(req) ;
<a id="L206" name="L206"></a> 206         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L207" name="L207"></a> 207             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L208" name="L208"></a> 208                 "waitForResponse", "Session switching to sync mode for inform request " + req.<a href="../D/22004.html" title="Multiple defined in 31 places.">getRequestId</a>());
<a id="L209" name="L209"></a> 209         <em class="brace">}</em>
<a id="L210" name="L210"></a> 210         <strong class="reserved">long</strong> maxTime ;
<a id="L211" name="L211"></a> 211         <strong class="reserved">if</strong> (waitTime &lt;= 0)
<a id="L212" name="L212"></a> 212             maxTime = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() + 6000 * 1000 ;
<a id="L213" name="L213"></a> 213         <strong class="reserved">else</strong>
<a id="L214" name="L214"></a> 214             maxTime = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() + waitTime ;
<a id="L215" name="L215"></a> 215 
<a id="L216" name="L216"></a> 216         <strong class="reserved">while</strong> (req.<a href="../S/6457.html#L281" title="Defined at 281 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">inProgress</a>() || <a href="../S/6455.html#L146" title="Defined at 146 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">syncInProgress</a>()) <em class="brace">{</em>
<a id="L217" name="L217"></a> 217             waitTime = maxTime - <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() ;
<a id="L218" name="L218"></a> 218             <strong class="reserved">if</strong> (waitTime &lt;= 0)
<a id="L219" name="L219"></a> 219                 <strong class="reserved">break</strong> ;
<a id="L220" name="L220"></a> 220             <strong class="reserved">synchronized</strong> (<strong class="reserved">this</strong>) <em class="brace">{</em>
<a id="L221" name="L221"></a> 221                 <strong class="reserved">if</strong> (! informRespq.<a href="../D/30774.html" title="Multiple defined in 14 places.">removeElement</a>(req)) <em class="brace">{</em>
<a id="L222" name="L222"></a> 222                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L223" name="L223"></a> 223                         <strong class="reserved">this</strong>.<a href="../D/36778.html" title="Multiple defined in 3 places.">wait</a>(waitTime) ;
<a id="L224" name="L224"></a> 224                     <em class="brace">}</em> <strong class="reserved">catch</strong>(<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> e) <em class="brace">{</em>
<a id="L225" name="L225"></a> 225                     <em class="brace">}</em>
<a id="L226" name="L226"></a> 226                     <strong class="reserved">continue</strong> ;
<a id="L227" name="L227"></a> 227                 <em class="brace">}</em>
<a id="L228" name="L228"></a> 228             <em class="brace">}</em>
<a id="L229" name="L229"></a> 229             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L230" name="L230"></a> 230                 <a href="../D/29851.html" title="Multiple defined in 3 places.">processResponse</a>(req) ;
<a id="L231" name="L231"></a> 231             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L232" name="L232"></a> 232                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L233" name="L233"></a> 233                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L234" name="L234"></a> 234                         "waitForResponse", "Got unexpected exception", e);
<a id="L235" name="L235"></a> 235                 <em class="brace">}</em>
<a id="L236" name="L236"></a> 236             <em class="brace">}</em>
<a id="L237" name="L237"></a> 237         <em class="brace">}</em>
<a id="L238" name="L238"></a> 238         <a href="../S/6455.html#L154" title="Defined at 154 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">resetSyncMode</a>() ;
<a id="L239" name="L239"></a> 239     <em class="brace">}</em>
<a id="L240" name="L240"></a> 240 
<div class="comment">
      Dispatcher method for this session thread. This is the dispatcher method
      which goes in an endless-loop and waits for servicing inform requests
      which received a reply from the manager.</div>
<a id="L246" name="L246"></a> 246     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L247" name="L247"></a> 247     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26539.html" title="Multiple referred from 715 places.">run</a>() <em class="brace">{</em>
<a id="L248" name="L248"></a> 248         myThread = <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L264" title="Defined at 264 in src/java/lang/Thread.java.">currentThread</a>();
<a id="L249" name="L249"></a> 249         myThread.<a href="../D/33607.html" title="Multiple defined in 2 places.">setPriority</a>(<a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.NORM_PRIORITY);
<a id="L250" name="L250"></a> 250 
<a id="L251" name="L251"></a> 251         <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> reqc = <strong class="reserved">null</strong>;
<a id="L252" name="L252"></a> 252         <strong class="reserved">while</strong> (myThread != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L253" name="L253"></a> 253             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L254" name="L254"></a> 254                 reqc = <a href="../S/6455.html#L385" title="Defined at 385 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">nextResponse</a>();
<a id="L255" name="L255"></a> 255                 <strong class="reserved">if</strong> (reqc != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L256" name="L256"></a> 256                     <a href="../D/29851.html" title="Multiple defined in 3 places.">processResponse</a>(reqc);
<a id="L257" name="L257"></a> 257                 <em class="brace">}</em>
<a id="L258" name="L258"></a> 258             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1576.html#L49" title="Defined at 49 in src/java/lang/ThreadDeath.java.">ThreadDeath</a> d) <em class="brace">{</em>
<a id="L259" name="L259"></a> 259                 myThread = <strong class="reserved">null</strong>;
<a id="L260" name="L260"></a> 260                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L261" name="L261"></a> 261                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L262" name="L262"></a> 262                         "run", "ThreadDeath, session thread unexpectedly shutting down");
<a id="L263" name="L263"></a> 263                 <em class="brace">}</em>
<a id="L264" name="L264"></a> 264                 <strong class="reserved">throw</strong> d ;
<a id="L265" name="L265"></a> 265             <em class="brace">}</em>
<a id="L266" name="L266"></a> 266         <em class="brace">}</em>
<a id="L267" name="L267"></a> 267         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L268" name="L268"></a> 268             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L269" name="L269"></a> 269                 "run", "Session thread shutting down");
<a id="L270" name="L270"></a> 270         <em class="brace">}</em>
<a id="L271" name="L271"></a> 271         myThread = <strong class="reserved">null</strong> ;
<a id="L272" name="L272"></a> 272     <em class="brace">}</em>
<a id="L273" name="L273"></a> 273 
<a id="L274" name="L274"></a> 274     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25182.html" title="Multiple referred from 5 places.">processResponse</a>(<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> reqc) <em class="brace">{</em>
<a id="L275" name="L275"></a> 275 
<a id="L276" name="L276"></a> 276         <strong class="reserved">while</strong> (reqc != <strong class="reserved">null</strong> &amp;&amp; myThread != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L277" name="L277"></a> 277             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L278" name="L278"></a> 278                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L279" name="L279"></a> 279                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L280" name="L280"></a> 280                             "processResponse", "Processing response to req = " + reqc.<a href="../D/22004.html" title="Multiple defined in 31 places.">getRequestId</a>());
<a id="L281" name="L281"></a> 281                 <em class="brace">}</em>
<a id="L282" name="L282"></a> 282                 reqc.<a href="../D/29851.html" title="Multiple defined in 3 places.">processResponse</a>() ;  <em class="comment">// Handles out of memory.</em>
<a id="L283" name="L283"></a> 283                 reqc = <strong class="reserved">null</strong> ;  <em class="comment">// finished processing.</em>
<a id="L284" name="L284"></a> 284             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L285" name="L285"></a> 285                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L286" name="L286"></a> 286                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L287" name="L287"></a> 287                         "processResponse", "Got unexpected exception", e);
<a id="L288" name="L288"></a> 288                 <em class="brace">}</em>
<a id="L289" name="L289"></a> 289                 reqc = <strong class="reserved">null</strong> ;
<a id="L290" name="L290"></a> 290             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1597.html#L41" title="Defined at 41 in src/java/lang/OutOfMemoryError.java.">OutOfMemoryError</a> ome) <em class="brace">{</em>
<a id="L291" name="L291"></a> 291                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L292" name="L292"></a> 292                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L293" name="L293"></a> 293                         "processResponse", "Out of memory error in session thread", ome);
<a id="L294" name="L294"></a> 294                 <em class="brace">}</em>
<a id="L295" name="L295"></a> 295                 <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L282" title="Defined at 282 in src/java/lang/Thread.java.">yield</a>();
<a id="L296" name="L296"></a> 296                 <strong class="reserved">continue</strong> ;   <em class="comment">// re-process the request.</em>
<a id="L297" name="L297"></a> 297             <em class="brace">}</em>
<a id="L298" name="L298"></a> 298         <em class="brace">}</em>
<a id="L299" name="L299"></a> 299     <em class="brace">}</em>
<a id="L300" name="L300"></a> 300 
<a id="L301" name="L301"></a> 301     <em class="comment">// HANDLING INFORM REQUESTS LIST AND INFORM RESPONSES LIST</em>
<a id="L302" name="L302"></a> 302     <em class="comment">//--------------------------------------------------------</em>
<a id="L303" name="L303"></a> 303 
<div class="comment">
      Adds an inform request.
      @param snmpreq The inform request to add.
      @exception SnmpStatusException SNMP adaptor is not ONLINE or session is dead.</div>
<a id="L309" name="L309"></a> 309     <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../S/6457.html#L238" title="Referred from 238 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">addInformRequest</a>(<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> snmpreq) <strong class="reserved">throws</strong> <a href="../S/6312.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/SnmpStatusException.java.">SnmpStatusException</a> <em class="brace">{</em>
<a id="L310" name="L310"></a> 310 
<a id="L311" name="L311"></a> 311         <em class="comment">// If the adaptor is not ONLINE, stop adding requests.</em>
<a id="L312" name="L312"></a> 312         <em class="comment">//</em>
<a id="L313" name="L313"></a> 313         <strong class="reserved">if</strong> (!<a href="../S/6455.html#L121" title="Defined at 121 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">isSessionActive</a>()) <em class="brace">{</em>
<a id="L314" name="L314"></a> 314             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/6312.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/SnmpStatusException.java.">SnmpStatusException</a>("SNMP adaptor is not ONLINE or session is dead...") ;
<a id="L315" name="L315"></a> 315         <em class="brace">}</em>
<a id="L316" name="L316"></a> 316         informRequestList.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(snmpreq, snmpreq);
<a id="L317" name="L317"></a> 317     <em class="brace">}</em>
<a id="L318" name="L318"></a> 318 
<div class="comment">
      Deletes an inform request.
      @param snmpreq The inform request to delete.</div>
<a id="L323" name="L323"></a> 323     <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../S/6457.html#L1031" title="Referred from 1031 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">removeInformRequest</a>(<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> snmpreq) <em class="brace">{</em>
<a id="L324" name="L324"></a> 324         <em class="comment">// deleteRequest can be called from destroySnmpSession.</em>
<a id="L325" name="L325"></a> 325         <em class="comment">//In such a case remove is done in cancelAllRequest method.</em>
<a id="L326" name="L326"></a> 326         <strong class="reserved">if</strong>(!isBeingCancelled)
<a id="L327" name="L327"></a> 327             informRequestList.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(snmpreq) ;
<a id="L328" name="L328"></a> 328 
<a id="L329" name="L329"></a> 329         <strong class="reserved">if</strong> (syncInformReq != <strong class="reserved">null</strong> &amp;&amp; syncInformReq == snmpreq) <em class="brace">{</em>
<a id="L330" name="L330"></a> 330             <a href="../S/6455.html#L154" title="Defined at 154 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">resetSyncMode</a>() ;
<a id="L331" name="L331"></a> 331         <em class="brace">}</em>
<a id="L332" name="L332"></a> 332     <em class="brace">}</em>
<a id="L333" name="L333"></a> 333 
<div class="comment">
      Cancels all pending inform requests in this session.</div>
<a id="L337" name="L337"></a> 337     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6455.html#L418" title="Referred from 418 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">cancelAllRequests</a>() <em class="brace">{</em>
<a id="L338" name="L338"></a> 338         <strong class="reserved">final</strong> <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a>[] <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>;
<a id="L339" name="L339"></a> 339 
<a id="L340" name="L340"></a> 340         <strong class="reserved">synchronized</strong>(<strong class="reserved">this</strong>) <em class="brace">{</em>
<a id="L341" name="L341"></a> 341 
<a id="L342" name="L342"></a> 342             <strong class="reserved">if</strong> (informRequestList.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L343" name="L343"></a> 343                 <strong class="reserved">return</strong> ;
<a id="L344" name="L344"></a> 344             <em class="brace">}</em>
<a id="L345" name="L345"></a> 345 
<a id="L346" name="L346"></a> 346             isBeingCancelled = <strong class="reserved">true</strong>;
<a id="L347" name="L347"></a> 347 
<a id="L348" name="L348"></a> 348             <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a> = <strong class="reserved">new</strong> <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a>[informRequestList.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()];
<a id="L349" name="L349"></a> 349             <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util.<a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a>&gt; it = informRequestList.<a href="../D/36382.html" title="Multiple defined in 31 places.">values</a>().<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L350" name="L350"></a> 350             <strong class="reserved">int</strong> i = 0;
<a id="L351" name="L351"></a> 351             <strong class="reserved">while</strong>(it.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L352" name="L352"></a> 352                 <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> req = it.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L353" name="L353"></a> 353                 <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>[i++] = req;
<a id="L354" name="L354"></a> 354                 it.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>();
<a id="L355" name="L355"></a> 355             <em class="brace">}</em>
<a id="L356" name="L356"></a> 356             informRequestList.<a href="../D/12817.html" title="Multiple defined in 199 places.">clear</a>();
<a id="L357" name="L357"></a> 357         <em class="brace">}</em>
<a id="L358" name="L358"></a> 358 
<a id="L359" name="L359"></a> 359         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i = 0; i &lt; <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++)
<a id="L360" name="L360"></a> 360             <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>[i].<a href="../S/6457.html#L414" title="Defined at 414 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">cancelRequest</a>();
<a id="L361" name="L361"></a> 361     <em class="brace">}</em>
<a id="L362" name="L362"></a> 362 
<div class="comment">
      Adds the inform request object which received a response to an inform request
      generated by the session.  This is added to a private store, which
      will be eventually picked up by the dispatcher for processing.
      @param reqc The inform request that received the response from the manager.</div>
<a id="L369" name="L369"></a> 369     <strong class="reserved">void</strong> <a href="../S/6457.html#L630" title="Referred from 630 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">addResponse</a>(<a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> reqc) <em class="brace">{</em>
<a id="L370" name="L370"></a> 370 
<a id="L371" name="L371"></a> 371         <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> snmpreq = reqc;
<a id="L372" name="L372"></a> 372         <strong class="reserved">if</strong> (<a href="../S/6455.html#L121" title="Defined at 121 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">isSessionActive</a>()) <em class="brace">{</em>
<a id="L373" name="L373"></a> 373             <strong class="reserved">synchronized</strong>(<strong class="reserved">this</strong>) <em class="brace">{</em>
<a id="L374" name="L374"></a> 374                 informRespq.<a href="../D/29933.html" title="Multiple defined in 37 places.">push</a>(reqc) ;
<a id="L375" name="L375"></a> 375                 <strong class="reserved">this</strong>.<a href="../S/1724.html#L295" title="Defined at 295 in src/java/lang/Object.java.">notifyAll</a>() ;
<a id="L376" name="L376"></a> 376             <em class="brace">}</em>
<a id="L377" name="L377"></a> 377         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L378" name="L378"></a> 378             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L379" name="L379"></a> 379                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L380" name="L380"></a> 380                     "addResponse", "Adaptor not ONLINE or session thread dead, so inform response is dropped..." + reqc.<a href="../D/22004.html" title="Multiple defined in 31 places.">getRequestId</a>());
<a id="L381" name="L381"></a> 381             <em class="brace">}</em>
<a id="L382" name="L382"></a> 382         <em class="brace">}</em>
<a id="L383" name="L383"></a> 383     <em class="brace">}</em>
<a id="L384" name="L384"></a> 384 
<a id="L385" name="L385"></a> 385     <strong class="reserved">private</strong> <strong class="reserved">synchronized</strong> <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> <a href="../S/6455.html#L254" title="Referred from 254 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">nextResponse</a>() <em class="brace">{</em>
<a id="L386" name="L386"></a> 386 
<a id="L387" name="L387"></a> 387         <strong class="reserved">if</strong> (informRespq.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L388" name="L388"></a> 388             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L389" name="L389"></a> 389                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L390" name="L390"></a> 390                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L391" name="L391"></a> 391                        "nextResponse", "Blocking for response");
<a id="L392" name="L392"></a> 392                 <em class="brace">}</em>
<a id="L393" name="L393"></a> 393                 <strong class="reserved">this</strong>.<a href="../D/36778.html" title="Multiple defined in 3 places.">wait</a>();
<a id="L394" name="L394"></a> 394             <em class="brace">}</em> <strong class="reserved">catch</strong>(<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> e) <em class="brace">{</em>
<a id="L395" name="L395"></a> 395             <em class="brace">}</em>
<a id="L396" name="L396"></a> 396         <em class="brace">}</em>
<a id="L397" name="L397"></a> 397         <strong class="reserved">if</strong> (informRespq.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>())
<a id="L398" name="L398"></a> 398             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L399" name="L399"></a> 399         <a href="../S/6457.html#L72" title="Defined at 72 in src/com/sun/jmx/snmp/daemon/SnmpInformRequest.java.">SnmpInformRequest</a> reqc = informRespq.<a href="../D/16403.html" title="Multiple defined in 2 places.">firstElement</a>();
<a id="L400" name="L400"></a> 400         informRespq.<a href="../D/30775.html" title="Multiple defined in 12 places.">removeElementAt</a>(0) ;
<a id="L401" name="L401"></a> 401         <strong class="reserved">return</strong> reqc ;
<a id="L402" name="L402"></a> 402     <em class="brace">}</em>
<a id="L403" name="L403"></a> 403 
<a id="L404" name="L404"></a> 404     <strong class="reserved">private</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../S/6455.html#L419" title="Referred from 419 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">cancelAllResponses</a>() <em class="brace">{</em>
<a id="L405" name="L405"></a> 405         <strong class="reserved">if</strong> (informRespq != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L406" name="L406"></a> 406             syncInformReq = <strong class="reserved">null</strong> ;
<a id="L407" name="L407"></a> 407             informRespq.<a href="../D/30689.html" title="Multiple defined in 14 places.">removeAllElements</a>() ;
<a id="L408" name="L408"></a> 408             <strong class="reserved">this</strong>.<a href="../S/1724.html#L295" title="Defined at 295 in src/java/lang/Object.java.">notifyAll</a>() ;
<a id="L409" name="L409"></a> 409         <em class="brace">}</em>
<a id="L410" name="L410"></a> 410     <em class="brace">}</em>
<a id="L411" name="L411"></a> 411 
<div class="comment">
      Destroys any pending inform requests and then stops the session.
      The session will not be usable after this method returns.</div>
<a id="L416" name="L416"></a> 416     <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../S/6449.html#L2551" title="Referred from 2551 in src/com/sun/jmx/snmp/daemon/SnmpAdaptorServer.java.">destroySession</a>() <em class="brace">{</em>
<a id="L417" name="L417"></a> 417 
<a id="L418" name="L418"></a> 418         <a href="../S/6455.html#L337" title="Defined at 337 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">cancelAllRequests</a>() ;
<a id="L419" name="L419"></a> 419         <a href="../S/6455.html#L404" title="Defined at 404 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">cancelAllResponses</a>() ;
<a id="L420" name="L420"></a> 420         <strong class="reserved">synchronized</strong>(<strong class="reserved">this</strong>) <em class="brace">{</em>
<a id="L421" name="L421"></a> 421             informSocket.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>() ;
<a id="L422" name="L422"></a> 422             informSocket = <strong class="reserved">null</strong> ;
<a id="L423" name="L423"></a> 423         <em class="brace">}</em>
<a id="L424" name="L424"></a> 424         snmpQman.<a href="../S/6461.html#L57" title="Defined at 57 in src/com/sun/jmx/snmp/daemon/SnmpQManager.java.">stopQThreads</a>() ;
<a id="L425" name="L425"></a> 425         snmpQman = <strong class="reserved">null</strong> ;
<a id="L426" name="L426"></a> 426         <a href="../S/6455.html#L433" title="Defined at 433 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">killSessionThread</a>() ;
<a id="L427" name="L427"></a> 427     <em class="brace">}</em>
<a id="L428" name="L428"></a> 428 
<div class="comment">
      Make sure you are killing the thread when it is active. Instead
      prepare for a graceful exit.</div>
<a id="L433" name="L433"></a> 433     <strong class="reserved">private</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../S/6455.html#L426" title="Referred from 426 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">killSessionThread</a>() <em class="brace">{</em>
<a id="L434" name="L434"></a> 434 
<a id="L435" name="L435"></a> 435         <strong class="reserved">if</strong> ((myThread != <strong class="reserved">null</strong>) &amp;&amp; (myThread.<a href="../D/25173.html" title="Multiple defined in 3 places.">isAlive</a>())) <em class="brace">{</em>
<a id="L436" name="L436"></a> 436             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L437" name="L437"></a> 437                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L438" name="L438"></a> 438                    "killSessionThread", "Destroying session");
<a id="L439" name="L439"></a> 439             <em class="brace">}</em>
<a id="L440" name="L440"></a> 440             <strong class="reserved">if</strong> (!<a href="../S/6455.html#L170" title="Defined at 170 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">thisSessionContext</a>()) <em class="brace">{</em>
<a id="L441" name="L441"></a> 441                 myThread = <strong class="reserved">null</strong> ;
<a id="L442" name="L442"></a> 442                 <strong class="reserved">this</strong>.<a href="../S/1724.html#L295" title="Defined at 295 in src/java/lang/Object.java.">notifyAll</a>() ;
<a id="L443" name="L443"></a> 443             <em class="brace">}</em> <strong class="reserved">else</strong>
<a id="L444" name="L444"></a> 444                 myThread = <strong class="reserved">null</strong> ;
<a id="L445" name="L445"></a> 445         <em class="brace">}</em>
<a id="L446" name="L446"></a> 446     <em class="brace">}</em>
<a id="L447" name="L447"></a> 447 
<div class="comment">
      Finalizer of the <code>SnmpSession</code> objects.
      This method is called by the garbage collector on an object
      when garbage collection determines that there are no more references to the object.
      <p>Removes all the requests for this SNMP session, closes the socket and
      sets all the references to the <code>SnmpSession</code> object to <code>null</code>.</p></div>
<a id="L455" name="L455"></a> 455     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L456" name="L456"></a> 456     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/14337.html" title="Multiple referred from 5 places.">finalize</a>() <em class="brace">{</em>
<a id="L457" name="L457"></a> 457 
<a id="L458" name="L458"></a> 458         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L459" name="L459"></a> 459             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, <a href="../S/6455.html#L40" title="Defined at 40 in src/com/sun/jmx/snmp/daemon/SnmpSession.java.">SnmpSession</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L460" name="L460"></a> 460                "finalize", "Shutting all servers");
<a id="L461" name="L461"></a> 461         <em class="brace">}</em>
<a id="L462" name="L462"></a> 462 
<a id="L463" name="L463"></a> 463         <strong class="reserved">if</strong> (informRespq != <strong class="reserved">null</strong>)
<a id="L464" name="L464"></a> 464             informRespq.<a href="../D/30689.html" title="Multiple defined in 14 places.">removeAllElements</a>() ;
<a id="L465" name="L465"></a> 465         informRespq = <strong class="reserved">null</strong> ;
<a id="L466" name="L466"></a> 466         <strong class="reserved">if</strong> (informSocket != <strong class="reserved">null</strong>)
<a id="L467" name="L467"></a> 467             informSocket.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>() ;
<a id="L468" name="L468"></a> 468         informSocket = <strong class="reserved">null</strong> ;
<a id="L469" name="L469"></a> 469 
<a id="L470" name="L470"></a> 470         snmpQman = <strong class="reserved">null</strong> ;
<a id="L471" name="L471"></a> 471     <em class="brace">}</em>
<a id="L472" name="L472"></a> 472 
<a id="L473" name="L473"></a> 473 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L108">[^]</a><a href="#L456">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>