<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xerces/internal/util/XMLGrammarPoolImpl.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L96">[^]</a><a href="#L333">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L96" title="Defined at 96.">retrieveInitialGrammarSet</a></li>
<li><a href="#L125" title="Defined at 125.">cacheGrammars</a></li>
<li><a href="#L152" title="Defined at 152.">retrieveGrammar</a></li>
<li><a href="#L170" title="Defined at 170.">putGrammar</a></li>
<li><a href="#L197" title="Defined at 197.">getGrammar</a></li>
<li><a href="#L219" title="Defined at 219.">removeGrammar</a></li>
<li><a href="#L249" title="Defined at 249.">containsGrammar</a></li>
<li><a href="#L265" title="Defined at 265.">lockPool</a></li>
<li><a href="#L273" title="Defined at 273.">unlockPool</a></li>
<li><a href="#L281" title="Defined at 281.">clear</a></li>
<li><a href="#L300" title="Defined at 300.">equals</a></li>
<li><a href="#L310" title="Defined at 310.">hashCode</a></li>
<li><a href="#L333" title="Defined at 333.">clear</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2002,2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
       http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<a id="L20" name="L20"></a>  20 
<a id="L21" name="L21"></a>  21 <strong class="reserved">package</strong> com.sun.org.apache.xerces.internal.util;
<a id="L22" name="L22"></a>  22 
<a id="L23" name="L23"></a>  23 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.grammars.Grammar;
<a id="L24" name="L24"></a>  24 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.grammars.XMLGrammarDescription;
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.grammars.XMLGrammarPool;
<a id="L26" name="L26"></a>  26 
<div class="comment">
  Stores grammars in a pool associated to a specific key. This grammar pool
  implementation stores two types of grammars: those keyed by the root element
  name, and those keyed by the grammar's target namespace.
  This is the default implementation of the GrammarPool interface.
  As we move forward, this will become more function-rich and robust.
  @author Jeffrey Rodriguez, IBM
  @author Andy Clark, IBM
  @author Neil Graham, IBM
  @author Pavani Mukthipudi, Sun Microsystems
  @author Neeraj Bajaj, SUN Microsystems</div>
<a id="L42" name="L42"></a>  42 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/9019.html" title="Multiple referred from 12 places.">XMLGrammarPoolImpl</a> <strong class="reserved">implements</strong> <a href="../S/5516.html#L47" title="Defined at 47 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarPool.java.">XMLGrammarPool</a> <em class="brace">{</em>
<a id="L43" name="L43"></a>  43 
<a id="L44" name="L44"></a>  44     <em class="comment">//</em>
<a id="L45" name="L45"></a>  45     <em class="comment">// Constants</em>
<a id="L46" name="L46"></a>  46     <em class="comment">//</em>
<a id="L47" name="L47"></a>  47 
<div class="comment">
     /** Default size. */</div>
<a id="L49" name="L49"></a>  49     <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> TABLE_SIZE = 11;
<a id="L50" name="L50"></a>  50 
<a id="L51" name="L51"></a>  51     <em class="comment">//</em>
<a id="L52" name="L52"></a>  52     <em class="comment">// Data</em>
<a id="L53" name="L53"></a>  53     <em class="comment">//</em>
<a id="L54" name="L54"></a>  54 
<div class="comment">
     /** Grammars. */</div>
<a id="L56" name="L56"></a>  56     <strong class="reserved">protected</strong> <a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a>[] fGrammars = <strong class="reserved">null</strong>;
<a id="L57" name="L57"></a>  57 
<a id="L58" name="L58"></a>  58     <em class="comment">// whether this pool is locked</em>
<a id="L59" name="L59"></a>  59     <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> fPoolIsLocked;
<a id="L60" name="L60"></a>  60 
<a id="L61" name="L61"></a>  61     <em class="comment">// the number of grammars in the pool</em>
<a id="L62" name="L62"></a>  62     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> fGrammarCount = 0;
<a id="L63" name="L63"></a>  63 
<a id="L64" name="L64"></a>  64     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> DEBUG = <strong class="reserved">false</strong> ;
<a id="L65" name="L65"></a>  65 
<a id="L66" name="L66"></a>  66     <em class="comment">//</em>
<a id="L67" name="L67"></a>  67     <em class="comment">// Constructors</em>
<a id="L68" name="L68"></a>  68     <em class="comment">//</em>
<a id="L69" name="L69"></a>  69 
<div class="comment">
     /** Constructs a grammar pool with a default number of buckets. */</div>
<a id="L71" name="L71"></a>  71     <strong class="reserved">public</strong> XMLGrammarPoolImpl() <em class="brace">{</em>
<a id="L72" name="L72"></a>  72         fGrammars = <strong class="reserved">new</strong> <a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a>[TABLE_SIZE];
<a id="L73" name="L73"></a>  73         fPoolIsLocked = <strong class="reserved">false</strong>;
<a id="L74" name="L74"></a>  74     <em class="brace">}</em> <em class="comment">// &lt;init&gt;()</em>
<a id="L75" name="L75"></a>  75 
<div class="comment">
     /** Constructs a grammar pool with a specified number of buckets. */</div>
<a id="L77" name="L77"></a>  77     <strong class="reserved">public</strong> XMLGrammarPoolImpl(<strong class="reserved">int</strong> initialCapacity) <em class="brace">{</em>
<a id="L78" name="L78"></a>  78         fGrammars = <strong class="reserved">new</strong> <a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a>[initialCapacity];
<a id="L79" name="L79"></a>  79         fPoolIsLocked = <strong class="reserved">false</strong>;
<a id="L80" name="L80"></a>  80     <em class="brace">}</em>
<a id="L81" name="L81"></a>  81 
<a id="L82" name="L82"></a>  82     <em class="comment">//</em>
<a id="L83" name="L83"></a>  83     <em class="comment">// XMLGrammarPool methods</em>
<a id="L84" name="L84"></a>  84     <em class="comment">//</em>
<a id="L85" name="L85"></a>  85 
<div class="comment">
 <p> Retrieve the initial known set of grammars. This method is
      called by a validator before the validation starts. The application
      can provide an initial set of grammars available to the current
      validation attempt. </p>
      @param grammarType The type of the grammar, from the
                         <code>com.sun.org.apache.xerces.internal.xni.grammars.XMLGrammarDescription</code>
                         interface.
      @return            The set of grammars the validator may put in its "bucket"</div>
<a id="L96" name="L96"></a>  96     <strong class="reserved">public</strong> <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> [] <a href="../R/26463.html" title="Multiple referred from 8 places.">retrieveInitialGrammarSet</a> (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> grammarType) <em class="brace">{</em>
<a id="L97" name="L97"></a>  97         <strong class="reserved">synchronized</strong> (fGrammars) <em class="brace">{</em>
<a id="L98" name="L98"></a>  98             <strong class="reserved">int</strong> grammarSize = fGrammars.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> ;
<a id="L99" name="L99"></a>  99             <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> [] tempGrammars = <strong class="reserved">new</strong> <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a>[fGrammarCount];
<a id="L100" name="L100"></a> 100             <strong class="reserved">int</strong> pos = 0;
<a id="L101" name="L101"></a> 101             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; grammarSize; i++) <em class="brace">{</em>
<a id="L102" name="L102"></a> 102                 <strong class="reserved">for</strong> (<a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a> e = fGrammars[i]; e != <strong class="reserved">null</strong>; e = e.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L103" name="L103"></a> 103                     <strong class="reserved">if</strong> (e.desc.<a href="../D/19355.html" title="Multiple defined in 3 places.">getGrammarType</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(grammarType)) <em class="brace">{</em>
<a id="L104" name="L104"></a> 104                         tempGrammars[pos++] = e.grammar;
<a id="L105" name="L105"></a> 105                     <em class="brace">}</em>
<a id="L106" name="L106"></a> 106                 <em class="brace">}</em>
<a id="L107" name="L107"></a> 107             <em class="brace">}</em>
<a id="L108" name="L108"></a> 108             <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a>[] toReturn = <strong class="reserved">new</strong> <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a>[pos];
<a id="L109" name="L109"></a> 109             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(tempGrammars, 0, toReturn, 0, pos);
<a id="L110" name="L110"></a> 110             <strong class="reserved">return</strong> toReturn;
<a id="L111" name="L111"></a> 111         <em class="brace">}</em>
<a id="L112" name="L112"></a> 112     <em class="brace">}</em> <em class="comment">// retrieveInitialGrammarSet (String): Grammar[]</em>
<a id="L113" name="L113"></a> 113 
<div class="comment">
 <p> Return the final set of grammars that the validator ended up
      with. This method is called after the validation finishes. The
      application may then choose to cache some of the returned grammars.</p>
      <p>In this implementation, we make our choice based on whether this object
      is "locked"--that is, whether the application has instructed
      us not to accept any new grammars.</p>
      @param grammarType The type of the grammars being returned;
      @param grammars    An array containing the set of grammars being
                         returned; order is not significant.</div>
<a id="L125" name="L125"></a> 125     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/10755.html" title="Multiple referred from 10 places.">cacheGrammars</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> grammarType, <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a>[] grammars) <em class="brace">{</em>
<a id="L126" name="L126"></a> 126         <strong class="reserved">if</strong>(!fPoolIsLocked) <em class="brace">{</em>
<a id="L127" name="L127"></a> 127             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; grammars.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L128" name="L128"></a> 128                 <strong class="reserved">if</strong>(DEBUG) <em class="brace">{</em>
<a id="L129" name="L129"></a> 129                     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("CACHED GRAMMAR " + (i+1) ) ;
<a id="L130" name="L130"></a> 130                     <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> temp = grammars[i] ;
<a id="L131" name="L131"></a> 131                     <em class="comment">//print(temp.getGrammarDescription());</em>
<a id="L132" name="L132"></a> 132                 <em class="brace">}</em>
<a id="L133" name="L133"></a> 133                 <a href="../D/30001.html" title="Multiple defined in 7 places.">putGrammar</a>(grammars[i]);
<a id="L134" name="L134"></a> 134             <em class="brace">}</em>
<a id="L135" name="L135"></a> 135         <em class="brace">}</em>
<a id="L136" name="L136"></a> 136     <em class="brace">}</em> <em class="comment">// cacheGrammars(String, Grammar[]);</em>
<a id="L137" name="L137"></a> 137 
<div class="comment">
 <p> This method requests that the application retrieve a grammar
      corresponding to the given GrammarIdentifier from its cache.
      If it cannot do so it must return null; the parser will then
      call the EntityResolver. </p>
      <strong>An application must not call its EntityResolver itself
      from this method; this may result in infinite recursions.</strong>
      This implementation chooses to use the root element name to identify a DTD grammar
      and the target namespace to identify a Schema grammar.
      @param desc The description of the Grammar being requested.
      @return     The Grammar corresponding to this description or null if
                  no such Grammar is known.</div>
<a id="L152" name="L152"></a> 152     <strong class="reserved">public</strong> <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> <a href="../R/26461.html" title="Multiple referred from 8 places.">retrieveGrammar</a>(<a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc) <em class="brace">{</em>
<a id="L153" name="L153"></a> 153         <strong class="reserved">if</strong>(DEBUG)<em class="brace">{</em>
<a id="L154" name="L154"></a> 154             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("RETRIEVING GRAMMAR FROM THE APPLICATION WITH FOLLOWING DESCRIPTION :");
<a id="L155" name="L155"></a> 155             <em class="comment">//print(desc);</em>
<a id="L156" name="L156"></a> 156         <em class="brace">}</em>
<a id="L157" name="L157"></a> 157         <strong class="reserved">return</strong> <a href="../D/19350.html" title="Multiple defined in 8 places.">getGrammar</a>(desc);
<a id="L158" name="L158"></a> 158     <em class="brace">}</em> <em class="comment">// retrieveGrammar(XMLGrammarDescription):  Grammar</em>
<a id="L159" name="L159"></a> 159 
<a id="L160" name="L160"></a> 160     <em class="comment">//</em>
<a id="L161" name="L161"></a> 161     <em class="comment">// Public methods</em>
<a id="L162" name="L162"></a> 162     <em class="comment">//</em>
<a id="L163" name="L163"></a> 163 
<div class="comment">
      Puts the specified grammar into the grammar pool and associates it to
      its root element name or its target namespace.
      @param grammar The Grammar.</div>
<a id="L170" name="L170"></a> 170     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25312.html" title="Multiple referred from 23 places.">putGrammar</a>(<a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> grammar) <em class="brace">{</em>
<a id="L171" name="L171"></a> 171         <strong class="reserved">if</strong>(!fPoolIsLocked) <em class="brace">{</em>
<a id="L172" name="L172"></a> 172             <strong class="reserved">synchronized</strong> (fGrammars) <em class="brace">{</em>
<a id="L173" name="L173"></a> 173                 <a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc = grammar.<a href="../D/19353.html" title="Multiple defined in 5 places.">getGrammarDescription</a>();
<a id="L174" name="L174"></a> 174                 <strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> = <a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>(desc);
<a id="L175" name="L175"></a> 175                 <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = (<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> &amp; 0x7FFFFFFF) % fGrammars.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L176" name="L176"></a> 176                 <strong class="reserved">for</strong> (<a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a> entry = fGrammars[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>]; entry != <strong class="reserved">null</strong>; entry = entry.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L177" name="L177"></a> 177                     <strong class="reserved">if</strong> (entry.<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> == <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> &amp;&amp; <a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(entry.desc, desc)) <em class="brace">{</em>
<a id="L178" name="L178"></a> 178                         entry.grammar = grammar;
<a id="L179" name="L179"></a> 179                         <strong class="reserved">return</strong>;
<a id="L180" name="L180"></a> 180                     <em class="brace">}</em>
<a id="L181" name="L181"></a> 181                 <em class="brace">}</em>
<a id="L182" name="L182"></a> 182                 <em class="comment">// create a new entry</em>
<a id="L183" name="L183"></a> 183                 <a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a> entry = <strong class="reserved">new</strong> <a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a>(<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>, desc, grammar, fGrammars[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>]);
<a id="L184" name="L184"></a> 184                 fGrammars[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>] = entry;
<a id="L185" name="L185"></a> 185                 fGrammarCount++;
<a id="L186" name="L186"></a> 186             <em class="brace">}</em>
<a id="L187" name="L187"></a> 187         <em class="brace">}</em>
<a id="L188" name="L188"></a> 188     <em class="brace">}</em> <em class="comment">// putGrammar(Grammar)</em>
<a id="L189" name="L189"></a> 189 
<div class="comment">
      Returns the grammar associated to the specified grammar description.
      Currently, the root element name is used as the key for DTD grammars
      and the target namespace  is used as the key for Schema grammars.
      @param desc The Grammar Description.</div>
<a id="L197" name="L197"></a> 197     <strong class="reserved">public</strong> <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> <a href="../R/16800.html" title="Multiple referred from 37 places.">getGrammar</a>(<a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc) <em class="brace">{</em>
<a id="L198" name="L198"></a> 198         <strong class="reserved">synchronized</strong> (fGrammars) <em class="brace">{</em>
<a id="L199" name="L199"></a> 199             <strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> = <a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>(desc);
<a id="L200" name="L200"></a> 200         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = (<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> &amp; 0x7FFFFFFF) % fGrammars.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L201" name="L201"></a> 201         <strong class="reserved">for</strong> (<a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a> entry = fGrammars[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>] ; entry != <strong class="reserved">null</strong> ; entry = entry.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L202" name="L202"></a> 202             <strong class="reserved">if</strong> ((entry.<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> == <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>) &amp;&amp; <a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(entry.desc, desc)) <em class="brace">{</em>
<a id="L203" name="L203"></a> 203                 <strong class="reserved">return</strong> entry.grammar;
<a id="L204" name="L204"></a> 204             <em class="brace">}</em>
<a id="L205" name="L205"></a> 205         <em class="brace">}</em>
<a id="L206" name="L206"></a> 206         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L207" name="L207"></a> 207     <em class="brace">}</em>
<a id="L208" name="L208"></a> 208     <em class="brace">}</em> <em class="comment">// getGrammar(XMLGrammarDescription):Grammar</em>
<a id="L209" name="L209"></a> 209 
<div class="comment">
      Removes the grammar associated to the specified grammar description from the
      grammar pool and returns the removed grammar. Currently, the root element name
      is used as the key for DTD grammars and the target namespace  is used
      as the key for Schema grammars.
      @param desc The Grammar Description.
      @return     The removed grammar.</div>
<a id="L219" name="L219"></a> 219     <strong class="reserved">public</strong> <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> removeGrammar(<a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc) <em class="brace">{</em>
<a id="L220" name="L220"></a> 220         <strong class="reserved">synchronized</strong> (fGrammars) <em class="brace">{</em>
<a id="L221" name="L221"></a> 221             <strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> = <a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>(desc);
<a id="L222" name="L222"></a> 222         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = (<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> &amp; 0x7FFFFFFF) % fGrammars.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L223" name="L223"></a> 223         <strong class="reserved">for</strong> (<a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a> entry = fGrammars[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>], prev = <strong class="reserved">null</strong> ; entry != <strong class="reserved">null</strong> ; prev = entry, entry = entry.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L224" name="L224"></a> 224             <strong class="reserved">if</strong> ((entry.<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> == <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>) &amp;&amp; <a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(entry.desc, desc)) <em class="brace">{</em>
<a id="L225" name="L225"></a> 225                 <strong class="reserved">if</strong> (prev != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L226" name="L226"></a> 226                         prev.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = entry.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L227" name="L227"></a> 227             <em class="brace">}</em>
<a id="L228" name="L228"></a> 228             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L229" name="L229"></a> 229                 fGrammars[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>] = entry.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L230" name="L230"></a> 230             <em class="brace">}</em>
<a id="L231" name="L231"></a> 231                 <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> tempGrammar = entry.grammar;
<a id="L232" name="L232"></a> 232                 entry.grammar = <strong class="reserved">null</strong>;
<a id="L233" name="L233"></a> 233                 fGrammarCount--;
<a id="L234" name="L234"></a> 234                 <strong class="reserved">return</strong> tempGrammar;
<a id="L235" name="L235"></a> 235             <em class="brace">}</em>
<a id="L236" name="L236"></a> 236         <em class="brace">}</em>
<a id="L237" name="L237"></a> 237         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L238" name="L238"></a> 238         <em class="brace">}</em>
<a id="L239" name="L239"></a> 239     <em class="brace">}</em> <em class="comment">// removeGrammar(XMLGrammarDescription):Grammar</em>
<a id="L240" name="L240"></a> 240 
<div class="comment">
      Returns true if the grammar pool contains a grammar associated
      to the specified grammar description. Currently, the root element name
      is used as the key for DTD grammars and the target namespace  is used
      as the key for Schema grammars.
      @param desc The Grammar Description.</div>
<a id="L249" name="L249"></a> 249     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/11961.html" title="Multiple referred from 2 places.">containsGrammar</a>(<a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc) <em class="brace">{</em>
<a id="L250" name="L250"></a> 250         <strong class="reserved">synchronized</strong> (fGrammars) <em class="brace">{</em>
<a id="L251" name="L251"></a> 251             <strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> = <a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>(desc);
<a id="L252" name="L252"></a> 252         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = (<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> &amp; 0x7FFFFFFF) % fGrammars.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L253" name="L253"></a> 253         <strong class="reserved">for</strong> (<a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a> entry = fGrammars[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>] ; entry != <strong class="reserved">null</strong> ; entry = entry.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L254" name="L254"></a> 254             <strong class="reserved">if</strong> ((entry.<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> == <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>) &amp;&amp; <a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(entry.desc, desc)) <em class="brace">{</em>
<a id="L255" name="L255"></a> 255                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L256" name="L256"></a> 256             <em class="brace">}</em>
<a id="L257" name="L257"></a> 257         <em class="brace">}</em>
<a id="L258" name="L258"></a> 258         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L259" name="L259"></a> 259     <em class="brace">}</em>
<a id="L260" name="L260"></a> 260     <em class="brace">}</em> <em class="comment">// containsGrammar(XMLGrammarDescription):boolean</em>
<a id="L261" name="L261"></a> 261 
<div class="comment">
 <p> Sets this grammar pool to a "locked" state--i.e.,
      no new grammars will be added until it is "unlocked".</p></div>
<a id="L265" name="L265"></a> 265     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/22671.html" title="Multiple referred from 3 places.">lockPool</a>() <em class="brace">{</em>
<a id="L266" name="L266"></a> 266         fPoolIsLocked = <strong class="reserved">true</strong>;
<a id="L267" name="L267"></a> 267     <em class="brace">}</em> <em class="comment">// lockPool()</em>
<a id="L268" name="L268"></a> 268 
<div class="comment">
 <p> Sets this grammar pool to an "unlocked" state--i.e.,
      new grammars will be added when putGrammar or cacheGrammars
      are called.</p></div>
<a id="L273" name="L273"></a> 273     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/29714.html" title="Multiple referred from 3 places.">unlockPool</a>() <em class="brace">{</em>
<a id="L274" name="L274"></a> 274         fPoolIsLocked = <strong class="reserved">false</strong>;
<a id="L275" name="L275"></a> 275     <em class="brace">}</em> <em class="comment">// unlockPool()</em>
<a id="L276" name="L276"></a> 276 
<div class="comment">
      <p>This method clears the pool-i.e., removes references
      to all the grammars in it.</p></div>
<a id="L281" name="L281"></a> 281     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11497.html" title="Multiple referred from 522 places.">clear</a>() <em class="brace">{</em>
<a id="L282" name="L282"></a> 282         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i=0; i&lt;fGrammars.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L283" name="L283"></a> 283             <strong class="reserved">if</strong>(fGrammars[i] != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L284" name="L284"></a> 284                 fGrammars[i].<a href="../D/12817.html" title="Multiple defined in 199 places.">clear</a>();
<a id="L285" name="L285"></a> 285                 fGrammars[i] = <strong class="reserved">null</strong>;
<a id="L286" name="L286"></a> 286             <em class="brace">}</em>
<a id="L287" name="L287"></a> 287         <em class="brace">}</em>
<a id="L288" name="L288"></a> 288         fGrammarCount = 0;
<a id="L289" name="L289"></a> 289     <em class="brace">}</em> <em class="comment">// clear()</em>
<a id="L290" name="L290"></a> 290 
<div class="comment">
      This method checks whether two grammars are the same. Currently, we compare
      the root element names for DTD grammars and the target namespaces for Schema grammars.
      The application can override this behaviour and add its own logic.
      @param desc1 The grammar description
      @param desc2 The grammar description of the grammar to be compared to
      @return      True if the grammars are equal, otherwise false</div>
<a id="L300" name="L300"></a> 300     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13992.html" title="Multiple referred from 5400 places.">equals</a>(<a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc1, <a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc2) <em class="brace">{</em>
<a id="L301" name="L301"></a> 301         <strong class="reserved">return</strong> desc1.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(desc2);
<a id="L302" name="L302"></a> 302     <em class="brace">}</em>
<a id="L303" name="L303"></a> 303 
<div class="comment">
      Returns the hash code value for the given grammar description.
      @param desc The grammar description
      @return     The hash code value</div>
<a id="L310" name="L310"></a> 310     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/20298.html" title="Multiple referred from 715 places.">hashCode</a>(<a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc) <em class="brace">{</em>
<a id="L311" name="L311"></a> 311         <strong class="reserved">return</strong> desc.<a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>();
<a id="L312" name="L312"></a> 312     <em class="brace">}</em>
<a id="L313" name="L313"></a> 313 
<div class="comment">
      This class is a grammar pool entry. Each entry acts as a node
      in a linked list.</div>
<a id="L318" name="L318"></a> 318     <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/2694.html" title="Multiple referred from 1260 places.">Entry</a> <em class="brace">{</em>
<a id="L319" name="L319"></a> 319         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>;
<a id="L320" name="L320"></a> 320         <strong class="reserved">public</strong> <a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc;
<a id="L321" name="L321"></a> 321         <strong class="reserved">public</strong> <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> grammar;
<a id="L322" name="L322"></a> 322         <strong class="reserved">public</strong> <a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L323" name="L323"></a> 323 
<a id="L324" name="L324"></a> 324         <strong class="reserved">protected</strong> <a href="../D/2925.html" title="Multiple defined in 20 places.">Entry</a>(<strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>, <a href="../S/5514.html#L31" title="Defined at 31 in src/com/sun/org/apache/xerces/internal/xni/grammars/XMLGrammarDescription.java.">XMLGrammarDescription</a> desc, <a href="../S/5511.html#L48" title="Defined at 48 in src/com/sun/org/apache/xerces/internal/xni/grammars/Grammar.java.">Grammar</a> grammar, Entry <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L325" name="L325"></a> 325             <strong class="reserved">this</strong>.<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> = <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>;
<a id="L326" name="L326"></a> 326             <strong class="reserved">this</strong>.desc = desc;
<a id="L327" name="L327"></a> 327             <strong class="reserved">this</strong>.grammar = grammar;
<a id="L328" name="L328"></a> 328             <strong class="reserved">this</strong>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L329" name="L329"></a> 329         <em class="brace">}</em>
<a id="L330" name="L330"></a> 330 
<a id="L331" name="L331"></a> 331         <em class="comment">// clear this entry; useful to promote garbage collection</em>
<a id="L332" name="L332"></a> 332         <em class="comment">// since reduces reference count of objects to be destroyed</em>
<a id="L333" name="L333"></a> 333         <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/11497.html" title="Multiple referred from 522 places.">clear</a> () <em class="brace">{</em>
<a id="L334" name="L334"></a> 334             desc = <strong class="reserved">null</strong>;
<a id="L335" name="L335"></a> 335             grammar = <strong class="reserved">null</strong>;
<a id="L336" name="L336"></a> 336             <strong class="reserved">if</strong>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L337" name="L337"></a> 337                 <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>.<a href="../D/12817.html" title="Multiple defined in 199 places.">clear</a>();
<a id="L338" name="L338"></a> 338                 <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = <strong class="reserved">null</strong>;
<a id="L339" name="L339"></a> 339             <em class="brace">}</em>
<a id="L340" name="L340"></a> 340         <em class="brace">}</em> <em class="comment">// clear()</em>
<a id="L341" name="L341"></a> 341     <em class="brace">}</em> <em class="comment">// class Entry</em>
<a id="L342" name="L342"></a> 342 
<div class="comment">
     /* For DTD build we can't import here XSDDescription. Thus, this method is commented out.. */</div>
<div class="comment">
 public void print(XMLGrammarDescription description){
        if(description.getGrammarType().equals(XMLGrammarDescription.XML_DTD)){
        }
        else if(description.getGrammarType().equals(XMLGrammarDescription.XML_SCHEMA)){
            XSDDescription schema = (XSDDescription)description ;
            System.out.println("Context = " + schema.getContextType());
            System.out.println("TargetNamespace = " + schema.getTargetNamespace());
            String [] temp = schema.getLocationHints();
            for (int i = 0 ; (temp != null &amp;&amp; i &lt; temp.length) ; i++){
                System.out.println("LocationHint " + i + " = "+ temp[i]);
            }
            System.out.println("Triggering Component = " + schema.getTriggeringComponent());
            System.out.println("EnclosingElementName =" + schema.getEnclosingElementName());
        }
    }//print</div>
<a id="L365" name="L365"></a> 365 
<a id="L366" name="L366"></a> 366 <em class="brace">}</em> <em class="comment">// class XMLGrammarPoolImpl</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L96">[^]</a><a href="#L333">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>