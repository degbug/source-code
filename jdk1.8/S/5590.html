<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L241">[^]</a><a href="#L517">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L241" title="Defined at 241.">findAccessControllerClass</a></li>
<li><a href="#L275" title="Defined at 275.">getDefaultMethodProperties</a></li>
<li><a href="#L368" title="Defined at 368.">loadPropertiesFile</a></li>
<li><a href="#L517" title="Defined at 517.">fixupPropertyString</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: OutputPropertiesFactory.java,v 1.2.4.1 2005/09/15 08:15:21 suresh_emailid Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xml.internal.serializer;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.utils.SecuritySupport;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> java.io.BufferedInputStream;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.io.IOException;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.InputStream;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.security.AccessController;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.security.PrivilegedAction;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.util.Enumeration;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> java.util.Properties;
<a id="L33" name="L33"></a>  33 
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> javax.xml.transform.OutputKeys;
<a id="L35" name="L35"></a>  35 
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.serializer.utils.MsgKey;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.serializer.utils.Utils;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.serializer.utils.WrappedRuntimeException;
<a id="L39" name="L39"></a>  39 
<div class="comment">
  This class is a factory to generate a set of default properties
  of key/value pairs that are used to create a serializer through the
  factory {@link SerializerFactory SerilizerFactory}.
  The properties generated by this factory
  may be modified to non-default values before the SerializerFactory is used to
  create a Serializer.
  <p>
  The given output types supported are "xml", "text", and "html".
  These type strings can be obtained from the
  {@link Method Method} class in this package.
  </p><p>
  Other constants defined in this class are the non-standard property keys
  that can be used to set non-standard property values on a java.util.Properties object
  that is used to create or configure a serializer. Here are the non-standard keys:
  </p><ul><li> <b>S_KEY_INDENT_AMOUNT </b> -
  The non-standard property key to use to set the indentation amount.
  The "indent" key needs to have a value of "yes", and this
  properties value is a the number of whitespaces to indent by per
  indentation level.
  </li><li> <b>S_KEY_CONTENT_HANDLER </b> -
  This non-standard property key is used to set the name of the fully qualified
  Java class that implements the ContentHandler interface.
  The output of the serializer will be SAX events sent to this an
  object of this class.
  </li><li> <b>S_KEY_ENTITIES </b> -
  This non-standard property key is used to specify the name of the property file
  that specifies character to entity reference mappings. A line in such a
  file is has the name of the entity and the numeric (base 10) value
  of the corresponding character, like this one: <br> quot=34 <br>
  </li><li> <b>S_USE_URL_ESCAPING </b> -
  This non-standard property key is used to set a value of "yes" if the href values for HTML serialization should
   use %xx escaping.
  </li><li> <b>S_OMIT_META_TAG </b> -
  This non-standard property key is used to set a value of "yes" if the META tag should be omitted where it would
   otherwise be supplied.
  </li></ul>
  @see SerializerFactory
  @see Method
  @see Serializer</div>
<a id="L87" name="L87"></a>  87 <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/5873.html" title="Multiple referred from 24 places.">OutputPropertiesFactory</a>
<a id="L88" name="L88"></a>  88 <em class="brace">{</em>
<div class="comment">
 S_BUILTIN_EXTENSIONS_URL is a mnemonic for the XML Namespace
     (http://xml.apache.org/xalan) predefined to signify Xalan's
      built-in XSLT Extensions. When used in stylesheets, this is often
      bound to the "xalan:" prefix.</div>
<a id="L94" name="L94"></a>  94     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>
<a id="L95" name="L95"></a>  95       S_BUILTIN_EXTENSIONS_URL = "http://xml.apache.org/xalan";
<a id="L96" name="L96"></a>  96 
<div class="comment">
      The old built-in extension url. It is still supported for
      backward compatibility.</div>
<a id="L101" name="L101"></a> 101     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>
<a id="L102" name="L102"></a> 102       S_BUILTIN_OLD_EXTENSIONS_URL = "http://xml.apache.org/xslt";
<a id="L103" name="L103"></a> 103 
<a id="L104" name="L104"></a> 104     <em class="comment">//************************************************************</em>
<a id="L105" name="L105"></a> 105     <em class="comment">//*  PUBLIC CONSTANTS</em>
<a id="L106" name="L106"></a> 106     <em class="comment">//************************************************************</em>
<div class="comment">
      This is not a public API.
      This is the built-in extensions namespace,
      reexpressed in {namespaceURI} syntax
      suitable for prepending to a localname to produce a "universal
      name".</div>
<a id="L114" name="L114"></a> 114     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_BUILTIN_EXTENSIONS_UNIVERSAL =
<a id="L115" name="L115"></a> 115         "{" + S_BUILTIN_EXTENSIONS_URL + "}";
<a id="L116" name="L116"></a> 116 
<a id="L117" name="L117"></a> 117     <em class="comment">// Some special Xalan keys.</em>
<a id="L118" name="L118"></a> 118 
<div class="comment">
      The non-standard property key to use to set the
      number of whitepaces to indent by, per indentation level,
      if indent="yes".</div>
<a id="L124" name="L124"></a> 124     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_KEY_INDENT_AMOUNT =
<a id="L125" name="L125"></a> 125         S_BUILTIN_EXTENSIONS_UNIVERSAL + "indent-amount";
<a id="L126" name="L126"></a> 126 
<div class="comment">
      The non-standard property key to use to set the
      number of whitepaces to indent by, per indentation level,
      if indent="yes".</div>
<a id="L132" name="L132"></a> 132     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_KEY_LINE_SEPARATOR =
<a id="L133" name="L133"></a> 133         S_BUILTIN_EXTENSIONS_UNIVERSAL + "line-separator";
<a id="L134" name="L134"></a> 134 
<div class="comment">
 This non-standard property key is used to set the name of the fully qualified
      Java class that implements the ContentHandler interface.
      Fully qualified name of class with a default constructor that
       implements the ContentHandler interface, where the result tree events
       will be sent to.</div>
<a id="L141" name="L141"></a> 141 
<a id="L142" name="L142"></a> 142     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_KEY_CONTENT_HANDLER =
<a id="L143" name="L143"></a> 143         S_BUILTIN_EXTENSIONS_UNIVERSAL + "content-handler";
<a id="L144" name="L144"></a> 144 
<div class="comment">
      This non-standard property key is used to specify the name of the property file
      that specifies character to entity reference mappings.</div>
<a id="L149" name="L149"></a> 149     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_KEY_ENTITIES =
<a id="L150" name="L150"></a> 150         S_BUILTIN_EXTENSIONS_UNIVERSAL + "entities";
<a id="L151" name="L151"></a> 151 
<div class="comment">
      This non-standard property key is used to set a value of "yes" if the href values for HTML serialization should
     *  use %xx escaping. </div>
<a id="L155" name="L155"></a> 155     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_USE_URL_ESCAPING =
<a id="L156" name="L156"></a> 156         S_BUILTIN_EXTENSIONS_UNIVERSAL + "use-url-escaping";
<a id="L157" name="L157"></a> 157 
<div class="comment">
      This non-standard property key is used to set a value of "yes" if the META tag should be omitted where it would
       otherwise be supplied.</div>
<a id="L162" name="L162"></a> 162     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_OMIT_META_TAG =
<a id="L163" name="L163"></a> 163         S_BUILTIN_EXTENSIONS_UNIVERSAL + "omit-meta-tag";
<a id="L164" name="L164"></a> 164 
<div class="comment">
      The old built-in extension namespace, this is not a public API.</div>
<a id="L168" name="L168"></a> 168     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_BUILTIN_OLD_EXTENSIONS_UNIVERSAL =
<a id="L169" name="L169"></a> 169         "{" + S_BUILTIN_OLD_EXTENSIONS_URL + "}";
<a id="L170" name="L170"></a> 170 
<div class="comment">
      This is not a public API, it is only public because it is used
      by outside of this package,
      it is the length of the old built-in extension namespace.</div>
<a id="L176" name="L176"></a> 176     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> S_BUILTIN_OLD_EXTENSIONS_UNIVERSAL_LEN =
<a id="L177" name="L177"></a> 177         S_BUILTIN_OLD_EXTENSIONS_UNIVERSAL.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L178" name="L178"></a> 178 
<div class="comment">
      This non-standard, Oracle-impl only property key is used as if OutputKeys.STANDALONE is specified but
      without writing it out in the declaration; It can be used to reverse the change by Xalan patch 1495.
      Since Xalan patch 1495 can cause incompatible behavior, this property is add for application to neutralize
      the effect of Xalan patch 1495</div>
<div class="comment">
          <p>Is Standalone</p>
          <ul><li>
              <code>yes</code> to indicate the output is intended to be used as standalone
            </li><li>
              <code>no</code> has no effect.
            </li>
          </ul></div>
<a id="L197" name="L197"></a> 197     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> ORACLE_IS_STANDALONE = "http://www.oracle.com/xml/is-standalone";
<a id="L198" name="L198"></a> 198 
<a id="L199" name="L199"></a> 199     <em class="comment">//************************************************************</em>
<a id="L200" name="L200"></a> 200     <em class="comment">//*  PRIVATE CONSTANTS</em>
<a id="L201" name="L201"></a> 201     <em class="comment">//************************************************************</em>
<a id="L202" name="L202"></a> 202 
<a id="L203" name="L203"></a> 203     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_XSLT_PREFIX = "xslt.output.";
<a id="L204" name="L204"></a> 204     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> S_XSLT_PREFIX_LEN = S_XSLT_PREFIX.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L205" name="L205"></a> 205     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> S_XALAN_PREFIX = "org.apache.xslt.";
<a id="L206" name="L206"></a> 206     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> S_XALAN_PREFIX_LEN = S_XALAN_PREFIX.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L207" name="L207"></a> 207 
<div class="comment">
     /** Synchronization object for lazy initialization of the above tables. */</div>
<a id="L209" name="L209"></a> 209     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a> m_synch_object = <strong class="reserved">new</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>(1);
<a id="L210" name="L210"></a> 210 
<div class="comment">
     /** the directory in which the various method property files are located */</div>
<a id="L212" name="L212"></a> 212     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> PROP_DIR = "com/sun/org/apache/xml/internal/serializer/";
<div class="comment">
     /** property file for default XML properties */</div>
<a id="L214" name="L214"></a> 214     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> PROP_FILE_XML = "output_xml.properties";
<div class="comment">
     /** property file for default TEXT properties */</div>
<a id="L216" name="L216"></a> 216     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> PROP_FILE_TEXT = "output_text.properties";
<div class="comment">
     /** property file for default HTML properties */</div>
<a id="L218" name="L218"></a> 218     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> PROP_FILE_HTML = "output_html.properties";
<div class="comment">
     /** property file for default UNKNOWN (Either XML or HTML, to be determined later) properties */</div>
<a id="L220" name="L220"></a> 220     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> PROP_FILE_UNKNOWN = "output_unknown.properties";
<a id="L221" name="L221"></a> 221 
<a id="L222" name="L222"></a> 222     <em class="comment">//************************************************************</em>
<a id="L223" name="L223"></a> 223     <em class="comment">//*  PRIVATE STATIC FIELDS</em>
<a id="L224" name="L224"></a> 224     <em class="comment">//************************************************************</em>
<a id="L225" name="L225"></a> 225 
<div class="comment">
     /** The default properties of all output files. */</div>
<a id="L227" name="L227"></a> 227     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> m_xml_properties = <strong class="reserved">null</strong>;
<a id="L228" name="L228"></a> 228 
<div class="comment">
     /** The default properties when method="html". */</div>
<a id="L230" name="L230"></a> 230     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> m_html_properties = <strong class="reserved">null</strong>;
<a id="L231" name="L231"></a> 231 
<div class="comment">
     /** The default properties when method="text". */</div>
<a id="L233" name="L233"></a> 233     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> m_text_properties = <strong class="reserved">null</strong>;
<a id="L234" name="L234"></a> 234 
<div class="comment">
     /** The properties when method="" for the "unknown" wrapper */</div>
<a id="L236" name="L236"></a> 236     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> m_unknown_properties = <strong class="reserved">null</strong>;
<a id="L237" name="L237"></a> 237 
<a id="L238" name="L238"></a> 238     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>
<a id="L239" name="L239"></a> 239         ACCESS_CONTROLLER_CLASS = <a href="../S/5590.html#L241" title="Defined at 241 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">findAccessControllerClass</a>();
<a id="L240" name="L240"></a> 240 
<a id="L241" name="L241"></a> 241     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a> <a href="../S/5590.html#L239" title="Referred from 239 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">findAccessControllerClass</a>() <em class="brace">{</em>
<a id="L242" name="L242"></a> 242         <strong class="reserved">try</strong>
<a id="L243" name="L243"></a> 243         <em class="brace">{</em>
<a id="L244" name="L244"></a> 244             <em class="comment">// This Class was introduced in JDK 1.2. With the re-architecture of</em>
<a id="L245" name="L245"></a> 245             <em class="comment">// security mechanism ( starting in JDK 1.2 ), we have option of</em>
<a id="L246" name="L246"></a> 246             <em class="comment">// giving privileges to certain part of code using doPrivileged block.</em>
<a id="L247" name="L247"></a> 247             <em class="comment">// In JDK1.1.X applications won't be having security manager and if</em>
<a id="L248" name="L248"></a> 248             <em class="comment">// there is security manager ( in applets ), code need to be signed</em>
<a id="L249" name="L249"></a> 249             <em class="comment">// and trusted for having access to resources.</em>
<a id="L250" name="L250"></a> 250 
<a id="L251" name="L251"></a> 251             <strong class="reserved">return</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>.<a href="../D/16518.html" title="Multiple defined in 6 places.">forName</a>("java.security.AccessController");
<a id="L252" name="L252"></a> 252         <em class="brace">}</em>
<a id="L253" name="L253"></a> 253         <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e)
<a id="L254" name="L254"></a> 254         <em class="brace">{</em>
<a id="L255" name="L255"></a> 255             <em class="comment">//User may be using older JDK ( JDK &lt;1.2 ). Allow him/her to use it.</em>
<a id="L256" name="L256"></a> 256             <em class="comment">// But don't try to use doPrivileged</em>
<a id="L257" name="L257"></a> 257         <em class="brace">}</em>
<a id="L258" name="L258"></a> 258 
<a id="L259" name="L259"></a> 259         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L260" name="L260"></a> 260     <em class="brace">}</em>
<a id="L261" name="L261"></a> 261 
<div class="comment">
      Creates an empty OutputProperties with the property key/value defaults specified by
      a property file.  The method argument is used to construct a string of
      the form output_[method].properties (for instance, output_html.properties).
      The output_xml.properties file is always used as the base.
      <p>Anything other than 'text', 'xml', and 'html', will
      use the output_xml.properties file.</p>
      @param   method non-null reference to method name.
      @return Properties object that holds the defaults for the given method.</div>
<a id="L275" name="L275"></a> 275     <strong class="reserved">static</strong> <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> <a href="../R/16047.html" title="Multiple referred from 6 places.">getDefaultMethodProperties</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> method)
<a id="L276" name="L276"></a> 276     <em class="brace">{</em>
<a id="L277" name="L277"></a> 277         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fileName = <strong class="reserved">null</strong>;
<a id="L278" name="L278"></a> 278         <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> defaultProperties = <strong class="reserved">null</strong>;
<a id="L279" name="L279"></a> 279         <em class="comment">// According to this article : Double-check locking does not work</em>
<a id="L280" name="L280"></a> 280         <em class="comment">// http://www.javaworld.com/javaworld/jw-02-2001/jw-0209-toolbox.html</em>
<a id="L281" name="L281"></a> 281         <strong class="reserved">try</strong>
<a id="L282" name="L282"></a> 282         <em class="brace">{</em>
<a id="L283" name="L283"></a> 283             <strong class="reserved">synchronized</strong> (m_synch_object)
<a id="L284" name="L284"></a> 284             <em class="brace">{</em>
<a id="L285" name="L285"></a> 285                 <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == m_xml_properties) <em class="comment">// double check</em>
<a id="L286" name="L286"></a> 286                 <em class="brace">{</em>
<a id="L287" name="L287"></a> 287                     fileName = PROP_FILE_XML;
<a id="L288" name="L288"></a> 288                     m_xml_properties = <a href="../S/5590.html#L368" title="Defined at 368 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">loadPropertiesFile</a>(fileName, <strong class="reserved">null</strong>);
<a id="L289" name="L289"></a> 289                 <em class="brace">}</em>
<a id="L290" name="L290"></a> 290             <em class="brace">}</em>
<a id="L291" name="L291"></a> 291 
<a id="L292" name="L292"></a> 292             <strong class="reserved">if</strong> (method.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a>.XML))
<a id="L293" name="L293"></a> 293             <em class="brace">{</em>
<a id="L294" name="L294"></a> 294                 defaultProperties = m_xml_properties;
<a id="L295" name="L295"></a> 295             <em class="brace">}</em>
<a id="L296" name="L296"></a> 296             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (method.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a>.<a href="../D/3655.html" title="Multiple defined in 2 places.">HTML</a>))
<a id="L297" name="L297"></a> 297             <em class="brace">{</em>
<a id="L298" name="L298"></a> 298                 <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == m_html_properties) <em class="comment">// double check</em>
<a id="L299" name="L299"></a> 299                 <em class="brace">{</em>
<a id="L300" name="L300"></a> 300                     fileName = PROP_FILE_HTML;
<a id="L301" name="L301"></a> 301                     m_html_properties =
<a id="L302" name="L302"></a> 302                         <a href="../S/5590.html#L368" title="Defined at 368 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">loadPropertiesFile</a>(fileName, m_xml_properties);
<a id="L303" name="L303"></a> 303                 <em class="brace">}</em>
<a id="L304" name="L304"></a> 304 
<a id="L305" name="L305"></a> 305                 defaultProperties = m_html_properties;
<a id="L306" name="L306"></a> 306             <em class="brace">}</em>
<a id="L307" name="L307"></a> 307             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (method.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a>.TEXT))
<a id="L308" name="L308"></a> 308             <em class="brace">{</em>
<a id="L309" name="L309"></a> 309                 <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == m_text_properties) <em class="comment">// double check</em>
<a id="L310" name="L310"></a> 310                 <em class="brace">{</em>
<a id="L311" name="L311"></a> 311                     fileName = PROP_FILE_TEXT;
<a id="L312" name="L312"></a> 312                     m_text_properties =
<a id="L313" name="L313"></a> 313                         <a href="../S/5590.html#L368" title="Defined at 368 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">loadPropertiesFile</a>(fileName, m_xml_properties);
<a id="L314" name="L314"></a> 314                     <strong class="reserved">if</strong> (<strong class="reserved">null</strong>
<a id="L315" name="L315"></a> 315                         == m_text_properties.<a href="../D/21720.html" title="Multiple defined in 77 places.">getProperty</a>(<a href="../S/4048.html#L37" title="Defined at 37 in src/javax/xml/transform/OutputKeys.java.">OutputKeys</a>.ENCODING))
<a id="L316" name="L316"></a> 316                     <em class="brace">{</em>
<a id="L317" name="L317"></a> 317                         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> mimeEncoding = <a href="../D/2874.html" title="Multiple defined in 2 places.">Encodings</a>.<a href="../S/5600.html#L212" title="Defined at 212 in src/com/sun/org/apache/xml/internal/serializer/Encodings.java.">getMimeEncoding</a>(<strong class="reserved">null</strong>);
<a id="L318" name="L318"></a> 318                         m_text_properties.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(
<a id="L319" name="L319"></a> 319                             <a href="../S/4048.html#L37" title="Defined at 37 in src/javax/xml/transform/OutputKeys.java.">OutputKeys</a>.ENCODING,
<a id="L320" name="L320"></a> 320                             mimeEncoding);
<a id="L321" name="L321"></a> 321                     <em class="brace">}</em>
<a id="L322" name="L322"></a> 322                 <em class="brace">}</em>
<a id="L323" name="L323"></a> 323 
<a id="L324" name="L324"></a> 324                 defaultProperties = m_text_properties;
<a id="L325" name="L325"></a> 325             <em class="brace">}</em>
<a id="L326" name="L326"></a> 326             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (method.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(com.sun.org.apache.xml.internal.serializer.<a href="../D/5605.html" title="Multiple defined in 4 places.">Method</a>.<a href="../D/9240.html" title="Multiple defined in 3 places.">UNKNOWN</a>))
<a id="L327" name="L327"></a> 327             <em class="brace">{</em>
<a id="L328" name="L328"></a> 328                 <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == m_unknown_properties) <em class="comment">// double check</em>
<a id="L329" name="L329"></a> 329                 <em class="brace">{</em>
<a id="L330" name="L330"></a> 330                     fileName = PROP_FILE_UNKNOWN;
<a id="L331" name="L331"></a> 331                     m_unknown_properties =
<a id="L332" name="L332"></a> 332                         <a href="../S/5590.html#L368" title="Defined at 368 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">loadPropertiesFile</a>(fileName, m_xml_properties);
<a id="L333" name="L333"></a> 333                 <em class="brace">}</em>
<a id="L334" name="L334"></a> 334 
<a id="L335" name="L335"></a> 335                 defaultProperties = m_unknown_properties;
<a id="L336" name="L336"></a> 336             <em class="brace">}</em>
<a id="L337" name="L337"></a> 337             <strong class="reserved">else</strong>
<a id="L338" name="L338"></a> 338             <em class="brace">{</em>
<a id="L339" name="L339"></a> 339                 <em class="comment">// TODO: Calculate res file from name.</em>
<a id="L340" name="L340"></a> 340                 defaultProperties = m_xml_properties;
<a id="L341" name="L341"></a> 341             <em class="brace">}</em>
<a id="L342" name="L342"></a> 342         <em class="brace">}</em>
<a id="L343" name="L343"></a> 343         <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> ioe)
<a id="L344" name="L344"></a> 344         <em class="brace">{</em>
<a id="L345" name="L345"></a> 345             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/9772.html" title="Multiple defined in 2 places.">WrappedRuntimeException</a>(
<a id="L346" name="L346"></a> 346                 <a href="../D/9445.html" title="Multiple defined in 2 places.">Utils</a>.messages.<a href="../D/14043.html" title="Multiple defined in 4 places.">createMessage</a>(
<a id="L347" name="L347"></a> 347                     <a href="../S/5578.html#L34" title="Defined at 34 in src/com/sun/org/apache/xml/internal/serializer/utils/MsgKey.java.">MsgKey</a>.ER_COULD_NOT_LOAD_METHOD_PROPERTY,
<a id="L348" name="L348"></a> 348                     <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <em class="brace">{</em> fileName, method <em class="brace">}</em>),
<a id="L349" name="L349"></a> 349                 ioe);
<a id="L350" name="L350"></a> 350         <em class="brace">}</em>
<a id="L351" name="L351"></a> 351         <em class="comment">// wrap these cached defaultProperties in a new Property object just so</em>
<a id="L352" name="L352"></a> 352         <em class="comment">// that the caller of this method can't modify the default values</em>
<a id="L353" name="L353"></a> 353         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a>(defaultProperties);
<a id="L354" name="L354"></a> 354     <em class="brace">}</em>
<a id="L355" name="L355"></a> 355 
<div class="comment">
      Load the properties file from a resource stream.  If a
      key name such as "org.apache.xslt.xxx", fix up the start of
      string to be a curly namespace.  If a key name starts with
      "xslt.output.xxx", clip off "xslt.output.".  If a key name *or* a
      key value is discovered, check for \u003a in the text, and
      fix it up to be ":", since earlier versions of the JDK do not
      handle the escape sequence (at least in key names).
      @param resourceName non-null reference to resource name.
      @param defaults Default properties, which may be null.</div>
<a id="L368" name="L368"></a> 368     <strong class="reserved">static</strong> <strong class="reserved">private</strong> <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> <a href="../R/22612.html" title="Multiple referred from 4 places.">loadPropertiesFile</a>(
<a id="L369" name="L369"></a> 369         <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> resourceName,
<a id="L370" name="L370"></a> 370         <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> defaults)
<a id="L371" name="L371"></a> 371         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L372" name="L372"></a> 372     <em class="brace">{</em>
<a id="L373" name="L373"></a> 373 
<a id="L374" name="L374"></a> 374         <em class="comment">// This static method should eventually be moved to a thread-specific class</em>
<a id="L375" name="L375"></a> 375         <em class="comment">// so that we can cache the ContextClassLoader and bottleneck all properties file</em>
<a id="L376" name="L376"></a> 376         <em class="comment">// loading throughout Xalan.</em>
<a id="L377" name="L377"></a> 377 
<a id="L378" name="L378"></a> 378         <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a> props = <strong class="reserved">new</strong> <a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a>(defaults);
<a id="L379" name="L379"></a> 379 
<a id="L380" name="L380"></a> 380         <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/25134.html" title="Multiple defined in 5 places.">is</a> = <strong class="reserved">null</strong>;
<a id="L381" name="L381"></a> 381         <a href="../S/1411.html#L51" title="Defined at 51 in src/java/io/BufferedInputStream.java.">BufferedInputStream</a> bis = <strong class="reserved">null</strong>;
<a id="L382" name="L382"></a> 382 
<a id="L383" name="L383"></a> 383         <strong class="reserved">try</strong>
<a id="L384" name="L384"></a> 384         <em class="brace">{</em>
<a id="L385" name="L385"></a> 385             <strong class="reserved">if</strong> (ACCESS_CONTROLLER_CLASS != <strong class="reserved">null</strong>)
<a id="L386" name="L386"></a> 386             <em class="brace">{</em>
<a id="L387" name="L387"></a> 387                 <a href="../D/25134.html" title="Multiple defined in 5 places.">is</a> = (<a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a>) <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>
<a id="L388" name="L388"></a> 388                     .<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<strong class="reserved">new</strong> <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>() <em class="brace">{</em>
<a id="L389" name="L389"></a> 389                         <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>()
<a id="L390" name="L390"></a> 390                         <em class="brace">{</em>
<a id="L391" name="L391"></a> 391                             <strong class="reserved">return</strong> <a href="../S/5590.html#L87" title="Defined at 87 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">OutputPropertiesFactory</a>.<strong class="reserved">class</strong>
<a id="L392" name="L392"></a> 392                                 .<a href="../D/22045.html" title="Multiple defined in 30 places.">getResourceAsStream</a>(resourceName);
<a id="L393" name="L393"></a> 393                         <em class="brace">}</em>
<a id="L394" name="L394"></a> 394                     <em class="brace">}</em>);
<a id="L395" name="L395"></a> 395             <em class="brace">}</em>
<a id="L396" name="L396"></a> 396             <strong class="reserved">else</strong>
<a id="L397" name="L397"></a> 397             <em class="brace">{</em>
<a id="L398" name="L398"></a> 398                 <em class="comment">// User may be using older JDK ( JDK &lt; 1.2 )</em>
<a id="L399" name="L399"></a> 399                 <a href="../D/25134.html" title="Multiple defined in 5 places.">is</a> = <a href="../S/5590.html#L87" title="Defined at 87 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">OutputPropertiesFactory</a>.<strong class="reserved">class</strong>
<a id="L400" name="L400"></a> 400                     .<a href="../D/22045.html" title="Multiple defined in 30 places.">getResourceAsStream</a>(resourceName);
<a id="L401" name="L401"></a> 401             <em class="brace">}</em>
<a id="L402" name="L402"></a> 402 
<a id="L403" name="L403"></a> 403             bis = <strong class="reserved">new</strong> <a href="../S/1411.html#L51" title="Defined at 51 in src/java/io/BufferedInputStream.java.">BufferedInputStream</a>(<a href="../D/25134.html" title="Multiple defined in 5 places.">is</a>);
<a id="L404" name="L404"></a> 404             props.<a href="../D/26888.html" title="Multiple defined in 27 places.">load</a>(bis);
<a id="L405" name="L405"></a> 405         <em class="brace">}</em>
<a id="L406" name="L406"></a> 406         <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> ioe)
<a id="L407" name="L407"></a> 407         <em class="brace">{</em>
<a id="L408" name="L408"></a> 408             <strong class="reserved">if</strong> (defaults == <strong class="reserved">null</strong>)
<a id="L409" name="L409"></a> 409             <em class="brace">{</em>
<a id="L410" name="L410"></a> 410                 <strong class="reserved">throw</strong> ioe;
<a id="L411" name="L411"></a> 411             <em class="brace">}</em>
<a id="L412" name="L412"></a> 412             <strong class="reserved">else</strong>
<a id="L413" name="L413"></a> 413             <em class="brace">{</em>
<a id="L414" name="L414"></a> 414                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/9772.html" title="Multiple defined in 2 places.">WrappedRuntimeException</a>(
<a id="L415" name="L415"></a> 415                     <a href="../D/9445.html" title="Multiple defined in 2 places.">Utils</a>.messages.<a href="../D/14043.html" title="Multiple defined in 4 places.">createMessage</a>(
<a id="L416" name="L416"></a> 416                         <a href="../S/5578.html#L34" title="Defined at 34 in src/com/sun/org/apache/xml/internal/serializer/utils/MsgKey.java.">MsgKey</a>.ER_COULD_NOT_LOAD_RESOURCE,
<a id="L417" name="L417"></a> 417                         <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <em class="brace">{</em> resourceName <em class="brace">}</em>),
<a id="L418" name="L418"></a> 418                     ioe);
<a id="L419" name="L419"></a> 419                 <em class="comment">//"Could not load '"+resourceName+"' (check CLASSPATH), now using just the defaults ", ioe);</em>
<a id="L420" name="L420"></a> 420             <em class="brace">}</em>
<a id="L421" name="L421"></a> 421         <em class="brace">}</em>
<a id="L422" name="L422"></a> 422         <strong class="reserved">catch</strong> (<a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> se)
<a id="L423" name="L423"></a> 423         <em class="brace">{</em>
<a id="L424" name="L424"></a> 424             <em class="comment">// Repeat IOException handling for sandbox/applet case -sc</em>
<a id="L425" name="L425"></a> 425             <strong class="reserved">if</strong> (defaults == <strong class="reserved">null</strong>)
<a id="L426" name="L426"></a> 426             <em class="brace">{</em>
<a id="L427" name="L427"></a> 427                 <strong class="reserved">throw</strong> se;
<a id="L428" name="L428"></a> 428             <em class="brace">}</em>
<a id="L429" name="L429"></a> 429             <strong class="reserved">else</strong>
<a id="L430" name="L430"></a> 430             <em class="brace">{</em>
<a id="L431" name="L431"></a> 431                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/9772.html" title="Multiple defined in 2 places.">WrappedRuntimeException</a>(
<a id="L432" name="L432"></a> 432                     <a href="../D/9445.html" title="Multiple defined in 2 places.">Utils</a>.messages.<a href="../D/14043.html" title="Multiple defined in 4 places.">createMessage</a>(
<a id="L433" name="L433"></a> 433                         <a href="../S/5578.html#L34" title="Defined at 34 in src/com/sun/org/apache/xml/internal/serializer/utils/MsgKey.java.">MsgKey</a>.ER_COULD_NOT_LOAD_RESOURCE,
<a id="L434" name="L434"></a> 434                         <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <em class="brace">{</em> resourceName <em class="brace">}</em>),
<a id="L435" name="L435"></a> 435                     se);
<a id="L436" name="L436"></a> 436                 <em class="comment">//"Could not load '"+resourceName+"' (check CLASSPATH, applet security), now using just the defaults ", se);</em>
<a id="L437" name="L437"></a> 437             <em class="brace">}</em>
<a id="L438" name="L438"></a> 438         <em class="brace">}</em>
<a id="L439" name="L439"></a> 439         <strong class="reserved">finally</strong>
<a id="L440" name="L440"></a> 440         <em class="brace">{</em>
<a id="L441" name="L441"></a> 441             <strong class="reserved">if</strong> (bis != <strong class="reserved">null</strong>)
<a id="L442" name="L442"></a> 442             <em class="brace">{</em>
<a id="L443" name="L443"></a> 443                 bis.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L444" name="L444"></a> 444             <em class="brace">}</em>
<a id="L445" name="L445"></a> 445             <strong class="reserved">if</strong> (<a href="../D/25134.html" title="Multiple defined in 5 places.">is</a> != <strong class="reserved">null</strong>)
<a id="L446" name="L446"></a> 446             <em class="brace">{</em>
<a id="L447" name="L447"></a> 447                 <a href="../D/25134.html" title="Multiple defined in 5 places.">is</a>.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L448" name="L448"></a> 448             <em class="brace">}</em>
<a id="L449" name="L449"></a> 449         <em class="brace">}</em>
<a id="L450" name="L450"></a> 450 
<a id="L451" name="L451"></a> 451         <em class="comment">// Note that we're working at the HashTable level here,</em>
<a id="L452" name="L452"></a> 452         <em class="comment">// and not at the Properties level!  This is important</em>
<a id="L453" name="L453"></a> 453         <em class="comment">// because we don't want to modify the default properties.</em>
<a id="L454" name="L454"></a> 454         <em class="comment">// NB: If fixupPropertyString ends up changing the property</em>
<a id="L455" name="L455"></a> 455         <em class="comment">// name or value, we need to remove the old key and re-add</em>
<a id="L456" name="L456"></a> 456         <em class="comment">// with the new key and value.  However, then our Enumeration</em>
<a id="L457" name="L457"></a> 457         <em class="comment">// could lose its place in the HashTable.  So, we first</em>
<a id="L458" name="L458"></a> 458         <em class="comment">// clone the HashTable and enumerate over that since the</em>
<a id="L459" name="L459"></a> 459         <em class="comment">// clone will not change.  When we migrate to Collections,</em>
<a id="L460" name="L460"></a> 460         <em class="comment">// this code should be revisited and cleaned up to use</em>
<a id="L461" name="L461"></a> 461         <em class="comment">// an Iterator which may (or may not) alleviate the need for</em>
<a id="L462" name="L462"></a> 462         <em class="comment">// the clone.  Many thanks to Padraig O'hIceadha</em>
<a id="L463" name="L463"></a> 463         <em class="comment">// &lt;padraig@gradient.ie&gt; for finding this problem.  Bugzilla 2000.</em>
<a id="L464" name="L464"></a> 464 
<a id="L465" name="L465"></a> 465         <a href="../S/1134.html#L61" title="Defined at 61 in src/java/util/Enumeration.java.">Enumeration</a> <a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a> = ((<a href="../S/1039.html#L122" title="Defined at 122 in src/java/util/Properties.java.">Properties</a>) props.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>()).<a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>();
<a id="L466" name="L466"></a> 466         <strong class="reserved">while</strong> (<a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>())
<a id="L467" name="L467"></a> 467         <em class="brace">{</em>
<a id="L468" name="L468"></a> 468             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) <a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>();
<a id="L469" name="L469"></a> 469             <em class="comment">// Now check if the given key was specified as a</em>
<a id="L470" name="L470"></a> 470             <em class="comment">// System property. If so, the system property</em>
<a id="L471" name="L471"></a> 471             <em class="comment">// overides the default value in the propery file.</em>
<a id="L472" name="L472"></a> 472             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = <strong class="reserved">null</strong>;
<a id="L473" name="L473"></a> 473             <strong class="reserved">try</strong>
<a id="L474" name="L474"></a> 474             <em class="brace">{</em>
<a id="L475" name="L475"></a> 475                 <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = <a href="../D/7684.html" title="Multiple defined in 12 places.">SecuritySupport</a>.<a href="../D/22922.html" title="Multiple defined in 24 places.">getSystemProperty</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>);
<a id="L476" name="L476"></a> 476             <em class="brace">}</em>
<a id="L477" name="L477"></a> 477             <strong class="reserved">catch</strong> (<a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> se)
<a id="L478" name="L478"></a> 478             <em class="brace">{</em>
<a id="L479" name="L479"></a> 479                 <em class="comment">// No-op for sandbox/applet case, leave null -sc</em>
<a id="L480" name="L480"></a> 480             <em class="brace">}</em>
<a id="L481" name="L481"></a> 481             <strong class="reserved">if</strong> (<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> == <strong class="reserved">null</strong>)
<a id="L482" name="L482"></a> 482                 <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) props.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>);
<a id="L483" name="L483"></a> 483 
<a id="L484" name="L484"></a> 484             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> newKey = <a href="../S/5590.html#L517" title="Defined at 517 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">fixupPropertyString</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>, <strong class="reserved">true</strong>);
<a id="L485" name="L485"></a> 485             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> newValue = <strong class="reserved">null</strong>;
<a id="L486" name="L486"></a> 486             <strong class="reserved">try</strong>
<a id="L487" name="L487"></a> 487             <em class="brace">{</em>
<a id="L488" name="L488"></a> 488                 newValue = <a href="../D/7684.html" title="Multiple defined in 12 places.">SecuritySupport</a>.<a href="../D/22922.html" title="Multiple defined in 24 places.">getSystemProperty</a>(newKey);
<a id="L489" name="L489"></a> 489             <em class="brace">}</em>
<a id="L490" name="L490"></a> 490             <strong class="reserved">catch</strong> (<a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> se)
<a id="L491" name="L491"></a> 491             <em class="brace">{</em>
<a id="L492" name="L492"></a> 492                 <em class="comment">// No-op for sandbox/applet case, leave null -sc</em>
<a id="L493" name="L493"></a> 493             <em class="brace">}</em>
<a id="L494" name="L494"></a> 494             <strong class="reserved">if</strong> (newValue == <strong class="reserved">null</strong>)
<a id="L495" name="L495"></a> 495                 newValue = <a href="../S/5590.html#L517" title="Defined at 517 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">fixupPropertyString</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>, <strong class="reserved">false</strong>);
<a id="L496" name="L496"></a> 496             <strong class="reserved">else</strong>
<a id="L497" name="L497"></a> 497                 newValue = <a href="../S/5590.html#L517" title="Defined at 517 in src/com/sun/org/apache/xml/internal/serializer/OutputPropertiesFactory.java.">fixupPropertyString</a>(newValue, <strong class="reserved">false</strong>);
<a id="L498" name="L498"></a> 498 
<a id="L499" name="L499"></a> 499             <strong class="reserved">if</strong> (<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> != newKey || <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> != newValue)
<a id="L500" name="L500"></a> 500             <em class="brace">{</em>
<a id="L501" name="L501"></a> 501                 props.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>);
<a id="L502" name="L502"></a> 502                 props.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(newKey, newValue);
<a id="L503" name="L503"></a> 503             <em class="brace">}</em>
<a id="L504" name="L504"></a> 504 
<a id="L505" name="L505"></a> 505         <em class="brace">}</em>
<a id="L506" name="L506"></a> 506 
<a id="L507" name="L507"></a> 507         <strong class="reserved">return</strong> props;
<a id="L508" name="L508"></a> 508     <em class="brace">}</em>
<a id="L509" name="L509"></a> 509 
<div class="comment">
      Fix up a string in an output properties file according to
      the rules of {@link #loadPropertiesFile}.
      @param s non-null reference to string that may need to be fixed up.
      @return A new string if fixup occured, otherwise the s argument.</div>
<a id="L517" name="L517"></a> 517     <strong class="reserved">static</strong> <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/14668.html" title="Multiple referred from 3 places.">fixupPropertyString</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <strong class="reserved">boolean</strong> doClipping)
<a id="L518" name="L518"></a> 518     <em class="brace">{</em>
<a id="L519" name="L519"></a> 519         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L520" name="L520"></a> 520         <strong class="reserved">if</strong> (doClipping &amp;&amp; s.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>(S_XSLT_PREFIX))
<a id="L521" name="L521"></a> 521         <em class="brace">{</em>
<a id="L522" name="L522"></a> 522             s = s.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(S_XSLT_PREFIX_LEN);
<a id="L523" name="L523"></a> 523         <em class="brace">}</em>
<a id="L524" name="L524"></a> 524         <strong class="reserved">if</strong> (s.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>(S_XALAN_PREFIX))
<a id="L525" name="L525"></a> 525         <em class="brace">{</em>
<a id="L526" name="L526"></a> 526             s =
<a id="L527" name="L527"></a> 527                 S_BUILTIN_EXTENSIONS_UNIVERSAL
<a id="L528" name="L528"></a> 528                     + s.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(S_XALAN_PREFIX_LEN);
<a id="L529" name="L529"></a> 529         <em class="brace">}</em>
<a id="L530" name="L530"></a> 530         <strong class="reserved">if</strong> ((<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = s.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>("\\u003a")) &gt; 0)
<a id="L531" name="L531"></a> 531         <em class="brace">{</em>
<a id="L532" name="L532"></a> 532             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> temp = s.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> + 6);
<a id="L533" name="L533"></a> 533             s = s.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) + ":" + temp;
<a id="L534" name="L534"></a> 534 
<a id="L535" name="L535"></a> 535         <em class="brace">}</em>
<a id="L536" name="L536"></a> 536         <strong class="reserved">return</strong> s;
<a id="L537" name="L537"></a> 537     <em class="brace">}</em>
<a id="L538" name="L538"></a> 538 
<a id="L539" name="L539"></a> 539 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L241">[^]</a><a href="#L517">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>