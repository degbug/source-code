<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/time/zone/ZoneRulesProvider.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L198">[^]</a><a href="#L435">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L198" title="Defined at 198.">getAvailableZoneIds</a></li>
<li><a href="#L225" title="Defined at 225.">getRules</a></li>
<li><a href="#L254" title="Defined at 254.">getVersions</a></li>
<li><a href="#L266" title="Defined at 266.">getProvider</a></li>
<li><a href="#L293" title="Defined at 293.">registerProvider</a></li>
<li><a href="#L305" title="Defined at 305.">registerProvider0</a></li>
<li><a href="#L340" title="Defined at 340.">refresh</a></li>
<li><a href="#L367" title="Defined at 367.">provideZoneIds</a></li>
<li><a href="#L395" title="Defined at 395.">provideRules</a></li>
<li><a href="#L420" title="Defined at 420.">provideVersions</a></li>
<li><a href="#L435" title="Defined at 435.">provideRefresh</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2012, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<div class="comment">
  Copyright (c) 2009-2012, Stephen Colebourne &amp; Michael Nascimento Santos
  All rights reserved.
  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:
   * Redistributions of source code must retain the above copyright notice,
     this list of conditions and the following disclaimer.
   * Redistributions in binary form must reproduce the above copyright notice,
     this list of conditions and the following disclaimer in the documentation
     and/or other materials provided with the distribution.
   * Neither the name of JSR-310 nor the names of its contributors
     may be used to endorse or promote products derived from this software
     without specific prior written permission.
  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</div>
<a id="L62" name="L62"></a>  62 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.<a href="../D/35330.html" title="Multiple defined in 2 places.">time</a>.<a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>;
<a id="L63" name="L63"></a>  63 
<a id="L64" name="L64"></a>  64 <strong class="reserved">import</strong> java.security.AccessController;
<a id="L65" name="L65"></a>  65 <strong class="reserved">import</strong> java.security.PrivilegedAction;
<a id="L66" name="L66"></a>  66 <strong class="reserved">import</strong> java.time.ZoneId;
<a id="L67" name="L67"></a>  67 <strong class="reserved">import</strong> java.time.ZonedDateTime;
<a id="L68" name="L68"></a>  68 <strong class="reserved">import</strong> java.util.ArrayList;
<a id="L69" name="L69"></a>  69 <strong class="reserved">import</strong> java.util.HashSet;
<a id="L70" name="L70"></a>  70 <strong class="reserved">import</strong> java.util.Iterator;
<a id="L71" name="L71"></a>  71 <strong class="reserved">import</strong> java.util.List;
<a id="L72" name="L72"></a>  72 <strong class="reserved">import</strong> java.util.NavigableMap;
<a id="L73" name="L73"></a>  73 <strong class="reserved">import</strong> java.util.Objects;
<a id="L74" name="L74"></a>  74 <strong class="reserved">import</strong> java.util.ServiceConfigurationError;
<a id="L75" name="L75"></a>  75 <strong class="reserved">import</strong> java.util.ServiceLoader;
<a id="L76" name="L76"></a>  76 <strong class="reserved">import</strong> java.util.Set;
<a id="L77" name="L77"></a>  77 <strong class="reserved">import</strong> java.util.concurrent.ConcurrentHashMap;
<a id="L78" name="L78"></a>  78 <strong class="reserved">import</strong> java.util.concurrent.ConcurrentMap;
<a id="L79" name="L79"></a>  79 <strong class="reserved">import</strong> java.util.concurrent.CopyOnWriteArrayList;
<a id="L80" name="L80"></a>  80 
<div class="comment">
  Provider of time-zone rules to the system.
  <p>
  This class manages the configuration of time-zone rules.
  The static methods provide the public API that can be used to manage the providers.
  The abstract methods provide the SPI that allows rules to be provided.
  </p><p>
  ZoneRulesProvider may be installed in an instance of the Java Platform as
  extension classes, that is, jar files placed into any of the usual extension
  directories. Installed providers are loaded using the service-provider loading
  facility defined by the <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a> class. A ZoneRulesProvider
  identifies itself with a provider configuration file named
  <code>java.time.zone.ZoneRulesProvider</code> in the resource directory
  <code>META-INF/services</code>. The file should contain a line that specifies the
  fully qualified concrete zonerules-provider class name.
  Providers may also be made available by adding them to the class path or by
  registering themselves via <a href="#L293" title="Defined at 293.">registerProvider</a> method.
  </p><p>
  The Java virtual machine has a default provider that provides zone rules
  for the time-zones defined by IANA Time Zone Database (TZDB). If the system
  property <code>java.time.zone.DefaultZoneRulesProvider</code> is defined then
  it is taken to be the fully-qualified name of a concrete ZoneRulesProvider
  class to be loaded as the default provider, using the system class loader.
  If this system property is not defined, a system-default provider will be
  loaded to serve as the default provider.
  </p><p>
  Rules are looked up primarily by zone ID, as used by {@link ZoneId}.
  Only zone region IDs may be used, zone offset IDs are not used here.
  </p><p>
  Time-zone rules are political, thus the data can change at any time.
  Each provider will provide the latest rules for each zone ID, but they
  may also provide the history of how the rules changed.
  @implSpec
  This interface is a service provider that can be called by multiple threads.
  Implementations must be immutable and thread-safe.
  </p><p>
  Providers must ensure that once a rule has been seen by the application, the
  rule must continue to be available.
  </p><p>
  Providers are encouraged to implement a meaningful <code>toString</code> method.
  </p><p>
  Many systems would like to update time-zone rules dynamically without stopping the JVM.
  When examined in detail, this is a complex problem.
  Providers may choose to handle dynamic updates, however the default provider does not.
  @since 1.8</p></div>
<a id="L129" name="L129"></a> 129 <strong class="reserved">public</strong> <strong class="reserved">abstract</strong> <strong class="reserved">class</strong> <a href="../R/9352.html" title="Multiple referred from 23 places.">ZoneRulesProvider</a> <em class="brace">{</em>
<a id="L130" name="L130"></a> 130 
<div class="comment">
      The set of loaded providers.</div>
<a id="L134" name="L134"></a> 134     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1072.html#L91" title="Defined at 91 in src/java/util/concurrent/CopyOnWriteArrayList.java.">CopyOnWriteArrayList</a>&lt;<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a>&gt; PROVIDERS = <strong class="reserved">new</strong> <a href="../S/1072.html#L91" title="Defined at 91 in src/java/util/concurrent/CopyOnWriteArrayList.java.">CopyOnWriteArrayList</a>&lt;&gt;();
<div class="comment">
      The lookup from zone ID to provider.</div>
<a id="L138" name="L138"></a> 138     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1110.html#L63" title="Defined at 63 in src/java/util/concurrent/ConcurrentMap.java.">ConcurrentMap</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>, <a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a>&gt; ZONES = <strong class="reserved">new</strong> <a href="../S/1074.html#L267" title="Defined at 267 in src/java/util/concurrent/ConcurrentHashMap.java.">ConcurrentHashMap</a>&lt;&gt;(512, 0.75f, 2);
<a id="L139" name="L139"></a> 139 
<a id="L140" name="L140"></a> 140     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L141" name="L141"></a> 141         <em class="comment">// if the property java.time.zone.DefaultZoneRulesProvider is</em>
<a id="L142" name="L142"></a> 142         <em class="comment">// set then its value is the class name of the default provider</em>
<a id="L143" name="L143"></a> 143         <strong class="reserved">final</strong> <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a>&gt; loaded = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;&gt;();
<a id="L144" name="L144"></a> 144         <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<strong class="reserved">new</strong> <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt;() <em class="brace">{</em>
<a id="L145" name="L145"></a> 145             <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>() <em class="brace">{</em>
<a id="L146" name="L146"></a> 146                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> prop = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../D/21720.html" title="Multiple defined in 77 places.">getProperty</a>("java.time.zone.DefaultZoneRulesProvider");
<a id="L147" name="L147"></a> 147                 <strong class="reserved">if</strong> (prop != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L148" name="L148"></a> 148                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L149" name="L149"></a> 149                         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>.<a href="../D/16518.html" title="Multiple defined in 6 places.">forName</a>(prop, <strong class="reserved">true</strong>, <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a>.<a href="../D/22895.html" title="Multiple defined in 7 places.">getSystemClassLoader</a>());
<a id="L150" name="L150"></a> 150                         <a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> = <a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a>.<strong class="reserved">class</strong>.<a href="../D/12274.html" title="Multiple defined in 6 places.">cast</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>.<a href="../D/28016.html" title="Multiple defined in 74 places.">newInstance</a>());
<a id="L151" name="L151"></a> 151                         <a href="../D/30587.html" title="Multiple defined in 2 places.">registerProvider</a>(<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L152" name="L152"></a> 152                         loaded.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L153" name="L153"></a> 153                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L154" name="L154"></a> 154                         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L155" name="L155"></a> 155                     <em class="brace">}</em>
<a id="L156" name="L156"></a> 156                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L157" name="L157"></a> 157                     <a href="../D/30587.html" title="Multiple defined in 2 places.">registerProvider</a>(<strong class="reserved">new</strong> <a href="../S/1525.html#L86" title="Defined at 86 in src/java/time/zone/TzdbZoneRulesProvider.java.">TzdbZoneRulesProvider</a>());
<a id="L158" name="L158"></a> 158                 <em class="brace">}</em>
<a id="L159" name="L159"></a> 159                 <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L160" name="L160"></a> 160             <em class="brace">}</em>
<a id="L161" name="L161"></a> 161         <em class="brace">}</em>);
<a id="L162" name="L162"></a> 162 
<a id="L163" name="L163"></a> 163         <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a>&lt;<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a>&gt; sl = <a href="../S/1190.html#L185" title="Defined at 185 in src/java/util/ServiceLoader.java.">ServiceLoader</a>.<a href="../D/26888.html" title="Multiple defined in 27 places.">load</a>(<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a>.<strong class="reserved">class</strong>, <a href="../D/1519.html" title="Multiple defined in 2 places.">ClassLoader</a>.<a href="../D/22895.html" title="Multiple defined in 7 places.">getSystemClassLoader</a>());
<a id="L164" name="L164"></a> 164         <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a>&gt; it = sl.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L165" name="L165"></a> 165         <strong class="reserved">while</strong> (it.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L166" name="L166"></a> 166             <a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>;
<a id="L167" name="L167"></a> 167             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L168" name="L168"></a> 168                 <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> = it.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L169" name="L169"></a> 169             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1155.html#L59" title="Defined at 59 in src/java/util/ServiceConfigurationError.java.">ServiceConfigurationError</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L170" name="L170"></a> 170                 <strong class="reserved">if</strong> (<a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>.<a href="../D/17525.html" title="Multiple defined in 41 places.">getCause</a>() <strong class="reserved">instanceof</strong> <a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a>) <em class="brace">{</em>
<a id="L171" name="L171"></a> 171                     <strong class="reserved">continue</strong>;  <em class="comment">// ignore the security exception, try the next provider</em>
<a id="L172" name="L172"></a> 172                 <em class="brace">}</em>
<a id="L173" name="L173"></a> 173                 <strong class="reserved">throw</strong> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>;
<a id="L174" name="L174"></a> 174             <em class="brace">}</em>
<a id="L175" name="L175"></a> 175             <strong class="reserved">boolean</strong> found = <strong class="reserved">false</strong>;
<a id="L176" name="L176"></a> 176             <strong class="reserved">for</strong> (<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> p : loaded) <em class="brace">{</em>
<a id="L177" name="L177"></a> 177                 <strong class="reserved">if</strong> (p.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>() == <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>()) <em class="brace">{</em>
<a id="L178" name="L178"></a> 178                     found = <strong class="reserved">true</strong>;
<a id="L179" name="L179"></a> 179                 <em class="brace">}</em>
<a id="L180" name="L180"></a> 180             <em class="brace">}</em>
<a id="L181" name="L181"></a> 181             <strong class="reserved">if</strong> (!found) <em class="brace">{</em>
<a id="L182" name="L182"></a> 182                 <a href="../S/1519.html#L305" title="Defined at 305 in src/java/time/zone/ZoneRulesProvider.java.">registerProvider0</a>(<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L183" name="L183"></a> 183                 loaded.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L184" name="L184"></a> 184             <em class="brace">}</em>
<a id="L185" name="L185"></a> 185         <em class="brace">}</em>
<a id="L186" name="L186"></a> 186         <em class="comment">// CopyOnWriteList could be slow if lots of providers and each added individually</em>
<a id="L187" name="L187"></a> 187         PROVIDERS.<a href="../D/10646.html" title="Multiple defined in 78 places.">addAll</a>(loaded);
<a id="L188" name="L188"></a> 188     <em class="brace">}</em>
<a id="L189" name="L189"></a> 189 
<a id="L190" name="L190"></a> 190     <em class="comment">//-------------------------------------------------------------------------</em>
<div class="comment">
      Gets the set of available zone IDs.
      <p>
      These IDs are the string form of a {@link ZoneId}.
      @return a modifiable copy of the set of zone IDs, not null</p></div>
<a id="L198" name="L198"></a> 198     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; <a href="../R/15201.html" title="Multiple referred from 3 places.">getAvailableZoneIds</a>() <em class="brace">{</em>
<a id="L199" name="L199"></a> 199         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;&gt;(ZONES.<a href="../D/26719.html" title="Multiple defined in 33 places.">keySet</a>());
<a id="L200" name="L200"></a> 200     <em class="brace">}</em>
<a id="L201" name="L201"></a> 201 
<div class="comment">
      Gets the rules for the zone ID.
      <p>
      This returns the latest available rules for the zone ID.
      </p><p>
      This method relies on time-zone data provider files that are configured.
      These are loaded using a <code>ServiceLoader</code>.
      </p><p>
      The caching flag is designed to allow provider implementations to
      prevent the rules being cached in <code>ZoneId</code>.
      Under normal circumstances, the caching of zone rules is highly desirable
      as it will provide greater performance. However, there is a use case where
      the caching would not be desirable, see <a href="#L395" title="Defined at 395.">provideRules</a>.
      @param zoneId the zone ID as defined by <code>ZoneId</code>, not null
      @param forCaching whether the rules are being queried for caching,
      true if the returned rules will be cached by <code>ZoneId</code>,
      false if they will be returned to the user without being cached in <code>ZoneId</code>
      @return the rules, null if <code>forCaching</code> is true and this
      is a dynamic provider that wants to prevent caching in <code>ZoneId</code>,
      otherwise not null
      @throws ZoneRulesException if rules cannot be obtained for the zone ID</p></div>
<a id="L225" name="L225"></a> 225     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1522.html#L110" title="Defined at 110 in src/java/time/zone/ZoneRules.java.">ZoneRules</a> <a href="../R/18809.html" title="Multiple referred from 32 places.">getRules</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>, <strong class="reserved">boolean</strong> forCaching) <em class="brace">{</em>
<a id="L226" name="L226"></a> 226         <a href="../S/859.html#L38" title="Defined at 38 in src/java/util/Objects.java.">Objects</a>.<a href="../D/31141.html" title="Multiple defined in 4 places.">requireNonNull</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>, "zoneId");
<a id="L227" name="L227"></a> 227         <strong class="reserved">return</strong> <a href="../D/21756.html" title="Multiple defined in 24 places.">getProvider</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>).<a href="../D/29906.html" title="Multiple defined in 2 places.">provideRules</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>, forCaching);
<a id="L228" name="L228"></a> 228     <em class="brace">}</em>
<a id="L229" name="L229"></a> 229 
<div class="comment">
      Gets the history of rules for the zone ID.
      <p>
      Time-zones are defined by governments and change frequently.
      This method allows applications to find the history of changes to the
      rules for a single zone ID. The map is keyed by a string, which is the
      version string associated with the rules.
      </p><p>
      The exact meaning and format of the version is provider specific.
      The version must follow lexicographical order, thus the returned map will
      be order from the oldest known rules to the newest available rules.
      The default 'TZDB' group uses version numbering consisting of the year
      followed by a letter, such as '2009e' or '2012f'.
      </p><p>
      Implementations must provide a result for each valid zone ID, however
      they do not have to provide a history of rules.
      Thus the map will always contain one element, and will only contain more
      than one element if historical rule information is available.
      @param zoneId  the zone ID as defined by <code>ZoneId</code>, not null
      @return a modifiable copy of the history of the rules for the ID, sorted
       from oldest to newest, not null
      @throws ZoneRulesException if history cannot be obtained for the zone ID</p></div>
<a id="L254" name="L254"></a> 254     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/862.html#L95" title="Defined at 95 in src/java/util/NavigableMap.java.">NavigableMap</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>, <a href="../S/1522.html#L110" title="Defined at 110 in src/java/time/zone/ZoneRules.java.">ZoneRules</a>&gt; getVersions(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>) <em class="brace">{</em>
<a id="L255" name="L255"></a> 255         <a href="../S/859.html#L38" title="Defined at 38 in src/java/util/Objects.java.">Objects</a>.<a href="../D/31141.html" title="Multiple defined in 4 places.">requireNonNull</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>, "zoneId");
<a id="L256" name="L256"></a> 256         <strong class="reserved">return</strong> <a href="../D/21756.html" title="Multiple defined in 24 places.">getProvider</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>).<a href="../D/29907.html" title="Multiple defined in 2 places.">provideVersions</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>);
<a id="L257" name="L257"></a> 257     <em class="brace">}</em>
<a id="L258" name="L258"></a> 258 
<div class="comment">
      Gets the provider for the zone ID.
      @param zoneId  the zone ID as defined by <code>ZoneId</code>, not null
      @return the provider, not null
      @throws ZoneRulesException if the zone ID is unknown</div>
<a id="L266" name="L266"></a> 266     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> <a href="../R/18534.html" title="Multiple referred from 23 places.">getProvider</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>) <em class="brace">{</em>
<a id="L267" name="L267"></a> 267         <a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> = ZONES.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>);
<a id="L268" name="L268"></a> 268         <strong class="reserved">if</strong> (<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L269" name="L269"></a> 269             <strong class="reserved">if</strong> (ZONES.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L270" name="L270"></a> 270                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1523.html#L72" title="Defined at 72 in src/java/time/zone/ZoneRulesException.java.">ZoneRulesException</a>("No time-zone data files registered");
<a id="L271" name="L271"></a> 271             <em class="brace">}</em>
<a id="L272" name="L272"></a> 272             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1523.html#L72" title="Defined at 72 in src/java/time/zone/ZoneRulesException.java.">ZoneRulesException</a>("Unknown time-zone ID: " + <a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>);
<a id="L273" name="L273"></a> 273         <em class="brace">}</em>
<a id="L274" name="L274"></a> 274         <strong class="reserved">return</strong> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>;
<a id="L275" name="L275"></a> 275     <em class="brace">}</em>
<a id="L276" name="L276"></a> 276 
<a id="L277" name="L277"></a> 277     <em class="comment">//-------------------------------------------------------------------------</em>
<div class="comment">
      Registers a zone rules provider.
      <p>
      This adds a new provider to those currently available.
      A provider supplies rules for one or more zone IDs.
      A provider cannot be registered if it supplies a zone ID that has already been
      registered. See the notes on time-zone IDs in {@link ZoneId}, especially
      the section on using the concept of a "group" to make IDs unique.
      </p><p>
      To ensure the integrity of time-zones already created, there is no way
      to deregister providers.
      @param provider  the provider to register, not null
      @throws ZoneRulesException if a zone ID is already registered</p></div>
<a id="L293" name="L293"></a> 293     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/25809.html" title="Multiple referred from 2 places.">registerProvider</a>(<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>) <em class="brace">{</em>
<a id="L294" name="L294"></a> 294         <a href="../S/859.html#L38" title="Defined at 38 in src/java/util/Objects.java.">Objects</a>.<a href="../D/31141.html" title="Multiple defined in 4 places.">requireNonNull</a>(<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>, "provider");
<a id="L295" name="L295"></a> 295         <a href="../S/1519.html#L305" title="Defined at 305 in src/java/time/zone/ZoneRulesProvider.java.">registerProvider0</a>(<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L296" name="L296"></a> 296         PROVIDERS.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L297" name="L297"></a> 297     <em class="brace">}</em>
<a id="L298" name="L298"></a> 298 
<div class="comment">
      Registers the provider.
      @param provider  the provider to register, not null
      @throws ZoneRulesException if unable to complete the registration</div>
<a id="L305" name="L305"></a> 305     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/25810.html" title="Multiple referred from 2 places.">registerProvider0</a>(<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>) <em class="brace">{</em>
<a id="L306" name="L306"></a> 306         <strong class="reserved">for</strong> (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a> : <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>.<a href="../D/29908.html" title="Multiple defined in 2 places.">provideZoneIds</a>()) <em class="brace">{</em>
<a id="L307" name="L307"></a> 307             <a href="../S/859.html#L38" title="Defined at 38 in src/java/util/Objects.java.">Objects</a>.<a href="../D/31141.html" title="Multiple defined in 4 places.">requireNonNull</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>, "zoneId");
<a id="L308" name="L308"></a> 308             <a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> old = ZONES.<a href="../D/30006.html" title="Multiple defined in 13 places.">putIfAbsent</a>(<a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>, <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L309" name="L309"></a> 309             <strong class="reserved">if</strong> (old != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L310" name="L310"></a> 310                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1523.html#L72" title="Defined at 72 in src/java/time/zone/ZoneRulesException.java.">ZoneRulesException</a>(
<a id="L311" name="L311"></a> 311                     "Unable to register zone as one already registered with that ID: " + <a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a> +
<a id="L312" name="L312"></a> 312                     ", currently loading from provider: " + <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>);
<a id="L313" name="L313"></a> 313             <em class="brace">}</em>
<a id="L314" name="L314"></a> 314         <em class="brace">}</em>
<a id="L315" name="L315"></a> 315     <em class="brace">}</em>
<a id="L316" name="L316"></a> 316 
<div class="comment">
      Refreshes the rules from the underlying data provider.
      <p>
      This method allows an application to request that the providers check
      for any updates to the provided rules.
      After calling this method, the offset stored in any {@link ZonedDateTime}
      may be invalid for the zone ID.
      </p><p>
      Dynamic update of rules is a complex problem and most applications
      should not use this method or dynamic rules.
      To achieve dynamic rules, a provider implementation will have to be written
      as per the specification of this class.
      In addition, instances of <code>ZoneRules</code> must not be cached in the
      application as they will become stale. However, the boolean flag on
      {@link #provideRules(String, boolean)} allows provider implementations
      to control the caching of <code>ZoneId</code>, potentially ensuring that
      all objects in the system see the new rules.
      Note that there is likely to be a cost in performance of a dynamic rules
      provider. Note also that no dynamic rules provider is in this specification.
      @return true if the rules were updated
      @throws ZoneRulesException if an error occurs during the refresh</p></div>
<a id="L340" name="L340"></a> 340     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/25739.html" title="Multiple referred from 7 places.">refresh</a>() <em class="brace">{</em>
<a id="L341" name="L341"></a> 341         <strong class="reserved">boolean</strong> <a href="../D/12315.html" title="Multiple defined in 4 places.">changed</a> = <strong class="reserved">false</strong>;
<a id="L342" name="L342"></a> 342         <strong class="reserved">for</strong> (<a href="../S/1519.html#L129" title="Defined at 129 in src/java/time/zone/ZoneRulesProvider.java.">ZoneRulesProvider</a> <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a> : PROVIDERS) <em class="brace">{</em>
<a id="L343" name="L343"></a> 343             <a href="../D/12315.html" title="Multiple defined in 4 places.">changed</a> |= <a href="../D/29909.html" title="Multiple defined in 12 places.">provider</a>.<a href="../S/1519.html#L435" title="Defined at 435 in src/java/time/zone/ZoneRulesProvider.java.">provideRefresh</a>();
<a id="L344" name="L344"></a> 344         <em class="brace">}</em>
<a id="L345" name="L345"></a> 345         <strong class="reserved">return</strong> <a href="../D/12315.html" title="Multiple defined in 4 places.">changed</a>;
<a id="L346" name="L346"></a> 346     <em class="brace">}</em>
<a id="L347" name="L347"></a> 347 
<div class="comment">
      Constructor.</div>
<a id="L351" name="L351"></a> 351     <strong class="reserved">protected</strong> ZoneRulesProvider() <em class="brace">{</em>
<a id="L352" name="L352"></a> 352     <em class="brace">}</em>
<a id="L353" name="L353"></a> 353 
<a id="L354" name="L354"></a> 354     <em class="comment">//-----------------------------------------------------------------------</em>
<div class="comment">
      SPI method to get the available zone IDs.
      <p>
      This obtains the IDs that this <code>ZoneRulesProvider</code> provides.
      A provider should provide data for at least one zone ID.
      </p><p>
      The returned zone IDs remain available and valid for the lifetime of the application.
      A dynamic provider may increase the set of IDs as more data becomes available.
      @return the set of zone IDs being provided, not null
      @throws ZoneRulesException if a problem occurs while providing the IDs</p></div>
<a id="L367" name="L367"></a> 367     <strong class="reserved">protected</strong> <strong class="reserved">abstract</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; <a href="../S/1519.html#L306" title="Referred from 306 in src/java/time/zone/ZoneRulesProvider.java.">provideZoneIds</a>();
<a id="L368" name="L368"></a> 368 
<div class="comment">
      SPI method to get the rules for the zone ID.
      <p>
      This loads the rules for the specified zone ID.
      The provider implementation must validate that the zone ID is valid and
      available, throwing a <code>ZoneRulesException</code> if it is not.
      The result of the method in the valid case depends on the caching flag.
      </p><p>
      If the provider implementation is not dynamic, then the result of the
      method must be the non-null set of rules selected by the ID.
      </p><p>
      If the provider implementation is dynamic, then the flag gives the option
      of preventing the returned rules from being cached in {@link ZoneId}.
      When the flag is true, the provider is permitted to return null, where
      null will prevent the rules from being cached in <code>ZoneId</code>.
      When the flag is false, the provider must return non-null rules.
      @param zoneId the zone ID as defined by <code>ZoneId</code>, not null
      @param forCaching whether the rules are being queried for caching,
      true if the returned rules will be cached by <code>ZoneId</code>,
      false if they will be returned to the user without being cached in <code>ZoneId</code>
      @return the rules, null if <code>forCaching</code> is true and this
      is a dynamic provider that wants to prevent caching in <code>ZoneId</code>,
      otherwise not null
      @throws ZoneRulesException if rules cannot be obtained for the zone ID</p></div>
<a id="L395" name="L395"></a> 395     <strong class="reserved">protected</strong> <strong class="reserved">abstract</strong> <a href="../S/1522.html#L110" title="Defined at 110 in src/java/time/zone/ZoneRules.java.">ZoneRules</a> <a href="../S/1519.html#L227" title="Referred from 227 in src/java/time/zone/ZoneRulesProvider.java.">provideRules</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>, <strong class="reserved">boolean</strong> forCaching);
<a id="L396" name="L396"></a> 396 
<div class="comment">
      SPI method to get the history of rules for the zone ID.
      <p>
      This returns a map of historical rules keyed by a version string.
      The exact meaning and format of the version is provider specific.
      The version must follow lexicographical order, thus the returned map will
      be order from the oldest known rules to the newest available rules.
      The default 'TZDB' group uses version numbering consisting of the year
      followed by a letter, such as '2009e' or '2012f'.
      </p><p>
      Implementations must provide a result for each valid zone ID, however
      they do not have to provide a history of rules.
      Thus the map will contain at least one element, and will only contain
      more than one element if historical rule information is available.
      </p><p>
      The returned versions remain available and valid for the lifetime of the application.
      A dynamic provider may increase the set of versions as more data becomes available.
      @param zoneId  the zone ID as defined by <code>ZoneId</code>, not null
      @return a modifiable copy of the history of the rules for the ID, sorted
       from oldest to newest, not null
      @throws ZoneRulesException if history cannot be obtained for the zone ID</p></div>
<a id="L420" name="L420"></a> 420     <strong class="reserved">protected</strong> <strong class="reserved">abstract</strong> <a href="../S/862.html#L95" title="Defined at 95 in src/java/util/NavigableMap.java.">NavigableMap</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>, <a href="../S/1522.html#L110" title="Defined at 110 in src/java/time/zone/ZoneRules.java.">ZoneRules</a>&gt; <a href="../S/1519.html#L256" title="Referred from 256 in src/java/time/zone/ZoneRulesProvider.java.">provideVersions</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1481.html#L167" title="Defined at 167 in src/java/time/temporal/TemporalQueries.java.">zoneId</a>);
<a id="L421" name="L421"></a> 421 
<div class="comment">
      SPI method to refresh the rules from the underlying data provider.
      <p>
      This method provides the opportunity for a provider to dynamically
      recheck the underlying data provider to find the latest rules.
      This could be used to load new rules without stopping the JVM.
      Dynamic behavior is entirely optional and most providers do not support it.
      </p><p>
      This implementation returns false.
      @return true if the rules were updated
      @throws ZoneRulesException if an error occurs during the refresh</p></div>
<a id="L435" name="L435"></a> 435     <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../S/1519.html#L343" title="Referred from 343 in src/java/time/zone/ZoneRulesProvider.java.">provideRefresh</a>() <em class="brace">{</em>
<a id="L436" name="L436"></a> 436         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L437" name="L437"></a> 437     <em class="brace">}</em>
<a id="L438" name="L438"></a> 438 
<a id="L439" name="L439"></a> 439 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L198">[^]</a><a href="#L435">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>