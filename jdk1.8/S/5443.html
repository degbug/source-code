<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xerces/internal/dom/NodeIteratorImpl.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L104">[^]</a><a href="#L369">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L104" title="Defined at 104.">getRoot</a></li>
<li><a href="#L113" title="Defined at 113.">getWhatToShow</a></li>
<li><a href="#L118" title="Defined at 118.">getFilter</a></li>
<li><a href="#L123" title="Defined at 123.">getExpandEntityReferences</a></li>
<li><a href="#L131" title="Defined at 131.">nextNode</a></li>
<li><a href="#L187" title="Defined at 187.">previousNode</a></li>
<li><a href="#L233" title="Defined at 233.">acceptNode</a></li>
<li><a href="#L244" title="Defined at 244.">matchNodeOrParent</a></li>
<li><a href="#L263" title="Defined at 263.">nextNode</a></li>
<li><a href="#L305" title="Defined at 305.">previousNode</a></li>
<li><a href="#L338" title="Defined at 338.">removeNode</a></li>
<li><a href="#L369" title="Defined at 369.">detach</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2002,2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
       http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<a id="L20" name="L20"></a>  20 
<a id="L21" name="L21"></a>  21 <strong class="reserved">package</strong> com.sun.org.apache.xerces.internal.dom;
<a id="L22" name="L22"></a>  22 
<a id="L23" name="L23"></a>  23 <strong class="reserved">import</strong> org.w3c.dom.DOMException;
<a id="L24" name="L24"></a>  24 <strong class="reserved">import</strong> org.w3c.dom.Node;
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> org.w3c.dom.traversal.NodeFilter;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> org.w3c.dom.traversal.NodeIterator;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 
<div class="comment">
 DefaultNodeIterator implements a NodeIterator, which iterates a
   DOM tree in the expected depth first way.
   <p>The whatToShow and filter functionality is implemented as expected.
   </p><p>This class also has method removeNode to enable iterator "fix-up"
   on DOM remove. It is expected that the DOM implementation call removeNode
   right before the actual DOM transformation. If not called by the DOM,
   the client could call it before doing the removal.
  @xerces.internal</p></div>
<a id="L42" name="L42"></a>  42 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/5556.html" title="Multiple referred from 2 places.">NodeIteratorImpl</a> <strong class="reserved">implements</strong> <a href="../D/6090.html" title="Multiple defined in 2 places.">NodeIterator</a> <em class="brace">{</em>
<a id="L43" name="L43"></a>  43 
<a id="L44" name="L44"></a>  44     <em class="comment">//</em>
<a id="L45" name="L45"></a>  45     <em class="comment">// Data</em>
<a id="L46" name="L46"></a>  46     <em class="comment">//</em>
<a id="L47" name="L47"></a>  47 
<div class="comment">
     /** The DocumentImpl which created this iterator, so it can be detached. */</div>
<a id="L49" name="L49"></a>  49     <strong class="reserved">private</strong> <a href="../S/5446.html#L82" title="Defined at 82 in src/com/sun/org/apache/xerces/internal/dom/DocumentImpl.java.">DocumentImpl</a> fDocument;
<div class="comment">
     /** The root. */</div>
<a id="L51" name="L51"></a>  51     <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> fRoot;
<div class="comment">
     /** The whatToShow mask. */</div>
<a id="L53" name="L53"></a>  53     <strong class="reserved">private</strong> <strong class="reserved">int</strong> fWhatToShow = <a href="../D/6087.html" title="Multiple defined in 2 places.">NodeFilter</a>.SHOW_ALL;
<div class="comment">
     /** The NodeFilter reference. */</div>
<a id="L55" name="L55"></a>  55     <strong class="reserved">private</strong> <a href="../D/6087.html" title="Multiple defined in 2 places.">NodeFilter</a> fNodeFilter;
<div class="comment">
     /** If detach is called, the fDetach flag is true, otherwise flase. */</div>
<a id="L57" name="L57"></a>  57     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> fDetach = <strong class="reserved">false</strong>;
<a id="L58" name="L58"></a>  58 
<a id="L59" name="L59"></a>  59     <em class="comment">//</em>
<a id="L60" name="L60"></a>  60     <em class="comment">// Iterator state - current node and direction.</em>
<a id="L61" name="L61"></a>  61     <em class="comment">//</em>
<a id="L62" name="L62"></a>  62     <em class="comment">// Note: The current node and direction are sufficient to implement</em>
<a id="L63" name="L63"></a>  63     <em class="comment">// the desired behaviour of the current pointer being _between_</em>
<a id="L64" name="L64"></a>  64     <em class="comment">// two nodes. The fCurrentNode is actually the last node returned,</em>
<a id="L65" name="L65"></a>  65     <em class="comment">// and the</em>
<a id="L66" name="L66"></a>  66     <em class="comment">// direction is whether the pointer is in front or behind this node.</em>
<a id="L67" name="L67"></a>  67     <em class="comment">// (usually akin to whether the node was returned via nextNode())</em>
<a id="L68" name="L68"></a>  68     <em class="comment">// (eg fForward = true) or previousNode() (eg fForward = false).</em>
<a id="L69" name="L69"></a>  69     <em class="comment">// Note also, if removing a Node, the fCurrentNode</em>
<a id="L70" name="L70"></a>  70     <em class="comment">// can be placed on a Node which would not pass filters.</em>
<a id="L71" name="L71"></a>  71 
<div class="comment">
     /** The last Node returned. */</div>
<a id="L73" name="L73"></a>  73     <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> fCurrentNode;
<a id="L74" name="L74"></a>  74 
<div class="comment">
 The direction of the iterator on the fCurrentNode.
       <pre>       nextNode()  ==      fForward = true;
       previousNode() ==   fForward = false;
       </pre></div>
<a id="L81" name="L81"></a>  81     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> fForward = <strong class="reserved">true</strong>;
<a id="L82" name="L82"></a>  82 
<div class="comment">
     /** When TRUE, the children of entites references are returned in the iterator. */</div>
<a id="L84" name="L84"></a>  84     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> fEntityReferenceExpansion;
<a id="L85" name="L85"></a>  85 
<a id="L86" name="L86"></a>  86     <em class="comment">//</em>
<a id="L87" name="L87"></a>  87     <em class="comment">// Constructor</em>
<a id="L88" name="L88"></a>  88     <em class="comment">//</em>
<a id="L89" name="L89"></a>  89 
<div class="comment">
     /** Public constructor */</div>
<a id="L91" name="L91"></a>  91     <strong class="reserved">public</strong> NodeIteratorImpl( <a href="../S/5446.html#L82" title="Defined at 82 in src/com/sun/org/apache/xerces/internal/dom/DocumentImpl.java.">DocumentImpl</a> <a href="../D/15104.html" title="Multiple defined in 4 places.">document</a>,
<a id="L92" name="L92"></a>  92                              <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../S/867.html#L1804" title="Defined at 1804 in src/java/util/HashMap.java.">root</a>,
<a id="L93" name="L93"></a>  93                              <strong class="reserved">int</strong> whatToShow,
<a id="L94" name="L94"></a>  94                              <a href="../D/6087.html" title="Multiple defined in 2 places.">NodeFilter</a> nodeFilter,
<a id="L95" name="L95"></a>  95                              <strong class="reserved">boolean</strong> entityReferenceExpansion) <em class="brace">{</em>
<a id="L96" name="L96"></a>  96         fDocument = <a href="../D/15104.html" title="Multiple defined in 4 places.">document</a>;
<a id="L97" name="L97"></a>  97         fRoot = <a href="../S/867.html#L1804" title="Defined at 1804 in src/java/util/HashMap.java.">root</a>;
<a id="L98" name="L98"></a>  98         fCurrentNode = <strong class="reserved">null</strong>;
<a id="L99" name="L99"></a>  99         fWhatToShow = whatToShow;
<a id="L100" name="L100"></a> 100         fNodeFilter = nodeFilter;
<a id="L101" name="L101"></a> 101         fEntityReferenceExpansion = entityReferenceExpansion;
<a id="L102" name="L102"></a> 102     <em class="brace">}</em>
<a id="L103" name="L103"></a> 103 
<a id="L104" name="L104"></a> 104     <strong class="reserved">public</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../R/18758.html" title="Multiple referred from 54 places.">getRoot</a>() <em class="brace">{</em>
<a id="L105" name="L105"></a> 105         <strong class="reserved">return</strong> fRoot;
<a id="L106" name="L106"></a> 106     <em class="brace">}</em>
<a id="L107" name="L107"></a> 107 
<a id="L108" name="L108"></a> 108     <em class="comment">// Implementation Note: Note that the iterator looks at whatToShow</em>
<a id="L109" name="L109"></a> 109     <em class="comment">// and filter values at each call, and therefore one _could_ add</em>
<a id="L110" name="L110"></a> 110     <em class="comment">// setters for these values and alter them while iterating!</em>
<a id="L111" name="L111"></a> 111 
<div class="comment">
     /** Return the whatToShow value */</div>
<a id="L113" name="L113"></a> 113     <strong class="reserved">public</strong> <strong class="reserved">int</strong>                <a href="../R/19853.html" title="Multiple referred from 27 places.">getWhatToShow</a>() <em class="brace">{</em>
<a id="L114" name="L114"></a> 114         <strong class="reserved">return</strong> fWhatToShow;
<a id="L115" name="L115"></a> 115     <em class="brace">}</em>
<a id="L116" name="L116"></a> 116 
<div class="comment">
     /** Return the filter */</div>
<a id="L118" name="L118"></a> 118     <strong class="reserved">public</strong> <a href="../D/6087.html" title="Multiple defined in 2 places.">NodeFilter</a>         <a href="../R/16590.html" title="Multiple referred from 6 places.">getFilter</a>() <em class="brace">{</em>
<a id="L119" name="L119"></a> 119         <strong class="reserved">return</strong> fNodeFilter;
<a id="L120" name="L120"></a> 120     <em class="brace">}</em>
<a id="L121" name="L121"></a> 121 
<div class="comment">
     /** Return whether children entity references are included in the iterator. */</div>
<a id="L123" name="L123"></a> 123     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong>            <a href="../S/4889.html#L311" title="Referred from 311 in src/com/sun/org/apache/xpath/internal/axes/NodeSequence.java.">getExpandEntityReferences</a>() <em class="brace">{</em>
<a id="L124" name="L124"></a> 124         <strong class="reserved">return</strong> fEntityReferenceExpansion;
<a id="L125" name="L125"></a> 125     <em class="brace">}</em>
<a id="L126" name="L126"></a> 126 
<div class="comment">
 Return the next Node in the Iterator. The node is the next node in
       depth-first order which also passes the filter, and whatToShow.
       If there is no next node which passes these criteria, then return null.</div>
<a id="L131" name="L131"></a> 131     <strong class="reserved">public</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>               <a href="../R/23682.html" title="Multiple referred from 192 places.">nextNode</a>() <em class="brace">{</em>
<a id="L132" name="L132"></a> 132 
<a id="L133" name="L133"></a> 133         <strong class="reserved">if</strong>( fDetach) <em class="brace">{</em>
<a id="L134" name="L134"></a> 134                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/55.html#L62" title="Defined at 62 in src/org/w3c/dom/DOMException.java.">DOMException</a>(
<a id="L135" name="L135"></a> 135                 <a href="../S/55.html#L62" title="Defined at 62 in src/org/w3c/dom/DOMException.java.">DOMException</a>.INVALID_STATE_ERR,
<a id="L136" name="L136"></a> 136                 <a href="../S/5440.html#L36" title="Defined at 36 in src/com/sun/org/apache/xerces/internal/dom/DOMMessageFormatter.java.">DOMMessageFormatter</a>.<a href="../D/16540.html" title="Multiple defined in 20 places.">formatMessage</a>(<a href="../S/5440.html#L36" title="Defined at 36 in src/com/sun/org/apache/xerces/internal/dom/DOMMessageFormatter.java.">DOMMessageFormatter</a>.DOM_DOMAIN, "INVALID_STATE_ERR", <strong class="reserved">null</strong>));
<a id="L137" name="L137"></a> 137         <em class="brace">}</em>
<a id="L138" name="L138"></a> 138 
<a id="L139" name="L139"></a> 139         <em class="comment">// if root is null there is no next node.</em>
<a id="L140" name="L140"></a> 140         <strong class="reserved">if</strong> (fRoot == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L141" name="L141"></a> 141 
<a id="L142" name="L142"></a> 142         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> = fCurrentNode;
<a id="L143" name="L143"></a> 143         <strong class="reserved">boolean</strong> accepted = <strong class="reserved">false</strong>; <em class="comment">// the next node has not been accepted.</em>
<a id="L144" name="L144"></a> 144 
<a id="L145" name="L145"></a> 145         accepted_loop:
<a id="L146" name="L146"></a> 146         <strong class="reserved">while</strong> (!accepted) <em class="brace">{</em>
<a id="L147" name="L147"></a> 147 
<a id="L148" name="L148"></a> 148             <em class="comment">// if last direction is not forward, repeat node.</em>
<a id="L149" name="L149"></a> 149             <strong class="reserved">if</strong> (!fForward &amp;&amp; <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>!=<strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L150" name="L150"></a> 150                 <em class="comment">//System.out.println("nextNode():!fForward:"+fCurrentNode.getNodeName());</em>
<a id="L151" name="L151"></a> 151                 <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> = fCurrentNode;
<a id="L152" name="L152"></a> 152             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L153" name="L153"></a> 153             <em class="comment">// else get the next node via depth-first</em>
<a id="L154" name="L154"></a> 154                 <strong class="reserved">if</strong> (!fEntityReferenceExpansion
<a id="L155" name="L155"></a> 155                     &amp;&amp; <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> != <strong class="reserved">null</strong>
<a id="L156" name="L156"></a> 156                     &amp;&amp; <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>() == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ENTITY_REFERENCE_NODE) <em class="brace">{</em>
<a id="L157" name="L157"></a> 157                     <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>(<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>, <strong class="reserved">false</strong>);
<a id="L158" name="L158"></a> 158                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L159" name="L159"></a> 159                     <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>(<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>, <strong class="reserved">true</strong>);
<a id="L160" name="L160"></a> 160                 <em class="brace">}</em>
<a id="L161" name="L161"></a> 161             <em class="brace">}</em>
<a id="L162" name="L162"></a> 162 
<a id="L163" name="L163"></a> 163             fForward = <strong class="reserved">true</strong>; <em class="comment">//REVIST: should direction be set forward before null check?</em>
<a id="L164" name="L164"></a> 164 
<a id="L165" name="L165"></a> 165             <em class="comment">// nothing in the list. return null.</em>
<a id="L166" name="L166"></a> 166             <strong class="reserved">if</strong> (<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L167" name="L167"></a> 167 
<a id="L168" name="L168"></a> 168             <em class="comment">// does node pass the filters and whatToShow?</em>
<a id="L169" name="L169"></a> 169             accepted = <a href="../D/10547.html" title="Multiple defined in 10 places.">acceptNode</a>(<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>);
<a id="L170" name="L170"></a> 170             <strong class="reserved">if</strong> (accepted) <em class="brace">{</em>
<a id="L171" name="L171"></a> 171                 <em class="comment">// if so, then the node is the current node.</em>
<a id="L172" name="L172"></a> 172                 fCurrentNode = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>;
<a id="L173" name="L173"></a> 173                 <strong class="reserved">return</strong> fCurrentNode;
<a id="L174" name="L174"></a> 174             <em class="brace">}</em> <strong class="reserved">else</strong>
<a id="L175" name="L175"></a> 175                 <strong class="reserved">continue</strong> accepted_loop;
<a id="L176" name="L176"></a> 176 
<a id="L177" name="L177"></a> 177         <em class="brace">}</em> <em class="comment">// while (!accepted) {</em>
<a id="L178" name="L178"></a> 178 
<a id="L179" name="L179"></a> 179         <em class="comment">// no nodes, or no accepted nodes.</em>
<a id="L180" name="L180"></a> 180         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L181" name="L181"></a> 181 
<a id="L182" name="L182"></a> 182     <em class="brace">}</em>
<a id="L183" name="L183"></a> 183 
<div class="comment">
 Return the previous Node in the Iterator. The node is the next node in
       _backwards_ depth-first order which also passes the filter, and whatToShow.</div>
<a id="L187" name="L187"></a> 187     <strong class="reserved">public</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>               <a href="../R/24966.html" title="Multiple referred from 15 places.">previousNode</a>() <em class="brace">{</em>
<a id="L188" name="L188"></a> 188 
<a id="L189" name="L189"></a> 189         <strong class="reserved">if</strong>( fDetach) <em class="brace">{</em>
<a id="L190" name="L190"></a> 190                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/55.html#L62" title="Defined at 62 in src/org/w3c/dom/DOMException.java.">DOMException</a>(
<a id="L191" name="L191"></a> 191                 <a href="../S/55.html#L62" title="Defined at 62 in src/org/w3c/dom/DOMException.java.">DOMException</a>.INVALID_STATE_ERR,
<a id="L192" name="L192"></a> 192                 <a href="../S/5440.html#L36" title="Defined at 36 in src/com/sun/org/apache/xerces/internal/dom/DOMMessageFormatter.java.">DOMMessageFormatter</a>.<a href="../D/16540.html" title="Multiple defined in 20 places.">formatMessage</a>(<a href="../S/5440.html#L36" title="Defined at 36 in src/com/sun/org/apache/xerces/internal/dom/DOMMessageFormatter.java.">DOMMessageFormatter</a>.DOM_DOMAIN, "INVALID_STATE_ERR", <strong class="reserved">null</strong>));
<a id="L193" name="L193"></a> 193         <em class="brace">}</em>
<a id="L194" name="L194"></a> 194 
<a id="L195" name="L195"></a> 195         <em class="comment">// if the root is null, or the current node is null, return null.</em>
<a id="L196" name="L196"></a> 196         <strong class="reserved">if</strong> (fRoot == <strong class="reserved">null</strong> || fCurrentNode == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L197" name="L197"></a> 197 
<a id="L198" name="L198"></a> 198         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a> = fCurrentNode;
<a id="L199" name="L199"></a> 199         <strong class="reserved">boolean</strong> accepted = <strong class="reserved">false</strong>;
<a id="L200" name="L200"></a> 200 
<a id="L201" name="L201"></a> 201         accepted_loop:
<a id="L202" name="L202"></a> 202         <strong class="reserved">while</strong> (!accepted) <em class="brace">{</em>
<a id="L203" name="L203"></a> 203 
<a id="L204" name="L204"></a> 204             <strong class="reserved">if</strong> (fForward &amp;&amp; <a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L205" name="L205"></a> 205                 <em class="comment">//repeat last node.</em>
<a id="L206" name="L206"></a> 206                 <a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a> = fCurrentNode;
<a id="L207" name="L207"></a> 207             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L208" name="L208"></a> 208                 <em class="comment">// get previous node in backwards depth first order.</em>
<a id="L209" name="L209"></a> 209                 <a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a> = <a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a>(<a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a>);
<a id="L210" name="L210"></a> 210             <em class="brace">}</em>
<a id="L211" name="L211"></a> 211 
<a id="L212" name="L212"></a> 212             <em class="comment">// we are going backwards</em>
<a id="L213" name="L213"></a> 213             fForward = <strong class="reserved">false</strong>;
<a id="L214" name="L214"></a> 214 
<a id="L215" name="L215"></a> 215             <em class="comment">// if the new previous node is null, we're at head or past the root,</em>
<a id="L216" name="L216"></a> 216             <em class="comment">// so return null.</em>
<a id="L217" name="L217"></a> 217             <strong class="reserved">if</strong> (<a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a> == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L218" name="L218"></a> 218 
<a id="L219" name="L219"></a> 219             <em class="comment">// check if node passes filters and whatToShow.</em>
<a id="L220" name="L220"></a> 220             accepted = <a href="../D/10547.html" title="Multiple defined in 10 places.">acceptNode</a>(<a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a>);
<a id="L221" name="L221"></a> 221             <strong class="reserved">if</strong> (accepted) <em class="brace">{</em>
<a id="L222" name="L222"></a> 222                 <em class="comment">// if accepted, update the current node, and return it.</em>
<a id="L223" name="L223"></a> 223                 fCurrentNode = <a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a>;
<a id="L224" name="L224"></a> 224                 <strong class="reserved">return</strong> fCurrentNode;
<a id="L225" name="L225"></a> 225             <em class="brace">}</em> <strong class="reserved">else</strong>
<a id="L226" name="L226"></a> 226                 <strong class="reserved">continue</strong> accepted_loop;
<a id="L227" name="L227"></a> 227         <em class="brace">}</em>
<a id="L228" name="L228"></a> 228         <em class="comment">// there are no nodes?</em>
<a id="L229" name="L229"></a> 229         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L230" name="L230"></a> 230     <em class="brace">}</em>
<a id="L231" name="L231"></a> 231 
<div class="comment">
     /** The node is accepted if it passes the whatToShow and the filter. */</div>
<a id="L233" name="L233"></a> 233     <strong class="reserved">boolean</strong> <a href="../R/9519.html" title="Multiple referred from 29 places.">acceptNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>) <em class="brace">{</em>
<a id="L234" name="L234"></a> 234 
<a id="L235" name="L235"></a> 235         <strong class="reserved">if</strong> (fNodeFilter == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L236" name="L236"></a> 236             <strong class="reserved">return</strong> ( fWhatToShow &amp; (1 &lt;&lt; <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>()-1)) != 0 ;
<a id="L237" name="L237"></a> 237         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L238" name="L238"></a> 238             <strong class="reserved">return</strong> ((fWhatToShow &amp; (1 &lt;&lt; <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>()-1)) != 0 )
<a id="L239" name="L239"></a> 239                 &amp;&amp; fNodeFilter.<a href="../D/10547.html" title="Multiple defined in 10 places.">acceptNode</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>) == <a href="../D/6087.html" title="Multiple defined in 2 places.">NodeFilter</a>.FILTER_ACCEPT;
<a id="L240" name="L240"></a> 240         <em class="brace">}</em>
<a id="L241" name="L241"></a> 241     <em class="brace">}</em>
<a id="L242" name="L242"></a> 242 
<div class="comment">
     /** Return node, if matches or any parent if matches. */</div>
<a id="L244" name="L244"></a> 244     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../S/5443.html#L345" title="Referred from 345 in src/com/sun/org/apache/xerces/internal/dom/NodeIteratorImpl.java.">matchNodeOrParent</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>) <em class="brace">{</em>
<a id="L245" name="L245"></a> 245         <em class="comment">// Additions and removals in the underlying data structure may occur</em>
<a id="L246" name="L246"></a> 246         <em class="comment">// before any iterations, and in this case the reference_node is null.</em>
<a id="L247" name="L247"></a> 247         <strong class="reserved">if</strong> (fCurrentNode == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L248" name="L248"></a> 248 
<a id="L249" name="L249"></a> 249         <em class="comment">// check if the removed node is an _ancestor_ of the</em>
<a id="L250" name="L250"></a> 250         <em class="comment">// reference node</em>
<a id="L251" name="L251"></a> 251         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> n = fCurrentNode; n != fRoot; n = n.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>()) <em class="brace">{</em>
<a id="L252" name="L252"></a> 252             <strong class="reserved">if</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> == n) <strong class="reserved">return</strong> n;
<a id="L253" name="L253"></a> 253         <em class="brace">}</em>
<a id="L254" name="L254"></a> 254         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L255" name="L255"></a> 255     <em class="brace">}</em>
<a id="L256" name="L256"></a> 256 
<div class="comment">
 The method nextNode(Node, boolean) returns the next node
       from the actual DOM tree.
       The boolean visitChildren determines whether to visit the children.
       The result is the nextNode.</div>
<a id="L263" name="L263"></a> 263     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../R/23682.html" title="Multiple referred from 192 places.">nextNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>, <strong class="reserved">boolean</strong> visitChildren) <em class="brace">{</em>
<a id="L264" name="L264"></a> 264 
<a id="L265" name="L265"></a> 265         <strong class="reserved">if</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> fRoot;
<a id="L266" name="L266"></a> 266 
<a id="L267" name="L267"></a> 267         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L268" name="L268"></a> 268         <em class="comment">// only check children if we visit children.</em>
<a id="L269" name="L269"></a> 269         <strong class="reserved">if</strong> (visitChildren) <em class="brace">{</em>
<a id="L270" name="L270"></a> 270             <em class="comment">//if hasChildren, return 1st child.</em>
<a id="L271" name="L271"></a> 271             <strong class="reserved">if</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/24077.html" title="Multiple defined in 16 places.">hasChildNodes</a>()) <em class="brace">{</em>
<a id="L272" name="L272"></a> 272                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/19088.html" title="Multiple defined in 18 places.">getFirstChild</a>();
<a id="L273" name="L273"></a> 273                 <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L274" name="L274"></a> 274             <em class="brace">}</em>
<a id="L275" name="L275"></a> 275         <em class="brace">}</em>
<a id="L276" name="L276"></a> 276 
<a id="L277" name="L277"></a> 277         <strong class="reserved">if</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> == fRoot) <em class="brace">{</em> <em class="comment">//if Root has no kids</em>
<a id="L278" name="L278"></a> 278             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L279" name="L279"></a> 279         <em class="brace">}</em>
<a id="L280" name="L280"></a> 280 
<a id="L281" name="L281"></a> 281         <em class="comment">// if hasSibling, return sibling</em>
<a id="L282" name="L282"></a> 282         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L283" name="L283"></a> 283         <strong class="reserved">if</strong> (<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> != <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L284" name="L284"></a> 284 
<a id="L285" name="L285"></a> 285 
<a id="L286" name="L286"></a> 286         <em class="comment">// return parent's 1st sibling.</em>
<a id="L287" name="L287"></a> 287         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>();
<a id="L288" name="L288"></a> 288         <strong class="reserved">while</strong> (<a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> != <strong class="reserved">null</strong> &amp;&amp; <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> != fRoot) <em class="brace">{</em>
<a id="L289" name="L289"></a> 289             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L290" name="L290"></a> 290             <strong class="reserved">if</strong> (<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L291" name="L291"></a> 291                 <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L292" name="L292"></a> 292             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L293" name="L293"></a> 293                 <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> = <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>();
<a id="L294" name="L294"></a> 294             <em class="brace">}</em>
<a id="L295" name="L295"></a> 295 
<a id="L296" name="L296"></a> 296         <em class="brace">}</em> <em class="comment">// while (parent != null &amp;&amp; parent != fRoot) {</em>
<a id="L297" name="L297"></a> 297 
<a id="L298" name="L298"></a> 298         <em class="comment">// end of list, return null</em>
<a id="L299" name="L299"></a> 299         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L300" name="L300"></a> 300     <em class="brace">}</em>
<a id="L301" name="L301"></a> 301 
<div class="comment">
 The method previousNode(Node) returns the previous node
       from the actual DOM tree.</div>
<a id="L305" name="L305"></a> 305     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../R/24966.html" title="Multiple referred from 15 places.">previousNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>) <em class="brace">{</em>
<a id="L306" name="L306"></a> 306 
<a id="L307" name="L307"></a> 307         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L308" name="L308"></a> 308 
<a id="L309" name="L309"></a> 309         <em class="comment">// if we're at the root, return null.</em>
<a id="L310" name="L310"></a> 310         <strong class="reserved">if</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> == fRoot) <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L311" name="L311"></a> 311 
<a id="L312" name="L312"></a> 312         <em class="comment">// get sibling</em>
<a id="L313" name="L313"></a> 313         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/21622.html" title="Multiple defined in 19 places.">getPreviousSibling</a>();
<a id="L314" name="L314"></a> 314         <strong class="reserved">if</strong> (<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L315" name="L315"></a> 315             <em class="comment">//if 1st sibling, return parent</em>
<a id="L316" name="L316"></a> 316             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>();
<a id="L317" name="L317"></a> 317             <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L318" name="L318"></a> 318         <em class="brace">}</em>
<a id="L319" name="L319"></a> 319 
<a id="L320" name="L320"></a> 320         <em class="comment">// if sibling has children, keep getting last child of child.</em>
<a id="L321" name="L321"></a> 321         <strong class="reserved">if</strong> (<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/24077.html" title="Multiple defined in 16 places.">hasChildNodes</a>()
<a id="L322" name="L322"></a> 322             &amp;&amp; !(!fEntityReferenceExpansion
<a id="L323" name="L323"></a> 323                 &amp;&amp; <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> != <strong class="reserved">null</strong>
<a id="L324" name="L324"></a> 324                 &amp;&amp; <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>() == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ENTITY_REFERENCE_NODE))
<a id="L325" name="L325"></a> 325 
<a id="L326" name="L326"></a> 326         <em class="brace">{</em>
<a id="L327" name="L327"></a> 327             <strong class="reserved">while</strong> (<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/24077.html" title="Multiple defined in 16 places.">hasChildNodes</a>()) <em class="brace">{</em>
<a id="L328" name="L328"></a> 328                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/19993.html" title="Multiple defined in 20 places.">getLastChild</a>();
<a id="L329" name="L329"></a> 329             <em class="brace">}</em>
<a id="L330" name="L330"></a> 330         <em class="brace">}</em>
<a id="L331" name="L331"></a> 331 
<a id="L332" name="L332"></a> 332         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L333" name="L333"></a> 333     <em class="brace">}</em>
<a id="L334" name="L334"></a> 334 
<div class="comment">
 Fix-up the iterator on a remove. Called by DOM or otherwise,
       before an actual DOM remove.</div>
<a id="L338" name="L338"></a> 338     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26030.html" title="Multiple referred from 14 places.">removeNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>) <em class="brace">{</em>
<a id="L339" name="L339"></a> 339 
<a id="L340" name="L340"></a> 340         <em class="comment">// Implementation note: Fix-up means setting the current node properly</em>
<a id="L341" name="L341"></a> 341         <em class="comment">// after a remove.</em>
<a id="L342" name="L342"></a> 342 
<a id="L343" name="L343"></a> 343         <strong class="reserved">if</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> == <strong class="reserved">null</strong>) <strong class="reserved">return</strong>;
<a id="L344" name="L344"></a> 344 
<a id="L345" name="L345"></a> 345         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> deleted = <a href="../S/5443.html#L244" title="Defined at 244 in src/com/sun/org/apache/xerces/internal/dom/NodeIteratorImpl.java.">matchNodeOrParent</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L346" name="L346"></a> 346 
<a id="L347" name="L347"></a> 347         <strong class="reserved">if</strong> (deleted == <strong class="reserved">null</strong>) <strong class="reserved">return</strong>;
<a id="L348" name="L348"></a> 348 
<a id="L349" name="L349"></a> 349         <strong class="reserved">if</strong> (fForward) <em class="brace">{</em>
<a id="L350" name="L350"></a> 350             fCurrentNode = <a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a>(deleted);
<a id="L351" name="L351"></a> 351         <em class="brace">}</em> <strong class="reserved">else</strong>
<a id="L352" name="L352"></a> 352         <em class="comment">// if (!fForward)</em>
<a id="L353" name="L353"></a> 353         <em class="brace">{</em>
<a id="L354" name="L354"></a> 354             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>(deleted, <strong class="reserved">false</strong>);
<a id="L355" name="L355"></a> 355             <strong class="reserved">if</strong> (<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>!=<strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L356" name="L356"></a> 356                 <em class="comment">// normal case: there _are_ nodes following this in the iterator.</em>
<a id="L357" name="L357"></a> 357                 fCurrentNode = <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L358" name="L358"></a> 358             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L359" name="L359"></a> 359                 <em class="comment">// the last node in the iterator is to be removed,</em>
<a id="L360" name="L360"></a> 360                 <em class="comment">// so we set the current node to be the previous one.</em>
<a id="L361" name="L361"></a> 361                 fCurrentNode = <a href="../D/29605.html" title="Multiple defined in 11 places.">previousNode</a>(deleted);
<a id="L362" name="L362"></a> 362                 fForward = <strong class="reserved">true</strong>;
<a id="L363" name="L363"></a> 363             <em class="brace">}</em>
<a id="L364" name="L364"></a> 364 
<a id="L365" name="L365"></a> 365         <em class="brace">}</em>
<a id="L366" name="L366"></a> 366 
<a id="L367" name="L367"></a> 367     <em class="brace">}</em>
<a id="L368" name="L368"></a> 368 
<a id="L369" name="L369"></a> 369     <strong class="reserved">public</strong> <strong class="reserved">void</strong>               <a href="../R/13275.html" title="Multiple referred from 37 places.">detach</a>() <em class="brace">{</em>
<a id="L370" name="L370"></a> 370         fDetach = <strong class="reserved">true</strong>;
<a id="L371" name="L371"></a> 371         fDocument.<a href="../S/5446.html#L285" title="Defined at 285 in src/com/sun/org/apache/xerces/internal/dom/DocumentImpl.java.">removeNodeIterator</a>(<strong class="reserved">this</strong>);
<a id="L372" name="L372"></a> 372     <em class="brace">}</em>
<a id="L373" name="L373"></a> 373 
<a id="L374" name="L374"></a> 374 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L104">[^]</a><a href="#L369">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>