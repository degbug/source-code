<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L183">[^]</a><a href="#L1760">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L183" title="Defined at 183.">addNode</a></li>
<li><a href="#L315" title="Defined at 315.">getNumberOfNodes</a></li>
<li><a href="#L328" title="Defined at 328.">nextNode</a></li>
<li><a href="#L605" title="Defined at 605.">getNode</a></li>
<li><a href="#L620" title="Defined at 620.">lookupNode</a></li>
<li><a href="#L632" title="Defined at 632.">getNextNodeIdentity</a></li>
<li><a href="#L665" title="Defined at 665.">getHandleFromNode</a></li>
<li><a href="#L704" title="Defined at 704.">getHandleOfNode</a></li>
<li><a href="#L752" title="Defined at 752.">getAttributeNode</a></li>
<li><a href="#L813" title="Defined at 813.">getStringValue</a></li>
<li><a href="#L869" title="Defined at 869.">isWhitespace</a></li>
<li><a href="#L917" title="Defined at 917.">getNodeData</a></li>
<li><a href="#L956" title="Defined at 956.">getNodeName</a></li>
<li><a href="#L973" title="Defined at 973.">getNodeNameX</a></li>
<li><a href="#L1023" title="Defined at 1023.">getLocalName</a></li>
<li><a href="#L1094" title="Defined at 1094.">getPrefix</a></li>
<li><a href="#L1143" title="Defined at 1143.">getNamespaceURI</a></li>
<li><a href="#L1189" title="Defined at 1189.">logicalNextDOMTextNode</a></li>
<li><a href="#L1232" title="Defined at 1232.">getNodeValue</a></li>
<li><a href="#L1275" title="Defined at 1275.">getDocumentTypeDeclarationSystemIdentifier</a></li>
<li><a href="#L1306" title="Defined at 1306.">getDocumentTypeDeclarationPublicIdentifier</a></li>
<li><a href="#L1346" title="Defined at 1346.">getElementById</a></li>
<li><a href="#L1414" title="Defined at 1414.">getUnparsedEntityURI</a></li>
<li><a href="#L1474" title="Defined at 1474.">isAttributeSpecified</a></li>
<li><a href="#L1492" title="Defined at 1492.">setIncrementalSAXSource</a></li>
<li><a href="#L1505" title="Defined at 1505.">getContentHandler</a></li>
<li><a href="#L1520" title="Defined at 1520.">getLexicalHandler</a></li>
<li><a href="#L1532" title="Defined at 1532.">getEntityResolver</a></li>
<li><a href="#L1543" title="Defined at 1543.">getDTDHandler</a></li>
<li><a href="#L1554" title="Defined at 1554.">getErrorHandler</a></li>
<li><a href="#L1565" title="Defined at 1565.">getDeclHandler</a></li>
<li><a href="#L1576" title="Defined at 1576.">needsTwoThreads</a></li>
<li><a href="#L1590" title="Defined at 1590.">isSpace</a></li>
<li><a href="#L1608" title="Defined at 1608.">dispatchCharactersEvents</a></li>
<li><a href="#L1656" title="Defined at 1656.">dispatchNodeData</a></li>
<li><a href="#L1713" title="Defined at 1713.">dispatchToEvents</a></li>
<li><a href="#L1738" title="Defined at 1738.">characters</a></li>
<li><a href="#L1749" title="Defined at 1749.">setProperty</a></li>
<li><a href="#L1760" title="Defined at 1760.">getSourceLocatorFor</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: DOM2DTM.java,v 1.2.4.1 2005/09/15 08:15:10 suresh_emailid Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xml.internal.dtm.<a href="../S/986.html#L2252" title="Defined at 2252 in src/java/util/regex/Pattern.java.">ref</a>.dom2dtm;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> java.util.Vector;
<a id="L26" name="L26"></a>  26 
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> javax.xml.transform.SourceLocator;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> javax.xml.transform.dom.DOMSource;
<a id="L29" name="L29"></a>  29 
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTM;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMManager;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMWSFilter;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.ref.DTMDefaultBaseIterators;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.ref.DTMManagerDefault;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.ref.ExpandedNameTable;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.ref.IncrementalSAXSource;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.res.XMLErrorResources;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.res.XMLMessages;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.FastStringBuffer;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.QName;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.StringBufferPool;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.TreeWalker;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.XMLCharacterRecognizer;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.XMLString;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.XMLStringFactory;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> org.w3c.dom.Attr;
<a id="L47" name="L47"></a>  47 <strong class="reserved">import</strong> org.w3c.dom.Document;
<a id="L48" name="L48"></a>  48 <strong class="reserved">import</strong> org.w3c.dom.DocumentType;
<a id="L49" name="L49"></a>  49 <strong class="reserved">import</strong> org.w3c.dom.Element;
<a id="L50" name="L50"></a>  50 <strong class="reserved">import</strong> org.w3c.dom.Entity;
<a id="L51" name="L51"></a>  51 <strong class="reserved">import</strong> org.w3c.dom.NamedNodeMap;
<a id="L52" name="L52"></a>  52 <strong class="reserved">import</strong> org.w3c.dom.Node;
<a id="L53" name="L53"></a>  53 <strong class="reserved">import</strong> org.xml.sax.ContentHandler;
<a id="L54" name="L54"></a>  54 
<div class="comment">
 The <code>DOM2DTM</code> class serves up a DOM's contents via the
  DTM API.
  Note that it doesn't necessarily represent a full Document
  tree. You can wrap a DOM2DTM around a specific node and its subtree
  and the right things should happen. (I don't _think_ we currently
  support DocumentFrgment nodes as roots, though that might be worth
  considering.)
  Note too that we do not currently attempt to track document
  mutation. If you alter the DOM after wrapping DOM2DTM around it,
  all bets are off.
 * </div>
<a id="L68" name="L68"></a>  68 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/1869.html" title="Multiple referred from 8 places.">DOM2DTM</a> <strong class="reserved">extends</strong> <a href="../S/5905.html#L38" title="Defined at 38 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBaseIterators.java.">DTMDefaultBaseIterators</a>
<a id="L69" name="L69"></a>  69 <em class="brace">{</em>
<a id="L70" name="L70"></a>  70   <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> JJK_DEBUG=<strong class="reserved">false</strong>;
<a id="L71" name="L71"></a>  71   <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> JJK_NEWCODE=<strong class="reserved">true</strong>;
<a id="L72" name="L72"></a>  72 
<div class="comment">
 Manefest constant</div>
<a id="L75" name="L75"></a>  75   <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> NAMESPACE_DECL_NS="http://www.w3.org/XML/1998/namespace";
<a id="L76" name="L76"></a>  76 
<div class="comment">
 The current position in the DOM tree. Last node examined for
   * possible copying to DTM. </div>
<a id="L79" name="L79"></a>  79   <strong class="reserved">transient</strong> <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> m_pos;
<div class="comment">
   /** The current position in the DTM tree. Who children get appended to. */</div>
<a id="L81" name="L81"></a>  81   <strong class="reserved">private</strong> <strong class="reserved">int</strong> m_last_parent=0;
<div class="comment">
 The current position in the DTM tree. Who children reference as their
   * previous sib. </div>
<a id="L84" name="L84"></a>  84   <strong class="reserved">private</strong> <strong class="reserved">int</strong> m_last_kid=<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L85" name="L85"></a>  85 
<div class="comment">
 The top of the subtree.
    %REVIEW%: 'may not be the same as m_context if "//foo" pattern.'
   * </div>
<a id="L89" name="L89"></a>  89   <strong class="reserved">transient</strong> <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> m_root;
<a id="L90" name="L90"></a>  90 
<div class="comment">
 True iff the first element has been processed. This is used to control
      synthesis of the implied xml: namespace declaration node. </div>
<a id="L93" name="L93"></a>  93   <strong class="reserved">boolean</strong> m_processedFirstElement=<strong class="reserved">false</strong>;
<a id="L94" name="L94"></a>  94 
<div class="comment">
 true if ALL the nodes in the m_root subtree have been processed;
    false if our incremental build has not yet finished scanning the
   * DOM tree.  </div>
<a id="L98" name="L98"></a>  98   <strong class="reserved">transient</strong> <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> m_nodesAreProcessed;
<a id="L99" name="L99"></a>  99 
<div class="comment">
 The node objects.  The instance part of the handle indexes
    directly into this vector.  Each DTM node may actually be
    composed of several DOM nodes (for example, if logically-adjacent
    Text/CDATASection nodes in the DOM have been coalesced into a
    single DTM Text node); this table points only to the first in
   * that sequence. </div>
<a id="L106" name="L106"></a> 106   <strong class="reserved">protected</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> m_nodes = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>();
<a id="L107" name="L107"></a> 107 
<div class="comment">
    Construct a DOM2DTM object from a DOM node.
    @param mgr The DTMManager who owns this DTM.
    @param domSource the DOM source that this DTM will wrap.
    @param dtmIdentity The DTM identity ID for this DTM.
    @param whiteSpaceFilter The white space filter for this DTM, which may
                            be null.
    @param xstringfactory XMLString factory for creating character content.
    @param doIndexing true if the caller considers it worth it to use
                      indexing schemes.</div>
<a id="L120" name="L120"></a> 120   <strong class="reserved">public</strong> DOM2DTM(<a href="../S/5920.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/dtm/DTMManager.java.">DTMManager</a> mgr, <a href="../S/4046.html#L44" title="Defined at 44 in src/javax/xml/transform/dom/DOMSource.java.">DOMSource</a> domSource,
<a id="L121" name="L121"></a> 121                  <strong class="reserved">int</strong> dtmIdentity, <a href="../S/5926.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMWSFilter.java.">DTMWSFilter</a> whiteSpaceFilter,
<a id="L122" name="L122"></a> 122                  <a href="../S/5839.html#L28" title="Defined at 28 in src/com/sun/org/apache/xml/internal/utils/XMLStringFactory.java.">XMLStringFactory</a> xstringfactory,
<a id="L123" name="L123"></a> 123                  <strong class="reserved">boolean</strong> doIndexing)
<a id="L124" name="L124"></a> 124   <em class="brace">{</em>
<a id="L125" name="L125"></a> 125     <strong class="reserved">super</strong>(mgr, domSource, dtmIdentity, whiteSpaceFilter,
<a id="L126" name="L126"></a> 126           xstringfactory, doIndexing);
<a id="L127" name="L127"></a> 127 
<a id="L128" name="L128"></a> 128     <em class="comment">// Initialize DOM navigation</em>
<a id="L129" name="L129"></a> 129     m_pos=m_root = domSource.<a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>();
<a id="L130" name="L130"></a> 130     <em class="comment">// Initialize DTM navigation</em>
<a id="L131" name="L131"></a> 131     m_last_parent=m_last_kid=<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L132" name="L132"></a> 132     m_last_kid=<a href="../D/10963.html" title="Multiple defined in 6 places.">addNode</a>(m_root, m_last_parent,m_last_kid, <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L133" name="L133"></a> 133 
<a id="L134" name="L134"></a> 134     <em class="comment">// Apparently the domSource root may not actually be the</em>
<a id="L135" name="L135"></a> 135     <em class="comment">// Document node. If it's an Element node, we need to immediately</em>
<a id="L136" name="L136"></a> 136     <em class="comment">// add its attributes. Adapted from nextNode().</em>
<a id="L137" name="L137"></a> 137     <em class="comment">// %REVIEW% Move this logic into addNode and recurse? Cleaner!</em>
<a id="L138" name="L138"></a> 138     <em class="comment">//</em>
<a id="L139" name="L139"></a> 139     <em class="comment">// (If it's an EntityReference node, we're probably scrod. For now</em>
<a id="L140" name="L140"></a> 140     <em class="comment">// I'm just hoping nobody is ever quite that foolish... %REVIEW%)</em>
<a id="L141" name="L141"></a> 141                 <em class="comment">//</em>
<a id="L142" name="L142"></a> 142                 <em class="comment">// %ISSUE% What about inherited namespaces in this case?</em>
<a id="L143" name="L143"></a> 143                 <em class="comment">// Do we need to special-case initialize them into the DTM model?</em>
<a id="L144" name="L144"></a> 144     <strong class="reserved">if</strong>(ELEMENT_NODE == m_root.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L145" name="L145"></a> 145     <em class="brace">{</em>
<a id="L146" name="L146"></a> 146       <a href="../S/114.html#L56" title="Defined at 56 in src/org/w3c/dom/NamedNodeMap.java.">NamedNodeMap</a> attrs=m_root.<a href="../D/17112.html" title="Multiple defined in 109 places.">getAttributes</a>();
<a id="L147" name="L147"></a> 147       <strong class="reserved">int</strong> attrsize=(attrs==<strong class="reserved">null</strong>) ? 0 : attrs.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>();
<a id="L148" name="L148"></a> 148       <strong class="reserved">if</strong>(attrsize&gt;0)
<a id="L149" name="L149"></a> 149       <em class="brace">{</em>
<a id="L150" name="L150"></a> 150         <strong class="reserved">int</strong> attrIndex=<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>; <em class="comment">// start with no previous sib</em>
<a id="L151" name="L151"></a> 151         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i=0;i&lt;attrsize;++i)
<a id="L152" name="L152"></a> 152         <em class="brace">{</em>
<a id="L153" name="L153"></a> 153           <em class="comment">// No need to force nodetype in this case;</em>
<a id="L154" name="L154"></a> 154           <em class="comment">// addNode() will take care of switching it from</em>
<a id="L155" name="L155"></a> 155           <em class="comment">// Attr to Namespace if necessary.</em>
<a id="L156" name="L156"></a> 156           attrIndex=<a href="../D/10963.html" title="Multiple defined in 6 places.">addNode</a>(attrs.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>(i),0,attrIndex,<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L157" name="L157"></a> 157           m_firstch.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,attrIndex);
<a id="L158" name="L158"></a> 158         <em class="brace">}</em>
<a id="L159" name="L159"></a> 159         <em class="comment">// Terminate list of attrs, and make sure they aren't</em>
<a id="L160" name="L160"></a> 160         <em class="comment">// considered children of the element</em>
<a id="L161" name="L161"></a> 161         m_nextsib.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,attrIndex);
<a id="L162" name="L162"></a> 162 
<a id="L163" name="L163"></a> 163         <em class="comment">// IMPORTANT: This does NOT change m_last_parent or m_last_kid!</em>
<a id="L164" name="L164"></a> 164       <em class="brace">}</em> <em class="comment">// if attrs exist</em>
<a id="L165" name="L165"></a> 165     <em class="brace">}</em> <em class="comment">//if(ELEMENT_NODE)</em>
<a id="L166" name="L166"></a> 166 
<a id="L167" name="L167"></a> 167     <em class="comment">// Initialize DTM-completed status</em>
<a id="L168" name="L168"></a> 168     m_nodesAreProcessed = <strong class="reserved">false</strong>;
<a id="L169" name="L169"></a> 169   <em class="brace">}</em>
<a id="L170" name="L170"></a> 170 
<div class="comment">
    Construct the node map from the node.
    @param node The node that is to be added to the DTM.
    @param parentIndex The current parent index.
    @param previousSibling The previous sibling index.
    @param forceNodeType If not DTM.NULL, overrides the DOM node type.
       Used to force nodes to Text rather than CDATASection when their
       coalesced value includes ordinary Text nodes (current DTM behavior).
    @return The index identity of the node that was added.</div>
<a id="L183" name="L183"></a> 183   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/9871.html" title="Multiple referred from 39 places.">addNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>, <strong class="reserved">int</strong> parentIndex,
<a id="L184" name="L184"></a> 184                         <strong class="reserved">int</strong> <a href="../D/29608.html" title="Multiple defined in 4 places.">previousSibling</a>, <strong class="reserved">int</strong> forceNodeType)
<a id="L185" name="L185"></a> 185   <em class="brace">{</em>
<a id="L186" name="L186"></a> 186     <strong class="reserved">int</strong> nodeIndex = m_nodes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L187" name="L187"></a> 187 
<a id="L188" name="L188"></a> 188     <em class="comment">// Have we overflowed a DTM Identity's addressing range?</em>
<a id="L189" name="L189"></a> 189     <strong class="reserved">if</strong>(m_dtmIdent.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() == (nodeIndex&gt;&gt;&gt;<a href="../S/5920.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/dtm/DTMManager.java.">DTMManager</a>.IDENT_DTM_NODE_BITS))
<a id="L190" name="L190"></a> 190     <em class="brace">{</em>
<a id="L191" name="L191"></a> 191       <strong class="reserved">try</strong>
<a id="L192" name="L192"></a> 192       <em class="brace">{</em>
<a id="L193" name="L193"></a> 193         <strong class="reserved">if</strong>(m_mgr==<strong class="reserved">null</strong>)
<a id="L194" name="L194"></a> 194           <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1727.html#L41" title="Defined at 41 in src/java/lang/ClassCastException.java.">ClassCastException</a>();
<a id="L195" name="L195"></a> 195 
<a id="L196" name="L196"></a> 196                                 <em class="comment">// Handle as Extended Addressing</em>
<a id="L197" name="L197"></a> 197         <a href="../S/5906.html#L76" title="Defined at 76 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMManagerDefault.java.">DTMManagerDefault</a> mgrD=(<a href="../S/5906.html#L76" title="Defined at 76 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMManagerDefault.java.">DTMManagerDefault</a>)m_mgr;
<a id="L198" name="L198"></a> 198         <strong class="reserved">int</strong> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>=mgrD.<a href="../S/5906.html#L187" title="Defined at 187 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMManagerDefault.java.">getFirstFreeDTMID</a>();
<a id="L199" name="L199"></a> 199         mgrD.<a href="../D/10743.html" title="Multiple defined in 2 places.">addDTM</a>(<strong class="reserved">this</strong>,<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>,nodeIndex);
<a id="L200" name="L200"></a> 200         m_dtmIdent.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>&lt;&lt;<a href="../S/5920.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/dtm/DTMManager.java.">DTMManager</a>.IDENT_DTM_NODE_BITS);
<a id="L201" name="L201"></a> 201       <em class="brace">}</em>
<a id="L202" name="L202"></a> 202       <strong class="reserved">catch</strong>(<a href="../S/1727.html#L41" title="Defined at 41 in src/java/lang/ClassCastException.java.">ClassCastException</a> e)
<a id="L203" name="L203"></a> 203       <em class="brace">{</em>
<a id="L204" name="L204"></a> 204         <em class="comment">// %REVIEW% Wrong error message, but I've been told we're trying</em>
<a id="L205" name="L205"></a> 205         <em class="comment">// not to add messages right not for I18N reasons.</em>
<a id="L206" name="L206"></a> 206         <em class="comment">// %REVIEW% Should this be a Fatal Error?</em>
<a id="L207" name="L207"></a> 207         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/5529.html#L33" title="Defined at 33 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">XMLMessages</a>.<a href="../S/5529.html#L82" title="Defined at 82 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">createXMLMessage</a>(<a href="../S/5541.html#L35" title="Defined at 35 in src/com/sun/org/apache/xml/internal/res/XMLErrorResources.java.">XMLErrorResources</a>.ER_NO_DTMIDS_AVAIL, <strong class="reserved">null</strong>));<em class="comment">//"No more DTM IDs are available";</em>
<a id="L208" name="L208"></a> 208       <em class="brace">}</em>
<a id="L209" name="L209"></a> 209     <em class="brace">}</em>
<a id="L210" name="L210"></a> 210 
<a id="L211" name="L211"></a> 211     m_size++;
<a id="L212" name="L212"></a> 212     <em class="comment">// ensureSize(nodeIndex);</em>
<a id="L213" name="L213"></a> 213 
<a id="L214" name="L214"></a> 214     <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>;
<a id="L215" name="L215"></a> 215     <strong class="reserved">if</strong>(<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>==forceNodeType)
<a id="L216" name="L216"></a> 216         <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>();
<a id="L217" name="L217"></a> 217     <strong class="reserved">else</strong>
<a id="L218" name="L218"></a> 218         <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>=forceNodeType;
<a id="L219" name="L219"></a> 219 
<a id="L220" name="L220"></a> 220     <em class="comment">// %REVIEW% The Namespace Spec currently says that Namespaces are</em>
<a id="L221" name="L221"></a> 221     <em class="comment">// processed in a non-namespace-aware manner, by matching the</em>
<a id="L222" name="L222"></a> 222     <em class="comment">// QName, even though there is in fact a namespace assigned to</em>
<a id="L223" name="L223"></a> 223     <em class="comment">// these nodes in the DOM. If and when that changes, we will have</em>
<a id="L224" name="L224"></a> 224     <em class="comment">// to consider whether we check the namespace-for-namespaces</em>
<a id="L225" name="L225"></a> 225     <em class="comment">// rather than the node name.</em>
<a id="L226" name="L226"></a> 226     <em class="comment">//</em>
<a id="L227" name="L227"></a> 227     <em class="comment">// %TBD% Note that the DOM does not necessarily explicitly declare</em>
<a id="L228" name="L228"></a> 228     <em class="comment">// all the namespaces it uses. DOM Level 3 will introduce a</em>
<a id="L229" name="L229"></a> 229     <em class="comment">// namespace-normalization operation which reconciles that, and we</em>
<a id="L230" name="L230"></a> 230     <em class="comment">// can request that users invoke it or otherwise ensure that the</em>
<a id="L231" name="L231"></a> 231     <em class="comment">// tree is namespace-well-formed before passing the DOM to Xalan.</em>
<a id="L232" name="L232"></a> 232     <em class="comment">// But if they don't, what should we do about it? We probably</em>
<a id="L233" name="L233"></a> 233     <em class="comment">// don't want to alter the source DOM (and may not be able to do</em>
<a id="L234" name="L234"></a> 234     <em class="comment">// so if it's read-only). The best available answer might be to</em>
<a id="L235" name="L235"></a> 235     <em class="comment">// synthesize additional DTM Namespace Nodes that don't correspond</em>
<a id="L236" name="L236"></a> 236     <em class="comment">// to DOM Attr Nodes.</em>
<a id="L237" name="L237"></a> 237     <strong class="reserved">if</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ATTRIBUTE_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L238" name="L238"></a> 238     <em class="brace">{</em>
<a id="L239" name="L239"></a> 239       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>();
<a id="L240" name="L240"></a> 240 
<a id="L241" name="L241"></a> 241       <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("xmlns:") || <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("xmlns"))
<a id="L242" name="L242"></a> 242       <em class="brace">{</em>
<a id="L243" name="L243"></a> 243         <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE;
<a id="L244" name="L244"></a> 244       <em class="brace">}</em>
<a id="L245" name="L245"></a> 245     <em class="brace">}</em>
<a id="L246" name="L246"></a> 246 
<a id="L247" name="L247"></a> 247     m_nodes.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L248" name="L248"></a> 248 
<a id="L249" name="L249"></a> 249     m_firstch.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(NOTPROCESSED,nodeIndex);
<a id="L250" name="L250"></a> 250     m_nextsib.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(NOTPROCESSED,nodeIndex);
<a id="L251" name="L251"></a> 251     m_prevsib.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../D/29608.html" title="Multiple defined in 4 places.">previousSibling</a>,nodeIndex);
<a id="L252" name="L252"></a> 252     m_parent.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(parentIndex,nodeIndex);
<a id="L253" name="L253"></a> 253 
<a id="L254" name="L254"></a> 254     <strong class="reserved">if</strong>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != parentIndex &amp;&amp;
<a id="L255" name="L255"></a> 255        <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> != <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE &amp;&amp;
<a id="L256" name="L256"></a> 256        <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> != <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE)
<a id="L257" name="L257"></a> 257     <em class="brace">{</em>
<a id="L258" name="L258"></a> 258       <em class="comment">// If the DTM parent had no children, this becomes its first child.</em>
<a id="L259" name="L259"></a> 259       <strong class="reserved">if</strong>(NOTPROCESSED == m_firstch.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(parentIndex))
<a id="L260" name="L260"></a> 260         m_firstch.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(nodeIndex,parentIndex);
<a id="L261" name="L261"></a> 261     <em class="brace">}</em>
<a id="L262" name="L262"></a> 262 
<a id="L263" name="L263"></a> 263     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> nsURI = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20828.html" title="Multiple defined in 47 places.">getNamespaceURI</a>();
<a id="L264" name="L264"></a> 264 
<a id="L265" name="L265"></a> 265     <em class="comment">// Deal with the difference between Namespace spec and XSLT</em>
<a id="L266" name="L266"></a> 266     <em class="comment">// definitions of local name. (The former says PIs don't have</em>
<a id="L267" name="L267"></a> 267     <em class="comment">// localnames; the latter says they do.)</em>
<a id="L268" name="L268"></a> 268     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a> =  (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.PROCESSING_INSTRUCTION_NODE) ?
<a id="L269" name="L269"></a> 269                          <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>() :
<a id="L270" name="L270"></a> 270                          <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20201.html" title="Multiple defined in 44 places.">getLocalName</a>();
<a id="L271" name="L271"></a> 271 
<a id="L272" name="L272"></a> 272     <em class="comment">// Hack to make DOM1 sort of work...</em>
<a id="L273" name="L273"></a> 273     <strong class="reserved">if</strong>(((<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ELEMENT_NODE) || (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ATTRIBUTE_NODE))
<a id="L274" name="L274"></a> 274         &amp;&amp; <strong class="reserved">null</strong> == <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a>)
<a id="L275" name="L275"></a> 275       <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>(); <em class="comment">// -sb</em>
<a id="L276" name="L276"></a> 276 
<a id="L277" name="L277"></a> 277     <a href="../S/5887.html#L39" title="Defined at 39 in src/com/sun/org/apache/xml/internal/dtm/ref/ExpandedNameTable.java.">ExpandedNameTable</a> exnt = m_expandedNameTable;
<a id="L278" name="L278"></a> 278 
<a id="L279" name="L279"></a> 279     <em class="comment">// %TBD% Nodes created with the old non-namespace-aware DOM</em>
<a id="L280" name="L280"></a> 280     <em class="comment">// calls createElement() and createAttribute() will never have a</em>
<a id="L281" name="L281"></a> 281     <em class="comment">// localname. That will cause their expandedNameID to be just the</em>
<a id="L282" name="L282"></a> 282     <em class="comment">// nodeType... which will keep them from being matched</em>
<a id="L283" name="L283"></a> 283     <em class="comment">// successfully by name. Since the DOM makes no promise that</em>
<a id="L284" name="L284"></a> 284     <em class="comment">// those will participate in namespace processing, this is</em>
<a id="L285" name="L285"></a> 285     <em class="comment">// officially accepted as Not Our Fault. But it might be nice to</em>
<a id="L286" name="L286"></a> 286     <em class="comment">// issue a diagnostic message!</em>
<a id="L287" name="L287"></a> 287     <strong class="reserved">if</strong>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20201.html" title="Multiple defined in 44 places.">getLocalName</a>()==<strong class="reserved">null</strong> &amp;&amp;
<a id="L288" name="L288"></a> 288        (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>==<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ELEMENT_NODE || <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>==<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ATTRIBUTE_NODE))
<a id="L289" name="L289"></a> 289       <em class="brace">{</em>
<a id="L290" name="L290"></a> 290         <em class="comment">// warning("DOM 'level 1' node "+node.getNodeName()+" won't be mapped properly in DOM2DTM.");</em>
<a id="L291" name="L291"></a> 291       <em class="brace">}</em>
<a id="L292" name="L292"></a> 292 
<a id="L293" name="L293"></a> 293     <strong class="reserved">int</strong> expandedNameID = (<strong class="reserved">null</strong> != <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a>)
<a id="L294" name="L294"></a> 294        ? exnt.<a href="../D/18929.html" title="Multiple defined in 16 places.">getExpandedTypeID</a>(nsURI, <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a>, <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) :
<a id="L295" name="L295"></a> 295          exnt.<a href="../D/18929.html" title="Multiple defined in 16 places.">getExpandedTypeID</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L296" name="L296"></a> 296 
<a id="L297" name="L297"></a> 297     m_exptype.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(expandedNameID,nodeIndex);
<a id="L298" name="L298"></a> 298 
<a id="L299" name="L299"></a> 299     <a href="../S/5889.html#L319" title="Defined at 319 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">indexNode</a>(expandedNameID, nodeIndex);
<a id="L300" name="L300"></a> 300 
<a id="L301" name="L301"></a> 301     <strong class="reserved">if</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != <a href="../D/29608.html" title="Multiple defined in 4 places.">previousSibling</a>)
<a id="L302" name="L302"></a> 302       m_nextsib.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(nodeIndex,<a href="../D/29608.html" title="Multiple defined in 4 places.">previousSibling</a>);
<a id="L303" name="L303"></a> 303 
<a id="L304" name="L304"></a> 304     <em class="comment">// This should be done after m_exptype has been set, and probably should</em>
<a id="L305" name="L305"></a> 305     <em class="comment">// always be the last thing we do</em>
<a id="L306" name="L306"></a> 306     <strong class="reserved">if</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE)
<a id="L307" name="L307"></a> 307         <a href="../S/5889.html#L1262" title="Defined at 1262 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">declareNamespaceInContext</a>(parentIndex,nodeIndex);
<a id="L308" name="L308"></a> 308 
<a id="L309" name="L309"></a> 309     <strong class="reserved">return</strong> nodeIndex;
<a id="L310" name="L310"></a> 310   <em class="brace">}</em>
<a id="L311" name="L311"></a> 311 
<div class="comment">
    Get the number of nodes that have been added.</div>
<a id="L315" name="L315"></a> 315   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/18057.html" title="Multiple referred from 3 places.">getNumberOfNodes</a>()
<a id="L316" name="L316"></a> 316   <em class="brace">{</em>
<a id="L317" name="L317"></a> 317     <strong class="reserved">return</strong> m_nodes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L318" name="L318"></a> 318   <em class="brace">}</em>
<a id="L319" name="L319"></a> 319 
<div class="comment">
    This method iterates to the next node that will be added to the table.
    Each call to this method adds a new node to the table, unless the end
    is reached, in which case it returns null.
    @return The true if a next node is found or false if
            there are no more nodes.</div>
<a id="L328" name="L328"></a> 328   <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/23682.html" title="Multiple referred from 192 places.">nextNode</a>()
<a id="L329" name="L329"></a> 329   <em class="brace">{</em>
<a id="L330" name="L330"></a> 330     <em class="comment">// Non-recursive one-fetch-at-a-time depth-first traversal with</em>
<a id="L331" name="L331"></a> 331     <em class="comment">// attribute/namespace nodes and white-space stripping.</em>
<a id="L332" name="L332"></a> 332     <em class="comment">// Navigating the DOM is simple, navigating the DTM is simple;</em>
<a id="L333" name="L333"></a> 333     <em class="comment">// keeping track of both at once is a trifle baroque but at least</em>
<a id="L334" name="L334"></a> 334     <em class="comment">// we've avoided most of the special cases.</em>
<a id="L335" name="L335"></a> 335     <strong class="reserved">if</strong> (m_nodesAreProcessed)
<a id="L336" name="L336"></a> 336       <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L337" name="L337"></a> 337 
<a id="L338" name="L338"></a> 338     <em class="comment">// %REVIEW% Is this local copy Really Useful from a performance</em>
<a id="L339" name="L339"></a> 339     <em class="comment">// point of view?  Or is this a false microoptimization?</em>
<a id="L340" name="L340"></a> 340     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> pos=m_pos;
<a id="L341" name="L341"></a> 341     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>=<strong class="reserved">null</strong>;
<a id="L342" name="L342"></a> 342     <strong class="reserved">int</strong> nexttype=<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L343" name="L343"></a> 343 
<a id="L344" name="L344"></a> 344     <em class="comment">// Navigate DOM tree</em>
<a id="L345" name="L345"></a> 345     <strong class="reserved">do</strong>
<a id="L346" name="L346"></a> 346       <em class="brace">{</em>
<a id="L347" name="L347"></a> 347         <em class="comment">// Look down to first child.</em>
<a id="L348" name="L348"></a> 348         <strong class="reserved">if</strong> (pos.<a href="../D/24077.html" title="Multiple defined in 16 places.">hasChildNodes</a>())
<a id="L349" name="L349"></a> 349           <em class="brace">{</em>
<a id="L350" name="L350"></a> 350             <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = pos.<a href="../D/19088.html" title="Multiple defined in 18 places.">getFirstChild</a>();
<a id="L351" name="L351"></a> 351 
<a id="L352" name="L352"></a> 352             <em class="comment">// %REVIEW% There's probably a more elegant way to skip</em>
<a id="L353" name="L353"></a> 353             <em class="comment">// the doctype. (Just let it go and Suppress it?</em>
<a id="L354" name="L354"></a> 354             <strong class="reserved">if</strong>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>!=<strong class="reserved">null</strong> &amp;&amp; DOCUMENT_TYPE_NODE==<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L355" name="L355"></a> 355               <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>=<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L356" name="L356"></a> 356 
<a id="L357" name="L357"></a> 357             <em class="comment">// Push DTM context -- except for children of Entity References,</em>
<a id="L358" name="L358"></a> 358             <em class="comment">// which have no DTM equivalent and cause no DTM navigation.</em>
<a id="L359" name="L359"></a> 359             <strong class="reserved">if</strong>(ENTITY_REFERENCE_NODE!=pos.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L360" name="L360"></a> 360               <em class="brace">{</em>
<a id="L361" name="L361"></a> 361                 m_last_parent=m_last_kid;
<a id="L362" name="L362"></a> 362                 m_last_kid=<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L363" name="L363"></a> 363                 <em class="comment">// Whitespace-handler context stacking</em>
<a id="L364" name="L364"></a> 364                 <strong class="reserved">if</strong>(<strong class="reserved">null</strong> != m_wsfilter)
<a id="L365" name="L365"></a> 365                 <em class="brace">{</em>
<a id="L366" name="L366"></a> 366                   <strong class="reserved">short</strong> wsv =
<a id="L367" name="L367"></a> 367                     m_wsfilter.<a href="../D/22488.html" title="Multiple defined in 2 places.">getShouldStripSpace</a>(<a href="../S/5889.html#L902" title="Defined at 902 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeHandle</a>(m_last_parent),<strong class="reserved">this</strong>);
<a id="L368" name="L368"></a> 368                   <strong class="reserved">boolean</strong> shouldStrip = (<a href="../S/5926.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMWSFilter.java.">DTMWSFilter</a>.INHERIT == wsv)
<a id="L369" name="L369"></a> 369                     ? <a href="../D/22489.html" title="Multiple defined in 2 places.">getShouldStripWhitespace</a>()
<a id="L370" name="L370"></a> 370                     : (<a href="../S/5926.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMWSFilter.java.">DTMWSFilter</a>.STRIP == wsv);
<a id="L371" name="L371"></a> 371                   <a href="../S/5889.html#L2281" title="Defined at 2281 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">pushShouldStripWhitespace</a>(shouldStrip);
<a id="L372" name="L372"></a> 372                 <em class="brace">}</em> <em class="comment">// if(m_wsfilter)</em>
<a id="L373" name="L373"></a> 373               <em class="brace">}</em>
<a id="L374" name="L374"></a> 374           <em class="brace">}</em>
<a id="L375" name="L375"></a> 375 
<a id="L376" name="L376"></a> 376         <em class="comment">// If that fails, look up and right (but not past root!)</em>
<a id="L377" name="L377"></a> 377         <strong class="reserved">else</strong>
<a id="L378" name="L378"></a> 378           <em class="brace">{</em>
<a id="L379" name="L379"></a> 379             <strong class="reserved">if</strong>(m_last_kid!=<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L380" name="L380"></a> 380               <em class="brace">{</em>
<a id="L381" name="L381"></a> 381                 <em class="comment">// Last node posted at this level had no more children</em>
<a id="L382" name="L382"></a> 382                 <em class="comment">// If it has _no_ children, we need to record that.</em>
<a id="L383" name="L383"></a> 383                 <strong class="reserved">if</strong>(m_firstch.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(m_last_kid)==NOTPROCESSED)
<a id="L384" name="L384"></a> 384                   m_firstch.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,m_last_kid);
<a id="L385" name="L385"></a> 385               <em class="brace">}</em>
<a id="L386" name="L386"></a> 386 
<a id="L387" name="L387"></a> 387             <strong class="reserved">while</strong>(m_last_parent != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L388" name="L388"></a> 388               <em class="brace">{</em>
<a id="L389" name="L389"></a> 389                 <em class="comment">// %REVIEW% There's probably a more elegant way to</em>
<a id="L390" name="L390"></a> 390                 <em class="comment">// skip the doctype. (Just let it go and Suppress it?</em>
<a id="L391" name="L391"></a> 391                 <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = pos.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L392" name="L392"></a> 392                 <strong class="reserved">if</strong>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>!=<strong class="reserved">null</strong> &amp;&amp; DOCUMENT_TYPE_NODE==<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L393" name="L393"></a> 393                   <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>=<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L394" name="L394"></a> 394 
<a id="L395" name="L395"></a> 395                 <strong class="reserved">if</strong>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>!=<strong class="reserved">null</strong>)
<a id="L396" name="L396"></a> 396                   <strong class="reserved">break</strong>; <em class="comment">// Found it!</em>
<a id="L397" name="L397"></a> 397 
<a id="L398" name="L398"></a> 398                 <em class="comment">// No next-sibling found. Pop the DOM.</em>
<a id="L399" name="L399"></a> 399                 pos=pos.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>();
<a id="L400" name="L400"></a> 400                 <strong class="reserved">if</strong>(pos==<strong class="reserved">null</strong>)
<a id="L401" name="L401"></a> 401                   <em class="brace">{</em>
<a id="L402" name="L402"></a> 402                     <em class="comment">// %TBD% Should never arise, but I want to be sure of that...</em>
<a id="L403" name="L403"></a> 403                     <strong class="reserved">if</strong>(JJK_DEBUG)
<a id="L404" name="L404"></a> 404                       <em class="brace">{</em>
<a id="L405" name="L405"></a> 405                         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("***** DOM2DTM Pop Control Flow problem");
<a id="L406" name="L406"></a> 406                         <strong class="reserved">for</strong>(;;); <em class="comment">// Freeze right here!</em>
<a id="L407" name="L407"></a> 407                       <em class="brace">}</em>
<a id="L408" name="L408"></a> 408                   <em class="brace">}</em>
<a id="L409" name="L409"></a> 409 
<a id="L410" name="L410"></a> 410                 <em class="comment">// The only parents in the DTM are Elements.  However,</em>
<a id="L411" name="L411"></a> 411                 <em class="comment">// the DOM could contain EntityReferences.  If we</em>
<a id="L412" name="L412"></a> 412                 <em class="comment">// encounter one, pop it _without_ popping DTM.</em>
<a id="L413" name="L413"></a> 413                 <strong class="reserved">if</strong>(pos!=<strong class="reserved">null</strong> &amp;&amp; ENTITY_REFERENCE_NODE == pos.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L414" name="L414"></a> 414                   <em class="brace">{</em>
<a id="L415" name="L415"></a> 415                     <em class="comment">// Nothing needs doing</em>
<a id="L416" name="L416"></a> 416                     <strong class="reserved">if</strong>(JJK_DEBUG)
<a id="L417" name="L417"></a> 417                       <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("***** DOM2DTM popping EntRef");
<a id="L418" name="L418"></a> 418                   <em class="brace">}</em>
<a id="L419" name="L419"></a> 419                 <strong class="reserved">else</strong>
<a id="L420" name="L420"></a> 420                   <em class="brace">{</em>
<a id="L421" name="L421"></a> 421                     <a href="../S/5889.html#L2295" title="Defined at 2295 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">popShouldStripWhitespace</a>();
<a id="L422" name="L422"></a> 422                     <em class="comment">// Fix and pop DTM</em>
<a id="L423" name="L423"></a> 423                     <strong class="reserved">if</strong>(m_last_kid==<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L424" name="L424"></a> 424                       m_firstch.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,m_last_parent); <em class="comment">// Popping from an element</em>
<a id="L425" name="L425"></a> 425                     <strong class="reserved">else</strong>
<a id="L426" name="L426"></a> 426                       m_nextsib.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,m_last_kid); <em class="comment">// Popping from anything else</em>
<a id="L427" name="L427"></a> 427                     m_last_parent=m_parent.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(m_last_kid=m_last_parent);
<a id="L428" name="L428"></a> 428                   <em class="brace">}</em>
<a id="L429" name="L429"></a> 429               <em class="brace">}</em>
<a id="L430" name="L430"></a> 430             <strong class="reserved">if</strong>(m_last_parent==<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L431" name="L431"></a> 431               <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>=<strong class="reserved">null</strong>;
<a id="L432" name="L432"></a> 432           <em class="brace">}</em>
<a id="L433" name="L433"></a> 433 
<a id="L434" name="L434"></a> 434         <strong class="reserved">if</strong>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>!=<strong class="reserved">null</strong>)
<a id="L435" name="L435"></a> 435           nexttype=<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>();
<a id="L436" name="L436"></a> 436 
<a id="L437" name="L437"></a> 437         <em class="comment">// If it's an entity ref, advance past it.</em>
<a id="L438" name="L438"></a> 438         <em class="comment">//</em>
<a id="L439" name="L439"></a> 439         <em class="comment">// %REVIEW% Should we let this out the door and just suppress it?</em>
<a id="L440" name="L440"></a> 440         <em class="comment">// More work, but simpler code, more likely to be correct, and</em>
<a id="L441" name="L441"></a> 441         <em class="comment">// it doesn't happen very often. We'd get rid of the loop too.</em>
<a id="L442" name="L442"></a> 442         <strong class="reserved">if</strong> (ENTITY_REFERENCE_NODE == nexttype)
<a id="L443" name="L443"></a> 443           pos=<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L444" name="L444"></a> 444       <em class="brace">}</em>
<a id="L445" name="L445"></a> 445     <strong class="reserved">while</strong> (ENTITY_REFERENCE_NODE == nexttype);
<a id="L446" name="L446"></a> 446 
<a id="L447" name="L447"></a> 447     <em class="comment">// Did we run out of the tree?</em>
<a id="L448" name="L448"></a> 448     <strong class="reserved">if</strong>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>==<strong class="reserved">null</strong>)
<a id="L449" name="L449"></a> 449       <em class="brace">{</em>
<a id="L450" name="L450"></a> 450         m_nextsib.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,0);
<a id="L451" name="L451"></a> 451         m_nodesAreProcessed = <strong class="reserved">true</strong>;
<a id="L452" name="L452"></a> 452         m_pos=<strong class="reserved">null</strong>;
<a id="L453" name="L453"></a> 453 
<a id="L454" name="L454"></a> 454         <strong class="reserved">if</strong>(JJK_DEBUG)
<a id="L455" name="L455"></a> 455           <em class="brace">{</em>
<a id="L456" name="L456"></a> 456             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("***** DOM2DTM Crosscheck:");
<a id="L457" name="L457"></a> 457             <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i=0;i&lt;m_nodes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();++i)
<a id="L458" name="L458"></a> 458               <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>(i+":\t"+m_firstch.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i)+"\t"+m_nextsib.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i));
<a id="L459" name="L459"></a> 459           <em class="brace">}</em>
<a id="L460" name="L460"></a> 460 
<a id="L461" name="L461"></a> 461         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L462" name="L462"></a> 462       <em class="brace">}</em>
<a id="L463" name="L463"></a> 463 
<a id="L464" name="L464"></a> 464     <em class="comment">// Text needs some special handling:</em>
<a id="L465" name="L465"></a> 465     <em class="comment">//</em>
<a id="L466" name="L466"></a> 466     <em class="comment">// DTM may skip whitespace. This is handled by the suppressNode flag, which</em>
<a id="L467" name="L467"></a> 467     <em class="comment">// when true will keep the DTM node from being created.</em>
<a id="L468" name="L468"></a> 468     <em class="comment">//</em>
<a id="L469" name="L469"></a> 469     <em class="comment">// DTM only directly records the first DOM node of any logically-contiguous</em>
<a id="L470" name="L470"></a> 470     <em class="comment">// sequence. The lastTextNode value will be set to the last node in the</em>
<a id="L471" name="L471"></a> 471     <em class="comment">// contiguous sequence, and -- AFTER the DTM addNode -- can be used to</em>
<a id="L472" name="L472"></a> 472     <em class="comment">// advance next over this whole block. Should be simpler than special-casing</em>
<a id="L473" name="L473"></a> 473     <em class="comment">// the above loop for "Was the logically-preceeding sibling a text node".</em>
<a id="L474" name="L474"></a> 474     <em class="comment">//</em>
<a id="L475" name="L475"></a> 475     <em class="comment">// Finally, a DTM node should be considered a CDATASection only if all the</em>
<a id="L476" name="L476"></a> 476     <em class="comment">// contiguous text it covers is CDATASections. The first Text should</em>
<a id="L477" name="L477"></a> 477     <em class="comment">// force DTM to Text.</em>
<a id="L478" name="L478"></a> 478 
<a id="L479" name="L479"></a> 479     <strong class="reserved">boolean</strong> suppressNode=<strong class="reserved">false</strong>;
<a id="L480" name="L480"></a> 480     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> lastTextNode=<strong class="reserved">null</strong>;
<a id="L481" name="L481"></a> 481 
<a id="L482" name="L482"></a> 482     nexttype=<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>();
<a id="L483" name="L483"></a> 483 
<a id="L484" name="L484"></a> 484     <em class="comment">// nexttype=pos.getNodeType();</em>
<a id="L485" name="L485"></a> 485     <strong class="reserved">if</strong>(TEXT_NODE == nexttype || CDATA_SECTION_NODE == nexttype)
<a id="L486" name="L486"></a> 486       <em class="brace">{</em>
<a id="L487" name="L487"></a> 487         <em class="comment">// If filtering, initially assume we're going to suppress the node</em>
<a id="L488" name="L488"></a> 488         suppressNode=((<strong class="reserved">null</strong> != m_wsfilter) &amp;&amp; <a href="../D/22489.html" title="Multiple defined in 2 places.">getShouldStripWhitespace</a>());
<a id="L489" name="L489"></a> 489 
<a id="L490" name="L490"></a> 490         <em class="comment">// Scan logically contiguous text (siblings, plus "flattening"</em>
<a id="L491" name="L491"></a> 491         <em class="comment">// of entity reference boundaries).</em>
<a id="L492" name="L492"></a> 492         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> n=<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L493" name="L493"></a> 493         <strong class="reserved">while</strong>(n!=<strong class="reserved">null</strong>)
<a id="L494" name="L494"></a> 494           <em class="brace">{</em>
<a id="L495" name="L495"></a> 495             lastTextNode=n;
<a id="L496" name="L496"></a> 496             <em class="comment">// Any Text node means DTM considers it all Text</em>
<a id="L497" name="L497"></a> 497             <strong class="reserved">if</strong>(TEXT_NODE == n.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L498" name="L498"></a> 498               nexttype=TEXT_NODE;
<a id="L499" name="L499"></a> 499             <em class="comment">// Any non-whitespace in this sequence blocks whitespace</em>
<a id="L500" name="L500"></a> 500             <em class="comment">// suppression</em>
<a id="L501" name="L501"></a> 501             suppressNode &amp;=
<a id="L502" name="L502"></a> 502               <a href="../S/5871.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/utils/XMLCharacterRecognizer.java.">XMLCharacterRecognizer</a>.<a href="../D/26505.html" title="Multiple defined in 15 places.">isWhiteSpace</a>(n.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>());
<a id="L503" name="L503"></a> 503 
<a id="L504" name="L504"></a> 504             n=<a href="../S/5895.html#L1189" title="Defined at 1189 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">logicalNextDOMTextNode</a>(n);
<a id="L505" name="L505"></a> 505           <em class="brace">}</em>
<a id="L506" name="L506"></a> 506       <em class="brace">}</em>
<a id="L507" name="L507"></a> 507 
<a id="L508" name="L508"></a> 508     <em class="comment">// Special handling for PIs: Some DOMs represent the XML</em>
<a id="L509" name="L509"></a> 509     <em class="comment">// Declaration as a PI. This is officially incorrect, per the DOM</em>
<a id="L510" name="L510"></a> 510     <em class="comment">// spec, but is considered a "wrong but tolerable" temporary</em>
<a id="L511" name="L511"></a> 511     <em class="comment">// workaround pending proper handling of these fields in DOM Level</em>
<a id="L512" name="L512"></a> 512     <em class="comment">// 3. We want to recognize and reject that case.</em>
<a id="L513" name="L513"></a> 513     <strong class="reserved">else</strong> <strong class="reserved">if</strong>(PROCESSING_INSTRUCTION_NODE==nexttype)
<a id="L514" name="L514"></a> 514       <em class="brace">{</em>
<a id="L515" name="L515"></a> 515         suppressNode = (pos.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>().<a href="../D/35437.html" title="Multiple defined in 19 places.">toLowerCase</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("xml"));
<a id="L516" name="L516"></a> 516       <em class="brace">}</em>
<a id="L517" name="L517"></a> 517 
<a id="L518" name="L518"></a> 518 
<a id="L519" name="L519"></a> 519     <strong class="reserved">if</strong>(!suppressNode)
<a id="L520" name="L520"></a> 520       <em class="brace">{</em>
<a id="L521" name="L521"></a> 521         <em class="comment">// Inserting next. NOTE that we force the node type; for</em>
<a id="L522" name="L522"></a> 522         <em class="comment">// coalesced Text, this records CDATASections adjacent to</em>
<a id="L523" name="L523"></a> 523         <em class="comment">// ordinary Text as Text.</em>
<a id="L524" name="L524"></a> 524         <strong class="reserved">int</strong> nextindex=<a href="../D/10963.html" title="Multiple defined in 6 places.">addNode</a>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>,m_last_parent,m_last_kid,
<a id="L525" name="L525"></a> 525                               nexttype);
<a id="L526" name="L526"></a> 526 
<a id="L527" name="L527"></a> 527         m_last_kid=nextindex;
<a id="L528" name="L528"></a> 528 
<a id="L529" name="L529"></a> 529         <strong class="reserved">if</strong>(ELEMENT_NODE == nexttype)
<a id="L530" name="L530"></a> 530           <em class="brace">{</em>
<a id="L531" name="L531"></a> 531             <strong class="reserved">int</strong> attrIndex=<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>; <em class="comment">// start with no previous sib</em>
<a id="L532" name="L532"></a> 532             <em class="comment">// Process attributes _now_, rather than waiting.</em>
<a id="L533" name="L533"></a> 533             <em class="comment">// Simpler control flow, makes NS cache available immediately.</em>
<a id="L534" name="L534"></a> 534             <a href="../S/114.html#L56" title="Defined at 56 in src/org/w3c/dom/NamedNodeMap.java.">NamedNodeMap</a> attrs=<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>.<a href="../D/17112.html" title="Multiple defined in 109 places.">getAttributes</a>();
<a id="L535" name="L535"></a> 535             <strong class="reserved">int</strong> attrsize=(attrs==<strong class="reserved">null</strong>) ? 0 : attrs.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>();
<a id="L536" name="L536"></a> 536             <strong class="reserved">if</strong>(attrsize&gt;0)
<a id="L537" name="L537"></a> 537               <em class="brace">{</em>
<a id="L538" name="L538"></a> 538                 <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i=0;i&lt;attrsize;++i)
<a id="L539" name="L539"></a> 539                   <em class="brace">{</em>
<a id="L540" name="L540"></a> 540                     <em class="comment">// No need to force nodetype in this case;</em>
<a id="L541" name="L541"></a> 541                     <em class="comment">// addNode() will take care of switching it from</em>
<a id="L542" name="L542"></a> 542                     <em class="comment">// Attr to Namespace if necessary.</em>
<a id="L543" name="L543"></a> 543                     attrIndex=<a href="../D/10963.html" title="Multiple defined in 6 places.">addNode</a>(attrs.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>(i),
<a id="L544" name="L544"></a> 544                                       nextindex,attrIndex,<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L545" name="L545"></a> 545                     m_firstch.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,attrIndex);
<a id="L546" name="L546"></a> 546 
<a id="L547" name="L547"></a> 547                     <em class="comment">// If the xml: prefix is explicitly declared</em>
<a id="L548" name="L548"></a> 548                     <em class="comment">// we don't need to synthesize one.</em>
<a id="L549" name="L549"></a> 549                     <em class="comment">//</em>
<a id="L550" name="L550"></a> 550                     <em class="comment">// NOTE that XML Namespaces were not originally</em>
<a id="L551" name="L551"></a> 551                     <em class="comment">// defined as being namespace-aware (grrr), and</em>
<a id="L552" name="L552"></a> 552                     <em class="comment">// while the W3C is planning to fix this it's</em>
<a id="L553" name="L553"></a> 553                     <em class="comment">// safer for now to test the QName and trust the</em>
<a id="L554" name="L554"></a> 554                     <em class="comment">// parsers to prevent anyone from redefining the</em>
<a id="L555" name="L555"></a> 555                     <em class="comment">// reserved xmlns: prefix</em>
<a id="L556" name="L556"></a> 556                     <strong class="reserved">if</strong>(!m_processedFirstElement
<a id="L557" name="L557"></a> 557                        &amp;&amp; "xmlns:xml".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(attrs.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>(i).<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>()))
<a id="L558" name="L558"></a> 558                       m_processedFirstElement=<strong class="reserved">true</strong>;
<a id="L559" name="L559"></a> 559                   <em class="brace">}</em>
<a id="L560" name="L560"></a> 560                 <em class="comment">// Terminate list of attrs, and make sure they aren't</em>
<a id="L561" name="L561"></a> 561                 <em class="comment">// considered children of the element</em>
<a id="L562" name="L562"></a> 562               <em class="brace">}</em> <em class="comment">// if attrs exist</em>
<a id="L563" name="L563"></a> 563             <strong class="reserved">if</strong>(!m_processedFirstElement)
<a id="L564" name="L564"></a> 564             <em class="brace">{</em>
<a id="L565" name="L565"></a> 565               <em class="comment">// The DOM might not have an explicit declaration for the</em>
<a id="L566" name="L566"></a> 566               <em class="comment">// implicit "xml:" prefix, but the XPath data model</em>
<a id="L567" name="L567"></a> 567               <em class="comment">// requires that this appear as a Namespace Node so we</em>
<a id="L568" name="L568"></a> 568               <em class="comment">// have to synthesize one. You can think of this as</em>
<a id="L569" name="L569"></a> 569               <em class="comment">// being a default attribute defined by the XML</em>
<a id="L570" name="L570"></a> 570               <em class="comment">// Namespaces spec rather than by the DTD.</em>
<a id="L571" name="L571"></a> 571               attrIndex=<a href="../D/10963.html" title="Multiple defined in 6 places.">addNode</a>(<strong class="reserved">new</strong> <a href="../S/5894.html#L55" title="Defined at 55 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTMdefaultNamespaceDeclarationNode.java.">DOM2DTMdefaultNamespaceDeclarationNode</a>(
<a id="L572" name="L572"></a> 572                                                                                                                                         (<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a>)<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>,"xml",NAMESPACE_DECL_NS,
<a id="L573" name="L573"></a> 573                                                                                                                                         <a href="../S/5889.html#L902" title="Defined at 902 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeHandle</a>(((attrIndex==<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)?nextindex:attrIndex)+1)
<a id="L574" name="L574"></a> 574                                                                                                                                         ),
<a id="L575" name="L575"></a> 575                                 nextindex,attrIndex,<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L576" name="L576"></a> 576               m_firstch.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,attrIndex);
<a id="L577" name="L577"></a> 577               m_processedFirstElement=<strong class="reserved">true</strong>;
<a id="L578" name="L578"></a> 578             <em class="brace">}</em>
<a id="L579" name="L579"></a> 579             <strong class="reserved">if</strong>(attrIndex!=<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L580" name="L580"></a> 580               m_nextsib.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>,attrIndex);
<a id="L581" name="L581"></a> 581           <em class="brace">}</em> <em class="comment">//if(ELEMENT_NODE)</em>
<a id="L582" name="L582"></a> 582       <em class="brace">}</em> <em class="comment">// (if !suppressNode)</em>
<a id="L583" name="L583"></a> 583 
<a id="L584" name="L584"></a> 584     <em class="comment">// Text postprocessing: Act on values stored above</em>
<a id="L585" name="L585"></a> 585     <strong class="reserved">if</strong>(TEXT_NODE == nexttype || CDATA_SECTION_NODE == nexttype)
<a id="L586" name="L586"></a> 586       <em class="brace">{</em>
<a id="L587" name="L587"></a> 587         <em class="comment">// %TBD% If nexttype was forced to TEXT, patch the DTM node</em>
<a id="L588" name="L588"></a> 588 
<a id="L589" name="L589"></a> 589         <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>=lastTextNode;      <em class="comment">// Advance the DOM cursor over contiguous text</em>
<a id="L590" name="L590"></a> 590       <em class="brace">}</em>
<a id="L591" name="L591"></a> 591 
<a id="L592" name="L592"></a> 592     <em class="comment">// Remember where we left off.</em>
<a id="L593" name="L593"></a> 593     m_pos=<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L594" name="L594"></a> 594     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L595" name="L595"></a> 595   <em class="brace">}</em>
<a id="L596" name="L596"></a> 596 
<a id="L597" name="L597"></a> 597 
<div class="comment">
    Return an DOM node for the given node.
    @param nodeHandle The node ID.
    @return A node representation of the DTM node.</div>
<a id="L605" name="L605"></a> 605   <strong class="reserved">public</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../R/17972.html" title="Multiple referred from 119 places.">getNode</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L606" name="L606"></a> 606   <em class="brace">{</em>
<a id="L607" name="L607"></a> 607 
<a id="L608" name="L608"></a> 608     <strong class="reserved">int</strong> <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a> = <a href="../S/5889.html#L929" title="Defined at 929 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeIdentity</a>(nodeHandle);
<a id="L609" name="L609"></a> 609 
<a id="L610" name="L610"></a> 610     <strong class="reserved">return</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>) m_nodes.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>);
<a id="L611" name="L611"></a> 611   <em class="brace">}</em>
<a id="L612" name="L612"></a> 612 
<div class="comment">
    Get a Node from an identity index.
    NEEDSDOC @param nodeIdentity
    NEEDSDOC ($objectName$) @return</div>
<a id="L620" name="L620"></a> 620   <strong class="reserved">protected</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../S/5895.html#L782" title="Referred from 782 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">lookupNode</a>(<strong class="reserved">int</strong> nodeIdentity)
<a id="L621" name="L621"></a> 621   <em class="brace">{</em>
<a id="L622" name="L622"></a> 622     <strong class="reserved">return</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>) m_nodes.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(nodeIdentity);
<a id="L623" name="L623"></a> 623   <em class="brace">}</em>
<a id="L624" name="L624"></a> 624 
<div class="comment">
    Get the next node identity value in the list, and call the iterator
    if it hasn't been added yet.
    @param identity The node identity (index).
    @return identity+1, or DTM.NULL.</div>
<a id="L632" name="L632"></a> 632   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/17935.html" title="Multiple referred from 9 places.">getNextNodeIdentity</a>(<strong class="reserved">int</strong> <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>)
<a id="L633" name="L633"></a> 633   <em class="brace">{</em>
<a id="L634" name="L634"></a> 634 
<a id="L635" name="L635"></a> 635     <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a> += 1;
<a id="L636" name="L636"></a> 636 
<a id="L637" name="L637"></a> 637     <strong class="reserved">if</strong> (<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a> &gt;= m_nodes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>())
<a id="L638" name="L638"></a> 638     <em class="brace">{</em>
<a id="L639" name="L639"></a> 639       <strong class="reserved">if</strong> (!<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>())
<a id="L640" name="L640"></a> 640         <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a> = <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L641" name="L641"></a> 641     <em class="brace">}</em>
<a id="L642" name="L642"></a> 642 
<a id="L643" name="L643"></a> 643     <strong class="reserved">return</strong> <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>;
<a id="L644" name="L644"></a> 644   <em class="brace">}</em>
<a id="L645" name="L645"></a> 645 
<div class="comment">
    Get the handle from a Node.
    <p>%OPT% This will be pretty slow.</p>
    <p>%OPT% An XPath-like search (walk up DOM to root, tracking path;
    walk down DTM reconstructing path) might be considerably faster
    on later nodes in large documents. That might also imply improving
    this call to handle nodes which would be in this DTM but
    have not yet been built, which might or might not be a Good Thing.</p>
    %REVIEW% This relies on being able to test node-identity via
    object-identity. DTM2DOM proxying is a great example of a case where
    that doesn't work. DOM Level 3 will provide the isSameNode() method
    to fix that, but until then this is going to be flaky.
    @param node A node, which may be null.
    @return The node handle or <code>DTM.NULL</code>.</div>
<a id="L665" name="L665"></a> 665   <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/16848.html" title="Multiple referred from 3 places.">getHandleFromNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L666" name="L666"></a> 666   <em class="brace">{</em>
<a id="L667" name="L667"></a> 667     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L668" name="L668"></a> 668     <em class="brace">{</em>
<a id="L669" name="L669"></a> 669       <strong class="reserved">int</strong> len = m_nodes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L670" name="L670"></a> 670       <strong class="reserved">boolean</strong> isMore;
<a id="L671" name="L671"></a> 671       <strong class="reserved">int</strong> i = 0;
<a id="L672" name="L672"></a> 672       <strong class="reserved">do</strong>
<a id="L673" name="L673"></a> 673       <em class="brace">{</em>
<a id="L674" name="L674"></a> 674         <strong class="reserved">for</strong> (; i &lt; len; i++)
<a id="L675" name="L675"></a> 675         <em class="brace">{</em>
<a id="L676" name="L676"></a> 676           <strong class="reserved">if</strong> (m_nodes.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i) == <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L677" name="L677"></a> 677             <strong class="reserved">return</strong> <a href="../S/5889.html#L902" title="Defined at 902 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeHandle</a>(i);
<a id="L678" name="L678"></a> 678         <em class="brace">}</em>
<a id="L679" name="L679"></a> 679 
<a id="L680" name="L680"></a> 680         isMore = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>();
<a id="L681" name="L681"></a> 681 
<a id="L682" name="L682"></a> 682         len = m_nodes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L683" name="L683"></a> 683 
<a id="L684" name="L684"></a> 684       <em class="brace">}</em>
<a id="L685" name="L685"></a> 685       <strong class="reserved">while</strong>(isMore || i &lt; len);
<a id="L686" name="L686"></a> 686     <em class="brace">}</em>
<a id="L687" name="L687"></a> 687 
<a id="L688" name="L688"></a> 688     <strong class="reserved">return</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L689" name="L689"></a> 689   <em class="brace">}</em>
<a id="L690" name="L690"></a> 690 
<div class="comment">
 Get the handle from a Node. This is a more robust version of
    getHandleFromNode, intended to be usable by the public.
    <p>%OPT% This will be pretty slow.</p>
    %REVIEW% This relies on being able to test node-identity via
    object-identity. DTM2DOM proxying is a great example of a case where
    that doesn't work. DOM Level 3 will provide the isSameNode() method
    to fix that, but until then this is going to be flaky.
    @param node A node, which may be null.
   * @return The node handle or <code>DTM.NULL</code>.  </div>
<a id="L704" name="L704"></a> 704   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/16849.html" title="Multiple referred from 3 places.">getHandleOfNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L705" name="L705"></a> 705   <em class="brace">{</em>
<a id="L706" name="L706"></a> 706     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L707" name="L707"></a> 707     <em class="brace">{</em>
<a id="L708" name="L708"></a> 708       <em class="comment">// Is Node actually within the same document? If not, don't search!</em>
<a id="L709" name="L709"></a> 709       <em class="comment">// This would be easier if m_root was always the Document node, but</em>
<a id="L710" name="L710"></a> 710       <em class="comment">// we decided to allow wrapping a DTM around a subtree.</em>
<a id="L711" name="L711"></a> 711       <strong class="reserved">if</strong>((m_root==<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>) ||
<a id="L712" name="L712"></a> 712          (m_root.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>()==DOCUMENT_NODE &amp;&amp;
<a id="L713" name="L713"></a> 713           m_root==<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/21292.html" title="Multiple defined in 20 places.">getOwnerDocument</a>()) ||
<a id="L714" name="L714"></a> 714          (m_root.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>()!=DOCUMENT_NODE &amp;&amp;
<a id="L715" name="L715"></a> 715           m_root.<a href="../D/21292.html" title="Multiple defined in 20 places.">getOwnerDocument</a>()==<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/21292.html" title="Multiple defined in 20 places.">getOwnerDocument</a>())
<a id="L716" name="L716"></a> 716          )
<a id="L717" name="L717"></a> 717         <em class="brace">{</em>
<a id="L718" name="L718"></a> 718           <em class="comment">// If node _is_ in m_root's tree, find its handle</em>
<a id="L719" name="L719"></a> 719           <em class="comment">//</em>
<a id="L720" name="L720"></a> 720           <em class="comment">// %OPT% This check may be improved significantly when DOM</em>
<a id="L721" name="L721"></a> 721           <em class="comment">// Level 3 nodeKey and relative-order tests become</em>
<a id="L722" name="L722"></a> 722           <em class="comment">// available!</em>
<a id="L723" name="L723"></a> 723           <strong class="reserved">for</strong>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../S/986.html#L3222" title="Defined at 3222 in src/java/util/regex/Pattern.java.">cursor</a>=<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>;
<a id="L724" name="L724"></a> 724               <a href="../S/986.html#L3222" title="Defined at 3222 in src/java/util/regex/Pattern.java.">cursor</a>!=<strong class="reserved">null</strong>;
<a id="L725" name="L725"></a> 725               <a href="../S/986.html#L3222" title="Defined at 3222 in src/java/util/regex/Pattern.java.">cursor</a>=
<a id="L726" name="L726"></a> 726                 (<a href="../S/986.html#L3222" title="Defined at 3222 in src/java/util/regex/Pattern.java.">cursor</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>()!=ATTRIBUTE_NODE)
<a id="L727" name="L727"></a> 727                 ? <a href="../S/986.html#L3222" title="Defined at 3222 in src/java/util/regex/Pattern.java.">cursor</a>.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>()
<a id="L728" name="L728"></a> 728                 : ((org.w3c.dom.<a href="../S/54.html#L186" title="Defined at 186 in src/org/w3c/dom/Attr.java.">Attr</a>)<a href="../S/986.html#L3222" title="Defined at 3222 in src/java/util/regex/Pattern.java.">cursor</a>).<a href="../D/21293.html" title="Multiple defined in 9 places.">getOwnerElement</a>())
<a id="L729" name="L729"></a> 729             <em class="brace">{</em>
<a id="L730" name="L730"></a> 730               <strong class="reserved">if</strong>(<a href="../S/986.html#L3222" title="Defined at 3222 in src/java/util/regex/Pattern.java.">cursor</a>==m_root)
<a id="L731" name="L731"></a> 731                 <em class="comment">// We know this node; find its handle.</em>
<a id="L732" name="L732"></a> 732                 <strong class="reserved">return</strong> <a href="../S/5895.html#L665" title="Defined at 665 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">getHandleFromNode</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L733" name="L733"></a> 733             <em class="brace">}</em> <em class="comment">// for ancestors of node</em>
<a id="L734" name="L734"></a> 734         <em class="brace">}</em> <em class="comment">// if node and m_root in same Document</em>
<a id="L735" name="L735"></a> 735     <em class="brace">}</em> <em class="comment">// if node!=null</em>
<a id="L736" name="L736"></a> 736 
<a id="L737" name="L737"></a> 737     <strong class="reserved">return</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L738" name="L738"></a> 738   <em class="brace">}</em>
<a id="L739" name="L739"></a> 739 
<div class="comment">
    Retrieves an attribute node by by qualified name and namespace URI.
    @param nodeHandle int Handle of the node upon which to look up this attribute..
    @param namespaceURI The namespace URI of the attribute to
      retrieve, or null.
    @param name The local name of the attribute to
      retrieve.
    @return The attribute node handle with the specified name (
      <code>nodeName</code>) or <code>DTM.NULL</code> if there is no such
      attribute.</div>
<a id="L752" name="L752"></a> 752   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/15154.html" title="Multiple referred from 32 places.">getAttributeNode</a>(<strong class="reserved">int</strong> nodeHandle, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/3963.html#L58" title="Defined at 58 in src/javax/xml/bind/annotation/XmlNs.java.">namespaceURI</a>,
<a id="L753" name="L753"></a> 753                               <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L754" name="L754"></a> 754   <em class="brace">{</em>
<a id="L755" name="L755"></a> 755 
<a id="L756" name="L756"></a> 756     <em class="comment">// %OPT% This is probably slower than it needs to be.</em>
<a id="L757" name="L757"></a> 757     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/3963.html#L58" title="Defined at 58 in src/javax/xml/bind/annotation/XmlNs.java.">namespaceURI</a>)
<a id="L758" name="L758"></a> 758       <a href="../S/3963.html#L58" title="Defined at 58 in src/javax/xml/bind/annotation/XmlNs.java.">namespaceURI</a> = "";
<a id="L759" name="L759"></a> 759 
<a id="L760" name="L760"></a> 760     <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle);
<a id="L761" name="L761"></a> 761 
<a id="L762" name="L762"></a> 762     <strong class="reserved">if</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L763" name="L763"></a> 763     <em class="brace">{</em>
<a id="L764" name="L764"></a> 764 
<a id="L765" name="L765"></a> 765       <em class="comment">// Assume that attributes immediately follow the element.</em>
<a id="L766" name="L766"></a> 766       <strong class="reserved">int</strong> <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a> = <a href="../S/5889.html#L929" title="Defined at 929 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeIdentity</a>(nodeHandle);
<a id="L767" name="L767"></a> 767 
<a id="L768" name="L768"></a> 768       <strong class="reserved">while</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != (<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a> = <a href="../D/20923.html" title="Multiple defined in 3 places.">getNextNodeIdentity</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>)))
<a id="L769" name="L769"></a> 769       <em class="brace">{</em>
<a id="L770" name="L770"></a> 770         <em class="comment">// Assume this can not be null.</em>
<a id="L771" name="L771"></a> 771         <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/10508.html" title="Multiple defined in 126 places.">_type</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>);
<a id="L772" name="L772"></a> 772 
<a id="L773" name="L773"></a> 773                                 <em class="comment">// %REVIEW%</em>
<a id="L774" name="L774"></a> 774                                 <em class="comment">// Should namespace nodes be retrievable DOM-style as attrs?</em>
<a id="L775" name="L775"></a> 775                                 <em class="comment">// If not we need a separate function... which may be desirable</em>
<a id="L776" name="L776"></a> 776                                 <em class="comment">// architecturally, but which is ugly from a code point of view.</em>
<a id="L777" name="L777"></a> 777                                 <em class="comment">// (If we REALLY insist on it, this code should become a subroutine</em>
<a id="L778" name="L778"></a> 778                                 <em class="comment">// of both -- retrieve the node, then test if the type matches</em>
<a id="L779" name="L779"></a> 779                                 <em class="comment">// what you're looking for.)</em>
<a id="L780" name="L780"></a> 780         <strong class="reserved">if</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE || <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>==<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE)
<a id="L781" name="L781"></a> 781         <em class="brace">{</em>
<a id="L782" name="L782"></a> 782           <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../S/5895.html#L620" title="Defined at 620 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">lookupNode</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>);
<a id="L783" name="L783"></a> 783           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> nodeuri = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20828.html" title="Multiple defined in 47 places.">getNamespaceURI</a>();
<a id="L784" name="L784"></a> 784 
<a id="L785" name="L785"></a> 785           <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == nodeuri)
<a id="L786" name="L786"></a> 786             nodeuri = "";
<a id="L787" name="L787"></a> 787 
<a id="L788" name="L788"></a> 788           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> nodelocalname = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20201.html" title="Multiple defined in 44 places.">getLocalName</a>();
<a id="L789" name="L789"></a> 789 
<a id="L790" name="L790"></a> 790           <strong class="reserved">if</strong> (nodeuri.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../S/3963.html#L58" title="Defined at 58 in src/javax/xml/bind/annotation/XmlNs.java.">namespaceURI</a>) &amp;&amp; <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(nodelocalname))
<a id="L791" name="L791"></a> 791             <strong class="reserved">return</strong> <a href="../S/5889.html#L902" title="Defined at 902 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeHandle</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>);
<a id="L792" name="L792"></a> 792         <em class="brace">}</em>
<a id="L793" name="L793"></a> 793 
<a id="L794" name="L794"></a> 794         <strong class="reserved">else</strong> <em class="comment">// if (DTM.NAMESPACE_NODE != type)</em>
<a id="L795" name="L795"></a> 795         <em class="brace">{</em>
<a id="L796" name="L796"></a> 796           <strong class="reserved">break</strong>;
<a id="L797" name="L797"></a> 797         <em class="brace">}</em>
<a id="L798" name="L798"></a> 798       <em class="brace">}</em>
<a id="L799" name="L799"></a> 799     <em class="brace">}</em>
<a id="L800" name="L800"></a> 800 
<a id="L801" name="L801"></a> 801     <strong class="reserved">return</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L802" name="L802"></a> 802   <em class="brace">}</em>
<a id="L803" name="L803"></a> 803 
<div class="comment">
    Get the string-value of a node as a String object
    (see http://www.w3.org/TR/xpath#data-model
    for the definition of a node's string-value).
    @param nodeHandle The node ID.
    @return A string object that represents the string-value of the given node.</div>
<a id="L813" name="L813"></a> 813   <strong class="reserved">public</strong> <a href="../D/10017.html" title="Multiple defined in 2 places.">XMLString</a> <a href="../R/19227.html" title="Multiple referred from 38 places.">getStringValue</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L814" name="L814"></a> 814   <em class="brace">{</em>
<a id="L815" name="L815"></a> 815 
<a id="L816" name="L816"></a> 816     <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle);
<a id="L817" name="L817"></a> 817     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L818" name="L818"></a> 818     <em class="comment">// %TBD% If an element only has one text node, we should just use it</em>
<a id="L819" name="L819"></a> 819     <em class="comment">// directly.</em>
<a id="L820" name="L820"></a> 820     <strong class="reserved">if</strong>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> || <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.DOCUMENT_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>
<a id="L821" name="L821"></a> 821     || <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.DOCUMENT_FRAGMENT_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L822" name="L822"></a> 822     <em class="brace">{</em>
<a id="L823" name="L823"></a> 823       <a href="../S/5847.html#L56" title="Defined at 56 in src/com/sun/org/apache/xml/internal/utils/FastStringBuffer.java.">FastStringBuffer</a> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a> = <a href="../S/5869.html#L31" title="Defined at 31 in src/com/sun/org/apache/xml/internal/utils/StringBufferPool.java.">StringBufferPool</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L824" name="L824"></a> 824       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s;
<a id="L825" name="L825"></a> 825 
<a id="L826" name="L826"></a> 826       <strong class="reserved">try</strong>
<a id="L827" name="L827"></a> 827       <em class="brace">{</em>
<a id="L828" name="L828"></a> 828         <a href="../D/20973.html" title="Multiple defined in 5 places.">getNodeData</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>, <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>);
<a id="L829" name="L829"></a> 829 
<a id="L830" name="L830"></a> 830         s = (<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt; 0) ? <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() : "";
<a id="L831" name="L831"></a> 831       <em class="brace">}</em>
<a id="L832" name="L832"></a> 832       <strong class="reserved">finally</strong>
<a id="L833" name="L833"></a> 833       <em class="brace">{</em>
<a id="L834" name="L834"></a> 834         <a href="../S/5869.html#L31" title="Defined at 31 in src/com/sun/org/apache/xml/internal/utils/StringBufferPool.java.">StringBufferPool</a>.<a href="../D/16577.html" title="Multiple defined in 8 places.">free</a>(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>);
<a id="L835" name="L835"></a> 835       <em class="brace">}</em>
<a id="L836" name="L836"></a> 836 
<a id="L837" name="L837"></a> 837       <strong class="reserved">return</strong> m_xstrf.<a href="../D/28130.html" title="Multiple defined in 9 places.">newstr</a>( s );
<a id="L838" name="L838"></a> 838     <em class="brace">}</em>
<a id="L839" name="L839"></a> 839     <strong class="reserved">else</strong> <strong class="reserved">if</strong>(TEXT_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> || CDATA_SECTION_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L840" name="L840"></a> 840     <em class="brace">{</em>
<a id="L841" name="L841"></a> 841       <em class="comment">// If this is a DTM text node, it may be made of multiple DOM text</em>
<a id="L842" name="L842"></a> 842       <em class="comment">// nodes -- including navigating into Entity References. DOM2DTM</em>
<a id="L843" name="L843"></a> 843       <em class="comment">// records the first node in the sequence and requires that we</em>
<a id="L844" name="L844"></a> 844       <em class="comment">// pick up the others when we retrieve the DTM node's value.</em>
<a id="L845" name="L845"></a> 845       <em class="comment">//</em>
<a id="L846" name="L846"></a> 846       <em class="comment">// %REVIEW% DOM Level 3 is expected to add a "whole text"</em>
<a id="L847" name="L847"></a> 847       <em class="comment">// retrieval method which performs this function for us.</em>
<a id="L848" name="L848"></a> 848       <a href="../S/5847.html#L56" title="Defined at 56 in src/com/sun/org/apache/xml/internal/utils/FastStringBuffer.java.">FastStringBuffer</a> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a> = <a href="../S/5869.html#L31" title="Defined at 31 in src/com/sun/org/apache/xml/internal/utils/StringBufferPool.java.">StringBufferPool</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L849" name="L849"></a> 849       <strong class="reserved">while</strong>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>!=<strong class="reserved">null</strong>)
<a id="L850" name="L850"></a> 850       <em class="brace">{</em>
<a id="L851" name="L851"></a> 851         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>());
<a id="L852" name="L852"></a> 852         <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>=<a href="../S/5895.html#L1189" title="Defined at 1189 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">logicalNextDOMTextNode</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L853" name="L853"></a> 853       <em class="brace">}</em>
<a id="L854" name="L854"></a> 854       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s=(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt; 0) ? <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() : "";
<a id="L855" name="L855"></a> 855       <a href="../S/5869.html#L31" title="Defined at 31 in src/com/sun/org/apache/xml/internal/utils/StringBufferPool.java.">StringBufferPool</a>.<a href="../D/16577.html" title="Multiple defined in 8 places.">free</a>(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>);
<a id="L856" name="L856"></a> 856       <strong class="reserved">return</strong> m_xstrf.<a href="../D/28130.html" title="Multiple defined in 9 places.">newstr</a>( s );
<a id="L857" name="L857"></a> 857     <em class="brace">}</em>
<a id="L858" name="L858"></a> 858     <strong class="reserved">else</strong>
<a id="L859" name="L859"></a> 859       <strong class="reserved">return</strong> m_xstrf.<a href="../D/28130.html" title="Multiple defined in 9 places.">newstr</a>( <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>() );
<a id="L860" name="L860"></a> 860   <em class="brace">}</em>
<a id="L861" name="L861"></a> 861 
<div class="comment">
    Determine if the string-value of a node is whitespace
    @param nodeHandle The node Handle.
    @return Return true if the given node is whitespace.</div>
<a id="L869" name="L869"></a> 869   <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/22238.html" title="Multiple referred from 54 places.">isWhitespace</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L870" name="L870"></a> 870   <em class="brace">{</em>
<a id="L871" name="L871"></a> 871         <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle);
<a id="L872" name="L872"></a> 872     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L873" name="L873"></a> 873         <strong class="reserved">if</strong>(TEXT_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> || CDATA_SECTION_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L874" name="L874"></a> 874     <em class="brace">{</em>
<a id="L875" name="L875"></a> 875       <em class="comment">// If this is a DTM text node, it may be made of multiple DOM text</em>
<a id="L876" name="L876"></a> 876       <em class="comment">// nodes -- including navigating into Entity References. DOM2DTM</em>
<a id="L877" name="L877"></a> 877       <em class="comment">// records the first node in the sequence and requires that we</em>
<a id="L878" name="L878"></a> 878       <em class="comment">// pick up the others when we retrieve the DTM node's value.</em>
<a id="L879" name="L879"></a> 879       <em class="comment">//</em>
<a id="L880" name="L880"></a> 880       <em class="comment">// %REVIEW% DOM Level 3 is expected to add a "whole text"</em>
<a id="L881" name="L881"></a> 881       <em class="comment">// retrieval method which performs this function for us.</em>
<a id="L882" name="L882"></a> 882       <a href="../S/5847.html#L56" title="Defined at 56 in src/com/sun/org/apache/xml/internal/utils/FastStringBuffer.java.">FastStringBuffer</a> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a> = <a href="../S/5869.html#L31" title="Defined at 31 in src/com/sun/org/apache/xml/internal/utils/StringBufferPool.java.">StringBufferPool</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L883" name="L883"></a> 883       <strong class="reserved">while</strong>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>!=<strong class="reserved">null</strong>)
<a id="L884" name="L884"></a> 884       <em class="brace">{</em>
<a id="L885" name="L885"></a> 885         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>());
<a id="L886" name="L886"></a> 886         <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>=<a href="../S/5895.html#L1189" title="Defined at 1189 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">logicalNextDOMTextNode</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L887" name="L887"></a> 887       <em class="brace">}</em>
<a id="L888" name="L888"></a> 888      <strong class="reserved">boolean</strong> b = <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/26507.html" title="Multiple defined in 18 places.">isWhitespace</a>(0, <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L889" name="L889"></a> 889       <a href="../S/5869.html#L31" title="Defined at 31 in src/com/sun/org/apache/xml/internal/utils/StringBufferPool.java.">StringBufferPool</a>.<a href="../D/16577.html" title="Multiple defined in 8 places.">free</a>(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>);
<a id="L890" name="L890"></a> 890      <strong class="reserved">return</strong> b;
<a id="L891" name="L891"></a> 891     <em class="brace">}</em>
<a id="L892" name="L892"></a> 892     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L893" name="L893"></a> 893   <em class="brace">}</em>
<a id="L894" name="L894"></a> 894 
<div class="comment">
    Retrieve the text content of a DOM subtree, appending it into a
    user-supplied FastStringBuffer object. Note that attributes are
    not considered part of the content of an element.
    <p>
    There are open questions regarding whitespace stripping.
    Currently we make no special effort in that regard, since the standard
    DOM doesn't yet provide DTD-based information to distinguish
    whitespace-in-element-context from genuine #PCDATA. Note that we
    should probably also consider xml:space if/when we address this.
    DOM Level 3 may solve the problem for us.
    </p><p>
    %REVIEW% Actually, since this method operates on the DOM side of the
    fence rather than the DTM side, it SHOULDN'T do
    any special handling. The DOM does what the DOM does; if you want
    DTM-level abstractions, use DTM-level methods.
    @param node Node whose subtree is to be walked, gathering the
    contents of all Text or CDATASection nodes.
    @param buf FastStringBuffer into which the contents of the text
    nodes are to be concatenated.</p></div>
<a id="L917" name="L917"></a> 917   <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/17975.html" title="Multiple referred from 5 places.">getNodeData</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>, <a href="../S/5847.html#L56" title="Defined at 56 in src/com/sun/org/apache/xml/internal/utils/FastStringBuffer.java.">FastStringBuffer</a> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>)
<a id="L918" name="L918"></a> 918   <em class="brace">{</em>
<a id="L919" name="L919"></a> 919 
<a id="L920" name="L920"></a> 920     <strong class="reserved">switch</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L921" name="L921"></a> 921     <em class="brace">{</em>
<a id="L922" name="L922"></a> 922     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.DOCUMENT_FRAGMENT_NODE :
<a id="L923" name="L923"></a> 923     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.DOCUMENT_NODE :
<a id="L924" name="L924"></a> 924     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ELEMENT_NODE :
<a id="L925" name="L925"></a> 925     <em class="brace">{</em>
<a id="L926" name="L926"></a> 926       <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> child = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/19088.html" title="Multiple defined in 18 places.">getFirstChild</a>(); <strong class="reserved">null</strong> != child;
<a id="L927" name="L927"></a> 927               child = child.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>())
<a id="L928" name="L928"></a> 928       <em class="brace">{</em>
<a id="L929" name="L929"></a> 929         <a href="../D/20973.html" title="Multiple defined in 5 places.">getNodeData</a>(child, <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>);
<a id="L930" name="L930"></a> 930       <em class="brace">}</em>
<a id="L931" name="L931"></a> 931     <em class="brace">}</em>
<a id="L932" name="L932"></a> 932     <strong class="reserved">break</strong>;
<a id="L933" name="L933"></a> 933     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.TEXT_NODE :
<a id="L934" name="L934"></a> 934     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.CDATA_SECTION_NODE :
<a id="L935" name="L935"></a> 935     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ATTRIBUTE_NODE :  <em class="comment">// Never a child but might be our starting node</em>
<a id="L936" name="L936"></a> 936       <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>());
<a id="L937" name="L937"></a> 937       <strong class="reserved">break</strong>;
<a id="L938" name="L938"></a> 938     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.PROCESSING_INSTRUCTION_NODE :
<a id="L939" name="L939"></a> 939       <em class="comment">// warning(XPATHErrorResources.WG_PARSING_AND_PREPARING);</em>
<a id="L940" name="L940"></a> 940       <strong class="reserved">break</strong>;
<a id="L941" name="L941"></a> 941     <strong class="reserved">default</strong> :
<a id="L942" name="L942"></a> 942       <em class="comment">// ignore</em>
<a id="L943" name="L943"></a> 943       <strong class="reserved">break</strong>;
<a id="L944" name="L944"></a> 944     <em class="brace">}</em>
<a id="L945" name="L945"></a> 945   <em class="brace">}</em>
<a id="L946" name="L946"></a> 946 
<div class="comment">
    Given a node handle, return its DOM-style node name. This will
    include names such as #text or #document.
    @param nodeHandle the id of the node.
    @return String Name of this node, which may be an empty string.
    %REVIEW% Document when empty string is possible...
    %REVIEW-COMMENT% It should never be empty, should it?</div>
<a id="L956" name="L956"></a> 956   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/17984.html" title="Multiple referred from 297 places.">getNodeName</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L957" name="L957"></a> 957   <em class="brace">{</em>
<a id="L958" name="L958"></a> 958 
<a id="L959" name="L959"></a> 959     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L960" name="L960"></a> 960 
<a id="L961" name="L961"></a> 961     <em class="comment">// Assume non-null.</em>
<a id="L962" name="L962"></a> 962     <strong class="reserved">return</strong> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>();
<a id="L963" name="L963"></a> 963   <em class="brace">}</em>
<a id="L964" name="L964"></a> 964 
<div class="comment">
    Given a node handle, return the XPath node name.  This should be
    the name as described by the XPath data model, NOT the DOM-style
    name.
    @param nodeHandle the id of the node.
    @return String Name of this node, which may be an empty string.</div>
<a id="L973" name="L973"></a> 973   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/17985.html" title="Multiple referred from 11 places.">getNodeNameX</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L974" name="L974"></a> 974   <em class="brace">{</em>
<a id="L975" name="L975"></a> 975 
<a id="L976" name="L976"></a> 976     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>;
<a id="L977" name="L977"></a> 977     <strong class="reserved">short</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle);
<a id="L978" name="L978"></a> 978 
<a id="L979" name="L979"></a> 979     <strong class="reserved">switch</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L980" name="L980"></a> 980     <em class="brace">{</em>
<a id="L981" name="L981"></a> 981     <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE :
<a id="L982" name="L982"></a> 982     <em class="brace">{</em>
<a id="L983" name="L983"></a> 983       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L984" name="L984"></a> 984 
<a id="L985" name="L985"></a> 985       <em class="comment">// assume not null.</em>
<a id="L986" name="L986"></a> 986       <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>();
<a id="L987" name="L987"></a> 987       <strong class="reserved">if</strong>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("xmlns:"))
<a id="L988" name="L988"></a> 988       <em class="brace">{</em>
<a id="L989" name="L989"></a> 989         <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = <a href="../D/6976.html" title="Multiple defined in 5 places.">QName</a>.<a href="../D/20208.html" title="Multiple defined in 4 places.">getLocalPart</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L990" name="L990"></a> 990       <em class="brace">}</em>
<a id="L991" name="L991"></a> 991       <strong class="reserved">else</strong> <strong class="reserved">if</strong>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("xmlns"))
<a id="L992" name="L992"></a> 992       <em class="brace">{</em>
<a id="L993" name="L993"></a> 993         <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = "";
<a id="L994" name="L994"></a> 994       <em class="brace">}</em>
<a id="L995" name="L995"></a> 995     <em class="brace">}</em>
<a id="L996" name="L996"></a> 996     <strong class="reserved">break</strong>;
<a id="L997" name="L997"></a> 997     <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE :
<a id="L998" name="L998"></a> 998     <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE :
<a id="L999" name="L999"></a> 999     <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ENTITY_REFERENCE_NODE :
<a id="L1000" name="L1000"></a>1000     <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE :
<a id="L1001" name="L1001"></a>1001     <em class="brace">{</em>
<a id="L1002" name="L1002"></a>1002       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L1003" name="L1003"></a>1003 
<a id="L1004" name="L1004"></a>1004       <em class="comment">// assume not null.</em>
<a id="L1005" name="L1005"></a>1005       <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>();
<a id="L1006" name="L1006"></a>1006     <em class="brace">}</em>
<a id="L1007" name="L1007"></a>1007     <strong class="reserved">break</strong>;
<a id="L1008" name="L1008"></a>1008     <strong class="reserved">default</strong> :
<a id="L1009" name="L1009"></a>1009       <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = "";
<a id="L1010" name="L1010"></a>1010     <em class="brace">}</em>
<a id="L1011" name="L1011"></a>1011 
<a id="L1012" name="L1012"></a>1012     <strong class="reserved">return</strong> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>;
<a id="L1013" name="L1013"></a>1013   <em class="brace">}</em>
<a id="L1014" name="L1014"></a>1014 
<div class="comment">
    Given a node handle, return its XPath-style localname.
    (As defined in Namespaces, this is the portion of the name after any
    colon character).
    @param nodeHandle the id of the node.
    @return String Local name of this node.</div>
<a id="L1023" name="L1023"></a>1023   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/17419.html" title="Multiple referred from 323 places.">getLocalName</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L1024" name="L1024"></a>1024   <em class="brace">{</em>
<a id="L1025" name="L1025"></a>1025     <strong class="reserved">if</strong>(JJK_NEWCODE)
<a id="L1026" name="L1026"></a>1026     <em class="brace">{</em>
<a id="L1027" name="L1027"></a>1027       <strong class="reserved">int</strong> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>=<a href="../S/5889.html#L929" title="Defined at 929 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeIdentity</a>(nodeHandle);
<a id="L1028" name="L1028"></a>1028       <strong class="reserved">if</strong>(<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>==<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>) <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1029" name="L1029"></a>1029       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> newnode=(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>)m_nodes.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>);
<a id="L1030" name="L1030"></a>1030       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> newname=newnode.<a href="../D/20201.html" title="Multiple defined in 44 places.">getLocalName</a>();
<a id="L1031" name="L1031"></a>1031       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == newname)
<a id="L1032" name="L1032"></a>1032       <em class="brace">{</em>
<a id="L1033" name="L1033"></a>1033         <em class="comment">// XSLT treats PIs, and possibly other things, as having QNames.</em>
<a id="L1034" name="L1034"></a>1034         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> qname = newnode.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>();
<a id="L1035" name="L1035"></a>1035         <strong class="reserved">if</strong>('#'==qname.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0))
<a id="L1036" name="L1036"></a>1036         <em class="brace">{</em>
<a id="L1037" name="L1037"></a>1037           <em class="comment">//  Match old default for this function</em>
<a id="L1038" name="L1038"></a>1038           <em class="comment">// This conversion may or may not be necessary</em>
<a id="L1039" name="L1039"></a>1039           newname="";
<a id="L1040" name="L1040"></a>1040         <em class="brace">}</em>
<a id="L1041" name="L1041"></a>1041         <strong class="reserved">else</strong>
<a id="L1042" name="L1042"></a>1042         <em class="brace">{</em>
<a id="L1043" name="L1043"></a>1043           <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = qname.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(':');
<a id="L1044" name="L1044"></a>1044           newname = (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; 0) ? qname : qname.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> + 1);
<a id="L1045" name="L1045"></a>1045         <em class="brace">}</em>
<a id="L1046" name="L1046"></a>1046       <em class="brace">}</em>
<a id="L1047" name="L1047"></a>1047       <strong class="reserved">return</strong> newname;
<a id="L1048" name="L1048"></a>1048     <em class="brace">}</em>
<a id="L1049" name="L1049"></a>1049     <strong class="reserved">else</strong>
<a id="L1050" name="L1050"></a>1050     <em class="brace">{</em>
<a id="L1051" name="L1051"></a>1051       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>;
<a id="L1052" name="L1052"></a>1052       <strong class="reserved">short</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle);
<a id="L1053" name="L1053"></a>1053       <strong class="reserved">switch</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L1054" name="L1054"></a>1054       <em class="brace">{</em>
<a id="L1055" name="L1055"></a>1055       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE :
<a id="L1056" name="L1056"></a>1056       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE :
<a id="L1057" name="L1057"></a>1057       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ENTITY_REFERENCE_NODE :
<a id="L1058" name="L1058"></a>1058       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE :
<a id="L1059" name="L1059"></a>1059       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE :
<a id="L1060" name="L1060"></a>1060         <em class="brace">{</em>
<a id="L1061" name="L1061"></a>1061           <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L1062" name="L1062"></a>1062 
<a id="L1063" name="L1063"></a>1063           <em class="comment">// assume not null.</em>
<a id="L1064" name="L1064"></a>1064           <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20201.html" title="Multiple defined in 44 places.">getLocalName</a>();
<a id="L1065" name="L1065"></a>1065 
<a id="L1066" name="L1066"></a>1066           <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L1067" name="L1067"></a>1067           <em class="brace">{</em>
<a id="L1068" name="L1068"></a>1068             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> qname = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>();
<a id="L1069" name="L1069"></a>1069             <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = qname.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(':');
<a id="L1070" name="L1070"></a>1070 
<a id="L1071" name="L1071"></a>1071             <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; 0) ? qname : qname.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> + 1);
<a id="L1072" name="L1072"></a>1072           <em class="brace">}</em>
<a id="L1073" name="L1073"></a>1073         <em class="brace">}</em>
<a id="L1074" name="L1074"></a>1074         <strong class="reserved">break</strong>;
<a id="L1075" name="L1075"></a>1075       <strong class="reserved">default</strong> :
<a id="L1076" name="L1076"></a>1076         <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = "";
<a id="L1077" name="L1077"></a>1077       <em class="brace">}</em>
<a id="L1078" name="L1078"></a>1078       <strong class="reserved">return</strong> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>;
<a id="L1079" name="L1079"></a>1079     <em class="brace">}</em>
<a id="L1080" name="L1080"></a>1080   <em class="brace">}</em>
<a id="L1081" name="L1081"></a>1081 
<div class="comment">
    Given a namespace handle, return the prefix that the namespace decl is
    mapping.
    Given a node handle, return the prefix used to map to the namespace.
    <p> %REVIEW% Are you sure you want "" for no prefix?  </p>
    <p> %REVIEW-COMMENT% I think so... not totally sure. -sb  </p>
    @param nodeHandle the id of the node.
    @return String prefix of this node's name, or "" if no explicit
    namespace prefix was given.</div>
<a id="L1094" name="L1094"></a>1094   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/18418.html" title="Multiple referred from 112 places.">getPrefix</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L1095" name="L1095"></a>1095   <em class="brace">{</em>
<a id="L1096" name="L1096"></a>1096 
<a id="L1097" name="L1097"></a>1097     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a>;
<a id="L1098" name="L1098"></a>1098     <strong class="reserved">short</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle);
<a id="L1099" name="L1099"></a>1099 
<a id="L1100" name="L1100"></a>1100     <strong class="reserved">switch</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L1101" name="L1101"></a>1101     <em class="brace">{</em>
<a id="L1102" name="L1102"></a>1102     <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE :
<a id="L1103" name="L1103"></a>1103     <em class="brace">{</em>
<a id="L1104" name="L1104"></a>1104       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L1105" name="L1105"></a>1105 
<a id="L1106" name="L1106"></a>1106       <em class="comment">// assume not null.</em>
<a id="L1107" name="L1107"></a>1107       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> qname = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>();
<a id="L1108" name="L1108"></a>1108       <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = qname.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(':');
<a id="L1109" name="L1109"></a>1109 
<a id="L1110" name="L1110"></a>1110       <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> = (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; 0) ? "" : qname.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> + 1);
<a id="L1111" name="L1111"></a>1111     <em class="brace">}</em>
<a id="L1112" name="L1112"></a>1112     <strong class="reserved">break</strong>;
<a id="L1113" name="L1113"></a>1113     <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE :
<a id="L1114" name="L1114"></a>1114     <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE :
<a id="L1115" name="L1115"></a>1115     <em class="brace">{</em>
<a id="L1116" name="L1116"></a>1116       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L1117" name="L1117"></a>1117 
<a id="L1118" name="L1118"></a>1118       <em class="comment">// assume not null.</em>
<a id="L1119" name="L1119"></a>1119       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> qname = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20983.html" title="Multiple defined in 37 places.">getNodeName</a>();
<a id="L1120" name="L1120"></a>1120       <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = qname.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(':');
<a id="L1121" name="L1121"></a>1121 
<a id="L1122" name="L1122"></a>1122       <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> = (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; 0) ? "" : qname.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>);
<a id="L1123" name="L1123"></a>1123     <em class="brace">}</em>
<a id="L1124" name="L1124"></a>1124     <strong class="reserved">break</strong>;
<a id="L1125" name="L1125"></a>1125     <strong class="reserved">default</strong> :
<a id="L1126" name="L1126"></a>1126       <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> = "";
<a id="L1127" name="L1127"></a>1127     <em class="brace">}</em>
<a id="L1128" name="L1128"></a>1128 
<a id="L1129" name="L1129"></a>1129     <strong class="reserved">return</strong> <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a>;
<a id="L1130" name="L1130"></a>1130   <em class="brace">}</em>
<a id="L1131" name="L1131"></a>1131 
<div class="comment">
    Given a node handle, return its DOM-style namespace URI
    (As defined in Namespaces, this is the declared URI which this node's
    prefix -- or default in lieu thereof -- was mapped to.)
    <p>%REVIEW% Null or ""? -sb</p>
    @param nodeHandle the id of the node.
    @return String URI value of this node's namespace, or null if no
    namespace was resolved.</div>
<a id="L1143" name="L1143"></a>1143   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/17864.html" title="Multiple referred from 185 places.">getNamespaceURI</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L1144" name="L1144"></a>1144   <em class="brace">{</em>
<a id="L1145" name="L1145"></a>1145     <strong class="reserved">if</strong>(JJK_NEWCODE)
<a id="L1146" name="L1146"></a>1146     <em class="brace">{</em>
<a id="L1147" name="L1147"></a>1147       <strong class="reserved">int</strong> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>=<a href="../S/5889.html#L929" title="Defined at 929 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeIdentity</a>(nodeHandle);
<a id="L1148" name="L1148"></a>1148       <strong class="reserved">if</strong>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>==<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1149" name="L1149"></a>1149       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>=(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>)m_nodes.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>);
<a id="L1150" name="L1150"></a>1150       <strong class="reserved">return</strong> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20828.html" title="Multiple defined in 47 places.">getNamespaceURI</a>();
<a id="L1151" name="L1151"></a>1151     <em class="brace">}</em>
<a id="L1152" name="L1152"></a>1152     <strong class="reserved">else</strong>
<a id="L1153" name="L1153"></a>1153     <em class="brace">{</em>
<a id="L1154" name="L1154"></a>1154       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> nsuri;
<a id="L1155" name="L1155"></a>1155       <strong class="reserved">short</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle);
<a id="L1156" name="L1156"></a>1156 
<a id="L1157" name="L1157"></a>1157       <strong class="reserved">switch</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L1158" name="L1158"></a>1158       <em class="brace">{</em>
<a id="L1159" name="L1159"></a>1159       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE :
<a id="L1160" name="L1160"></a>1160       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE :
<a id="L1161" name="L1161"></a>1161       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ENTITY_REFERENCE_NODE :
<a id="L1162" name="L1162"></a>1162       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE :
<a id="L1163" name="L1163"></a>1163       <strong class="reserved">case</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE :
<a id="L1164" name="L1164"></a>1164         <em class="brace">{</em>
<a id="L1165" name="L1165"></a>1165           <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L1166" name="L1166"></a>1166 
<a id="L1167" name="L1167"></a>1167           <em class="comment">// assume not null.</em>
<a id="L1168" name="L1168"></a>1168           nsuri = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20828.html" title="Multiple defined in 47 places.">getNamespaceURI</a>();
<a id="L1169" name="L1169"></a>1169 
<a id="L1170" name="L1170"></a>1170           <em class="comment">// %TBD% Handle DOM1?</em>
<a id="L1171" name="L1171"></a>1171         <em class="brace">}</em>
<a id="L1172" name="L1172"></a>1172         <strong class="reserved">break</strong>;
<a id="L1173" name="L1173"></a>1173       <strong class="reserved">default</strong> :
<a id="L1174" name="L1174"></a>1174         nsuri = <strong class="reserved">null</strong>;
<a id="L1175" name="L1175"></a>1175       <em class="brace">}</em>
<a id="L1176" name="L1176"></a>1176 
<a id="L1177" name="L1177"></a>1177       <strong class="reserved">return</strong> nsuri;
<a id="L1178" name="L1178"></a>1178     <em class="brace">}</em>
<a id="L1179" name="L1179"></a>1179 
<a id="L1180" name="L1180"></a>1180   <em class="brace">}</em>
<a id="L1181" name="L1181"></a>1181 
<div class="comment">
 Utility function: Given a DOM Text node, determine whether it is
    logically followed by another Text or CDATASection node. This may
    involve traversing into Entity References.
    %REVIEW% DOM Level 3 is expected to add functionality which may
    allow us to retire this.</div>
<a id="L1189" name="L1189"></a>1189   <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../R/22688.html" title="Multiple referred from 6 places.">logicalNextDOMTextNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> n)
<a id="L1190" name="L1190"></a>1190   <em class="brace">{</em>
<a id="L1191" name="L1191"></a>1191         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> p=n.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L1192" name="L1192"></a>1192         <strong class="reserved">if</strong>(p==<strong class="reserved">null</strong>)
<a id="L1193" name="L1193"></a>1193         <em class="brace">{</em>
<a id="L1194" name="L1194"></a>1194                 <em class="comment">// Walk out of any EntityReferenceNodes that ended with text</em>
<a id="L1195" name="L1195"></a>1195                 <strong class="reserved">for</strong>(n=n.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>();
<a id="L1196" name="L1196"></a>1196                         n!=<strong class="reserved">null</strong> &amp;&amp; ENTITY_REFERENCE_NODE == n.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>();
<a id="L1197" name="L1197"></a>1197                         n=n.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>())
<a id="L1198" name="L1198"></a>1198                 <em class="brace">{</em>
<a id="L1199" name="L1199"></a>1199                         p=n.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L1200" name="L1200"></a>1200                         <strong class="reserved">if</strong>(p!=<strong class="reserved">null</strong>)
<a id="L1201" name="L1201"></a>1201                                 <strong class="reserved">break</strong>;
<a id="L1202" name="L1202"></a>1202                 <em class="brace">}</em>
<a id="L1203" name="L1203"></a>1203         <em class="brace">}</em>
<a id="L1204" name="L1204"></a>1204         n=p;
<a id="L1205" name="L1205"></a>1205         <strong class="reserved">while</strong>(n!=<strong class="reserved">null</strong> &amp;&amp; ENTITY_REFERENCE_NODE == n.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L1206" name="L1206"></a>1206         <em class="brace">{</em>
<a id="L1207" name="L1207"></a>1207                 <em class="comment">// Walk into any EntityReferenceNodes that start with text</em>
<a id="L1208" name="L1208"></a>1208                 <strong class="reserved">if</strong>(n.<a href="../D/24077.html" title="Multiple defined in 16 places.">hasChildNodes</a>())
<a id="L1209" name="L1209"></a>1209                         n=n.<a href="../D/19088.html" title="Multiple defined in 18 places.">getFirstChild</a>();
<a id="L1210" name="L1210"></a>1210                 <strong class="reserved">else</strong>
<a id="L1211" name="L1211"></a>1211                         n=n.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L1212" name="L1212"></a>1212         <em class="brace">}</em>
<a id="L1213" name="L1213"></a>1213         <strong class="reserved">if</strong>(n!=<strong class="reserved">null</strong>)
<a id="L1214" name="L1214"></a>1214         <em class="brace">{</em>
<a id="L1215" name="L1215"></a>1215                 <em class="comment">// Found a logical next sibling. Is it text?</em>
<a id="L1216" name="L1216"></a>1216                 <strong class="reserved">int</strong> ntype=n.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>();
<a id="L1217" name="L1217"></a>1217                 <strong class="reserved">if</strong>(TEXT_NODE != ntype &amp;&amp; CDATA_SECTION_NODE != ntype)
<a id="L1218" name="L1218"></a>1218                         n=<strong class="reserved">null</strong>;
<a id="L1219" name="L1219"></a>1219         <em class="brace">}</em>
<a id="L1220" name="L1220"></a>1220         <strong class="reserved">return</strong> n;
<a id="L1221" name="L1221"></a>1221   <em class="brace">}</em>
<a id="L1222" name="L1222"></a>1222 
<div class="comment">
    Given a node handle, return its node value. This is mostly
    as defined by the DOM, but may ignore some conveniences.
    <p>
    @param nodeHandle The node id.
    @return String Value of this node, or null if not
    meaningful for this node type.</p></div>
<a id="L1232" name="L1232"></a>1232   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/17992.html" title="Multiple referred from 231 places.">getNodeValue</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L1233" name="L1233"></a>1233   <em class="brace">{</em>
<a id="L1234" name="L1234"></a>1234     <em class="comment">// The _type(nodeHandle) call was taking the lion's share of our</em>
<a id="L1235" name="L1235"></a>1235     <em class="comment">// time, and was wrong anyway since it wasn't coverting handle to</em>
<a id="L1236" name="L1236"></a>1236     <em class="comment">// identity. Inlined it.</em>
<a id="L1237" name="L1237"></a>1237     <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/10424.html" title="Multiple defined in 2 places.">_exptype</a>(<a href="../S/5889.html#L929" title="Defined at 929 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">makeNodeIdentity</a>(nodeHandle));
<a id="L1238" name="L1238"></a>1238     <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>=(<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) ? <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle) : <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L1239" name="L1239"></a>1239 
<a id="L1240" name="L1240"></a>1240     <strong class="reserved">if</strong>(TEXT_NODE!=<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> &amp;&amp; CDATA_SECTION_NODE!=<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L1241" name="L1241"></a>1241       <strong class="reserved">return</strong> <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle).<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>();
<a id="L1242" name="L1242"></a>1242 
<a id="L1243" name="L1243"></a>1243     <em class="comment">// If this is a DTM text node, it may be made of multiple DOM text</em>
<a id="L1244" name="L1244"></a>1244     <em class="comment">// nodes -- including navigating into Entity References. DOM2DTM</em>
<a id="L1245" name="L1245"></a>1245     <em class="comment">// records the first node in the sequence and requires that we</em>
<a id="L1246" name="L1246"></a>1246     <em class="comment">// pick up the others when we retrieve the DTM node's value.</em>
<a id="L1247" name="L1247"></a>1247     <em class="comment">//</em>
<a id="L1248" name="L1248"></a>1248     <em class="comment">// %REVIEW% DOM Level 3 is expected to add a "whole text"</em>
<a id="L1249" name="L1249"></a>1249     <em class="comment">// retrieval method which performs this function for us.</em>
<a id="L1250" name="L1250"></a>1250     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L1251" name="L1251"></a>1251     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> n=<a href="../S/5895.html#L1189" title="Defined at 1189 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">logicalNextDOMTextNode</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L1252" name="L1252"></a>1252     <strong class="reserved">if</strong>(n==<strong class="reserved">null</strong>)
<a id="L1253" name="L1253"></a>1253       <strong class="reserved">return</strong> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>();
<a id="L1254" name="L1254"></a>1254 
<a id="L1255" name="L1255"></a>1255     <a href="../S/5847.html#L56" title="Defined at 56 in src/com/sun/org/apache/xml/internal/utils/FastStringBuffer.java.">FastStringBuffer</a> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a> = <a href="../S/5869.html#L31" title="Defined at 31 in src/com/sun/org/apache/xml/internal/utils/StringBufferPool.java.">StringBufferPool</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L1256" name="L1256"></a>1256         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>());
<a id="L1257" name="L1257"></a>1257     <strong class="reserved">while</strong>(n!=<strong class="reserved">null</strong>)
<a id="L1258" name="L1258"></a>1258     <em class="brace">{</em>
<a id="L1259" name="L1259"></a>1259       <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(n.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>());
<a id="L1260" name="L1260"></a>1260       n=<a href="../S/5895.html#L1189" title="Defined at 1189 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">logicalNextDOMTextNode</a>(n);
<a id="L1261" name="L1261"></a>1261     <em class="brace">}</em>
<a id="L1262" name="L1262"></a>1262     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s = (<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt; 0) ? <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() : "";
<a id="L1263" name="L1263"></a>1263     <a href="../S/5869.html#L31" title="Defined at 31 in src/com/sun/org/apache/xml/internal/utils/StringBufferPool.java.">StringBufferPool</a>.<a href="../D/16577.html" title="Multiple defined in 8 places.">free</a>(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>);
<a id="L1264" name="L1264"></a>1264     <strong class="reserved">return</strong> s;
<a id="L1265" name="L1265"></a>1265   <em class="brace">}</em>
<a id="L1266" name="L1266"></a>1266 
<div class="comment">
      A document type declaration information item has the following properties:
        1. [system identifier] The system identifier of the external subset, if
           it exists. Otherwise this property has no value.
    @return the system identifier String object, or null if there is none.</div>
<a id="L1275" name="L1275"></a>1275   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/16231.html" title="Multiple referred from 2 places.">getDocumentTypeDeclarationSystemIdentifier</a>()
<a id="L1276" name="L1276"></a>1276   <em class="brace">{</em>
<a id="L1277" name="L1277"></a>1277 
<a id="L1278" name="L1278"></a>1278     <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc;
<a id="L1279" name="L1279"></a>1279 
<a id="L1280" name="L1280"></a>1280     <strong class="reserved">if</strong> (m_root.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>() == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.DOCUMENT_NODE)
<a id="L1281" name="L1281"></a>1281       doc = (<a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a>) m_root;
<a id="L1282" name="L1282"></a>1282     <strong class="reserved">else</strong>
<a id="L1283" name="L1283"></a>1283       doc = m_root.<a href="../D/21292.html" title="Multiple defined in 20 places.">getOwnerDocument</a>();
<a id="L1284" name="L1284"></a>1284 
<a id="L1285" name="L1285"></a>1285     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != doc)
<a id="L1286" name="L1286"></a>1286     <em class="brace">{</em>
<a id="L1287" name="L1287"></a>1287       <a href="../S/130.html#L55" title="Defined at 55 in src/org/w3c/dom/DocumentType.java.">DocumentType</a> dtd = doc.<a href="../D/18550.html" title="Multiple defined in 5 places.">getDoctype</a>();
<a id="L1288" name="L1288"></a>1288 
<a id="L1289" name="L1289"></a>1289       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != dtd)
<a id="L1290" name="L1290"></a>1290       <em class="brace">{</em>
<a id="L1291" name="L1291"></a>1291         <strong class="reserved">return</strong> dtd.<a href="../D/22911.html" title="Multiple defined in 50 places.">getSystemId</a>();
<a id="L1292" name="L1292"></a>1292       <em class="brace">}</em>
<a id="L1293" name="L1293"></a>1293     <em class="brace">}</em>
<a id="L1294" name="L1294"></a>1294 
<a id="L1295" name="L1295"></a>1295     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1296" name="L1296"></a>1296   <em class="brace">}</em>
<a id="L1297" name="L1297"></a>1297 
<div class="comment">
    Return the public identifier of the external subset,
    normalized as described in 4.2.2 External Entities [XML]. If there is
    no external subset or if it has no public identifier, this property
    has no value.
    @return the public identifier String object, or null if there is none.</div>
<a id="L1306" name="L1306"></a>1306   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/16230.html" title="Multiple referred from 2 places.">getDocumentTypeDeclarationPublicIdentifier</a>()
<a id="L1307" name="L1307"></a>1307   <em class="brace">{</em>
<a id="L1308" name="L1308"></a>1308 
<a id="L1309" name="L1309"></a>1309     <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc;
<a id="L1310" name="L1310"></a>1310 
<a id="L1311" name="L1311"></a>1311     <strong class="reserved">if</strong> (m_root.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>() == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.DOCUMENT_NODE)
<a id="L1312" name="L1312"></a>1312       doc = (<a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a>) m_root;
<a id="L1313" name="L1313"></a>1313     <strong class="reserved">else</strong>
<a id="L1314" name="L1314"></a>1314       doc = m_root.<a href="../D/21292.html" title="Multiple defined in 20 places.">getOwnerDocument</a>();
<a id="L1315" name="L1315"></a>1315 
<a id="L1316" name="L1316"></a>1316     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != doc)
<a id="L1317" name="L1317"></a>1317     <em class="brace">{</em>
<a id="L1318" name="L1318"></a>1318       <a href="../S/130.html#L55" title="Defined at 55 in src/org/w3c/dom/DocumentType.java.">DocumentType</a> dtd = doc.<a href="../D/18550.html" title="Multiple defined in 5 places.">getDoctype</a>();
<a id="L1319" name="L1319"></a>1319 
<a id="L1320" name="L1320"></a>1320       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != dtd)
<a id="L1321" name="L1321"></a>1321       <em class="brace">{</em>
<a id="L1322" name="L1322"></a>1322         <strong class="reserved">return</strong> dtd.<a href="../D/21781.html" title="Multiple defined in 41 places.">getPublicId</a>();
<a id="L1323" name="L1323"></a>1323       <em class="brace">}</em>
<a id="L1324" name="L1324"></a>1324     <em class="brace">}</em>
<a id="L1325" name="L1325"></a>1325 
<a id="L1326" name="L1326"></a>1326     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1327" name="L1327"></a>1327   <em class="brace">}</em>
<a id="L1328" name="L1328"></a>1328 
<div class="comment">
    Returns the <code>Element</code> whose <code>ID</code> is given by
    <code>elementId</code>. If no such element exists, returns
    <code>DTM.NULL</code>. Behavior is not defined if more than one element
    has this <code>ID</code>. Attributes (including those
    with the name "ID") are not of type ID unless so defined by DTD/Schema
    information available to the DTM implementation.
    Implementations that do not know whether attributes are of type ID or
    not are expected to return <code>DTM.NULL</code>.
    <p>%REVIEW% Presumably IDs are still scoped to a single document,
    and this operation searches only within a single document, right?
    Wouldn't want collisions between DTMs in the same process.</p>
    @param elementId The unique <code>id</code> value for an element.
    @return The handle of the matching element.</div>
<a id="L1346" name="L1346"></a>1346   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/16314.html" title="Multiple referred from 11 places.">getElementById</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> elementId)
<a id="L1347" name="L1347"></a>1347   <em class="brace">{</em>
<a id="L1348" name="L1348"></a>1348 
<a id="L1349" name="L1349"></a>1349     <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = (m_root.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>() == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.DOCUMENT_NODE)
<a id="L1350" name="L1350"></a>1350         ? (<a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a>) m_root : m_root.<a href="../D/21292.html" title="Multiple defined in 20 places.">getOwnerDocument</a>();
<a id="L1351" name="L1351"></a>1351 
<a id="L1352" name="L1352"></a>1352     <strong class="reserved">if</strong>(<strong class="reserved">null</strong> != doc)
<a id="L1353" name="L1353"></a>1353     <em class="brace">{</em>
<a id="L1354" name="L1354"></a>1354       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> elem = doc.<a href="../D/18671.html" title="Multiple defined in 16 places.">getElementById</a>(elementId);
<a id="L1355" name="L1355"></a>1355       <strong class="reserved">if</strong>(<strong class="reserved">null</strong> != elem)
<a id="L1356" name="L1356"></a>1356       <em class="brace">{</em>
<a id="L1357" name="L1357"></a>1357         <strong class="reserved">int</strong> elemHandle = <a href="../S/5895.html#L665" title="Defined at 665 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">getHandleFromNode</a>(elem);
<a id="L1358" name="L1358"></a>1358 
<a id="L1359" name="L1359"></a>1359         <strong class="reserved">if</strong>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> == elemHandle)
<a id="L1360" name="L1360"></a>1360         <em class="brace">{</em>
<a id="L1361" name="L1361"></a>1361           <strong class="reserved">int</strong> <a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a> = m_nodes.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()-1;
<a id="L1362" name="L1362"></a>1362           <strong class="reserved">while</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != (<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a> = <a href="../D/20923.html" title="Multiple defined in 3 places.">getNextNodeIdentity</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>)))
<a id="L1363" name="L1363"></a>1363           <em class="brace">{</em>
<a id="L1364" name="L1364"></a>1364             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(<a href="../D/24301.html" title="Multiple defined in 8 places.">identity</a>);
<a id="L1365" name="L1365"></a>1365             <strong class="reserved">if</strong>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> == elem)
<a id="L1366" name="L1366"></a>1366             <em class="brace">{</em>
<a id="L1367" name="L1367"></a>1367               elemHandle = <a href="../S/5895.html#L665" title="Defined at 665 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">getHandleFromNode</a>(elem);
<a id="L1368" name="L1368"></a>1368               <strong class="reserved">break</strong>;
<a id="L1369" name="L1369"></a>1369             <em class="brace">}</em>
<a id="L1370" name="L1370"></a>1370            <em class="brace">}</em>
<a id="L1371" name="L1371"></a>1371         <em class="brace">}</em>
<a id="L1372" name="L1372"></a>1372 
<a id="L1373" name="L1373"></a>1373         <strong class="reserved">return</strong> elemHandle;
<a id="L1374" name="L1374"></a>1374       <em class="brace">}</em>
<a id="L1375" name="L1375"></a>1375 
<a id="L1376" name="L1376"></a>1376     <em class="brace">}</em>
<a id="L1377" name="L1377"></a>1377     <strong class="reserved">return</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L1378" name="L1378"></a>1378   <em class="brace">}</em>
<a id="L1379" name="L1379"></a>1379 
<div class="comment">
    The getUnparsedEntityURI function returns the URI of the unparsed
    entity with the specified name in the same document as the context
    node (see [3.3 Unparsed Entities]). It returns the empty string if
    there is no such entity.
    <p>
    XML processors may choose to use the System Identifier (if one
    is provided) to resolve the entity, rather than the URI in the
    Public Identifier. The details are dependent on the processor, and
    we would have to support some form of plug-in resolver to handle
    this properly. Currently, we simply return the System Identifier if
    present, and hope that it a usable URI or that our caller can
    map it to one.
    TODO: Resolve Public Identifiers... or consider changing function name.
    </p><p>
    If we find a relative URI
    reference, XML expects it to be resolved in terms of the base URI
    of the document. The DOM doesn't do that for us, and it isn't
    entirely clear whether that should be done here; currently that's
    pushed up to a higher level of our application. (Note that DOM Level
    1 didn't store the document's base URI.)
    TODO: Consider resolving Relative URIs.
    </p><p>
    (The DOM's statement that "An XML processor may choose to
    completely expand entities before the structure model is passed
    to the DOM" refers only to parsed entities, not unparsed, and hence
    doesn't affect this function.)
    @param name A string containing the Entity Name of the unparsed
    entity.
    @return String containing the URI of the Unparsed Entity, or an
    empty string if no such entity exists.</p></div>
<a id="L1414" name="L1414"></a>1414   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/19689.html" title="Multiple referred from 6 places.">getUnparsedEntityURI</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L1415" name="L1415"></a>1415   <em class="brace">{</em>
<a id="L1416" name="L1416"></a>1416 
<a id="L1417" name="L1417"></a>1417     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> url = "";
<a id="L1418" name="L1418"></a>1418     <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = (m_root.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>() == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.DOCUMENT_NODE)
<a id="L1419" name="L1419"></a>1419         ? (<a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a>) m_root : m_root.<a href="../D/21292.html" title="Multiple defined in 20 places.">getOwnerDocument</a>();
<a id="L1420" name="L1420"></a>1420 
<a id="L1421" name="L1421"></a>1421     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != doc)
<a id="L1422" name="L1422"></a>1422     <em class="brace">{</em>
<a id="L1423" name="L1423"></a>1423       <a href="../S/130.html#L55" title="Defined at 55 in src/org/w3c/dom/DocumentType.java.">DocumentType</a> doctype = doc.<a href="../D/18550.html" title="Multiple defined in 5 places.">getDoctype</a>();
<a id="L1424" name="L1424"></a>1424 
<a id="L1425" name="L1425"></a>1425       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != doctype)
<a id="L1426" name="L1426"></a>1426       <em class="brace">{</em>
<a id="L1427" name="L1427"></a>1427         <a href="../S/114.html#L56" title="Defined at 56 in src/org/w3c/dom/NamedNodeMap.java.">NamedNodeMap</a> entities = doctype.<a href="../D/18794.html" title="Multiple defined in 3 places.">getEntities</a>();
<a id="L1428" name="L1428"></a>1428         <strong class="reserved">if</strong>(<strong class="reserved">null</strong> == entities)
<a id="L1429" name="L1429"></a>1429           <strong class="reserved">return</strong> url;
<a id="L1430" name="L1430"></a>1430         <a href="../D/2913.html" title="Multiple defined in 2 places.">Entity</a> entity = (<a href="../D/2913.html" title="Multiple defined in 2 places.">Entity</a>) entities.<a href="../D/20798.html" title="Multiple defined in 5 places.">getNamedItem</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L1431" name="L1431"></a>1431         <strong class="reserved">if</strong>(<strong class="reserved">null</strong> == entity)
<a id="L1432" name="L1432"></a>1432           <strong class="reserved">return</strong> url;
<a id="L1433" name="L1433"></a>1433 
<a id="L1434" name="L1434"></a>1434         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> notationName = entity.<a href="../D/21022.html" title="Multiple defined in 3 places.">getNotationName</a>();
<a id="L1435" name="L1435"></a>1435 
<a id="L1436" name="L1436"></a>1436         <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != notationName)  <em class="comment">// then it's unparsed</em>
<a id="L1437" name="L1437"></a>1437         <em class="brace">{</em>
<a id="L1438" name="L1438"></a>1438           <em class="comment">// The draft says: "The XSLT processor may use the public</em>
<a id="L1439" name="L1439"></a>1439           <em class="comment">// identifier to generate a URI for the entity instead of the URI</em>
<a id="L1440" name="L1440"></a>1440           <em class="comment">// specified in the system identifier. If the XSLT processor does</em>
<a id="L1441" name="L1441"></a>1441           <em class="comment">// not use the public identifier to generate the URI, it must use</em>
<a id="L1442" name="L1442"></a>1442           <em class="comment">// the system identifier; if the system identifier is a relative</em>
<a id="L1443" name="L1443"></a>1443           <em class="comment">// URI, it must be resolved into an absolute URI using the URI of</em>
<a id="L1444" name="L1444"></a>1444           <em class="comment">// the resource containing the entity declaration as the base</em>
<a id="L1445" name="L1445"></a>1445           <em class="comment">// URI [RFC2396]."</em>
<a id="L1446" name="L1446"></a>1446           <em class="comment">// So I'm falling a bit short here.</em>
<a id="L1447" name="L1447"></a>1447           url = entity.<a href="../D/22911.html" title="Multiple defined in 50 places.">getSystemId</a>();
<a id="L1448" name="L1448"></a>1448 
<a id="L1449" name="L1449"></a>1449           <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == url)
<a id="L1450" name="L1450"></a>1450           <em class="brace">{</em>
<a id="L1451" name="L1451"></a>1451             url = entity.<a href="../D/21781.html" title="Multiple defined in 41 places.">getPublicId</a>();
<a id="L1452" name="L1452"></a>1452           <em class="brace">}</em>
<a id="L1453" name="L1453"></a>1453           <strong class="reserved">else</strong>
<a id="L1454" name="L1454"></a>1454           <em class="brace">{</em>
<a id="L1455" name="L1455"></a>1455             <em class="comment">// This should be resolved to an absolute URL, but that's hard</em>
<a id="L1456" name="L1456"></a>1456             <em class="comment">// to do from here.</em>
<a id="L1457" name="L1457"></a>1457           <em class="brace">}</em>
<a id="L1458" name="L1458"></a>1458         <em class="brace">}</em>
<a id="L1459" name="L1459"></a>1459       <em class="brace">}</em>
<a id="L1460" name="L1460"></a>1460     <em class="brace">}</em>
<a id="L1461" name="L1461"></a>1461 
<a id="L1462" name="L1462"></a>1462     <strong class="reserved">return</strong> url;
<a id="L1463" name="L1463"></a>1463   <em class="brace">}</em>
<a id="L1464" name="L1464"></a>1464 
<div class="comment">
        5. [specified] A flag indicating whether this attribute was actually
           specified in the start-tag of its element, or was defaulted from the
           DTD.
    @param attributeHandle the attribute handle
    @return <code>true</code> if the attribute was specified;
            <code>false</code> if it was defaulted.</div>
<a id="L1474" name="L1474"></a>1474   <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21189.html" title="Multiple referred from 5 places.">isAttributeSpecified</a>(<strong class="reserved">int</strong> attributeHandle)
<a id="L1475" name="L1475"></a>1475   <em class="brace">{</em>
<a id="L1476" name="L1476"></a>1476     <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(attributeHandle);
<a id="L1477" name="L1477"></a>1477 
<a id="L1478" name="L1478"></a>1478     <strong class="reserved">if</strong> (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L1479" name="L1479"></a>1479     <em class="brace">{</em>
<a id="L1480" name="L1480"></a>1480       <a href="../S/54.html#L186" title="Defined at 186 in src/org/w3c/dom/Attr.java.">Attr</a> <a href="../D/11626.html" title="Multiple defined in 2 places.">attr</a> = (<a href="../S/54.html#L186" title="Defined at 186 in src/org/w3c/dom/Attr.java.">Attr</a>)<a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(attributeHandle);
<a id="L1481" name="L1481"></a>1481       <strong class="reserved">return</strong> <a href="../D/11626.html" title="Multiple defined in 2 places.">attr</a>.<a href="../D/22666.html" title="Multiple defined in 7 places.">getSpecified</a>();
<a id="L1482" name="L1482"></a>1482     <em class="brace">}</em>
<a id="L1483" name="L1483"></a>1483     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1484" name="L1484"></a>1484   <em class="brace">}</em>
<a id="L1485" name="L1485"></a>1485 
<div class="comment">
 Bind an IncrementalSAXSource to this DTM. NOT RELEVANT for DOM2DTM, since
    we're wrapped around an existing DOM.
    @param source The IncrementalSAXSource that we want to recieve events from
    on demand.</div>
<a id="L1492" name="L1492"></a>1492   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/5906.html#L391" title="Referred from 391 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMManagerDefault.java.">setIncrementalSAXSource</a>(<a href="../S/5909.html#L39" title="Defined at 39 in src/com/sun/org/apache/xml/internal/dtm/ref/IncrementalSAXSource.java.">IncrementalSAXSource</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>)
<a id="L1493" name="L1493"></a>1493   <em class="brace">{</em>
<a id="L1494" name="L1494"></a>1494   <em class="brace">}</em>
<a id="L1495" name="L1495"></a>1495 
<div class="comment">
 getContentHandler returns "our SAX builder" -- the thing that
    someone else should send SAX events to in order to extend this
    DTM model.
    @return null if this model doesn't respond to SAX events,
    "this" if the DTM object has a built-in SAX ContentHandler,
    the IncrmentalSAXSource if we're bound to one and should receive
    the SAX stream via it for incremental build purposes...
   * </div>
<a id="L1505" name="L1505"></a>1505   <strong class="reserved">public</strong> org.xml.sax.<a href="../D/1853.html" title="Multiple defined in 2 places.">ContentHandler</a> <a href="../R/15784.html" title="Multiple referred from 7 places.">getContentHandler</a>()
<a id="L1506" name="L1506"></a>1506   <em class="brace">{</em>
<a id="L1507" name="L1507"></a>1507       <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1508" name="L1508"></a>1508   <em class="brace">}</em>
<a id="L1509" name="L1509"></a>1509 
<div class="comment">
    Return this DTM's lexical handler.
    %REVIEW% Should this return null if constrution already done/begun?
    @return null if this model doesn't respond to lexical SAX events,
    "this" if the DTM object has a built-in SAX ContentHandler,
    the IncrementalSAXSource if we're bound to one and should receive
    the SAX stream via it for incremental build purposes...</div>
<a id="L1520" name="L1520"></a>1520   <strong class="reserved">public</strong> org.xml.sax.ext.<a href="../S/719.html#L68" title="Defined at 68 in src/org/xml/sax/ext/LexicalHandler.java.">LexicalHandler</a> <a href="../R/17346.html" title="Multiple referred from 4 places.">getLexicalHandler</a>()
<a id="L1521" name="L1521"></a>1521   <em class="brace">{</em>
<a id="L1522" name="L1522"></a>1522 
<a id="L1523" name="L1523"></a>1523     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1524" name="L1524"></a>1524   <em class="brace">}</em>
<a id="L1525" name="L1525"></a>1525 
<a id="L1526" name="L1526"></a>1526 
<div class="comment">
    Return this DTM's EntityResolver.
    @return null if this model doesn't respond to SAX entity ref events.</div>
<a id="L1532" name="L1532"></a>1532   <strong class="reserved">public</strong> org.xml.sax.<a href="../S/722.html#L93" title="Defined at 93 in src/org/xml/sax/EntityResolver.java.">EntityResolver</a> <a href="../R/16392.html" title="Multiple referred from 19 places.">getEntityResolver</a>()
<a id="L1533" name="L1533"></a>1533   <em class="brace">{</em>
<a id="L1534" name="L1534"></a>1534 
<a id="L1535" name="L1535"></a>1535     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1536" name="L1536"></a>1536   <em class="brace">}</em>
<a id="L1537" name="L1537"></a>1537 
<div class="comment">
    Return this DTM's DTDHandler.
    @return null if this model doesn't respond to SAX dtd events.</div>
<a id="L1543" name="L1543"></a>1543   <strong class="reserved">public</strong> org.xml.sax.<a href="../S/721.html#L74" title="Defined at 74 in src/org/xml/sax/DTDHandler.java.">DTDHandler</a> <a href="../R/15931.html" title="Multiple referred from 4 places.">getDTDHandler</a>()
<a id="L1544" name="L1544"></a>1544   <em class="brace">{</em>
<a id="L1545" name="L1545"></a>1545 
<a id="L1546" name="L1546"></a>1546     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1547" name="L1547"></a>1547   <em class="brace">}</em>
<a id="L1548" name="L1548"></a>1548 
<div class="comment">
    Return this DTM's ErrorHandler.
    @return null if this model doesn't respond to SAX error events.</div>
<a id="L1554" name="L1554"></a>1554   <strong class="reserved">public</strong> org.xml.sax.<a href="../S/723.html#L73" title="Defined at 73 in src/org/xml/sax/ErrorHandler.java.">ErrorHandler</a> <a href="../R/16431.html" title="Multiple referred from 39 places.">getErrorHandler</a>()
<a id="L1555" name="L1555"></a>1555   <em class="brace">{</em>
<a id="L1556" name="L1556"></a>1556 
<a id="L1557" name="L1557"></a>1557     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1558" name="L1558"></a>1558   <em class="brace">}</em>
<a id="L1559" name="L1559"></a>1559 
<div class="comment">
    Return this DTM's DeclHandler.
    @return null if this model doesn't respond to SAX Decl events.</div>
<a id="L1565" name="L1565"></a>1565   <strong class="reserved">public</strong> org.xml.sax.ext.<a href="../S/716.html#L72" title="Defined at 72 in src/org/xml/sax/ext/DeclHandler.java.">DeclHandler</a> <a href="../R/15973.html" title="Multiple referred from 3 places.">getDeclHandler</a>()
<a id="L1566" name="L1566"></a>1566   <em class="brace">{</em>
<a id="L1567" name="L1567"></a>1567 
<a id="L1568" name="L1568"></a>1568     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1569" name="L1569"></a>1569   <em class="brace">}</em>
<a id="L1570" name="L1570"></a>1570 
<div class="comment">
 @return true iff we're building this model incrementally (eg
    we're partnered with a IncrementalSAXSource) and thus require that the
    transformation and the parse run simultaneously. Guidance to the
    DTMManager.
   * </div>
<a id="L1576" name="L1576"></a>1576   <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/23508.html" title="Multiple referred from 2 places.">needsTwoThreads</a>()
<a id="L1577" name="L1577"></a>1577   <em class="brace">{</em>
<a id="L1578" name="L1578"></a>1578     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1579" name="L1579"></a>1579   <em class="brace">}</em>
<a id="L1580" name="L1580"></a>1580 
<a id="L1581" name="L1581"></a>1581   <em class="comment">// ========== Direct SAX Dispatch, for optimization purposes ========</em>
<a id="L1582" name="L1582"></a>1582 
<div class="comment">
    Returns whether the specified <var>ch</var> conforms to the XML 1.0 definition
    of whitespace.  Refer to <a href="http://www.w3.org/TR/1998/REC-xml-19980210#NT-S">
    the definition of <code>S</code></a> for details.
    @param   ch      Character to check as XML whitespace.
    @return          =true if <var>ch</var> is XML whitespace; otherwise =false.</div>
<a id="L1590" name="L1590"></a>1590   <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/22037.html" title="Multiple referred from 30 places.">isSpace</a>(<strong class="reserved">char</strong> ch)
<a id="L1591" name="L1591"></a>1591   <em class="brace">{</em>
<a id="L1592" name="L1592"></a>1592     <strong class="reserved">return</strong> <a href="../S/5871.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/utils/XMLCharacterRecognizer.java.">XMLCharacterRecognizer</a>.<a href="../D/26505.html" title="Multiple defined in 15 places.">isWhiteSpace</a>(ch);  <em class="comment">// Take the easy way out for now.</em>
<a id="L1593" name="L1593"></a>1593   <em class="brace">}</em>
<a id="L1594" name="L1594"></a>1594 
<div class="comment">
    Directly call the
    characters method on the passed ContentHandler for the
    string-value of the given node (see http://www.w3.org/TR/xpath#data-model
    for the definition of a node's string-value). Multiple calls to the
    ContentHandler's characters methods may well occur for a single call to
    this method.
    @param nodeHandle The node ID.
    @param ch A non-null reference to a ContentHandler.
    @throws org.xml.sax.SAXException</div>
<a id="L1608" name="L1608"></a>1608   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/13318.html" title="Multiple referred from 11 places.">dispatchCharactersEvents</a>(
<a id="L1609" name="L1609"></a>1609           <strong class="reserved">int</strong> nodeHandle, org.xml.sax.<a href="../D/1853.html" title="Multiple defined in 2 places.">ContentHandler</a> ch,
<a id="L1610" name="L1610"></a>1610           <strong class="reserved">boolean</strong> <a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>)
<a id="L1611" name="L1611"></a>1611             <strong class="reserved">throws</strong> org.xml.sax.<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a>
<a id="L1612" name="L1612"></a>1612   <em class="brace">{</em>
<a id="L1613" name="L1613"></a>1613     <strong class="reserved">if</strong>(<a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>)
<a id="L1614" name="L1614"></a>1614     <em class="brace">{</em>
<a id="L1615" name="L1615"></a>1615       <a href="../D/10017.html" title="Multiple defined in 2 places.">XMLString</a> <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a> = <a href="../D/22791.html" title="Multiple defined in 23 places.">getStringValue</a>(nodeHandle);
<a id="L1616" name="L1616"></a>1616       <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a> = <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/16429.html" title="Multiple defined in 4 places.">fixWhiteSpace</a>(<strong class="reserved">true</strong>, <strong class="reserved">true</strong>, <strong class="reserved">false</strong>);
<a id="L1617" name="L1617"></a>1617       <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/14949.html" title="Multiple defined in 15 places.">dispatchCharactersEvents</a>(ch);
<a id="L1618" name="L1618"></a>1618     <em class="brace">}</em>
<a id="L1619" name="L1619"></a>1619     <strong class="reserved">else</strong>
<a id="L1620" name="L1620"></a>1620     <em class="brace">{</em>
<a id="L1621" name="L1621"></a>1621       <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = <a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(nodeHandle);
<a id="L1622" name="L1622"></a>1622       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L1623" name="L1623"></a>1623       <a href="../S/5895.html#L1656" title="Defined at 1656 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">dispatchNodeData</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>, ch, 0);
<a id="L1624" name="L1624"></a>1624           <em class="comment">// Text coalition -- a DTM text node may represent multiple</em>
<a id="L1625" name="L1625"></a>1625           <em class="comment">// DOM nodes.</em>
<a id="L1626" name="L1626"></a>1626           <strong class="reserved">if</strong>(TEXT_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> || CDATA_SECTION_NODE == <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>)
<a id="L1627" name="L1627"></a>1627           <em class="brace">{</em>
<a id="L1628" name="L1628"></a>1628                   <strong class="reserved">while</strong>( <strong class="reserved">null</strong> != (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>=<a href="../S/5895.html#L1189" title="Defined at 1189 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">logicalNextDOMTextNode</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)) )
<a id="L1629" name="L1629"></a>1629                   <em class="brace">{</em>
<a id="L1630" name="L1630"></a>1630                       <a href="../S/5895.html#L1656" title="Defined at 1656 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">dispatchNodeData</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>, ch, 0);
<a id="L1631" name="L1631"></a>1631                   <em class="brace">}</em>
<a id="L1632" name="L1632"></a>1632           <em class="brace">}</em>
<a id="L1633" name="L1633"></a>1633     <em class="brace">}</em>
<a id="L1634" name="L1634"></a>1634   <em class="brace">}</em>
<a id="L1635" name="L1635"></a>1635 
<div class="comment">
    Retrieve the text content of a DOM subtree, appending it into a
    user-supplied FastStringBuffer object. Note that attributes are
    not considered part of the content of an element.
    <p>
    There are open questions regarding whitespace stripping.
    Currently we make no special effort in that regard, since the standard
    DOM doesn't yet provide DTD-based information to distinguish
    whitespace-in-element-context from genuine #PCDATA. Note that we
    should probably also consider xml:space if/when we address this.
    DOM Level 3 may solve the problem for us.
    </p><p>
    %REVIEW% Note that as a DOM-level operation, it can be argued that this
    routine _shouldn't_ perform any processing beyond what the DOM already
    does, and that whitespace stripping and so on belong at the DTM level.
    If you want a stripped DOM view, wrap DTM2DOM around DOM2DTM.
    @param node Node whose subtree is to be walked, gathering the
    contents of all Text or CDATASection nodes.</p></div>
<a id="L1656" name="L1656"></a>1656   <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/13326.html" title="Multiple referred from 3 places.">dispatchNodeData</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>,
<a id="L1657" name="L1657"></a>1657                                          org.xml.sax.<a href="../D/1853.html" title="Multiple defined in 2 places.">ContentHandler</a> ch,
<a id="L1658" name="L1658"></a>1658                                          <strong class="reserved">int</strong> <a href="../S/3238.html#L188" title="Defined at 188 in src/javax/swing/text/ElementIterator.java.">depth</a>)
<a id="L1659" name="L1659"></a>1659             <strong class="reserved">throws</strong> org.xml.sax.<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a>
<a id="L1660" name="L1660"></a>1660   <em class="brace">{</em>
<a id="L1661" name="L1661"></a>1661 
<a id="L1662" name="L1662"></a>1662     <strong class="reserved">switch</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>())
<a id="L1663" name="L1663"></a>1663     <em class="brace">{</em>
<a id="L1664" name="L1664"></a>1664     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.DOCUMENT_FRAGMENT_NODE :
<a id="L1665" name="L1665"></a>1665     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.DOCUMENT_NODE :
<a id="L1666" name="L1666"></a>1666     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ELEMENT_NODE :
<a id="L1667" name="L1667"></a>1667     <em class="brace">{</em>
<a id="L1668" name="L1668"></a>1668       <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> child = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/19088.html" title="Multiple defined in 18 places.">getFirstChild</a>(); <strong class="reserved">null</strong> != child;
<a id="L1669" name="L1669"></a>1669               child = child.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>())
<a id="L1670" name="L1670"></a>1670       <em class="brace">{</em>
<a id="L1671" name="L1671"></a>1671         <a href="../S/5895.html#L1656" title="Defined at 1656 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">dispatchNodeData</a>(child, ch, <a href="../S/3238.html#L188" title="Defined at 188 in src/javax/swing/text/ElementIterator.java.">depth</a>+1);
<a id="L1672" name="L1672"></a>1672       <em class="brace">}</em>
<a id="L1673" name="L1673"></a>1673     <em class="brace">}</em>
<a id="L1674" name="L1674"></a>1674     <strong class="reserved">break</strong>;
<a id="L1675" name="L1675"></a>1675     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.PROCESSING_INSTRUCTION_NODE : <em class="comment">// %REVIEW%</em>
<a id="L1676" name="L1676"></a>1676     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.COMMENT_NODE :
<a id="L1677" name="L1677"></a>1677       <strong class="reserved">if</strong>(0 != <a href="../S/3238.html#L188" title="Defined at 188 in src/javax/swing/text/ElementIterator.java.">depth</a>)
<a id="L1678" name="L1678"></a>1678         <strong class="reserved">break</strong>;
<a id="L1679" name="L1679"></a>1679         <em class="comment">// NOTE: Because this operation works in the DOM space, it does _not_ attempt</em>
<a id="L1680" name="L1680"></a>1680         <em class="comment">// to perform Text Coalition. That should only be done in DTM space.</em>
<a id="L1681" name="L1681"></a>1681     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.TEXT_NODE :
<a id="L1682" name="L1682"></a>1682     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.CDATA_SECTION_NODE :
<a id="L1683" name="L1683"></a>1683     <strong class="reserved">case</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ATTRIBUTE_NODE :
<a id="L1684" name="L1684"></a>1684       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20992.html" title="Multiple defined in 23 places.">getNodeValue</a>();
<a id="L1685" name="L1685"></a>1685       <strong class="reserved">if</strong>(ch <strong class="reserved">instanceof</strong> <a href="../S/5895.html#L1736" title="Defined at 1736 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">CharacterNodeHandler</a>)
<a id="L1686" name="L1686"></a>1686       <em class="brace">{</em>
<a id="L1687" name="L1687"></a>1687         ((<a href="../S/5895.html#L1736" title="Defined at 1736 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">CharacterNodeHandler</a>)ch).<a href="../D/12339.html" title="Multiple defined in 98 places.">characters</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L1688" name="L1688"></a>1688       <em class="brace">}</em>
<a id="L1689" name="L1689"></a>1689       <strong class="reserved">else</strong>
<a id="L1690" name="L1690"></a>1690       <em class="brace">{</em>
<a id="L1691" name="L1691"></a>1691         ch.<a href="../D/12339.html" title="Multiple defined in 98 places.">characters</a>(<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/35368.html" title="Multiple defined in 3 places.">toCharArray</a>(), 0, <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L1692" name="L1692"></a>1692       <em class="brace">}</em>
<a id="L1693" name="L1693"></a>1693       <strong class="reserved">break</strong>;
<a id="L1694" name="L1694"></a>1694 <em class="comment">//    /* case Node.PROCESSING_INSTRUCTION_NODE :</em>
<a id="L1695" name="L1695"></a>1695 <em class="comment">//      // warning(XPATHErrorResources.WG_PARSING_AND_PREPARING);</em>
<a id="L1696" name="L1696"></a>1696 <em class="comment">//      break; */</em>
<a id="L1697" name="L1697"></a>1697     <strong class="reserved">default</strong> :
<a id="L1698" name="L1698"></a>1698       <em class="comment">// ignore</em>
<a id="L1699" name="L1699"></a>1699       <strong class="reserved">break</strong>;
<a id="L1700" name="L1700"></a>1700     <em class="brace">}</em>
<a id="L1701" name="L1701"></a>1701   <em class="brace">}</em>
<a id="L1702" name="L1702"></a>1702 
<a id="L1703" name="L1703"></a>1703   <a href="../D/9164.html" title="Multiple defined in 3 places.">TreeWalker</a> m_walker = <strong class="reserved">new</strong> <a href="../D/9164.html" title="Multiple defined in 3 places.">TreeWalker</a>(<strong class="reserved">null</strong>);
<a id="L1704" name="L1704"></a>1704 
<div class="comment">
    Directly create SAX parser events from a subtree.
    @param nodeHandle The node ID.
    @param ch A non-null reference to a ContentHandler.
    @throws org.xml.sax.SAXException</div>
<a id="L1713" name="L1713"></a>1713   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/13328.html" title="Multiple referred from 2 places.">dispatchToEvents</a>(<strong class="reserved">int</strong> nodeHandle, org.xml.sax.<a href="../D/1853.html" title="Multiple defined in 2 places.">ContentHandler</a> ch)
<a id="L1714" name="L1714"></a>1714           <strong class="reserved">throws</strong> org.xml.sax.<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a>
<a id="L1715" name="L1715"></a>1715   <em class="brace">{</em>
<a id="L1716" name="L1716"></a>1716     <a href="../D/9164.html" title="Multiple defined in 3 places.">TreeWalker</a> treeWalker = m_walker;
<a id="L1717" name="L1717"></a>1717     <a href="../D/1853.html" title="Multiple defined in 2 places.">ContentHandler</a> prevCH = treeWalker.<a href="../D/17957.html" title="Multiple defined in 20 places.">getContentHandler</a>();
<a id="L1718" name="L1718"></a>1718 
<a id="L1719" name="L1719"></a>1719     <strong class="reserved">if</strong>(<strong class="reserved">null</strong> != prevCH)
<a id="L1720" name="L1720"></a>1720     <em class="brace">{</em>
<a id="L1721" name="L1721"></a>1721       treeWalker = <strong class="reserved">new</strong> <a href="../D/9164.html" title="Multiple defined in 3 places.">TreeWalker</a>(<strong class="reserved">null</strong>);
<a id="L1722" name="L1722"></a>1722     <em class="brace">}</em>
<a id="L1723" name="L1723"></a>1723     treeWalker.<a href="../D/32251.html" title="Multiple defined in 23 places.">setContentHandler</a>(ch);
<a id="L1724" name="L1724"></a>1724 
<a id="L1725" name="L1725"></a>1725     <strong class="reserved">try</strong>
<a id="L1726" name="L1726"></a>1726     <em class="brace">{</em>
<a id="L1727" name="L1727"></a>1727       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> = <a href="../D/20970.html" title="Multiple defined in 26 places.">getNode</a>(nodeHandle);
<a id="L1728" name="L1728"></a>1728       treeWalker.<a href="../S/5864.html#L174" title="Defined at 174 in src/com/sun/org/apache/xml/internal/utils/TreeWalker.java.">traverseFragment</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L1729" name="L1729"></a>1729     <em class="brace">}</em>
<a id="L1730" name="L1730"></a>1730     <strong class="reserved">finally</strong>
<a id="L1731" name="L1731"></a>1731     <em class="brace">{</em>
<a id="L1732" name="L1732"></a>1732       treeWalker.<a href="../D/32251.html" title="Multiple defined in 23 places.">setContentHandler</a>(<strong class="reserved">null</strong>);
<a id="L1733" name="L1733"></a>1733     <em class="brace">}</em>
<a id="L1734" name="L1734"></a>1734   <em class="brace">}</em>
<a id="L1735" name="L1735"></a>1735 
<a id="L1736" name="L1736"></a>1736   <strong class="reserved">public</strong> <strong class="reserved">interface</strong> <a href="../R/1296.html" title="Multiple referred from 4 places.">CharacterNodeHandler</a>
<a id="L1737" name="L1737"></a>1737   <em class="brace">{</em>
<a id="L1738" name="L1738"></a>1738     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11056.html" title="Multiple referred from 150 places.">characters</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L1739" name="L1739"></a>1739             <strong class="reserved">throws</strong> org.xml.sax.<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a>;
<a id="L1740" name="L1740"></a>1740   <em class="brace">}</em>
<a id="L1741" name="L1741"></a>1741 
<div class="comment">
    For the moment all the run time properties are ignored by this
    class.
    @param property a <code>String</code> value
    @param value an <code>Object</code> value</div>
<a id="L1749" name="L1749"></a>1749   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27976.html" title="Multiple referred from 343 places.">setProperty</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> property, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>)
<a id="L1750" name="L1750"></a>1750   <em class="brace">{</em>
<a id="L1751" name="L1751"></a>1751   <em class="brace">}</em>
<a id="L1752" name="L1752"></a>1752 
<div class="comment">
    No source information is available for DOM2DTM, so return
    <code>null</code> here.
    @param node an <code>int</code> value
    @return null</div>
<a id="L1760" name="L1760"></a>1760   <strong class="reserved">public</strong> <a href="../S/4044.html#L32" title="Defined at 32 in src/javax/xml/transform/SourceLocator.java.">SourceLocator</a> <a href="../R/19100.html" title="Multiple referred from 10 places.">getSourceLocatorFor</a>(<strong class="reserved">int</strong> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L1761" name="L1761"></a>1761   <em class="brace">{</em>
<a id="L1762" name="L1762"></a>1762     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1763" name="L1763"></a>1763   <em class="brace">}</em>
<a id="L1764" name="L1764"></a>1764 
<a id="L1765" name="L1765"></a>1765 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L183">[^]</a><a href="#L1760">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>