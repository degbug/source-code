<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/javax/sound/sampled/AudioInputStream.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L172">[^]</a><a href="#L507">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L172" title="Defined at 172.">getFormat</a></li>
<li><a href="#L181" title="Defined at 181.">getFrameLength</a></li>
<li><a href="#L198" title="Defined at 198.">read</a></li>
<li><a href="#L231" title="Defined at 231.">read</a></li>
<li><a href="#L256" title="Defined at 256.">read</a></li>
<li><a href="#L327" title="Defined at 327.">skip</a></li>
<li><a href="#L370" title="Defined at 370.">available</a></li>
<li><a href="#L388" title="Defined at 388.">close</a></li>
<li><a href="#L401" title="Defined at 401.">mark</a></li>
<li><a href="#L425" title="Defined at 425.">reset</a></li>
<li><a href="#L448" title="Defined at 448.">markSupported</a></li>
<li><a href="#L471" title="Defined at 471.">available</a></li>
<li><a href="#L477" title="Defined at 477.">close</a></li>
<li><a href="#L487" title="Defined at 487.">read</a></li>
<li><a href="#L507" title="Defined at 507.">read</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1999, 2005, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.sound.sampled;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.InputStream;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.io.PushbackInputStream;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.io.IOException;
<a id="L31" name="L31"></a>  31 
<a id="L32" name="L32"></a>  32 
<div class="comment">
  An audio input stream is an input stream with a specified audio format and
  length.  The length is expressed in sample frames, not bytes.
  Several methods are provided for reading a certain number of bytes from
  the stream, or an unspecified number of bytes.
  The audio input stream keeps track  of the last byte that was read.
  You can skip over an arbitrary number of bytes to get to a later position
  for reading. An audio input stream may support marks.  When you set a mark,
  the current position is remembered so that you can return to it later.
  <p>
  The <code>AudioSystem</code> class includes many methods that manipulate
  <code>AudioInputStream</code> objects.
  For example, the methods let you:
  </p><ul><li> obtain an
  audio input stream from an external audio file, stream, or URL
  </li><li> write an external file from an audio input stream
  </li><li> convert an audio input stream to a different audio format
  </li></ul>
  @author David Rivas
  @author Kara Kytle
  @author Florian Bomers
  @see AudioSystem
  @see Clip#open(AudioInputStream) Clip.open(AudioInputStream)
  @since 1.3</div>
<a id="L61" name="L61"></a>  61 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/561.html" title="Multiple referred from 28 places.">AudioInputStream</a> <strong class="reserved">extends</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <em class="brace">{</em>
<a id="L62" name="L62"></a>  62 
<div class="comment">
      The <code>InputStream</code> from which this <code>AudioInputStream</code>
      object was constructed.</div>
<a id="L67" name="L67"></a>  67     <strong class="reserved">private</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>;
<a id="L68" name="L68"></a>  68 
<div class="comment">
      The format of the audio data contained in the stream.</div>
<a id="L72" name="L72"></a>  72     <strong class="reserved">protected</strong> <a href="../S/4383.html#L125" title="Defined at 125 in src/javax/sound/sampled/AudioFormat.java.">AudioFormat</a> <a href="../D/16531.html" title="Multiple defined in 87 places.">format</a>;
<a id="L73" name="L73"></a>  73 
<div class="comment">
      This stream's length, in sample frames.</div>
<a id="L77" name="L77"></a>  77     <strong class="reserved">protected</strong> <strong class="reserved">long</strong> frameLength;
<a id="L78" name="L78"></a>  78 
<div class="comment">
      The size of each frame, in bytes.</div>
<a id="L82" name="L82"></a>  82     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> frameSize;
<a id="L83" name="L83"></a>  83 
<div class="comment">
      The current position in this stream, in sample frames (zero-based).</div>
<a id="L87" name="L87"></a>  87     <strong class="reserved">protected</strong> <strong class="reserved">long</strong> framePos;
<a id="L88" name="L88"></a>  88 
<div class="comment">
      The position where a mark was set.</div>
<a id="L92" name="L92"></a>  92     <strong class="reserved">private</strong> <strong class="reserved">long</strong> markpos;
<a id="L93" name="L93"></a>  93 
<div class="comment">
      When the underlying stream could only return
      a non-integral number of frames, store
      the remainder in a temporary buffer</div>
<a id="L99" name="L99"></a>  99     <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] pushBackBuffer = <strong class="reserved">null</strong>;
<a id="L100" name="L100"></a> 100 
<div class="comment">
      number of valid bytes in the pushBackBuffer</div>
<a id="L104" name="L104"></a> 104     <strong class="reserved">private</strong> <strong class="reserved">int</strong> pushBackLen = 0;
<a id="L105" name="L105"></a> 105 
<div class="comment">
      MarkBuffer at mark position</div>
<a id="L109" name="L109"></a> 109     <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] markPushBackBuffer = <strong class="reserved">null</strong>;
<a id="L110" name="L110"></a> 110 
<div class="comment">
      number of valid bytes in the markPushBackBuffer</div>
<a id="L114" name="L114"></a> 114     <strong class="reserved">private</strong> <strong class="reserved">int</strong> markPushBackLen = 0;
<a id="L115" name="L115"></a> 115 
<a id="L116" name="L116"></a> 116 
<div class="comment">
      Constructs an audio input stream that has the requested format and length in sample frames,
      using audio data from the specified input stream.
      @param stream the stream on which this <code>AudioInputStream</code>
      object is based
      @param format the format of this stream's audio data
      @param length the length in sample frames of the data in this stream</div>
<a id="L125" name="L125"></a> 125     <strong class="reserved">public</strong> AudioInputStream(<a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>, <a href="../S/4383.html#L125" title="Defined at 125 in src/javax/sound/sampled/AudioFormat.java.">AudioFormat</a> <a href="../D/16531.html" title="Multiple defined in 87 places.">format</a>, <strong class="reserved">long</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L126" name="L126"></a> 126 
<a id="L127" name="L127"></a> 127         <strong class="reserved">super</strong>();
<a id="L128" name="L128"></a> 128 
<a id="L129" name="L129"></a> 129         <strong class="reserved">this</strong>.<a href="../D/16531.html" title="Multiple defined in 87 places.">format</a> = <a href="../D/16531.html" title="Multiple defined in 87 places.">format</a>;
<a id="L130" name="L130"></a> 130         <strong class="reserved">this</strong>.frameLength = <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L131" name="L131"></a> 131         <strong class="reserved">this</strong>.frameSize = <a href="../D/16531.html" title="Multiple defined in 87 places.">format</a>.<a href="../S/4383.html#L348" title="Defined at 348 in src/javax/sound/sampled/AudioFormat.java.">getFrameSize</a>();
<a id="L132" name="L132"></a> 132 
<a id="L133" name="L133"></a> 133         <em class="comment">// any frameSize that is not well-defined will</em>
<a id="L134" name="L134"></a> 134         <em class="comment">// cause that this stream will be read in bytes</em>
<a id="L135" name="L135"></a> 135         <strong class="reserved">if</strong>( <strong class="reserved">this</strong>.frameSize == <a href="../S/4392.html#L170" title="Defined at 170 in src/javax/sound/sampled/AudioSystem.java.">AudioSystem</a>.NOT_SPECIFIED || frameSize &lt;= 0) <em class="brace">{</em>
<a id="L136" name="L136"></a> 136             <strong class="reserved">this</strong>.frameSize = 1;
<a id="L137" name="L137"></a> 137         <em class="brace">}</em>
<a id="L138" name="L138"></a> 138 
<a id="L139" name="L139"></a> 139         <strong class="reserved">this</strong>.<a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a> = <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>;
<a id="L140" name="L140"></a> 140         framePos = 0;
<a id="L141" name="L141"></a> 141         markpos = 0;
<a id="L142" name="L142"></a> 142     <em class="brace">}</em>
<a id="L143" name="L143"></a> 143 
<a id="L144" name="L144"></a> 144 
<div class="comment">
      Constructs an audio input stream that reads its data from the target
      data line indicated.  The format of the stream is the same as that of
      the target data line, and the length is AudioSystem#NOT_SPECIFIED.
      @param line the target data line from which this stream obtains its data.
      @see AudioSystem#NOT_SPECIFIED</div>
<a id="L152" name="L152"></a> 152     <strong class="reserved">public</strong> AudioInputStream(<a href="../S/4384.html#L59" title="Defined at 59 in src/javax/sound/sampled/TargetDataLine.java.">TargetDataLine</a> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>) <em class="brace">{</em>
<a id="L153" name="L153"></a> 153 
<a id="L154" name="L154"></a> 154         <a href="../S/4378.html#L457" title="Defined at 457 in src/javax/sound/sampled/AudioInputStream.java.">TargetDataLineInputStream</a> tstream = <strong class="reserved">new</strong> <a href="../S/4378.html#L457" title="Defined at 457 in src/javax/sound/sampled/AudioInputStream.java.">TargetDataLineInputStream</a>(<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>);
<a id="L155" name="L155"></a> 155         <a href="../D/16531.html" title="Multiple defined in 87 places.">format</a> = <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/19207.html" title="Multiple defined in 14 places.">getFormat</a>();
<a id="L156" name="L156"></a> 156         frameLength = <a href="../S/4392.html#L170" title="Defined at 170 in src/javax/sound/sampled/AudioSystem.java.">AudioSystem</a>.NOT_SPECIFIED;
<a id="L157" name="L157"></a> 157         frameSize = <a href="../D/16531.html" title="Multiple defined in 87 places.">format</a>.<a href="../S/4383.html#L348" title="Defined at 348 in src/javax/sound/sampled/AudioFormat.java.">getFrameSize</a>();
<a id="L158" name="L158"></a> 158 
<a id="L159" name="L159"></a> 159         <strong class="reserved">if</strong>( frameSize == <a href="../S/4392.html#L170" title="Defined at 170 in src/javax/sound/sampled/AudioSystem.java.">AudioSystem</a>.NOT_SPECIFIED || frameSize &lt;= 0) <em class="brace">{</em>
<a id="L160" name="L160"></a> 160             frameSize = 1;
<a id="L161" name="L161"></a> 161         <em class="brace">}</em>
<a id="L162" name="L162"></a> 162         <strong class="reserved">this</strong>.<a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a> = tstream;
<a id="L163" name="L163"></a> 163         framePos = 0;
<a id="L164" name="L164"></a> 164         markpos = 0;
<a id="L165" name="L165"></a> 165     <em class="brace">}</em>
<a id="L166" name="L166"></a> 166 
<a id="L167" name="L167"></a> 167 
<div class="comment">
      Obtains the audio format of the sound data in this audio input stream.
      @return an audio format object describing this stream's format</div>
<a id="L172" name="L172"></a> 172     <strong class="reserved">public</strong> <a href="../S/4383.html#L125" title="Defined at 125 in src/javax/sound/sampled/AudioFormat.java.">AudioFormat</a> <a href="../R/16695.html" title="Multiple referred from 25 places.">getFormat</a>() <em class="brace">{</em>
<a id="L173" name="L173"></a> 173         <strong class="reserved">return</strong> <a href="../D/16531.html" title="Multiple defined in 87 places.">format</a>;
<a id="L174" name="L174"></a> 174     <em class="brace">}</em>
<a id="L175" name="L175"></a> 175 
<a id="L176" name="L176"></a> 176 
<div class="comment">
      Obtains the length of the stream, expressed in sample frames rather than bytes.
      @return the length in sample frames</div>
<a id="L181" name="L181"></a> 181     <strong class="reserved">public</strong> <strong class="reserved">long</strong> getFrameLength() <em class="brace">{</em>
<a id="L182" name="L182"></a> 182         <strong class="reserved">return</strong> frameLength;
<a id="L183" name="L183"></a> 183     <em class="brace">}</em>
<a id="L184" name="L184"></a> 184 
<a id="L185" name="L185"></a> 185 
<div class="comment">
      Reads the next byte of data from the audio input stream.  The audio input
      stream's frame size must be one byte, or an <code>IOException</code>
      will be thrown.
      @return the next byte of data, or -1 if the end of the stream is reached
      @throws IOException if an input or output error occurs
      @see #read(byte[], int, int)
      @see #read(byte[])
      @see #available
      <p></p></div>
<a id="L198" name="L198"></a> 198     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/25407.html" title="Multiple referred from 1300 places.">read</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L199" name="L199"></a> 199         <strong class="reserved">if</strong>( frameSize != 1 ) <em class="brace">{</em>
<a id="L200" name="L200"></a> 200             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("cannot read a single byte if frame size &gt; 1");
<a id="L201" name="L201"></a> 201         <em class="brace">}</em>
<a id="L202" name="L202"></a> 202 
<a id="L203" name="L203"></a> 203         <strong class="reserved">byte</strong>[] <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a> = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[1];
<a id="L204" name="L204"></a> 204         <strong class="reserved">int</strong> temp = <a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(<a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>);
<a id="L205" name="L205"></a> 205         <strong class="reserved">if</strong> (temp &lt;= 0) <em class="brace">{</em>
<a id="L206" name="L206"></a> 206             <em class="comment">// we have a weird situation if read(byte[]) returns 0!</em>
<a id="L207" name="L207"></a> 207             <strong class="reserved">return</strong> -1;
<a id="L208" name="L208"></a> 208         <em class="brace">}</em>
<a id="L209" name="L209"></a> 209         <strong class="reserved">return</strong> <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[0] &amp; 0xFF;
<a id="L210" name="L210"></a> 210     <em class="brace">}</em>
<a id="L211" name="L211"></a> 211 
<a id="L212" name="L212"></a> 212 
<div class="comment">
      Reads some number of bytes from the audio input stream and stores them into
      the buffer array <code>b</code>. The number of bytes actually read is
      returned as an integer. This method blocks until input data is
      available, the end of the stream is detected, or an exception is thrown.
      <p>This method will always read an integral number of frames.
      If the length of the array is not an integral number
      of frames, a maximum of <code>b.length - (b.length % frameSize)
      </code> bytes will be read.
      @param b the buffer into which the data is read
      @return the total number of bytes read into the buffer, or -1 if there
      is no more data because the end of the stream has been reached
      @throws IOException if an input or output error occurs
      @see #read(byte[], int, int)
      @see #read()
      @see #available</p></div>
<a id="L231" name="L231"></a> 231     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/25407.html" title="Multiple referred from 1300 places.">read</a>(<strong class="reserved">byte</strong>[] b) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L232" name="L232"></a> 232         <strong class="reserved">return</strong> <a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(b,0,b.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L233" name="L233"></a> 233     <em class="brace">}</em>
<a id="L234" name="L234"></a> 234 
<a id="L235" name="L235"></a> 235 
<div class="comment">
      Reads up to a specified maximum number of bytes of data from the audio
      stream, putting them into the given byte array.
      <p>This method will always read an integral number of frames.
      If <code>len</code> does not specify an integral number
      of frames, a maximum of <code>len - (len % frameSize)
      </code> bytes will be read.
      @param b the buffer into which the data is read
      @param off the offset, from the beginning of array <code>b</code>, at which
      the data will be written
      @param len the maximum number of bytes to read
      @return the total number of bytes read into the buffer, or -1 if there
      is no more data because the end of the stream has been reached
      @throws IOException if an input or output error occurs
      @see #read(byte[])
      @see #read()
      @see #skip
      @see #available</p></div>
<a id="L256" name="L256"></a> 256     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/25407.html" title="Multiple referred from 1300 places.">read</a>(<strong class="reserved">byte</strong>[] b, <strong class="reserved">int</strong> off, <strong class="reserved">int</strong> len) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L257" name="L257"></a> 257 
<a id="L258" name="L258"></a> 258         <em class="comment">// make sure we don't read fractions of a frame.</em>
<a id="L259" name="L259"></a> 259         <strong class="reserved">if</strong>( (len%frameSize) != 0 ) <em class="brace">{</em>
<a id="L260" name="L260"></a> 260             len -= (len%frameSize);
<a id="L261" name="L261"></a> 261             <strong class="reserved">if</strong> (len == 0) <em class="brace">{</em>
<a id="L262" name="L262"></a> 262                 <strong class="reserved">return</strong> 0;
<a id="L263" name="L263"></a> 263             <em class="brace">}</em>
<a id="L264" name="L264"></a> 264         <em class="brace">}</em>
<a id="L265" name="L265"></a> 265 
<a id="L266" name="L266"></a> 266         <strong class="reserved">if</strong>( frameLength != <a href="../S/4392.html#L170" title="Defined at 170 in src/javax/sound/sampled/AudioSystem.java.">AudioSystem</a>.NOT_SPECIFIED ) <em class="brace">{</em>
<a id="L267" name="L267"></a> 267             <strong class="reserved">if</strong>( framePos &gt;= frameLength ) <em class="brace">{</em>
<a id="L268" name="L268"></a> 268                 <strong class="reserved">return</strong> -1;
<a id="L269" name="L269"></a> 269             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L270" name="L270"></a> 270 
<a id="L271" name="L271"></a> 271                 <em class="comment">// don't try to read beyond our own set length in frames</em>
<a id="L272" name="L272"></a> 272                 <strong class="reserved">if</strong>( (len/frameSize) &gt; (frameLength-framePos) ) <em class="brace">{</em>
<a id="L273" name="L273"></a> 273                     len = (<strong class="reserved">int</strong>) (frameLength-framePos) * frameSize;
<a id="L274" name="L274"></a> 274                 <em class="brace">}</em>
<a id="L275" name="L275"></a> 275             <em class="brace">}</em>
<a id="L276" name="L276"></a> 276         <em class="brace">}</em>
<a id="L277" name="L277"></a> 277 
<a id="L278" name="L278"></a> 278         <strong class="reserved">int</strong> bytesRead = 0;
<a id="L279" name="L279"></a> 279         <strong class="reserved">int</strong> thisOff = off;
<a id="L280" name="L280"></a> 280 
<a id="L281" name="L281"></a> 281         <em class="comment">// if we've bytes left from last call to read(),</em>
<a id="L282" name="L282"></a> 282         <em class="comment">// use them first</em>
<a id="L283" name="L283"></a> 283         <strong class="reserved">if</strong> (pushBackLen &gt; 0 &amp;&amp; len &gt;= pushBackLen) <em class="brace">{</em>
<a id="L284" name="L284"></a> 284             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(pushBackBuffer, 0,
<a id="L285" name="L285"></a> 285                              b, off, pushBackLen);
<a id="L286" name="L286"></a> 286             thisOff += pushBackLen;
<a id="L287" name="L287"></a> 287             len -= pushBackLen;
<a id="L288" name="L288"></a> 288             bytesRead += pushBackLen;
<a id="L289" name="L289"></a> 289             pushBackLen = 0;
<a id="L290" name="L290"></a> 290         <em class="brace">}</em>
<a id="L291" name="L291"></a> 291 
<a id="L292" name="L292"></a> 292         <strong class="reserved">int</strong> thisBytesRead = <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(b, thisOff, len);
<a id="L293" name="L293"></a> 293         <strong class="reserved">if</strong> (thisBytesRead == -1) <em class="brace">{</em>
<a id="L294" name="L294"></a> 294             <strong class="reserved">return</strong> -1;
<a id="L295" name="L295"></a> 295         <em class="brace">}</em>
<a id="L296" name="L296"></a> 296         <strong class="reserved">if</strong> (thisBytesRead &gt; 0) <em class="brace">{</em>
<a id="L297" name="L297"></a> 297             bytesRead += thisBytesRead;
<a id="L298" name="L298"></a> 298         <em class="brace">}</em>
<a id="L299" name="L299"></a> 299         <strong class="reserved">if</strong> (bytesRead &gt; 0) <em class="brace">{</em>
<a id="L300" name="L300"></a> 300             pushBackLen = bytesRead % frameSize;
<a id="L301" name="L301"></a> 301             <strong class="reserved">if</strong> (pushBackLen &gt; 0) <em class="brace">{</em>
<a id="L302" name="L302"></a> 302                 <em class="comment">// copy everything we got from the beginning of the frame</em>
<a id="L303" name="L303"></a> 303                 <em class="comment">// to our pushback buffer</em>
<a id="L304" name="L304"></a> 304                 <strong class="reserved">if</strong> (pushBackBuffer == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L305" name="L305"></a> 305                     pushBackBuffer = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[frameSize];
<a id="L306" name="L306"></a> 306                 <em class="brace">}</em>
<a id="L307" name="L307"></a> 307                 <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(b, off + bytesRead - pushBackLen,
<a id="L308" name="L308"></a> 308                                  pushBackBuffer, 0, pushBackLen);
<a id="L309" name="L309"></a> 309                 bytesRead -= pushBackLen;
<a id="L310" name="L310"></a> 310             <em class="brace">}</em>
<a id="L311" name="L311"></a> 311             <em class="comment">// make sure to update our framePos</em>
<a id="L312" name="L312"></a> 312             framePos += bytesRead/frameSize;
<a id="L313" name="L313"></a> 313         <em class="brace">}</em>
<a id="L314" name="L314"></a> 314         <strong class="reserved">return</strong> bytesRead;
<a id="L315" name="L315"></a> 315     <em class="brace">}</em>
<a id="L316" name="L316"></a> 316 
<a id="L317" name="L317"></a> 317 
<div class="comment">
      Skips over and discards a specified number of bytes from this
      audio input stream.
      @param n the requested number of bytes to be skipped
      @return the actual number of bytes skipped
      @throws IOException if an input or output error occurs
      @see #read
      @see #available</div>
<a id="L327" name="L327"></a> 327     <strong class="reserved">public</strong> <strong class="reserved">long</strong> <a href="../R/28643.html" title="Multiple referred from 174 places.">skip</a>(<strong class="reserved">long</strong> n) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L328" name="L328"></a> 328 
<a id="L329" name="L329"></a> 329         <em class="comment">// make sure not to skip fractional frames</em>
<a id="L330" name="L330"></a> 330         <strong class="reserved">if</strong>( (n%frameSize) != 0 ) <em class="brace">{</em>
<a id="L331" name="L331"></a> 331             n -= (n%frameSize);
<a id="L332" name="L332"></a> 332         <em class="brace">}</em>
<a id="L333" name="L333"></a> 333 
<a id="L334" name="L334"></a> 334         <strong class="reserved">if</strong>( frameLength != <a href="../S/4392.html#L170" title="Defined at 170 in src/javax/sound/sampled/AudioSystem.java.">AudioSystem</a>.NOT_SPECIFIED ) <em class="brace">{</em>
<a id="L335" name="L335"></a> 335             <em class="comment">// don't skip more than our set length in frames.</em>
<a id="L336" name="L336"></a> 336             <strong class="reserved">if</strong>( (n/frameSize) &gt; (frameLength-framePos) ) <em class="brace">{</em>
<a id="L337" name="L337"></a> 337                 n = (frameLength-framePos) * frameSize;
<a id="L338" name="L338"></a> 338             <em class="brace">}</em>
<a id="L339" name="L339"></a> 339         <em class="brace">}</em>
<a id="L340" name="L340"></a> 340         <strong class="reserved">long</strong> temp = <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/34598.html" title="Multiple defined in 46 places.">skip</a>(n);
<a id="L341" name="L341"></a> 341 
<a id="L342" name="L342"></a> 342         <em class="comment">// if no error, update our position.</em>
<a id="L343" name="L343"></a> 343         <strong class="reserved">if</strong>( temp%frameSize != 0 ) <em class="brace">{</em>
<a id="L344" name="L344"></a> 344 
<a id="L345" name="L345"></a> 345             <em class="comment">// Throw an IOException if we've skipped a fractional number of frames</em>
<a id="L346" name="L346"></a> 346             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("Could not skip an integer number of frames.");
<a id="L347" name="L347"></a> 347         <em class="brace">}</em>
<a id="L348" name="L348"></a> 348         <strong class="reserved">if</strong>( temp &gt;= 0 ) <em class="brace">{</em>
<a id="L349" name="L349"></a> 349             framePos += temp/frameSize;
<a id="L350" name="L350"></a> 350         <em class="brace">}</em>
<a id="L351" name="L351"></a> 351         <strong class="reserved">return</strong> temp;
<a id="L352" name="L352"></a> 352 
<a id="L353" name="L353"></a> 353     <em class="brace">}</em>
<a id="L354" name="L354"></a> 354 
<a id="L355" name="L355"></a> 355 
<div class="comment">
      Returns the maximum number of bytes that can be read (or skipped over) from this
      audio input stream without blocking.  This limit applies only to the next invocation of
      a <code>read</code> or <code>skip</code> method for this audio input stream; the limit
      can vary each time these methods are invoked.
      Depending on the underlying stream,an IOException may be thrown if this
      stream is closed.
      @return the number of bytes that can be read from this audio input stream without blocking
      @throws IOException if an input or output error occurs
      @see #read(byte[], int, int)
      @see #read(byte[])
      @see #read()
      @see #skip</div>
<a id="L370" name="L370"></a> 370     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/10425.html" title="Multiple referred from 160 places.">available</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L371" name="L371"></a> 371 
<a id="L372" name="L372"></a> 372         <strong class="reserved">int</strong> temp = <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/11656.html" title="Multiple defined in 33 places.">available</a>();
<a id="L373" name="L373"></a> 373 
<a id="L374" name="L374"></a> 374         <em class="comment">// don't return greater than our set length in frames</em>
<a id="L375" name="L375"></a> 375         <strong class="reserved">if</strong>( (frameLength != <a href="../S/4392.html#L170" title="Defined at 170 in src/javax/sound/sampled/AudioSystem.java.">AudioSystem</a>.NOT_SPECIFIED) &amp;&amp; ( (temp/frameSize) &gt; (frameLength-framePos)) ) <em class="brace">{</em>
<a id="L376" name="L376"></a> 376             <strong class="reserved">return</strong> (<strong class="reserved">int</strong>) (frameLength-framePos) * frameSize;
<a id="L377" name="L377"></a> 377         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L378" name="L378"></a> 378             <strong class="reserved">return</strong> temp;
<a id="L379" name="L379"></a> 379         <em class="brace">}</em>
<a id="L380" name="L380"></a> 380     <em class="brace">}</em>
<a id="L381" name="L381"></a> 381 
<a id="L382" name="L382"></a> 382 
<div class="comment">
      Closes this audio input stream and releases any system resources associated
      with the stream.
      @throws IOException if an input or output error occurs</div>
<a id="L388" name="L388"></a> 388     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11587.html" title="Multiple referred from 410 places.">close</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L389" name="L389"></a> 389         <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L390" name="L390"></a> 390     <em class="brace">}</em>
<a id="L391" name="L391"></a> 391 
<a id="L392" name="L392"></a> 392 
<div class="comment">
      Marks the current position in this audio input stream.
      @param readlimit the maximum number of bytes that can be read before
      the mark position becomes invalid.
      @see #reset
      @see #markSupported</div>
<a id="L400" name="L400"></a> 400 
<a id="L401" name="L401"></a> 401     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/23088.html" title="Multiple referred from 334 places.">mark</a>(<strong class="reserved">int</strong> readlimit) <em class="brace">{</em>
<a id="L402" name="L402"></a> 402 
<a id="L403" name="L403"></a> 403         <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>(readlimit);
<a id="L404" name="L404"></a> 404         <strong class="reserved">if</strong> (<a href="../D/27505.html" title="Multiple defined in 23 places.">markSupported</a>()) <em class="brace">{</em>
<a id="L405" name="L405"></a> 405             markpos = framePos;
<a id="L406" name="L406"></a> 406             <em class="comment">// remember the pushback buffer</em>
<a id="L407" name="L407"></a> 407             markPushBackLen = pushBackLen;
<a id="L408" name="L408"></a> 408             <strong class="reserved">if</strong> (markPushBackLen &gt; 0) <em class="brace">{</em>
<a id="L409" name="L409"></a> 409                 <strong class="reserved">if</strong> (markPushBackBuffer == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L410" name="L410"></a> 410                     markPushBackBuffer = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[frameSize];
<a id="L411" name="L411"></a> 411                 <em class="brace">}</em>
<a id="L412" name="L412"></a> 412                 <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(pushBackBuffer, 0, markPushBackBuffer, 0, markPushBackLen);
<a id="L413" name="L413"></a> 413             <em class="brace">}</em>
<a id="L414" name="L414"></a> 414         <em class="brace">}</em>
<a id="L415" name="L415"></a> 415     <em class="brace">}</em>
<a id="L416" name="L416"></a> 416 
<a id="L417" name="L417"></a> 417 
<div class="comment">
      Repositions this audio input stream to the position it had at the time its
      <code>mark</code> method was last invoked.
      @throws IOException if an input or output error occurs.
      @see #mark
      @see #markSupported</div>
<a id="L425" name="L425"></a> 425     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26238.html" title="Multiple referred from 619 places.">reset</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L426" name="L426"></a> 426 
<a id="L427" name="L427"></a> 427         <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/31151.html" title="Multiple defined in 296 places.">reset</a>();
<a id="L428" name="L428"></a> 428         framePos = markpos;
<a id="L429" name="L429"></a> 429         <em class="comment">// re-create the pushback buffer</em>
<a id="L430" name="L430"></a> 430         pushBackLen = markPushBackLen;
<a id="L431" name="L431"></a> 431         <strong class="reserved">if</strong> (pushBackLen &gt; 0) <em class="brace">{</em>
<a id="L432" name="L432"></a> 432             <strong class="reserved">if</strong> (pushBackBuffer == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L433" name="L433"></a> 433                 pushBackBuffer = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[frameSize - 1];
<a id="L434" name="L434"></a> 434             <em class="brace">}</em>
<a id="L435" name="L435"></a> 435             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(markPushBackBuffer, 0, pushBackBuffer, 0, pushBackLen);
<a id="L436" name="L436"></a> 436         <em class="brace">}</em>
<a id="L437" name="L437"></a> 437     <em class="brace">}</em>
<a id="L438" name="L438"></a> 438 
<a id="L439" name="L439"></a> 439 
<div class="comment">
      Tests whether this audio input stream supports the <code>mark</code> and
      <code>reset</code> methods.
      @return <code>true</code> if this stream supports the <code>mark</code>
      and <code>reset</code> methods; <code>false</code> otherwise
      @see #mark
      @see #reset</div>
<a id="L448" name="L448"></a> 448     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/23104.html" title="Multiple referred from 12 places.">markSupported</a>() <em class="brace">{</em>
<a id="L449" name="L449"></a> 449 
<a id="L450" name="L450"></a> 450         <strong class="reserved">return</strong> <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/27505.html" title="Multiple defined in 23 places.">markSupported</a>();
<a id="L451" name="L451"></a> 451     <em class="brace">}</em>
<a id="L452" name="L452"></a> 452 
<a id="L453" name="L453"></a> 453 
<div class="comment">
      Private inner class that makes a TargetDataLine look like an InputStream.</div>
<a id="L457" name="L457"></a> 457     <strong class="reserved">private</strong> <strong class="reserved">class</strong> <a href="../S/4378.html#L154" title="Referred from 154 in src/javax/sound/sampled/AudioInputStream.java.">TargetDataLineInputStream</a> <strong class="reserved">extends</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <em class="brace">{</em>
<a id="L458" name="L458"></a> 458 
<div class="comment">
          The TargetDataLine on which this TargetDataLineInputStream is based.</div>
<a id="L462" name="L462"></a> 462         <a href="../S/4384.html#L59" title="Defined at 59 in src/javax/sound/sampled/TargetDataLine.java.">TargetDataLine</a> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>;
<a id="L463" name="L463"></a> 463 
<a id="L464" name="L464"></a> 464 
<a id="L465" name="L465"></a> 465         TargetDataLineInputStream(<a href="../S/4384.html#L59" title="Defined at 59 in src/javax/sound/sampled/TargetDataLine.java.">TargetDataLine</a> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>) <em class="brace">{</em>
<a id="L466" name="L466"></a> 466             <strong class="reserved">super</strong>();
<a id="L467" name="L467"></a> 467             <strong class="reserved">this</strong>.<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> = <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>;
<a id="L468" name="L468"></a> 468         <em class="brace">}</em>
<a id="L469" name="L469"></a> 469 
<a id="L470" name="L470"></a> 470 
<a id="L471" name="L471"></a> 471         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/10425.html" title="Multiple referred from 160 places.">available</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L472" name="L472"></a> 472             <strong class="reserved">return</strong> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/11656.html" title="Multiple defined in 33 places.">available</a>();
<a id="L473" name="L473"></a> 473         <em class="brace">}</em>
<a id="L474" name="L474"></a> 474 
<a id="L475" name="L475"></a> 475         <em class="comment">//$$fb 2001-07-16: added this method to correctly close the underlying TargetDataLine.</em>
<a id="L476" name="L476"></a> 476         <em class="comment">// fixes bug 4479984</em>
<a id="L477" name="L477"></a> 477         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11587.html" title="Multiple referred from 410 places.">close</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L478" name="L478"></a> 478             <em class="comment">// the line needs to be flushed and stopped to avoid a dead lock...</em>
<a id="L479" name="L479"></a> 479             <em class="comment">// Probably related to bugs 4417527, 4334868, 4383457</em>
<a id="L480" name="L480"></a> 480             <strong class="reserved">if</strong> (<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/25158.html" title="Multiple defined in 19 places.">isActive</a>()) <em class="brace">{</em>
<a id="L481" name="L481"></a> 481                 <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/16474.html" title="Multiple defined in 60 places.">flush</a>();
<a id="L482" name="L482"></a> 482                 <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>();
<a id="L483" name="L483"></a> 483             <em class="brace">}</em>
<a id="L484" name="L484"></a> 484             <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L485" name="L485"></a> 485         <em class="brace">}</em>
<a id="L486" name="L486"></a> 486 
<a id="L487" name="L487"></a> 487         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/25407.html" title="Multiple referred from 1300 places.">read</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L488" name="L488"></a> 488 
<a id="L489" name="L489"></a> 489             <strong class="reserved">byte</strong>[] b = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[1];
<a id="L490" name="L490"></a> 490 
<a id="L491" name="L491"></a> 491             <strong class="reserved">int</strong> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = <a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(b, 0, 1);
<a id="L492" name="L492"></a> 492 
<a id="L493" name="L493"></a> 493             <strong class="reserved">if</strong> (<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> == -1) <em class="brace">{</em>
<a id="L494" name="L494"></a> 494                 <strong class="reserved">return</strong> -1;
<a id="L495" name="L495"></a> 495             <em class="brace">}</em>
<a id="L496" name="L496"></a> 496 
<a id="L497" name="L497"></a> 497             <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = (<strong class="reserved">int</strong>)b[0];
<a id="L498" name="L498"></a> 498 
<a id="L499" name="L499"></a> 499             <strong class="reserved">if</strong> (<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/19207.html" title="Multiple defined in 14 places.">getFormat</a>().<a href="../D/18747.html" title="Multiple defined in 37 places.">getEncoding</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../S/4383.html#L125" title="Defined at 125 in src/javax/sound/sampled/AudioFormat.java.">AudioFormat</a>.<a href="../D/2869.html" title="Multiple defined in 2 places.">Encoding</a>.PCM_SIGNED)) <em class="brace">{</em>
<a id="L500" name="L500"></a> 500                 <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> += 128;
<a id="L501" name="L501"></a> 501             <em class="brace">}</em>
<a id="L502" name="L502"></a> 502 
<a id="L503" name="L503"></a> 503             <strong class="reserved">return</strong> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>;
<a id="L504" name="L504"></a> 504         <em class="brace">}</em>
<a id="L505" name="L505"></a> 505 
<a id="L506" name="L506"></a> 506 
<a id="L507" name="L507"></a> 507         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/25407.html" title="Multiple referred from 1300 places.">read</a>(<strong class="reserved">byte</strong>[] b, <strong class="reserved">int</strong> off, <strong class="reserved">int</strong> len) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L508" name="L508"></a> 508             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L509" name="L509"></a> 509                 <strong class="reserved">return</strong> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(b, off, len);
<a id="L510" name="L510"></a> 510             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> e) <em class="brace">{</em>
<a id="L511" name="L511"></a> 511                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>(e.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L512" name="L512"></a> 512             <em class="brace">}</em>
<a id="L513" name="L513"></a> 513         <em class="brace">}</em>
<a id="L514" name="L514"></a> 514     <em class="brace">}</em>
<a id="L515" name="L515"></a> 515 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L172">[^]</a><a href="#L507">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>