<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xpath/internal/patterns/StepPattern.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L95">[^]</a><a href="#L1022">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L95" title="Defined at 95.">calcTargetString</a></li>
<li><a href="#L137" title="Defined at 137.">getTargetString</a></li>
<li><a href="#L160" title="Defined at 160.">fixupVariables</a></li>
<li><a href="#L186" title="Defined at 186.">setRelativePathPattern</a></li>
<li><a href="#L202" title="Defined at 202.">getRelativePathPattern</a></li>
<li><a href="#L220" title="Defined at 220.">getPredicates</a></li>
<li><a href="#L240" title="Defined at 240.">canTraverseOutsideSubtree</a></li>
<li><a href="#L262" title="Defined at 262.">getPredicate</a></li>
<li><a href="#L273" title="Defined at 273.">getPredicateCount</a></li>
<li><a href="#L285" title="Defined at 285.">setPredicates</a></li>
<li><a href="#L303" title="Defined at 303.">calcScore</a></li>
<li><a href="#L332" title="Defined at 332.">execute</a></li>
<li><a href="#L362" title="Defined at 362.">execute</a></li>
<li><a href="#L383" title="Defined at 383.">execute</a></li>
<li><a href="#L430" title="Defined at 430.">checkProximityPosition</a></li>
<li><a href="#L525" title="Defined at 525.">getProximityPosition</a></li>
<li><a href="#L629" title="Defined at 629.">getProximityPosition</a></li>
<li><a href="#L645" title="Defined at 645.">getLastPos</a></li>
<li><a href="#L666" title="Defined at 666.">executeRelativePathPattern</a></li>
<li><a href="#L710" title="Defined at 710.">executePredicates</a></li>
<li><a href="#L789" title="Defined at 789.">toString</a></li>
<li><a href="#L894" title="Defined at 894.">getMatchScore</a></li>
<li><a href="#L922" title="Defined at 922.">setAxis</a></li>
<li><a href="#L933" title="Defined at 933.">getAxis</a></li>
<li><a href="#L950" title="Defined at 950.">getExpression</a></li>
<li><a href="#L959" title="Defined at 959.">setExpression</a></li>
<li><a href="#L969" title="Defined at 969.">callVisitors</a></li>
<li><a href="#L981" title="Defined at 981.">callSubtreeVisitors</a></li>
<li><a href="#L1005" title="Defined at 1005.">getExpression</a></li>
<li><a href="#L1013" title="Defined at 1013.">setExpression</a></li>
<li><a href="#L1022" title="Defined at 1022.">deepEquals</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: StepPattern.java,v 1.2.4.2 2005/09/15 00:21:16 jeffsuttor Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xpath.internal.patterns;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.Axis;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTM;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMAxisTraverser;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMFilter;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.Expression;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.ExpressionOwner;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.XPathContext;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.XPathVisitor;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.axes.SubContextList;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.compiler.PsuedoNames;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.objects.XObject;
<a id="L36" name="L36"></a>  36 
<div class="comment">
  This class represents a single pattern match step.
  @xsl.usage advanced</div>
<a id="L41" name="L41"></a>  41 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/7609.html" title="Multiple referred from 82 places.">StepPattern</a> <strong class="reserved">extends</strong> <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a> <strong class="reserved">implements</strong> <a href="../S/4890.html#L32" title="Defined at 32 in src/com/sun/org/apache/xpath/internal/axes/SubContextList.java.">SubContextList</a>, <a href="../S/4989.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/ExpressionOwner.java.">ExpressionOwner</a>
<a id="L42" name="L42"></a>  42 <em class="brace">{</em>
<a id="L43" name="L43"></a>  43     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = 9071668960168152644L;
<a id="L44" name="L44"></a>  44 
<div class="comment">
   /** The axis for this test. */</div>
<a id="L46" name="L46"></a>  46   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> m_axis;
<a id="L47" name="L47"></a>  47 
<div class="comment">
    Construct a StepPattern that tests for namespaces and node names.
    @param whatToShow Bit set defined mainly by {@link org.w3c.dom.traversal.NodeFilter}.
    @param namespace The namespace to be tested.
    @param name The local name to be tested.
    @param axis The Axis for this test, one of of Axes.ANCESTORORSELF, etc.
    @param axisForPredicate No longer used.</div>
<a id="L58" name="L58"></a>  58   <strong class="reserved">public</strong> StepPattern(<strong class="reserved">int</strong> whatToShow, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <strong class="reserved">int</strong> axis,
<a id="L59" name="L59"></a>  59                      <strong class="reserved">int</strong> axisForPredicate)
<a id="L60" name="L60"></a>  60   <em class="brace">{</em>
<a id="L61" name="L61"></a>  61 
<a id="L62" name="L62"></a>  62     <strong class="reserved">super</strong>(whatToShow, <a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L63" name="L63"></a>  63 
<a id="L64" name="L64"></a>  64     m_axis = axis;
<a id="L65" name="L65"></a>  65   <em class="brace">}</em>
<a id="L66" name="L66"></a>  66 
<div class="comment">
    Construct a StepPattern that doesn't test for node names.
    @param whatToShow Bit set defined mainly by {@link org.w3c.dom.traversal.NodeFilter}.
    @param axis The Axis for this test, one of of Axes.ANCESTORORSELF, etc.
    @param axisForPredicate No longer used.</div>
<a id="L75" name="L75"></a>  75   <strong class="reserved">public</strong> StepPattern(<strong class="reserved">int</strong> whatToShow, <strong class="reserved">int</strong> axis, <strong class="reserved">int</strong> axisForPredicate)
<a id="L76" name="L76"></a>  76   <em class="brace">{</em>
<a id="L77" name="L77"></a>  77 
<a id="L78" name="L78"></a>  78     <strong class="reserved">super</strong>(whatToShow);
<a id="L79" name="L79"></a>  79 
<a id="L80" name="L80"></a>  80     m_axis = axis;
<a id="L81" name="L81"></a>  81   <em class="brace">}</em>
<a id="L82" name="L82"></a>  82 
<div class="comment">
    The target local name or psuedo name, for hash table lookup optimization.
     @serial</div>
<a id="L87" name="L87"></a>  87   <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> m_targetString;  <em class="comment">// only calculate on head</em>
<a id="L88" name="L88"></a>  88 
<div class="comment">
    Calculate the local name or psuedo name of the node that this pattern will test,
    for hash table lookup optimization.
    @see com.sun.org.apache.xpath.internal.compiler.PsuedoNames</div>
<a id="L95" name="L95"></a>  95   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/10783.html" title="Multiple referred from 2 places.">calcTargetString</a>()
<a id="L96" name="L96"></a>  96   <em class="brace">{</em>
<a id="L97" name="L97"></a>  97 
<a id="L98" name="L98"></a>  98     <strong class="reserved">int</strong> whatToShow = <a href="../D/23670.html" title="Multiple defined in 14 places.">getWhatToShow</a>();
<a id="L99" name="L99"></a>  99 
<a id="L100" name="L100"></a> 100     <strong class="reserved">switch</strong> (whatToShow)
<a id="L101" name="L101"></a> 101     <em class="brace">{</em>
<a id="L102" name="L102"></a> 102     <strong class="reserved">case</strong> <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_COMMENT :
<a id="L103" name="L103"></a> 103       m_targetString = <a href="../S/5002.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/compiler/PsuedoNames.java.">PsuedoNames</a>.PSEUDONAME_COMMENT;
<a id="L104" name="L104"></a> 104       <strong class="reserved">break</strong>;
<a id="L105" name="L105"></a> 105     <strong class="reserved">case</strong> <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_TEXT :
<a id="L106" name="L106"></a> 106     <strong class="reserved">case</strong> <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_CDATA_SECTION :
<a id="L107" name="L107"></a> 107     <strong class="reserved">case</strong> (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_TEXT | <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_CDATA_SECTION) :
<a id="L108" name="L108"></a> 108       m_targetString = <a href="../S/5002.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/compiler/PsuedoNames.java.">PsuedoNames</a>.PSEUDONAME_TEXT;
<a id="L109" name="L109"></a> 109       <strong class="reserved">break</strong>;
<a id="L110" name="L110"></a> 110     <strong class="reserved">case</strong> <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ALL :
<a id="L111" name="L111"></a> 111       m_targetString = <a href="../S/5002.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/compiler/PsuedoNames.java.">PsuedoNames</a>.PSEUDONAME_ANY;
<a id="L112" name="L112"></a> 112       <strong class="reserved">break</strong>;
<a id="L113" name="L113"></a> 113     <strong class="reserved">case</strong> <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_DOCUMENT :
<a id="L114" name="L114"></a> 114     <strong class="reserved">case</strong> <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_DOCUMENT | <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_DOCUMENT_FRAGMENT :
<a id="L115" name="L115"></a> 115       m_targetString = <a href="../S/5002.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/compiler/PsuedoNames.java.">PsuedoNames</a>.PSEUDONAME_ROOT;
<a id="L116" name="L116"></a> 116       <strong class="reserved">break</strong>;
<a id="L117" name="L117"></a> 117     <strong class="reserved">case</strong> <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ELEMENT :
<a id="L118" name="L118"></a> 118       <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.WILD == m_name)
<a id="L119" name="L119"></a> 119         m_targetString = <a href="../S/5002.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/compiler/PsuedoNames.java.">PsuedoNames</a>.PSEUDONAME_ANY;
<a id="L120" name="L120"></a> 120       <strong class="reserved">else</strong>
<a id="L121" name="L121"></a> 121         m_targetString = m_name;
<a id="L122" name="L122"></a> 122       <strong class="reserved">break</strong>;
<a id="L123" name="L123"></a> 123     <strong class="reserved">default</strong> :
<a id="L124" name="L124"></a> 124       m_targetString = <a href="../S/5002.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/compiler/PsuedoNames.java.">PsuedoNames</a>.PSEUDONAME_ANY;
<a id="L125" name="L125"></a> 125       <strong class="reserved">break</strong>;
<a id="L126" name="L126"></a> 126     <em class="brace">}</em>
<a id="L127" name="L127"></a> 127   <em class="brace">}</em>
<a id="L128" name="L128"></a> 128 
<div class="comment">
    Get the local name or psuedo name of the node that this pattern will test,
    for hash table lookup optimization.
    @return local name or psuedo name of the node.
    @see com.sun.org.apache.xpath.internal.compiler.PsuedoNames</div>
<a id="L137" name="L137"></a> 137   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> getTargetString()
<a id="L138" name="L138"></a> 138   <em class="brace">{</em>
<a id="L139" name="L139"></a> 139     <strong class="reserved">return</strong> m_targetString;
<a id="L140" name="L140"></a> 140   <em class="brace">}</em>
<a id="L141" name="L141"></a> 141 
<div class="comment">
    Reference to nodetest and predicate for
    parent or ancestor.
    @serial</div>
<a id="L147" name="L147"></a> 147   <a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a> m_relativePathPattern;
<a id="L148" name="L148"></a> 148 
<div class="comment">
    This function is used to fixup variables from QNames to stack frame
    indexes at stylesheet build time.
    @param vars List of QNames that correspond to variables.  This list
    should be searched backwards for the first qualified name that
    corresponds to the variable reference qname.  The position of the
    QName in the vector from the start of the vector will be its position
    in the stack frame (but variables above the globalsTop value will need
    to be offset to the current stack frame).
    @param globalsSize The number of variables in the global variable area.</div>
<a id="L160" name="L160"></a> 160   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/14669.html" title="Multiple referred from 33 places.">fixupVariables</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util.<a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> vars, <strong class="reserved">int</strong> globalsSize)
<a id="L161" name="L161"></a> 161   <em class="brace">{</em>
<a id="L162" name="L162"></a> 162 
<a id="L163" name="L163"></a> 163     <strong class="reserved">super</strong>.<a href="../D/16440.html" title="Multiple defined in 31 places.">fixupVariables</a>(vars, globalsSize);
<a id="L164" name="L164"></a> 164 
<a id="L165" name="L165"></a> 165     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_predicates)
<a id="L166" name="L166"></a> 166     <em class="brace">{</em>
<a id="L167" name="L167"></a> 167       <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++)
<a id="L168" name="L168"></a> 168       <em class="brace">{</em>
<a id="L169" name="L169"></a> 169         m_predicates[i].<a href="../D/16440.html" title="Multiple defined in 31 places.">fixupVariables</a>(vars, globalsSize);
<a id="L170" name="L170"></a> 170       <em class="brace">}</em>
<a id="L171" name="L171"></a> 171     <em class="brace">}</em>
<a id="L172" name="L172"></a> 172 
<a id="L173" name="L173"></a> 173     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_relativePathPattern)
<a id="L174" name="L174"></a> 174     <em class="brace">{</em>
<a id="L175" name="L175"></a> 175       m_relativePathPattern.<a href="../D/16440.html" title="Multiple defined in 31 places.">fixupVariables</a>(vars, globalsSize);
<a id="L176" name="L176"></a> 176     <em class="brace">}</em>
<a id="L177" name="L177"></a> 177   <em class="brace">}</em>
<a id="L178" name="L178"></a> 178 
<div class="comment">
    Set the reference to nodetest and predicate for
    parent or ancestor.
    @param expr The relative pattern expression.</div>
<a id="L186" name="L186"></a> 186   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28013.html" title="Multiple referred from 5 places.">setRelativePathPattern</a>(<a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a> <a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>)
<a id="L187" name="L187"></a> 187   <em class="brace">{</em>
<a id="L188" name="L188"></a> 188 
<a id="L189" name="L189"></a> 189     m_relativePathPattern = <a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>;
<a id="L190" name="L190"></a> 190     <a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>.<a href="../D/15890.html" title="Multiple defined in 3 places.">exprSetParent</a>(<strong class="reserved">this</strong>);
<a id="L191" name="L191"></a> 191 
<a id="L192" name="L192"></a> 192     <a href="../D/12031.html" title="Multiple defined in 3 places.">calcScore</a>();
<a id="L193" name="L193"></a> 193   <em class="brace">}</em>
<a id="L194" name="L194"></a> 194 
<div class="comment">
    Get the reference to nodetest and predicate for
    parent or ancestor.
    @return The relative pattern expression.</div>
<a id="L202" name="L202"></a> 202   <strong class="reserved">public</strong> <a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a> <a href="../R/18658.html" title="Multiple referred from 2 places.">getRelativePathPattern</a>()
<a id="L203" name="L203"></a> 203   <em class="brace">{</em>
<a id="L204" name="L204"></a> 204     <strong class="reserved">return</strong> m_relativePathPattern;
<a id="L205" name="L205"></a> 205   <em class="brace">}</em>
<a id="L206" name="L206"></a> 206 
<a id="L207" name="L207"></a> 207   <em class="comment">//  /**</em>
<a id="L208" name="L208"></a> 208   <em class="comment">//   * Set the list of predicate expressions for this pattern step.</em>
<a id="L209" name="L209"></a> 209   <em class="comment">//   * @param predicates List of expression objects.</em>
<a id="L210" name="L210"></a> 210   <em class="comment">//   */</em>
<a id="L211" name="L211"></a> 211   <em class="comment">//  public void setPredicates(Expression[] predicates)</em>
<a id="L212" name="L212"></a> 212   <em class="comment">//  {</em>
<a id="L213" name="L213"></a> 213   <em class="comment">//    m_predicates = predicates;</em>
<a id="L214" name="L214"></a> 214   <em class="comment">//  }</em>
<a id="L215" name="L215"></a> 215 
<div class="comment">
    Set the list of predicate expressions for this pattern step.
    @return List of expression objects.</div>
<a id="L220" name="L220"></a> 220   <strong class="reserved">public</strong> <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a>[] <a href="../R/18397.html" title="Multiple referred from 2 places.">getPredicates</a>()
<a id="L221" name="L221"></a> 221   <em class="brace">{</em>
<a id="L222" name="L222"></a> 222     <strong class="reserved">return</strong> m_predicates;
<a id="L223" name="L223"></a> 223   <em class="brace">}</em>
<a id="L224" name="L224"></a> 224 
<div class="comment">
    The list of predicate expressions for this pattern step.
     @serial</div>
<a id="L229" name="L229"></a> 229   <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a>[] m_predicates;
<a id="L230" name="L230"></a> 230 
<div class="comment">
    Tell if this expression or it's subexpressions can traverse outside
    the current subtree.
    NOTE: Ancestors tests with predicates are problematic, and will require
    special treatment.
    @return true if traversal outside the context node's subtree can occur.</div>
<a id="L240" name="L240"></a> 240   <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/10909.html" title="Multiple referred from 14 places.">canTraverseOutsideSubtree</a>()
<a id="L241" name="L241"></a> 241   <em class="brace">{</em>
<a id="L242" name="L242"></a> 242 
<a id="L243" name="L243"></a> 243     <strong class="reserved">int</strong> n = <a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>();
<a id="L244" name="L244"></a> 244 
<a id="L245" name="L245"></a> 245     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L246" name="L246"></a> 246     <em class="brace">{</em>
<a id="L247" name="L247"></a> 247       <strong class="reserved">if</strong> (<a href="../D/21564.html" title="Multiple defined in 2 places.">getPredicate</a>(i).<a href="../D/12178.html" title="Multiple defined in 11 places.">canTraverseOutsideSubtree</a>())
<a id="L248" name="L248"></a> 248         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L249" name="L249"></a> 249     <em class="brace">}</em>
<a id="L250" name="L250"></a> 250 
<a id="L251" name="L251"></a> 251     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L252" name="L252"></a> 252   <em class="brace">}</em>
<a id="L253" name="L253"></a> 253 
<div class="comment">
    Get a predicate expression.
    @param i The index of the predicate.
    @return A predicate expression.</div>
<a id="L262" name="L262"></a> 262   <strong class="reserved">public</strong> <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../R/18394.html" title="Multiple referred from 2 places.">getPredicate</a>(<strong class="reserved">int</strong> i)
<a id="L263" name="L263"></a> 263   <em class="brace">{</em>
<a id="L264" name="L264"></a> 264     <strong class="reserved">return</strong> m_predicates[i];
<a id="L265" name="L265"></a> 265   <em class="brace">}</em>
<a id="L266" name="L266"></a> 266 
<div class="comment">
    Get the number of predicates for this match pattern step.
    @return the number of predicates for this match pattern step.</div>
<a id="L273" name="L273"></a> 273   <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/18395.html" title="Multiple referred from 15 places.">getPredicateCount</a>()
<a id="L274" name="L274"></a> 274   <em class="brace">{</em>
<a id="L275" name="L275"></a> 275     <strong class="reserved">return</strong> (<strong class="reserved">null</strong> == m_predicates) ? 0 : m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L276" name="L276"></a> 276   <em class="brace">}</em>
<a id="L277" name="L277"></a> 277 
<div class="comment">
    Set the predicates for this match pattern step.
    @param predicates An array of expressions that define predicates
                      for this step.</div>
<a id="L285" name="L285"></a> 285   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27947.html" title="Multiple referred from 6 places.">setPredicates</a>(<a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a>[] predicates)
<a id="L286" name="L286"></a> 286   <em class="brace">{</em>
<a id="L287" name="L287"></a> 287 
<a id="L288" name="L288"></a> 288     m_predicates = predicates;
<a id="L289" name="L289"></a> 289     <strong class="reserved">if</strong>(<strong class="reserved">null</strong> != predicates)
<a id="L290" name="L290"></a> 290     <em class="brace">{</em>
<a id="L291" name="L291"></a> 291         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i = 0; i &lt; predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++)
<a id="L292" name="L292"></a> 292         <em class="brace">{</em>
<a id="L293" name="L293"></a> 293                 predicates[i].<a href="../D/15890.html" title="Multiple defined in 3 places.">exprSetParent</a>(<strong class="reserved">this</strong>);
<a id="L294" name="L294"></a> 294         <em class="brace">}</em>
<a id="L295" name="L295"></a> 295     <em class="brace">}</em>
<a id="L296" name="L296"></a> 296 
<a id="L297" name="L297"></a> 297     <a href="../D/12031.html" title="Multiple defined in 3 places.">calcScore</a>();
<a id="L298" name="L298"></a> 298   <em class="brace">}</em>
<a id="L299" name="L299"></a> 299 
<div class="comment">
    Static calc of match score.</div>
<a id="L303" name="L303"></a> 303   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/10779.html" title="Multiple referred from 5 places.">calcScore</a>()
<a id="L304" name="L304"></a> 304   <em class="brace">{</em>
<a id="L305" name="L305"></a> 305 
<a id="L306" name="L306"></a> 306     <strong class="reserved">if</strong> ((<a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>() &gt; 0) || (<strong class="reserved">null</strong> != m_relativePathPattern))
<a id="L307" name="L307"></a> 307     <em class="brace">{</em>
<a id="L308" name="L308"></a> 308       m_score = SCORE_OTHER;
<a id="L309" name="L309"></a> 309     <em class="brace">}</em>
<a id="L310" name="L310"></a> 310     <strong class="reserved">else</strong>
<a id="L311" name="L311"></a> 311       <strong class="reserved">super</strong>.<a href="../D/12031.html" title="Multiple defined in 3 places.">calcScore</a>();
<a id="L312" name="L312"></a> 312 
<a id="L313" name="L313"></a> 313     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == m_targetString)
<a id="L314" name="L314"></a> 314       <a href="../S/4858.html#L95" title="Defined at 95 in src/com/sun/org/apache/xpath/internal/patterns/StepPattern.java.">calcTargetString</a>();
<a id="L315" name="L315"></a> 315   <em class="brace">}</em>
<a id="L316" name="L316"></a> 316 
<div class="comment">
    Execute this pattern step, including predicates.
    @param xctxt XPath runtime context.
    @param currentNode The current node context.
    @return {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NODETEST},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NONE},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NSWILD},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_QNAME}, or
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_OTHER}.
    @throws javax.xml.transform.TransformerException</div>
<a id="L332" name="L332"></a> 332   <strong class="reserved">public</strong> <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> <a href="../R/14093.html" title="Multiple referred from 117 places.">execute</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt, <strong class="reserved">int</strong> currentNode)
<a id="L333" name="L333"></a> 333           <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L334" name="L334"></a> 334   <em class="brace">{</em>
<a id="L335" name="L335"></a> 335 
<a id="L336" name="L336"></a> 336     <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm = xctxt.<a href="../D/18175.html" title="Multiple defined in 19 places.">getDTM</a>(currentNode);
<a id="L337" name="L337"></a> 337 
<a id="L338" name="L338"></a> 338     <strong class="reserved">if</strong> (dtm != <strong class="reserved">null</strong>)
<a id="L339" name="L339"></a> 339     <em class="brace">{</em>
<a id="L340" name="L340"></a> 340       <strong class="reserved">int</strong> expType = dtm.<a href="../D/18929.html" title="Multiple defined in 16 places.">getExpandedTypeID</a>(currentNode);
<a id="L341" name="L341"></a> 341 
<a id="L342" name="L342"></a> 342       <strong class="reserved">return</strong> <a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt, currentNode, dtm, expType);
<a id="L343" name="L343"></a> 343     <em class="brace">}</em>
<a id="L344" name="L344"></a> 344 
<a id="L345" name="L345"></a> 345     <strong class="reserved">return</strong> <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE;
<a id="L346" name="L346"></a> 346   <em class="brace">}</em>
<a id="L347" name="L347"></a> 347 
<div class="comment">
    Execute this pattern step, including predicates.
    @param xctxt XPath runtime context.
    @return {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NODETEST},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NONE},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NSWILD},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_QNAME}, or
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_OTHER}.
    @throws javax.xml.transform.TransformerException</div>
<a id="L362" name="L362"></a> 362   <strong class="reserved">public</strong> <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> <a href="../R/14093.html" title="Multiple referred from 117 places.">execute</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L363" name="L363"></a> 363           <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L364" name="L364"></a> 364   <em class="brace">{</em>
<a id="L365" name="L365"></a> 365     <strong class="reserved">return</strong> <a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt, xctxt.<a href="../D/18114.html" title="Multiple defined in 11 places.">getCurrentNode</a>());
<a id="L366" name="L366"></a> 366   <em class="brace">}</em>
<a id="L367" name="L367"></a> 367 
<div class="comment">
    Execute an expression in the XPath runtime context, and return the
    result of the expression.
    @param xctxt The XPath runtime context.
    @param currentNode The currentNode.
    @param dtm The DTM of the current node.
    @param expType The expanded type ID of the current node.
    @return The result of the expression in the form of a <code>XObject</code>.
    @throws javax.xml.transform.TransformerException if a runtime exception
            occurs.</div>
<a id="L383" name="L383"></a> 383   <strong class="reserved">public</strong> <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> <a href="../R/14093.html" title="Multiple referred from 117 places.">execute</a>(
<a id="L384" name="L384"></a> 384           <a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt, <strong class="reserved">int</strong> currentNode, <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm, <strong class="reserved">int</strong> expType)
<a id="L385" name="L385"></a> 385             <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L386" name="L386"></a> 386   <em class="brace">{</em>
<a id="L387" name="L387"></a> 387 
<a id="L388" name="L388"></a> 388     <strong class="reserved">if</strong> (m_whatToShow == <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SHOW_BYFUNCTION)
<a id="L389" name="L389"></a> 389     <em class="brace">{</em>
<a id="L390" name="L390"></a> 390       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_relativePathPattern)
<a id="L391" name="L391"></a> 391       <em class="brace">{</em>
<a id="L392" name="L392"></a> 392         <strong class="reserved">return</strong> m_relativePathPattern.<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt);
<a id="L393" name="L393"></a> 393       <em class="brace">}</em>
<a id="L394" name="L394"></a> 394       <strong class="reserved">else</strong>
<a id="L395" name="L395"></a> 395         <strong class="reserved">return</strong> <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE;
<a id="L396" name="L396"></a> 396     <em class="brace">}</em>
<a id="L397" name="L397"></a> 397 
<a id="L398" name="L398"></a> 398     <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> score;
<a id="L399" name="L399"></a> 399 
<a id="L400" name="L400"></a> 400     score = <strong class="reserved">super</strong>.<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt, currentNode, dtm, expType);
<a id="L401" name="L401"></a> 401 
<a id="L402" name="L402"></a> 402     <strong class="reserved">if</strong> (score == <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE)
<a id="L403" name="L403"></a> 403       <strong class="reserved">return</strong> <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE;
<a id="L404" name="L404"></a> 404 
<a id="L405" name="L405"></a> 405     <strong class="reserved">if</strong> (<a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>() != 0)
<a id="L406" name="L406"></a> 406     <em class="brace">{</em>
<a id="L407" name="L407"></a> 407       <strong class="reserved">if</strong> (!<a href="../D/15809.html" title="Multiple defined in 2 places.">executePredicates</a>(xctxt, dtm, currentNode))
<a id="L408" name="L408"></a> 408         <strong class="reserved">return</strong> <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE;
<a id="L409" name="L409"></a> 409     <em class="brace">}</em>
<a id="L410" name="L410"></a> 410 
<a id="L411" name="L411"></a> 411     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_relativePathPattern)
<a id="L412" name="L412"></a> 412       <strong class="reserved">return</strong> m_relativePathPattern.<a href="../D/15811.html" title="Multiple defined in 2 places.">executeRelativePathPattern</a>(xctxt, dtm,
<a id="L413" name="L413"></a> 413               currentNode);
<a id="L414" name="L414"></a> 414 
<a id="L415" name="L415"></a> 415     <strong class="reserved">return</strong> score;
<a id="L416" name="L416"></a> 416   <em class="brace">}</em>
<a id="L417" name="L417"></a> 417 
<div class="comment">
    New Method to check whether the current node satisfies a position predicate
    @param xctxt The XPath runtime context.
    @param predPos Which predicate we're evaluating of foo[1][2][3].
    @param dtm The DTM of the current node.
    @param context The currentNode.
    @param pos The position being requested, i.e. the value returned by
               m_predicates[predPos].execute(xctxt).
    @return true of the position of the context matches pos, false otherwise.</div>
<a id="L430" name="L430"></a> 430   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../S/4858.html#L747" title="Referred from 747 in src/com/sun/org/apache/xpath/internal/patterns/StepPattern.java.">checkProximityPosition</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt,
<a id="L431" name="L431"></a> 431           <strong class="reserved">int</strong> predPos, <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm, <strong class="reserved">int</strong> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, <strong class="reserved">int</strong> pos)
<a id="L432" name="L432"></a> 432   <em class="brace">{</em>
<a id="L433" name="L433"></a> 433 
<a id="L434" name="L434"></a> 434     <strong class="reserved">try</strong>
<a id="L435" name="L435"></a> 435     <em class="brace">{</em>
<a id="L436" name="L436"></a> 436       <a href="../S/5919.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/DTMAxisTraverser.java.">DTMAxisTraverser</a> traverser =
<a id="L437" name="L437"></a> 437         dtm.<a href="../D/17166.html" title="Multiple defined in 5 places.">getAxisTraverser</a>(<a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.PRECEDINGSIBLING);
<a id="L438" name="L438"></a> 438 
<a id="L439" name="L439"></a> 439       <strong class="reserved">for</strong> (<strong class="reserved">int</strong> child = traverser.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>); <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != child;
<a id="L440" name="L440"></a> 440               child = traverser.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, child))
<a id="L441" name="L441"></a> 441       <em class="brace">{</em>
<a id="L442" name="L442"></a> 442         <strong class="reserved">try</strong>
<a id="L443" name="L443"></a> 443         <em class="brace">{</em>
<a id="L444" name="L444"></a> 444           xctxt.<a href="../S/4946.html#L750" title="Defined at 750 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushCurrentNode</a>(child);
<a id="L445" name="L445"></a> 445 
<a id="L446" name="L446"></a> 446           <strong class="reserved">if</strong> (<a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE != <strong class="reserved">super</strong>.<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt, child))
<a id="L447" name="L447"></a> 447           <em class="brace">{</em>
<a id="L448" name="L448"></a> 448             <strong class="reserved">boolean</strong> pass = <strong class="reserved">true</strong>;
<a id="L449" name="L449"></a> 449 
<a id="L450" name="L450"></a> 450             <strong class="reserved">try</strong>
<a id="L451" name="L451"></a> 451             <em class="brace">{</em>
<a id="L452" name="L452"></a> 452               xctxt.<a href="../S/4946.html#L941" title="Defined at 941 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushSubContextList</a>(<strong class="reserved">this</strong>);
<a id="L453" name="L453"></a> 453 
<a id="L454" name="L454"></a> 454               <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; predPos; i++)
<a id="L455" name="L455"></a> 455               <em class="brace">{</em>
<a id="L456" name="L456"></a> 456                 xctxt.<a href="../S/4946.html#L831" title="Defined at 831 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushPredicatePos</a>(i);
<a id="L457" name="L457"></a> 457                 <strong class="reserved">try</strong>
<a id="L458" name="L458"></a> 458                 <em class="brace">{</em>
<a id="L459" name="L459"></a> 459                   <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> = m_predicates[i].<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt);
<a id="L460" name="L460"></a> 460 
<a id="L461" name="L461"></a> 461                   <strong class="reserved">try</strong>
<a id="L462" name="L462"></a> 462                   <em class="brace">{</em>
<a id="L463" name="L463"></a> 463                     <strong class="reserved">if</strong> (<a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a>.CLASS_NUMBER == <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>())
<a id="L464" name="L464"></a> 464                     <em class="brace">{</em>
<a id="L465" name="L465"></a> 465                       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>("Why: Should never have been called");
<a id="L466" name="L466"></a> 466                     <em class="brace">}</em>
<a id="L467" name="L467"></a> 467                     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!<a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/11889.html" title="Multiple defined in 2 places.">boolWithSideEffects</a>())
<a id="L468" name="L468"></a> 468                     <em class="brace">{</em>
<a id="L469" name="L469"></a> 469                       pass = <strong class="reserved">false</strong>;
<a id="L470" name="L470"></a> 470 
<a id="L471" name="L471"></a> 471                       <strong class="reserved">break</strong>;
<a id="L472" name="L472"></a> 472                     <em class="brace">}</em>
<a id="L473" name="L473"></a> 473                   <em class="brace">}</em>
<a id="L474" name="L474"></a> 474                   <strong class="reserved">finally</strong>
<a id="L475" name="L475"></a> 475                   <em class="brace">{</em>
<a id="L476" name="L476"></a> 476                     <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/14888.html" title="Multiple defined in 26 places.">detach</a>();
<a id="L477" name="L477"></a> 477                   <em class="brace">}</em>
<a id="L478" name="L478"></a> 478                 <em class="brace">}</em>
<a id="L479" name="L479"></a> 479                 <strong class="reserved">finally</strong>
<a id="L480" name="L480"></a> 480                 <em class="brace">{</em>
<a id="L481" name="L481"></a> 481                   xctxt.<a href="../S/4946.html#L836" title="Defined at 836 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popPredicatePos</a>();
<a id="L482" name="L482"></a> 482                 <em class="brace">}</em>
<a id="L483" name="L483"></a> 483               <em class="brace">}</em>
<a id="L484" name="L484"></a> 484             <em class="brace">}</em>
<a id="L485" name="L485"></a> 485             <strong class="reserved">finally</strong>
<a id="L486" name="L486"></a> 486             <em class="brace">{</em>
<a id="L487" name="L487"></a> 487               xctxt.<a href="../S/4946.html#L950" title="Defined at 950 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popSubContextList</a>();
<a id="L488" name="L488"></a> 488             <em class="brace">}</em>
<a id="L489" name="L489"></a> 489 
<a id="L490" name="L490"></a> 490             <strong class="reserved">if</strong> (pass)
<a id="L491" name="L491"></a> 491               pos--;
<a id="L492" name="L492"></a> 492 
<a id="L493" name="L493"></a> 493             <strong class="reserved">if</strong> (pos &lt; 1)
<a id="L494" name="L494"></a> 494               <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L495" name="L495"></a> 495           <em class="brace">}</em>
<a id="L496" name="L496"></a> 496         <em class="brace">}</em>
<a id="L497" name="L497"></a> 497         <strong class="reserved">finally</strong>
<a id="L498" name="L498"></a> 498         <em class="brace">{</em>
<a id="L499" name="L499"></a> 499           xctxt.<a href="../S/4946.html#L758" title="Defined at 758 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popCurrentNode</a>();
<a id="L500" name="L500"></a> 500         <em class="brace">}</em>
<a id="L501" name="L501"></a> 501       <em class="brace">}</em>
<a id="L502" name="L502"></a> 502     <em class="brace">}</em>
<a id="L503" name="L503"></a> 503     <strong class="reserved">catch</strong> (<a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a> se)
<a id="L504" name="L504"></a> 504     <em class="brace">{</em>
<a id="L505" name="L505"></a> 505 
<a id="L506" name="L506"></a> 506       <em class="comment">// TODO: should keep throw sax exception...</em>
<a id="L507" name="L507"></a> 507       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>(se.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L508" name="L508"></a> 508     <em class="brace">}</em>
<a id="L509" name="L509"></a> 509 
<a id="L510" name="L510"></a> 510     <strong class="reserved">return</strong> (pos == 1);
<a id="L511" name="L511"></a> 511   <em class="brace">}</em>
<a id="L512" name="L512"></a> 512 
<div class="comment">
    Get the proximity position index of the current node based on this
    node test.
    @param xctxt XPath runtime context.
    @param predPos Which predicate we're evaluating of foo[1][2][3].
    @param findLast If true, don't terminate when the context node is found.
    @return the proximity position index of the current node based on the
            node test.</div>
<a id="L525" name="L525"></a> 525   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/18546.html" title="Multiple referred from 9 places.">getProximityPosition</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt, <strong class="reserved">int</strong> predPos,
<a id="L526" name="L526"></a> 526                     <strong class="reserved">boolean</strong> <a href="../S/1097.html#L1146" title="Defined at 1146 in src/java/util/concurrent/ConcurrentSkipListMap.java.">findLast</a>)
<a id="L527" name="L527"></a> 527   <em class="brace">{</em>
<a id="L528" name="L528"></a> 528 
<a id="L529" name="L529"></a> 529     <strong class="reserved">int</strong> pos = 0;
<a id="L530" name="L530"></a> 530     <strong class="reserved">int</strong> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a> = xctxt.<a href="../D/18114.html" title="Multiple defined in 11 places.">getCurrentNode</a>();
<a id="L531" name="L531"></a> 531     <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm = xctxt.<a href="../D/18175.html" title="Multiple defined in 19 places.">getDTM</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>);
<a id="L532" name="L532"></a> 532     <strong class="reserved">int</strong> <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> = dtm.<a href="../D/21392.html" title="Multiple defined in 42 places.">getParent</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>);
<a id="L533" name="L533"></a> 533 
<a id="L534" name="L534"></a> 534     <strong class="reserved">try</strong>
<a id="L535" name="L535"></a> 535     <em class="brace">{</em>
<a id="L536" name="L536"></a> 536       <a href="../S/5919.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/DTMAxisTraverser.java.">DTMAxisTraverser</a> traverser = dtm.<a href="../D/17166.html" title="Multiple defined in 5 places.">getAxisTraverser</a>(<a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.CHILD);
<a id="L537" name="L537"></a> 537 
<a id="L538" name="L538"></a> 538       <strong class="reserved">for</strong> (<strong class="reserved">int</strong> child = traverser.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(<a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>); <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != child;
<a id="L539" name="L539"></a> 539               child = traverser.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>(<a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>, child))
<a id="L540" name="L540"></a> 540       <em class="brace">{</em>
<a id="L541" name="L541"></a> 541         <strong class="reserved">try</strong>
<a id="L542" name="L542"></a> 542         <em class="brace">{</em>
<a id="L543" name="L543"></a> 543           xctxt.<a href="../S/4946.html#L750" title="Defined at 750 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushCurrentNode</a>(child);
<a id="L544" name="L544"></a> 544 
<a id="L545" name="L545"></a> 545           <strong class="reserved">if</strong> (<a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE != <strong class="reserved">super</strong>.<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt, child))
<a id="L546" name="L546"></a> 546           <em class="brace">{</em>
<a id="L547" name="L547"></a> 547             <strong class="reserved">boolean</strong> pass = <strong class="reserved">true</strong>;
<a id="L548" name="L548"></a> 548 
<a id="L549" name="L549"></a> 549             <strong class="reserved">try</strong>
<a id="L550" name="L550"></a> 550             <em class="brace">{</em>
<a id="L551" name="L551"></a> 551               xctxt.<a href="../S/4946.html#L941" title="Defined at 941 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushSubContextList</a>(<strong class="reserved">this</strong>);
<a id="L552" name="L552"></a> 552 
<a id="L553" name="L553"></a> 553               <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; predPos; i++)
<a id="L554" name="L554"></a> 554               <em class="brace">{</em>
<a id="L555" name="L555"></a> 555                 xctxt.<a href="../S/4946.html#L831" title="Defined at 831 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushPredicatePos</a>(i);
<a id="L556" name="L556"></a> 556                 <strong class="reserved">try</strong>
<a id="L557" name="L557"></a> 557                 <em class="brace">{</em>
<a id="L558" name="L558"></a> 558                   <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> = m_predicates[i].<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt);
<a id="L559" name="L559"></a> 559 
<a id="L560" name="L560"></a> 560                   <strong class="reserved">try</strong>
<a id="L561" name="L561"></a> 561                   <em class="brace">{</em>
<a id="L562" name="L562"></a> 562                     <strong class="reserved">if</strong> (<a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a>.CLASS_NUMBER == <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>())
<a id="L563" name="L563"></a> 563                     <em class="brace">{</em>
<a id="L564" name="L564"></a> 564                       <strong class="reserved">if</strong> ((pos + 1) != (<strong class="reserved">int</strong>) <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/28368.html" title="Multiple defined in 2 places.">numWithSideEffects</a>())
<a id="L565" name="L565"></a> 565                       <em class="brace">{</em>
<a id="L566" name="L566"></a> 566                         pass = <strong class="reserved">false</strong>;
<a id="L567" name="L567"></a> 567 
<a id="L568" name="L568"></a> 568                         <strong class="reserved">break</strong>;
<a id="L569" name="L569"></a> 569                       <em class="brace">}</em>
<a id="L570" name="L570"></a> 570                     <em class="brace">}</em>
<a id="L571" name="L571"></a> 571                     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!<a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/11889.html" title="Multiple defined in 2 places.">boolWithSideEffects</a>())
<a id="L572" name="L572"></a> 572                     <em class="brace">{</em>
<a id="L573" name="L573"></a> 573                       pass = <strong class="reserved">false</strong>;
<a id="L574" name="L574"></a> 574 
<a id="L575" name="L575"></a> 575                       <strong class="reserved">break</strong>;
<a id="L576" name="L576"></a> 576                     <em class="brace">}</em>
<a id="L577" name="L577"></a> 577                   <em class="brace">}</em>
<a id="L578" name="L578"></a> 578                   <strong class="reserved">finally</strong>
<a id="L579" name="L579"></a> 579                   <em class="brace">{</em>
<a id="L580" name="L580"></a> 580                     <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/14888.html" title="Multiple defined in 26 places.">detach</a>();
<a id="L581" name="L581"></a> 581                   <em class="brace">}</em>
<a id="L582" name="L582"></a> 582                 <em class="brace">}</em>
<a id="L583" name="L583"></a> 583                 <strong class="reserved">finally</strong>
<a id="L584" name="L584"></a> 584                 <em class="brace">{</em>
<a id="L585" name="L585"></a> 585                   xctxt.<a href="../S/4946.html#L836" title="Defined at 836 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popPredicatePos</a>();
<a id="L586" name="L586"></a> 586                 <em class="brace">}</em>
<a id="L587" name="L587"></a> 587               <em class="brace">}</em>
<a id="L588" name="L588"></a> 588             <em class="brace">}</em>
<a id="L589" name="L589"></a> 589             <strong class="reserved">finally</strong>
<a id="L590" name="L590"></a> 590             <em class="brace">{</em>
<a id="L591" name="L591"></a> 591               xctxt.<a href="../S/4946.html#L950" title="Defined at 950 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popSubContextList</a>();
<a id="L592" name="L592"></a> 592             <em class="brace">}</em>
<a id="L593" name="L593"></a> 593 
<a id="L594" name="L594"></a> 594             <strong class="reserved">if</strong> (pass)
<a id="L595" name="L595"></a> 595               pos++;
<a id="L596" name="L596"></a> 596 
<a id="L597" name="L597"></a> 597             <strong class="reserved">if</strong> (!<a href="../S/1097.html#L1146" title="Defined at 1146 in src/java/util/concurrent/ConcurrentSkipListMap.java.">findLast</a> &amp;&amp; child == <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>)
<a id="L598" name="L598"></a> 598             <em class="brace">{</em>
<a id="L599" name="L599"></a> 599               <strong class="reserved">return</strong> pos;
<a id="L600" name="L600"></a> 600             <em class="brace">}</em>
<a id="L601" name="L601"></a> 601           <em class="brace">}</em>
<a id="L602" name="L602"></a> 602         <em class="brace">}</em>
<a id="L603" name="L603"></a> 603         <strong class="reserved">finally</strong>
<a id="L604" name="L604"></a> 604         <em class="brace">{</em>
<a id="L605" name="L605"></a> 605           xctxt.<a href="../S/4946.html#L758" title="Defined at 758 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popCurrentNode</a>();
<a id="L606" name="L606"></a> 606         <em class="brace">}</em>
<a id="L607" name="L607"></a> 607       <em class="brace">}</em>
<a id="L608" name="L608"></a> 608     <em class="brace">}</em>
<a id="L609" name="L609"></a> 609     <strong class="reserved">catch</strong> (<a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a> se)
<a id="L610" name="L610"></a> 610     <em class="brace">{</em>
<a id="L611" name="L611"></a> 611 
<a id="L612" name="L612"></a> 612       <em class="comment">// TODO: should keep throw sax exception...</em>
<a id="L613" name="L613"></a> 613       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>(se.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L614" name="L614"></a> 614     <em class="brace">}</em>
<a id="L615" name="L615"></a> 615 
<a id="L616" name="L616"></a> 616     <strong class="reserved">return</strong> pos;
<a id="L617" name="L617"></a> 617   <em class="brace">}</em>
<a id="L618" name="L618"></a> 618 
<div class="comment">
    Get the proximity position index of the current node based on this
    node test.
    @param xctxt XPath runtime context.
    @return the proximity position index of the current node based on the
            node test.</div>
<a id="L629" name="L629"></a> 629   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/18546.html" title="Multiple referred from 9 places.">getProximityPosition</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L630" name="L630"></a> 630   <em class="brace">{</em>
<a id="L631" name="L631"></a> 631     <strong class="reserved">return</strong> <a href="../D/21769.html" title="Multiple defined in 8 places.">getProximityPosition</a>(xctxt, xctxt.<a href="../S/4946.html#L826" title="Defined at 826 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">getPredicatePos</a>(), <strong class="reserved">false</strong>);
<a id="L632" name="L632"></a> 632   <em class="brace">}</em>
<a id="L633" name="L633"></a> 633 
<div class="comment">
    Get the count of the nodes that match the test, which is the proximity
    position of the last node that can pass this test in the sub context
    selection.  In XSLT 1-based indexing, this count is the index of the last
    node.
    @param xctxt XPath runtime context.
    @return the count of the nodes that match the test.</div>
<a id="L645" name="L645"></a> 645   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/4977.html#L71" title="Referred from 71 in src/com/sun/org/apache/xpath/internal/functions/FuncLast.java.">getLastPos</a>(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt)
<a id="L646" name="L646"></a> 646   <em class="brace">{</em>
<a id="L647" name="L647"></a> 647     <strong class="reserved">return</strong> <a href="../D/21769.html" title="Multiple defined in 8 places.">getProximityPosition</a>(xctxt, xctxt.<a href="../S/4946.html#L826" title="Defined at 826 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">getPredicatePos</a>(), <strong class="reserved">true</strong>);
<a id="L648" name="L648"></a> 648   <em class="brace">}</em>
<a id="L649" name="L649"></a> 649 
<div class="comment">
    Execute the match pattern step relative to another step.
    @param xctxt The XPath runtime context.
    @param dtm The DTM of the current node.
    @param currentNode The current node context.
    @return {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NODETEST},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NONE},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NSWILD},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_QNAME}, or
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_OTHER}.
    @throws javax.xml.transform.TransformerException</div>
<a id="L666" name="L666"></a> 666   <strong class="reserved">protected</strong> <strong class="reserved">final</strong> <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> <a href="../S/4858.html#L412" title="Referred from 412 in src/com/sun/org/apache/xpath/internal/patterns/StepPattern.java.">executeRelativePathPattern</a>(
<a id="L667" name="L667"></a> 667           <a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt, <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm, <strong class="reserved">int</strong> currentNode)
<a id="L668" name="L668"></a> 668             <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L669" name="L669"></a> 669   <em class="brace">{</em>
<a id="L670" name="L670"></a> 670 
<a id="L671" name="L671"></a> 671     <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> score = <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE;
<a id="L672" name="L672"></a> 672     <strong class="reserved">int</strong> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a> = currentNode;
<a id="L673" name="L673"></a> 673     <a href="../S/5919.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/DTMAxisTraverser.java.">DTMAxisTraverser</a> traverser;
<a id="L674" name="L674"></a> 674 
<a id="L675" name="L675"></a> 675     traverser = dtm.<a href="../D/17166.html" title="Multiple defined in 5 places.">getAxisTraverser</a>(m_axis);
<a id="L676" name="L676"></a> 676 
<a id="L677" name="L677"></a> 677     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a> = traverser.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>); <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> != <a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a>;
<a id="L678" name="L678"></a> 678             <a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a> = traverser.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, <a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a>))
<a id="L679" name="L679"></a> 679     <em class="brace">{</em>
<a id="L680" name="L680"></a> 680       <strong class="reserved">try</strong>
<a id="L681" name="L681"></a> 681       <em class="brace">{</em>
<a id="L682" name="L682"></a> 682         xctxt.<a href="../S/4946.html#L750" title="Defined at 750 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushCurrentNode</a>(<a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a>);
<a id="L683" name="L683"></a> 683 
<a id="L684" name="L684"></a> 684         score = <a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt);
<a id="L685" name="L685"></a> 685 
<a id="L686" name="L686"></a> 686         <strong class="reserved">if</strong> (score != <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.SCORE_NONE)
<a id="L687" name="L687"></a> 687           <strong class="reserved">break</strong>;
<a id="L688" name="L688"></a> 688       <em class="brace">}</em>
<a id="L689" name="L689"></a> 689       <strong class="reserved">finally</strong>
<a id="L690" name="L690"></a> 690       <em class="brace">{</em>
<a id="L691" name="L691"></a> 691         xctxt.<a href="../S/4946.html#L758" title="Defined at 758 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popCurrentNode</a>();
<a id="L692" name="L692"></a> 692       <em class="brace">}</em>
<a id="L693" name="L693"></a> 693     <em class="brace">}</em>
<a id="L694" name="L694"></a> 694 
<a id="L695" name="L695"></a> 695     <strong class="reserved">return</strong> score;
<a id="L696" name="L696"></a> 696   <em class="brace">}</em>
<a id="L697" name="L697"></a> 697 
<div class="comment">
    Execute the predicates on this step to determine if the current node
    should be filtered or accepted.
    @param xctxt The XPath runtime context.
    @param dtm The DTM of the current node.
    @param currentNode The current node context.
    @return true if the node should be accepted, false otherwise.
    @throws javax.xml.transform.TransformerException</div>
<a id="L710" name="L710"></a> 710   <strong class="reserved">protected</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../R/14097.html" title="Multiple referred from 5 places.">executePredicates</a>(
<a id="L711" name="L711"></a> 711           <a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt, <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm, <strong class="reserved">int</strong> currentNode)
<a id="L712" name="L712"></a> 712             <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L713" name="L713"></a> 713   <em class="brace">{</em>
<a id="L714" name="L714"></a> 714 
<a id="L715" name="L715"></a> 715     <strong class="reserved">boolean</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">true</strong>;
<a id="L716" name="L716"></a> 716     <strong class="reserved">boolean</strong> positionAlreadySeen = <strong class="reserved">false</strong>;
<a id="L717" name="L717"></a> 717     <strong class="reserved">int</strong> n = <a href="../D/21565.html" title="Multiple defined in 2 places.">getPredicateCount</a>();
<a id="L718" name="L718"></a> 718 
<a id="L719" name="L719"></a> 719     <strong class="reserved">try</strong>
<a id="L720" name="L720"></a> 720     <em class="brace">{</em>
<a id="L721" name="L721"></a> 721       xctxt.<a href="../S/4946.html#L941" title="Defined at 941 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushSubContextList</a>(<strong class="reserved">this</strong>);
<a id="L722" name="L722"></a> 722 
<a id="L723" name="L723"></a> 723       <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L724" name="L724"></a> 724       <em class="brace">{</em>
<a id="L725" name="L725"></a> 725         xctxt.<a href="../S/4946.html#L831" title="Defined at 831 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushPredicatePos</a>(i);
<a id="L726" name="L726"></a> 726 
<a id="L727" name="L727"></a> 727         <strong class="reserved">try</strong>
<a id="L728" name="L728"></a> 728         <em class="brace">{</em>
<a id="L729" name="L729"></a> 729           <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> = m_predicates[i].<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt);
<a id="L730" name="L730"></a> 730 
<a id="L731" name="L731"></a> 731           <strong class="reserved">try</strong>
<a id="L732" name="L732"></a> 732           <em class="brace">{</em>
<a id="L733" name="L733"></a> 733             <strong class="reserved">if</strong> (<a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a>.CLASS_NUMBER == <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>())
<a id="L734" name="L734"></a> 734             <em class="brace">{</em>
<a id="L735" name="L735"></a> 735               <strong class="reserved">int</strong> pos = (<strong class="reserved">int</strong>) <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/28365.html" title="Multiple defined in 17 places.">num</a>();
<a id="L736" name="L736"></a> 736 
<a id="L737" name="L737"></a> 737               <strong class="reserved">if</strong> (positionAlreadySeen)
<a id="L738" name="L738"></a> 738               <em class="brace">{</em>
<a id="L739" name="L739"></a> 739                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (pos == 1);
<a id="L740" name="L740"></a> 740 
<a id="L741" name="L741"></a> 741                 <strong class="reserved">break</strong>;
<a id="L742" name="L742"></a> 742               <em class="brace">}</em>
<a id="L743" name="L743"></a> 743               <strong class="reserved">else</strong>
<a id="L744" name="L744"></a> 744               <em class="brace">{</em>
<a id="L745" name="L745"></a> 745                 positionAlreadySeen = <strong class="reserved">true</strong>;
<a id="L746" name="L746"></a> 746 
<a id="L747" name="L747"></a> 747                 <strong class="reserved">if</strong> (!<a href="../S/4858.html#L430" title="Defined at 430 in src/com/sun/org/apache/xpath/internal/patterns/StepPattern.java.">checkProximityPosition</a>(xctxt, i, dtm, currentNode, pos))
<a id="L748" name="L748"></a> 748                 <em class="brace">{</em>
<a id="L749" name="L749"></a> 749                   <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">false</strong>;
<a id="L750" name="L750"></a> 750 
<a id="L751" name="L751"></a> 751                   <strong class="reserved">break</strong>;
<a id="L752" name="L752"></a> 752                 <em class="brace">}</em>
<a id="L753" name="L753"></a> 753               <em class="brace">}</em>
<a id="L754" name="L754"></a> 754 
<a id="L755" name="L755"></a> 755             <em class="brace">}</em>
<a id="L756" name="L756"></a> 756             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!<a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/11889.html" title="Multiple defined in 2 places.">boolWithSideEffects</a>())
<a id="L757" name="L757"></a> 757             <em class="brace">{</em>
<a id="L758" name="L758"></a> 758               <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">false</strong>;
<a id="L759" name="L759"></a> 759 
<a id="L760" name="L760"></a> 760               <strong class="reserved">break</strong>;
<a id="L761" name="L761"></a> 761             <em class="brace">}</em>
<a id="L762" name="L762"></a> 762           <em class="brace">}</em>
<a id="L763" name="L763"></a> 763           <strong class="reserved">finally</strong>
<a id="L764" name="L764"></a> 764           <em class="brace">{</em>
<a id="L765" name="L765"></a> 765             <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/14888.html" title="Multiple defined in 26 places.">detach</a>();
<a id="L766" name="L766"></a> 766           <em class="brace">}</em>
<a id="L767" name="L767"></a> 767         <em class="brace">}</em>
<a id="L768" name="L768"></a> 768         <strong class="reserved">finally</strong>
<a id="L769" name="L769"></a> 769         <em class="brace">{</em>
<a id="L770" name="L770"></a> 770           xctxt.<a href="../S/4946.html#L836" title="Defined at 836 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popPredicatePos</a>();
<a id="L771" name="L771"></a> 771         <em class="brace">}</em>
<a id="L772" name="L772"></a> 772       <em class="brace">}</em>
<a id="L773" name="L773"></a> 773     <em class="brace">}</em>
<a id="L774" name="L774"></a> 774     <strong class="reserved">finally</strong>
<a id="L775" name="L775"></a> 775     <em class="brace">{</em>
<a id="L776" name="L776"></a> 776       xctxt.<a href="../S/4946.html#L950" title="Defined at 950 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popSubContextList</a>();
<a id="L777" name="L777"></a> 777     <em class="brace">}</em>
<a id="L778" name="L778"></a> 778 
<a id="L779" name="L779"></a> 779     <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L780" name="L780"></a> 780   <em class="brace">}</em>
<a id="L781" name="L781"></a> 781 
<div class="comment">
    Get the string represenentation of this step for diagnostic purposes.
    @return A string representation of this step, built by reverse-engineering
    the contained info.</div>
<a id="L789" name="L789"></a> 789   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>()
<a id="L790" name="L790"></a> 790   <em class="brace">{</em>
<a id="L791" name="L791"></a> 791 
<a id="L792" name="L792"></a> 792     <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a> = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L793" name="L793"></a> 793 
<a id="L794" name="L794"></a> 794     <strong class="reserved">for</strong> (<a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a> pat = <strong class="reserved">this</strong>; pat != <strong class="reserved">null</strong>; pat = pat.m_relativePathPattern)
<a id="L795" name="L795"></a> 795     <em class="brace">{</em>
<a id="L796" name="L796"></a> 796       <strong class="reserved">if</strong> (pat != <strong class="reserved">this</strong>)
<a id="L797" name="L797"></a> 797         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("/");
<a id="L798" name="L798"></a> 798 
<a id="L799" name="L799"></a> 799       <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.<a href="../D/20803.html" title="Multiple defined in 3 places.">getNames</a>(pat.m_axis));
<a id="L800" name="L800"></a> 800       <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("::");
<a id="L801" name="L801"></a> 801 
<a id="L802" name="L802"></a> 802       <strong class="reserved">if</strong> (0x000005000 == pat.m_whatToShow)
<a id="L803" name="L803"></a> 803       <em class="brace">{</em>
<a id="L804" name="L804"></a> 804         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("doc()");
<a id="L805" name="L805"></a> 805       <em class="brace">}</em>
<a id="L806" name="L806"></a> 806       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_BYFUNCTION == pat.m_whatToShow)
<a id="L807" name="L807"></a> 807       <em class="brace">{</em>
<a id="L808" name="L808"></a> 808         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("function()");
<a id="L809" name="L809"></a> 809       <em class="brace">}</em>
<a id="L810" name="L810"></a> 810       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ALL == pat.m_whatToShow)
<a id="L811" name="L811"></a> 811       <em class="brace">{</em>
<a id="L812" name="L812"></a> 812         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("node()");
<a id="L813" name="L813"></a> 813       <em class="brace">}</em>
<a id="L814" name="L814"></a> 814       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_TEXT == pat.m_whatToShow)
<a id="L815" name="L815"></a> 815       <em class="brace">{</em>
<a id="L816" name="L816"></a> 816         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("text()");
<a id="L817" name="L817"></a> 817       <em class="brace">}</em>
<a id="L818" name="L818"></a> 818       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_PROCESSING_INSTRUCTION == pat.m_whatToShow)
<a id="L819" name="L819"></a> 819       <em class="brace">{</em>
<a id="L820" name="L820"></a> 820         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("processing-instruction(");
<a id="L821" name="L821"></a> 821 
<a id="L822" name="L822"></a> 822         <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != pat.m_name)
<a id="L823" name="L823"></a> 823         <em class="brace">{</em>
<a id="L824" name="L824"></a> 824           <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(pat.m_name);
<a id="L825" name="L825"></a> 825         <em class="brace">}</em>
<a id="L826" name="L826"></a> 826 
<a id="L827" name="L827"></a> 827         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(")");
<a id="L828" name="L828"></a> 828       <em class="brace">}</em>
<a id="L829" name="L829"></a> 829       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_COMMENT == pat.m_whatToShow)
<a id="L830" name="L830"></a> 830       <em class="brace">{</em>
<a id="L831" name="L831"></a> 831         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("comment()");
<a id="L832" name="L832"></a> 832       <em class="brace">}</em>
<a id="L833" name="L833"></a> 833       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != pat.m_name)
<a id="L834" name="L834"></a> 834       <em class="brace">{</em>
<a id="L835" name="L835"></a> 835         <strong class="reserved">if</strong> (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ATTRIBUTE == pat.m_whatToShow)
<a id="L836" name="L836"></a> 836         <em class="brace">{</em>
<a id="L837" name="L837"></a> 837           <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("@");
<a id="L838" name="L838"></a> 838         <em class="brace">}</em>
<a id="L839" name="L839"></a> 839 
<a id="L840" name="L840"></a> 840         <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != pat.m_namespace)
<a id="L841" name="L841"></a> 841         <em class="brace">{</em>
<a id="L842" name="L842"></a> 842           <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("{");
<a id="L843" name="L843"></a> 843           <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(pat.m_namespace);
<a id="L844" name="L844"></a> 844           <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("}");
<a id="L845" name="L845"></a> 845         <em class="brace">}</em>
<a id="L846" name="L846"></a> 846 
<a id="L847" name="L847"></a> 847         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(pat.m_name);
<a id="L848" name="L848"></a> 848       <em class="brace">}</em>
<a id="L849" name="L849"></a> 849       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_ATTRIBUTE == pat.m_whatToShow)
<a id="L850" name="L850"></a> 850       <em class="brace">{</em>
<a id="L851" name="L851"></a> 851         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("@");
<a id="L852" name="L852"></a> 852       <em class="brace">}</em>
<a id="L853" name="L853"></a> 853       <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((<a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_DOCUMENT | <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a>.SHOW_DOCUMENT_FRAGMENT)
<a id="L854" name="L854"></a> 854                == pat.m_whatToShow)
<a id="L855" name="L855"></a> 855       <em class="brace">{</em>
<a id="L856" name="L856"></a> 856         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("doc-root()");
<a id="L857" name="L857"></a> 857       <em class="brace">}</em>
<a id="L858" name="L858"></a> 858       <strong class="reserved">else</strong>
<a id="L859" name="L859"></a> 859       <em class="brace">{</em>
<a id="L860" name="L860"></a> 860         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('?').<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35410.html" title="Multiple defined in 5 places.">toHexString</a>(pat.m_whatToShow));
<a id="L861" name="L861"></a> 861       <em class="brace">}</em>
<a id="L862" name="L862"></a> 862 
<a id="L863" name="L863"></a> 863       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != pat.m_predicates)
<a id="L864" name="L864"></a> 864       <em class="brace">{</em>
<a id="L865" name="L865"></a> 865         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; pat.m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++)
<a id="L866" name="L866"></a> 866         <em class="brace">{</em>
<a id="L867" name="L867"></a> 867           <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("[");
<a id="L868" name="L868"></a> 868           <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(pat.m_predicates[i]);
<a id="L869" name="L869"></a> 869           <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("]");
<a id="L870" name="L870"></a> 870         <em class="brace">}</em>
<a id="L871" name="L871"></a> 871       <em class="brace">}</em>
<a id="L872" name="L872"></a> 872     <em class="brace">}</em>
<a id="L873" name="L873"></a> 873 
<a id="L874" name="L874"></a> 874     <strong class="reserved">return</strong> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L875" name="L875"></a> 875   <em class="brace">}</em>
<a id="L876" name="L876"></a> 876 
<div class="comment">
   /** Set to true to send diagnostics about pattern matches to the consol. */</div>
<a id="L878" name="L878"></a> 878   <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> DEBUG_MATCHES = <strong class="reserved">false</strong>;
<a id="L879" name="L879"></a> 879 
<div class="comment">
    Get the match score of the given node.
    @param xctxt The XPath runtime context.
    @param context The node to be tested.
    @return {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NODETEST},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NONE},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_NSWILD},
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_QNAME}, or
            {@link com.sun.org.apache.xpath.internal.patterns.NodeTest#SCORE_OTHER}.
    @throws javax.xml.transform.TransformerException</div>
<a id="L894" name="L894"></a> 894   <strong class="reserved">public</strong> <strong class="reserved">double</strong> getMatchScore(<a href="../S/4946.html#L61" title="Defined at 61 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">XPathContext</a> xctxt, <strong class="reserved">int</strong> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>)
<a id="L895" name="L895"></a> 895           <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L896" name="L896"></a> 896   <em class="brace">{</em>
<a id="L897" name="L897"></a> 897 
<a id="L898" name="L898"></a> 898     xctxt.<a href="../S/4946.html#L750" title="Defined at 750 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushCurrentNode</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>);
<a id="L899" name="L899"></a> 899     xctxt.<a href="../S/4946.html#L856" title="Defined at 856 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">pushCurrentExpressionNode</a>(<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>);
<a id="L900" name="L900"></a> 900 
<a id="L901" name="L901"></a> 901     <strong class="reserved">try</strong>
<a id="L902" name="L902"></a> 902     <em class="brace">{</em>
<a id="L903" name="L903"></a> 903       <a href="../S/4899.html#L50" title="Defined at 50 in src/com/sun/org/apache/xpath/internal/objects/XObject.java.">XObject</a> score = <a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(xctxt);
<a id="L904" name="L904"></a> 904 
<a id="L905" name="L905"></a> 905       <strong class="reserved">return</strong> score.<a href="../D/28365.html" title="Multiple defined in 17 places.">num</a>();
<a id="L906" name="L906"></a> 906     <em class="brace">}</em>
<a id="L907" name="L907"></a> 907     <strong class="reserved">finally</strong>
<a id="L908" name="L908"></a> 908     <em class="brace">{</em>
<a id="L909" name="L909"></a> 909       xctxt.<a href="../S/4946.html#L758" title="Defined at 758 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popCurrentNode</a>();
<a id="L910" name="L910"></a> 910       xctxt.<a href="../S/4946.html#L865" title="Defined at 865 in src/com/sun/org/apache/xpath/internal/XPathContext.java.">popCurrentExpressionNode</a>();
<a id="L911" name="L911"></a> 911     <em class="brace">}</em>
<a id="L912" name="L912"></a> 912 
<a id="L913" name="L913"></a> 913     <em class="comment">// return XPath.MATCH_SCORE_NONE;</em>
<a id="L914" name="L914"></a> 914   <em class="brace">}</em>
<a id="L915" name="L915"></a> 915 
<div class="comment">
    Set the axis that this step should follow.
    @param axis The Axis for this test, one of of Axes.ANCESTORORSELF, etc.</div>
<a id="L922" name="L922"></a> 922   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26931.html" title="Multiple referred from 6 places.">setAxis</a>(<strong class="reserved">int</strong> axis)
<a id="L923" name="L923"></a> 923   <em class="brace">{</em>
<a id="L924" name="L924"></a> 924     m_axis = axis;
<a id="L925" name="L925"></a> 925   <em class="brace">}</em>
<a id="L926" name="L926"></a> 926 
<div class="comment">
    Get the axis that this step follows.
    @return The Axis for this test, one of of Axes.ANCESTORORSELF, etc.</div>
<a id="L933" name="L933"></a> 933   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/15203.html" title="Multiple referred from 33 places.">getAxis</a>()
<a id="L934" name="L934"></a> 934   <em class="brace">{</em>
<a id="L935" name="L935"></a> 935     <strong class="reserved">return</strong> m_axis;
<a id="L936" name="L936"></a> 936   <em class="brace">}</em>
<a id="L937" name="L937"></a> 937 
<a id="L938" name="L938"></a> 938   <strong class="reserved">class</strong> <a href="../R/6184.html" title="Multiple referred from 2 places.">PredOwner</a> <strong class="reserved">implements</strong> <a href="../S/4989.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/ExpressionOwner.java.">ExpressionOwner</a>
<a id="L939" name="L939"></a> 939   <em class="brace">{</em>
<a id="L940" name="L940"></a> 940         <strong class="reserved">int</strong> m_index;
<a id="L941" name="L941"></a> 941 
<a id="L942" name="L942"></a> 942         PredOwner(<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>)
<a id="L943" name="L943"></a> 943         <em class="brace">{</em>
<a id="L944" name="L944"></a> 944                 m_index = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L945" name="L945"></a> 945         <em class="brace">}</em>
<a id="L946" name="L946"></a> 946 
<div class="comment">
      @see ExpressionOwner#getExpression()</div>
<a id="L950" name="L950"></a> 950     <strong class="reserved">public</strong> <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../R/16497.html" title="Multiple referred from 16 places.">getExpression</a>()
<a id="L951" name="L951"></a> 951     <em class="brace">{</em>
<a id="L952" name="L952"></a> 952       <strong class="reserved">return</strong> m_predicates[m_index];
<a id="L953" name="L953"></a> 953     <em class="brace">}</em>
<a id="L954" name="L954"></a> 954 
<a id="L955" name="L955"></a> 955 
<div class="comment">
      @see ExpressionOwner#setExpression(Expression)</div>
<a id="L959" name="L959"></a> 959     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27380.html" title="Multiple referred from 3 places.">setExpression</a>(<a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>)
<a id="L960" name="L960"></a> 960     <em class="brace">{</em>
<a id="L961" name="L961"></a> 961         <a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>.<a href="../D/15890.html" title="Multiple defined in 3 places.">exprSetParent</a>(<a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a>.<strong class="reserved">this</strong>);
<a id="L962" name="L962"></a> 962         m_predicates[m_index] = <a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>;
<a id="L963" name="L963"></a> 963     <em class="brace">}</em>
<a id="L964" name="L964"></a> 964   <em class="brace">}</em>
<a id="L965" name="L965"></a> 965 
<div class="comment">
    @see com.sun.org.apache.xpath.internal.XPathVisitable#callVisitors(ExpressionOwner, XPathVisitor)</div>
<a id="L969" name="L969"></a> 969   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/10860.html" title="Multiple referred from 22 places.">callVisitors</a>(<a href="../S/4989.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/ExpressionOwner.java.">ExpressionOwner</a> <a href="../D/28636.html" title="Multiple defined in 2 places.">owner</a>, <a href="../S/4945.html#L53" title="Defined at 53 in src/com/sun/org/apache/xpath/internal/XPathVisitor.java.">XPathVisitor</a> visitor)
<a id="L970" name="L970"></a> 970   <em class="brace">{</em>
<a id="L971" name="L971"></a> 971                 <strong class="reserved">if</strong>(visitor.<a href="../S/4945.html#L161" title="Defined at 161 in src/com/sun/org/apache/xpath/internal/XPathVisitor.java.">visitMatchPattern</a>(<a href="../D/28636.html" title="Multiple defined in 2 places.">owner</a>, <strong class="reserved">this</strong>))
<a id="L972" name="L972"></a> 972                 <em class="brace">{</em>
<a id="L973" name="L973"></a> 973                         <a href="../D/12114.html" title="Multiple defined in 2 places.">callSubtreeVisitors</a>(visitor);
<a id="L974" name="L974"></a> 974                 <em class="brace">}</em>
<a id="L975" name="L975"></a> 975   <em class="brace">}</em>
<a id="L976" name="L976"></a> 976 
<div class="comment">
    Call the visitors on the subtree.  Factored out from callVisitors
    so it may be called by derived classes.</div>
<a id="L981" name="L981"></a> 981   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/10858.html" title="Multiple referred from 2 places.">callSubtreeVisitors</a>(<a href="../S/4945.html#L53" title="Defined at 53 in src/com/sun/org/apache/xpath/internal/XPathVisitor.java.">XPathVisitor</a> visitor)
<a id="L982" name="L982"></a> 982   <em class="brace">{</em>
<a id="L983" name="L983"></a> 983     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_predicates)
<a id="L984" name="L984"></a> 984     <em class="brace">{</em>
<a id="L985" name="L985"></a> 985       <strong class="reserved">int</strong> n = m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L986" name="L986"></a> 986       <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L987" name="L987"></a> 987       <em class="brace">{</em>
<a id="L988" name="L988"></a> 988         <a href="../S/4989.html#L29" title="Defined at 29 in src/com/sun/org/apache/xpath/internal/ExpressionOwner.java.">ExpressionOwner</a> predOwner = <strong class="reserved">new</strong> <a href="../D/6787.html" title="Multiple defined in 2 places.">PredOwner</a>(i);
<a id="L989" name="L989"></a> 989         <strong class="reserved">if</strong> (visitor.<a href="../D/36692.html" title="Multiple defined in 2 places.">visitPredicate</a>(predOwner, m_predicates[i]))
<a id="L990" name="L990"></a> 990         <em class="brace">{</em>
<a id="L991" name="L991"></a> 991           m_predicates[i].<a href="../D/12116.html" title="Multiple defined in 16 places.">callVisitors</a>(predOwner, visitor);
<a id="L992" name="L992"></a> 992         <em class="brace">}</em>
<a id="L993" name="L993"></a> 993       <em class="brace">}</em>
<a id="L994" name="L994"></a> 994     <em class="brace">}</em>
<a id="L995" name="L995"></a> 995     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_relativePathPattern)
<a id="L996" name="L996"></a> 996     <em class="brace">{</em>
<a id="L997" name="L997"></a> 997       m_relativePathPattern.<a href="../D/12116.html" title="Multiple defined in 16 places.">callVisitors</a>(<strong class="reserved">this</strong>, visitor);
<a id="L998" name="L998"></a> 998     <em class="brace">}</em>
<a id="L999" name="L999"></a> 999   <em class="brace">}</em>
<a id="L1000" name="L1000"></a>1000 
<a id="L1001" name="L1001"></a>1001 
<div class="comment">
    @see ExpressionOwner#getExpression()</div>
<a id="L1005" name="L1005"></a>1005   <strong class="reserved">public</strong> <a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../R/16497.html" title="Multiple referred from 16 places.">getExpression</a>()
<a id="L1006" name="L1006"></a>1006   <em class="brace">{</em>
<a id="L1007" name="L1007"></a>1007     <strong class="reserved">return</strong> m_relativePathPattern;
<a id="L1008" name="L1008"></a>1008   <em class="brace">}</em>
<a id="L1009" name="L1009"></a>1009 
<div class="comment">
    @see ExpressionOwner#setExpression(Expression)</div>
<a id="L1013" name="L1013"></a>1013   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27380.html" title="Multiple referred from 3 places.">setExpression</a>(<a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>)
<a id="L1014" name="L1014"></a>1014   <em class="brace">{</em>
<a id="L1015" name="L1015"></a>1015     <a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>.<a href="../D/15890.html" title="Multiple defined in 3 places.">exprSetParent</a>(<strong class="reserved">this</strong>);
<a id="L1016" name="L1016"></a>1016         m_relativePathPattern = (<a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a>)<a href="../D/15822.html" title="Multiple defined in 3 places.">exp</a>;
<a id="L1017" name="L1017"></a>1017   <em class="brace">}</em>
<a id="L1018" name="L1018"></a>1018 
<div class="comment">
    @see Expression#deepEquals(Expression)</div>
<a id="L1022" name="L1022"></a>1022   <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13134.html" title="Multiple referred from 37 places.">deepEquals</a>(<a href="../D/3045.html" title="Multiple defined in 3 places.">Expression</a> <a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>)
<a id="L1023" name="L1023"></a>1023   <em class="brace">{</em>
<a id="L1024" name="L1024"></a>1024         <strong class="reserved">if</strong>(!<strong class="reserved">super</strong>.<a href="../D/14718.html" title="Multiple defined in 25 places.">deepEquals</a>(<a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>))
<a id="L1025" name="L1025"></a>1025                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1026" name="L1026"></a>1026 
<a id="L1027" name="L1027"></a>1027         <a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a> sp = (<a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a>)<a href="../D/15885.html" title="Multiple defined in 2 places.">expr</a>;
<a id="L1028" name="L1028"></a>1028 
<a id="L1029" name="L1029"></a>1029     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_predicates)
<a id="L1030" name="L1030"></a>1030     <em class="brace">{</em>
<a id="L1031" name="L1031"></a>1031         <strong class="reserved">int</strong> n = m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L1032" name="L1032"></a>1032         <strong class="reserved">if</strong> ((<strong class="reserved">null</strong> == sp.m_predicates) || (sp.m_predicates.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != n))
<a id="L1033" name="L1033"></a>1033               <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1034" name="L1034"></a>1034         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L1035" name="L1035"></a>1035         <em class="brace">{</em>
<a id="L1036" name="L1036"></a>1036           <strong class="reserved">if</strong> (!m_predicates[i].<a href="../D/14718.html" title="Multiple defined in 25 places.">deepEquals</a>(sp.m_predicates[i]))
<a id="L1037" name="L1037"></a>1037                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1038" name="L1038"></a>1038         <em class="brace">}</em>
<a id="L1039" name="L1039"></a>1039     <em class="brace">}</em>
<a id="L1040" name="L1040"></a>1040     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != sp.m_predicates)
<a id="L1041" name="L1041"></a>1041         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1042" name="L1042"></a>1042 
<a id="L1043" name="L1043"></a>1043         <strong class="reserved">if</strong>(<strong class="reserved">null</strong> != m_relativePathPattern)
<a id="L1044" name="L1044"></a>1044         <em class="brace">{</em>
<a id="L1045" name="L1045"></a>1045                 <strong class="reserved">if</strong>(!m_relativePathPattern.<a href="../D/14718.html" title="Multiple defined in 25 places.">deepEquals</a>(sp.m_relativePathPattern))
<a id="L1046" name="L1046"></a>1046                         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1047" name="L1047"></a>1047         <em class="brace">}</em>
<a id="L1048" name="L1048"></a>1048         <strong class="reserved">else</strong> <strong class="reserved">if</strong>(sp.m_relativePathPattern != <strong class="reserved">null</strong>)
<a id="L1049" name="L1049"></a>1049                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1050" name="L1050"></a>1050 
<a id="L1051" name="L1051"></a>1051         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1052" name="L1052"></a>1052   <em class="brace">}</em>
<a id="L1053" name="L1053"></a>1053 
<a id="L1054" name="L1054"></a>1054 
<a id="L1055" name="L1055"></a>1055 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L95">[^]</a><a href="#L1022">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>