<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/net/URI.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L848">[^]</a><a href="#L3506">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L848" title="Defined at 848.">create</a></li>
<li><a href="#L906" title="Defined at 906.">parseServerAuthority</a></li>
<li><a href="#L956" title="Defined at 956.">normalize</a></li>
<li><a href="#L1014" title="Defined at 1014.">resolve</a></li>
<li><a href="#L1035" title="Defined at 1035.">resolve</a></li>
<li><a href="#L1065" title="Defined at 1065.">relativize</a></li>
<li><a href="#L1085" title="Defined at 1085.">toURL</a></li>
<li><a href="#L1107" title="Defined at 1107.">getScheme</a></li>
<li><a href="#L1118" title="Defined at 1118.">isAbsolute</a></li>
<li><a href="#L1132" title="Defined at 1132.">isOpaque</a></li>
<li><a href="#L1146" title="Defined at 1146.">getRawSchemeSpecificPart</a></li>
<li><a href="#L1162" title="Defined at 1162.">getSchemeSpecificPart</a></li>
<li><a href="#L1181" title="Defined at 1181.">getRawAuthority</a></li>
<li><a href="#L1195" title="Defined at 1195.">getAuthority</a></li>
<li><a href="#L1211" title="Defined at 1211.">getRawUserInfo</a></li>
<li><a href="#L1225" title="Defined at 1225.">getUserInfo</a></li>
<li><a href="#L1267" title="Defined at 1267.">getHost</a></li>
<li><a href="#L1280" title="Defined at 1280.">getPort</a></li>
<li><a href="#L1295" title="Defined at 1295.">getRawPath</a></li>
<li><a href="#L1309" title="Defined at 1309.">getPath</a></li>
<li><a href="#L1324" title="Defined at 1324.">getRawQuery</a></li>
<li><a href="#L1338" title="Defined at 1338.">getQuery</a></li>
<li><a href="#L1353" title="Defined at 1353.">getRawFragment</a></li>
<li><a href="#L1367" title="Defined at 1367.">getFragment</a></li>
<li><a href="#L1413" title="Defined at 1413.">equals</a></li>
<li><a href="#L1455" title="Defined at 1455.">hashCode</a></li>
<li><a href="#L1545" title="Defined at 1545.">compareTo</a></li>
<li><a href="#L1602" title="Defined at 1602.">toString</a></li>
<li><a href="#L1620" title="Defined at 1620.">toASCIIString</a></li>
<li><a href="#L1639" title="Defined at 1639.">writeObject</a></li>
<li><a href="#L1656" title="Defined at 1656.">readObject</a></li>
<li><a href="#L1684" title="Defined at 1684.">toLower</a></li>
<li><a href="#L1691" title="Defined at 1691.">toUpper</a></li>
<li><a href="#L1697" title="Defined at 1697.">equal</a></li>
<li><a href="#L1730" title="Defined at 1730.">equalIgnoringCase</a></li>
<li><a href="#L1745" title="Defined at 1745.">hash</a></li>
<li><a href="#L1752" title="Defined at 1752.">normalizedHash</a></li>
<li><a href="#L1770" title="Defined at 1770.">hashIgnoringCase</a></li>
<li><a href="#L1779" title="Defined at 1779.">compare</a></li>
<li><a href="#L1792" title="Defined at 1792.">compareIgnoringCase</a></li>
<li><a href="#L1817" title="Defined at 1817.">checkPath</a></li>
<li><a href="#L1828" title="Defined at 1828.">appendAuthority</a></li>
<li><a href="#L1878" title="Defined at 1878.">appendSchemeSpecificPart</a></li>
<li><a href="#L1919" title="Defined at 1919.">appendFragment</a></li>
<li><a href="#L1926" title="Defined at 1926.">toString</a></li>
<li><a href="#L1948" title="Defined at 1948.">defineSchemeSpecificPart</a></li>
<li><a href="#L1957" title="Defined at 1957.">defineString</a></li>
<li><a href="#L2006" title="Defined at 2006.">resolvePath</a></li>
<li><a href="#L2037" title="Defined at 2037.">resolve</a></li>
<li><a href="#L2103" title="Defined at 2103.">normalize</a></li>
<li><a href="#L2128" title="Defined at 2128.">relativize</a></li>
<li><a href="#L2178" title="Defined at 2178.">needsNormalization</a></li>
<li><a href="#L2235" title="Defined at 2235.">split</a></li>
<li><a href="#L2284" title="Defined at 2284.">join</a></li>
<li><a href="#L2327" title="Defined at 2327.">removeDots</a></li>
<li><a href="#L2384" title="Defined at 2384.">maybeAddLeadingDot</a></li>
<li><a href="#L2422" title="Defined at 2422.">normalize</a></li>
<li><a href="#L2468" title="Defined at 2468.">lowMask</a></li>
<li><a href="#L2480" title="Defined at 2480.">highMask</a></li>
<li><a href="#L2493" title="Defined at 2493.">lowMask</a></li>
<li><a href="#L2504" title="Defined at 2504.">highMask</a></li>
<li><a href="#L2514" title="Defined at 2514.">match</a></li>
<li><a href="#L2648" title="Defined at 2648.">appendEscape</a></li>
<li><a href="#L2654" title="Defined at 2654.">appendEncoded</a></li>
<li><a href="#L2674" title="Defined at 2674.">quote</a></li>
<li><a href="#L2710" title="Defined at 2710.">encode</a></li>
<li><a href="#L2743" title="Defined at 2743.">decode</a></li>
<li><a href="#L2754" title="Defined at 2754.">decode</a></li>
<li><a href="#L2766" title="Defined at 2766.">decode</a></li>
<li><a href="#L2843" title="Defined at 2843.">fail</a></li>
<li><a href="#L2847" title="Defined at 2847.">fail</a></li>
<li><a href="#L2851" title="Defined at 2851.">failExpecting</a></li>
<li><a href="#L2857" title="Defined at 2857.">failExpecting</a></li>
<li><a href="#L2868" title="Defined at 2868.">substring</a></li>
<li><a href="#L2875" title="Defined at 2875.">charAt</a></li>
<li><a href="#L2934" title="Defined at 2934.">scan</a></li>
<li><a href="#L2947" title="Defined at 2947.">scan</a></li>
<li><a href="#L2966" title="Defined at 2966.">scanEscape</a></li>
<li><a href="#L2990" title="Defined at 2990.">scan</a></li>
<li><a href="#L3014" title="Defined at 3014.">checkChars</a></li>
<li><a href="#L3026" title="Defined at 3026.">checkChar</a></li>
<li><a href="#L3039" title="Defined at 3039.">parse</a></li>
<li><a href="#L3089" title="Defined at 3089.">parseHierarchical</a></li>
<li><a href="#L3126" title="Defined at 3126.">parseAuthority</a></li>
<li><a href="#L3196" title="Defined at 3196.">parseServer</a></li>
<li><a href="#L3262" title="Defined at 3262.">scanByte</a></li>
<li><a href="#L3287" title="Defined at 3287.">scanIPv4Address</a></li>
<li><a href="#L3315" title="Defined at 3315.">takeIPv4Address</a></li>
<li><a href="#L3328" title="Defined at 3328.">parseIPv4Address</a></li>
<li><a href="#L3358" title="Defined at 3358.">parseHostname</a></li>
<li><a href="#L3446" title="Defined at 3446.">parseIPv6Reference</a></li>
<li><a href="#L3480" title="Defined at 3480.">scanHexPost</a></li>
<li><a href="#L3506" title="Defined at 3506.">scanHexSeq</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.net;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.IOException;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.io.InvalidObjectException;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.io.ObjectInputStream;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.io.ObjectOutputStream;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> java.io.Serializable;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> java.nio.ByteBuffer;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> java.nio.CharBuffer;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> java.nio.charset.CharsetDecoder;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> java.nio.charset.CharsetEncoder;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> java.nio.charset.CoderResult;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> java.nio.charset.CodingErrorAction;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> java.nio.charset.CharacterCodingException;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.text.Normalizer;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> sun.nio.cs.ThreadLocalCoders;
<a id="L42" name="L42"></a>  42 
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> java.lang.Character;             <em class="comment">// for javadoc</em>
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> java.lang.NullPointerException;  <em class="comment">// for javadoc</em>
<a id="L45" name="L45"></a>  45 
<a id="L46" name="L46"></a>  46 
<div class="comment">
  Represents a Uniform Resource Identifier (URI) reference.
  <p> Aside from some minor deviations noted below, an instance of this
  class represents a URI reference as defined by
  <a href="http://www.ietf.org/rfc/rfc2396.txt"><i>RFC&nbsp;2396: Uniform
  Resource Identifiers (URI): Generic Syntax</i></a>, amended by <a href="http://www.ietf.org/rfc/rfc2732.txt"><i>RFC&nbsp;2732: Format for
  Literal IPv6 Addresses in URLs</i></a>. The Literal IPv6 address format
  also supports scope_ids. The syntax and usage of scope_ids is described
  <a href="Inet6Address.html#scoped">here</a>.
  This class provides constructors for creating URI instances from
  their components or by parsing their string forms, methods for accessing the
  various components of an instance, and methods for normalizing, resolving,
  and relativizing URI instances.  Instances of this class are immutable.
  </p><h3> URI syntax and components </h3>
  At the highest level a URI reference (hereinafter simply "URI") in string
  form has the syntax
  <blockquote>
  [<i>scheme</i><b><code>:</code></b>]<i>scheme-specific-part</i>[<b><code>#</code></b><i>fragment</i>]
  </blockquote>
  where square brackets [...] delineate optional components and the characters
  <b><code>:</code></b> and <b><code>#</code></b> stand for themselves.
  <p> An <i>absolute</i> URI specifies a scheme; a URI that is not absolute is
  said to be <i>relative</i>.  URIs are also classified according to whether
  they are <i>opaque</i> or <i>hierarchical</i>.
  </p><p> An <i>opaque</i> URI is an absolute URI whose scheme-specific part does
  not begin with a slash character (<code>'/'</code>).  Opaque URIs are not
  subject to further parsing.  Some examples of opaque URIs are:
  </p><blockquote><table cellpadding="0" cellspacing="0" summary="layout">
  <tbody><tr><td><code>mailto:java-net@java.sun.com</code></td><td></td></tr>
  <tr><td><code>news:comp.lang.java</code></td><td></td></tr>
  <tr><td><code>urn:isbn:096139210x</code></td></tr>
  </tbody></table></blockquote>
  <p> A <i>hierarchical</i> URI is either an absolute URI whose
  scheme-specific part begins with a slash character, or a relative URI, that
  is, a URI that does not specify a scheme.  Some examples of hierarchical
  URIs are:
  </p><blockquote>
  <code>http://java.sun.com/j2se/1.3/</code><br>
  <code>docs/guide/collections/designfaq.html#28</code><br>
  <code>../../../demo/jfc/SwingSet2/src/SwingSet2.java</code><br>
  <code>file:///~/calendar</code>
  </blockquote>
  <p> A hierarchical URI is subject to further parsing according to the syntax
  </p><blockquote>
  [<i>scheme</i><b><code>:</code></b>][<b><code>//</code></b><i>authority</i>][<i>path</i>][<b><code>?</code></b><i>query</i>][<b><code>#</code></b><i>fragment</i>]
  </blockquote>
  where the characters <b><code>:</code></b>, <b><code>/</code></b>,
  <b><code>?</code></b>, and <b><code>#</code></b> stand for themselves.  The
  scheme-specific part of a hierarchical URI consists of the characters
  between the scheme and fragment components.
  <p> The authority component of a hierarchical URI is, if specified, either
  <i>server-based</i> or <i>registry-based</i>.  A server-based authority
  parses according to the familiar syntax
  </p><blockquote>
  [<i>user-info</i><b><code>@</code></b>]<i>host</i>[<b><code>:</code></b><i>port</i>]
  </blockquote>
  where the characters <b><code>@</code></b> and <b><code>:</code></b> stand for
  themselves.  Nearly all URI schemes currently in use are server-based.  An
  authority component that does not parse in this way is considered to be
  registry-based.
  <p> The path component of a hierarchical URI is itself said to be absolute
  if it begins with a slash character (<code>'/'</code>); otherwise it is
  relative.  The path of a hierarchical URI that is either absolute or
  specifies an authority is always absolute.
  </p><p> All told, then, a URI instance has the following nine components:
  </p><blockquote><table summary="Describes the components of a URI:scheme,scheme-specific-part,authority,user-info,host,port,path,query,fragment">
  <tbody><tr><th><i>Component</i></th><th><i>Type</i></th></tr>
  <tr><td>scheme</td><td><code>String</code></td></tr>
  <tr><td>scheme-specific-part&nbsp;&nbsp;&nbsp;&nbsp;</td><td><code>String</code></td></tr>
  <tr><td>authority</td><td><code>String</code></td></tr>
  <tr><td>user-info</td><td><code>String</code></td></tr>
  <tr><td>host</td><td><code>String</code></td></tr>
  <tr><td>port</td><td><code>int</code></td></tr>
  <tr><td>path</td><td><code>String</code></td></tr>
  <tr><td>query</td><td><code>String</code></td></tr>
  <tr><td>fragment</td><td><code>String</code></td></tr>
  </tbody></table></blockquote>
  In a given instance any particular component is either <i>undefined</i> or
  <i>defined</i> with a distinct value.  Undefined string components are
  represented by <code>null</code>, while undefined integer components are
  represented by <code>-1</code>.  A string component may be defined to have the
  empty string as its value; this is not equivalent to that component being
  undefined.
  <p> Whether a particular component is or is not defined in an instance
  depends upon the type of the URI being represented.  An absolute URI has a
  scheme component.  An opaque URI has a scheme, a scheme-specific part, and
  possibly a fragment, but has no other components.  A hierarchical URI always
  has a path (though it may be empty) and a scheme-specific-part (which at
  least contains the path), and may have any of the other components.  If the
  authority component is present and is server-based then the host component
  will be defined and the user-information and port components may be defined.
  </p><h4> Operations on URI instances </h4>
  The key operations supported by this class are those of
  <i>normalization</i>, <i>resolution</i>, and <i>relativization</i>.
  <p> <i>Normalization</i> is the process of removing unnecessary <code>"."</code>
  and <code>".."</code> segments from the path component of a hierarchical URI.
  Each <code>"."</code> segment is simply removed.  A <code>".."</code> segment is
  removed only if it is preceded by a non-<code>".."</code> segment.
  Normalization has no effect upon opaque URIs.
  </p><p> <i>Resolution</i> is the process of resolving one URI against another,
  <i>base</i> URI.  The resulting URI is constructed from components of both
  URIs in the manner specified by RFC&nbsp;2396, taking components from the
  base URI for those not specified in the original.  For hierarchical URIs,
  the path of the original is resolved against the path of the base and then
  normalized.  The result, for example, of resolving
  </p><blockquote>
  <code>docs/guide/collections/designfaq.html#28</code>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;(1)
  </blockquote>
  against the base URI <code>http://java.sun.com/j2se/1.3/</code> is the result
  URI
  <blockquote>
  <code>https://docs.oracle.com/javase/1.3/docs/guide/collections/designfaq.html#28</code>
  </blockquote>
  Resolving the relative URI
  <blockquote>
  <code>../../../demo/jfc/SwingSet2/src/SwingSet2.java</code>&nbsp;&nbsp;&nbsp;&nbsp;(2)
  </blockquote>
  against this result yields, in turn,
  <blockquote>
  <code>http://java.sun.com/j2se/1.3/demo/jfc/SwingSet2/src/SwingSet2.java</code>
  </blockquote>
  Resolution of both absolute and relative URIs, and of both absolute and
  relative paths in the case of hierarchical URIs, is supported.  Resolving
  the URI <code>file:///~calendar</code> against any other URI simply yields the
  original URI, since it is absolute.  Resolving the relative URI (2) above
  against the relative base URI (1) yields the normalized, but still relative,
  URI
  <blockquote>
  <code>demo/jfc/SwingSet2/src/SwingSet2.java</code>
  </blockquote>
  <p> <i>Relativization</i>, finally, is the inverse of resolution: For any
  two normalized URIs <i>u</i> and&nbsp;<i>v</i>,
  </p><blockquote>
    <i>u</i><code>.relativize(</code><i>u</i><code>.resolve(</code><i>v</i><code>)).equals(</code><i>v</i><code>)</code>&nbsp;&nbsp;and<br>
    <i>u</i><code>.resolve(</code><i>u</i><code>.relativize(</code><i>v</i><code>)).equals(</code><i>v</i><code>)</code>&nbsp;&nbsp;.<br>
  </blockquote>
  This operation is often useful when constructing a document containing URIs
  that must be made relative to the base URI of the document wherever
  possible.  For example, relativizing the URI
  <blockquote>
  <code>https://docs.oracle.com/javase/1.3/docs/guide/index.html</code>
  </blockquote>
  against the base URI
  <blockquote>
  <code>http://java.sun.com/j2se/1.3</code>
  </blockquote>
  yields the relative URI <code>docs/guide/index.html</code>.
  <h4> Character categories </h4>
  RFC&nbsp;2396 specifies precisely which characters are permitted in the
  various components of a URI reference.  The following categories, most of
  which are taken from that specification, are used below to describe these
  constraints:
  <blockquote><table cellspacing="2" summary="Describes categories alpha,digit,alphanum,unreserved,punct,reserved,escaped,and other">
    <tbody><tr><th valign="top"><i>alpha</i></th>
        <td>The US-ASCII alphabetic characters,
         <code>'A'</code>&nbsp;through&nbsp;<code>'Z'</code>
         and <code>'a'</code>&nbsp;through&nbsp;<code>'z'</code></td></tr>
    <tr><th valign="top"><i>digit</i></th>
        <td>The US-ASCII decimal digit characters,
        <code>'0'</code>&nbsp;through&nbsp;<code>'9'</code></td></tr>
    <tr><th valign="top"><i>alphanum</i></th>
        <td>All <i>alpha</i> and <i>digit</i> characters</td></tr>
    <tr><th valign="top"><i>unreserved</i>&nbsp;&nbsp;&nbsp;&nbsp;</th>
        <td>All <i>alphanum</i> characters together with those in the string
         <code>"_-!.~'()*"</code></td></tr>
    <tr><th valign="top"><i>punct</i></th>
        <td>The characters in the string <code>",;:$&amp;+="</code></td></tr>
    <tr><th valign="top"><i>reserved</i></th>
        <td>All <i>punct</i> characters together with those in the string
         <code>"?/[]@"</code></td></tr>
    <tr><th valign="top"><i>escaped</i></th>
        <td>Escaped octets, that is, triplets consisting of the percent
            character (<code>'%'</code>) followed by two hexadecimal digits
            (<code>'0'</code>-<code>'9'</code>, <code>'A'</code>-<code>'F'</code>, and
            <code>'a'</code>-<code>'f'</code>)</td></tr>
    <tr><th valign="top"><i>other</i></th>
        <td>The Unicode characters that are not in the US-ASCII character set,
            are not control characters (according to the {@link
            java.lang.Character#isISOControl(char) Character.isISOControl}
            method), and are not space characters (according to the {@link
            java.lang.Character#isSpaceChar(char) Character.isSpaceChar}
            method)&nbsp;&nbsp;<i>(<b>Deviation from RFC 2396</b>, which is
            limited to US-ASCII)</i></td></tr>
  </tbody></table></blockquote>
  <p><a name="legal-chars"></a> The set of all legal URI characters consists of
  the <i>unreserved</i>, <i>reserved</i>, <i>escaped</i>, and <i>other</i>
  characters.
  </p><h4> Escaped octets, quotation, encoding, and decoding </h4>
  RFC 2396 allows escaped octets to appear in the user-info, path, query, and
  fragment components.  Escaping serves two purposes in URIs:
  <ul><li><p> To <i>encode</i> non-US-ASCII characters when a URI is required to
    conform strictly to RFC&nbsp;2396 by not containing any <i>other</i>
    characters.  </p></li><li><p> To <i>quote</i> characters that are otherwise illegal in a
    component.  The user-info, path, query, and fragment components differ
    slightly in terms of which characters are considered legal and illegal.
    </p></li>
  </ul>
  These purposes are served in this class by three related operations:
  <ul><li><p><a name="encode"></a> A character is <i>encoded</i> by replacing it
    with the sequence of escaped octets that represent that character in the
    UTF-8 character set.  The Euro currency symbol (<code>'\u005Cu20AC'</code>),
    for example, is encoded as <code>"%E2%82%AC"</code>.  <i>(<b>Deviation from
    RFC&nbsp;2396</b>, which does not specify any particular character
    set.)</i> </p></li><li><p><a name="quote"></a> An illegal character is <i>quoted</i> simply by
    encoding it.  The space character, for example, is quoted by replacing it
    with <code>"%20"</code>.  UTF-8 contains US-ASCII, hence for US-ASCII
    characters this transformation has exactly the effect required by
    RFC&nbsp;2396. </p></li><li><p><a name="decode"></a>
    A sequence of escaped octets is <i>decoded</i> by
    replacing it with the sequence of characters that it represents in the
    UTF-8 character set.  UTF-8 contains US-ASCII, hence decoding has the
    effect of de-quoting any quoted US-ASCII characters as well as that of
    decoding any encoded non-US-ASCII characters.  If a <a href="../nio/charset/CharsetDecoder.html#ce">decoding error</a> occurs
    when decoding the escaped octets then the erroneous octets are replaced by
    <code>'\u005CuFFFD'</code>, the Unicode replacement character.  </p></li>
  </ul>
  These operations are exposed in the constructors and methods of this class
  as follows:
  <ul><li><p> The {@linkplain #URI(java.lang.String) single-argument
    constructor} requires any illegal characters in its argument to be
    quoted and preserves any escaped octets and <i>other</i> characters that
    are present.  </p></li><li><p> The {@linkplain
    #URI(java.lang.String,java.lang.String,java.lang.String,int,java.lang.String,java.lang.String,java.lang.String)
    multi-argument constructors} quote illegal characters as
    required by the components in which they appear.  The percent character
    (<code>'%'</code>) is always quoted by these constructors.  Any <i>other</i>
    characters are preserved.  </p></li><li><p> The {@link #getRawUserInfo() getRawUserInfo}, {@link #getRawPath()
    getRawPath}, {@link #getRawQuery() getRawQuery}, {@link #getRawFragment()
    getRawFragment}, {@link #getRawAuthority() getRawAuthority}, and {@link
    #getRawSchemeSpecificPart() getRawSchemeSpecificPart} methods return the
    values of their corresponding components in raw form, without interpreting
    any escaped octets.  The strings returned by these methods may contain
    both escaped octets and <i>other</i> characters, and will not contain any
    illegal characters.  </p></li><li><p> The {@link #getUserInfo() getUserInfo}, {@link #getPath()
    getPath}, {@link #getQuery() getQuery}, {@link #getFragment()
    getFragment}, {@link #getAuthority() getAuthority}, and {@link
    #getSchemeSpecificPart() getSchemeSpecificPart} methods decode any escaped
    octets in their corresponding components.  The strings returned by these
    methods may contain both <i>other</i> characters and illegal characters,
    and will not contain any escaped octets.  </p></li><li><p> The {@link #toString() toString} method returns a URI string with
    all necessary quotation but which may contain <i>other</i> characters.
    </p></li><li><p> The {@link #toASCIIString() toASCIIString} method returns a fully
    quoted and encoded URI string that does not contain any <i>other</i>
    characters.  </p></li>
  </ul>
  <h4> Identities </h4>
  For any URI <i>u</i>, it is always the case that
  <blockquote>
  <code>new URI(</code><i>u</i><code>.toString()).equals(</code><i>u</i><code>)</code>&nbsp;.
  </blockquote>
  For any URI <i>u</i> that does not contain redundant syntax such as two
  slashes before an empty authority (as in <code>file:///tmp/</code>&nbsp;) or a
  colon following a host name but no port (as in
  <code>http://java.sun.com:</code>&nbsp;), and that does not encode characters
  except those that must be quoted, the following identities also hold:
  <pre>      new URI(<i>u</i>.getScheme(),
              <i>u</i>.getSchemeSpecificPart(),
              <i>u</i>.getFragment())
      .equals(<i>u</i>)</pre>
  in all cases,
  <pre>      new URI(<i>u</i>.getScheme(),
              <i>u</i>.getUserInfo(), <i>u</i>.getAuthority(),
              <i>u</i>.getPath(), <i>u</i>.getQuery(),
              <i>u</i>.getFragment())
      .equals(<i>u</i>)</pre>
  if <i>u</i> is hierarchical, and
  <pre>      new URI(<i>u</i>.getScheme(),
              <i>u</i>.getUserInfo(), <i>u</i>.getHost(), <i>u</i>.getPort(),
              <i>u</i>.getPath(), <i>u</i>.getQuery(),
              <i>u</i>.getFragment())
      .equals(<i>u</i>)</pre>
  if <i>u</i> is hierarchical and has either no authority or a server-based
  authority.
  <h4> URIs, URLs, and URNs </h4>
  A URI is a uniform resource <i>identifier</i> while a URL is a uniform
  resource <i>locator</i>.  Hence every URL is a URI, abstractly speaking, but
  not every URI is a URL.  This is because there is another subcategory of
  URIs, uniform resource <i>names</i> (URNs), which name resources but do not
  specify how to locate them.  The <code>mailto</code>, <code>news</code>, and
  <code>isbn</code> URIs shown above are examples of URNs.
  <p> The conceptual distinction between URIs and URLs is reflected in the
  differences between this class and the <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> class.
  </p><p> An instance of this class represents a URI reference in the syntactic
  sense defined by RFC&nbsp;2396.  A URI may be either absolute or relative.
  A URI string is parsed according to the generic syntax without regard to the
  scheme, if any, that it specifies.  No lookup of the host, if any, is
  performed, and no scheme-dependent stream handler is constructed.  Equality,
  hashing, and comparison are defined strictly in terms of the character
  content of the instance.  In other words, a URI instance is little more than
  a structured string that supports the syntactic, scheme-independent
  operations of comparison, normalization, resolution, and relativization.
  </p><p> An instance of the <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> class, by contrast, represents the
  syntactic components of a URL together with some of the information required
  to access the resource that it describes.  A URL must be absolute, that is,
  it must always specify a scheme.  A URL string is parsed according to its
  scheme.  A stream handler is always established for a URL, and in fact it is
  impossible to create a URL instance for a scheme for which no handler is
  available.  Equality and hashing depend upon both the scheme and the
  Internet address of the host, if any; comparison is not defined.  In other
  words, a URL is a structured string that supports the syntactic operation of
  resolution as well as the network I/O operations of looking up the host and
  opening a connection to the specified resource.
  @author Mark Reinhold
  @since 1.4
  @see <a href="http://www.ietf.org/rfc/rfc2279.txt"><i>RFC&nbsp;2279: UTF-8, a
  transformation format of ISO 10646</i></a>, <br><a href="http://www.ietf.org/rfc/rfc2373.txt"><i>RFC&nbsp;2373: IPv6 Addressing
  Architecture</i></a>, <br><a href="http://www.ietf.org/rfc/rfc2396.txt"><i>RFC&nbsp;2396: Uniform
  Resource Identifiers (URI): Generic Syntax</i></a>, <br><a href="http://www.ietf.org/rfc/rfc2732.txt"><i>RFC&nbsp;2732: Format for
  Literal IPv6 Addresses in URLs</i></a>, <br><a href="URISyntaxException.html">URISyntaxException</a></p></div>
<a id="L463" name="L463"></a> 463 
<a id="L464" name="L464"></a> 464 <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/8400.html" title="Multiple referred from 322 places.">URI</a>
<a id="L465" name="L465"></a> 465     <strong class="reserved">implements</strong> <a href="../S/1704.html#L96" title="Defined at 96 in src/java/lang/Comparable.java.">Comparable</a>&lt;<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>&gt;, <a href="../S/1407.html#L169" title="Defined at 169 in src/java/io/Serializable.java.">Serializable</a>
<a id="L466" name="L466"></a> 466 <em class="brace">{</em>
<a id="L467" name="L467"></a> 467 
<a id="L468" name="L468"></a> 468     <em class="comment">// Note: Comments containing the word "ASSERT" indicate places where a</em>
<a id="L469" name="L469"></a> 469     <em class="comment">// throw of an InternalError should be replaced by an appropriate assertion</em>
<a id="L470" name="L470"></a> 470     <em class="comment">// statement once asserts are enabled in the build.</em>
<a id="L471" name="L471"></a> 471 
<a id="L472" name="L472"></a> 472     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = -6052424284110960213L;
<a id="L473" name="L473"></a> 473 
<a id="L474" name="L474"></a> 474 
<a id="L475" name="L475"></a> 475     <em class="comment">// -- Properties and components of this instance --</em>
<a id="L476" name="L476"></a> 476 
<a id="L477" name="L477"></a> 477     <em class="comment">// Components of all URIs: [&lt;scheme&gt;:]&lt;scheme-specific-part&gt;[#&lt;fragment&gt;]</em>
<a id="L478" name="L478"></a> 478     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> scheme;            <em class="comment">// null ==&gt; relative URI</em>
<a id="L479" name="L479"></a> 479     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fragment;
<a id="L480" name="L480"></a> 480 
<a id="L481" name="L481"></a> 481     <em class="comment">// Hierarchical URI components: [//&lt;authority&gt;]&lt;path&gt;[?&lt;query&gt;]</em>
<a id="L482" name="L482"></a> 482     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> authority;         <em class="comment">// Registry or server</em>
<a id="L483" name="L483"></a> 483 
<a id="L484" name="L484"></a> 484     <em class="comment">// Server-based authority: [&lt;userInfo&gt;@]&lt;host&gt;[:&lt;port&gt;]</em>
<a id="L485" name="L485"></a> 485     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> userInfo;
<a id="L486" name="L486"></a> 486     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> host;              <em class="comment">// null ==&gt; registry-based</em>
<a id="L487" name="L487"></a> 487     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <strong class="reserved">int</strong> port = -1;            <em class="comment">// -1 ==&gt; undefined</em>
<a id="L488" name="L488"></a> 488 
<a id="L489" name="L489"></a> 489     <em class="comment">// Remaining components of hierarchical URIs</em>
<a id="L490" name="L490"></a> 490     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path;              <em class="comment">// null ==&gt; opaque</em>
<a id="L491" name="L491"></a> 491     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>;
<a id="L492" name="L492"></a> 492 
<a id="L493" name="L493"></a> 493     <em class="comment">// The remaining fields may be computed on demand</em>
<a id="L494" name="L494"></a> 494 
<a id="L495" name="L495"></a> 495     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> schemeSpecificPart;
<a id="L496" name="L496"></a> 496     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">transient</strong> <strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>;        <em class="comment">// Zero ==&gt; undefined</em>
<a id="L497" name="L497"></a> 497 
<a id="L498" name="L498"></a> 498     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> decodedUserInfo = <strong class="reserved">null</strong>;
<a id="L499" name="L499"></a> 499     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> decodedAuthority = <strong class="reserved">null</strong>;
<a id="L500" name="L500"></a> 500     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> decodedPath = <strong class="reserved">null</strong>;
<a id="L501" name="L501"></a> 501     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> decodedQuery = <strong class="reserved">null</strong>;
<a id="L502" name="L502"></a> 502     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> decodedFragment = <strong class="reserved">null</strong>;
<a id="L503" name="L503"></a> 503     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> decodedSchemeSpecificPart = <strong class="reserved">null</strong>;
<a id="L504" name="L504"></a> 504 
<div class="comment">
      The string form of this URI.
      @serial</div>
<a id="L510" name="L510"></a> 510     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>;             <em class="comment">// The only serializable field</em>
<a id="L511" name="L511"></a> 511 
<a id="L512" name="L512"></a> 512 
<a id="L513" name="L513"></a> 513 
<a id="L514" name="L514"></a> 514     <em class="comment">// -- Constructors and factories --</em>
<a id="L515" name="L515"></a> 515 
<a id="L516" name="L516"></a> 516     <strong class="reserved">private</strong> URI() <em class="brace">{</em> <em class="brace">}</em>                           <em class="comment">// Used internally</em>
<a id="L517" name="L517"></a> 517 
<div class="comment">
      Constructs a URI by parsing the given string.
      <p> This constructor parses the given string exactly as specified by the
      grammar in <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC&nbsp;2396</a>,
      Appendix&nbsp;A, <b><i>except for the following deviations:</i></b> </p>
      <ul><li><p> An empty authority component is permitted as long as it is
        followed by a non-empty path, a query component, or a fragment
        component.  This allows the parsing of URIs such as
        <code>"file:///foo/bar"</code>, which seems to be the intent of
        RFC&nbsp;2396 although the grammar does not permit it.  If the
        authority component is empty then the user-information, host, and port
        components are undefined. </p></li><li><p> Empty relative paths are permitted; this seems to be the
        intent of RFC&nbsp;2396 although the grammar does not permit it.  The
        primary consequence of this deviation is that a standalone fragment
        such as <code>"#foo"</code> parses as a relative URI with an empty path
        and the given fragment, and can be usefully <a href="#resolve-frag">resolved</a> against a base URI.
        </p></li><li><p> IPv4 addresses in host components are parsed rigorously, as
        specified by <a href="http://www.ietf.org/rfc/rfc2732.txt">RFC&nbsp;2732</a>: Each
        element of a dotted-quad address must contain no more than three
        decimal digits.  Each element is further constrained to have a value
        no greater than 255. </p></li><li> <p> Hostnames in host components that comprise only a single
        domain label are permitted to start with an <i>alphanum</i>
        character. This seems to be the intent of <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC&nbsp;2396</a>
        section&nbsp;3.2.2 although the grammar does not permit it. The
        consequence of this deviation is that the authority component of a
        hierarchical URI such as <code>s://123</code>, will parse as a server-based
        authority. </p></li><li><p> IPv6 addresses are permitted for the host component.  An IPv6
        address must be enclosed in square brackets (<code>'['</code> and
        <code>']'</code>) as specified by <a href="http://www.ietf.org/rfc/rfc2732.txt">RFC&nbsp;2732</a>.  The
        IPv6 address itself must parse according to <a href="http://www.ietf.org/rfc/rfc2373.txt">RFC&nbsp;2373</a>.  IPv6
        addresses are further constrained to describe no more than sixteen
        bytes of address information, a constraint implicit in RFC&nbsp;2373
        but not expressible in the grammar. </p></li><li><p> Characters in the <i>other</i> category are permitted wherever
        RFC&nbsp;2396 permits <i>escaped</i> octets, that is, in the
        user-information, path, query, and fragment components, as well as in
        the authority component if the authority is registry-based.  This
        allows URIs to contain Unicode characters beyond those in the US-ASCII
        character set. </p></li>
      </ul>
      @param  str   The string to be parsed into a URI
      @throws  NullPointerException
               If <code>str</code> is <code>null</code>
      @throws  URISyntaxException
               If the given string violates RFC&nbsp;2396, as augmented
               by the above deviations</div>
<a id="L587" name="L587"></a> 587     <strong class="reserved">public</strong> URI(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>) <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <em class="brace">{</em>
<a id="L588" name="L588"></a> 588         <strong class="reserved">new</strong> <a href="../D/6629.html" title="Multiple defined in 9 places.">Parser</a>(<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>).<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<strong class="reserved">false</strong>);
<a id="L589" name="L589"></a> 589     <em class="brace">}</em>
<a id="L590" name="L590"></a> 590 
<div class="comment">
      Constructs a hierarchical URI from the given components.
      <p> If a scheme is given then the path, if also given, must either be
      empty or begin with a slash character (<code>'/'</code>).  Otherwise a
      component of the new URI may be left undefined by passing <code>null</code>
      for the corresponding parameter or, in the case of the <code>port</code>
      parameter, by passing <code>-1</code>.
      </p><p> This constructor first builds a URI string from the given components
      according to the rules specified in <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC&nbsp;2396</a>,
      section&nbsp;5.2, step&nbsp;7: </p>
      <ol>
        <li><p> Initially, the result string is empty. </p></li><li><p> If a scheme is given then it is appended to the result,
        followed by a colon character (<code>':'</code>).  </p></li><li><p> If user information, a host, or a port are given then the
        string <code>"//"</code> is appended.  </p></li><li><p> If user information is given then it is appended, followed by
        a commercial-at character (<code>'@'</code>).  Any character not in the
        <i>unreserved</i>, <i>punct</i>, <i>escaped</i>, or <i>other</i>
        categories is <a href="#quote">quoted</a>.  </p></li><li><p> If a host is given then it is appended.  If the host is a
        literal IPv6 address but is not enclosed in square brackets
        (<code>'['</code> and <code>']'</code>) then the square brackets are added.
        </p></li><li><p> If a port number is given then a colon character
        (<code>':'</code>) is appended, followed by the port number in decimal.
        </p></li><li><p> If a path is given then it is appended.  Any character not in
        the <i>unreserved</i>, <i>punct</i>, <i>escaped</i>, or <i>other</i>
        categories, and not equal to the slash character (<code>'/'</code>) or the
        commercial-at character (<code>'@'</code>), is quoted.  </p></li><li><p> If a query is given then a question-mark character
        (<code>'?'</code>) is appended, followed by the query.  Any character that
        is not a <a href="#legal-chars">legal URI character</a> is quoted.
        </p></li><li><p> Finally, if a fragment is given then a hash character
        (<code>'#'</code>) is appended, followed by the fragment.  Any character
        that is not a legal URI character is quoted.  </p></li>
      </ol>
      <p> The resulting URI string is then parsed as if by invoking the {@link
      #URI(String)} constructor and then invoking the {@link
      #parseServerAuthority()} method upon the result; this may cause a {@link
      URISyntaxException} to be thrown.  </p>
      @param   scheme    Scheme name
      @param   userInfo  User name and authorization information
      @param   host      Host name
      @param   port      Port number
      @param   path      Path
      @param   query     Query
      @param   fragment  Fragment
      @throws URISyntaxException
              If both a scheme and a path are given but the path is relative,
              if the URI string constructed from the given components violates
              RFC&nbsp;2396, or if the authority component of the string is
              present but cannot be parsed as a server-based authority</div>
<a id="L664" name="L664"></a> 664     <strong class="reserved">public</strong> URI(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> scheme,
<a id="L665" name="L665"></a> 665                <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> userInfo, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> host, <strong class="reserved">int</strong> port,
<a id="L666" name="L666"></a> 666                <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fragment)
<a id="L667" name="L667"></a> 667         <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L668" name="L668"></a> 668     <em class="brace">{</em>
<a id="L669" name="L669"></a> 669         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s = <a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(scheme, <strong class="reserved">null</strong>,
<a id="L670" name="L670"></a> 670                             <strong class="reserved">null</strong>, userInfo, host, port,
<a id="L671" name="L671"></a> 671                             path, <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>, fragment);
<a id="L672" name="L672"></a> 672         <a href="../S/804.html#L1817" title="Defined at 1817 in src/java/net/URI.java.">checkPath</a>(s, scheme, path);
<a id="L673" name="L673"></a> 673         <strong class="reserved">new</strong> <a href="../D/6629.html" title="Multiple defined in 9 places.">Parser</a>(s).<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<strong class="reserved">true</strong>);
<a id="L674" name="L674"></a> 674     <em class="brace">}</em>
<a id="L675" name="L675"></a> 675 
<div class="comment">
      Constructs a hierarchical URI from the given components.
      <p> If a scheme is given then the path, if also given, must either be
      empty or begin with a slash character (<code>'/'</code>).  Otherwise a
      component of the new URI may be left undefined by passing <code>null</code>
      for the corresponding parameter.
      </p><p> This constructor first builds a URI string from the given components
      according to the rules specified in <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC&nbsp;2396</a>,
      section&nbsp;5.2, step&nbsp;7: </p>
      <ol>
        <li><p> Initially, the result string is empty.  </p></li><li><p> If a scheme is given then it is appended to the result,
        followed by a colon character (<code>':'</code>).  </p></li><li><p> If an authority is given then the string <code>"//"</code> is
        appended, followed by the authority.  If the authority contains a
        literal IPv6 address then the address must be enclosed in square
        brackets (<code>'['</code> and <code>']'</code>).  Any character not in the
        <i>unreserved</i>, <i>punct</i>, <i>escaped</i>, or <i>other</i>
        categories, and not equal to the commercial-at character
        (<code>'@'</code>), is <a href="#quote">quoted</a>.  </p></li><li><p> If a path is given then it is appended.  Any character not in
        the <i>unreserved</i>, <i>punct</i>, <i>escaped</i>, or <i>other</i>
        categories, and not equal to the slash character (<code>'/'</code>) or the
        commercial-at character (<code>'@'</code>), is quoted.  </p></li><li><p> If a query is given then a question-mark character
        (<code>'?'</code>) is appended, followed by the query.  Any character that
        is not a <a href="#legal-chars">legal URI character</a> is quoted.
        </p></li><li><p> Finally, if a fragment is given then a hash character
        (<code>'#'</code>) is appended, followed by the fragment.  Any character
        that is not a legal URI character is quoted.  </p></li>
      </ol>
      <p> The resulting URI string is then parsed as if by invoking the {@link
      #URI(String)} constructor and then invoking the {@link
      #parseServerAuthority()} method upon the result; this may cause a {@link
      URISyntaxException} to be thrown.  </p>
      @param   scheme     Scheme name
      @param   authority  Authority
      @param   path       Path
      @param   query      Query
      @param   fragment   Fragment
      @throws URISyntaxException
              If both a scheme and a path are given but the path is relative,
              if the URI string constructed from the given components violates
              RFC&nbsp;2396, or if the authority component of the string is
              present but cannot be parsed as a server-based authority</div>
<a id="L737" name="L737"></a> 737     <strong class="reserved">public</strong> URI(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> scheme,
<a id="L738" name="L738"></a> 738                <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> authority,
<a id="L739" name="L739"></a> 739                <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fragment)
<a id="L740" name="L740"></a> 740         <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L741" name="L741"></a> 741     <em class="brace">{</em>
<a id="L742" name="L742"></a> 742         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s = <a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(scheme, <strong class="reserved">null</strong>,
<a id="L743" name="L743"></a> 743                             authority, <strong class="reserved">null</strong>, <strong class="reserved">null</strong>, -1,
<a id="L744" name="L744"></a> 744                             path, <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>, fragment);
<a id="L745" name="L745"></a> 745         <a href="../S/804.html#L1817" title="Defined at 1817 in src/java/net/URI.java.">checkPath</a>(s, scheme, path);
<a id="L746" name="L746"></a> 746         <strong class="reserved">new</strong> <a href="../D/6629.html" title="Multiple defined in 9 places.">Parser</a>(s).<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<strong class="reserved">false</strong>);
<a id="L747" name="L747"></a> 747     <em class="brace">}</em>
<a id="L748" name="L748"></a> 748 
<div class="comment">
      Constructs a hierarchical URI from the given components.
      <p> A component may be left undefined by passing <code>null</code>.
      </p><p> This convenience constructor works as if by invoking the
      seven-argument constructor as follows:
      </p><blockquote>
      <code>new</code> {@link #URI(String, String, String, int, String, String, String)
      URI}<code>(scheme, null, host, -1, path, null, fragment);</code>
      </blockquote>
      @param   scheme    Scheme name
      @param   host      Host name
      @param   path      Path
      @param   fragment  Fragment
      @throws  URISyntaxException
               If the URI string constructed from the given components
               violates RFC&nbsp;2396</div>
<a id="L771" name="L771"></a> 771     <strong class="reserved">public</strong> URI(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> scheme, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> host, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fragment)
<a id="L772" name="L772"></a> 772         <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L773" name="L773"></a> 773     <em class="brace">{</em>
<a id="L774" name="L774"></a> 774         <strong class="reserved">this</strong>(scheme, <strong class="reserved">null</strong>, host, -1, path, <strong class="reserved">null</strong>, fragment);
<a id="L775" name="L775"></a> 775     <em class="brace">}</em>
<a id="L776" name="L776"></a> 776 
<div class="comment">
      Constructs a URI from the given components.
      <p> A component may be left undefined by passing <code>null</code>.
      </p><p> This constructor first builds a URI in string form using the given
      components as follows:  </p>
      <ol>
        <li><p> Initially, the result string is empty.  </p></li><li><p> If a scheme is given then it is appended to the result,
        followed by a colon character (<code>':'</code>).  </p></li><li><p> If a scheme-specific part is given then it is appended.  Any
        character that is not a <a href="#legal-chars">legal URI character</a>
        is <a href="#quote">quoted</a>.  </p></li><li><p> Finally, if a fragment is given then a hash character
        (<code>'#'</code>) is appended to the string, followed by the fragment.
        Any character that is not a legal URI character is quoted.  </p></li>
      </ol>
      <p> The resulting URI string is then parsed in order to create the new
      URI instance as if by invoking the {@link #URI(String)} constructor;
      this may cause a <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> to be thrown.  </p>
      @param   scheme    Scheme name
      @param   ssp       Scheme-specific part
      @param   fragment  Fragment
      @throws  URISyntaxException
               If the URI string constructed from the given components
               violates RFC&nbsp;2396</div>
<a id="L814" name="L814"></a> 814     <strong class="reserved">public</strong> URI(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> scheme, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> ssp, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fragment)
<a id="L815" name="L815"></a> 815         <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L816" name="L816"></a> 816     <em class="brace">{</em>
<a id="L817" name="L817"></a> 817         <strong class="reserved">new</strong> <a href="../D/6629.html" title="Multiple defined in 9 places.">Parser</a>(<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(scheme, ssp,
<a id="L818" name="L818"></a> 818                             <strong class="reserved">null</strong>, <strong class="reserved">null</strong>, <strong class="reserved">null</strong>, -1,
<a id="L819" name="L819"></a> 819                             <strong class="reserved">null</strong>, <strong class="reserved">null</strong>, fragment))
<a id="L820" name="L820"></a> 820             .<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<strong class="reserved">false</strong>);
<a id="L821" name="L821"></a> 821     <em class="brace">}</em>
<a id="L822" name="L822"></a> 822 
<div class="comment">
      Creates a URI by parsing the given string.
      <p> This convenience factory method works as if by invoking the {@link
      #URI(String)} constructor; any <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> thrown by the
      constructor is caught and wrapped in a new {@link
      IllegalArgumentException} object, which is then thrown.
      </p><p> This method is provided for use in situations where it is known that
      the given string is a legal URI, for example for URI constants declared
      within in a program, and so it would be considered a programming error
      for the string not to parse as such.  The constructors, which throw
      <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> directly, should be used situations where a
      URI is being constructed from user input or from some other source that
      may be prone to errors.  </p>
      @param  str   The string to be parsed into a URI
      @return The new URI
      @throws  NullPointerException
               If <code>str</code> is <code>null</code>
      @throws  IllegalArgumentException
               If the given string violates RFC&nbsp;2396</div>
<a id="L848" name="L848"></a> 848     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/12190.html" title="Multiple referred from 234 places.">create</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>) <em class="brace">{</em>
<a id="L849" name="L849"></a> 849         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L850" name="L850"></a> 850             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>(<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>);
<a id="L851" name="L851"></a> 851         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L852" name="L852"></a> 852             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>(), <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L853" name="L853"></a> 853         <em class="brace">}</em>
<a id="L854" name="L854"></a> 854     <em class="brace">}</em>
<a id="L855" name="L855"></a> 855 
<a id="L856" name="L856"></a> 856 
<a id="L857" name="L857"></a> 857     <em class="comment">// -- Operations --</em>
<a id="L858" name="L858"></a> 858 
<div class="comment">
      Attempts to parse this URI's authority component, if defined, into
      user-information, host, and port components.
      <p> If this URI's authority component has already been recognized as
      being server-based then it will already have been parsed into
      user-information, host, and port components.  In this case, or if this
      URI has no authority component, this method simply returns this URI.
      </p><p> Otherwise this method attempts once more to parse the authority
      component into user-information, host, and port components, and throws
      an exception describing why the authority component could not be parsed
      in that way.
      </p><p> This method is provided because the generic URI syntax specified in
      <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC&nbsp;2396</a>
      cannot always distinguish a malformed server-based authority from a
      legitimate registry-based authority.  It must therefore treat some
      instances of the former as instances of the latter.  The authority
      component in the URI string <code>"//foo:bar"</code>, for example, is not a
      legal server-based authority but it is legal as a registry-based
      authority.
      </p><p> In many common situations, for example when working URIs that are
      known to be either URNs or URLs, the hierarchical URIs being used will
      always be server-based.  They therefore must either be parsed as such or
      treated as an error.  In these cases a statement such as
      </p><blockquote>
      <code>URI </code><i>u</i><code> = new URI(str).parseServerAuthority();</code>
      </blockquote>
      <p> can be used to ensure that <i>u</i> always refers to a URI that, if
      it has an authority component, has a server-based authority with proper
      user-information, host, and port components.  Invoking this method also
      ensures that if the authority could not be parsed in that way then an
      appropriate diagnostic message can be issued based upon the exception
      that is thrown. </p>
      @return  A URI whose authority field has been parsed
               as a server-based authority
      @throws  URISyntaxException
               If the authority component of this URI is defined
               but cannot be parsed as a server-based authority
               according to RFC&nbsp;2396</div>
<a id="L906" name="L906"></a> 906     <strong class="reserved">public</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/24614.html" title="Multiple referred from 2 places.">parseServerAuthority</a>()
<a id="L907" name="L907"></a> 907         <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L908" name="L908"></a> 908     <em class="brace">{</em>
<a id="L909" name="L909"></a> 909         <em class="comment">// We could be clever and cache the error message and index from the</em>
<a id="L910" name="L910"></a> 910         <em class="comment">// exception thrown during the original parse, but that would require</em>
<a id="L911" name="L911"></a> 911         <em class="comment">// either more fields or a more-obscure representation.</em>
<a id="L912" name="L912"></a> 912         <strong class="reserved">if</strong> ((host != <strong class="reserved">null</strong>) || (authority == <strong class="reserved">null</strong>))
<a id="L913" name="L913"></a> 913             <strong class="reserved">return</strong> <strong class="reserved">this</strong>;
<a id="L914" name="L914"></a> 914         <a href="../S/804.html#L1957" title="Defined at 1957 in src/java/net/URI.java.">defineString</a>();
<a id="L915" name="L915"></a> 915         <strong class="reserved">new</strong> <a href="../D/6629.html" title="Multiple defined in 9 places.">Parser</a>(<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>).<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<strong class="reserved">true</strong>);
<a id="L916" name="L916"></a> 916         <strong class="reserved">return</strong> <strong class="reserved">this</strong>;
<a id="L917" name="L917"></a> 917     <em class="brace">}</em>
<a id="L918" name="L918"></a> 918 
<div class="comment">
      Normalizes this URI's path.
      <p> If this URI is opaque, or if its path is already in normal form,
      then this URI is returned.  Otherwise a new URI is constructed that is
      identical to this URI except that its path is computed by normalizing
      this URI's path in a manner consistent with <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC&nbsp;2396</a>,
      section&nbsp;5.2, step&nbsp;6, sub-steps&nbsp;c through&nbsp;f; that is:
      </p>
      <ol>
        <li><p> All <code>"."</code> segments are removed. </p></li><li><p> If a <code>".."</code> segment is preceded by a non-<code>".."</code>
        segment then both of these segments are removed.  This step is
        repeated until it is no longer applicable. </p></li><li><p> If the path is relative, and if its first segment contains a
        colon character (<code>':'</code>), then a <code>"."</code> segment is
        prepended.  This prevents a relative URI with a path such as
        <code>"a:b/c/d"</code> from later being re-parsed as an opaque URI with a
        scheme of <code>"a"</code> and a scheme-specific part of <code>"b/c/d"</code>.
        <b><i>(Deviation from RFC&nbsp;2396)</i></b> </p></li>
      </ol>
      <p> A normalized path will begin with one or more <code>".."</code> segments
      if there were insufficient non-<code>".."</code> segments preceding them to
      allow their removal.  A normalized path will begin with a <code>"."</code>
      segment if one was inserted by step 3 above.  Otherwise, a normalized
      path will not contain any <code>"."</code> or <code>".."</code> segments. </p>
      @return  A URI equivalent to this URI,
               but whose path is in normal form</div>
<a id="L956" name="L956"></a> 956     <strong class="reserved">public</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/23781.html" title="Multiple referred from 143 places.">normalize</a>() <em class="brace">{</em>
<a id="L957" name="L957"></a> 957         <strong class="reserved">return</strong> <a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(<strong class="reserved">this</strong>);
<a id="L958" name="L958"></a> 958     <em class="brace">}</em>
<a id="L959" name="L959"></a> 959 
<div class="comment">
      Resolves the given URI against this URI.
      <p> If the given URI is already absolute, or if this URI is opaque, then
      the given URI is returned.
      </p><p><a name="resolve-frag"></a> If the given URI's fragment component is
      defined, its path component is empty, and its scheme, authority, and
      query components are undefined, then a URI with the given fragment but
      with all other components equal to those of this URI is returned.  This
      allows a URI representing a standalone fragment reference, such as
      <code>"#foo"</code>, to be usefully resolved against a base URI.
      </p><p> Otherwise this method constructs a new hierarchical URI in a manner
      consistent with <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC&nbsp;2396</a>,
      section&nbsp;5.2; that is: </p>
      <ol>
        <li><p> A new URI is constructed with this URI's scheme and the given
        URI's query and fragment components. </p></li><li><p> If the given URI has an authority component then the new URI's
        authority and path are taken from the given URI. </p></li><li><p> Otherwise the new URI's authority component is copied from
        this URI, and its path is computed as follows: </p>
        <ol>
          <li><p> If the given URI's path is absolute then the new URI's path
          is taken from the given URI. </p></li><li><p> Otherwise the given URI's path is relative, and so the new
          URI's path is computed by resolving the path of the given URI
          against the path of this URI.  This is done by concatenating all but
          the last segment of this URI's path, if any, with the given URI's
          path and then normalizing the result as if by invoking the {@link
          #normalize() normalize} method. </p></li>
        </ol></li>
      </ol>
      <p> The result of this method is absolute if, and only if, either this
      URI is absolute or the given URI is absolute.  </p>
      @param  uri  The URI to be resolved against this URI
      @return The resulting URI
      @throws  NullPointerException
               If <code>uri</code> is <code>null</code></div>
<a id="L1014" name="L1014"></a>1014     <strong class="reserved">public</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/26316.html" title="Multiple referred from 78 places.">resolve</a>(<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> uri) <em class="brace">{</em>
<a id="L1015" name="L1015"></a>1015         <strong class="reserved">return</strong> <a href="../D/31237.html" title="Multiple defined in 38 places.">resolve</a>(<strong class="reserved">this</strong>, uri);
<a id="L1016" name="L1016"></a>1016     <em class="brace">}</em>
<a id="L1017" name="L1017"></a>1017 
<div class="comment">
      Constructs a new URI by parsing the given string and then resolving it
      against this URI.
      <p> This convenience method works as if invoking it were equivalent to
      evaluating the expression {@link #resolve(java.net.URI)
      resolve}<code>(URI.</code>{@link #create(String) create}<code>(str))</code>. </p>
      @param  str   The string to be parsed into a URI
      @return The resulting URI
      @throws  NullPointerException
               If <code>str</code> is <code>null</code>
      @throws  IllegalArgumentException
               If the given string violates RFC&nbsp;2396</div>
<a id="L1035" name="L1035"></a>1035     <strong class="reserved">public</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/26316.html" title="Multiple referred from 78 places.">resolve</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>) <em class="brace">{</em>
<a id="L1036" name="L1036"></a>1036         <strong class="reserved">return</strong> <a href="../D/31237.html" title="Multiple defined in 38 places.">resolve</a>(<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>.<a href="../D/13587.html" title="Multiple defined in 90 places.">create</a>(<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>));
<a id="L1037" name="L1037"></a>1037     <em class="brace">}</em>
<a id="L1038" name="L1038"></a>1038 
<div class="comment">
      Relativizes the given URI against this URI.
      <p> The relativization of the given URI against this URI is computed as
      follows: </p>
      <ol>
        <li><p> If either this URI or the given URI are opaque, or if the
        scheme and authority components of the two URIs are not identical, or
        if the path of this URI is not a prefix of the path of the given URI,
        then the given URI is returned. </p></li><li><p> Otherwise a new relative hierarchical URI is constructed with
        query and fragment components taken from the given URI and with a path
        component computed by removing this URI's path from the beginning of
        the given URI's path. </p></li>
      </ol>
      @param  uri  The URI to be relativized against this URI
      @return The resulting URI
      @throws  NullPointerException
               If <code>uri</code> is <code>null</code></div>
<a id="L1065" name="L1065"></a>1065     <strong class="reserved">public</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/25845.html" title="Multiple referred from 2 places.">relativize</a>(<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> uri) <em class="brace">{</em>
<a id="L1066" name="L1066"></a>1066         <strong class="reserved">return</strong> <a href="../D/30631.html" title="Multiple defined in 3 places.">relativize</a>(<strong class="reserved">this</strong>, uri);
<a id="L1067" name="L1067"></a>1067     <em class="brace">}</em>
<a id="L1068" name="L1068"></a>1068 
<div class="comment">
      Constructs a URL from this URI.
      <p> This convenience method works as if invoking it were equivalent to
      evaluating the expression <code>new URL(this.toString())</code> after
      first checking that this URI is absolute. </p>
      @return  A URL constructed from this URI
      @throws  IllegalArgumentException
               If this URL is not absolute
      @throws  MalformedURLException
               If a protocol handler for the URL could not be found,
               or if some other error occurred while constructing the URL</div>
<a id="L1085" name="L1085"></a>1085     <strong class="reserved">public</strong> <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> <a href="../R/29347.html" title="Multiple referred from 14 places.">toURL</a>()
<a id="L1086" name="L1086"></a>1086         <strong class="reserved">throws</strong> <a href="../S/814.html#L38" title="Defined at 38 in src/java/net/MalformedURLException.java.">MalformedURLException</a> <em class="brace">{</em>
<a id="L1087" name="L1087"></a>1087         <strong class="reserved">if</strong> (!<a href="../D/25141.html" title="Multiple defined in 6 places.">isAbsolute</a>())
<a id="L1088" name="L1088"></a>1088             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("URI is not absolute");
<a id="L1089" name="L1089"></a>1089         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a>(<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L1090" name="L1090"></a>1090     <em class="brace">}</em>
<a id="L1091" name="L1091"></a>1091 
<a id="L1092" name="L1092"></a>1092     <em class="comment">// -- Component access methods --</em>
<a id="L1093" name="L1093"></a>1093 
<div class="comment">
      Returns the scheme component of this URI.
      <p> The scheme component of a URI, if defined, only contains characters
      in the <i>alphanum</i> category and in the string <code>"-.+"</code>.  A
      scheme always starts with an <i>alpha</i> character. </p><p>
      The scheme component of a URI cannot contain escaped octets, hence this
      method does not perform any decoding.
      @return  The scheme component of this URI,
               or <code>null</code> if the scheme is undefined</p></div>
<a id="L1107" name="L1107"></a>1107     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/18865.html" title="Multiple referred from 36 places.">getScheme</a>() <em class="brace">{</em>
<a id="L1108" name="L1108"></a>1108         <strong class="reserved">return</strong> scheme;
<a id="L1109" name="L1109"></a>1109     <em class="brace">}</em>
<a id="L1110" name="L1110"></a>1110 
<div class="comment">
      Tells whether or not this URI is absolute.
      <p> A URI is absolute if, and only if, it has a scheme component. </p>
      @return  <code>true</code> if, and only if, this URI is absolute</div>
<a id="L1118" name="L1118"></a>1118     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21122.html" title="Multiple referred from 26 places.">isAbsolute</a>() <em class="brace">{</em>
<a id="L1119" name="L1119"></a>1119         <strong class="reserved">return</strong> scheme != <strong class="reserved">null</strong>;
<a id="L1120" name="L1120"></a>1120     <em class="brace">}</em>
<a id="L1121" name="L1121"></a>1121 
<div class="comment">
      Tells whether or not this URI is opaque.
      <p> A URI is opaque if, and only if, it is absolute and its
      scheme-specific part does not begin with a slash character ('/').
      An opaque URI has a scheme, a scheme-specific part, and possibly
      a fragment; all other components are undefined. </p>
      @return  <code>true</code> if, and only if, this URI is opaque</div>
<a id="L1132" name="L1132"></a>1132     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21824.html" title="Multiple referred from 85 places.">isOpaque</a>() <em class="brace">{</em>
<a id="L1133" name="L1133"></a>1133         <strong class="reserved">return</strong> path == <strong class="reserved">null</strong>;
<a id="L1134" name="L1134"></a>1134     <em class="brace">}</em>
<a id="L1135" name="L1135"></a>1135 
<div class="comment">
      Returns the raw scheme-specific part of this URI.  The scheme-specific
      part is never undefined, though it may be empty.
      <p> The scheme-specific part of a URI only contains legal URI
      characters. </p>
      @return  The raw scheme-specific part of this URI
               (never <code>null</code>)</div>
<a id="L1146" name="L1146"></a>1146     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/804.html#L1164" title="Referred from 1164 in src/java/net/URI.java.">getRawSchemeSpecificPart</a>() <em class="brace">{</em>
<a id="L1147" name="L1147"></a>1147         <a href="../S/804.html#L1948" title="Defined at 1948 in src/java/net/URI.java.">defineSchemeSpecificPart</a>();
<a id="L1148" name="L1148"></a>1148         <strong class="reserved">return</strong> schemeSpecificPart;
<a id="L1149" name="L1149"></a>1149     <em class="brace">}</em>
<a id="L1150" name="L1150"></a>1150 
<div class="comment">
      Returns the decoded scheme-specific part of this URI.
      <p> The string returned by this method is equal to that returned by the
      {@link #getRawSchemeSpecificPart() getRawSchemeSpecificPart} method
      except that all sequences of escaped octets are <a href="#decode">decoded</a>.  </p>
      @return  The decoded scheme-specific part of this URI
               (never <code>null</code>)</div>
<a id="L1162" name="L1162"></a>1162     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/18866.html" title="Multiple referred from 7 places.">getSchemeSpecificPart</a>() <em class="brace">{</em>
<a id="L1163" name="L1163"></a>1163         <strong class="reserved">if</strong> (decodedSchemeSpecificPart == <strong class="reserved">null</strong>)
<a id="L1164" name="L1164"></a>1164             decodedSchemeSpecificPart = <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(<a href="../S/804.html#L1146" title="Defined at 1146 in src/java/net/URI.java.">getRawSchemeSpecificPart</a>());
<a id="L1165" name="L1165"></a>1165         <strong class="reserved">return</strong> decodedSchemeSpecificPart;
<a id="L1166" name="L1166"></a>1166     <em class="brace">}</em>
<a id="L1167" name="L1167"></a>1167 
<div class="comment">
      Returns the raw authority component of this URI.
      <p> The authority component of a URI, if defined, only contains the
      commercial-at character (<code>'@'</code>) and characters in the
      <i>unreserved</i>, <i>punct</i>, <i>escaped</i>, and <i>other</i>
      categories.  If the authority is server-based then it is further
      constrained to have valid user-information, host, and port
      components. </p>
      @return  The raw authority component of this URI,
               or <code>null</code> if the authority is undefined</div>
<a id="L1181" name="L1181"></a>1181     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> getRawAuthority() <em class="brace">{</em>
<a id="L1182" name="L1182"></a>1182         <strong class="reserved">return</strong> authority;
<a id="L1183" name="L1183"></a>1183     <em class="brace">}</em>
<a id="L1184" name="L1184"></a>1184 
<div class="comment">
      Returns the decoded authority component of this URI.
      <p> The string returned by this method is equal to that returned by the
      {@link #getRawAuthority() getRawAuthority} method except that all
      sequences of escaped octets are <a href="#decode">decoded</a>.  </p>
      @return  The decoded authority component of this URI,
               or <code>null</code> if the authority is undefined</div>
<a id="L1195" name="L1195"></a>1195     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/15182.html" title="Multiple referred from 12 places.">getAuthority</a>() <em class="brace">{</em>
<a id="L1196" name="L1196"></a>1196         <strong class="reserved">if</strong> (decodedAuthority == <strong class="reserved">null</strong>)
<a id="L1197" name="L1197"></a>1197             decodedAuthority = <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(authority);
<a id="L1198" name="L1198"></a>1198         <strong class="reserved">return</strong> decodedAuthority;
<a id="L1199" name="L1199"></a>1199     <em class="brace">}</em>
<a id="L1200" name="L1200"></a>1200 
<div class="comment">
      Returns the raw user-information component of this URI.
      <p> The user-information component of a URI, if defined, only contains
      characters in the <i>unreserved</i>, <i>punct</i>, <i>escaped</i>, and
      <i>other</i> categories. </p>
      @return  The raw user-information component of this URI,
               or <code>null</code> if the user information is undefined</div>
<a id="L1211" name="L1211"></a>1211     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> getRawUserInfo() <em class="brace">{</em>
<a id="L1212" name="L1212"></a>1212         <strong class="reserved">return</strong> userInfo;
<a id="L1213" name="L1213"></a>1213     <em class="brace">}</em>
<a id="L1214" name="L1214"></a>1214 
<div class="comment">
      Returns the decoded user-information component of this URI.
      <p> The string returned by this method is equal to that returned by the
      {@link #getRawUserInfo() getRawUserInfo} method except that all
      sequences of escaped octets are <a href="#decode">decoded</a>.  </p>
      @return  The decoded user-information component of this URI,
               or <code>null</code> if the user information is undefined</div>
<a id="L1225" name="L1225"></a>1225     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/19723.html" title="Multiple referred from 3 places.">getUserInfo</a>() <em class="brace">{</em>
<a id="L1226" name="L1226"></a>1226         <strong class="reserved">if</strong> ((decodedUserInfo == <strong class="reserved">null</strong>) &amp;&amp; (userInfo != <strong class="reserved">null</strong>))
<a id="L1227" name="L1227"></a>1227             decodedUserInfo = <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(userInfo);
<a id="L1228" name="L1228"></a>1228         <strong class="reserved">return</strong> decodedUserInfo;
<a id="L1229" name="L1229"></a>1229     <em class="brace">}</em>
<a id="L1230" name="L1230"></a>1230 
<div class="comment">
      Returns the host component of this URI.
      <p> The host component of a URI, if defined, will have one of the
      following forms: </p>
      <ul><li><p> A domain name consisting of one or more <i>labels</i>
        separated by period characters (<code>'.'</code>), optionally followed by
        a period character.  Each label consists of <i>alphanum</i> characters
        as well as hyphen characters (<code>'-'</code>), though hyphens never
        occur as the first or last characters in a label. The rightmost
        label of a domain name consisting of two or more labels, begins
        with an <i>alpha</i> character. </p></li><li><p> A dotted-quad IPv4 address of the form
        <i>digit</i><code>+.</code><i>digit</i><code>+.</code><i>digit</i><code>+.</code><i>digit</i><code>+</code>,
        where no <i>digit</i> sequence is longer than three characters and no
        sequence has a value larger than 255. </p></li><li><p> An IPv6 address enclosed in square brackets (<code>'['</code> and
        <code>']'</code>) and consisting of hexadecimal digits, colon characters
        (<code>':'</code>), and possibly an embedded IPv4 address.  The full
        syntax of IPv6 addresses is specified in <a href="http://www.ietf.org/rfc/rfc2373.txt"><i>RFC&nbsp;2373: IPv6
        Addressing Architecture</i></a>.  </p></li>
      </ul>
      The host component of a URI cannot contain escaped octets, hence this
      method does not perform any decoding.
      @return  The host component of this URI,
               or <code>null</code> if the host is undefined</div>
<a id="L1267" name="L1267"></a>1267     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/16910.html" title="Multiple referred from 54 places.">getHost</a>() <em class="brace">{</em>
<a id="L1268" name="L1268"></a>1268         <strong class="reserved">return</strong> host;
<a id="L1269" name="L1269"></a>1269     <em class="brace">}</em>
<a id="L1270" name="L1270"></a>1270 
<div class="comment">
      Returns the port number of this URI.
      <p> The port component of a URI, if defined, is a non-negative
      integer. </p>
      @return  The port component of this URI,
               or <code>-1</code> if the port is undefined</div>
<a id="L1280" name="L1280"></a>1280     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/18374.html" title="Multiple referred from 119 places.">getPort</a>() <em class="brace">{</em>
<a id="L1281" name="L1281"></a>1281         <strong class="reserved">return</strong> port;
<a id="L1282" name="L1282"></a>1282     <em class="brace">}</em>
<a id="L1283" name="L1283"></a>1283 
<div class="comment">
      Returns the raw path component of this URI.
      <p> The path component of a URI, if defined, only contains the slash
      character (<code>'/'</code>), the commercial-at character (<code>'@'</code>),
      and characters in the <i>unreserved</i>, <i>punct</i>, <i>escaped</i>,
      and <i>other</i> categories. </p>
      @return  The path component of this URI,
               or <code>null</code> if the path is undefined</div>
<a id="L1295" name="L1295"></a>1295     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> getRawPath() <em class="brace">{</em>
<a id="L1296" name="L1296"></a>1296         <strong class="reserved">return</strong> path;
<a id="L1297" name="L1297"></a>1297     <em class="brace">}</em>
<a id="L1298" name="L1298"></a>1298 
<div class="comment">
      Returns the decoded path component of this URI.
      <p> The string returned by this method is equal to that returned by the
      {@link #getRawPath() getRawPath} method except that all sequences of
      escaped octets are <a href="#decode">decoded</a>.  </p>
      @return  The decoded path component of this URI,
               or <code>null</code> if the path is undefined</div>
<a id="L1309" name="L1309"></a>1309     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/18300.html" title="Multiple referred from 125 places.">getPath</a>() <em class="brace">{</em>
<a id="L1310" name="L1310"></a>1310         <strong class="reserved">if</strong> ((decodedPath == <strong class="reserved">null</strong>) &amp;&amp; (path != <strong class="reserved">null</strong>))
<a id="L1311" name="L1311"></a>1311             decodedPath = <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(path);
<a id="L1312" name="L1312"></a>1312         <strong class="reserved">return</strong> decodedPath;
<a id="L1313" name="L1313"></a>1313     <em class="brace">}</em>
<a id="L1314" name="L1314"></a>1314 
<div class="comment">
      Returns the raw query component of this URI.
      <p> The query component of a URI, if defined, only contains legal URI
      characters. </p>
      @return  The raw query component of this URI,
               or <code>null</code> if the query is undefined</div>
<a id="L1324" name="L1324"></a>1324     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> getRawQuery() <em class="brace">{</em>
<a id="L1325" name="L1325"></a>1325         <strong class="reserved">return</strong> <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>;
<a id="L1326" name="L1326"></a>1326     <em class="brace">}</em>
<a id="L1327" name="L1327"></a>1327 
<div class="comment">
      Returns the decoded query component of this URI.
      <p> The string returned by this method is equal to that returned by the
      {@link #getRawQuery() getRawQuery} method except that all sequences of
      escaped octets are <a href="#decode">decoded</a>.  </p>
      @return  The decoded query component of this URI,
               or <code>null</code> if the query is undefined</div>
<a id="L1338" name="L1338"></a>1338     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/18569.html" title="Multiple referred from 11 places.">getQuery</a>() <em class="brace">{</em>
<a id="L1339" name="L1339"></a>1339         <strong class="reserved">if</strong> ((decodedQuery == <strong class="reserved">null</strong>) &amp;&amp; (<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> != <strong class="reserved">null</strong>))
<a id="L1340" name="L1340"></a>1340             decodedQuery = <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>);
<a id="L1341" name="L1341"></a>1341         <strong class="reserved">return</strong> decodedQuery;
<a id="L1342" name="L1342"></a>1342     <em class="brace">}</em>
<a id="L1343" name="L1343"></a>1343 
<div class="comment">
      Returns the raw fragment component of this URI.
      <p> The fragment component of a URI, if defined, only contains legal URI
      characters. </p>
      @return  The raw fragment component of this URI,
               or <code>null</code> if the fragment is undefined</div>
<a id="L1353" name="L1353"></a>1353     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> getRawFragment() <em class="brace">{</em>
<a id="L1354" name="L1354"></a>1354         <strong class="reserved">return</strong> fragment;
<a id="L1355" name="L1355"></a>1355     <em class="brace">}</em>
<a id="L1356" name="L1356"></a>1356 
<div class="comment">
      Returns the decoded fragment component of this URI.
      <p> The string returned by this method is equal to that returned by the
      {@link #getRawFragment() getRawFragment} method except that all
      sequences of escaped octets are <a href="#decode">decoded</a>.  </p>
      @return  The decoded fragment component of this URI,
               or <code>null</code> if the fragment is undefined</div>
<a id="L1367" name="L1367"></a>1367     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/16710.html" title="Multiple referred from 11 places.">getFragment</a>() <em class="brace">{</em>
<a id="L1368" name="L1368"></a>1368         <strong class="reserved">if</strong> ((decodedFragment == <strong class="reserved">null</strong>) &amp;&amp; (fragment != <strong class="reserved">null</strong>))
<a id="L1369" name="L1369"></a>1369             decodedFragment = <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(fragment);
<a id="L1370" name="L1370"></a>1370         <strong class="reserved">return</strong> decodedFragment;
<a id="L1371" name="L1371"></a>1371     <em class="brace">}</em>
<a id="L1372" name="L1372"></a>1372 
<a id="L1373" name="L1373"></a>1373 
<a id="L1374" name="L1374"></a>1374     <em class="comment">// -- Equality, comparison, hash code, toString, and serialization --</em>
<a id="L1375" name="L1375"></a>1375 
<div class="comment">
      Tests this URI for equality with another object.
      <p> If the given object is not a URI then this method immediately
      returns <code>false</code>.
      </p><p> For two URIs to be considered equal requires that either both are
      opaque or both are hierarchical.  Their schemes must either both be
      undefined or else be equal without regard to case. Their fragments
      must either both be undefined or else be equal.
      </p><p> For two opaque URIs to be considered equal, their scheme-specific
      parts must be equal.
      </p><p> For two hierarchical URIs to be considered equal, their paths must
      be equal and their queries must either both be undefined or else be
      equal.  Their authorities must either both be undefined, or both be
      registry-based, or both be server-based.  If their authorities are
      defined and are registry-based, then they must be equal.  If their
      authorities are defined and are server-based, then their hosts must be
      equal without regard to case, their port numbers must be equal, and
      their user-information components must be equal.
      </p><p> When testing the user-information, path, query, fragment, authority,
      or scheme-specific parts of two URIs for equality, the raw forms rather
      than the encoded forms of these components are compared and the
      hexadecimal digits of escaped octets are compared without regard to
      case.
      </p><p> This method satisfies the general contract of the {@link
      java.lang.Object#equals(Object) Object.equals} method. </p>
      @param   ob   The object to which this object is to be compared
      @return  <code>true</code> if, and only if, the given object is a URI that
               is identical to this URI</div>
<a id="L1413" name="L1413"></a>1413     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13992.html" title="Multiple referred from 5400 places.">equals</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> ob) <em class="brace">{</em>
<a id="L1414" name="L1414"></a>1414         <strong class="reserved">if</strong> (ob == <strong class="reserved">this</strong>)
<a id="L1415" name="L1415"></a>1415             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1416" name="L1416"></a>1416         <strong class="reserved">if</strong> (!(ob <strong class="reserved">instanceof</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>))
<a id="L1417" name="L1417"></a>1417             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1418" name="L1418"></a>1418         <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> that = (<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>)ob;
<a id="L1419" name="L1419"></a>1419         <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>() != that.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>()) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1420" name="L1420"></a>1420         <strong class="reserved">if</strong> (!<a href="../S/804.html#L1730" title="Defined at 1730 in src/java/net/URI.java.">equalIgnoringCase</a>(<strong class="reserved">this</strong>.scheme, that.scheme)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1421" name="L1421"></a>1421         <strong class="reserved">if</strong> (!<a href="../D/15675.html" title="Multiple defined in 20 places.">equal</a>(<strong class="reserved">this</strong>.fragment, that.fragment)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1422" name="L1422"></a>1422 
<a id="L1423" name="L1423"></a>1423         <em class="comment">// Opaque</em>
<a id="L1424" name="L1424"></a>1424         <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>())
<a id="L1425" name="L1425"></a>1425             <strong class="reserved">return</strong> <a href="../D/15675.html" title="Multiple defined in 20 places.">equal</a>(<strong class="reserved">this</strong>.schemeSpecificPart, that.schemeSpecificPart);
<a id="L1426" name="L1426"></a>1426 
<a id="L1427" name="L1427"></a>1427         <em class="comment">// Hierarchical</em>
<a id="L1428" name="L1428"></a>1428         <strong class="reserved">if</strong> (!<a href="../D/15675.html" title="Multiple defined in 20 places.">equal</a>(<strong class="reserved">this</strong>.path, that.path)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1429" name="L1429"></a>1429         <strong class="reserved">if</strong> (!<a href="../D/15675.html" title="Multiple defined in 20 places.">equal</a>(<strong class="reserved">this</strong>.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>, that.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1430" name="L1430"></a>1430 
<a id="L1431" name="L1431"></a>1431         <em class="comment">// Authorities</em>
<a id="L1432" name="L1432"></a>1432         <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.authority == that.authority) <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1433" name="L1433"></a>1433         <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.host != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1434" name="L1434"></a>1434             <em class="comment">// Server-based</em>
<a id="L1435" name="L1435"></a>1435             <strong class="reserved">if</strong> (!<a href="../D/15675.html" title="Multiple defined in 20 places.">equal</a>(<strong class="reserved">this</strong>.userInfo, that.userInfo)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1436" name="L1436"></a>1436             <strong class="reserved">if</strong> (!<a href="../S/804.html#L1730" title="Defined at 1730 in src/java/net/URI.java.">equalIgnoringCase</a>(<strong class="reserved">this</strong>.host, that.host)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1437" name="L1437"></a>1437             <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.port != that.port) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1438" name="L1438"></a>1438         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.authority != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1439" name="L1439"></a>1439             <em class="comment">// Registry-based</em>
<a id="L1440" name="L1440"></a>1440             <strong class="reserved">if</strong> (!<a href="../D/15675.html" title="Multiple defined in 20 places.">equal</a>(<strong class="reserved">this</strong>.authority, that.authority)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1441" name="L1441"></a>1441         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.authority != that.authority) <em class="brace">{</em>
<a id="L1442" name="L1442"></a>1442             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1443" name="L1443"></a>1443         <em class="brace">}</em>
<a id="L1444" name="L1444"></a>1444 
<a id="L1445" name="L1445"></a>1445         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1446" name="L1446"></a>1446     <em class="brace">}</em>
<a id="L1447" name="L1447"></a>1447 
<div class="comment">
      Returns a hash-code value for this URI.  The hash code is based upon all
      of the URI's components, and satisfies the general contract of the
      {@link java.lang.Object#hashCode() Object.hashCode} method.
      @return  A hash-code value for this URI</div>
<a id="L1455" name="L1455"></a>1455     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/20298.html" title="Multiple referred from 715 places.">hashCode</a>() <em class="brace">{</em>
<a id="L1456" name="L1456"></a>1456         <strong class="reserved">if</strong> (<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> != 0)
<a id="L1457" name="L1457"></a>1457             <strong class="reserved">return</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>;
<a id="L1458" name="L1458"></a>1458         <strong class="reserved">int</strong> h = <a href="../S/804.html#L1770" title="Defined at 1770 in src/java/net/URI.java.">hashIgnoringCase</a>(0, scheme);
<a id="L1459" name="L1459"></a>1459         h = <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>(h, fragment);
<a id="L1460" name="L1460"></a>1460         <strong class="reserved">if</strong> (<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>()) <em class="brace">{</em>
<a id="L1461" name="L1461"></a>1461             h = <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>(h, schemeSpecificPart);
<a id="L1462" name="L1462"></a>1462         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1463" name="L1463"></a>1463             h = <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>(h, path);
<a id="L1464" name="L1464"></a>1464             h = <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>(h, <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>);
<a id="L1465" name="L1465"></a>1465             <strong class="reserved">if</strong> (host != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1466" name="L1466"></a>1466                 h = <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>(h, userInfo);
<a id="L1467" name="L1467"></a>1467                 h = <a href="../S/804.html#L1770" title="Defined at 1770 in src/java/net/URI.java.">hashIgnoringCase</a>(h, host);
<a id="L1468" name="L1468"></a>1468                 h += 1949 * port;
<a id="L1469" name="L1469"></a>1469             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1470" name="L1470"></a>1470                 h = <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>(h, authority);
<a id="L1471" name="L1471"></a>1471             <em class="brace">}</em>
<a id="L1472" name="L1472"></a>1472         <em class="brace">}</em>
<a id="L1473" name="L1473"></a>1473         <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> = h;
<a id="L1474" name="L1474"></a>1474         <strong class="reserved">return</strong> h;
<a id="L1475" name="L1475"></a>1475     <em class="brace">}</em>
<a id="L1476" name="L1476"></a>1476 
<div class="comment">
      Compares this URI to another object, which must be a URI.
      <p> When comparing corresponding components of two URIs, if one
      component is undefined but the other is defined then the first is
      considered to be less than the second.  Unless otherwise noted, string
      components are ordered according to their natural, case-sensitive
      ordering as defined by the {@link java.lang.String#compareTo(Object)
      String.compareTo} method.  String components that are subject to
      encoding are compared by comparing their raw forms rather than their
      encoded forms.
      </p><p> The ordering of URIs is defined as follows: </p>
      <ul><li><p> Two URIs with different schemes are ordered according the
        ordering of their schemes, without regard to case. </p></li><li><p> A hierarchical URI is considered to be less than an opaque URI
        with an identical scheme. </p></li><li><p> Two opaque URIs with identical schemes are ordered according
        to the ordering of their scheme-specific parts. </p></li><li><p> Two opaque URIs with identical schemes and scheme-specific
        parts are ordered according to the ordering of their
        fragments. </p></li><li><p> Two hierarchical URIs with identical schemes are ordered
        according to the ordering of their authority components: </p>
        <ul><li><p> If both authority components are server-based then the URIs
          are ordered according to their user-information components; if these
          components are identical then the URIs are ordered according to the
          ordering of their hosts, without regard to case; if the hosts are
          identical then the URIs are ordered according to the ordering of
          their ports. </p></li><li><p> If one or both authority components are registry-based then
          the URIs are ordered according to the ordering of their authority
          components. </p></li>
        </ul></li><li><p> Finally, two hierarchical URIs with identical schemes and
        authority components are ordered according to the ordering of their
        paths; if their paths are identical then they are ordered according to
        the ordering of their queries; if the queries are identical then they
        are ordered according to the order of their fragments. </p></li>
      </ul>
      <p> This method satisfies the general contract of the {@link
      java.lang.Comparable#compareTo(Object) Comparable.compareTo}
      method. </p>
      @param   that
               The object to which this URI is to be compared
      @return  A negative integer, zero, or a positive integer as this URI is
               less than, equal to, or greater than the given URI
      @throws  ClassCastException
               If the given object is not a URI</div>
<a id="L1545" name="L1545"></a>1545     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/11724.html" title="Multiple referred from 291 places.">compareTo</a>(<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> that) <em class="brace">{</em>
<a id="L1546" name="L1546"></a>1546         <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1547" name="L1547"></a>1547 
<a id="L1548" name="L1548"></a>1548         <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../S/804.html#L1792" title="Defined at 1792 in src/java/net/URI.java.">compareIgnoringCase</a>(<strong class="reserved">this</strong>.scheme, that.scheme)) != 0)
<a id="L1549" name="L1549"></a>1549             <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1550" name="L1550"></a>1550 
<a id="L1551" name="L1551"></a>1551         <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>()) <em class="brace">{</em>
<a id="L1552" name="L1552"></a>1552             <strong class="reserved">if</strong> (that.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>()) <em class="brace">{</em>
<a id="L1553" name="L1553"></a>1553                 <em class="comment">// Both opaque</em>
<a id="L1554" name="L1554"></a>1554                 <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<strong class="reserved">this</strong>.schemeSpecificPart,
<a id="L1555" name="L1555"></a>1555                                  that.schemeSpecificPart)) != 0)
<a id="L1556" name="L1556"></a>1556                     <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1557" name="L1557"></a>1557                 <strong class="reserved">return</strong> <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<strong class="reserved">this</strong>.fragment, that.fragment);
<a id="L1558" name="L1558"></a>1558             <em class="brace">}</em>
<a id="L1559" name="L1559"></a>1559             <strong class="reserved">return</strong> +1;                  <em class="comment">// Opaque &gt; hierarchical</em>
<a id="L1560" name="L1560"></a>1560         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (that.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>()) <em class="brace">{</em>
<a id="L1561" name="L1561"></a>1561             <strong class="reserved">return</strong> -1;                  <em class="comment">// Hierarchical &lt; opaque</em>
<a id="L1562" name="L1562"></a>1562         <em class="brace">}</em>
<a id="L1563" name="L1563"></a>1563 
<a id="L1564" name="L1564"></a>1564         <em class="comment">// Hierarchical</em>
<a id="L1565" name="L1565"></a>1565         <strong class="reserved">if</strong> ((<strong class="reserved">this</strong>.host != <strong class="reserved">null</strong>) &amp;&amp; (that.host != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L1566" name="L1566"></a>1566             <em class="comment">// Both server-based</em>
<a id="L1567" name="L1567"></a>1567             <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<strong class="reserved">this</strong>.userInfo, that.userInfo)) != 0)
<a id="L1568" name="L1568"></a>1568                 <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1569" name="L1569"></a>1569             <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../S/804.html#L1792" title="Defined at 1792 in src/java/net/URI.java.">compareIgnoringCase</a>(<strong class="reserved">this</strong>.host, that.host)) != 0)
<a id="L1570" name="L1570"></a>1570                 <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1571" name="L1571"></a>1571             <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <strong class="reserved">this</strong>.port - that.port) != 0)
<a id="L1572" name="L1572"></a>1572                 <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1573" name="L1573"></a>1573         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1574" name="L1574"></a>1574             <em class="comment">// If one or both authorities are registry-based then we simply</em>
<a id="L1575" name="L1575"></a>1575             <em class="comment">// compare them in the usual, case-sensitive way.  If one is</em>
<a id="L1576" name="L1576"></a>1576             <em class="comment">// registry-based and one is server-based then the strings are</em>
<a id="L1577" name="L1577"></a>1577             <em class="comment">// guaranteed to be unequal, hence the comparison will never return</em>
<a id="L1578" name="L1578"></a>1578             <em class="comment">// zero and the compareTo and equals methods will remain</em>
<a id="L1579" name="L1579"></a>1579             <em class="comment">// consistent.</em>
<a id="L1580" name="L1580"></a>1580             <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<strong class="reserved">this</strong>.authority, that.authority)) != 0) <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1581" name="L1581"></a>1581         <em class="brace">}</em>
<a id="L1582" name="L1582"></a>1582 
<a id="L1583" name="L1583"></a>1583         <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<strong class="reserved">this</strong>.path, that.path)) != 0) <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1584" name="L1584"></a>1584         <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<strong class="reserved">this</strong>.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>, that.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>)) != 0) <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1585" name="L1585"></a>1585         <strong class="reserved">return</strong> <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<strong class="reserved">this</strong>.fragment, that.fragment);
<a id="L1586" name="L1586"></a>1586     <em class="brace">}</em>
<a id="L1587" name="L1587"></a>1587 
<div class="comment">
      Returns the content of this URI as a string.
      <p> If this URI was created by invoking one of the constructors in this
      class then a string equivalent to the original input string, or to the
      string computed from the originally-given components, as appropriate, is
      returned.  Otherwise this URI was created by normalization, resolution,
      or relativization, and so a string is constructed from this URI's
      components according to the rules specified in <a href="http://www.ietf.org/rfc/rfc2396.txt">RFC&nbsp;2396</a>,
      section&nbsp;5.2, step&nbsp;7. </p>
      @return  The string form of this URI</div>
<a id="L1602" name="L1602"></a>1602     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L1603" name="L1603"></a>1603         <a href="../S/804.html#L1957" title="Defined at 1957 in src/java/net/URI.java.">defineString</a>();
<a id="L1604" name="L1604"></a>1604         <strong class="reserved">return</strong> <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>;
<a id="L1605" name="L1605"></a>1605     <em class="brace">}</em>
<a id="L1606" name="L1606"></a>1606 
<div class="comment">
      Returns the content of this URI as a US-ASCII string.
      <p> If this URI does not contain any characters in the <i>other</i>
      category then an invocation of this method will return the same value as
      an invocation of the {@link #toString() toString} method.  Otherwise
      this method works as if by invoking that method and then <a href="#encode">encoding</a> the result.  </p>
      @return  The string form of this URI, encoded as needed
               so that it only contains characters in the US-ASCII
               charset</div>
<a id="L1620" name="L1620"></a>1620     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29211.html" title="Multiple referred from 7 places.">toASCIIString</a>() <em class="brace">{</em>
<a id="L1621" name="L1621"></a>1621         <a href="../S/804.html#L1957" title="Defined at 1957 in src/java/net/URI.java.">defineString</a>();
<a id="L1622" name="L1622"></a>1622         <strong class="reserved">return</strong> <a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>);
<a id="L1623" name="L1623"></a>1623     <em class="brace">}</em>
<a id="L1624" name="L1624"></a>1624 
<a id="L1625" name="L1625"></a>1625 
<a id="L1626" name="L1626"></a>1626     <em class="comment">// -- Serialization support --</em>
<a id="L1627" name="L1627"></a>1627 
<div class="comment">
      Saves the content of this URI to the given serial stream.
      <p> The only serializable field of a URI instance is its <code>string</code>
      field.  That field is given a value, if it does not have one already,
      and then the {@link java.io.ObjectOutputStream#defaultWriteObject()}
      method of the given object-output stream is invoked. </p>
      @param  os  The object-output stream to which this object
                  is to be written</div>
<a id="L1639" name="L1639"></a>1639     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/30680.html" title="Multiple referred from 184 places.">writeObject</a>(<a href="../S/1381.html#L162" title="Defined at 162 in src/java/io/ObjectOutputStream.java.">ObjectOutputStream</a> os)
<a id="L1640" name="L1640"></a>1640         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L1641" name="L1641"></a>1641     <em class="brace">{</em>
<a id="L1642" name="L1642"></a>1642         <a href="../S/804.html#L1957" title="Defined at 1957 in src/java/net/URI.java.">defineString</a>();
<a id="L1643" name="L1643"></a>1643         os.<a href="../D/14752.html" title="Multiple defined in 6 places.">defaultWriteObject</a>();        <em class="comment">// Writes the string field only</em>
<a id="L1644" name="L1644"></a>1644     <em class="brace">}</em>
<a id="L1645" name="L1645"></a>1645 
<div class="comment">
      Reconstitutes a URI from the given serial stream.
      <p> The {@link java.io.ObjectInputStream#defaultReadObject()} method is
      invoked to read the value of the <code>string</code> field.  The result is
      then parsed in the usual way.
      @param  is  The object-input stream from which this object
                  is being read</p></div>
<a id="L1656" name="L1656"></a>1656     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25518.html" title="Multiple referred from 189 places.">readObject</a>(<a href="../S/1378.html#L206" title="Defined at 206 in src/java/io/ObjectInputStream.java.">ObjectInputStream</a> <a href="../D/25134.html" title="Multiple defined in 5 places.">is</a>)
<a id="L1657" name="L1657"></a>1657         <strong class="reserved">throws</strong> <a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a>, <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L1658" name="L1658"></a>1658     <em class="brace">{</em>
<a id="L1659" name="L1659"></a>1659         port = -1;                      <em class="comment">// Argh</em>
<a id="L1660" name="L1660"></a>1660         <a href="../D/25134.html" title="Multiple defined in 5 places.">is</a>.<a href="../D/14746.html" title="Multiple defined in 2 places.">defaultReadObject</a>();
<a id="L1661" name="L1661"></a>1661         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1662" name="L1662"></a>1662             <strong class="reserved">new</strong> <a href="../D/6629.html" title="Multiple defined in 9 places.">Parser</a>(<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>).<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<strong class="reserved">false</strong>);
<a id="L1663" name="L1663"></a>1663         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L1664" name="L1664"></a>1664             <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> y = <strong class="reserved">new</strong> <a href="../S/1428.html#L38" title="Defined at 38 in src/java/io/InvalidObjectException.java.">InvalidObjectException</a>("Invalid URI");
<a id="L1665" name="L1665"></a>1665             y.<a href="../D/24507.html" title="Multiple defined in 7 places.">initCause</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L1666" name="L1666"></a>1666             <strong class="reserved">throw</strong> y;
<a id="L1667" name="L1667"></a>1667         <em class="brace">}</em>
<a id="L1668" name="L1668"></a>1668     <em class="brace">}</em>
<a id="L1669" name="L1669"></a>1669 
<a id="L1670" name="L1670"></a>1670 
<a id="L1671" name="L1671"></a>1671     <em class="comment">// -- End of public methods --</em>
<a id="L1672" name="L1672"></a>1672 
<a id="L1673" name="L1673"></a>1673 
<a id="L1674" name="L1674"></a>1674     <em class="comment">// -- Utility methods for string-field comparison and hashing --</em>
<a id="L1675" name="L1675"></a>1675 
<a id="L1676" name="L1676"></a>1676     <em class="comment">// These methods return appropriate values for null string arguments,</em>
<a id="L1677" name="L1677"></a>1677     <em class="comment">// thereby simplifying the equals, hashCode, and compareTo methods.</em>
<a id="L1678" name="L1678"></a>1678     <em class="comment">//</em>
<a id="L1679" name="L1679"></a>1679     <em class="comment">// The case-ignoring methods should only be applied to strings whose</em>
<a id="L1680" name="L1680"></a>1680     <em class="comment">// characters are all known to be US-ASCII.  Because of this restriction,</em>
<a id="L1681" name="L1681"></a>1681     <em class="comment">// these methods are faster than the similar methods in the String class.</em>
<a id="L1682" name="L1682"></a>1682 
<a id="L1683" name="L1683"></a>1683     <em class="comment">// US-ASCII only</em>
<a id="L1684" name="L1684"></a>1684     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/29288.html" title="Multiple referred from 15 places.">toLower</a>(<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L1685" name="L1685"></a>1685         <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 'A') &amp;&amp; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= 'Z'))
<a id="L1686" name="L1686"></a>1686             <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> + ('a' - 'A');
<a id="L1687" name="L1687"></a>1687         <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1688" name="L1688"></a>1688     <em class="brace">}</em>
<a id="L1689" name="L1689"></a>1689 
<a id="L1690" name="L1690"></a>1690     <em class="comment">// US-ASCII only</em>
<a id="L1691" name="L1691"></a>1691     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/29357.html" title="Multiple referred from 4 places.">toUpper</a>(<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L1692" name="L1692"></a>1692         <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 'a') &amp;&amp; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= 'z'))
<a id="L1693" name="L1693"></a>1693             <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> - ('a' - 'A');
<a id="L1694" name="L1694"></a>1694         <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1695" name="L1695"></a>1695     <em class="brace">}</em>
<a id="L1696" name="L1696"></a>1696 
<a id="L1697" name="L1697"></a>1697     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/13983.html" title="Multiple referred from 70 places.">equal</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> t) <em class="brace">{</em>
<a id="L1698" name="L1698"></a>1698         <strong class="reserved">if</strong> (s == t) <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1699" name="L1699"></a>1699         <strong class="reserved">if</strong> ((s != <strong class="reserved">null</strong>) &amp;&amp; (t != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L1700" name="L1700"></a>1700             <strong class="reserved">if</strong> (s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() != t.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>())
<a id="L1701" name="L1701"></a>1701                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1702" name="L1702"></a>1702             <strong class="reserved">if</strong> (s.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('%') &lt; 0)
<a id="L1703" name="L1703"></a>1703                 <strong class="reserved">return</strong> s.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(t);
<a id="L1704" name="L1704"></a>1704             <strong class="reserved">int</strong> n = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L1705" name="L1705"></a>1705             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n;) <em class="brace">{</em>
<a id="L1706" name="L1706"></a>1706                 <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L1707" name="L1707"></a>1707                 <strong class="reserved">char</strong> d = t.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L1708" name="L1708"></a>1708                 <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> != '%') <em class="brace">{</em>
<a id="L1709" name="L1709"></a>1709                     <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> != d)
<a id="L1710" name="L1710"></a>1710                         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1711" name="L1711"></a>1711                     i++;
<a id="L1712" name="L1712"></a>1712                     <strong class="reserved">continue</strong>;
<a id="L1713" name="L1713"></a>1713                 <em class="brace">}</em>
<a id="L1714" name="L1714"></a>1714                 <strong class="reserved">if</strong> (d != '%')
<a id="L1715" name="L1715"></a>1715                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1716" name="L1716"></a>1716                 i++;
<a id="L1717" name="L1717"></a>1717                 <strong class="reserved">if</strong> (<a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)) != <a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(t.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)))
<a id="L1718" name="L1718"></a>1718                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1719" name="L1719"></a>1719                 i++;
<a id="L1720" name="L1720"></a>1720                 <strong class="reserved">if</strong> (<a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)) != <a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(t.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)))
<a id="L1721" name="L1721"></a>1721                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1722" name="L1722"></a>1722                 i++;
<a id="L1723" name="L1723"></a>1723             <em class="brace">}</em>
<a id="L1724" name="L1724"></a>1724             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1725" name="L1725"></a>1725         <em class="brace">}</em>
<a id="L1726" name="L1726"></a>1726         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1727" name="L1727"></a>1727     <em class="brace">}</em>
<a id="L1728" name="L1728"></a>1728 
<a id="L1729" name="L1729"></a>1729     <em class="comment">// US-ASCII only</em>
<a id="L1730" name="L1730"></a>1730     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/13987.html" title="Multiple referred from 3 places.">equalIgnoringCase</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> t) <em class="brace">{</em>
<a id="L1731" name="L1731"></a>1731         <strong class="reserved">if</strong> (s == t) <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1732" name="L1732"></a>1732         <strong class="reserved">if</strong> ((s != <strong class="reserved">null</strong>) &amp;&amp; (t != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L1733" name="L1733"></a>1733             <strong class="reserved">int</strong> n = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L1734" name="L1734"></a>1734             <strong class="reserved">if</strong> (t.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() != n)
<a id="L1735" name="L1735"></a>1735                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1736" name="L1736"></a>1736             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L1737" name="L1737"></a>1737                 <strong class="reserved">if</strong> (<a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)) != <a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(t.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)))
<a id="L1738" name="L1738"></a>1738                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1739" name="L1739"></a>1739             <em class="brace">}</em>
<a id="L1740" name="L1740"></a>1740             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1741" name="L1741"></a>1741         <em class="brace">}</em>
<a id="L1742" name="L1742"></a>1742         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1743" name="L1743"></a>1743     <em class="brace">}</em>
<a id="L1744" name="L1744"></a>1744 
<a id="L1745" name="L1745"></a>1745     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/20297.html" title="Multiple referred from 694 places.">hash</a>(<strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <em class="brace">{</em>
<a id="L1746" name="L1746"></a>1746         <strong class="reserved">if</strong> (s == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>;
<a id="L1747" name="L1747"></a>1747         <strong class="reserved">return</strong> s.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('%') &lt; 0 ? <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> * 127 + s.<a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>()
<a id="L1748" name="L1748"></a>1748                                   : <a href="../S/804.html#L1752" title="Defined at 1752 in src/java/net/URI.java.">normalizedHash</a>(<a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>, s);
<a id="L1749" name="L1749"></a>1749     <em class="brace">}</em>
<a id="L1750" name="L1750"></a>1750 
<a id="L1751" name="L1751"></a>1751 
<a id="L1752" name="L1752"></a>1752     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../S/804.html#L1748" title="Referred from 1748 in src/java/net/URI.java.">normalizedHash</a>(<strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <em class="brace">{</em>
<a id="L1753" name="L1753"></a>1753         <strong class="reserved">int</strong> h = 0;
<a id="L1754" name="L1754"></a>1754         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = 0; <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>(); <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++) <em class="brace">{</em>
<a id="L1755" name="L1755"></a>1755             <strong class="reserved">char</strong> ch = s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>);
<a id="L1756" name="L1756"></a>1756             h = 31 * h + ch;
<a id="L1757" name="L1757"></a>1757             <strong class="reserved">if</strong> (ch == '%') <em class="brace">{</em>
<div class="comment">
                  Process the next two encoded characters</div>
<a id="L1761" name="L1761"></a>1761                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> + 1; i &lt; <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> + 3; i++)
<a id="L1762" name="L1762"></a>1762                     h = 31 * h + <a href="../D/35513.html" title="Multiple defined in 2 places.">toUpper</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i));
<a id="L1763" name="L1763"></a>1763                 <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> += 2;
<a id="L1764" name="L1764"></a>1764             <em class="brace">}</em>
<a id="L1765" name="L1765"></a>1765         <em class="brace">}</em>
<a id="L1766" name="L1766"></a>1766         <strong class="reserved">return</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a> * 127 + h;
<a id="L1767" name="L1767"></a>1767     <em class="brace">}</em>
<a id="L1768" name="L1768"></a>1768 
<a id="L1769" name="L1769"></a>1769     <em class="comment">// US-ASCII only</em>
<a id="L1770" name="L1770"></a>1770     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/20299.html" title="Multiple referred from 2 places.">hashIgnoringCase</a>(<strong class="reserved">int</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <em class="brace">{</em>
<a id="L1771" name="L1771"></a>1771         <strong class="reserved">if</strong> (s == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>;
<a id="L1772" name="L1772"></a>1772         <strong class="reserved">int</strong> h = <a href="../D/24219.html" title="Multiple defined in 17 places.">hash</a>;
<a id="L1773" name="L1773"></a>1773         <strong class="reserved">int</strong> n = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L1774" name="L1774"></a>1774         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L1775" name="L1775"></a>1775             h = 31 * h + <a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i));
<a id="L1776" name="L1776"></a>1776         <strong class="reserved">return</strong> h;
<a id="L1777" name="L1777"></a>1777     <em class="brace">}</em>
<a id="L1778" name="L1778"></a>1778 
<a id="L1779" name="L1779"></a>1779     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/11691.html" title="Multiple referred from 208 places.">compare</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> t) <em class="brace">{</em>
<a id="L1780" name="L1780"></a>1780         <strong class="reserved">if</strong> (s == t) <strong class="reserved">return</strong> 0;
<a id="L1781" name="L1781"></a>1781         <strong class="reserved">if</strong> (s != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1782" name="L1782"></a>1782             <strong class="reserved">if</strong> (t != <strong class="reserved">null</strong>)
<a id="L1783" name="L1783"></a>1783                 <strong class="reserved">return</strong> s.<a href="../D/13068.html" title="Multiple defined in 86 places.">compareTo</a>(t);
<a id="L1784" name="L1784"></a>1784             <strong class="reserved">else</strong>
<a id="L1785" name="L1785"></a>1785                 <strong class="reserved">return</strong> +1;
<a id="L1786" name="L1786"></a>1786         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1787" name="L1787"></a>1787             <strong class="reserved">return</strong> -1;
<a id="L1788" name="L1788"></a>1788         <em class="brace">}</em>
<a id="L1789" name="L1789"></a>1789     <em class="brace">}</em>
<a id="L1790" name="L1790"></a>1790 
<a id="L1791" name="L1791"></a>1791     <em class="comment">// US-ASCII only</em>
<a id="L1792" name="L1792"></a>1792     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/11713.html" title="Multiple referred from 2 places.">compareIgnoringCase</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> t) <em class="brace">{</em>
<a id="L1793" name="L1793"></a>1793         <strong class="reserved">if</strong> (s == t) <strong class="reserved">return</strong> 0;
<a id="L1794" name="L1794"></a>1794         <strong class="reserved">if</strong> (s != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1795" name="L1795"></a>1795             <strong class="reserved">if</strong> (t != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1796" name="L1796"></a>1796                 <strong class="reserved">int</strong> sn = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L1797" name="L1797"></a>1797                 <strong class="reserved">int</strong> tn = t.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L1798" name="L1798"></a>1798                 <strong class="reserved">int</strong> n = sn &lt; tn ? sn : tn;
<a id="L1799" name="L1799"></a>1799                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L1800" name="L1800"></a>1800                     <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)) - <a href="../D/35436.html" title="Multiple defined in 5 places.">toLower</a>(t.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i));
<a id="L1801" name="L1801"></a>1801                     <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> != 0)
<a id="L1802" name="L1802"></a>1802                         <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L1803" name="L1803"></a>1803                 <em class="brace">}</em>
<a id="L1804" name="L1804"></a>1804                 <strong class="reserved">return</strong> sn - tn;
<a id="L1805" name="L1805"></a>1805             <em class="brace">}</em>
<a id="L1806" name="L1806"></a>1806             <strong class="reserved">return</strong> +1;
<a id="L1807" name="L1807"></a>1807         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1808" name="L1808"></a>1808             <strong class="reserved">return</strong> -1;
<a id="L1809" name="L1809"></a>1809         <em class="brace">}</em>
<a id="L1810" name="L1810"></a>1810     <em class="brace">}</em>
<a id="L1811" name="L1811"></a>1811 
<a id="L1812" name="L1812"></a>1812 
<a id="L1813" name="L1813"></a>1813     <em class="comment">// -- String construction --</em>
<a id="L1814" name="L1814"></a>1814 
<a id="L1815" name="L1815"></a>1815     <em class="comment">// If a scheme is given then the path, if given, must be absolute</em>
<a id="L1816" name="L1816"></a>1816     <em class="comment">//</em>
<a id="L1817" name="L1817"></a>1817     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/11291.html" title="Multiple referred from 2 places.">checkPath</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> scheme, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path)
<a id="L1818" name="L1818"></a>1818         <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L1819" name="L1819"></a>1819     <em class="brace">{</em>
<a id="L1820" name="L1820"></a>1820         <strong class="reserved">if</strong> (scheme != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1821" name="L1821"></a>1821             <strong class="reserved">if</strong> ((path != <strong class="reserved">null</strong>)
<a id="L1822" name="L1822"></a>1822                 &amp;&amp; ((path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt; 0) &amp;&amp; (path.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0) != '/')))
<a id="L1823" name="L1823"></a>1823                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>(s,
<a id="L1824" name="L1824"></a>1824                                              "Relative path in absolute URI");
<a id="L1825" name="L1825"></a>1825         <em class="brace">}</em>
<a id="L1826" name="L1826"></a>1826     <em class="brace">}</em>
<a id="L1827" name="L1827"></a>1827 
<a id="L1828" name="L1828"></a>1828     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/804.html#L1909" title="Referred from 1909 in src/java/net/URI.java.">appendAuthority</a>(<a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb,
<a id="L1829" name="L1829"></a>1829                                  <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> authority,
<a id="L1830" name="L1830"></a>1830                                  <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> userInfo,
<a id="L1831" name="L1831"></a>1831                                  <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> host,
<a id="L1832" name="L1832"></a>1832                                  <strong class="reserved">int</strong> port)
<a id="L1833" name="L1833"></a>1833     <em class="brace">{</em>
<a id="L1834" name="L1834"></a>1834         <strong class="reserved">if</strong> (host != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1835" name="L1835"></a>1835             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("//");
<a id="L1836" name="L1836"></a>1836             <strong class="reserved">if</strong> (userInfo != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1837" name="L1837"></a>1837                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30085.html" title="Multiple defined in 6 places.">quote</a>(userInfo, L_USERINFO, H_USERINFO));
<a id="L1838" name="L1838"></a>1838                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('@');
<a id="L1839" name="L1839"></a>1839             <em class="brace">}</em>
<a id="L1840" name="L1840"></a>1840             <strong class="reserved">boolean</strong> needBrackets = ((host.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(':') &gt;= 0)
<a id="L1841" name="L1841"></a>1841                                     &amp;&amp; !host.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("[")
<a id="L1842" name="L1842"></a>1842                                     &amp;&amp; !host.<a href="../D/15495.html" title="Multiple defined in 12 places.">endsWith</a>("]"));
<a id="L1843" name="L1843"></a>1843             <strong class="reserved">if</strong> (needBrackets) sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('[');
<a id="L1844" name="L1844"></a>1844             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(host);
<a id="L1845" name="L1845"></a>1845             <strong class="reserved">if</strong> (needBrackets) sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(']');
<a id="L1846" name="L1846"></a>1846             <strong class="reserved">if</strong> (port != -1) <em class="brace">{</em>
<a id="L1847" name="L1847"></a>1847                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(':');
<a id="L1848" name="L1848"></a>1848                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(port);
<a id="L1849" name="L1849"></a>1849             <em class="brace">}</em>
<a id="L1850" name="L1850"></a>1850         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (authority != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1851" name="L1851"></a>1851             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("//");
<a id="L1852" name="L1852"></a>1852             <strong class="reserved">if</strong> (authority.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("[")) <em class="brace">{</em>
<a id="L1853" name="L1853"></a>1853                 <em class="comment">// authority should (but may not) contain an embedded IPv6 address</em>
<a id="L1854" name="L1854"></a>1854                 <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = authority.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>("]");
<a id="L1855" name="L1855"></a>1855                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> doquote = authority, dontquote = "";
<a id="L1856" name="L1856"></a>1856                 <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != -1 &amp;&amp; authority.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(":") != -1) <em class="brace">{</em>
<a id="L1857" name="L1857"></a>1857                     <em class="comment">// the authority contains an IPv6 address</em>
<a id="L1858" name="L1858"></a>1858                     <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> == authority.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <em class="brace">{</em>
<a id="L1859" name="L1859"></a>1859                         dontquote = authority;
<a id="L1860" name="L1860"></a>1860                         doquote = "";
<a id="L1861" name="L1861"></a>1861                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1862" name="L1862"></a>1862                         dontquote = authority.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0 , <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> + 1);
<a id="L1863" name="L1863"></a>1863                         doquote = authority.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> + 1);
<a id="L1864" name="L1864"></a>1864                     <em class="brace">}</em>
<a id="L1865" name="L1865"></a>1865                 <em class="brace">}</em>
<a id="L1866" name="L1866"></a>1866                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(dontquote);
<a id="L1867" name="L1867"></a>1867                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30085.html" title="Multiple defined in 6 places.">quote</a>(doquote,
<a id="L1868" name="L1868"></a>1868                             L_REG_NAME | L_SERVER,
<a id="L1869" name="L1869"></a>1869                             H_REG_NAME | H_SERVER));
<a id="L1870" name="L1870"></a>1870             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1871" name="L1871"></a>1871                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30085.html" title="Multiple defined in 6 places.">quote</a>(authority,
<a id="L1872" name="L1872"></a>1872                             L_REG_NAME | L_SERVER,
<a id="L1873" name="L1873"></a>1873                             H_REG_NAME | H_SERVER));
<a id="L1874" name="L1874"></a>1874             <em class="brace">}</em>
<a id="L1875" name="L1875"></a>1875         <em class="brace">}</em>
<a id="L1876" name="L1876"></a>1876     <em class="brace">}</em>
<a id="L1877" name="L1877"></a>1877 
<a id="L1878" name="L1878"></a>1878     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/10239.html" title="Multiple referred from 2 places.">appendSchemeSpecificPart</a>(<a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb,
<a id="L1879" name="L1879"></a>1879                                           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> opaquePart,
<a id="L1880" name="L1880"></a>1880                                           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> authority,
<a id="L1881" name="L1881"></a>1881                                           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> userInfo,
<a id="L1882" name="L1882"></a>1882                                           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> host,
<a id="L1883" name="L1883"></a>1883                                           <strong class="reserved">int</strong> port,
<a id="L1884" name="L1884"></a>1884                                           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path,
<a id="L1885" name="L1885"></a>1885                                           <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>)
<a id="L1886" name="L1886"></a>1886     <em class="brace">{</em>
<a id="L1887" name="L1887"></a>1887         <strong class="reserved">if</strong> (opaquePart != <strong class="reserved">null</strong>) <em class="brace">{</em>
<div class="comment">
 check if SSP begins with an IPv6 address
              because we must not quote a literal IPv6 address</div>
<a id="L1891" name="L1891"></a>1891             <strong class="reserved">if</strong> (opaquePart.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("//[")) <em class="brace">{</em>
<a id="L1892" name="L1892"></a>1892                 <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> =  opaquePart.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>("]");
<a id="L1893" name="L1893"></a>1893                 <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != -1 &amp;&amp; opaquePart.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(":")!=-1) <em class="brace">{</em>
<a id="L1894" name="L1894"></a>1894                     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> doquote, dontquote;
<a id="L1895" name="L1895"></a>1895                     <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> == opaquePart.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <em class="brace">{</em>
<a id="L1896" name="L1896"></a>1896                         dontquote = opaquePart;
<a id="L1897" name="L1897"></a>1897                         doquote = "";
<a id="L1898" name="L1898"></a>1898                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1899" name="L1899"></a>1899                         dontquote = opaquePart.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0,<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>+1);
<a id="L1900" name="L1900"></a>1900                         doquote = opaquePart.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>+1);
<a id="L1901" name="L1901"></a>1901                     <em class="brace">}</em>
<a id="L1902" name="L1902"></a>1902                     sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a> (dontquote);
<a id="L1903" name="L1903"></a>1903                     sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30085.html" title="Multiple defined in 6 places.">quote</a>(doquote, L_URIC, H_URIC));
<a id="L1904" name="L1904"></a>1904                 <em class="brace">}</em>
<a id="L1905" name="L1905"></a>1905             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1906" name="L1906"></a>1906                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30085.html" title="Multiple defined in 6 places.">quote</a>(opaquePart, L_URIC, H_URIC));
<a id="L1907" name="L1907"></a>1907             <em class="brace">}</em>
<a id="L1908" name="L1908"></a>1908         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1909" name="L1909"></a>1909             <a href="../S/804.html#L1828" title="Defined at 1828 in src/java/net/URI.java.">appendAuthority</a>(sb, authority, userInfo, host, port);
<a id="L1910" name="L1910"></a>1910             <strong class="reserved">if</strong> (path != <strong class="reserved">null</strong>)
<a id="L1911" name="L1911"></a>1911                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30085.html" title="Multiple defined in 6 places.">quote</a>(path, L_PATH, H_PATH));
<a id="L1912" name="L1912"></a>1912             <strong class="reserved">if</strong> (<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1913" name="L1913"></a>1913                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('?');
<a id="L1914" name="L1914"></a>1914                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30085.html" title="Multiple defined in 6 places.">quote</a>(<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>, L_URIC, H_URIC));
<a id="L1915" name="L1915"></a>1915             <em class="brace">}</em>
<a id="L1916" name="L1916"></a>1916         <em class="brace">}</em>
<a id="L1917" name="L1917"></a>1917     <em class="brace">}</em>
<a id="L1918" name="L1918"></a>1918 
<a id="L1919" name="L1919"></a>1919     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/804.html#L1944" title="Referred from 1944 in src/java/net/URI.java.">appendFragment</a>(<a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fragment) <em class="brace">{</em>
<a id="L1920" name="L1920"></a>1920         <strong class="reserved">if</strong> (fragment != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1921" name="L1921"></a>1921             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('#');
<a id="L1922" name="L1922"></a>1922             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30085.html" title="Multiple defined in 6 places.">quote</a>(fragment, L_URIC, H_URIC));
<a id="L1923" name="L1923"></a>1923         <em class="brace">}</em>
<a id="L1924" name="L1924"></a>1924     <em class="brace">}</em>
<a id="L1925" name="L1925"></a>1925 
<a id="L1926" name="L1926"></a>1926     <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> scheme,
<a id="L1927" name="L1927"></a>1927                             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> opaquePart,
<a id="L1928" name="L1928"></a>1928                             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> authority,
<a id="L1929" name="L1929"></a>1929                             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> userInfo,
<a id="L1930" name="L1930"></a>1930                             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> host,
<a id="L1931" name="L1931"></a>1931                             <strong class="reserved">int</strong> port,
<a id="L1932" name="L1932"></a>1932                             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path,
<a id="L1933" name="L1933"></a>1933                             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>,
<a id="L1934" name="L1934"></a>1934                             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fragment)
<a id="L1935" name="L1935"></a>1935     <em class="brace">{</em>
<a id="L1936" name="L1936"></a>1936         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L1937" name="L1937"></a>1937         <strong class="reserved">if</strong> (scheme != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1938" name="L1938"></a>1938             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(scheme);
<a id="L1939" name="L1939"></a>1939             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(':');
<a id="L1940" name="L1940"></a>1940         <em class="brace">}</em>
<a id="L1941" name="L1941"></a>1941         <a href="../S/804.html#L1878" title="Defined at 1878 in src/java/net/URI.java.">appendSchemeSpecificPart</a>(sb, opaquePart,
<a id="L1942" name="L1942"></a>1942                                  authority, userInfo, host, port,
<a id="L1943" name="L1943"></a>1943                                  path, <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>);
<a id="L1944" name="L1944"></a>1944         <a href="../S/804.html#L1919" title="Defined at 1919 in src/java/net/URI.java.">appendFragment</a>(sb, fragment);
<a id="L1945" name="L1945"></a>1945         <strong class="reserved">return</strong> sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L1946" name="L1946"></a>1946     <em class="brace">}</em>
<a id="L1947" name="L1947"></a>1947 
<a id="L1948" name="L1948"></a>1948     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/804.html#L1147" title="Referred from 1147 in src/java/net/URI.java.">defineSchemeSpecificPart</a>() <em class="brace">{</em>
<a id="L1949" name="L1949"></a>1949         <strong class="reserved">if</strong> (schemeSpecificPart != <strong class="reserved">null</strong>) <strong class="reserved">return</strong>;
<a id="L1950" name="L1950"></a>1950         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L1951" name="L1951"></a>1951         <a href="../S/804.html#L1878" title="Defined at 1878 in src/java/net/URI.java.">appendSchemeSpecificPart</a>(sb, <strong class="reserved">null</strong>, <a href="../D/17127.html" title="Multiple defined in 3 places.">getAuthority</a>(), <a href="../D/23491.html" title="Multiple defined in 2 places.">getUserInfo</a>(),
<a id="L1952" name="L1952"></a>1952                                  host, port, <a href="../D/21434.html" title="Multiple defined in 38 places.">getPath</a>(), <a href="../D/21802.html" title="Multiple defined in 3 places.">getQuery</a>());
<a id="L1953" name="L1953"></a>1953         <strong class="reserved">if</strong> (sb.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 0) <strong class="reserved">return</strong>;
<a id="L1954" name="L1954"></a>1954         schemeSpecificPart = sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L1955" name="L1955"></a>1955     <em class="brace">}</em>
<a id="L1956" name="L1956"></a>1956 
<a id="L1957" name="L1957"></a>1957     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/13185.html" title="Multiple referred from 4 places.">defineString</a>() <em class="brace">{</em>
<a id="L1958" name="L1958"></a>1958         <strong class="reserved">if</strong> (<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> != <strong class="reserved">null</strong>) <strong class="reserved">return</strong>;
<a id="L1959" name="L1959"></a>1959 
<a id="L1960" name="L1960"></a>1960         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L1961" name="L1961"></a>1961         <strong class="reserved">if</strong> (scheme != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1962" name="L1962"></a>1962             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(scheme);
<a id="L1963" name="L1963"></a>1963             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(':');
<a id="L1964" name="L1964"></a>1964         <em class="brace">}</em>
<a id="L1965" name="L1965"></a>1965         <strong class="reserved">if</strong> (<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>()) <em class="brace">{</em>
<a id="L1966" name="L1966"></a>1966             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(schemeSpecificPart);
<a id="L1967" name="L1967"></a>1967         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1968" name="L1968"></a>1968             <strong class="reserved">if</strong> (host != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1969" name="L1969"></a>1969                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("//");
<a id="L1970" name="L1970"></a>1970                 <strong class="reserved">if</strong> (userInfo != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1971" name="L1971"></a>1971                     sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(userInfo);
<a id="L1972" name="L1972"></a>1972                     sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('@');
<a id="L1973" name="L1973"></a>1973                 <em class="brace">}</em>
<a id="L1974" name="L1974"></a>1974                 <strong class="reserved">boolean</strong> needBrackets = ((host.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(':') &gt;= 0)
<a id="L1975" name="L1975"></a>1975                                     &amp;&amp; !host.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>("[")
<a id="L1976" name="L1976"></a>1976                                     &amp;&amp; !host.<a href="../D/15495.html" title="Multiple defined in 12 places.">endsWith</a>("]"));
<a id="L1977" name="L1977"></a>1977                 <strong class="reserved">if</strong> (needBrackets) sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('[');
<a id="L1978" name="L1978"></a>1978                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(host);
<a id="L1979" name="L1979"></a>1979                 <strong class="reserved">if</strong> (needBrackets) sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(']');
<a id="L1980" name="L1980"></a>1980                 <strong class="reserved">if</strong> (port != -1) <em class="brace">{</em>
<a id="L1981" name="L1981"></a>1981                     sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(':');
<a id="L1982" name="L1982"></a>1982                     sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(port);
<a id="L1983" name="L1983"></a>1983                 <em class="brace">}</em>
<a id="L1984" name="L1984"></a>1984             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (authority != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1985" name="L1985"></a>1985                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("//");
<a id="L1986" name="L1986"></a>1986                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(authority);
<a id="L1987" name="L1987"></a>1987             <em class="brace">}</em>
<a id="L1988" name="L1988"></a>1988             <strong class="reserved">if</strong> (path != <strong class="reserved">null</strong>)
<a id="L1989" name="L1989"></a>1989                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(path);
<a id="L1990" name="L1990"></a>1990             <strong class="reserved">if</strong> (<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1991" name="L1991"></a>1991                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('?');
<a id="L1992" name="L1992"></a>1992                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>);
<a id="L1993" name="L1993"></a>1993             <em class="brace">}</em>
<a id="L1994" name="L1994"></a>1994         <em class="brace">}</em>
<a id="L1995" name="L1995"></a>1995         <strong class="reserved">if</strong> (fragment != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1996" name="L1996"></a>1996             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('#');
<a id="L1997" name="L1997"></a>1997             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(fragment);
<a id="L1998" name="L1998"></a>1998         <em class="brace">}</em>
<a id="L1999" name="L1999"></a>1999         <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> = sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L2000" name="L2000"></a>2000     <em class="brace">}</em>
<a id="L2001" name="L2001"></a>2001 
<a id="L2002" name="L2002"></a>2002 
<a id="L2003" name="L2003"></a>2003     <em class="comment">// -- Normalization, resolution, and relativization --</em>
<a id="L2004" name="L2004"></a>2004 
<a id="L2005" name="L2005"></a>2005     <em class="comment">// RFC2396 5.2 (6)</em>
<a id="L2006" name="L2006"></a>2006     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/804.html#L2085" title="Referred from 2085 in src/java/net/URI.java.">resolvePath</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> base, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> child,
<a id="L2007" name="L2007"></a>2007                                       <strong class="reserved">boolean</strong> <a href="../S/2602.html#L1222" title="Defined at 1222 in src/java/sql/ResultSet.java.">absolute</a>)
<a id="L2008" name="L2008"></a>2008     <em class="brace">{</em>
<a id="L2009" name="L2009"></a>2009         <strong class="reserved">int</strong> i = base.<a href="../D/26748.html" title="Multiple defined in 44 places.">lastIndexOf</a>('/');
<a id="L2010" name="L2010"></a>2010         <strong class="reserved">int</strong> cn = child.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L2011" name="L2011"></a>2011         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path = "";
<a id="L2012" name="L2012"></a>2012 
<a id="L2013" name="L2013"></a>2013         <strong class="reserved">if</strong> (cn == 0) <em class="brace">{</em>
<a id="L2014" name="L2014"></a>2014             <em class="comment">// 5.2 (6a)</em>
<a id="L2015" name="L2015"></a>2015             <strong class="reserved">if</strong> (i &gt;= 0)
<a id="L2016" name="L2016"></a>2016                 path = base.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, i + 1);
<a id="L2017" name="L2017"></a>2017         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2018" name="L2018"></a>2018             <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>(base.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() + cn);
<a id="L2019" name="L2019"></a>2019             <em class="comment">// 5.2 (6a)</em>
<a id="L2020" name="L2020"></a>2020             <strong class="reserved">if</strong> (i &gt;= 0)
<a id="L2021" name="L2021"></a>2021                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(base.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, i + 1));
<a id="L2022" name="L2022"></a>2022             <em class="comment">// 5.2 (6b)</em>
<a id="L2023" name="L2023"></a>2023             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(child);
<a id="L2024" name="L2024"></a>2024             path = sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L2025" name="L2025"></a>2025         <em class="brace">}</em>
<a id="L2026" name="L2026"></a>2026 
<a id="L2027" name="L2027"></a>2027         <em class="comment">// 5.2 (6c-f)</em>
<a id="L2028" name="L2028"></a>2028         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> np = <a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(path);
<a id="L2029" name="L2029"></a>2029 
<a id="L2030" name="L2030"></a>2030         <em class="comment">// 5.2 (6g): If the result is absolute but the path begins with "../",</em>
<a id="L2031" name="L2031"></a>2031         <em class="comment">// then we simply leave the path as-is</em>
<a id="L2032" name="L2032"></a>2032 
<a id="L2033" name="L2033"></a>2033         <strong class="reserved">return</strong> np;
<a id="L2034" name="L2034"></a>2034     <em class="brace">}</em>
<a id="L2035" name="L2035"></a>2035 
<a id="L2036" name="L2036"></a>2036     <em class="comment">// RFC2396 5.2</em>
<a id="L2037" name="L2037"></a>2037     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/26316.html" title="Multiple referred from 78 places.">resolve</a>(<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> base, <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> child) <em class="brace">{</em>
<a id="L2038" name="L2038"></a>2038         <em class="comment">// check if child if opaque first so that NPE is thrown</em>
<a id="L2039" name="L2039"></a>2039         <em class="comment">// if child is null.</em>
<a id="L2040" name="L2040"></a>2040         <strong class="reserved">if</strong> (child.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>() || base.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>())
<a id="L2041" name="L2041"></a>2041             <strong class="reserved">return</strong> child;
<a id="L2042" name="L2042"></a>2042 
<a id="L2043" name="L2043"></a>2043         <em class="comment">// 5.2 (2): Reference to current document (lone fragment)</em>
<a id="L2044" name="L2044"></a>2044         <strong class="reserved">if</strong> ((child.scheme == <strong class="reserved">null</strong>) &amp;&amp; (child.authority == <strong class="reserved">null</strong>)
<a id="L2045" name="L2045"></a>2045             &amp;&amp; child.path.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("") &amp;&amp; (child.fragment != <strong class="reserved">null</strong>)
<a id="L2046" name="L2046"></a>2046             &amp;&amp; (child.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> == <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L2047" name="L2047"></a>2047             <strong class="reserved">if</strong> ((base.fragment != <strong class="reserved">null</strong>)
<a id="L2048" name="L2048"></a>2048                 &amp;&amp; child.fragment.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(base.fragment)) <em class="brace">{</em>
<a id="L2049" name="L2049"></a>2049                 <strong class="reserved">return</strong> base;
<a id="L2050" name="L2050"></a>2050             <em class="brace">}</em>
<a id="L2051" name="L2051"></a>2051             <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> ru = <strong class="reserved">new</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>();
<a id="L2052" name="L2052"></a>2052             ru.scheme = base.scheme;
<a id="L2053" name="L2053"></a>2053             ru.authority = base.authority;
<a id="L2054" name="L2054"></a>2054             ru.userInfo = base.userInfo;
<a id="L2055" name="L2055"></a>2055             ru.host = base.host;
<a id="L2056" name="L2056"></a>2056             ru.port = base.port;
<a id="L2057" name="L2057"></a>2057             ru.path = base.path;
<a id="L2058" name="L2058"></a>2058             ru.fragment = child.fragment;
<a id="L2059" name="L2059"></a>2059             ru.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> = base.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>;
<a id="L2060" name="L2060"></a>2060             <strong class="reserved">return</strong> ru;
<a id="L2061" name="L2061"></a>2061         <em class="brace">}</em>
<a id="L2062" name="L2062"></a>2062 
<a id="L2063" name="L2063"></a>2063         <em class="comment">// 5.2 (3): Child is absolute</em>
<a id="L2064" name="L2064"></a>2064         <strong class="reserved">if</strong> (child.scheme != <strong class="reserved">null</strong>)
<a id="L2065" name="L2065"></a>2065             <strong class="reserved">return</strong> child;
<a id="L2066" name="L2066"></a>2066 
<a id="L2067" name="L2067"></a>2067         <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> ru = <strong class="reserved">new</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>();             <em class="comment">// Resolved URI</em>
<a id="L2068" name="L2068"></a>2068         ru.scheme = base.scheme;
<a id="L2069" name="L2069"></a>2069         ru.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> = child.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>;
<a id="L2070" name="L2070"></a>2070         ru.fragment = child.fragment;
<a id="L2071" name="L2071"></a>2071 
<a id="L2072" name="L2072"></a>2072         <em class="comment">// 5.2 (4): Authority</em>
<a id="L2073" name="L2073"></a>2073         <strong class="reserved">if</strong> (child.authority == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2074" name="L2074"></a>2074             ru.authority = base.authority;
<a id="L2075" name="L2075"></a>2075             ru.host = base.host;
<a id="L2076" name="L2076"></a>2076             ru.userInfo = base.userInfo;
<a id="L2077" name="L2077"></a>2077             ru.port = base.port;
<a id="L2078" name="L2078"></a>2078 
<a id="L2079" name="L2079"></a>2079             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> cp = (child.path == <strong class="reserved">null</strong>) ? "" : child.path;
<a id="L2080" name="L2080"></a>2080             <strong class="reserved">if</strong> ((cp.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt; 0) &amp;&amp; (cp.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0) == '/')) <em class="brace">{</em>
<a id="L2081" name="L2081"></a>2081                 <em class="comment">// 5.2 (5): Child path is absolute</em>
<a id="L2082" name="L2082"></a>2082                 ru.path = child.path;
<a id="L2083" name="L2083"></a>2083             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2084" name="L2084"></a>2084                 <em class="comment">// 5.2 (6): Resolve relative path</em>
<a id="L2085" name="L2085"></a>2085                 ru.path = <a href="../S/804.html#L2006" title="Defined at 2006 in src/java/net/URI.java.">resolvePath</a>(base.path, cp, base.<a href="../D/25141.html" title="Multiple defined in 6 places.">isAbsolute</a>());
<a id="L2086" name="L2086"></a>2086             <em class="brace">}</em>
<a id="L2087" name="L2087"></a>2087         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2088" name="L2088"></a>2088             ru.authority = child.authority;
<a id="L2089" name="L2089"></a>2089             ru.host = child.host;
<a id="L2090" name="L2090"></a>2090             ru.userInfo = child.userInfo;
<a id="L2091" name="L2091"></a>2091             ru.host = child.host;
<a id="L2092" name="L2092"></a>2092             ru.port = child.port;
<a id="L2093" name="L2093"></a>2093             ru.path = child.path;
<a id="L2094" name="L2094"></a>2094         <em class="brace">}</em>
<a id="L2095" name="L2095"></a>2095 
<a id="L2096" name="L2096"></a>2096         <em class="comment">// 5.2 (7): Recombine (nothing to do here)</em>
<a id="L2097" name="L2097"></a>2097         <strong class="reserved">return</strong> ru;
<a id="L2098" name="L2098"></a>2098     <em class="brace">}</em>
<a id="L2099" name="L2099"></a>2099 
<a id="L2100" name="L2100"></a>2100     <em class="comment">// If the given URI's path is normal then return the URI;</em>
<a id="L2101" name="L2101"></a>2101     <em class="comment">// o.w., return a new URI containing the normalized path.</em>
<a id="L2102" name="L2102"></a>2102     <em class="comment">//</em>
<a id="L2103" name="L2103"></a>2103     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/23781.html" title="Multiple referred from 143 places.">normalize</a>(<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>) <em class="brace">{</em>
<a id="L2104" name="L2104"></a>2104         <strong class="reserved">if</strong> (<a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>() || (<a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.path == <strong class="reserved">null</strong>) || (<a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 0))
<a id="L2105" name="L2105"></a>2105             <strong class="reserved">return</strong> <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>;
<a id="L2106" name="L2106"></a>2106 
<a id="L2107" name="L2107"></a>2107         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> np = <a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(<a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.path);
<a id="L2108" name="L2108"></a>2108         <strong class="reserved">if</strong> (np == <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.path)
<a id="L2109" name="L2109"></a>2109             <strong class="reserved">return</strong> <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>;
<a id="L2110" name="L2110"></a>2110 
<a id="L2111" name="L2111"></a>2111         <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> v = <strong class="reserved">new</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>();
<a id="L2112" name="L2112"></a>2112         v.scheme = <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.scheme;
<a id="L2113" name="L2113"></a>2113         v.fragment = <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.fragment;
<a id="L2114" name="L2114"></a>2114         v.authority = <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.authority;
<a id="L2115" name="L2115"></a>2115         v.userInfo = <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.userInfo;
<a id="L2116" name="L2116"></a>2116         v.host = <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.host;
<a id="L2117" name="L2117"></a>2117         v.port = <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.port;
<a id="L2118" name="L2118"></a>2118         v.path = np;
<a id="L2119" name="L2119"></a>2119         v.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> = <a href="../S/986.html#L3242" title="Defined at 3242 in src/java/util/regex/Pattern.java.">u</a>.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>;
<a id="L2120" name="L2120"></a>2120         <strong class="reserved">return</strong> v;
<a id="L2121" name="L2121"></a>2121     <em class="brace">}</em>
<a id="L2122" name="L2122"></a>2122 
<a id="L2123" name="L2123"></a>2123     <em class="comment">// If both URIs are hierarchical, their scheme and authority components are</em>
<a id="L2124" name="L2124"></a>2124     <em class="comment">// identical, and the base path is a prefix of the child's path, then</em>
<a id="L2125" name="L2125"></a>2125     <em class="comment">// return a relative URI that, when resolved against the base, yields the</em>
<a id="L2126" name="L2126"></a>2126     <em class="comment">// child; otherwise, return the child.</em>
<a id="L2127" name="L2127"></a>2127     <em class="comment">//</em>
<a id="L2128" name="L2128"></a>2128     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> <a href="../R/25845.html" title="Multiple referred from 2 places.">relativize</a>(<a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> base, <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> child) <em class="brace">{</em>
<a id="L2129" name="L2129"></a>2129         <em class="comment">// check if child if opaque first so that NPE is thrown</em>
<a id="L2130" name="L2130"></a>2130         <em class="comment">// if child is null.</em>
<a id="L2131" name="L2131"></a>2131         <strong class="reserved">if</strong> (child.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>() || base.<a href="../D/25996.html" title="Multiple defined in 14 places.">isOpaque</a>())
<a id="L2132" name="L2132"></a>2132             <strong class="reserved">return</strong> child;
<a id="L2133" name="L2133"></a>2133         <strong class="reserved">if</strong> (!<a href="../S/804.html#L1730" title="Defined at 1730 in src/java/net/URI.java.">equalIgnoringCase</a>(base.scheme, child.scheme)
<a id="L2134" name="L2134"></a>2134             || !<a href="../D/15675.html" title="Multiple defined in 20 places.">equal</a>(base.authority, child.authority))
<a id="L2135" name="L2135"></a>2135             <strong class="reserved">return</strong> child;
<a id="L2136" name="L2136"></a>2136 
<a id="L2137" name="L2137"></a>2137         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> bp = <a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(base.path);
<a id="L2138" name="L2138"></a>2138         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> cp = <a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(child.path);
<a id="L2139" name="L2139"></a>2139         <strong class="reserved">if</strong> (!bp.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(cp)) <em class="brace">{</em>
<a id="L2140" name="L2140"></a>2140             <strong class="reserved">if</strong> (!bp.<a href="../D/15495.html" title="Multiple defined in 12 places.">endsWith</a>("/"))
<a id="L2141" name="L2141"></a>2141                 bp = bp + "/";
<a id="L2142" name="L2142"></a>2142             <strong class="reserved">if</strong> (!cp.<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>(bp))
<a id="L2143" name="L2143"></a>2143                 <strong class="reserved">return</strong> child;
<a id="L2144" name="L2144"></a>2144         <em class="brace">}</em>
<a id="L2145" name="L2145"></a>2145 
<a id="L2146" name="L2146"></a>2146         <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a> v = <strong class="reserved">new</strong> <a href="../D/9247.html" title="Multiple defined in 4 places.">URI</a>();
<a id="L2147" name="L2147"></a>2147         v.path = cp.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(bp.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L2148" name="L2148"></a>2148         v.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> = child.<a href="../D/30057.html" title="Multiple defined in 20 places.">query</a>;
<a id="L2149" name="L2149"></a>2149         v.fragment = child.fragment;
<a id="L2150" name="L2150"></a>2150         <strong class="reserved">return</strong> v;
<a id="L2151" name="L2151"></a>2151     <em class="brace">}</em>
<a id="L2152" name="L2152"></a>2152 
<a id="L2153" name="L2153"></a>2153 
<a id="L2154" name="L2154"></a>2154 
<a id="L2155" name="L2155"></a>2155     <em class="comment">// -- Path normalization --</em>
<a id="L2156" name="L2156"></a>2156 
<a id="L2157" name="L2157"></a>2157     <em class="comment">// The following algorithm for path normalization avoids the creation of a</em>
<a id="L2158" name="L2158"></a>2158     <em class="comment">// string object for each segment, as well as the use of a string buffer to</em>
<a id="L2159" name="L2159"></a>2159     <em class="comment">// compute the final result, by using a single char array and editing it in</em>
<a id="L2160" name="L2160"></a>2160     <em class="comment">// place.  The array is first split into segments, replacing each slash</em>
<a id="L2161" name="L2161"></a>2161     <em class="comment">// with '\0' and creating a segment-index array, each element of which is</em>
<a id="L2162" name="L2162"></a>2162     <em class="comment">// the index of the first char in the corresponding segment.  We then walk</em>
<a id="L2163" name="L2163"></a>2163     <em class="comment">// through both arrays, removing ".", "..", and other segments as necessary</em>
<a id="L2164" name="L2164"></a>2164     <em class="comment">// by setting their entries in the index array to -1.  Finally, the two</em>
<a id="L2165" name="L2165"></a>2165     <em class="comment">// arrays are used to rejoin the segments and compute the final result.</em>
<a id="L2166" name="L2166"></a>2166     <em class="comment">//</em>
<a id="L2167" name="L2167"></a>2167     <em class="comment">// This code is based upon src/solaris/native/java/io/canonicalize_md.c</em>
<a id="L2168" name="L2168"></a>2168 
<a id="L2169" name="L2169"></a>2169 
<a id="L2170" name="L2170"></a>2170     <em class="comment">// Check the given path to see if it might need normalization.  A path</em>
<a id="L2171" name="L2171"></a>2171     <em class="comment">// might need normalization if it contains duplicate slashes, a "."</em>
<a id="L2172" name="L2172"></a>2172     <em class="comment">// segment, or a ".." segment.  Return -1 if no further normalization is</em>
<a id="L2173" name="L2173"></a>2173     <em class="comment">// possible, otherwise return the number of segments found.</em>
<a id="L2174" name="L2174"></a>2174     <em class="comment">//</em>
<a id="L2175" name="L2175"></a>2175     <em class="comment">// This method takes a string argument rather than a char array so that</em>
<a id="L2176" name="L2176"></a>2176     <em class="comment">// this test can be performed without invoking path.toCharArray().</em>
<a id="L2177" name="L2177"></a>2177     <em class="comment">//</em>
<a id="L2178" name="L2178"></a>2178     <strong class="reserved">static</strong> <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../S/804.html#L2425" title="Referred from 2425 in src/java/net/URI.java.">needsNormalization</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> path) <em class="brace">{</em>
<a id="L2179" name="L2179"></a>2179         <strong class="reserved">boolean</strong> normal = <strong class="reserved">true</strong>;
<a id="L2180" name="L2180"></a>2180         <strong class="reserved">int</strong> ns = 0;                     <em class="comment">// Number of segments</em>
<a id="L2181" name="L2181"></a>2181         <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() - 1;    <em class="comment">// Index of last char in path</em>
<a id="L2182" name="L2182"></a>2182         <strong class="reserved">int</strong> p = 0;                      <em class="comment">// Index of next char in path</em>
<a id="L2183" name="L2183"></a>2183 
<a id="L2184" name="L2184"></a>2184         <em class="comment">// Skip initial slashes</em>
<a id="L2185" name="L2185"></a>2185         <strong class="reserved">while</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2186" name="L2186"></a>2186             <strong class="reserved">if</strong> (path.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p) != '/') <strong class="reserved">break</strong>;
<a id="L2187" name="L2187"></a>2187             p++;
<a id="L2188" name="L2188"></a>2188         <em class="brace">}</em>
<a id="L2189" name="L2189"></a>2189         <strong class="reserved">if</strong> (p &gt; 1) normal = <strong class="reserved">false</strong>;
<a id="L2190" name="L2190"></a>2190 
<a id="L2191" name="L2191"></a>2191         <em class="comment">// Scan segments</em>
<a id="L2192" name="L2192"></a>2192         <strong class="reserved">while</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2193" name="L2193"></a>2193 
<a id="L2194" name="L2194"></a>2194             <em class="comment">// Looking at "." or ".." ?</em>
<a id="L2195" name="L2195"></a>2195             <strong class="reserved">if</strong> ((path.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p) == '.')
<a id="L2196" name="L2196"></a>2196                 &amp;&amp; ((p == <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>)
<a id="L2197" name="L2197"></a>2197                     || ((path.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p + 1) == '/')
<a id="L2198" name="L2198"></a>2198                         || ((path.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p + 1) == '.')
<a id="L2199" name="L2199"></a>2199                             &amp;&amp; ((p + 1 == <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>)
<a id="L2200" name="L2200"></a>2200                                 || (path.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p + 2) == '/')))))) <em class="brace">{</em>
<a id="L2201" name="L2201"></a>2201                 normal = <strong class="reserved">false</strong>;
<a id="L2202" name="L2202"></a>2202             <em class="brace">}</em>
<a id="L2203" name="L2203"></a>2203             ns++;
<a id="L2204" name="L2204"></a>2204 
<a id="L2205" name="L2205"></a>2205             <em class="comment">// Find beginning of next segment</em>
<a id="L2206" name="L2206"></a>2206             <strong class="reserved">while</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2207" name="L2207"></a>2207                 <strong class="reserved">if</strong> (path.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p++) != '/')
<a id="L2208" name="L2208"></a>2208                     <strong class="reserved">continue</strong>;
<a id="L2209" name="L2209"></a>2209 
<a id="L2210" name="L2210"></a>2210                 <em class="comment">// Skip redundant slashes</em>
<a id="L2211" name="L2211"></a>2211                 <strong class="reserved">while</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2212" name="L2212"></a>2212                     <strong class="reserved">if</strong> (path.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p) != '/') <strong class="reserved">break</strong>;
<a id="L2213" name="L2213"></a>2213                     normal = <strong class="reserved">false</strong>;
<a id="L2214" name="L2214"></a>2214                     p++;
<a id="L2215" name="L2215"></a>2215                 <em class="brace">}</em>
<a id="L2216" name="L2216"></a>2216 
<a id="L2217" name="L2217"></a>2217                 <strong class="reserved">break</strong>;
<a id="L2218" name="L2218"></a>2218             <em class="brace">}</em>
<a id="L2219" name="L2219"></a>2219         <em class="brace">}</em>
<a id="L2220" name="L2220"></a>2220 
<a id="L2221" name="L2221"></a>2221         <strong class="reserved">return</strong> normal ? -1 : ns;
<a id="L2222" name="L2222"></a>2222     <em class="brace">}</em>
<a id="L2223" name="L2223"></a>2223 
<a id="L2224" name="L2224"></a>2224 
<a id="L2225" name="L2225"></a>2225     <em class="comment">// Split the given path into segments, replacing slashes with nulls and</em>
<a id="L2226" name="L2226"></a>2226     <em class="comment">// filling in the given segment-index array.</em>
<a id="L2227" name="L2227"></a>2227     <em class="comment">//</em>
<a id="L2228" name="L2228"></a>2228     <em class="comment">// Preconditions:</em>
<a id="L2229" name="L2229"></a>2229     <em class="comment">//   segs.length == Number of segments in path</em>
<a id="L2230" name="L2230"></a>2230     <em class="comment">//</em>
<a id="L2231" name="L2231"></a>2231     <em class="comment">// Postconditions:</em>
<a id="L2232" name="L2232"></a>2232     <em class="comment">//   All slashes in path replaced by '\0'</em>
<a id="L2233" name="L2233"></a>2233     <em class="comment">//   segs[i] == Index of first char in segment i (0 &lt;= i &lt; segs.length)</em>
<a id="L2234" name="L2234"></a>2234     <em class="comment">//</em>
<a id="L2235" name="L2235"></a>2235     <strong class="reserved">static</strong> <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/28754.html" title="Multiple referred from 96 places.">split</a>(<strong class="reserved">char</strong>[] path, <strong class="reserved">int</strong>[] segs) <em class="brace">{</em>
<a id="L2236" name="L2236"></a>2236         <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - 1;      <em class="comment">// Index of last char in path</em>
<a id="L2237" name="L2237"></a>2237         <strong class="reserved">int</strong> p = 0;                      <em class="comment">// Index of next char in path</em>
<a id="L2238" name="L2238"></a>2238         <strong class="reserved">int</strong> i = 0;                      <em class="comment">// Index of current segment</em>
<a id="L2239" name="L2239"></a>2239 
<a id="L2240" name="L2240"></a>2240         <em class="comment">// Skip initial slashes</em>
<a id="L2241" name="L2241"></a>2241         <strong class="reserved">while</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2242" name="L2242"></a>2242             <strong class="reserved">if</strong> (path[p] != '/') <strong class="reserved">break</strong>;
<a id="L2243" name="L2243"></a>2243             path[p] = '\0';
<a id="L2244" name="L2244"></a>2244             p++;
<a id="L2245" name="L2245"></a>2245         <em class="brace">}</em>
<a id="L2246" name="L2246"></a>2246 
<a id="L2247" name="L2247"></a>2247         <strong class="reserved">while</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2248" name="L2248"></a>2248 
<a id="L2249" name="L2249"></a>2249             <em class="comment">// Note start of segment</em>
<a id="L2250" name="L2250"></a>2250             segs[i++] = p++;
<a id="L2251" name="L2251"></a>2251 
<a id="L2252" name="L2252"></a>2252             <em class="comment">// Find beginning of next segment</em>
<a id="L2253" name="L2253"></a>2253             <strong class="reserved">while</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2254" name="L2254"></a>2254                 <strong class="reserved">if</strong> (path[p++] != '/')
<a id="L2255" name="L2255"></a>2255                     <strong class="reserved">continue</strong>;
<a id="L2256" name="L2256"></a>2256                 path[p - 1] = '\0';
<a id="L2257" name="L2257"></a>2257 
<a id="L2258" name="L2258"></a>2258                 <em class="comment">// Skip redundant slashes</em>
<a id="L2259" name="L2259"></a>2259                 <strong class="reserved">while</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2260" name="L2260"></a>2260                     <strong class="reserved">if</strong> (path[p] != '/') <strong class="reserved">break</strong>;
<a id="L2261" name="L2261"></a>2261                     path[p++] = '\0';
<a id="L2262" name="L2262"></a>2262                 <em class="brace">}</em>
<a id="L2263" name="L2263"></a>2263                 <strong class="reserved">break</strong>;
<a id="L2264" name="L2264"></a>2264             <em class="brace">}</em>
<a id="L2265" name="L2265"></a>2265         <em class="brace">}</em>
<a id="L2266" name="L2266"></a>2266 
<a id="L2267" name="L2267"></a>2267         <strong class="reserved">if</strong> (i != segs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>)
<a id="L2268" name="L2268"></a>2268             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>();  <em class="comment">// ASSERT</em>
<a id="L2269" name="L2269"></a>2269     <em class="brace">}</em>
<a id="L2270" name="L2270"></a>2270 
<a id="L2271" name="L2271"></a>2271 
<a id="L2272" name="L2272"></a>2272     <em class="comment">// Join the segments in the given path according to the given segment-index</em>
<a id="L2273" name="L2273"></a>2273     <em class="comment">// array, ignoring those segments whose index entries have been set to -1,</em>
<a id="L2274" name="L2274"></a>2274     <em class="comment">// and inserting slashes as needed.  Return the length of the resulting</em>
<a id="L2275" name="L2275"></a>2275     <em class="comment">// path.</em>
<a id="L2276" name="L2276"></a>2276     <em class="comment">//</em>
<a id="L2277" name="L2277"></a>2277     <em class="comment">// Preconditions:</em>
<a id="L2278" name="L2278"></a>2278     <em class="comment">//   segs[i] == -1 implies segment i is to be ignored</em>
<a id="L2279" name="L2279"></a>2279     <em class="comment">//   path computed by split, as above, with '\0' having replaced '/'</em>
<a id="L2280" name="L2280"></a>2280     <em class="comment">//</em>
<a id="L2281" name="L2281"></a>2281     <em class="comment">// Postconditions:</em>
<a id="L2282" name="L2282"></a>2282     <em class="comment">//   path[0] .. path[return value] == Resulting path</em>
<a id="L2283" name="L2283"></a>2283     <em class="comment">//</em>
<a id="L2284" name="L2284"></a>2284     <strong class="reserved">static</strong> <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/22372.html" title="Multiple referred from 37 places.">join</a>(<strong class="reserved">char</strong>[] path, <strong class="reserved">int</strong>[] segs) <em class="brace">{</em>
<a id="L2285" name="L2285"></a>2285         <strong class="reserved">int</strong> ns = segs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;           <em class="comment">// Number of segments</em>
<a id="L2286" name="L2286"></a>2286         <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - 1;      <em class="comment">// Index of last char in path</em>
<a id="L2287" name="L2287"></a>2287         <strong class="reserved">int</strong> p = 0;                      <em class="comment">// Index of next path char to write</em>
<a id="L2288" name="L2288"></a>2288 
<a id="L2289" name="L2289"></a>2289         <strong class="reserved">if</strong> (path[p] == '\0') <em class="brace">{</em>
<a id="L2290" name="L2290"></a>2290             <em class="comment">// Restore initial slash for absolute paths</em>
<a id="L2291" name="L2291"></a>2291             path[p++] = '/';
<a id="L2292" name="L2292"></a>2292         <em class="brace">}</em>
<a id="L2293" name="L2293"></a>2293 
<a id="L2294" name="L2294"></a>2294         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; ns; i++) <em class="brace">{</em>
<a id="L2295" name="L2295"></a>2295             <strong class="reserved">int</strong> q = segs[i];            <em class="comment">// Current segment</em>
<a id="L2296" name="L2296"></a>2296             <strong class="reserved">if</strong> (q == -1)
<a id="L2297" name="L2297"></a>2297                 <em class="comment">// Ignore this segment</em>
<a id="L2298" name="L2298"></a>2298                 <strong class="reserved">continue</strong>;
<a id="L2299" name="L2299"></a>2299 
<a id="L2300" name="L2300"></a>2300             <strong class="reserved">if</strong> (p == q) <em class="brace">{</em>
<a id="L2301" name="L2301"></a>2301                 <em class="comment">// We're already at this segment, so just skip to its end</em>
<a id="L2302" name="L2302"></a>2302                 <strong class="reserved">while</strong> ((p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) &amp;&amp; (path[p] != '\0'))
<a id="L2303" name="L2303"></a>2303                     p++;
<a id="L2304" name="L2304"></a>2304                 <strong class="reserved">if</strong> (p &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2305" name="L2305"></a>2305                     <em class="comment">// Preserve trailing slash</em>
<a id="L2306" name="L2306"></a>2306                     path[p++] = '/';
<a id="L2307" name="L2307"></a>2307                 <em class="brace">}</em>
<a id="L2308" name="L2308"></a>2308             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p &lt; q) <em class="brace">{</em>
<a id="L2309" name="L2309"></a>2309                 <em class="comment">// Copy q down to p</em>
<a id="L2310" name="L2310"></a>2310                 <strong class="reserved">while</strong> ((q &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) &amp;&amp; (path[q] != '\0'))
<a id="L2311" name="L2311"></a>2311                     path[p++] = path[q++];
<a id="L2312" name="L2312"></a>2312                 <strong class="reserved">if</strong> (q &lt;= <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2313" name="L2313"></a>2313                     <em class="comment">// Preserve trailing slash</em>
<a id="L2314" name="L2314"></a>2314                     path[p++] = '/';
<a id="L2315" name="L2315"></a>2315                 <em class="brace">}</em>
<a id="L2316" name="L2316"></a>2316             <em class="brace">}</em> <strong class="reserved">else</strong>
<a id="L2317" name="L2317"></a>2317                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>(); <em class="comment">// ASSERT false</em>
<a id="L2318" name="L2318"></a>2318         <em class="brace">}</em>
<a id="L2319" name="L2319"></a>2319 
<a id="L2320" name="L2320"></a>2320         <strong class="reserved">return</strong> p;
<a id="L2321" name="L2321"></a>2321     <em class="brace">}</em>
<a id="L2322" name="L2322"></a>2322 
<a id="L2323" name="L2323"></a>2323 
<a id="L2324" name="L2324"></a>2324     <em class="comment">// Remove "." segments from the given path, and remove segment pairs</em>
<a id="L2325" name="L2325"></a>2325     <em class="comment">// consisting of a non-".." segment followed by a ".." segment.</em>
<a id="L2326" name="L2326"></a>2326     <em class="comment">//</em>
<a id="L2327" name="L2327"></a>2327     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/804.html#L2437" title="Referred from 2437 in src/java/net/URI.java.">removeDots</a>(<strong class="reserved">char</strong>[] path, <strong class="reserved">int</strong>[] segs) <em class="brace">{</em>
<a id="L2328" name="L2328"></a>2328         <strong class="reserved">int</strong> ns = segs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L2329" name="L2329"></a>2329         <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - 1;
<a id="L2330" name="L2330"></a>2330 
<a id="L2331" name="L2331"></a>2331         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; ns; i++) <em class="brace">{</em>
<a id="L2332" name="L2332"></a>2332             <strong class="reserved">int</strong> dots = 0;               <em class="comment">// Number of dots found (0, 1, or 2)</em>
<a id="L2333" name="L2333"></a>2333 
<a id="L2334" name="L2334"></a>2334             <em class="comment">// Find next occurrence of "." or ".."</em>
<a id="L2335" name="L2335"></a>2335             <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L2336" name="L2336"></a>2336                 <strong class="reserved">int</strong> p = segs[i];
<a id="L2337" name="L2337"></a>2337                 <strong class="reserved">if</strong> (path[p] == '.') <em class="brace">{</em>
<a id="L2338" name="L2338"></a>2338                     <strong class="reserved">if</strong> (p == <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2339" name="L2339"></a>2339                         dots = 1;
<a id="L2340" name="L2340"></a>2340                         <strong class="reserved">break</strong>;
<a id="L2341" name="L2341"></a>2341                     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (path[p + 1] == '\0') <em class="brace">{</em>
<a id="L2342" name="L2342"></a>2342                         dots = 1;
<a id="L2343" name="L2343"></a>2343                         <strong class="reserved">break</strong>;
<a id="L2344" name="L2344"></a>2344                     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((path[p + 1] == '.')
<a id="L2345" name="L2345"></a>2345                                &amp;&amp; ((p + 1 == <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>)
<a id="L2346" name="L2346"></a>2346                                    || (path[p + 2] == '\0'))) <em class="brace">{</em>
<a id="L2347" name="L2347"></a>2347                         dots = 2;
<a id="L2348" name="L2348"></a>2348                         <strong class="reserved">break</strong>;
<a id="L2349" name="L2349"></a>2349                     <em class="brace">}</em>
<a id="L2350" name="L2350"></a>2350                 <em class="brace">}</em>
<a id="L2351" name="L2351"></a>2351                 i++;
<a id="L2352" name="L2352"></a>2352             <em class="brace">}</em> <strong class="reserved">while</strong> (i &lt; ns);
<a id="L2353" name="L2353"></a>2353             <strong class="reserved">if</strong> ((i &gt; ns) || (dots == 0))
<a id="L2354" name="L2354"></a>2354                 <strong class="reserved">break</strong>;
<a id="L2355" name="L2355"></a>2355 
<a id="L2356" name="L2356"></a>2356             <strong class="reserved">if</strong> (dots == 1) <em class="brace">{</em>
<a id="L2357" name="L2357"></a>2357                 <em class="comment">// Remove this occurrence of "."</em>
<a id="L2358" name="L2358"></a>2358                 segs[i] = -1;
<a id="L2359" name="L2359"></a>2359             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2360" name="L2360"></a>2360                 <em class="comment">// If there is a preceding non-".." segment, remove both that</em>
<a id="L2361" name="L2361"></a>2361                 <em class="comment">// segment and this occurrence of ".."; otherwise, leave this</em>
<a id="L2362" name="L2362"></a>2362                 <em class="comment">// ".." segment as-is.</em>
<a id="L2363" name="L2363"></a>2363                 <strong class="reserved">int</strong> j;
<a id="L2364" name="L2364"></a>2364                 <strong class="reserved">for</strong> (j = i - 1; j &gt;= 0; j--) <em class="brace">{</em>
<a id="L2365" name="L2365"></a>2365                     <strong class="reserved">if</strong> (segs[j] != -1) <strong class="reserved">break</strong>;
<a id="L2366" name="L2366"></a>2366                 <em class="brace">}</em>
<a id="L2367" name="L2367"></a>2367                 <strong class="reserved">if</strong> (j &gt;= 0) <em class="brace">{</em>
<a id="L2368" name="L2368"></a>2368                     <strong class="reserved">int</strong> q = segs[j];
<a id="L2369" name="L2369"></a>2369                     <strong class="reserved">if</strong> (!((path[q] == '.')
<a id="L2370" name="L2370"></a>2370                           &amp;&amp; (path[q + 1] == '.')
<a id="L2371" name="L2371"></a>2371                           &amp;&amp; (path[q + 2] == '\0'))) <em class="brace">{</em>
<a id="L2372" name="L2372"></a>2372                         segs[i] = -1;
<a id="L2373" name="L2373"></a>2373                         segs[j] = -1;
<a id="L2374" name="L2374"></a>2374                     <em class="brace">}</em>
<a id="L2375" name="L2375"></a>2375                 <em class="brace">}</em>
<a id="L2376" name="L2376"></a>2376             <em class="brace">}</em>
<a id="L2377" name="L2377"></a>2377         <em class="brace">}</em>
<a id="L2378" name="L2378"></a>2378     <em class="brace">}</em>
<a id="L2379" name="L2379"></a>2379 
<a id="L2380" name="L2380"></a>2380 
<a id="L2381" name="L2381"></a>2381     <em class="comment">// DEVIATION: If the normalized path is relative, and if the first</em>
<a id="L2382" name="L2382"></a>2382     <em class="comment">// segment could be parsed as a scheme name, then prepend a "." segment</em>
<a id="L2383" name="L2383"></a>2383     <em class="comment">//</em>
<a id="L2384" name="L2384"></a>2384     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/804.html#L2440" title="Referred from 2440 in src/java/net/URI.java.">maybeAddLeadingDot</a>(<strong class="reserved">char</strong>[] path, <strong class="reserved">int</strong>[] segs) <em class="brace">{</em>
<a id="L2385" name="L2385"></a>2385 
<a id="L2386" name="L2386"></a>2386         <strong class="reserved">if</strong> (path[0] == '\0')
<a id="L2387" name="L2387"></a>2387             <em class="comment">// The path is absolute</em>
<a id="L2388" name="L2388"></a>2388             <strong class="reserved">return</strong>;
<a id="L2389" name="L2389"></a>2389 
<a id="L2390" name="L2390"></a>2390         <strong class="reserved">int</strong> ns = segs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L2391" name="L2391"></a>2391         <strong class="reserved">int</strong> f = 0;                      <em class="comment">// Index of first segment</em>
<a id="L2392" name="L2392"></a>2392         <strong class="reserved">while</strong> (f &lt; ns) <em class="brace">{</em>
<a id="L2393" name="L2393"></a>2393             <strong class="reserved">if</strong> (segs[f] &gt;= 0)
<a id="L2394" name="L2394"></a>2394                 <strong class="reserved">break</strong>;
<a id="L2395" name="L2395"></a>2395             f++;
<a id="L2396" name="L2396"></a>2396         <em class="brace">}</em>
<a id="L2397" name="L2397"></a>2397         <strong class="reserved">if</strong> ((f &gt;= ns) || (f == 0))
<a id="L2398" name="L2398"></a>2398             <em class="comment">// The path is empty, or else the original first segment survived,</em>
<a id="L2399" name="L2399"></a>2399             <em class="comment">// in which case we already know that no leading "." is needed</em>
<a id="L2400" name="L2400"></a>2400             <strong class="reserved">return</strong>;
<a id="L2401" name="L2401"></a>2401 
<a id="L2402" name="L2402"></a>2402         <strong class="reserved">int</strong> p = segs[f];
<a id="L2403" name="L2403"></a>2403         <strong class="reserved">while</strong> ((p &lt; path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) &amp;&amp; (path[p] != ':') &amp;&amp; (path[p] != '\0')) p++;
<a id="L2404" name="L2404"></a>2404         <strong class="reserved">if</strong> (p &gt;= path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> || path[p] == '\0')
<a id="L2405" name="L2405"></a>2405             <em class="comment">// No colon in first segment, so no "." needed</em>
<a id="L2406" name="L2406"></a>2406             <strong class="reserved">return</strong>;
<a id="L2407" name="L2407"></a>2407 
<a id="L2408" name="L2408"></a>2408         <em class="comment">// At this point we know that the first segment is unused,</em>
<a id="L2409" name="L2409"></a>2409         <em class="comment">// hence we can insert a "." segment at that position</em>
<a id="L2410" name="L2410"></a>2410         path[0] = '.';
<a id="L2411" name="L2411"></a>2411         path[1] = '\0';
<a id="L2412" name="L2412"></a>2412         segs[0] = 0;
<a id="L2413" name="L2413"></a>2413     <em class="brace">}</em>
<a id="L2414" name="L2414"></a>2414 
<a id="L2415" name="L2415"></a>2415 
<a id="L2416" name="L2416"></a>2416     <em class="comment">// Normalize the given path string.  A normal path string has no empty</em>
<a id="L2417" name="L2417"></a>2417     <em class="comment">// segments (i.e., occurrences of "//"), no segments equal to ".", and no</em>
<a id="L2418" name="L2418"></a>2418     <em class="comment">// segments equal to ".." that are preceded by a segment not equal to "..".</em>
<a id="L2419" name="L2419"></a>2419     <em class="comment">// In contrast to Unix-style pathname normalization, for URI paths we</em>
<a id="L2420" name="L2420"></a>2420     <em class="comment">// always retain trailing slashes.</em>
<a id="L2421" name="L2421"></a>2421     <em class="comment">//</em>
<a id="L2422" name="L2422"></a>2422     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/23781.html" title="Multiple referred from 143 places.">normalize</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> ps) <em class="brace">{</em>
<a id="L2423" name="L2423"></a>2423 
<a id="L2424" name="L2424"></a>2424         <em class="comment">// Does this path need normalization?</em>
<a id="L2425" name="L2425"></a>2425         <strong class="reserved">int</strong> ns = <a href="../S/804.html#L2178" title="Defined at 2178 in src/java/net/URI.java.">needsNormalization</a>(ps);        <em class="comment">// Number of segments</em>
<a id="L2426" name="L2426"></a>2426         <strong class="reserved">if</strong> (ns &lt; 0)
<a id="L2427" name="L2427"></a>2427             <em class="comment">// Nope -- just return it</em>
<a id="L2428" name="L2428"></a>2428             <strong class="reserved">return</strong> ps;
<a id="L2429" name="L2429"></a>2429 
<a id="L2430" name="L2430"></a>2430         <strong class="reserved">char</strong>[] path = ps.<a href="../D/35368.html" title="Multiple defined in 3 places.">toCharArray</a>();         <em class="comment">// Path in char-array form</em>
<a id="L2431" name="L2431"></a>2431 
<a id="L2432" name="L2432"></a>2432         <em class="comment">// Split path into segments</em>
<a id="L2433" name="L2433"></a>2433         <strong class="reserved">int</strong>[] segs = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[ns];               <em class="comment">// Segment-index array</em>
<a id="L2434" name="L2434"></a>2434         <a href="../D/34718.html" title="Multiple defined in 12 places.">split</a>(path, segs);
<a id="L2435" name="L2435"></a>2435 
<a id="L2436" name="L2436"></a>2436         <em class="comment">// Remove dots</em>
<a id="L2437" name="L2437"></a>2437         <a href="../S/804.html#L2327" title="Defined at 2327 in src/java/net/URI.java.">removeDots</a>(path, segs);
<a id="L2438" name="L2438"></a>2438 
<a id="L2439" name="L2439"></a>2439         <em class="comment">// Prevent scheme-name confusion</em>
<a id="L2440" name="L2440"></a>2440         <a href="../S/804.html#L2384" title="Defined at 2384 in src/java/net/URI.java.">maybeAddLeadingDot</a>(path, segs);
<a id="L2441" name="L2441"></a>2441 
<a id="L2442" name="L2442"></a>2442         <em class="comment">// Join the remaining segments and return the result</em>
<a id="L2443" name="L2443"></a>2443         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s = <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>(path, 0, <a href="../D/26697.html" title="Multiple defined in 17 places.">join</a>(path, segs));
<a id="L2444" name="L2444"></a>2444         <strong class="reserved">if</strong> (s.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(ps)) <em class="brace">{</em>
<a id="L2445" name="L2445"></a>2445             <em class="comment">// string was already normalized</em>
<a id="L2446" name="L2446"></a>2446             <strong class="reserved">return</strong> ps;
<a id="L2447" name="L2447"></a>2447         <em class="brace">}</em>
<a id="L2448" name="L2448"></a>2448         <strong class="reserved">return</strong> s;
<a id="L2449" name="L2449"></a>2449     <em class="brace">}</em>
<a id="L2450" name="L2450"></a>2450 
<a id="L2451" name="L2451"></a>2451 
<a id="L2452" name="L2452"></a>2452 
<a id="L2453" name="L2453"></a>2453     <em class="comment">// -- Character classes for parsing --</em>
<a id="L2454" name="L2454"></a>2454 
<a id="L2455" name="L2455"></a>2455     <em class="comment">// RFC2396 precisely specifies which characters in the US-ASCII charset are</em>
<a id="L2456" name="L2456"></a>2456     <em class="comment">// permissible in the various components of a URI reference.  We here</em>
<a id="L2457" name="L2457"></a>2457     <em class="comment">// define a set of mask pairs to aid in enforcing these restrictions.  Each</em>
<a id="L2458" name="L2458"></a>2458     <em class="comment">// mask pair consists of two longs, a low mask and a high mask.  Taken</em>
<a id="L2459" name="L2459"></a>2459     <em class="comment">// together they represent a 128-bit mask, where bit i is set iff the</em>
<a id="L2460" name="L2460"></a>2460     <em class="comment">// character with value i is permitted.</em>
<a id="L2461" name="L2461"></a>2461     <em class="comment">//</em>
<a id="L2462" name="L2462"></a>2462     <em class="comment">// This approach is more efficient than sequentially searching arrays of</em>
<a id="L2463" name="L2463"></a>2463     <em class="comment">// permitted characters.  It could be made still more efficient by</em>
<a id="L2464" name="L2464"></a>2464     <em class="comment">// precompiling the mask information so that a character's presence in a</em>
<a id="L2465" name="L2465"></a>2465     <em class="comment">// given mask could be determined by a single table lookup.</em>
<a id="L2466" name="L2466"></a>2466 
<a id="L2467" name="L2467"></a>2467     <em class="comment">// Compute the low-order mask for the characters in the given string</em>
<a id="L2468" name="L2468"></a>2468     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">long</strong> <a href="../R/22792.html" title="Multiple referred from 26 places.">lowMask</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>) <em class="brace">{</em>
<a id="L2469" name="L2469"></a>2469         <strong class="reserved">int</strong> n = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L2470" name="L2470"></a>2470         <strong class="reserved">long</strong> m = 0;
<a id="L2471" name="L2471"></a>2471         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L2472" name="L2472"></a>2472             <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L2473" name="L2473"></a>2473             <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 64)
<a id="L2474" name="L2474"></a>2474                 m |= (1L &lt;&lt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L2475" name="L2475"></a>2475         <em class="brace">}</em>
<a id="L2476" name="L2476"></a>2476         <strong class="reserved">return</strong> m;
<a id="L2477" name="L2477"></a>2477     <em class="brace">}</em>
<a id="L2478" name="L2478"></a>2478 
<a id="L2479" name="L2479"></a>2479     <em class="comment">// Compute the high-order mask for the characters in the given string</em>
<a id="L2480" name="L2480"></a>2480     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">long</strong> <a href="../R/20330.html" title="Multiple referred from 28 places.">highMask</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>) <em class="brace">{</em>
<a id="L2481" name="L2481"></a>2481         <strong class="reserved">int</strong> n = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L2482" name="L2482"></a>2482         <strong class="reserved">long</strong> m = 0;
<a id="L2483" name="L2483"></a>2483         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L2484" name="L2484"></a>2484             <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L2485" name="L2485"></a>2485             <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 64) &amp;&amp; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 128))
<a id="L2486" name="L2486"></a>2486                 m |= (1L &lt;&lt; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> - 64));
<a id="L2487" name="L2487"></a>2487         <em class="brace">}</em>
<a id="L2488" name="L2488"></a>2488         <strong class="reserved">return</strong> m;
<a id="L2489" name="L2489"></a>2489     <em class="brace">}</em>
<a id="L2490" name="L2490"></a>2490 
<a id="L2491" name="L2491"></a>2491     <em class="comment">// Compute a low-order mask for the characters</em>
<a id="L2492" name="L2492"></a>2492     <em class="comment">// between first and last, inclusive</em>
<a id="L2493" name="L2493"></a>2493     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">long</strong> <a href="../R/22792.html" title="Multiple referred from 26 places.">lowMask</a>(<strong class="reserved">char</strong> <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>, <strong class="reserved">char</strong> <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>) <em class="brace">{</em>
<a id="L2494" name="L2494"></a>2494         <strong class="reserved">long</strong> m = 0;
<a id="L2495" name="L2495"></a>2495         <strong class="reserved">int</strong> f = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>, 63), 0);
<a id="L2496" name="L2496"></a>2496         <strong class="reserved">int</strong> l = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>, 63), 0);
<a id="L2497" name="L2497"></a>2497         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = f; i &lt;= l; i++)
<a id="L2498" name="L2498"></a>2498             m |= 1L &lt;&lt; i;
<a id="L2499" name="L2499"></a>2499         <strong class="reserved">return</strong> m;
<a id="L2500" name="L2500"></a>2500     <em class="brace">}</em>
<a id="L2501" name="L2501"></a>2501 
<a id="L2502" name="L2502"></a>2502     <em class="comment">// Compute a high-order mask for the characters</em>
<a id="L2503" name="L2503"></a>2503     <em class="comment">// between first and last, inclusive</em>
<a id="L2504" name="L2504"></a>2504     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">long</strong> <a href="../R/20330.html" title="Multiple referred from 28 places.">highMask</a>(<strong class="reserved">char</strong> <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>, <strong class="reserved">char</strong> <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>) <em class="brace">{</em>
<a id="L2505" name="L2505"></a>2505         <strong class="reserved">long</strong> m = 0;
<a id="L2506" name="L2506"></a>2506         <strong class="reserved">int</strong> f = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>, 127), 64) - 64;
<a id="L2507" name="L2507"></a>2507         <strong class="reserved">int</strong> l = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>, 127), 64) - 64;
<a id="L2508" name="L2508"></a>2508         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = f; i &lt;= l; i++)
<a id="L2509" name="L2509"></a>2509             m |= 1L &lt;&lt; i;
<a id="L2510" name="L2510"></a>2510         <strong class="reserved">return</strong> m;
<a id="L2511" name="L2511"></a>2511     <em class="brace">}</em>
<a id="L2512" name="L2512"></a>2512 
<a id="L2513" name="L2513"></a>2513     <em class="comment">// Tell whether the given character is permitted by the given mask pair</em>
<a id="L2514" name="L2514"></a>2514     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/23117.html" title="Multiple referred from 460 places.">match</a>(<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <strong class="reserved">long</strong> <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <strong class="reserved">long</strong> <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>) <em class="brace">{</em>
<a id="L2515" name="L2515"></a>2515         <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == 0) <em class="comment">// 0 doesn't have a slot in the mask. So, it never matches.</em>
<a id="L2516" name="L2516"></a>2516             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2517" name="L2517"></a>2517         <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 64)
<a id="L2518" name="L2518"></a>2518             <strong class="reserved">return</strong> ((1L &lt;&lt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) &amp; <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>) != 0;
<a id="L2519" name="L2519"></a>2519         <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 128)
<a id="L2520" name="L2520"></a>2520             <strong class="reserved">return</strong> ((1L &lt;&lt; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> - 64)) &amp; <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>) != 0;
<a id="L2521" name="L2521"></a>2521         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2522" name="L2522"></a>2522     <em class="brace">}</em>
<a id="L2523" name="L2523"></a>2523 
<a id="L2524" name="L2524"></a>2524     <em class="comment">// Character-class masks, in reverse order from RFC2396 because</em>
<a id="L2525" name="L2525"></a>2525     <em class="comment">// initializers for static fields cannot make forward references.</em>
<a id="L2526" name="L2526"></a>2526 
<a id="L2527" name="L2527"></a>2527     <em class="comment">// digit    = "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" |</em>
<a id="L2528" name="L2528"></a>2528     <em class="comment">//            "8" | "9"</em>
<a id="L2529" name="L2529"></a>2529     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_DIGIT = <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>('0', '9');
<a id="L2530" name="L2530"></a>2530     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_DIGIT = 0L;
<a id="L2531" name="L2531"></a>2531 
<a id="L2532" name="L2532"></a>2532     <em class="comment">// upalpha  = "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" | "I" |</em>
<a id="L2533" name="L2533"></a>2533     <em class="comment">//            "J" | "K" | "L" | "M" | "N" | "O" | "P" | "Q" | "R" |</em>
<a id="L2534" name="L2534"></a>2534     <em class="comment">//            "S" | "T" | "U" | "V" | "W" | "X" | "Y" | "Z"</em>
<a id="L2535" name="L2535"></a>2535     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_UPALPHA = 0L;
<a id="L2536" name="L2536"></a>2536     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_UPALPHA = <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>('A', 'Z');
<a id="L2537" name="L2537"></a>2537 
<a id="L2538" name="L2538"></a>2538     <em class="comment">// lowalpha = "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" | "i" |</em>
<a id="L2539" name="L2539"></a>2539     <em class="comment">//            "j" | "k" | "l" | "m" | "n" | "o" | "p" | "q" | "r" |</em>
<a id="L2540" name="L2540"></a>2540     <em class="comment">//            "s" | "t" | "u" | "v" | "w" | "x" | "y" | "z"</em>
<a id="L2541" name="L2541"></a>2541     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_LOWALPHA = 0L;
<a id="L2542" name="L2542"></a>2542     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_LOWALPHA = <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>('a', 'z');
<a id="L2543" name="L2543"></a>2543 
<a id="L2544" name="L2544"></a>2544     <em class="comment">// alpha         = lowalpha | upalpha</em>
<a id="L2545" name="L2545"></a>2545     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_ALPHA = L_LOWALPHA | L_UPALPHA;
<a id="L2546" name="L2546"></a>2546     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_ALPHA = H_LOWALPHA | H_UPALPHA;
<a id="L2547" name="L2547"></a>2547 
<a id="L2548" name="L2548"></a>2548     <em class="comment">// alphanum      = alpha | digit</em>
<a id="L2549" name="L2549"></a>2549     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_ALPHANUM = L_DIGIT | L_ALPHA;
<a id="L2550" name="L2550"></a>2550     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_ALPHANUM = H_DIGIT | H_ALPHA;
<a id="L2551" name="L2551"></a>2551 
<a id="L2552" name="L2552"></a>2552     <em class="comment">// hex           = digit | "A" | "B" | "C" | "D" | "E" | "F" |</em>
<a id="L2553" name="L2553"></a>2553     <em class="comment">//                         "a" | "b" | "c" | "d" | "e" | "f"</em>
<a id="L2554" name="L2554"></a>2554     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_HEX = L_DIGIT;
<a id="L2555" name="L2555"></a>2555     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_HEX = <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>('A', 'F') | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>('a', 'f');
<a id="L2556" name="L2556"></a>2556 
<a id="L2557" name="L2557"></a>2557     <em class="comment">// mark          = "-" | "_" | "." | "!" | "~" | "*" | "'" |</em>
<a id="L2558" name="L2558"></a>2558     <em class="comment">//                 "(" | ")"</em>
<a id="L2559" name="L2559"></a>2559     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_MARK = <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>("-_.!~*'()");
<a id="L2560" name="L2560"></a>2560     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_MARK = <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>("-_.!~*'()");
<a id="L2561" name="L2561"></a>2561 
<a id="L2562" name="L2562"></a>2562     <em class="comment">// unreserved    = alphanum | mark</em>
<a id="L2563" name="L2563"></a>2563     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_UNRESERVED = L_ALPHANUM | L_MARK;
<a id="L2564" name="L2564"></a>2564     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_UNRESERVED = H_ALPHANUM | H_MARK;
<a id="L2565" name="L2565"></a>2565 
<a id="L2566" name="L2566"></a>2566     <em class="comment">// reserved      = ";" | "/" | "?" | ":" | "@" | "&amp;" | "=" | "+" |</em>
<a id="L2567" name="L2567"></a>2567     <em class="comment">//                 "$" | "," | "[" | "]"</em>
<a id="L2568" name="L2568"></a>2568     <em class="comment">// Added per RFC2732: "[", "]"</em>
<a id="L2569" name="L2569"></a>2569     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_RESERVED = <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>(";/?:@&amp;=+$,[]");
<a id="L2570" name="L2570"></a>2570     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_RESERVED = <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>(";/?:@&amp;=+$,[]");
<a id="L2571" name="L2571"></a>2571 
<a id="L2572" name="L2572"></a>2572     <em class="comment">// The zero'th bit is used to indicate that escape pairs and non-US-ASCII</em>
<a id="L2573" name="L2573"></a>2573     <em class="comment">// characters are allowed; this is handled by the scanEscape method below.</em>
<a id="L2574" name="L2574"></a>2574     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_ESCAPED = 1L;
<a id="L2575" name="L2575"></a>2575     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_ESCAPED = 0L;
<a id="L2576" name="L2576"></a>2576 
<a id="L2577" name="L2577"></a>2577     <em class="comment">// uric          = reserved | unreserved | escaped</em>
<a id="L2578" name="L2578"></a>2578     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_URIC = L_RESERVED | L_UNRESERVED | L_ESCAPED;
<a id="L2579" name="L2579"></a>2579     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_URIC = H_RESERVED | H_UNRESERVED | H_ESCAPED;
<a id="L2580" name="L2580"></a>2580 
<a id="L2581" name="L2581"></a>2581     <em class="comment">// pchar         = unreserved | escaped |</em>
<a id="L2582" name="L2582"></a>2582     <em class="comment">//                 ":" | "@" | "&amp;" | "=" | "+" | "$" | ","</em>
<a id="L2583" name="L2583"></a>2583     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_PCHAR
<a id="L2584" name="L2584"></a>2584         = L_UNRESERVED | L_ESCAPED | <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>(":@&amp;=+$,");
<a id="L2585" name="L2585"></a>2585     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_PCHAR
<a id="L2586" name="L2586"></a>2586         = H_UNRESERVED | H_ESCAPED | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>(":@&amp;=+$,");
<a id="L2587" name="L2587"></a>2587 
<a id="L2588" name="L2588"></a>2588     <em class="comment">// All valid path characters</em>
<a id="L2589" name="L2589"></a>2589     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_PATH = L_PCHAR | <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>(";/");
<a id="L2590" name="L2590"></a>2590     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_PATH = H_PCHAR | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>(";/");
<a id="L2591" name="L2591"></a>2591 
<a id="L2592" name="L2592"></a>2592     <em class="comment">// Dash, for use in domainlabel and toplabel</em>
<a id="L2593" name="L2593"></a>2593     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_DASH = <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>("-");
<a id="L2594" name="L2594"></a>2594     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_DASH = <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>("-");
<a id="L2595" name="L2595"></a>2595 
<a id="L2596" name="L2596"></a>2596     <em class="comment">// Dot, for use in hostnames</em>
<a id="L2597" name="L2597"></a>2597     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_DOT = <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>(".");
<a id="L2598" name="L2598"></a>2598     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_DOT = <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>(".");
<a id="L2599" name="L2599"></a>2599 
<a id="L2600" name="L2600"></a>2600     <em class="comment">// userinfo      = *( unreserved | escaped |</em>
<a id="L2601" name="L2601"></a>2601     <em class="comment">//                    ";" | ":" | "&amp;" | "=" | "+" | "$" | "," )</em>
<a id="L2602" name="L2602"></a>2602     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_USERINFO
<a id="L2603" name="L2603"></a>2603         = L_UNRESERVED | L_ESCAPED | <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>(";:&amp;=+$,");
<a id="L2604" name="L2604"></a>2604     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_USERINFO
<a id="L2605" name="L2605"></a>2605         = H_UNRESERVED | H_ESCAPED | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>(";:&amp;=+$,");
<a id="L2606" name="L2606"></a>2606 
<a id="L2607" name="L2607"></a>2607     <em class="comment">// reg_name      = 1*( unreserved | escaped | "$" | "," |</em>
<a id="L2608" name="L2608"></a>2608     <em class="comment">//                     ";" | ":" | "@" | "&amp;" | "=" | "+" )</em>
<a id="L2609" name="L2609"></a>2609     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_REG_NAME
<a id="L2610" name="L2610"></a>2610         = L_UNRESERVED | L_ESCAPED | <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>("$,;:@&amp;=+");
<a id="L2611" name="L2611"></a>2611     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_REG_NAME
<a id="L2612" name="L2612"></a>2612         = H_UNRESERVED | H_ESCAPED | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>("$,;:@&amp;=+");
<a id="L2613" name="L2613"></a>2613 
<a id="L2614" name="L2614"></a>2614     <em class="comment">// All valid characters for server-based authorities</em>
<a id="L2615" name="L2615"></a>2615     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_SERVER
<a id="L2616" name="L2616"></a>2616         = L_USERINFO | L_ALPHANUM | L_DASH | <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>(".:@[]");
<a id="L2617" name="L2617"></a>2617     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_SERVER
<a id="L2618" name="L2618"></a>2618         = H_USERINFO | H_ALPHANUM | H_DASH | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>(".:@[]");
<a id="L2619" name="L2619"></a>2619 
<a id="L2620" name="L2620"></a>2620     <em class="comment">// Special case of server authority that represents an IPv6 address</em>
<a id="L2621" name="L2621"></a>2621     <em class="comment">// In this case, a % does not signify an escape sequence</em>
<a id="L2622" name="L2622"></a>2622     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_SERVER_PERCENT
<a id="L2623" name="L2623"></a>2623         = L_SERVER | <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>("%");
<a id="L2624" name="L2624"></a>2624     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_SERVER_PERCENT
<a id="L2625" name="L2625"></a>2625         = H_SERVER | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>("%");
<a id="L2626" name="L2626"></a>2626     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_LEFT_BRACKET = <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>("[");
<a id="L2627" name="L2627"></a>2627     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_LEFT_BRACKET = <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>("[");
<a id="L2628" name="L2628"></a>2628 
<a id="L2629" name="L2629"></a>2629     <em class="comment">// scheme        = alpha *( alpha | digit | "+" | "-" | "." )</em>
<a id="L2630" name="L2630"></a>2630     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_SCHEME = L_ALPHA | L_DIGIT | <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>("+-.");
<a id="L2631" name="L2631"></a>2631     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_SCHEME = H_ALPHA | H_DIGIT | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>("+-.");
<a id="L2632" name="L2632"></a>2632 
<a id="L2633" name="L2633"></a>2633     <em class="comment">// uric_no_slash = unreserved | escaped | ";" | "?" | ":" | "@" |</em>
<a id="L2634" name="L2634"></a>2634     <em class="comment">//                 "&amp;" | "=" | "+" | "$" | ","</em>
<a id="L2635" name="L2635"></a>2635     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> L_URIC_NO_SLASH
<a id="L2636" name="L2636"></a>2636         = L_UNRESERVED | L_ESCAPED | <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>(";?:@&amp;=+$,");
<a id="L2637" name="L2637"></a>2637     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> H_URIC_NO_SLASH
<a id="L2638" name="L2638"></a>2638         = H_UNRESERVED | H_ESCAPED | <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>(";?:@&amp;=+$,");
<a id="L2639" name="L2639"></a>2639 
<a id="L2640" name="L2640"></a>2640 
<a id="L2641" name="L2641"></a>2641     <em class="comment">// -- Escaping and encoding --</em>
<a id="L2642" name="L2642"></a>2642 
<a id="L2643" name="L2643"></a>2643     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">char</strong>[] hexDigits = <em class="brace">{</em>
<a id="L2644" name="L2644"></a>2644         '0', '1', '2', '3', '4', '5', '6', '7',
<a id="L2645" name="L2645"></a>2645         '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'
<a id="L2646" name="L2646"></a>2646     <em class="brace">}</em>;
<a id="L2647" name="L2647"></a>2647 
<a id="L2648" name="L2648"></a>2648     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/10208.html" title="Multiple referred from 3 places.">appendEscape</a>(<a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb, <strong class="reserved">byte</strong> b) <em class="brace">{</em>
<a id="L2649" name="L2649"></a>2649         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('%');
<a id="L2650" name="L2650"></a>2650         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(hexDigits[(b &gt;&gt; 4) &amp; 0x0f]);
<a id="L2651" name="L2651"></a>2651         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(hexDigits[(b &gt;&gt; 0) &amp; 0x0f]);
<a id="L2652" name="L2652"></a>2652     <em class="brace">}</em>
<a id="L2653" name="L2653"></a>2653 
<a id="L2654" name="L2654"></a>2654     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/804.html#L2698" title="Referred from 2698 in src/java/net/URI.java.">appendEncoded</a>(<a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb, <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L2655" name="L2655"></a>2655         <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = <strong class="reserved">null</strong>;
<a id="L2656" name="L2656"></a>2656         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2657" name="L2657"></a>2657             bb = ThreadLocalCoders.encoderFor("UTF-8")
<a id="L2658" name="L2658"></a>2658                 .<a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(<a href="../S/1855.html#L262" title="Defined at 262 in src/java/nio/CharBuffer.java.">CharBuffer</a>.<a href="../D/36957.html" title="Multiple defined in 35 places.">wrap</a>("" + <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>));
<a id="L2659" name="L2659"></a>2659         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/2003.html#L40" title="Defined at 40 in src/java/nio/charset/CharacterCodingException.java.">CharacterCodingException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L2660" name="L2660"></a>2660             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> <strong class="reserved">false</strong>;
<a id="L2661" name="L2661"></a>2661         <em class="brace">}</em>
<a id="L2662" name="L2662"></a>2662         <strong class="reserved">while</strong> (bb.<a href="../S/1990.html#L401" title="Defined at 401 in src/java/nio/Buffer.java.">hasRemaining</a>()) <em class="brace">{</em>
<a id="L2663" name="L2663"></a>2663             <strong class="reserved">int</strong> b = bb.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>() &amp; 0xff;
<a id="L2664" name="L2664"></a>2664             <strong class="reserved">if</strong> (b &gt;= 0x80)
<a id="L2665" name="L2665"></a>2665                 <a href="../S/804.html#L2648" title="Defined at 2648 in src/java/net/URI.java.">appendEscape</a>(sb, (<strong class="reserved">byte</strong>)b);
<a id="L2666" name="L2666"></a>2666             <strong class="reserved">else</strong>
<a id="L2667" name="L2667"></a>2667                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)b);
<a id="L2668" name="L2668"></a>2668         <em class="brace">}</em>
<a id="L2669" name="L2669"></a>2669     <em class="brace">}</em>
<a id="L2670" name="L2670"></a>2670 
<a id="L2671" name="L2671"></a>2671     <em class="comment">// Quote any characters in s that are not permitted</em>
<a id="L2672" name="L2672"></a>2672     <em class="comment">// by the given mask pair</em>
<a id="L2673" name="L2673"></a>2673     <em class="comment">//</em>
<a id="L2674" name="L2674"></a>2674     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/25388.html" title="Multiple referred from 92 places.">quote</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <strong class="reserved">long</strong> <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <strong class="reserved">long</strong> <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>) <em class="brace">{</em>
<a id="L2675" name="L2675"></a>2675         <strong class="reserved">int</strong> n = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L2676" name="L2676"></a>2676         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">null</strong>;
<a id="L2677" name="L2677"></a>2677         <strong class="reserved">boolean</strong> allowNonASCII = ((<a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a> &amp; L_ESCAPED) != 0);
<a id="L2678" name="L2678"></a>2678         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>(); i++) <em class="brace">{</em>
<a id="L2679" name="L2679"></a>2679             <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L2680" name="L2680"></a>2680             <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; '\u0080') <em class="brace">{</em>
<a id="L2681" name="L2681"></a>2681                 <strong class="reserved">if</strong> (!<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>)) <em class="brace">{</em>
<a id="L2682" name="L2682"></a>2682                     <strong class="reserved">if</strong> (sb == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2683" name="L2683"></a>2683                         sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L2684" name="L2684"></a>2684                         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(s.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, i));
<a id="L2685" name="L2685"></a>2685                     <em class="brace">}</em>
<a id="L2686" name="L2686"></a>2686                     <a href="../S/804.html#L2648" title="Defined at 2648 in src/java/net/URI.java.">appendEscape</a>(sb, (<strong class="reserved">byte</strong>)<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L2687" name="L2687"></a>2687                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2688" name="L2688"></a>2688                     <strong class="reserved">if</strong> (sb != <strong class="reserved">null</strong>)
<a id="L2689" name="L2689"></a>2689                         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L2690" name="L2690"></a>2690                 <em class="brace">}</em>
<a id="L2691" name="L2691"></a>2691             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (allowNonASCII
<a id="L2692" name="L2692"></a>2692                        &amp;&amp; (<a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/26262.html" title="Multiple defined in 2 places.">isSpaceChar</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)
<a id="L2693" name="L2693"></a>2693                            || <a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25670.html" title="Multiple defined in 2 places.">isISOControl</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>))) <em class="brace">{</em>
<a id="L2694" name="L2694"></a>2694                 <strong class="reserved">if</strong> (sb == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2695" name="L2695"></a>2695                     sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L2696" name="L2696"></a>2696                     sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(s.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, i));
<a id="L2697" name="L2697"></a>2697                 <em class="brace">}</em>
<a id="L2698" name="L2698"></a>2698                 <a href="../S/804.html#L2654" title="Defined at 2654 in src/java/net/URI.java.">appendEncoded</a>(sb, <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L2699" name="L2699"></a>2699             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2700" name="L2700"></a>2700                 <strong class="reserved">if</strong> (sb != <strong class="reserved">null</strong>)
<a id="L2701" name="L2701"></a>2701                     sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L2702" name="L2702"></a>2702             <em class="brace">}</em>
<a id="L2703" name="L2703"></a>2703         <em class="brace">}</em>
<a id="L2704" name="L2704"></a>2704         <strong class="reserved">return</strong> (sb == <strong class="reserved">null</strong>) ? s : sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L2705" name="L2705"></a>2705     <em class="brace">}</em>
<a id="L2706" name="L2706"></a>2706 
<a id="L2707" name="L2707"></a>2707     <em class="comment">// Encodes all characters &gt;= \u0080 into escaped, normalized UTF-8 octets,</em>
<a id="L2708" name="L2708"></a>2708     <em class="comment">// assuming that s is otherwise legal</em>
<a id="L2709" name="L2709"></a>2709     <em class="comment">//</em>
<a id="L2710" name="L2710"></a>2710     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/13718.html" title="Multiple referred from 69 places.">encode</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <em class="brace">{</em>
<a id="L2711" name="L2711"></a>2711         <strong class="reserved">int</strong> n = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L2712" name="L2712"></a>2712         <strong class="reserved">if</strong> (n == 0)
<a id="L2713" name="L2713"></a>2713             <strong class="reserved">return</strong> s;
<a id="L2714" name="L2714"></a>2714 
<a id="L2715" name="L2715"></a>2715         <em class="comment">// First check whether we actually need to encode</em>
<a id="L2716" name="L2716"></a>2716         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0;;) <em class="brace">{</em>
<a id="L2717" name="L2717"></a>2717             <strong class="reserved">if</strong> (s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i) &gt;= '\u0080')
<a id="L2718" name="L2718"></a>2718                 <strong class="reserved">break</strong>;
<a id="L2719" name="L2719"></a>2719             <strong class="reserved">if</strong> (++i &gt;= n)
<a id="L2720" name="L2720"></a>2720                 <strong class="reserved">return</strong> s;
<a id="L2721" name="L2721"></a>2721         <em class="brace">}</em>
<a id="L2722" name="L2722"></a>2722 
<a id="L2723" name="L2723"></a>2723         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> ns = <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(s, <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../S/2470.html#L122" title="Defined at 122 in src/java/text/Normalizer.java.">Form</a>.NFC);
<a id="L2724" name="L2724"></a>2724         <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = <strong class="reserved">null</strong>;
<a id="L2725" name="L2725"></a>2725         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2726" name="L2726"></a>2726             bb = ThreadLocalCoders.encoderFor("UTF-8")
<a id="L2727" name="L2727"></a>2727                 .<a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(<a href="../S/1855.html#L262" title="Defined at 262 in src/java/nio/CharBuffer.java.">CharBuffer</a>.<a href="../D/36957.html" title="Multiple defined in 35 places.">wrap</a>(ns));
<a id="L2728" name="L2728"></a>2728         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/2003.html#L40" title="Defined at 40 in src/java/nio/charset/CharacterCodingException.java.">CharacterCodingException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L2729" name="L2729"></a>2729             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> <strong class="reserved">false</strong>;
<a id="L2730" name="L2730"></a>2730         <em class="brace">}</em>
<a id="L2731" name="L2731"></a>2731 
<a id="L2732" name="L2732"></a>2732         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L2733" name="L2733"></a>2733         <strong class="reserved">while</strong> (bb.<a href="../S/1990.html#L401" title="Defined at 401 in src/java/nio/Buffer.java.">hasRemaining</a>()) <em class="brace">{</em>
<a id="L2734" name="L2734"></a>2734             <strong class="reserved">int</strong> b = bb.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>() &amp; 0xff;
<a id="L2735" name="L2735"></a>2735             <strong class="reserved">if</strong> (b &gt;= 0x80)
<a id="L2736" name="L2736"></a>2736                 <a href="../S/804.html#L2648" title="Defined at 2648 in src/java/net/URI.java.">appendEscape</a>(sb, (<strong class="reserved">byte</strong>)b);
<a id="L2737" name="L2737"></a>2737             <strong class="reserved">else</strong>
<a id="L2738" name="L2738"></a>2738                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)b);
<a id="L2739" name="L2739"></a>2739         <em class="brace">}</em>
<a id="L2740" name="L2740"></a>2740         <strong class="reserved">return</strong> sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L2741" name="L2741"></a>2741     <em class="brace">}</em>
<a id="L2742" name="L2742"></a>2742 
<a id="L2743" name="L2743"></a>2743     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L2744" name="L2744"></a>2744         <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= '0') &amp;&amp; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= '9'))
<a id="L2745" name="L2745"></a>2745             <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> - '0';
<a id="L2746" name="L2746"></a>2746         <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 'a') &amp;&amp; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= 'f'))
<a id="L2747" name="L2747"></a>2747             <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> - 'a' + 10;
<a id="L2748" name="L2748"></a>2748         <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 'A') &amp;&amp; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= 'F'))
<a id="L2749" name="L2749"></a>2749             <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> - 'A' + 10;
<a id="L2750" name="L2750"></a>2750         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> <strong class="reserved">false</strong>;
<a id="L2751" name="L2751"></a>2751         <strong class="reserved">return</strong> -1;
<a id="L2752" name="L2752"></a>2752     <em class="brace">}</em>
<a id="L2753" name="L2753"></a>2753 
<a id="L2754" name="L2754"></a>2754     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">byte</strong> <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<strong class="reserved">char</strong> c1, <strong class="reserved">char</strong> c2) <em class="brace">{</em>
<a id="L2755" name="L2755"></a>2755         <strong class="reserved">return</strong> (<strong class="reserved">byte</strong>)(  ((<a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(c1) &amp; 0xf) &lt;&lt; 4)
<a id="L2756" name="L2756"></a>2756                       | ((<a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(c2) &amp; 0xf) &lt;&lt; 0));
<a id="L2757" name="L2757"></a>2757     <em class="brace">}</em>
<a id="L2758" name="L2758"></a>2758 
<a id="L2759" name="L2759"></a>2759     <em class="comment">// Evaluates all escapes in s, applying UTF-8 decoding if needed.  Assumes</em>
<a id="L2760" name="L2760"></a>2760     <em class="comment">// that escapes are well-formed syntactically, i.e., of the form %XX.  If a</em>
<a id="L2761" name="L2761"></a>2761     <em class="comment">// sequence of escaped octets is not valid UTF-8 then the erroneous octets</em>
<a id="L2762" name="L2762"></a>2762     <em class="comment">// are replaced with '\uFFFD'.</em>
<a id="L2763" name="L2763"></a>2763     <em class="comment">// Exception: any "%" found between "[]" is left alone. It is an IPv6 literal</em>
<a id="L2764" name="L2764"></a>2764     <em class="comment">//            with a scope_id</em>
<a id="L2765" name="L2765"></a>2765     <em class="comment">//</em>
<a id="L2766" name="L2766"></a>2766     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <em class="brace">{</em>
<a id="L2767" name="L2767"></a>2767         <strong class="reserved">if</strong> (s == <strong class="reserved">null</strong>)
<a id="L2768" name="L2768"></a>2768             <strong class="reserved">return</strong> s;
<a id="L2769" name="L2769"></a>2769         <strong class="reserved">int</strong> n = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L2770" name="L2770"></a>2770         <strong class="reserved">if</strong> (n == 0)
<a id="L2771" name="L2771"></a>2771             <strong class="reserved">return</strong> s;
<a id="L2772" name="L2772"></a>2772         <strong class="reserved">if</strong> (s.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('%') &lt; 0)
<a id="L2773" name="L2773"></a>2773             <strong class="reserved">return</strong> s;
<a id="L2774" name="L2774"></a>2774 
<a id="L2775" name="L2775"></a>2775         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>(n);
<a id="L2776" name="L2776"></a>2776         <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a>.<a href="../D/11296.html" title="Multiple defined in 10 places.">allocate</a>(n);
<a id="L2777" name="L2777"></a>2777         <a href="../S/1855.html#L262" title="Defined at 262 in src/java/nio/CharBuffer.java.">CharBuffer</a> cb = <a href="../S/1855.html#L262" title="Defined at 262 in src/java/nio/CharBuffer.java.">CharBuffer</a>.<a href="../D/11296.html" title="Multiple defined in 10 places.">allocate</a>(n);
<a id="L2778" name="L2778"></a>2778         <a href="../S/2001.html#L137" title="Defined at 137 in src/java/nio/charset/CharsetDecoder.java.">CharsetDecoder</a> <a href="../S/1118.html#L131" title="Defined at 131 in src/java/util/concurrent/ArrayBlockingQueue.java.">dec</a> = ThreadLocalCoders.decoderFor("UTF-8")
<a id="L2779" name="L2779"></a>2779             .<a href="../D/28491.html" title="Multiple defined in 2 places.">onMalformedInput</a>(<a href="../S/2013.html#L43" title="Defined at 43 in src/java/nio/charset/CodingErrorAction.java.">CodingErrorAction</a>.REPLACE)
<a id="L2780" name="L2780"></a>2780             .<a href="../D/28496.html" title="Multiple defined in 2 places.">onUnmappableCharacter</a>(<a href="../S/2013.html#L43" title="Defined at 43 in src/java/nio/charset/CodingErrorAction.java.">CodingErrorAction</a>.REPLACE);
<a id="L2781" name="L2781"></a>2781 
<a id="L2782" name="L2782"></a>2782         <em class="comment">// This is not horribly efficient, but it will do for now</em>
<a id="L2783" name="L2783"></a>2783         <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0);
<a id="L2784" name="L2784"></a>2784         <strong class="reserved">boolean</strong> betweenBrackets = <strong class="reserved">false</strong>;
<a id="L2785" name="L2785"></a>2785 
<a id="L2786" name="L2786"></a>2786         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n;) <em class="brace">{</em>
<a id="L2787" name="L2787"></a>2787             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);    <em class="comment">// Loop invariant</em>
<a id="L2788" name="L2788"></a>2788             <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == '[') <em class="brace">{</em>
<a id="L2789" name="L2789"></a>2789                 betweenBrackets = <strong class="reserved">true</strong>;
<a id="L2790" name="L2790"></a>2790             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (betweenBrackets &amp;&amp; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == ']') <em class="brace">{</em>
<a id="L2791" name="L2791"></a>2791                 betweenBrackets = <strong class="reserved">false</strong>;
<a id="L2792" name="L2792"></a>2792             <em class="brace">}</em>
<a id="L2793" name="L2793"></a>2793             <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> != '%' || betweenBrackets) <em class="brace">{</em>
<a id="L2794" name="L2794"></a>2794                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L2795" name="L2795"></a>2795                 <strong class="reserved">if</strong> (++i &gt;= n)
<a id="L2796" name="L2796"></a>2796                     <strong class="reserved">break</strong>;
<a id="L2797" name="L2797"></a>2797                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L2798" name="L2798"></a>2798                 <strong class="reserved">continue</strong>;
<a id="L2799" name="L2799"></a>2799             <em class="brace">}</em>
<a id="L2800" name="L2800"></a>2800             bb.<a href="../D/12817.html" title="Multiple defined in 199 places.">clear</a>();
<a id="L2801" name="L2801"></a>2801             <strong class="reserved">int</strong> ui = i;
<a id="L2802" name="L2802"></a>2802             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L2803" name="L2803"></a>2803                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> (n - i &gt;= 2);
<a id="L2804" name="L2804"></a>2804                 bb.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(<a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(++i), s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(++i)));
<a id="L2805" name="L2805"></a>2805                 <strong class="reserved">if</strong> (++i &gt;= n)
<a id="L2806" name="L2806"></a>2806                     <strong class="reserved">break</strong>;
<a id="L2807" name="L2807"></a>2807                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L2808" name="L2808"></a>2808                 <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> != '%')
<a id="L2809" name="L2809"></a>2809                     <strong class="reserved">break</strong>;
<a id="L2810" name="L2810"></a>2810             <em class="brace">}</em>
<a id="L2811" name="L2811"></a>2811             bb.<a href="../D/16458.html" title="Multiple defined in 3 places.">flip</a>();
<a id="L2812" name="L2812"></a>2812             cb.<a href="../D/12817.html" title="Multiple defined in 199 places.">clear</a>();
<a id="L2813" name="L2813"></a>2813             <a href="../S/1118.html#L131" title="Defined at 131 in src/java/util/concurrent/ArrayBlockingQueue.java.">dec</a>.<a href="../D/31151.html" title="Multiple defined in 296 places.">reset</a>();
<a id="L2814" name="L2814"></a>2814             <a href="../S/2007.html#L85" title="Defined at 85 in src/java/nio/charset/CoderResult.java.">CoderResult</a> cr = <a href="../S/1118.html#L131" title="Defined at 131 in src/java/util/concurrent/ArrayBlockingQueue.java.">dec</a>.<a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(bb, cb, <strong class="reserved">true</strong>);
<a id="L2815" name="L2815"></a>2815             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> cr.<a href="../S/2007.html#L119" title="Defined at 119 in src/java/nio/charset/CoderResult.java.">isUnderflow</a>();
<a id="L2816" name="L2816"></a>2816             cr = <a href="../S/1118.html#L131" title="Defined at 131 in src/java/util/concurrent/ArrayBlockingQueue.java.">dec</a>.<a href="../D/16474.html" title="Multiple defined in 60 places.">flush</a>(cb);
<a id="L2817" name="L2817"></a>2817             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> cr.<a href="../S/2007.html#L119" title="Defined at 119 in src/java/nio/charset/CoderResult.java.">isUnderflow</a>();
<a id="L2818" name="L2818"></a>2818             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(cb.<a href="../D/16458.html" title="Multiple defined in 3 places.">flip</a>().<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L2819" name="L2819"></a>2819         <em class="brace">}</em>
<a id="L2820" name="L2820"></a>2820 
<a id="L2821" name="L2821"></a>2821         <strong class="reserved">return</strong> sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L2822" name="L2822"></a>2822     <em class="brace">}</em>
<a id="L2823" name="L2823"></a>2823 
<a id="L2824" name="L2824"></a>2824 
<a id="L2825" name="L2825"></a>2825     <em class="comment">// -- Parsing --</em>
<a id="L2826" name="L2826"></a>2826 
<a id="L2827" name="L2827"></a>2827     <em class="comment">// For convenience we wrap the input URI string in a new instance of the</em>
<a id="L2828" name="L2828"></a>2828     <em class="comment">// following internal class.  This saves always having to pass the input</em>
<a id="L2829" name="L2829"></a>2829     <em class="comment">// string as an argument to each internal scan/parse method.</em>
<a id="L2830" name="L2830"></a>2830 
<a id="L2831" name="L2831"></a>2831     <strong class="reserved">private</strong> <strong class="reserved">class</strong> <a href="../R/6036.html" title="Multiple referred from 195 places.">Parser</a> <em class="brace">{</em>
<a id="L2832" name="L2832"></a>2832 
<a id="L2833" name="L2833"></a>2833         <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>;           <em class="comment">// URI input string</em>
<a id="L2834" name="L2834"></a>2834         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> requireServerAuthority = <strong class="reserved">false</strong>;
<a id="L2835" name="L2835"></a>2835 
<a id="L2836" name="L2836"></a>2836         Parser(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <em class="brace">{</em>
<a id="L2837" name="L2837"></a>2837             <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a> = s;
<a id="L2838" name="L2838"></a>2838             <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> = s;
<a id="L2839" name="L2839"></a>2839         <em class="brace">}</em>
<a id="L2840" name="L2840"></a>2840 
<a id="L2841" name="L2841"></a>2841         <em class="comment">// -- Methods for throwing URISyntaxException in various ways --</em>
<a id="L2842" name="L2842"></a>2842 
<a id="L2843" name="L2843"></a>2843         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/14235.html" title="Multiple referred from 75 places.">fail</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> reason) <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <em class="brace">{</em>
<a id="L2844" name="L2844"></a>2844             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>, reason);
<a id="L2845" name="L2845"></a>2845         <em class="brace">}</em>
<a id="L2846" name="L2846"></a>2846 
<a id="L2847" name="L2847"></a>2847         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/14235.html" title="Multiple referred from 75 places.">fail</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> reason, <strong class="reserved">int</strong> p) <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <em class="brace">{</em>
<a id="L2848" name="L2848"></a>2848             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>, reason, p);
<a id="L2849" name="L2849"></a>2849         <em class="brace">}</em>
<a id="L2850" name="L2850"></a>2850 
<a id="L2851" name="L2851"></a>2851         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/14237.html" title="Multiple referred from 9 places.">failExpecting</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> expected, <strong class="reserved">int</strong> p)
<a id="L2852" name="L2852"></a>2852             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L2853" name="L2853"></a>2853         <em class="brace">{</em>
<a id="L2854" name="L2854"></a>2854             <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Expected " + expected, p);
<a id="L2855" name="L2855"></a>2855         <em class="brace">}</em>
<a id="L2856" name="L2856"></a>2856 
<a id="L2857" name="L2857"></a>2857         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/14237.html" title="Multiple referred from 9 places.">failExpecting</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> expected, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> prior, <strong class="reserved">int</strong> p)
<a id="L2858" name="L2858"></a>2858             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L2859" name="L2859"></a>2859         <em class="brace">{</em>
<a id="L2860" name="L2860"></a>2860             <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Expected " + expected + " following " + prior, p);
<a id="L2861" name="L2861"></a>2861         <em class="brace">}</em>
<a id="L2862" name="L2862"></a>2862 
<a id="L2863" name="L2863"></a>2863 
<a id="L2864" name="L2864"></a>2864         <em class="comment">// -- Simple access to the input string --</em>
<a id="L2865" name="L2865"></a>2865 
<a id="L2866" name="L2866"></a>2866         <em class="comment">// Return a substring of the input string</em>
<a id="L2867" name="L2867"></a>2867         <em class="comment">//</em>
<a id="L2868" name="L2868"></a>2868         <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29020.html" title="Multiple referred from 1271 places.">substring</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2869" name="L2869"></a>2869             <strong class="reserved">return</strong> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>);
<a id="L2870" name="L2870"></a>2870         <em class="brace">}</em>
<a id="L2871" name="L2871"></a>2871 
<a id="L2872" name="L2872"></a>2872         <em class="comment">// Return the char at position p,</em>
<a id="L2873" name="L2873"></a>2873         <em class="comment">// assuming that p &lt; input.length()</em>
<a id="L2874" name="L2874"></a>2874         <em class="comment">//</em>
<a id="L2875" name="L2875"></a>2875         <strong class="reserved">private</strong> <strong class="reserved">char</strong> <a href="../R/11039.html" title="Multiple referred from 1437 places.">charAt</a>(<strong class="reserved">int</strong> p) <em class="brace">{</em>
<a id="L2876" name="L2876"></a>2876             <strong class="reserved">return</strong> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p);
<a id="L2877" name="L2877"></a>2877         <em class="brace">}</em>
<a id="L2878" name="L2878"></a>2878 
<a id="L2879" name="L2879"></a>2879         <em class="comment">// Tells whether start &lt; end and, if so, whether charAt(start) == c</em>
<a id="L2880" name="L2880"></a>2880         <em class="comment">//</em>
<a id="L2881" name="L2881"></a>2881         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/10386.html" title="Multiple referred from 395 places.">at</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>, <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L2882" name="L2882"></a>2882             <strong class="reserved">return</strong> (<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> &lt; <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) &amp;&amp; (<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>) == <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L2883" name="L2883"></a>2883         <em class="brace">}</em>
<a id="L2884" name="L2884"></a>2884 
<a id="L2885" name="L2885"></a>2885         <em class="comment">// Tells whether start + s.length() &lt; end and, if so,</em>
<a id="L2886" name="L2886"></a>2886         <em class="comment">// whether the chars at the start position match s exactly</em>
<a id="L2887" name="L2887"></a>2887         <em class="comment">//</em>
<a id="L2888" name="L2888"></a>2888         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/10386.html" title="Multiple referred from 395 places.">at</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <em class="brace">{</em>
<a id="L2889" name="L2889"></a>2889             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L2890" name="L2890"></a>2890             <strong class="reserved">int</strong> sn = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L2891" name="L2891"></a>2891             <strong class="reserved">if</strong> (sn &gt; <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> - p)
<a id="L2892" name="L2892"></a>2892                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2893" name="L2893"></a>2893             <strong class="reserved">int</strong> i = 0;
<a id="L2894" name="L2894"></a>2894             <strong class="reserved">while</strong> (i &lt; sn) <em class="brace">{</em>
<a id="L2895" name="L2895"></a>2895                 <strong class="reserved">if</strong> (<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p++) != s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)) <em class="brace">{</em>
<a id="L2896" name="L2896"></a>2896                     <strong class="reserved">break</strong>;
<a id="L2897" name="L2897"></a>2897                 <em class="brace">}</em>
<a id="L2898" name="L2898"></a>2898                 i++;
<a id="L2899" name="L2899"></a>2899             <em class="brace">}</em>
<a id="L2900" name="L2900"></a>2900             <strong class="reserved">return</strong> (i == sn);
<a id="L2901" name="L2901"></a>2901         <em class="brace">}</em>
<a id="L2902" name="L2902"></a>2902 
<a id="L2903" name="L2903"></a>2903 
<a id="L2904" name="L2904"></a>2904         <em class="comment">// -- Scanning --</em>
<a id="L2905" name="L2905"></a>2905 
<a id="L2906" name="L2906"></a>2906         <em class="comment">// The various scan and parse methods that follow use a uniform</em>
<a id="L2907" name="L2907"></a>2907         <em class="comment">// convention of taking the current start position and end index as</em>
<a id="L2908" name="L2908"></a>2908         <em class="comment">// their first two arguments.  The start is inclusive while the end is</em>
<a id="L2909" name="L2909"></a>2909         <em class="comment">// exclusive, just as in the String class, i.e., a start/end pair</em>
<a id="L2910" name="L2910"></a>2910         <em class="comment">// denotes the left-open interval [start, end) of the input string.</em>
<a id="L2911" name="L2911"></a>2911         <em class="comment">//</em>
<a id="L2912" name="L2912"></a>2912         <em class="comment">// These methods never proceed past the end position.  They may return</em>
<a id="L2913" name="L2913"></a>2913         <em class="comment">// -1 to indicate outright failure, but more often they simply return</em>
<a id="L2914" name="L2914"></a>2914         <em class="comment">// the position of the first char after the last char scanned.  Thus</em>
<a id="L2915" name="L2915"></a>2915         <em class="comment">// a typical idiom is</em>
<a id="L2916" name="L2916"></a>2916         <em class="comment">//</em>
<a id="L2917" name="L2917"></a>2917         <em class="comment">//     int p = start;</em>
<a id="L2918" name="L2918"></a>2918         <em class="comment">//     int q = scan(p, end, ...);</em>
<a id="L2919" name="L2919"></a>2919         <em class="comment">//     if (q &gt; p)</em>
<a id="L2920" name="L2920"></a>2920         <em class="comment">//         // We scanned something</em>
<a id="L2921" name="L2921"></a>2921         <em class="comment">//         ...;</em>
<a id="L2922" name="L2922"></a>2922         <em class="comment">//     else if (q == p)</em>
<a id="L2923" name="L2923"></a>2923         <em class="comment">//         // We scanned nothing</em>
<a id="L2924" name="L2924"></a>2924         <em class="comment">//         ...;</em>
<a id="L2925" name="L2925"></a>2925         <em class="comment">//     else if (q == -1)</em>
<a id="L2926" name="L2926"></a>2926         <em class="comment">//         // Something went wrong</em>
<a id="L2927" name="L2927"></a>2927         <em class="comment">//         ...;</em>
<a id="L2928" name="L2928"></a>2928 
<a id="L2929" name="L2929"></a>2929 
<a id="L2930" name="L2930"></a>2930         <em class="comment">// Scan a specific char: If the char at the given start position is</em>
<a id="L2931" name="L2931"></a>2931         <em class="comment">// equal to c, return the index of the next char; otherwise, return the</em>
<a id="L2932" name="L2932"></a>2932         <em class="comment">// start position.</em>
<a id="L2933" name="L2933"></a>2933         <em class="comment">//</em>
<a id="L2934" name="L2934"></a>2934         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/26607.html" title="Multiple referred from 130 places.">scan</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>, <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L2935" name="L2935"></a>2935             <strong class="reserved">if</strong> ((<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> &lt; <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) &amp;&amp; (<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>) == <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>))
<a id="L2936" name="L2936"></a>2936                 <strong class="reserved">return</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> + 1;
<a id="L2937" name="L2937"></a>2937             <strong class="reserved">return</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L2938" name="L2938"></a>2938         <em class="brace">}</em>
<a id="L2939" name="L2939"></a>2939 
<a id="L2940" name="L2940"></a>2940         <em class="comment">// Scan forward from the given start position.  Stop at the first char</em>
<a id="L2941" name="L2941"></a>2941         <em class="comment">// in the err string (in which case -1 is returned), or the first char</em>
<a id="L2942" name="L2942"></a>2942         <em class="comment">// in the stop string (in which case the index of the preceding char is</em>
<a id="L2943" name="L2943"></a>2943         <em class="comment">// returned), or the end of the input string (in which case the length</em>
<a id="L2944" name="L2944"></a>2944         <em class="comment">// of the input string is returned).  May return the start position if</em>
<a id="L2945" name="L2945"></a>2945         <em class="comment">// nothing matches.</em>
<a id="L2946" name="L2946"></a>2946         <em class="comment">//</em>
<a id="L2947" name="L2947"></a>2947         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/26607.html" title="Multiple referred from 130 places.">scan</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> err, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>) <em class="brace">{</em>
<a id="L2948" name="L2948"></a>2948             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L2949" name="L2949"></a>2949             <strong class="reserved">while</strong> (p &lt; <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L2950" name="L2950"></a>2950                 <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p);
<a id="L2951" name="L2951"></a>2951                 <strong class="reserved">if</strong> (err.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) &gt;= 0)
<a id="L2952" name="L2952"></a>2952                     <strong class="reserved">return</strong> -1;
<a id="L2953" name="L2953"></a>2953                 <strong class="reserved">if</strong> (<a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) &gt;= 0)
<a id="L2954" name="L2954"></a>2954                     <strong class="reserved">break</strong>;
<a id="L2955" name="L2955"></a>2955                 p++;
<a id="L2956" name="L2956"></a>2956             <em class="brace">}</em>
<a id="L2957" name="L2957"></a>2957             <strong class="reserved">return</strong> p;
<a id="L2958" name="L2958"></a>2958         <em class="brace">}</em>
<a id="L2959" name="L2959"></a>2959 
<a id="L2960" name="L2960"></a>2960         <em class="comment">// Scan a potential escape sequence, starting at the given position,</em>
<a id="L2961" name="L2961"></a>2961         <em class="comment">// with the given first char (i.e., charAt(start) == c).</em>
<a id="L2962" name="L2962"></a>2962         <em class="comment">//</em>
<a id="L2963" name="L2963"></a>2963         <em class="comment">// This method assumes that if escapes are allowed then visible</em>
<a id="L2964" name="L2964"></a>2964         <em class="comment">// non-US-ASCII chars are also allowed.</em>
<a id="L2965" name="L2965"></a>2965         <em class="comment">//</em>
<a id="L2966" name="L2966"></a>2966         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../S/804.html#L3001" title="Referred from 3001 in src/java/net/URI.java.">scanEscape</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n, <strong class="reserved">char</strong> <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>)
<a id="L2967" name="L2967"></a>2967             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L2968" name="L2968"></a>2968         <em class="brace">{</em>
<a id="L2969" name="L2969"></a>2969             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L2970" name="L2970"></a>2970             <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>;
<a id="L2971" name="L2971"></a>2971             <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == '%') <em class="brace">{</em>
<a id="L2972" name="L2972"></a>2972                 <em class="comment">// Process escape pair</em>
<a id="L2973" name="L2973"></a>2973                 <strong class="reserved">if</strong> ((p + 3 &lt;= n)
<a id="L2974" name="L2974"></a>2974                     &amp;&amp; <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>(<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p + 1), L_HEX, H_HEX)
<a id="L2975" name="L2975"></a>2975                     &amp;&amp; <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>(<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p + 2), L_HEX, H_HEX)) <em class="brace">{</em>
<a id="L2976" name="L2976"></a>2976                     <strong class="reserved">return</strong> p + 3;
<a id="L2977" name="L2977"></a>2977                 <em class="brace">}</em>
<a id="L2978" name="L2978"></a>2978                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Malformed escape pair", p);
<a id="L2979" name="L2979"></a>2979             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt; 128)
<a id="L2980" name="L2980"></a>2980                        &amp;&amp; !<a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/26262.html" title="Multiple defined in 2 places.">isSpaceChar</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)
<a id="L2981" name="L2981"></a>2981                        &amp;&amp; !<a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25670.html" title="Multiple defined in 2 places.">isISOControl</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)) <em class="brace">{</em>
<a id="L2982" name="L2982"></a>2982                 <em class="comment">// Allow unescaped but visible non-US-ASCII chars</em>
<a id="L2983" name="L2983"></a>2983                 <strong class="reserved">return</strong> p + 1;
<a id="L2984" name="L2984"></a>2984             <em class="brace">}</em>
<a id="L2985" name="L2985"></a>2985             <strong class="reserved">return</strong> p;
<a id="L2986" name="L2986"></a>2986         <em class="brace">}</em>
<a id="L2987" name="L2987"></a>2987 
<a id="L2988" name="L2988"></a>2988         <em class="comment">// Scan chars that match the given mask pair</em>
<a id="L2989" name="L2989"></a>2989         <em class="comment">//</em>
<a id="L2990" name="L2990"></a>2990         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/26607.html" title="Multiple referred from 130 places.">scan</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n, <strong class="reserved">long</strong> <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <strong class="reserved">long</strong> <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>)
<a id="L2991" name="L2991"></a>2991             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L2992" name="L2992"></a>2992         <em class="brace">{</em>
<a id="L2993" name="L2993"></a>2993             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L2994" name="L2994"></a>2994             <strong class="reserved">while</strong> (p &lt; n) <em class="brace">{</em>
<a id="L2995" name="L2995"></a>2995                 <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p);
<a id="L2996" name="L2996"></a>2996                 <strong class="reserved">if</strong> (<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>)) <em class="brace">{</em>
<a id="L2997" name="L2997"></a>2997                     p++;
<a id="L2998" name="L2998"></a>2998                     <strong class="reserved">continue</strong>;
<a id="L2999" name="L2999"></a>2999                 <em class="brace">}</em>
<a id="L3000" name="L3000"></a>3000                 <strong class="reserved">if</strong> ((<a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a> &amp; L_ESCAPED) != 0) <em class="brace">{</em>
<a id="L3001" name="L3001"></a>3001                     <strong class="reserved">int</strong> q = <a href="../S/804.html#L2966" title="Defined at 2966 in src/java/net/URI.java.">scanEscape</a>(p, n, <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L3002" name="L3002"></a>3002                     <strong class="reserved">if</strong> (q &gt; p) <em class="brace">{</em>
<a id="L3003" name="L3003"></a>3003                         p = q;
<a id="L3004" name="L3004"></a>3004                         <strong class="reserved">continue</strong>;
<a id="L3005" name="L3005"></a>3005                     <em class="brace">}</em>
<a id="L3006" name="L3006"></a>3006                 <em class="brace">}</em>
<a id="L3007" name="L3007"></a>3007                 <strong class="reserved">break</strong>;
<a id="L3008" name="L3008"></a>3008             <em class="brace">}</em>
<a id="L3009" name="L3009"></a>3009             <strong class="reserved">return</strong> p;
<a id="L3010" name="L3010"></a>3010         <em class="brace">}</em>
<a id="L3011" name="L3011"></a>3011 
<a id="L3012" name="L3012"></a>3012         <em class="comment">// Check that each of the chars in [start, end) matches the given mask</em>
<a id="L3013" name="L3013"></a>3013         <em class="comment">//</em>
<a id="L3014" name="L3014"></a>3014         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/11108.html" title="Multiple referred from 9 places.">checkChars</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>,
<a id="L3015" name="L3015"></a>3015                                 <strong class="reserved">long</strong> <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <strong class="reserved">long</strong> <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>,
<a id="L3016" name="L3016"></a>3016                                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> what)
<a id="L3017" name="L3017"></a>3017             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3018" name="L3018"></a>3018         <em class="brace">{</em>
<a id="L3019" name="L3019"></a>3019             <strong class="reserved">int</strong> p = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>, <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>);
<a id="L3020" name="L3020"></a>3020             <strong class="reserved">if</strong> (p &lt; <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>)
<a id="L3021" name="L3021"></a>3021                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Illegal character in " + what, p);
<a id="L3022" name="L3022"></a>3022         <em class="brace">}</em>
<a id="L3023" name="L3023"></a>3023 
<a id="L3024" name="L3024"></a>3024         <em class="comment">// Check that the char at position p matches the given mask</em>
<a id="L3025" name="L3025"></a>3025         <em class="comment">//</em>
<a id="L3026" name="L3026"></a>3026         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/804.html#L3047" title="Referred from 3047 in src/java/net/URI.java.">checkChar</a>(<strong class="reserved">int</strong> p,
<a id="L3027" name="L3027"></a>3027                                <strong class="reserved">long</strong> <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <strong class="reserved">long</strong> <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>,
<a id="L3028" name="L3028"></a>3028                                <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> what)
<a id="L3029" name="L3029"></a>3029             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3030" name="L3030"></a>3030         <em class="brace">{</em>
<a id="L3031" name="L3031"></a>3031             <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a>(p, p + 1, <a href="../D/27173.html" title="Multiple defined in 2 places.">lowMask</a>, <a href="../D/24255.html" title="Multiple defined in 2 places.">highMask</a>, what);
<a id="L3032" name="L3032"></a>3032         <em class="brace">}</em>
<a id="L3033" name="L3033"></a>3033 
<a id="L3034" name="L3034"></a>3034 
<a id="L3035" name="L3035"></a>3035         <em class="comment">// -- Parsing --</em>
<a id="L3036" name="L3036"></a>3036 
<a id="L3037" name="L3037"></a>3037         <em class="comment">// [&lt;scheme&gt;:]&lt;scheme-specific-part&gt;[#&lt;fragment&gt;]</em>
<a id="L3038" name="L3038"></a>3038         <em class="comment">//</em>
<a id="L3039" name="L3039"></a>3039         <strong class="reserved">void</strong> <a href="../R/24493.html" title="Multiple referred from 256 places.">parse</a>(<strong class="reserved">boolean</strong> rsa) <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <em class="brace">{</em>
<a id="L3040" name="L3040"></a>3040             requireServerAuthority = rsa;
<a id="L3041" name="L3041"></a>3041             <strong class="reserved">int</strong> ssp;                    <em class="comment">// Start of scheme-specific part</em>
<a id="L3042" name="L3042"></a>3042             <strong class="reserved">int</strong> n = <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L3043" name="L3043"></a>3043             <strong class="reserved">int</strong> p = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(0, n, "/?#", ":");
<a id="L3044" name="L3044"></a>3044             <strong class="reserved">if</strong> ((p &gt;= 0) &amp;&amp; <a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, ':')) <em class="brace">{</em>
<a id="L3045" name="L3045"></a>3045                 <strong class="reserved">if</strong> (p == 0)
<a id="L3046" name="L3046"></a>3046                     <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>("scheme name", 0);
<a id="L3047" name="L3047"></a>3047                 <a href="../S/804.html#L3026" title="Defined at 3026 in src/java/net/URI.java.">checkChar</a>(0, L_ALPHA, H_ALPHA, "scheme name");
<a id="L3048" name="L3048"></a>3048                 <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a>(1, p, L_SCHEME, H_SCHEME, "scheme name");
<a id="L3049" name="L3049"></a>3049                 scheme = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, p);
<a id="L3050" name="L3050"></a>3050                 p++;                    <em class="comment">// Skip ':'</em>
<a id="L3051" name="L3051"></a>3051                 ssp = p;
<a id="L3052" name="L3052"></a>3052                 <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, '/')) <em class="brace">{</em>
<a id="L3053" name="L3053"></a>3053                     p = <a href="../S/804.html#L3089" title="Defined at 3089 in src/java/net/URI.java.">parseHierarchical</a>(p, n);
<a id="L3054" name="L3054"></a>3054                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3055" name="L3055"></a>3055                     <strong class="reserved">int</strong> q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, "", "#");
<a id="L3056" name="L3056"></a>3056                     <strong class="reserved">if</strong> (q &lt;= p)
<a id="L3057" name="L3057"></a>3057                         <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>("scheme-specific part", p);
<a id="L3058" name="L3058"></a>3058                     <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a>(p, q, L_URIC, H_URIC, "opaque part");
<a id="L3059" name="L3059"></a>3059                     p = q;
<a id="L3060" name="L3060"></a>3060                 <em class="brace">}</em>
<a id="L3061" name="L3061"></a>3061             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3062" name="L3062"></a>3062                 ssp = 0;
<a id="L3063" name="L3063"></a>3063                 p = <a href="../S/804.html#L3089" title="Defined at 3089 in src/java/net/URI.java.">parseHierarchical</a>(0, n);
<a id="L3064" name="L3064"></a>3064             <em class="brace">}</em>
<a id="L3065" name="L3065"></a>3065             schemeSpecificPart = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(ssp, p);
<a id="L3066" name="L3066"></a>3066             <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, '#')) <em class="brace">{</em>
<a id="L3067" name="L3067"></a>3067                 <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a>(p + 1, n, L_URIC, H_URIC, "fragment");
<a id="L3068" name="L3068"></a>3068                 fragment = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p + 1, n);
<a id="L3069" name="L3069"></a>3069                 p = n;
<a id="L3070" name="L3070"></a>3070             <em class="brace">}</em>
<a id="L3071" name="L3071"></a>3071             <strong class="reserved">if</strong> (p &lt; n)
<a id="L3072" name="L3072"></a>3072                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("end of URI", p);
<a id="L3073" name="L3073"></a>3073         <em class="brace">}</em>
<a id="L3074" name="L3074"></a>3074 
<a id="L3075" name="L3075"></a>3075         <em class="comment">// [//authority]&lt;path&gt;[?&lt;query&gt;]</em>
<a id="L3076" name="L3076"></a>3076         <em class="comment">//</em>
<a id="L3077" name="L3077"></a>3077         <em class="comment">// DEVIATION from RFC2396: We allow an empty authority component as</em>
<a id="L3078" name="L3078"></a>3078         <em class="comment">// long as it's followed by a non-empty path, query component, or</em>
<a id="L3079" name="L3079"></a>3079         <em class="comment">// fragment component.  This is so that URIs such as "file:///foo/bar"</em>
<a id="L3080" name="L3080"></a>3080         <em class="comment">// will parse.  This seems to be the intent of RFC2396, though the</em>
<a id="L3081" name="L3081"></a>3081         <em class="comment">// grammar does not permit it.  If the authority is empty then the</em>
<a id="L3082" name="L3082"></a>3082         <em class="comment">// userInfo, host, and port components are undefined.</em>
<a id="L3083" name="L3083"></a>3083         <em class="comment">//</em>
<a id="L3084" name="L3084"></a>3084         <em class="comment">// DEVIATION from RFC2396: We allow empty relative paths.  This seems</em>
<a id="L3085" name="L3085"></a>3085         <em class="comment">// to be the intent of RFC2396, but the grammar does not permit it.</em>
<a id="L3086" name="L3086"></a>3086         <em class="comment">// The primary consequence of this deviation is that "#f" parses as a</em>
<a id="L3087" name="L3087"></a>3087         <em class="comment">// relative URI with an empty path.</em>
<a id="L3088" name="L3088"></a>3088         <em class="comment">//</em>
<a id="L3089" name="L3089"></a>3089         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/24555.html" title="Multiple referred from 2 places.">parseHierarchical</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n)
<a id="L3090" name="L3090"></a>3090             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3091" name="L3091"></a>3091         <em class="brace">{</em>
<a id="L3092" name="L3092"></a>3092             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3093" name="L3093"></a>3093             <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, '/') &amp;&amp; <a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p + 1, n, '/')) <em class="brace">{</em>
<a id="L3094" name="L3094"></a>3094                 p += 2;
<a id="L3095" name="L3095"></a>3095                 <strong class="reserved">int</strong> q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, "", "/?#");
<a id="L3096" name="L3096"></a>3096                 <strong class="reserved">if</strong> (q &gt; p) <em class="brace">{</em>
<a id="L3097" name="L3097"></a>3097                     p = <a href="../S/804.html#L3126" title="Defined at 3126 in src/java/net/URI.java.">parseAuthority</a>(p, q);
<a id="L3098" name="L3098"></a>3098                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (q &lt; n) <em class="brace">{</em>
<a id="L3099" name="L3099"></a>3099                     <em class="comment">// DEVIATION: Allow empty authority prior to non-empty</em>
<a id="L3100" name="L3100"></a>3100                     <em class="comment">// path, query component or fragment identifier</em>
<a id="L3101" name="L3101"></a>3101                 <em class="brace">}</em> <strong class="reserved">else</strong>
<a id="L3102" name="L3102"></a>3102                     <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>("authority", p);
<a id="L3103" name="L3103"></a>3103             <em class="brace">}</em>
<a id="L3104" name="L3104"></a>3104             <strong class="reserved">int</strong> q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, "", "?#"); <em class="comment">// DEVIATION: May be empty</em>
<a id="L3105" name="L3105"></a>3105             <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a>(p, q, L_PATH, H_PATH, "path");
<a id="L3106" name="L3106"></a>3106             path = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, q);
<a id="L3107" name="L3107"></a>3107             p = q;
<a id="L3108" name="L3108"></a>3108             <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, '?')) <em class="brace">{</em>
<a id="L3109" name="L3109"></a>3109                 p++;
<a id="L3110" name="L3110"></a>3110                 q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, "", "#");
<a id="L3111" name="L3111"></a>3111                 <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a>(p, q, L_URIC, H_URIC, "query");
<a id="L3112" name="L3112"></a>3112                 <a href="../D/30057.html" title="Multiple defined in 20 places.">query</a> = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, q);
<a id="L3113" name="L3113"></a>3113                 p = q;
<a id="L3114" name="L3114"></a>3114             <em class="brace">}</em>
<a id="L3115" name="L3115"></a>3115             <strong class="reserved">return</strong> p;
<a id="L3116" name="L3116"></a>3116         <em class="brace">}</em>
<a id="L3117" name="L3117"></a>3117 
<a id="L3118" name="L3118"></a>3118         <em class="comment">// authority     = server | reg_name</em>
<a id="L3119" name="L3119"></a>3119         <em class="comment">//</em>
<a id="L3120" name="L3120"></a>3120         <em class="comment">// Ambiguity: An authority that is a registry name rather than a server</em>
<a id="L3121" name="L3121"></a>3121         <em class="comment">// might have a prefix that parses as a server.  We use the fact that</em>
<a id="L3122" name="L3122"></a>3122         <em class="comment">// the authority component is always followed by '/' or the end of the</em>
<a id="L3123" name="L3123"></a>3123         <em class="comment">// input string to resolve this: If the complete authority did not</em>
<a id="L3124" name="L3124"></a>3124         <em class="comment">// parse as a server then we try to parse it as a registry name.</em>
<a id="L3125" name="L3125"></a>3125         <em class="comment">//</em>
<a id="L3126" name="L3126"></a>3126         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../S/804.html#L3097" title="Referred from 3097 in src/java/net/URI.java.">parseAuthority</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n)
<a id="L3127" name="L3127"></a>3127             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3128" name="L3128"></a>3128         <em class="brace">{</em>
<a id="L3129" name="L3129"></a>3129             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3130" name="L3130"></a>3130             <strong class="reserved">int</strong> q = p;
<a id="L3131" name="L3131"></a>3131             <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a> = <strong class="reserved">null</strong>;
<a id="L3132" name="L3132"></a>3132 
<a id="L3133" name="L3133"></a>3133             <strong class="reserved">boolean</strong> serverChars;
<a id="L3134" name="L3134"></a>3134             <strong class="reserved">boolean</strong> regChars;
<a id="L3135" name="L3135"></a>3135 
<a id="L3136" name="L3136"></a>3136             <strong class="reserved">if</strong> (<a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, "", "]") &gt; p) <em class="brace">{</em>
<a id="L3137" name="L3137"></a>3137                 <em class="comment">// contains a literal IPv6 address, therefore % is allowed</em>
<a id="L3138" name="L3138"></a>3138                 serverChars = (<a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_SERVER_PERCENT, H_SERVER_PERCENT) == n);
<a id="L3139" name="L3139"></a>3139             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3140" name="L3140"></a>3140                 serverChars = (<a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_SERVER, H_SERVER) == n);
<a id="L3141" name="L3141"></a>3141             <em class="brace">}</em>
<a id="L3142" name="L3142"></a>3142             regChars = (<a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_REG_NAME, H_REG_NAME) == n);
<a id="L3143" name="L3143"></a>3143 
<a id="L3144" name="L3144"></a>3144             <strong class="reserved">if</strong> (regChars &amp;&amp; !serverChars) <em class="brace">{</em>
<a id="L3145" name="L3145"></a>3145                 <em class="comment">// Must be a registry-based authority</em>
<a id="L3146" name="L3146"></a>3146                 authority = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, n);
<a id="L3147" name="L3147"></a>3147                 <strong class="reserved">return</strong> n;
<a id="L3148" name="L3148"></a>3148             <em class="brace">}</em>
<a id="L3149" name="L3149"></a>3149 
<a id="L3150" name="L3150"></a>3150             <strong class="reserved">if</strong> (serverChars) <em class="brace">{</em>
<a id="L3151" name="L3151"></a>3151                 <em class="comment">// Might be (probably is) a server-based authority, so attempt</em>
<a id="L3152" name="L3152"></a>3152                 <em class="comment">// to parse it as such.  If the attempt fails, try to treat it</em>
<a id="L3153" name="L3153"></a>3153                 <em class="comment">// as a registry-based authority.</em>
<a id="L3154" name="L3154"></a>3154                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L3155" name="L3155"></a>3155                     q = <a href="../S/804.html#L3196" title="Defined at 3196 in src/java/net/URI.java.">parseServer</a>(p, n);
<a id="L3156" name="L3156"></a>3156                     <strong class="reserved">if</strong> (q &lt; n)
<a id="L3157" name="L3157"></a>3157                         <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>("end of authority", q);
<a id="L3158" name="L3158"></a>3158                     authority = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, n);
<a id="L3159" name="L3159"></a>3159                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L3160" name="L3160"></a>3160                     <em class="comment">// Undo results of failed parse</em>
<a id="L3161" name="L3161"></a>3161                     userInfo = <strong class="reserved">null</strong>;
<a id="L3162" name="L3162"></a>3162                     host = <strong class="reserved">null</strong>;
<a id="L3163" name="L3163"></a>3163                     port = -1;
<a id="L3164" name="L3164"></a>3164                     <strong class="reserved">if</strong> (requireServerAuthority) <em class="brace">{</em>
<a id="L3165" name="L3165"></a>3165                         <em class="comment">// If we're insisting upon a server-based authority,</em>
<a id="L3166" name="L3166"></a>3166                         <em class="comment">// then just re-throw the exception</em>
<a id="L3167" name="L3167"></a>3167                         <strong class="reserved">throw</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L3168" name="L3168"></a>3168                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3169" name="L3169"></a>3169                         <em class="comment">// Save the exception in case it doesn't parse as a</em>
<a id="L3170" name="L3170"></a>3170                         <em class="comment">// registry either</em>
<a id="L3171" name="L3171"></a>3171                         <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a> = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L3172" name="L3172"></a>3172                         q = p;
<a id="L3173" name="L3173"></a>3173                     <em class="brace">}</em>
<a id="L3174" name="L3174"></a>3174                 <em class="brace">}</em>
<a id="L3175" name="L3175"></a>3175             <em class="brace">}</em>
<a id="L3176" name="L3176"></a>3176 
<a id="L3177" name="L3177"></a>3177             <strong class="reserved">if</strong> (q &lt; n) <em class="brace">{</em>
<a id="L3178" name="L3178"></a>3178                 <strong class="reserved">if</strong> (regChars) <em class="brace">{</em>
<a id="L3179" name="L3179"></a>3179                     <em class="comment">// Registry-based authority</em>
<a id="L3180" name="L3180"></a>3180                     authority = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, n);
<a id="L3181" name="L3181"></a>3181                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L3182" name="L3182"></a>3182                     <em class="comment">// Re-throw exception; it was probably due to</em>
<a id="L3183" name="L3183"></a>3183                     <em class="comment">// a malformed IPv6 address</em>
<a id="L3184" name="L3184"></a>3184                     <strong class="reserved">throw</strong> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>;
<a id="L3185" name="L3185"></a>3185                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3186" name="L3186"></a>3186                     <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Illegal character in authority", q);
<a id="L3187" name="L3187"></a>3187                 <em class="brace">}</em>
<a id="L3188" name="L3188"></a>3188             <em class="brace">}</em>
<a id="L3189" name="L3189"></a>3189 
<a id="L3190" name="L3190"></a>3190             <strong class="reserved">return</strong> n;
<a id="L3191" name="L3191"></a>3191         <em class="brace">}</em>
<a id="L3192" name="L3192"></a>3192 
<a id="L3193" name="L3193"></a>3193 
<a id="L3194" name="L3194"></a>3194         <em class="comment">// [&lt;userinfo&gt;@]&lt;host&gt;[:&lt;port&gt;]</em>
<a id="L3195" name="L3195"></a>3195         <em class="comment">//</em>
<a id="L3196" name="L3196"></a>3196         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../S/804.html#L3155" title="Referred from 3155 in src/java/net/URI.java.">parseServer</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n)
<a id="L3197" name="L3197"></a>3197             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3198" name="L3198"></a>3198         <em class="brace">{</em>
<a id="L3199" name="L3199"></a>3199             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3200" name="L3200"></a>3200             <strong class="reserved">int</strong> q;
<a id="L3201" name="L3201"></a>3201 
<a id="L3202" name="L3202"></a>3202             <em class="comment">// userinfo</em>
<a id="L3203" name="L3203"></a>3203             q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, "/?#", "@");
<a id="L3204" name="L3204"></a>3204             <strong class="reserved">if</strong> ((q &gt;= p) &amp;&amp; <a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(q, n, '@')) <em class="brace">{</em>
<a id="L3205" name="L3205"></a>3205                 <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a>(p, q, L_USERINFO, H_USERINFO, "user info");
<a id="L3206" name="L3206"></a>3206                 userInfo = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, q);
<a id="L3207" name="L3207"></a>3207                 p = q + 1;              <em class="comment">// Skip '@'</em>
<a id="L3208" name="L3208"></a>3208             <em class="brace">}</em>
<a id="L3209" name="L3209"></a>3209 
<a id="L3210" name="L3210"></a>3210             <em class="comment">// hostname, IPv4 address, or IPv6 address</em>
<a id="L3211" name="L3211"></a>3211             <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, '[')) <em class="brace">{</em>
<a id="L3212" name="L3212"></a>3212                 <em class="comment">// DEVIATION from RFC2396: Support IPv6 addresses, per RFC2732</em>
<a id="L3213" name="L3213"></a>3213                 p++;
<a id="L3214" name="L3214"></a>3214                 q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, "/?#", "]");
<a id="L3215" name="L3215"></a>3215                 <strong class="reserved">if</strong> ((q &gt; p) &amp;&amp; <a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(q, n, ']')) <em class="brace">{</em>
<a id="L3216" name="L3216"></a>3216                     <em class="comment">// look for a "%" scope id</em>
<a id="L3217" name="L3217"></a>3217                     <strong class="reserved">int</strong> r = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a> (p, q, "", "%");
<a id="L3218" name="L3218"></a>3218                     <strong class="reserved">if</strong> (r &gt; p) <em class="brace">{</em>
<a id="L3219" name="L3219"></a>3219                         <a href="../S/804.html#L3446" title="Defined at 3446 in src/java/net/URI.java.">parseIPv6Reference</a>(p, r);
<a id="L3220" name="L3220"></a>3220                         <strong class="reserved">if</strong> (r+1 == q) <em class="brace">{</em>
<a id="L3221" name="L3221"></a>3221                             <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a> ("scope id expected");
<a id="L3222" name="L3222"></a>3222                         <em class="brace">}</em>
<a id="L3223" name="L3223"></a>3223                         <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a> (r+1, q, L_ALPHANUM, H_ALPHANUM,
<a id="L3224" name="L3224"></a>3224                                                 "scope id");
<a id="L3225" name="L3225"></a>3225                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3226" name="L3226"></a>3226                         <a href="../S/804.html#L3446" title="Defined at 3446 in src/java/net/URI.java.">parseIPv6Reference</a>(p, q);
<a id="L3227" name="L3227"></a>3227                     <em class="brace">}</em>
<a id="L3228" name="L3228"></a>3228                     host = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p-1, q+1);
<a id="L3229" name="L3229"></a>3229                     p = q + 1;
<a id="L3230" name="L3230"></a>3230                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3231" name="L3231"></a>3231                     <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>("closing bracket for IPv6 address", q);
<a id="L3232" name="L3232"></a>3232                 <em class="brace">}</em>
<a id="L3233" name="L3233"></a>3233             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3234" name="L3234"></a>3234                 q = <a href="../S/804.html#L3328" title="Defined at 3328 in src/java/net/URI.java.">parseIPv4Address</a>(p, n);
<a id="L3235" name="L3235"></a>3235                 <strong class="reserved">if</strong> (q &lt;= p)
<a id="L3236" name="L3236"></a>3236                     q = <a href="../S/804.html#L3358" title="Defined at 3358 in src/java/net/URI.java.">parseHostname</a>(p, n);
<a id="L3237" name="L3237"></a>3237                 p = q;
<a id="L3238" name="L3238"></a>3238             <em class="brace">}</em>
<a id="L3239" name="L3239"></a>3239 
<a id="L3240" name="L3240"></a>3240             <em class="comment">// port</em>
<a id="L3241" name="L3241"></a>3241             <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, ':')) <em class="brace">{</em>
<a id="L3242" name="L3242"></a>3242                 p++;
<a id="L3243" name="L3243"></a>3243                 q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, "", "/");
<a id="L3244" name="L3244"></a>3244                 <strong class="reserved">if</strong> (q &gt; p) <em class="brace">{</em>
<a id="L3245" name="L3245"></a>3245                     <a href="../S/804.html#L3014" title="Defined at 3014 in src/java/net/URI.java.">checkChars</a>(p, q, L_DIGIT, H_DIGIT, "port number");
<a id="L3246" name="L3246"></a>3246                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L3247" name="L3247"></a>3247                         port = <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/29148.html" title="Multiple defined in 9 places.">parseInt</a>(<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, q));
<a id="L3248" name="L3248"></a>3248                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1762.html#L38" title="Defined at 38 in src/java/lang/NumberFormatException.java.">NumberFormatException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L3249" name="L3249"></a>3249                         <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Malformed port number", p);
<a id="L3250" name="L3250"></a>3250                     <em class="brace">}</em>
<a id="L3251" name="L3251"></a>3251                     p = q;
<a id="L3252" name="L3252"></a>3252                 <em class="brace">}</em>
<a id="L3253" name="L3253"></a>3253             <em class="brace">}</em>
<a id="L3254" name="L3254"></a>3254             <strong class="reserved">if</strong> (p &lt; n)
<a id="L3255" name="L3255"></a>3255                 <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>("port number", p);
<a id="L3256" name="L3256"></a>3256 
<a id="L3257" name="L3257"></a>3257             <strong class="reserved">return</strong> p;
<a id="L3258" name="L3258"></a>3258         <em class="brace">}</em>
<a id="L3259" name="L3259"></a>3259 
<a id="L3260" name="L3260"></a>3260         <em class="comment">// Scan a string of decimal digits whose value fits in a byte</em>
<a id="L3261" name="L3261"></a>3261         <em class="comment">//</em>
<a id="L3262" name="L3262"></a>3262         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/26614.html" title="Multiple referred from 4 places.">scanByte</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n)
<a id="L3263" name="L3263"></a>3263             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3264" name="L3264"></a>3264         <em class="brace">{</em>
<a id="L3265" name="L3265"></a>3265             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3266" name="L3266"></a>3266             <strong class="reserved">int</strong> q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_DIGIT, H_DIGIT);
<a id="L3267" name="L3267"></a>3267             <strong class="reserved">if</strong> (q &lt;= p) <strong class="reserved">return</strong> q;
<a id="L3268" name="L3268"></a>3268             <strong class="reserved">if</strong> (<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/29148.html" title="Multiple defined in 9 places.">parseInt</a>(<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, q)) &gt; 255) <strong class="reserved">return</strong> p;
<a id="L3269" name="L3269"></a>3269             <strong class="reserved">return</strong> q;
<a id="L3270" name="L3270"></a>3270         <em class="brace">}</em>
<a id="L3271" name="L3271"></a>3271 
<a id="L3272" name="L3272"></a>3272         <em class="comment">// Scan an IPv4 address.</em>
<a id="L3273" name="L3273"></a>3273         <em class="comment">//</em>
<a id="L3274" name="L3274"></a>3274         <em class="comment">// If the strict argument is true then we require that the given</em>
<a id="L3275" name="L3275"></a>3275         <em class="comment">// interval contain nothing besides an IPv4 address; if it is false</em>
<a id="L3276" name="L3276"></a>3276         <em class="comment">// then we only require that it start with an IPv4 address.</em>
<a id="L3277" name="L3277"></a>3277         <em class="comment">//</em>
<a id="L3278" name="L3278"></a>3278         <em class="comment">// If the interval does not contain or start with (depending upon the</em>
<a id="L3279" name="L3279"></a>3279         <em class="comment">// strict argument) a legal IPv4 address characters then we return -1</em>
<a id="L3280" name="L3280"></a>3280         <em class="comment">// immediately; otherwise we insist that these characters parse as a</em>
<a id="L3281" name="L3281"></a>3281         <em class="comment">// legal IPv4 address and throw an exception on failure.</em>
<a id="L3282" name="L3282"></a>3282         <em class="comment">//</em>
<a id="L3283" name="L3283"></a>3283         <em class="comment">// We assume that any string of decimal digits and dots must be an IPv4</em>
<a id="L3284" name="L3284"></a>3284         <em class="comment">// address.  It won't parse as a hostname anyway, so making that</em>
<a id="L3285" name="L3285"></a>3285         <em class="comment">// assumption here allows more meaningful exceptions to be thrown.</em>
<a id="L3286" name="L3286"></a>3286         <em class="comment">//</em>
<a id="L3287" name="L3287"></a>3287         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/26641.html" title="Multiple referred from 2 places.">scanIPv4Address</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n, <strong class="reserved">boolean</strong> strict)
<a id="L3288" name="L3288"></a>3288             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3289" name="L3289"></a>3289         <em class="brace">{</em>
<a id="L3290" name="L3290"></a>3290             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3291" name="L3291"></a>3291             <strong class="reserved">int</strong> q;
<a id="L3292" name="L3292"></a>3292             <strong class="reserved">int</strong> m = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_DIGIT | L_DOT, H_DIGIT | H_DOT);
<a id="L3293" name="L3293"></a>3293             <strong class="reserved">if</strong> ((m &lt;= p) || (strict &amp;&amp; (m != n)))
<a id="L3294" name="L3294"></a>3294                 <strong class="reserved">return</strong> -1;
<a id="L3295" name="L3295"></a>3295             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L3296" name="L3296"></a>3296                 <em class="comment">// Per RFC2732: At most three digits per byte</em>
<a id="L3297" name="L3297"></a>3297                 <em class="comment">// Further constraint: Each element fits in a byte</em>
<a id="L3298" name="L3298"></a>3298                 <strong class="reserved">if</strong> ((q = <a href="../S/804.html#L3262" title="Defined at 3262 in src/java/net/URI.java.">scanByte</a>(p, m)) &lt;= p) <strong class="reserved">break</strong>;   p = q;
<a id="L3299" name="L3299"></a>3299                 <strong class="reserved">if</strong> ((q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, m, '.')) &lt;= p) <strong class="reserved">break</strong>;  p = q;
<a id="L3300" name="L3300"></a>3300                 <strong class="reserved">if</strong> ((q = <a href="../S/804.html#L3262" title="Defined at 3262 in src/java/net/URI.java.">scanByte</a>(p, m)) &lt;= p) <strong class="reserved">break</strong>;   p = q;
<a id="L3301" name="L3301"></a>3301                 <strong class="reserved">if</strong> ((q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, m, '.')) &lt;= p) <strong class="reserved">break</strong>;  p = q;
<a id="L3302" name="L3302"></a>3302                 <strong class="reserved">if</strong> ((q = <a href="../S/804.html#L3262" title="Defined at 3262 in src/java/net/URI.java.">scanByte</a>(p, m)) &lt;= p) <strong class="reserved">break</strong>;   p = q;
<a id="L3303" name="L3303"></a>3303                 <strong class="reserved">if</strong> ((q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, m, '.')) &lt;= p) <strong class="reserved">break</strong>;  p = q;
<a id="L3304" name="L3304"></a>3304                 <strong class="reserved">if</strong> ((q = <a href="../S/804.html#L3262" title="Defined at 3262 in src/java/net/URI.java.">scanByte</a>(p, m)) &lt;= p) <strong class="reserved">break</strong>;   p = q;
<a id="L3305" name="L3305"></a>3305                 <strong class="reserved">if</strong> (q &lt; m) <strong class="reserved">break</strong>;
<a id="L3306" name="L3306"></a>3306                 <strong class="reserved">return</strong> q;
<a id="L3307" name="L3307"></a>3307             <em class="brace">}</em>
<a id="L3308" name="L3308"></a>3308             <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Malformed IPv4 address", q);
<a id="L3309" name="L3309"></a>3309             <strong class="reserved">return</strong> -1;
<a id="L3310" name="L3310"></a>3310         <em class="brace">}</em>
<a id="L3311" name="L3311"></a>3311 
<a id="L3312" name="L3312"></a>3312         <em class="comment">// Take an IPv4 address: Throw an exception if the given interval</em>
<a id="L3313" name="L3313"></a>3313         <em class="comment">// contains anything except an IPv4 address</em>
<a id="L3314" name="L3314"></a>3314         <em class="comment">//</em>
<a id="L3315" name="L3315"></a>3315         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/29110.html" title="Multiple referred from 3 places.">takeIPv4Address</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> expected)
<a id="L3316" name="L3316"></a>3316             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3317" name="L3317"></a>3317         <em class="brace">{</em>
<a id="L3318" name="L3318"></a>3318             <strong class="reserved">int</strong> p = <a href="../S/804.html#L3287" title="Defined at 3287 in src/java/net/URI.java.">scanIPv4Address</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, n, <strong class="reserved">true</strong>);
<a id="L3319" name="L3319"></a>3319             <strong class="reserved">if</strong> (p &lt;= <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>)
<a id="L3320" name="L3320"></a>3320                 <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>(expected, <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>);
<a id="L3321" name="L3321"></a>3321             <strong class="reserved">return</strong> p;
<a id="L3322" name="L3322"></a>3322         <em class="brace">}</em>
<a id="L3323" name="L3323"></a>3323 
<a id="L3324" name="L3324"></a>3324         <em class="comment">// Attempt to parse an IPv4 address, returning -1 on failure but</em>
<a id="L3325" name="L3325"></a>3325         <em class="comment">// allowing the given interval to contain [:&lt;characters&gt;] after</em>
<a id="L3326" name="L3326"></a>3326         <em class="comment">// the IPv4 address.</em>
<a id="L3327" name="L3327"></a>3327         <em class="comment">//</em>
<a id="L3328" name="L3328"></a>3328         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../S/804.html#L3234" title="Referred from 3234 in src/java/net/URI.java.">parseIPv4Address</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n) <em class="brace">{</em>
<a id="L3329" name="L3329"></a>3329             <strong class="reserved">int</strong> p;
<a id="L3330" name="L3330"></a>3330 
<a id="L3331" name="L3331"></a>3331             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L3332" name="L3332"></a>3332                 p = <a href="../S/804.html#L3287" title="Defined at 3287 in src/java/net/URI.java.">scanIPv4Address</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, n, <strong class="reserved">false</strong>);
<a id="L3333" name="L3333"></a>3333             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L3334" name="L3334"></a>3334                 <strong class="reserved">return</strong> -1;
<a id="L3335" name="L3335"></a>3335             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1762.html#L38" title="Defined at 38 in src/java/lang/NumberFormatException.java.">NumberFormatException</a> nfe) <em class="brace">{</em>
<a id="L3336" name="L3336"></a>3336                 <strong class="reserved">return</strong> -1;
<a id="L3337" name="L3337"></a>3337             <em class="brace">}</em>
<a id="L3338" name="L3338"></a>3338 
<a id="L3339" name="L3339"></a>3339             <strong class="reserved">if</strong> (p &gt; <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> &amp;&amp; p &lt; n) <em class="brace">{</em>
<a id="L3340" name="L3340"></a>3340                 <em class="comment">// IPv4 address is followed by something - check that</em>
<a id="L3341" name="L3341"></a>3341                 <em class="comment">// it's a ":" as this is the only valid character to</em>
<a id="L3342" name="L3342"></a>3342                 <em class="comment">// follow an address.</em>
<a id="L3343" name="L3343"></a>3343                 <strong class="reserved">if</strong> (<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(p) != ':') <em class="brace">{</em>
<a id="L3344" name="L3344"></a>3344                     p = -1;
<a id="L3345" name="L3345"></a>3345                 <em class="brace">}</em>
<a id="L3346" name="L3346"></a>3346             <em class="brace">}</em>
<a id="L3347" name="L3347"></a>3347 
<a id="L3348" name="L3348"></a>3348             <strong class="reserved">if</strong> (p &gt; <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>)
<a id="L3349" name="L3349"></a>3349                 host = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, p);
<a id="L3350" name="L3350"></a>3350 
<a id="L3351" name="L3351"></a>3351             <strong class="reserved">return</strong> p;
<a id="L3352" name="L3352"></a>3352         <em class="brace">}</em>
<a id="L3353" name="L3353"></a>3353 
<a id="L3354" name="L3354"></a>3354         <em class="comment">// hostname      = domainlabel [ "." ] | 1*( domainlabel "." ) toplabel [ "." ]</em>
<a id="L3355" name="L3355"></a>3355         <em class="comment">// domainlabel   = alphanum | alphanum *( alphanum | "-" ) alphanum</em>
<a id="L3356" name="L3356"></a>3356         <em class="comment">// toplabel      = alpha | alpha *( alphanum | "-" ) alphanum</em>
<a id="L3357" name="L3357"></a>3357         <em class="comment">//</em>
<a id="L3358" name="L3358"></a>3358         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../S/804.html#L3236" title="Referred from 3236 in src/java/net/URI.java.">parseHostname</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n)
<a id="L3359" name="L3359"></a>3359             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3360" name="L3360"></a>3360         <em class="brace">{</em>
<a id="L3361" name="L3361"></a>3361             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3362" name="L3362"></a>3362             <strong class="reserved">int</strong> q;
<a id="L3363" name="L3363"></a>3363             <strong class="reserved">int</strong> l = -1;                 <em class="comment">// Start of last parsed label</em>
<a id="L3364" name="L3364"></a>3364 
<a id="L3365" name="L3365"></a>3365             <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L3366" name="L3366"></a>3366                 <em class="comment">// domainlabel = alphanum [ *( alphanum | "-" ) alphanum ]</em>
<a id="L3367" name="L3367"></a>3367                 q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_ALPHANUM, H_ALPHANUM);
<a id="L3368" name="L3368"></a>3368                 <strong class="reserved">if</strong> (q &lt;= p)
<a id="L3369" name="L3369"></a>3369                     <strong class="reserved">break</strong>;
<a id="L3370" name="L3370"></a>3370                 l = p;
<a id="L3371" name="L3371"></a>3371                 <strong class="reserved">if</strong> (q &gt; p) <em class="brace">{</em>
<a id="L3372" name="L3372"></a>3372                     p = q;
<a id="L3373" name="L3373"></a>3373                     q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_ALPHANUM | L_DASH, H_ALPHANUM | H_DASH);
<a id="L3374" name="L3374"></a>3374                     <strong class="reserved">if</strong> (q &gt; p) <em class="brace">{</em>
<a id="L3375" name="L3375"></a>3375                         <strong class="reserved">if</strong> (<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(q - 1) == '-')
<a id="L3376" name="L3376"></a>3376                             <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Illegal character in hostname", q - 1);
<a id="L3377" name="L3377"></a>3377                         p = q;
<a id="L3378" name="L3378"></a>3378                     <em class="brace">}</em>
<a id="L3379" name="L3379"></a>3379                 <em class="brace">}</em>
<a id="L3380" name="L3380"></a>3380                 q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, '.');
<a id="L3381" name="L3381"></a>3381                 <strong class="reserved">if</strong> (q &lt;= p)
<a id="L3382" name="L3382"></a>3382                     <strong class="reserved">break</strong>;
<a id="L3383" name="L3383"></a>3383                 p = q;
<a id="L3384" name="L3384"></a>3384             <em class="brace">}</em> <strong class="reserved">while</strong> (p &lt; n);
<a id="L3385" name="L3385"></a>3385 
<a id="L3386" name="L3386"></a>3386             <strong class="reserved">if</strong> ((p &lt; n) &amp;&amp; !<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, ':'))
<a id="L3387" name="L3387"></a>3387                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Illegal character in hostname", p);
<a id="L3388" name="L3388"></a>3388 
<a id="L3389" name="L3389"></a>3389             <strong class="reserved">if</strong> (l &lt; 0)
<a id="L3390" name="L3390"></a>3390                 <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>("hostname", <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>);
<a id="L3391" name="L3391"></a>3391 
<a id="L3392" name="L3392"></a>3392             <em class="comment">// for a fully qualified hostname check that the rightmost</em>
<a id="L3393" name="L3393"></a>3393             <em class="comment">// label starts with an alpha character.</em>
<a id="L3394" name="L3394"></a>3394             <strong class="reserved">if</strong> (l &gt; <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> &amp;&amp; !<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>(<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(l), L_ALPHA, H_ALPHA)) <em class="brace">{</em>
<a id="L3395" name="L3395"></a>3395                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Illegal character in hostname", l);
<a id="L3396" name="L3396"></a>3396             <em class="brace">}</em>
<a id="L3397" name="L3397"></a>3397 
<a id="L3398" name="L3398"></a>3398             host = <a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, p);
<a id="L3399" name="L3399"></a>3399             <strong class="reserved">return</strong> p;
<a id="L3400" name="L3400"></a>3400         <em class="brace">}</em>
<a id="L3401" name="L3401"></a>3401 
<a id="L3402" name="L3402"></a>3402 
<a id="L3403" name="L3403"></a>3403         <em class="comment">// IPv6 address parsing, from RFC2373: IPv6 Addressing Architecture</em>
<a id="L3404" name="L3404"></a>3404         <em class="comment">//</em>
<a id="L3405" name="L3405"></a>3405         <em class="comment">// Bug: The grammar in RFC2373 Appendix B does not allow addresses of</em>
<a id="L3406" name="L3406"></a>3406         <em class="comment">// the form ::12.34.56.78, which are clearly shown in the examples</em>
<a id="L3407" name="L3407"></a>3407         <em class="comment">// earlier in the document.  Here is the original grammar:</em>
<a id="L3408" name="L3408"></a>3408         <em class="comment">//</em>
<a id="L3409" name="L3409"></a>3409         <em class="comment">//   IPv6address = hexpart [ ":" IPv4address ]</em>
<a id="L3410" name="L3410"></a>3410         <em class="comment">//   hexpart     = hexseq | hexseq "::" [ hexseq ] | "::" [ hexseq ]</em>
<a id="L3411" name="L3411"></a>3411         <em class="comment">//   hexseq      = hex4 *( ":" hex4)</em>
<a id="L3412" name="L3412"></a>3412         <em class="comment">//   hex4        = 1*4HEXDIG</em>
<a id="L3413" name="L3413"></a>3413         <em class="comment">//</em>
<a id="L3414" name="L3414"></a>3414         <em class="comment">// We therefore use the following revised grammar:</em>
<a id="L3415" name="L3415"></a>3415         <em class="comment">//</em>
<a id="L3416" name="L3416"></a>3416         <em class="comment">//   IPv6address = hexseq [ ":" IPv4address ]</em>
<a id="L3417" name="L3417"></a>3417         <em class="comment">//                 | hexseq [ "::" [ hexpost ] ]</em>
<a id="L3418" name="L3418"></a>3418         <em class="comment">//                 | "::" [ hexpost ]</em>
<a id="L3419" name="L3419"></a>3419         <em class="comment">//   hexpost     = hexseq | hexseq ":" IPv4address | IPv4address</em>
<a id="L3420" name="L3420"></a>3420         <em class="comment">//   hexseq      = hex4 *( ":" hex4)</em>
<a id="L3421" name="L3421"></a>3421         <em class="comment">//   hex4        = 1*4HEXDIG</em>
<a id="L3422" name="L3422"></a>3422         <em class="comment">//</em>
<a id="L3423" name="L3423"></a>3423         <em class="comment">// This covers all and only the following cases:</em>
<a id="L3424" name="L3424"></a>3424         <em class="comment">//</em>
<a id="L3425" name="L3425"></a>3425         <em class="comment">//   hexseq</em>
<a id="L3426" name="L3426"></a>3426         <em class="comment">//   hexseq : IPv4address</em>
<a id="L3427" name="L3427"></a>3427         <em class="comment">//   hexseq ::</em>
<a id="L3428" name="L3428"></a>3428         <em class="comment">//   hexseq :: hexseq</em>
<a id="L3429" name="L3429"></a>3429         <em class="comment">//   hexseq :: hexseq : IPv4address</em>
<a id="L3430" name="L3430"></a>3430         <em class="comment">//   hexseq :: IPv4address</em>
<a id="L3431" name="L3431"></a>3431         <em class="comment">//   :: hexseq</em>
<a id="L3432" name="L3432"></a>3432         <em class="comment">//   :: hexseq : IPv4address</em>
<a id="L3433" name="L3433"></a>3433         <em class="comment">//   :: IPv4address</em>
<a id="L3434" name="L3434"></a>3434         <em class="comment">//   ::</em>
<a id="L3435" name="L3435"></a>3435         <em class="comment">//</em>
<a id="L3436" name="L3436"></a>3436         <em class="comment">// Additionally we constrain the IPv6 address as follows :-</em>
<a id="L3437" name="L3437"></a>3437         <em class="comment">//</em>
<a id="L3438" name="L3438"></a>3438         <em class="comment">//  i.  IPv6 addresses without compressed zeros should contain</em>
<a id="L3439" name="L3439"></a>3439         <em class="comment">//      exactly 16 bytes.</em>
<a id="L3440" name="L3440"></a>3440         <em class="comment">//</em>
<a id="L3441" name="L3441"></a>3441         <em class="comment">//  ii. IPv6 addresses with compressed zeros should contain</em>
<a id="L3442" name="L3442"></a>3442         <em class="comment">//      less than 16 bytes.</em>
<a id="L3443" name="L3443"></a>3443 
<a id="L3444" name="L3444"></a>3444         <strong class="reserved">private</strong> <strong class="reserved">int</strong> ipv6byteCount = 0;
<a id="L3445" name="L3445"></a>3445 
<a id="L3446" name="L3446"></a>3446         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/24559.html" title="Multiple referred from 2 places.">parseIPv6Reference</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n)
<a id="L3447" name="L3447"></a>3447             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3448" name="L3448"></a>3448         <em class="brace">{</em>
<a id="L3449" name="L3449"></a>3449             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3450" name="L3450"></a>3450             <strong class="reserved">int</strong> q;
<a id="L3451" name="L3451"></a>3451             <strong class="reserved">boolean</strong> compressedZeros = <strong class="reserved">false</strong>;
<a id="L3452" name="L3452"></a>3452 
<a id="L3453" name="L3453"></a>3453             q = <a href="../S/804.html#L3506" title="Defined at 3506 in src/java/net/URI.java.">scanHexSeq</a>(p, n);
<a id="L3454" name="L3454"></a>3454 
<a id="L3455" name="L3455"></a>3455             <strong class="reserved">if</strong> (q &gt; p) <em class="brace">{</em>
<a id="L3456" name="L3456"></a>3456                 p = q;
<a id="L3457" name="L3457"></a>3457                 <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, "::")) <em class="brace">{</em>
<a id="L3458" name="L3458"></a>3458                     compressedZeros = <strong class="reserved">true</strong>;
<a id="L3459" name="L3459"></a>3459                     p = <a href="../S/804.html#L3480" title="Defined at 3480 in src/java/net/URI.java.">scanHexPost</a>(p + 2, n);
<a id="L3460" name="L3460"></a>3460                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, ':')) <em class="brace">{</em>
<a id="L3461" name="L3461"></a>3461                     p = <a href="../S/804.html#L3315" title="Defined at 3315 in src/java/net/URI.java.">takeIPv4Address</a>(p + 1,  n, "IPv4 address");
<a id="L3462" name="L3462"></a>3462                     ipv6byteCount += 4;
<a id="L3463" name="L3463"></a>3463                 <em class="brace">}</em>
<a id="L3464" name="L3464"></a>3464             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, "::")) <em class="brace">{</em>
<a id="L3465" name="L3465"></a>3465                 compressedZeros = <strong class="reserved">true</strong>;
<a id="L3466" name="L3466"></a>3466                 p = <a href="../S/804.html#L3480" title="Defined at 3480 in src/java/net/URI.java.">scanHexPost</a>(p + 2, n);
<a id="L3467" name="L3467"></a>3467             <em class="brace">}</em>
<a id="L3468" name="L3468"></a>3468             <strong class="reserved">if</strong> (p &lt; n)
<a id="L3469" name="L3469"></a>3469                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Malformed IPv6 address", <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>);
<a id="L3470" name="L3470"></a>3470             <strong class="reserved">if</strong> (ipv6byteCount &gt; 16)
<a id="L3471" name="L3471"></a>3471                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("IPv6 address too long", <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>);
<a id="L3472" name="L3472"></a>3472             <strong class="reserved">if</strong> (!compressedZeros &amp;&amp; ipv6byteCount &lt; 16)
<a id="L3473" name="L3473"></a>3473                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("IPv6 address too short", <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>);
<a id="L3474" name="L3474"></a>3474             <strong class="reserved">if</strong> (compressedZeros &amp;&amp; ipv6byteCount == 16)
<a id="L3475" name="L3475"></a>3475                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("Malformed IPv6 address", <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>);
<a id="L3476" name="L3476"></a>3476 
<a id="L3477" name="L3477"></a>3477             <strong class="reserved">return</strong> p;
<a id="L3478" name="L3478"></a>3478         <em class="brace">}</em>
<a id="L3479" name="L3479"></a>3479 
<a id="L3480" name="L3480"></a>3480         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/26638.html" title="Multiple referred from 2 places.">scanHexPost</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n)
<a id="L3481" name="L3481"></a>3481             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3482" name="L3482"></a>3482         <em class="brace">{</em>
<a id="L3483" name="L3483"></a>3483             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3484" name="L3484"></a>3484             <strong class="reserved">int</strong> q;
<a id="L3485" name="L3485"></a>3485 
<a id="L3486" name="L3486"></a>3486             <strong class="reserved">if</strong> (p == n)
<a id="L3487" name="L3487"></a>3487                 <strong class="reserved">return</strong> p;
<a id="L3488" name="L3488"></a>3488 
<a id="L3489" name="L3489"></a>3489             q = <a href="../S/804.html#L3506" title="Defined at 3506 in src/java/net/URI.java.">scanHexSeq</a>(p, n);
<a id="L3490" name="L3490"></a>3490             <strong class="reserved">if</strong> (q &gt; p) <em class="brace">{</em>
<a id="L3491" name="L3491"></a>3491                 p = q;
<a id="L3492" name="L3492"></a>3492                 <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, ':')) <em class="brace">{</em>
<a id="L3493" name="L3493"></a>3493                     p++;
<a id="L3494" name="L3494"></a>3494                     p = <a href="../S/804.html#L3315" title="Defined at 3315 in src/java/net/URI.java.">takeIPv4Address</a>(p, n, "hex digits or IPv4 address");
<a id="L3495" name="L3495"></a>3495                     ipv6byteCount += 4;
<a id="L3496" name="L3496"></a>3496                 <em class="brace">}</em>
<a id="L3497" name="L3497"></a>3497             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L3498" name="L3498"></a>3498                 p = <a href="../S/804.html#L3315" title="Defined at 3315 in src/java/net/URI.java.">takeIPv4Address</a>(p, n, "hex digits or IPv4 address");
<a id="L3499" name="L3499"></a>3499                 ipv6byteCount += 4;
<a id="L3500" name="L3500"></a>3500             <em class="brace">}</em>
<a id="L3501" name="L3501"></a>3501             <strong class="reserved">return</strong> p;
<a id="L3502" name="L3502"></a>3502         <em class="brace">}</em>
<a id="L3503" name="L3503"></a>3503 
<a id="L3504" name="L3504"></a>3504         <em class="comment">// Scan a hex sequence; return -1 if one could not be scanned</em>
<a id="L3505" name="L3505"></a>3505         <em class="comment">//</em>
<a id="L3506" name="L3506"></a>3506         <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/26639.html" title="Multiple referred from 2 places.">scanHexSeq</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> n)
<a id="L3507" name="L3507"></a>3507             <strong class="reserved">throws</strong> <a href="../S/791.html#L38" title="Defined at 38 in src/java/net/URISyntaxException.java.">URISyntaxException</a>
<a id="L3508" name="L3508"></a>3508         <em class="brace">{</em>
<a id="L3509" name="L3509"></a>3509             <strong class="reserved">int</strong> p = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L3510" name="L3510"></a>3510             <strong class="reserved">int</strong> q;
<a id="L3511" name="L3511"></a>3511 
<a id="L3512" name="L3512"></a>3512             q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_HEX, H_HEX);
<a id="L3513" name="L3513"></a>3513             <strong class="reserved">if</strong> (q &lt;= p)
<a id="L3514" name="L3514"></a>3514                 <strong class="reserved">return</strong> -1;
<a id="L3515" name="L3515"></a>3515             <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(q, n, '.'))          <em class="comment">// Beginning of IPv4 address</em>
<a id="L3516" name="L3516"></a>3516                 <strong class="reserved">return</strong> -1;
<a id="L3517" name="L3517"></a>3517             <strong class="reserved">if</strong> (q &gt; p + 4)
<a id="L3518" name="L3518"></a>3518                 <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("IPv6 hexadecimal digit sequence too long", p);
<a id="L3519" name="L3519"></a>3519             ipv6byteCount += 2;
<a id="L3520" name="L3520"></a>3520             p = q;
<a id="L3521" name="L3521"></a>3521             <strong class="reserved">while</strong> (p &lt; n) <em class="brace">{</em>
<a id="L3522" name="L3522"></a>3522                 <strong class="reserved">if</strong> (!<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p, n, ':'))
<a id="L3523" name="L3523"></a>3523                     <strong class="reserved">break</strong>;
<a id="L3524" name="L3524"></a>3524                 <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(p + 1, n, ':'))
<a id="L3525" name="L3525"></a>3525                     <strong class="reserved">break</strong>;              <em class="comment">// "::"</em>
<a id="L3526" name="L3526"></a>3526                 p++;
<a id="L3527" name="L3527"></a>3527                 q = <a href="../D/31557.html" title="Multiple defined in 18 places.">scan</a>(p, n, L_HEX, H_HEX);
<a id="L3528" name="L3528"></a>3528                 <strong class="reserved">if</strong> (q &lt;= p)
<a id="L3529" name="L3529"></a>3529                     <a href="../D/15968.html" title="Multiple defined in 2 places.">failExpecting</a>("digits for an IPv6 address", p);
<a id="L3530" name="L3530"></a>3530                 <strong class="reserved">if</strong> (<a href="../D/11601.html" title="Multiple defined in 3 places.">at</a>(q, n, '.')) <em class="brace">{</em>    <em class="comment">// Beginning of IPv4 address</em>
<a id="L3531" name="L3531"></a>3531                     p--;
<a id="L3532" name="L3532"></a>3532                     <strong class="reserved">break</strong>;
<a id="L3533" name="L3533"></a>3533                 <em class="brace">}</em>
<a id="L3534" name="L3534"></a>3534                 <strong class="reserved">if</strong> (q &gt; p + 4)
<a id="L3535" name="L3535"></a>3535                     <a href="../D/15966.html" title="Multiple defined in 7 places.">fail</a>("IPv6 hexadecimal digit sequence too long", p);
<a id="L3536" name="L3536"></a>3536                 ipv6byteCount += 2;
<a id="L3537" name="L3537"></a>3537                 p = q;
<a id="L3538" name="L3538"></a>3538             <em class="brace">}</em>
<a id="L3539" name="L3539"></a>3539 
<a id="L3540" name="L3540"></a>3540             <strong class="reserved">return</strong> p;
<a id="L3541" name="L3541"></a>3541         <em class="brace">}</em>
<a id="L3542" name="L3542"></a>3542 
<a id="L3543" name="L3543"></a>3543     <em class="brace">}</em>
<a id="L3544" name="L3544"></a>3544 
<a id="L3545" name="L3545"></a>3545 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L848">[^]</a><a href="#L3506">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>