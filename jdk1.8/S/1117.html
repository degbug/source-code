<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/util/concurrent/ThreadPoolExecutor.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L389">[^]</a><a href="#L2091">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L389" title="Defined at 389.">runStateOf</a></li>
<li><a href="#L390" title="Defined at 390.">workerCountOf</a></li>
<li><a href="#L391" title="Defined at 391.">ctlOf</a></li>
<li><a href="#L398" title="Defined at 398.">runStateLessThan</a></li>
<li><a href="#L402" title="Defined at 402.">runStateAtLeast</a></li>
<li><a href="#L406" title="Defined at 406.">isRunning</a></li>
<li><a href="#L413" title="Defined at 413.">compareAndIncrementWorkerCount</a></li>
<li><a href="#L420" title="Defined at 420.">compareAndDecrementWorkerCount</a></li>
<li><a href="#L429" title="Defined at 429.">decrementWorkerCount</a></li>
<li><a href="#L616" title="Defined at 616.">run</a></li>
<li><a href="#L625" title="Defined at 625.">isHeldExclusively</a></li>
<li><a href="#L629" title="Defined at 629.">tryAcquire</a></li>
<li><a href="#L637" title="Defined at 637.">tryRelease</a></li>
<li><a href="#L643" title="Defined at 643.">lock</a></li>
<li><a href="#L644" title="Defined at 644.">tryLock</a></li>
<li><a href="#L645" title="Defined at 645.">unlock</a></li>
<li><a href="#L646" title="Defined at 646.">isLocked</a></li>
<li><a href="#L648" title="Defined at 648.">interruptIfStarted</a></li>
<li><a href="#L670" title="Defined at 670.">advanceRunState</a></li>
<li><a href="#L689" title="Defined at 689.">tryTerminate</a></li>
<li><a href="#L732" title="Defined at 732.">checkShutdownAccess</a></li>
<li><a href="#L751" title="Defined at 751.">interruptWorkers</a></li>
<li><a href="#L781" title="Defined at 781.">interruptIdleWorkers</a></li>
<li><a href="#L807" title="Defined at 807.">interruptIdleWorkers</a></li>
<li><a href="#L822" title="Defined at 822.">reject</a></li>
<li><a href="#L831" title="Defined at 831.">onShutdown</a></li>
<li><a href="#L840" title="Defined at 840.">isRunningOrShutdown</a></li>
<li><a href="#L851" title="Defined at 851.">drainQueue</a></li>
<li><a href="#L894" title="Defined at 894.">addWorker</a></li>
<li><a href="#L968" title="Defined at 968.">addWorkerFailed</a></li>
<li><a href="#L994" title="Defined at 994.">processWorkerExit</a></li>
<li><a href="#L1039" title="Defined at 1039.">getTask</a></li>
<li><a href="#L1120" title="Defined at 1120.">runWorker</a></li>
<li><a href="#L1332" title="Defined at 1332.">execute</a></li>
<li><a href="#L1383" title="Defined at 1383.">shutdown</a></li>
<li><a href="#L1414" title="Defined at 1414.">shutdownNow</a></li>
<li><a href="#L1430" title="Defined at 1430.">isShutdown</a></li>
<li><a href="#L1445" title="Defined at 1445.">isTerminating</a></li>
<li><a href="#L1450" title="Defined at 1450.">isTerminated</a></li>
<li><a href="#L1454" title="Defined at 1454.">awaitTermination</a></li>
<li><a href="#L1476" title="Defined at 1476.">finalize</a></li>
<li><a href="#L1487" title="Defined at 1487.">setThreadFactory</a></li>
<li><a href="#L1499" title="Defined at 1499.">getThreadFactory</a></li>
<li><a href="#L1510" title="Defined at 1510.">setRejectedExecutionHandler</a></li>
<li><a href="#L1522" title="Defined at 1522.">getRejectedExecutionHandler</a></li>
<li><a href="#L1537" title="Defined at 1537.">setCorePoolSize</a></li>
<li><a href="#L1563" title="Defined at 1563.">getCorePoolSize</a></li>
<li><a href="#L1575" title="Defined at 1575.">prestartCoreThread</a></li>
<li><a href="#L1584" title="Defined at 1584.">ensurePrestart</a></li>
<li><a href="#L1599" title="Defined at 1599.">prestartAllCoreThreads</a></li>
<li><a href="#L1619" title="Defined at 1619.">allowsCoreThreadTimeOut</a></li>
<li><a href="#L1640" title="Defined at 1640.">allowCoreThreadTimeOut</a></li>
<li><a href="#L1662" title="Defined at 1662.">setMaximumPoolSize</a></li>
<li><a href="#L1676" title="Defined at 1676.">getMaximumPoolSize</a></li>
<li><a href="#L1694" title="Defined at 1694.">setKeepAliveTime</a></li>
<li><a href="#L1715" title="Defined at 1715.">getKeepAliveTime</a></li>
<li><a href="#L1729" title="Defined at 1729.">getQueue</a></li>
<li><a href="#L1749" title="Defined at 1749.">remove</a></li>
<li><a href="#L1765" title="Defined at 1765.">purge</a></li>
<li><a href="#L1793" title="Defined at 1793.">getPoolSize</a></li>
<li><a href="#L1812" title="Defined at 1812.">getActiveCount</a></li>
<li><a href="#L1832" title="Defined at 1832.">getLargestPoolSize</a></li>
<li><a href="#L1850" title="Defined at 1850.">getTaskCount</a></li>
<li><a href="#L1875" title="Defined at 1875.">getCompletedTaskCount</a></li>
<li><a href="#L1895" title="Defined at 1895.">toString</a></li>
<li><a href="#L1941" title="Defined at 1941.">beforeExecute</a></li>
<li><a href="#L1989" title="Defined at 1989.">afterExecute</a></li>
<li><a href="#L1997" title="Defined at 1997.">terminated</a></li>
<li><a href="#L2020" title="Defined at 2020.">rejectedExecution</a></li>
<li><a href="#L2044" title="Defined at 2044.">rejectedExecution</a></li>
<li><a href="#L2067" title="Defined at 2067.">rejectedExecution</a></li>
<li><a href="#L2091" title="Defined at 2091.">rejectedExecution</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L24" name="L24"></a>  24 
<div class="comment">
  Written by Doug Lea with assistance from members of JCP JSR-166
  Expert Group and released to the public domain, as explained at
  http://creativecommons.org/publicdomain/zero/1.0/</div>
<a id="L35" name="L35"></a>  35 
<a id="L36" name="L36"></a>  36 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util.concurrent;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> java.util.concurrent.locks.AbstractQueuedSynchronizer;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> java.util.concurrent.locks.Condition;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> java.util.concurrent.locks.ReentrantLock;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.util.concurrent.atomic.AtomicInteger;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> java.util.*;
<a id="L42" name="L42"></a>  42 
<div class="comment">
  An {@link ExecutorService} that executes each submitted task using
  one of possibly several pooled threads, normally configured
  using {@link Executors} factory methods.
  <p>Thread pools address two different problems: they usually
  provide improved performance when executing large numbers of
  asynchronous tasks, due to reduced per-task invocation overhead,
  and they provide a means of bounding and managing the resources,
  including threads, consumed when executing a collection of tasks.
  Each <code>ThreadPoolExecutor</code> also maintains some basic
  statistics, such as the number of completed tasks.
  </p><p>To be useful across a wide range of contexts, this class
  provides many adjustable parameters and extensibility
  hooks. However, programmers are urged to use the more convenient
  {@link Executors} factory methods {@link
  Executors#newCachedThreadPool} (unbounded thread pool, with
  automatic thread reclamation), {@link Executors#newFixedThreadPool}
  (fixed size thread pool) and {@link
  Executors#newSingleThreadExecutor} (single background thread), that
  preconfigure settings for the most common usage
  scenarios. Otherwise, use the following guide when manually
  configuring and tuning this class:
  </p><dl>
  <dt>Core and maximum pool sizes</dt>
  <dd>A <code>ThreadPoolExecutor</code> will automatically adjust the
  pool size (see {@link #getPoolSize})
  according to the bounds set by
  corePoolSize (see {@link #getCorePoolSize}) and
  maximumPoolSize (see {@link #getMaximumPoolSize}).
  When a new task is submitted in method {@link #execute(Runnable)},
  and fewer than corePoolSize threads are running, a new thread is
  created to handle the request, even if other worker threads are
  idle.  If there are more than corePoolSize but less than
  maximumPoolSize threads running, a new thread will be created only
  if the queue is full.  By setting corePoolSize and maximumPoolSize
  the same, you create a fixed-size thread pool. By setting
  maximumPoolSize to an essentially unbounded value such as {@code
  Integer.MAX_VALUE}, you allow the pool to accommodate an arbitrary
  number of concurrent tasks. Most typically, core and maximum pool
  sizes are set only upon construction, but they may also be changed
  dynamically using {@link #setCorePoolSize} and {@link
  #setMaximumPoolSize}. </dd>
  <dt>On-demand construction</dt>
  <dd>By default, even core threads are initially created and
  started only when new tasks arrive, but this can be overridden
  dynamically using method {@link #prestartCoreThread} or {@link
  #prestartAllCoreThreads}.  You probably want to prestart threads if
  you construct the pool with a non-empty queue. </dd>
  <dt>Creating new threads</dt>
  <dd>New threads are created using a {@link ThreadFactory}.  If not
  otherwise specified, a {@link Executors#defaultThreadFactory} is
  used, that creates threads to all be in the same {@link
  ThreadGroup} and with the same <code>NORM_PRIORITY</code> priority and
  non-daemon status. By supplying a different ThreadFactory, you can
  alter the thread's name, thread group, priority, daemon status,
  etc. If a <code>ThreadFactory</code> fails to create a thread when asked
  by returning null from <code>newThread</code>, the executor will
  continue, but might not be able to execute any tasks. Threads
  should possess the "modifyThread" <code>RuntimePermission</code>. If
  worker threads or other threads using the pool do not possess this
  permission, service may be degraded: configuration changes may not
  take effect in a timely manner, and a shutdown pool may remain in a
  state in which termination is possible but not completed.</dd>
  <dt>Keep-alive times</dt>
  <dd>If the pool currently has more than corePoolSize threads,
  excess threads will be terminated if they have been idle for more
  than the keepAliveTime (see {@link #getKeepAliveTime(TimeUnit)}).
  This provides a means of reducing resource consumption when the
  pool is not being actively used. If the pool becomes more active
  later, new threads will be constructed. This parameter can also be
  changed dynamically using method {@link #setKeepAliveTime(long,
  TimeUnit)}.  Using a value of <code>Long.MAX_VALUE</code> {@link
  TimeUnit#NANOSECONDS} effectively disables idle threads from ever
  terminating prior to shut down. By default, the keep-alive policy
  applies only when there are more than corePoolSize threads. But
  method {@link #allowCoreThreadTimeOut(boolean)} can be used to
  apply this time-out policy to core threads as well, so long as the
  keepAliveTime value is non-zero. </dd>
  <dt>Queuing</dt>
  <dd>Any {@link BlockingQueue} may be used to transfer and hold
  submitted tasks.  The use of this queue interacts with pool sizing:
  <ul><li> If fewer than corePoolSize threads are running, the Executor
  always prefers adding a new thread
  rather than queuing.</li><li> If corePoolSize or more threads are running, the Executor
  always prefers queuing a request rather than adding a new
  thread.</li><li> If a request cannot be queued, a new thread is created unless
  this would exceed maximumPoolSize, in which case, the task will be
  rejected.</li>
  </ul>
  There are three general strategies for queuing:
  <ol>
  <li> <em> Direct handoffs.</em> A good default choice for a work
  queue is a {@link SynchronousQueue} that hands off tasks to threads
  without otherwise holding them. Here, an attempt to queue a task
  will fail if no threads are immediately available to run it, so a
  new thread will be constructed. This policy avoids lockups when
  handling sets of requests that might have internal dependencies.
  Direct handoffs generally require unbounded maximumPoolSizes to
  avoid rejection of new submitted tasks. This in turn admits the
  possibility of unbounded thread growth when commands continue to
  arrive on average faster than they can be processed.  </li><li><em> Unbounded queues.</em> Using an unbounded queue (for
  example a {@link LinkedBlockingQueue} without a predefined
  capacity) will cause new tasks to wait in the queue when all
  corePoolSize threads are busy. Thus, no more than corePoolSize
  threads will ever be created. (And the value of the maximumPoolSize
  therefore doesn't have any effect.)  This may be appropriate when
  each task is completely independent of others, so tasks cannot
  affect each others execution; for example, in a web page server.
  While this style of queuing can be useful in smoothing out
  transient bursts of requests, it admits the possibility of
  unbounded work queue growth when commands continue to arrive on
  average faster than they can be processed.  </li><li><em>Bounded queues.</em> A bounded queue (for example, an
  {@link ArrayBlockingQueue}) helps prevent resource exhaustion when
  used with finite maximumPoolSizes, but can be more difficult to
  tune and control.  Queue sizes and maximum pool sizes may be traded
  off for each other: Using large queues and small pools minimizes
  CPU usage, OS resources, and context-switching overhead, but can
  lead to artificially low throughput.  If tasks frequently block (for
  example if they are I/O bound), a system may be able to schedule
  time for more threads than you otherwise allow. Use of small queues
  generally requires larger pool sizes, which keeps CPUs busier but
  may encounter unacceptable scheduling overhead, which also
  decreases throughput.  </li><li> In the default {@link ThreadPoolExecutor.AbortPolicy}, the
  handler throws a runtime {@link RejectedExecutionException} upon
  rejection. </li><li> In {@link ThreadPoolExecutor.CallerRunsPolicy}, the thread
  that invokes <code>execute</code> itself runs the task. This provides a
  simple feedback control mechanism that will slow down the rate that
  new tasks are submitted. </li><li> In {@link ThreadPoolExecutor.DiscardPolicy}, a task that
  cannot be executed is simply dropped.  </li><li>In {@link ThreadPoolExecutor.DiscardOldestPolicy}, if the
  executor is not shut down, the task at the head of the work queue
  is dropped, and then execution is retried (which can fail again,
  causing this to be repeated.) </li>
  </ol>
  It is possible to define and use other kinds of {@link
  RejectedExecutionHandler} classes. Doing so requires some care
  especially when policies are designed to work only under particular
  capacity or queuing policies. </dd>
  <dt>Hook methods</dt>
  <dd>This class provides <code>protected</code> overridable
  {@link #beforeExecute(Thread, Runnable)} and
  {@link #afterExecute(Runnable, Throwable)} methods that are called
  before and after execution of each task.  These can be used to
  manipulate the execution environment; for example, reinitializing
  ThreadLocals, gathering statistics, or adding log entries.
  Additionally, method {@link #terminated} can be overridden to perform
  any special processing that needs to be done once the Executor has
  fully terminated.
  <p>If hook or callback methods throw exceptions, internal worker
  threads may in turn fail and abruptly terminate.</p></dd>
  <dt>Queue maintenance</dt>
  <dd>Method {@link #getQueue()} allows access to the work queue
  for purposes of monitoring and debugging.  Use of this method for
  any other purpose is strongly discouraged.  Two supplied methods,
  {@link #remove(Runnable)} and {@link #purge} are available to
  assist in storage reclamation when large numbers of queued tasks
  become cancelled.</dd>
  <dt>Finalization</dt>
  <dd>A pool that is no longer referenced in a program <em>AND</em>
  has no remaining threads will be <code>shutdown</code> automatically. If
  you would like to ensure that unreferenced pools are reclaimed even
  if users forget to call {@link #shutdown}, then you must arrange
  that unused threads eventually die, by setting appropriate
  keep-alive times, using a lower bound of zero core threads and/or
  setting {@link #allowCoreThreadTimeOut(boolean)}.  </dd>
  </dl>
  <p><b>Extension example</b>. Most extensions of this class
  override one or more of the protected hook methods. For example,
  here is a subclass that adds a simple pause/resume feature:
   </p><pre> {@code
  class PausableThreadPoolExecutor extends ThreadPoolExecutor {
    private boolean isPaused;
    private ReentrantLock pauseLock = new ReentrantLock();
    private Condition unpaused = pauseLock.newCondition();
    public PausableThreadPoolExecutor(...) { super(...); }
    protected void beforeExecute(Thread t, Runnable r) {
      super.beforeExecute(t, r);
      pauseLock.lock();
      try {
        while (isPaused) unpaused.await();
      } catch (InterruptedException ie) {
        t.interrupt();
      } finally {
        pauseLock.unlock();
      }
    }
    public void pause() {
      pauseLock.lock();
      try {
        isPaused = true;
      } finally {
        pauseLock.unlock();
      }
    }
    public void resume() {
      pauseLock.lock();
      try {
        isPaused = false;
        unpaused.signalAll();
      } finally {
        pauseLock.unlock();
      }
    }
  }}</pre>
  @since 1.5
  @author Doug Lea</div>
<a id="L319" name="L319"></a> 319 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/8145.html" title="Multiple referred from 19 places.">ThreadPoolExecutor</a> <strong class="reserved">extends</strong> <a href="../S/1105.html#L71" title="Defined at 71 in src/java/util/concurrent/AbstractExecutorService.java.">AbstractExecutorService</a> <em class="brace">{</em>
<div class="comment">
      The main pool control state, ctl, is an atomic integer packing
      two conceptual fields
        workerCount, indicating the effective number of threads
        runState,    indicating whether running, shutting down etc
      In order to pack them into one int, we limit workerCount to
      (2^29)-1 (about 500 million) threads rather than (2^31)-1 (2
      billion) otherwise representable. If this is ever an issue in
      the future, the variable can be changed to be an AtomicLong,
      and the shift/mask constants below adjusted. But until the need
      arises, this code is a bit faster and simpler using an int.
      The workerCount is the number of workers that have been
      permitted to start and not permitted to stop.  The value may be
      transiently different from the actual number of live threads,
      for example when a ThreadFactory fails to create a thread when
      asked, and when exiting threads are still performing
      bookkeeping before terminating. The user-visible pool size is
      reported as the current size of the workers set.
      The runState provides the main lifecycle control, taking on values:
        RUNNING:  Accept new tasks and process queued tasks
        SHUTDOWN: Don't accept new tasks, but process queued tasks
        STOP:     Don't accept new tasks, don't process queued tasks,
                  and interrupt in-progress tasks
        TIDYING:  All tasks have terminated, workerCount is zero,
                  the thread transitioning to state TIDYING
                  will run the terminated() hook method
        TERMINATED: terminated() has completed
      The numerical order among these values matters, to allow
      ordered comparisons. The runState monotonically increases over
      time, but need not hit each state. The transitions are:
      RUNNING -&gt; SHUTDOWN
         On invocation of shutdown(), perhaps implicitly in finalize()
      (RUNNING or SHUTDOWN) -&gt; STOP
         On invocation of shutdownNow()
      SHUTDOWN -&gt; TIDYING
         When both queue and pool are empty
      STOP -&gt; TIDYING
         When pool is empty
      TIDYING -&gt; TERMINATED
         When the terminated() hook method has completed
      Threads waiting in awaitTermination() will return when the
      state reaches TERMINATED.
      Detecting the transition from SHUTDOWN to TIDYING is less
      straightforward than you'd like because the queue may become
      empty after non-empty and vice versa during SHUTDOWN state, but
      we can only terminate if, after seeing that it is empty, we see
      that workerCount is 0 (which sometimes entails a recheck -- see
      below).</div>
<a id="L377" name="L377"></a> 377     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1089.html#L54" title="Defined at 54 in src/java/util/concurrent/atomic/AtomicInteger.java.">AtomicInteger</a> ctl = <strong class="reserved">new</strong> <a href="../S/1089.html#L54" title="Defined at 54 in src/java/util/concurrent/atomic/AtomicInteger.java.">AtomicInteger</a>(<a href="../S/1117.html#L391" title="Defined at 391 in src/java/util/concurrent/ThreadPoolExecutor.java.">ctlOf</a>(RUNNING, 0));
<a id="L378" name="L378"></a> 378     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> COUNT_BITS = <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../S/6754.html#L474" title="Defined at 474 in src/com/sun/java/swing/plaf/windows/TMSchema.java.">SIZE</a> - 3;
<a id="L379" name="L379"></a> 379     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> CAPACITY   = (1 &lt;&lt; COUNT_BITS) - 1;
<a id="L380" name="L380"></a> 380 
<a id="L381" name="L381"></a> 381     <em class="comment">// runState is stored in the high-order bits</em>
<a id="L382" name="L382"></a> 382     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> RUNNING    = -1 &lt;&lt; COUNT_BITS;
<a id="L383" name="L383"></a> 383     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> SHUTDOWN   =  0 &lt;&lt; COUNT_BITS;
<a id="L384" name="L384"></a> 384     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> STOP       =  1 &lt;&lt; COUNT_BITS;
<a id="L385" name="L385"></a> 385     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> TIDYING    =  2 &lt;&lt; COUNT_BITS;
<a id="L386" name="L386"></a> 386     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> TERMINATED =  3 &lt;&lt; COUNT_BITS;
<a id="L387" name="L387"></a> 387 
<a id="L388" name="L388"></a> 388     <em class="comment">// Packing and unpacking ctl</em>
<a id="L389" name="L389"></a> 389     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/26556.html" title="Multiple referred from 6 places.">runStateOf</a>(<strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)     <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; ~CAPACITY; <em class="brace">}</em>
<a id="L390" name="L390"></a> 390     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/30526.html" title="Multiple referred from 11 places.">workerCountOf</a>(<strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)  <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; CAPACITY; <em class="brace">}</em>
<a id="L391" name="L391"></a> 391     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/12851.html" title="Multiple referred from 4 places.">ctlOf</a>(<strong class="reserved">int</strong> rs, <strong class="reserved">int</strong> wc) <em class="brace">{</em> <strong class="reserved">return</strong> rs | wc; <em class="brace">}</em>
<a id="L392" name="L392"></a> 392 
<div class="comment">
      Bit field accessors that don't require unpacking ctl.
      These depend on the bit layout and on workerCount being never negative.</div>
<a id="L397" name="L397"></a> 397 
<a id="L398" name="L398"></a> 398     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/26555.html" title="Multiple referred from 3 places.">runStateLessThan</a>(<strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <strong class="reserved">int</strong> s) <em class="brace">{</em>
<a id="L399" name="L399"></a> 399         <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; s;
<a id="L400" name="L400"></a> 400     <em class="brace">}</em>
<a id="L401" name="L401"></a> 401 
<a id="L402" name="L402"></a> 402     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/26554.html" title="Multiple referred from 8 places.">runStateAtLeast</a>(<strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <strong class="reserved">int</strong> s) <em class="brace">{</em>
<a id="L403" name="L403"></a> 403         <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= s;
<a id="L404" name="L404"></a> 404     <em class="brace">}</em>
<a id="L405" name="L405"></a> 405 
<a id="L406" name="L406"></a> 406     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/21985.html" title="Multiple referred from 21 places.">isRunning</a>(<strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L407" name="L407"></a> 407         <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; SHUTDOWN;
<a id="L408" name="L408"></a> 408     <em class="brace">}</em>
<a id="L409" name="L409"></a> 409 
<div class="comment">
      Attempts to CAS-increment the workerCount field of ctl.</div>
<a id="L413" name="L413"></a> 413     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1117.html#L912" title="Referred from 912 in src/java/util/concurrent/ThreadPoolExecutor.java.">compareAndIncrementWorkerCount</a>(<strong class="reserved">int</strong> expect) <em class="brace">{</em>
<a id="L414" name="L414"></a> 414         <strong class="reserved">return</strong> ctl.<a href="../D/13035.html" title="Multiple defined in 16 places.">compareAndSet</a>(expect, expect + 1);
<a id="L415" name="L415"></a> 415     <em class="brace">}</em>
<a id="L416" name="L416"></a> 416 
<div class="comment">
      Attempts to CAS-decrement the workerCount field of ctl.</div>
<a id="L420" name="L420"></a> 420     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/11692.html" title="Multiple referred from 2 places.">compareAndDecrementWorkerCount</a>(<strong class="reserved">int</strong> expect) <em class="brace">{</em>
<a id="L421" name="L421"></a> 421         <strong class="reserved">return</strong> ctl.<a href="../D/13035.html" title="Multiple defined in 16 places.">compareAndSet</a>(expect, expect - 1);
<a id="L422" name="L422"></a> 422     <em class="brace">}</em>
<a id="L423" name="L423"></a> 423 
<div class="comment">
      Decrements the workerCount field of ctl. This is called only on
      abrupt termination of a thread (see processWorkerExit). Other
      decrements are performed within getTask.</div>
<a id="L429" name="L429"></a> 429     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/13128.html" title="Multiple referred from 3 places.">decrementWorkerCount</a>() <em class="brace">{</em>
<a id="L430" name="L430"></a> 430         <strong class="reserved">do</strong> <em class="brace">{</em><em class="brace">}</em> <strong class="reserved">while</strong> (! <a href="../S/1117.html#L420" title="Defined at 420 in src/java/util/concurrent/ThreadPoolExecutor.java.">compareAndDecrementWorkerCount</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>()));
<a id="L431" name="L431"></a> 431     <em class="brace">}</em>
<a id="L432" name="L432"></a> 432 
<div class="comment">
      The queue used for holding tasks and handing off to worker
      threads.  We do not require that workQueue.poll() returning
      null necessarily means that workQueue.isEmpty(), so rely
      solely on isEmpty to see if the queue is empty (which we must
      do for example when deciding whether to transition from
      SHUTDOWN to TIDYING).  This accommodates special-purpose
      queues such as DelayQueues for which poll() is allowed to
      return null even if it may later return non-null when delays
      expire.</div>
<a id="L444" name="L444"></a> 444     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1109.html#L180" title="Defined at 180 in src/java/util/concurrent/BlockingQueue.java.">BlockingQueue</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; workQueue;
<a id="L445" name="L445"></a> 445 
<div class="comment">
      Lock held on access to workers set and related bookkeeping.
      While we could use a concurrent set of some sort, it turns out
      to be generally preferable to use a lock. Among the reasons is
      that this serializes interruptIdleWorkers, which avoids
      unnecessary interrupt storms, especially during shutdown.
      Otherwise exiting threads would concurrently interrupt those
      that have not yet interrupted. It also simplifies some of the
      associated statistics bookkeeping of largestPoolSize etc. We
      also hold mainLock on shutdown and shutdownNow, for the sake of
      ensuring workers set is stable while separately checking
      permission to interrupt and actually interrupting.</div>
<a id="L459" name="L459"></a> 459     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">new</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a>();
<a id="L460" name="L460"></a> 460 
<div class="comment">
      Set containing all worker threads in pool. Accessed only when
      holding mainLock.</div>
<a id="L465" name="L465"></a> 465     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a>&gt; workers = <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a>&gt;();
<a id="L466" name="L466"></a> 466 
<div class="comment">
      Wait condition to support awaitTermination</div>
<a id="L470" name="L470"></a> 470     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/1049.html#L179" title="Defined at 179 in src/java/util/concurrent/locks/Condition.java.">Condition</a> termination = mainLock.<a href="../D/27977.html" title="Multiple defined in 8 places.">newCondition</a>();
<a id="L471" name="L471"></a> 471 
<div class="comment">
      Tracks largest attained pool size. Accessed only under
      mainLock.</div>
<a id="L476" name="L476"></a> 476     <strong class="reserved">private</strong> <strong class="reserved">int</strong> largestPoolSize;
<a id="L477" name="L477"></a> 477 
<div class="comment">
      Counter for completed tasks. Updated only on termination of
      worker threads. Accessed only under mainLock.</div>
<a id="L482" name="L482"></a> 482     <strong class="reserved">private</strong> <strong class="reserved">long</strong> completedTaskCount;
<a id="L483" name="L483"></a> 483 
<div class="comment">
      All user control parameters are declared as volatiles so that
      ongoing actions are based on freshest values, but without need
      for locking, since no internal invariants depend on them
      changing synchronously with respect to other actions.</div>
<a id="L490" name="L490"></a> 490 
<div class="comment">
      Factory for new threads. All threads are created using this
      factory (via method addWorker).  All callers must be prepared
      for addWorker to fail, which may reflect a system or user's
      policy limiting the number of threads.  Even though it is not
      treated as an error, failure to create threads may result in
      new tasks being rejected or existing ones remaining stuck in
      the queue.
      We go further and preserve pool invariants even in the face of
      errors such as OutOfMemoryError, that might be thrown while
      trying to create threads.  Such errors are rather common due to
      the need to allocate a native stack in Thread.start, and users
      will want to perform clean pool shutdown to clean up.  There
      will likely be enough memory available for the cleanup code to
      complete without encountering yet another OutOfMemoryError.</div>
<a id="L508" name="L508"></a> 508     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <a href="../S/1104.html#L58" title="Defined at 58 in src/java/util/concurrent/ThreadFactory.java.">ThreadFactory</a> threadFactory;
<a id="L509" name="L509"></a> 509 
<div class="comment">
      Handler called when saturated or shutdown in execute.</div>
<a id="L513" name="L513"></a> 513     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>;
<a id="L514" name="L514"></a> 514 
<div class="comment">
      Timeout in nanoseconds for idle threads waiting for work.
      Threads use this timeout when there are more than corePoolSize
      present or if allowCoreThreadTimeOut. Otherwise they wait
      forever for new work.</div>
<a id="L521" name="L521"></a> 521     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">long</strong> keepAliveTime;
<a id="L522" name="L522"></a> 522 
<div class="comment">
      If false (default), core threads stay alive even when idle.
      If true, core threads use keepAliveTime to time out waiting
      for work.</div>
<a id="L528" name="L528"></a> 528     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">boolean</strong> <a href="../S/1117.html#L1640" title="Defined at 1640 in src/java/util/concurrent/ThreadPoolExecutor.java.">allowCoreThreadTimeOut</a>;
<a id="L529" name="L529"></a> 529 
<div class="comment">
      Core pool size is the minimum number of workers to keep alive
      (and not allow to time out etc) unless allowCoreThreadTimeOut
      is set, in which case the minimum is zero.</div>
<a id="L535" name="L535"></a> 535     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">int</strong> corePoolSize;
<a id="L536" name="L536"></a> 536 
<div class="comment">
      Maximum pool size. Note that the actual maximum is internally
      bounded by CAPACITY.</div>
<a id="L541" name="L541"></a> 541     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">int</strong> maximumPoolSize;
<a id="L542" name="L542"></a> 542 
<div class="comment">
      The default rejected execution handler</div>
<a id="L546" name="L546"></a> 546     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> defaultHandler =
<a id="L547" name="L547"></a> 547         <strong class="reserved">new</strong> <a href="../S/1117.html#L2031" title="Defined at 2031 in src/java/util/concurrent/ThreadPoolExecutor.java.">AbortPolicy</a>();
<a id="L548" name="L548"></a> 548 
<div class="comment">
      Permission required for callers of shutdown and shutdownNow.
      We additionally require (see checkShutdownAccess) that callers
      have permission to actually interrupt threads in the worker set
      (as governed by Thread.interrupt, which relies on
      ThreadGroup.checkAccess, which in turn relies on
      SecurityManager.checkAccess). Shutdowns are attempted only if
      these checks pass.
      All actual invocations of Thread.interrupt (see
      interruptIdleWorkers and interruptWorkers) ignore
      SecurityExceptions, meaning that the attempted interrupts
      silently fail. In the case of shutdown, they should not fail
      unless the SecurityManager has inconsistent policies, sometimes
      allowing access to a thread and sometimes not. In such cases,
      failure to actually interrupt threads may disable or delay full
      termination. Other uses of interruptIdleWorkers are advisory,
      and failure to actually interrupt will merely delay response to
      configuration changes so is not handled exceptionally.</div>
<a id="L569" name="L569"></a> 569     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1764.html#L349" title="Defined at 349 in src/java/lang/RuntimePermission.java.">RuntimePermission</a> shutdownPerm =
<a id="L570" name="L570"></a> 570         <strong class="reserved">new</strong> <a href="../S/1764.html#L349" title="Defined at 349 in src/java/lang/RuntimePermission.java.">RuntimePermission</a>("modifyThread");
<a id="L571" name="L571"></a> 571 
<div class="comment">
      Class Worker mainly maintains interrupt control state for
      threads running tasks, along with other minor bookkeeping.
      This class opportunistically extends AbstractQueuedSynchronizer
      to simplify acquiring and releasing a lock surrounding each
      task execution.  This protects against interrupts that are
      intended to wake up a worker thread waiting for a task from
      instead interrupting a task being run.  We implement a simple
      non-reentrant mutual exclusion lock rather than use
      ReentrantLock because we do not want worker tasks to be able to
      reacquire the lock when they invoke pool control methods like
      setCorePoolSize.  Additionally, to suppress interrupts until
      the thread actually starts running tasks, we initialize lock
      state to a negative value, and clear it upon start (in
      runWorker).</div>
<a id="L588" name="L588"></a> 588     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/8867.html" title="Multiple referred from 13 places.">Worker</a>
<a id="L589" name="L589"></a> 589         <strong class="reserved">extends</strong> <a href="../S/1046.html#L289" title="Defined at 289 in src/java/util/concurrent/locks/AbstractQueuedSynchronizer.java.">AbstractQueuedSynchronizer</a>
<a id="L590" name="L590"></a> 590         <strong class="reserved">implements</strong> <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>
<a id="L591" name="L591"></a> 591     <em class="brace">{</em>
<div class="comment">
          This class will never be serialized, but we provide a
          serialVersionUID to suppress a javac warning.</div>
<a id="L596" name="L596"></a> 596         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = 6138294804551838833L;
<a id="L597" name="L597"></a> 597 
<div class="comment">
         /** Thread this worker is running in.  Null if factory fails. */</div>
<a id="L599" name="L599"></a> 599         <strong class="reserved">final</strong> <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> thread;
<div class="comment">
         /** Initial task to run.  Possibly null. */</div>
<a id="L601" name="L601"></a> 601         <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> firstTask;
<div class="comment">
         /** Per-thread task counter */</div>
<a id="L603" name="L603"></a> 603         <strong class="reserved">volatile</strong> <strong class="reserved">long</strong> completedTasks;
<a id="L604" name="L604"></a> 604 
<div class="comment">
          Creates with given first task and thread from ThreadFactory.
          @param firstTask the first task (null if none)</div>
<a id="L609" name="L609"></a> 609         Worker(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> firstTask) <em class="brace">{</em>
<a id="L610" name="L610"></a> 610             <a href="../D/34006.html" title="Multiple defined in 21 places.">setState</a>(-1); <em class="comment">// inhibit interrupts until runWorker</em>
<a id="L611" name="L611"></a> 611             <strong class="reserved">this</strong>.firstTask = firstTask;
<a id="L612" name="L612"></a> 612             <strong class="reserved">this</strong>.thread = <a href="../S/1117.html#L1499" title="Defined at 1499 in src/java/util/concurrent/ThreadPoolExecutor.java.">getThreadFactory</a>().<a href="../D/28094.html" title="Multiple defined in 7 places.">newThread</a>(<strong class="reserved">this</strong>);
<a id="L613" name="L613"></a> 613         <em class="brace">}</em>
<a id="L614" name="L614"></a> 614 
<div class="comment">
         /** Delegates main run loop to outer runWorker  */</div>
<a id="L616" name="L616"></a> 616         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26539.html" title="Multiple referred from 715 places.">run</a>() <em class="brace">{</em>
<a id="L617" name="L617"></a> 617             <a href="../D/31509.html" title="Multiple defined in 2 places.">runWorker</a>(<strong class="reserved">this</strong>);
<a id="L618" name="L618"></a> 618         <em class="brace">}</em>
<a id="L619" name="L619"></a> 619 
<a id="L620" name="L620"></a> 620         <em class="comment">// Lock methods</em>
<a id="L621" name="L621"></a> 621         <em class="comment">//</em>
<a id="L622" name="L622"></a> 622         <em class="comment">// The value 0 represents the unlocked state.</em>
<a id="L623" name="L623"></a> 623         <em class="comment">// The value 1 represents the locked state.</em>
<a id="L624" name="L624"></a> 624 
<a id="L625" name="L625"></a> 625         <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/21524.html" title="Multiple referred from 17 places.">isHeldExclusively</a>() <em class="brace">{</em>
<a id="L626" name="L626"></a> 626             <strong class="reserved">return</strong> <a href="../D/22724.html" title="Multiple defined in 28 places.">getState</a>() != 0;
<a id="L627" name="L627"></a> 627         <em class="brace">}</em>
<a id="L628" name="L628"></a> 628 
<a id="L629" name="L629"></a> 629         <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/29536.html" title="Multiple referred from 13 places.">tryAcquire</a>(<strong class="reserved">int</strong> unused) <em class="brace">{</em>
<a id="L630" name="L630"></a> 630             <strong class="reserved">if</strong> (<a href="../D/13041.html" title="Multiple defined in 2 places.">compareAndSetState</a>(0, 1)) <em class="brace">{</em>
<a id="L631" name="L631"></a> 631                 <a href="../S/1048.html#L73" title="Defined at 73 in src/java/util/concurrent/locks/AbstractOwnableSynchronizer.java.">setExclusiveOwnerThread</a>(<a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L264" title="Defined at 264 in src/java/lang/Thread.java.">currentThread</a>());
<a id="L632" name="L632"></a> 632                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L633" name="L633"></a> 633             <em class="brace">}</em>
<a id="L634" name="L634"></a> 634             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L635" name="L635"></a> 635         <em class="brace">}</em>
<a id="L636" name="L636"></a> 636 
<a id="L637" name="L637"></a> 637         <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/29560.html" title="Multiple referred from 7 places.">tryRelease</a>(<strong class="reserved">int</strong> unused) <em class="brace">{</em>
<a id="L638" name="L638"></a> 638             <a href="../S/1048.html#L73" title="Defined at 73 in src/java/util/concurrent/locks/AbstractOwnableSynchronizer.java.">setExclusiveOwnerThread</a>(<strong class="reserved">null</strong>);
<a id="L639" name="L639"></a> 639             <a href="../D/34006.html" title="Multiple defined in 21 places.">setState</a>(0);
<a id="L640" name="L640"></a> 640             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L641" name="L641"></a> 641         <em class="brace">}</em>
<a id="L642" name="L642"></a> 642 
<a id="L643" name="L643"></a> 643         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/22669.html" title="Multiple referred from 810 places.">lock</a>()        <em class="brace">{</em> <a href="../D/10575.html" title="Multiple defined in 9 places.">acquire</a>(1); <em class="brace">}</em>
<a id="L644" name="L644"></a> 644         <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/29552.html" title="Multiple referred from 5 places.">tryLock</a>()  <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/35707.html" title="Multiple defined in 10 places.">tryAcquire</a>(1); <em class="brace">}</em>
<a id="L645" name="L645"></a> 645         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/29713.html" title="Multiple referred from 276 places.">unlock</a>()      <em class="brace">{</em> <a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>(1); <em class="brace">}</em>
<a id="L646" name="L646"></a> 646         <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21692.html" title="Multiple referred from 4 places.">isLocked</a>() <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/25649.html" title="Multiple defined in 5 places.">isHeldExclusively</a>(); <em class="brace">}</em>
<a id="L647" name="L647"></a> 647 
<a id="L648" name="L648"></a> 648         <strong class="reserved">void</strong> <a href="../S/1117.html#L756" title="Referred from 756 in src/java/util/concurrent/ThreadPoolExecutor.java.">interruptIfStarted</a>() <em class="brace">{</em>
<a id="L649" name="L649"></a> 649             <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> t;
<a id="L650" name="L650"></a> 650             <strong class="reserved">if</strong> (<a href="../D/22724.html" title="Multiple defined in 28 places.">getState</a>() &gt;= 0 &amp;&amp; (t = thread) != <strong class="reserved">null</strong> &amp;&amp; !t.<a href="../D/25738.html" title="Multiple defined in 2 places.">isInterrupted</a>()) <em class="brace">{</em>
<a id="L651" name="L651"></a> 651                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L652" name="L652"></a> 652                     t.<a href="../D/24969.html" title="Multiple defined in 3 places.">interrupt</a>();
<a id="L653" name="L653"></a> 653                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> <a href="../D/24317.html" title="Multiple defined in 3 places.">ignore</a>) <em class="brace">{</em>
<a id="L654" name="L654"></a> 654                 <em class="brace">}</em>
<a id="L655" name="L655"></a> 655             <em class="brace">}</em>
<a id="L656" name="L656"></a> 656         <em class="brace">}</em>
<a id="L657" name="L657"></a> 657     <em class="brace">}</em>
<a id="L658" name="L658"></a> 658 
<div class="comment">
      Methods for setting control state</div>
<a id="L662" name="L662"></a> 662 
<div class="comment">
      Transitions runState to given target, or leaves it alone if
      already at least the given target.
      @param targetState the desired state, either SHUTDOWN or STOP
             (but not TIDYING or TERMINATED -- use tryTerminate for that)</div>
<a id="L670" name="L670"></a> 670     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/10105.html" title="Multiple referred from 2 places.">advanceRunState</a>(<strong class="reserved">int</strong> targetState) <em class="brace">{</em>
<a id="L671" name="L671"></a> 671         <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L672" name="L672"></a> 672             <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L673" name="L673"></a> 673             <strong class="reserved">if</strong> (<a href="../S/1117.html#L402" title="Defined at 402 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateAtLeast</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, targetState) ||
<a id="L674" name="L674"></a> 674                 ctl.<a href="../D/13035.html" title="Multiple defined in 16 places.">compareAndSet</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <a href="../S/1117.html#L391" title="Defined at 391 in src/java/util/concurrent/ThreadPoolExecutor.java.">ctlOf</a>(targetState, <a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>))))
<a id="L675" name="L675"></a> 675                 <strong class="reserved">break</strong>;
<a id="L676" name="L676"></a> 676         <em class="brace">}</em>
<a id="L677" name="L677"></a> 677     <em class="brace">}</em>
<a id="L678" name="L678"></a> 678 
<div class="comment">
      Transitions to TERMINATED state if either (SHUTDOWN and pool
      and queue empty) or (STOP and pool empty).  If otherwise
      eligible to terminate but workerCount is nonzero, interrupts an
      idle worker to ensure that shutdown signals propagate. This
      method must be called following any action that might make
      termination possible -- reducing worker count or removing tasks
      from the queue during shutdown. The method is non-private to
      allow access from ScheduledThreadPoolExecutor.</div>
<a id="L689" name="L689"></a> 689     <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/29564.html" title="Multiple referred from 12 places.">tryTerminate</a>() <em class="brace">{</em>
<a id="L690" name="L690"></a> 690         <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L691" name="L691"></a> 691             <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L692" name="L692"></a> 692             <strong class="reserved">if</strong> (<a href="../D/26198.html" title="Multiple defined in 5 places.">isRunning</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) ||
<a id="L693" name="L693"></a> 693                 <a href="../S/1117.html#L402" title="Defined at 402 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateAtLeast</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, TIDYING) ||
<a id="L694" name="L694"></a> 694                 (<a href="../S/1117.html#L389" title="Defined at 389 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) == SHUTDOWN &amp;&amp; ! workQueue.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()))
<a id="L695" name="L695"></a> 695                 <strong class="reserved">return</strong>;
<a id="L696" name="L696"></a> 696             <strong class="reserved">if</strong> (<a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) != 0) <em class="brace">{</em> <em class="comment">// Eligible to terminate</em>
<a id="L697" name="L697"></a> 697                 <a href="../D/24972.html" title="Multiple defined in 2 places.">interruptIdleWorkers</a>(ONLY_ONE);
<a id="L698" name="L698"></a> 698                 <strong class="reserved">return</strong>;
<a id="L699" name="L699"></a> 699             <em class="brace">}</em>
<a id="L700" name="L700"></a> 700 
<a id="L701" name="L701"></a> 701             <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L702" name="L702"></a> 702             mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L703" name="L703"></a> 703             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L704" name="L704"></a> 704                 <strong class="reserved">if</strong> (ctl.<a href="../D/13035.html" title="Multiple defined in 16 places.">compareAndSet</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <a href="../S/1117.html#L391" title="Defined at 391 in src/java/util/concurrent/ThreadPoolExecutor.java.">ctlOf</a>(TIDYING, 0))) <em class="brace">{</em>
<a id="L705" name="L705"></a> 705                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L706" name="L706"></a> 706                         <a href="../S/1117.html#L1997" title="Defined at 1997 in src/java/util/concurrent/ThreadPoolExecutor.java.">terminated</a>();
<a id="L707" name="L707"></a> 707                     <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L708" name="L708"></a> 708                         ctl.<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>(<a href="../S/1117.html#L391" title="Defined at 391 in src/java/util/concurrent/ThreadPoolExecutor.java.">ctlOf</a>(TERMINATED, 0));
<a id="L709" name="L709"></a> 709                         termination.<a href="../D/34559.html" title="Multiple defined in 3 places.">signalAll</a>();
<a id="L710" name="L710"></a> 710                     <em class="brace">}</em>
<a id="L711" name="L711"></a> 711                     <strong class="reserved">return</strong>;
<a id="L712" name="L712"></a> 712                 <em class="brace">}</em>
<a id="L713" name="L713"></a> 713             <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L714" name="L714"></a> 714                 mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L715" name="L715"></a> 715             <em class="brace">}</em>
<a id="L716" name="L716"></a> 716             <em class="comment">// else retry on failed CAS</em>
<a id="L717" name="L717"></a> 717         <em class="brace">}</em>
<a id="L718" name="L718"></a> 718     <em class="brace">}</em>
<a id="L719" name="L719"></a> 719 
<div class="comment">
      Methods for controlling interrupts to worker threads.</div>
<a id="L723" name="L723"></a> 723 
<div class="comment">
      If there is a security manager, makes sure caller has
      permission to shut down threads in general (see shutdownPerm).
      If this passes, additionally makes sure the caller is allowed
      to interrupt each worker thread. This might not be true even if
      first check passed, if the SecurityManager treats some threads
      specially.</div>
<a id="L732" name="L732"></a> 732     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/11358.html" title="Multiple referred from 2 places.">checkShutdownAccess</a>() <em class="brace">{</em>
<a id="L733" name="L733"></a> 733         <a href="../D/7682.html" title="Multiple defined in 2 places.">SecurityManager</a> security = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>();
<a id="L734" name="L734"></a> 734         <strong class="reserved">if</strong> (security != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L735" name="L735"></a> 735             security.<a href="../D/12594.html" title="Multiple defined in 22 places.">checkPermission</a>(shutdownPerm);
<a id="L736" name="L736"></a> 736             <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L737" name="L737"></a> 737             mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L738" name="L738"></a> 738             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L739" name="L739"></a> 739                 <strong class="reserved">for</strong> (<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w : workers)
<a id="L740" name="L740"></a> 740                     security.<a href="../D/12351.html" title="Multiple defined in 20 places.">checkAccess</a>(w.thread);
<a id="L741" name="L741"></a> 741             <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L742" name="L742"></a> 742                 mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L743" name="L743"></a> 743             <em class="brace">}</em>
<a id="L744" name="L744"></a> 744         <em class="brace">}</em>
<a id="L745" name="L745"></a> 745     <em class="brace">}</em>
<a id="L746" name="L746"></a> 746 
<div class="comment">
      Interrupts all threads, even if active. Ignores SecurityExceptions
      (in which case some threads may remain uninterrupted).</div>
<a id="L751" name="L751"></a> 751     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L1421" title="Referred from 1421 in src/java/util/concurrent/ThreadPoolExecutor.java.">interruptWorkers</a>() <em class="brace">{</em>
<a id="L752" name="L752"></a> 752         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L753" name="L753"></a> 753         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L754" name="L754"></a> 754         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L755" name="L755"></a> 755             <strong class="reserved">for</strong> (<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w : workers)
<a id="L756" name="L756"></a> 756                 w.<a href="../S/1117.html#L648" title="Defined at 648 in src/java/util/concurrent/ThreadPoolExecutor.java.">interruptIfStarted</a>();
<a id="L757" name="L757"></a> 757         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L758" name="L758"></a> 758             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L759" name="L759"></a> 759         <em class="brace">}</em>
<a id="L760" name="L760"></a> 760     <em class="brace">}</em>
<a id="L761" name="L761"></a> 761 
<div class="comment">
      Interrupts threads that might be waiting for tasks (as
      indicated by not being locked) so they can check for
      termination or configuration changes. Ignores
      SecurityExceptions (in which case some threads may remain
      uninterrupted).
      @param onlyOne If true, interrupt at most one worker. This is
      called only from tryTerminate when termination is otherwise
      enabled but there are still other workers.  In this case, at
      most one waiting worker is interrupted to propagate shutdown
      signals in case all threads are currently waiting.
      Interrupting any arbitrary thread ensures that newly arriving
      workers since shutdown began will also eventually exit.
      To guarantee eventual termination, it suffices to always
      interrupt only one idle worker, but shutdown() interrupts all
      idle workers so that redundant workers exit promptly, not
      waiting for a straggler task to finish.</div>
<a id="L781" name="L781"></a> 781     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/20978.html" title="Multiple referred from 7 places.">interruptIdleWorkers</a>(<strong class="reserved">boolean</strong> onlyOne) <em class="brace">{</em>
<a id="L782" name="L782"></a> 782         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L783" name="L783"></a> 783         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L784" name="L784"></a> 784         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L785" name="L785"></a> 785             <strong class="reserved">for</strong> (<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w : workers) <em class="brace">{</em>
<a id="L786" name="L786"></a> 786                 <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> t = w.thread;
<a id="L787" name="L787"></a> 787                 <strong class="reserved">if</strong> (!t.<a href="../D/25738.html" title="Multiple defined in 2 places.">isInterrupted</a>() &amp;&amp; w.<a href="../D/35726.html" title="Multiple defined in 17 places.">tryLock</a>()) <em class="brace">{</em>
<a id="L788" name="L788"></a> 788                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L789" name="L789"></a> 789                         t.<a href="../D/24969.html" title="Multiple defined in 3 places.">interrupt</a>();
<a id="L790" name="L790"></a> 790                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1580.html#L34" title="Defined at 34 in src/java/lang/SecurityException.java.">SecurityException</a> <a href="../D/24317.html" title="Multiple defined in 3 places.">ignore</a>) <em class="brace">{</em>
<a id="L791" name="L791"></a> 791                     <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L792" name="L792"></a> 792                         w.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L793" name="L793"></a> 793                     <em class="brace">}</em>
<a id="L794" name="L794"></a> 794                 <em class="brace">}</em>
<a id="L795" name="L795"></a> 795                 <strong class="reserved">if</strong> (onlyOne)
<a id="L796" name="L796"></a> 796                     <strong class="reserved">break</strong>;
<a id="L797" name="L797"></a> 797             <em class="brace">}</em>
<a id="L798" name="L798"></a> 798         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L799" name="L799"></a> 799             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L800" name="L800"></a> 800         <em class="brace">}</em>
<a id="L801" name="L801"></a> 801     <em class="brace">}</em>
<a id="L802" name="L802"></a> 802 
<div class="comment">
      Common form of interruptIdleWorkers, to avoid having to
      remember what the boolean argument means.</div>
<a id="L807" name="L807"></a> 807     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/20978.html" title="Multiple referred from 7 places.">interruptIdleWorkers</a>() <em class="brace">{</em>
<a id="L808" name="L808"></a> 808         <a href="../D/24972.html" title="Multiple defined in 2 places.">interruptIdleWorkers</a>(<strong class="reserved">false</strong>);
<a id="L809" name="L809"></a> 809     <em class="brace">}</em>
<a id="L810" name="L810"></a> 810 
<a id="L811" name="L811"></a> 811     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> ONLY_ONE = <strong class="reserved">true</strong>;
<a id="L812" name="L812"></a> 812 
<div class="comment">
      Misc utilities, most of which are also exported to
      ScheduledThreadPoolExecutor</div>
<a id="L817" name="L817"></a> 817 
<div class="comment">
      Invokes the rejected execution handler for the given command.
      Package-protected for use by ScheduledThreadPoolExecutor.</div>
<a id="L822" name="L822"></a> 822     <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/25836.html" title="Multiple referred from 3 places.">reject</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> <a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>) <em class="brace">{</em>
<a id="L823" name="L823"></a> 823         <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>.<a href="../D/30625.html" title="Multiple defined in 5 places.">rejectedExecution</a>(<a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>, <strong class="reserved">this</strong>);
<a id="L824" name="L824"></a> 824     <em class="brace">}</em>
<a id="L825" name="L825"></a> 825 
<div class="comment">
      Performs any further cleanup following run state transition on
      invocation of shutdown.  A no-op here, but used by
      ScheduledThreadPoolExecutor to cancel delayed tasks.</div>
<a id="L831" name="L831"></a> 831     <strong class="reserved">void</strong> <a href="../R/23954.html" title="Multiple referred from 3 places.">onShutdown</a>() <em class="brace">{</em>
<a id="L832" name="L832"></a> 832     <em class="brace">}</em>
<a id="L833" name="L833"></a> 833 
<div class="comment">
      State check needed by ScheduledThreadPoolExecutor to
      enable running tasks during shutdown.
      @param shutdownOK true if should return true if SHUTDOWN</div>
<a id="L840" name="L840"></a> 840     <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../S/1098.html#L308" title="Referred from 308 in src/java/util/concurrent/ScheduledThreadPoolExecutor.java.">isRunningOrShutdown</a>(<strong class="reserved">boolean</strong> shutdownOK) <em class="brace">{</em>
<a id="L841" name="L841"></a> 841         <strong class="reserved">int</strong> rs = <a href="../S/1117.html#L389" title="Defined at 389 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateOf</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>());
<a id="L842" name="L842"></a> 842         <strong class="reserved">return</strong> rs == RUNNING || (rs == SHUTDOWN &amp;&amp; shutdownOK);
<a id="L843" name="L843"></a> 843     <em class="brace">}</em>
<a id="L844" name="L844"></a> 844 
<div class="comment">
      Drains the task queue into a new list, normally using
      drainTo. But if the queue is a DelayQueue or any other kind of
      queue for which poll or drainTo may fail to remove some
      elements, it deletes them one by one.</div>
<a id="L851" name="L851"></a> 851     <strong class="reserved">private</strong> <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; <a href="../S/1117.html#L1422" title="Referred from 1422 in src/java/util/concurrent/ThreadPoolExecutor.java.">drainQueue</a>() <em class="brace">{</em>
<a id="L852" name="L852"></a> 852         <a href="../S/1109.html#L180" title="Defined at 180 in src/java/util/concurrent/BlockingQueue.java.">BlockingQueue</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; q = workQueue;
<a id="L853" name="L853"></a> 853         <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; taskList = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt;();
<a id="L854" name="L854"></a> 854         q.<a href="../D/15160.html" title="Multiple defined in 18 places.">drainTo</a>(taskList);
<a id="L855" name="L855"></a> 855         <strong class="reserved">if</strong> (!q.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L856" name="L856"></a> 856             <strong class="reserved">for</strong> (<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r : q.<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>(<strong class="reserved">new</strong> <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>[0])) <em class="brace">{</em>
<a id="L857" name="L857"></a> 857                 <strong class="reserved">if</strong> (q.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(r))
<a id="L858" name="L858"></a> 858                     taskList.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(r);
<a id="L859" name="L859"></a> 859             <em class="brace">}</em>
<a id="L860" name="L860"></a> 860         <em class="brace">}</em>
<a id="L861" name="L861"></a> 861         <strong class="reserved">return</strong> taskList;
<a id="L862" name="L862"></a> 862     <em class="brace">}</em>
<a id="L863" name="L863"></a> 863 
<div class="comment">
      Methods for creating, running and cleaning up after workers</div>
<a id="L867" name="L867"></a> 867 
<div class="comment">
      Checks if a new worker can be added with respect to current
      pool state and the given bound (either core or maximum). If so,
      the worker count is adjusted accordingly, and, if possible, a
      new worker is created and started, running firstTask as its
      first task. This method returns false if the pool is stopped or
      eligible to shut down. It also returns false if the thread
      factory fails to create a thread when asked.  If the thread
      creation fails, either due to the thread factory returning
      null, or due to an exception (typically OutOfMemoryError in
      Thread.start()), we roll back cleanly.
      @param firstTask the task the new thread should run first (or
      null if none). Workers are created with an initial first task
      (in method execute()) to bypass queuing when there are fewer
      than corePoolSize threads (in which case we always start one),
      or when the queue is full (in which case we must bypass queue).
      Initially idle threads are usually created via
      prestartCoreThread or to replace other dying workers.
      @param core if true use corePoolSize as bound, else
      maximumPoolSize. (A boolean indicator is used here rather than a
      value to ensure reads of fresh values after checking other pool
      state).
      @return true if successful</div>
<a id="L894" name="L894"></a> 894     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/10043.html" title="Multiple referred from 9 places.">addWorker</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> firstTask, <strong class="reserved">boolean</strong> core) <em class="brace">{</em>
<a id="L895" name="L895"></a> 895         retry:
<a id="L896" name="L896"></a> 896         <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L897" name="L897"></a> 897             <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L898" name="L898"></a> 898             <strong class="reserved">int</strong> rs = <a href="../S/1117.html#L389" title="Defined at 389 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L899" name="L899"></a> 899 
<a id="L900" name="L900"></a> 900             <em class="comment">// Check if queue empty only if necessary.</em>
<a id="L901" name="L901"></a> 901             <strong class="reserved">if</strong> (rs &gt;= SHUTDOWN &amp;&amp;
<a id="L902" name="L902"></a> 902                 ! (rs == SHUTDOWN &amp;&amp;
<a id="L903" name="L903"></a> 903                    firstTask == <strong class="reserved">null</strong> &amp;&amp;
<a id="L904" name="L904"></a> 904                    ! workQueue.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()))
<a id="L905" name="L905"></a> 905                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L906" name="L906"></a> 906 
<a id="L907" name="L907"></a> 907             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L908" name="L908"></a> 908                 <strong class="reserved">int</strong> wc = <a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L909" name="L909"></a> 909                 <strong class="reserved">if</strong> (wc &gt;= CAPACITY ||
<a id="L910" name="L910"></a> 910                     wc &gt;= (core ? corePoolSize : maximumPoolSize))
<a id="L911" name="L911"></a> 911                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L912" name="L912"></a> 912                 <strong class="reserved">if</strong> (<a href="../S/1117.html#L413" title="Defined at 413 in src/java/util/concurrent/ThreadPoolExecutor.java.">compareAndIncrementWorkerCount</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>))
<a id="L913" name="L913"></a> 913                     <strong class="reserved">break</strong> retry;
<a id="L914" name="L914"></a> 914                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();  <em class="comment">// Re-read ctl</em>
<a id="L915" name="L915"></a> 915                 <strong class="reserved">if</strong> (<a href="../S/1117.html#L389" title="Defined at 389 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) != rs)
<a id="L916" name="L916"></a> 916                     <strong class="reserved">continue</strong> retry;
<a id="L917" name="L917"></a> 917                 <em class="comment">// else CAS failed due to workerCount change; retry inner loop</em>
<a id="L918" name="L918"></a> 918             <em class="brace">}</em>
<a id="L919" name="L919"></a> 919         <em class="brace">}</em>
<a id="L920" name="L920"></a> 920 
<a id="L921" name="L921"></a> 921         <strong class="reserved">boolean</strong> workerStarted = <strong class="reserved">false</strong>;
<a id="L922" name="L922"></a> 922         <strong class="reserved">boolean</strong> workerAdded = <strong class="reserved">false</strong>;
<a id="L923" name="L923"></a> 923         <a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w = <strong class="reserved">null</strong>;
<a id="L924" name="L924"></a> 924         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L925" name="L925"></a> 925             w = <strong class="reserved">new</strong> <a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a>(firstTask);
<a id="L926" name="L926"></a> 926             <strong class="reserved">final</strong> <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> t = w.thread;
<a id="L927" name="L927"></a> 927             <strong class="reserved">if</strong> (t != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L928" name="L928"></a> 928                 <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L929" name="L929"></a> 929                 mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L930" name="L930"></a> 930                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L931" name="L931"></a> 931                     <em class="comment">// Recheck while holding lock.</em>
<a id="L932" name="L932"></a> 932                     <em class="comment">// Back out on ThreadFactory failure or if</em>
<a id="L933" name="L933"></a> 933                     <em class="comment">// shut down before lock acquired.</em>
<a id="L934" name="L934"></a> 934                     <strong class="reserved">int</strong> rs = <a href="../S/1117.html#L389" title="Defined at 389 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateOf</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>());
<a id="L935" name="L935"></a> 935 
<a id="L936" name="L936"></a> 936                     <strong class="reserved">if</strong> (rs &lt; SHUTDOWN ||
<a id="L937" name="L937"></a> 937                         (rs == SHUTDOWN &amp;&amp; firstTask == <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L938" name="L938"></a> 938                         <strong class="reserved">if</strong> (t.<a href="../D/25173.html" title="Multiple defined in 3 places.">isAlive</a>()) <em class="comment">// precheck that t is startable</em>
<a id="L939" name="L939"></a> 939                             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1598.html#L39" title="Defined at 39 in src/java/lang/IllegalThreadStateException.java.">IllegalThreadStateException</a>();
<a id="L940" name="L940"></a> 940                         workers.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(w);
<a id="L941" name="L941"></a> 941                         <strong class="reserved">int</strong> s = workers.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L942" name="L942"></a> 942                         <strong class="reserved">if</strong> (s &gt; largestPoolSize)
<a id="L943" name="L943"></a> 943                             largestPoolSize = s;
<a id="L944" name="L944"></a> 944                         workerAdded = <strong class="reserved">true</strong>;
<a id="L945" name="L945"></a> 945                     <em class="brace">}</em>
<a id="L946" name="L946"></a> 946                 <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L947" name="L947"></a> 947                     mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L948" name="L948"></a> 948                 <em class="brace">}</em>
<a id="L949" name="L949"></a> 949                 <strong class="reserved">if</strong> (workerAdded) <em class="brace">{</em>
<a id="L950" name="L950"></a> 950                     t.<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>();
<a id="L951" name="L951"></a> 951                     workerStarted = <strong class="reserved">true</strong>;
<a id="L952" name="L952"></a> 952                 <em class="brace">}</em>
<a id="L953" name="L953"></a> 953             <em class="brace">}</em>
<a id="L954" name="L954"></a> 954         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L955" name="L955"></a> 955             <strong class="reserved">if</strong> (! workerStarted)
<a id="L956" name="L956"></a> 956                 <a href="../S/1117.html#L968" title="Defined at 968 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorkerFailed</a>(w);
<a id="L957" name="L957"></a> 957         <em class="brace">}</em>
<a id="L958" name="L958"></a> 958         <strong class="reserved">return</strong> workerStarted;
<a id="L959" name="L959"></a> 959     <em class="brace">}</em>
<a id="L960" name="L960"></a> 960 
<div class="comment">
      Rolls back the worker thread creation.
      - removes worker from workers, if present
      - decrements worker count
      - rechecks for termination, in case the existence of this
        worker was holding up termination</div>
<a id="L968" name="L968"></a> 968     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L956" title="Referred from 956 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorkerFailed</a>(<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w) <em class="brace">{</em>
<a id="L969" name="L969"></a> 969         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L970" name="L970"></a> 970         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L971" name="L971"></a> 971         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L972" name="L972"></a> 972             <strong class="reserved">if</strong> (w != <strong class="reserved">null</strong>)
<a id="L973" name="L973"></a> 973                 workers.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(w);
<a id="L974" name="L974"></a> 974             <a href="../S/1117.html#L429" title="Defined at 429 in src/java/util/concurrent/ThreadPoolExecutor.java.">decrementWorkerCount</a>();
<a id="L975" name="L975"></a> 975             <a href="../D/35739.html" title="Multiple defined in 2 places.">tryTerminate</a>();
<a id="L976" name="L976"></a> 976         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L977" name="L977"></a> 977             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L978" name="L978"></a> 978         <em class="brace">}</em>
<a id="L979" name="L979"></a> 979     <em class="brace">}</em>
<a id="L980" name="L980"></a> 980 
<div class="comment">
      Performs cleanup and bookkeeping for a dying worker. Called
      only from worker threads. Unless completedAbruptly is set,
      assumes that workerCount has already been adjusted to account
      for exit.  This method removes thread from worker set, and
      possibly terminates the pool or replaces the worker if either
      it exited due to user task exception or if fewer than
      corePoolSize workers are running or queue is non-empty but
      there are no workers.
      @param w the worker
      @param completedAbruptly if the worker died due to user exception</div>
<a id="L994" name="L994"></a> 994     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L1160" title="Referred from 1160 in src/java/util/concurrent/ThreadPoolExecutor.java.">processWorkerExit</a>(<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w, <strong class="reserved">boolean</strong> completedAbruptly) <em class="brace">{</em>
<a id="L995" name="L995"></a> 995         <strong class="reserved">if</strong> (completedAbruptly) <em class="comment">// If abrupt, then workerCount wasn't adjusted</em>
<a id="L996" name="L996"></a> 996             <a href="../S/1117.html#L429" title="Defined at 429 in src/java/util/concurrent/ThreadPoolExecutor.java.">decrementWorkerCount</a>();
<a id="L997" name="L997"></a> 997 
<a id="L998" name="L998"></a> 998         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L999" name="L999"></a> 999         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1000" name="L1000"></a>1000         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1001" name="L1001"></a>1001             completedTaskCount += w.completedTasks;
<a id="L1002" name="L1002"></a>1002             workers.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(w);
<a id="L1003" name="L1003"></a>1003         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1004" name="L1004"></a>1004             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1005" name="L1005"></a>1005         <em class="brace">}</em>
<a id="L1006" name="L1006"></a>1006 
<a id="L1007" name="L1007"></a>1007         <a href="../D/35739.html" title="Multiple defined in 2 places.">tryTerminate</a>();
<a id="L1008" name="L1008"></a>1008 
<a id="L1009" name="L1009"></a>1009         <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L1010" name="L1010"></a>1010         <strong class="reserved">if</strong> (<a href="../S/1117.html#L398" title="Defined at 398 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateLessThan</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, STOP)) <em class="brace">{</em>
<a id="L1011" name="L1011"></a>1011             <strong class="reserved">if</strong> (!completedAbruptly) <em class="brace">{</em>
<a id="L1012" name="L1012"></a>1012                 <strong class="reserved">int</strong> <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a> = <a href="../S/1117.html#L1640" title="Defined at 1640 in src/java/util/concurrent/ThreadPoolExecutor.java.">allowCoreThreadTimeOut</a> ? 0 : corePoolSize;
<a id="L1013" name="L1013"></a>1013                 <strong class="reserved">if</strong> (<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a> == 0 &amp;&amp; ! workQueue.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>())
<a id="L1014" name="L1014"></a>1014                     <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a> = 1;
<a id="L1015" name="L1015"></a>1015                 <strong class="reserved">if</strong> (<a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) &gt;= <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>)
<a id="L1016" name="L1016"></a>1016                     <strong class="reserved">return</strong>; <em class="comment">// replacement not needed</em>
<a id="L1017" name="L1017"></a>1017             <em class="brace">}</em>
<a id="L1018" name="L1018"></a>1018             <a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<strong class="reserved">null</strong>, <strong class="reserved">false</strong>);
<a id="L1019" name="L1019"></a>1019         <em class="brace">}</em>
<a id="L1020" name="L1020"></a>1020     <em class="brace">}</em>
<a id="L1021" name="L1021"></a>1021 
<div class="comment">
      Performs blocking or timed wait for a task, depending on
      current configuration settings, or returns null if this worker
      must exit because of any of:
      1. There are more than maximumPoolSize workers (due to
         a call to setMaximumPoolSize).
      2. The pool is stopped.
      3. The pool is shutdown and the queue is empty.
      4. This worker timed out waiting for a task, and timed-out
         workers are subject to termination (that is,
         <code>allowCoreThreadTimeOut || workerCount &gt; corePoolSize</code>)
         both before and after the timed wait, and if the queue is
         non-empty, this worker is not the last thread in the pool.
      @return task, or null if the worker must exit, in which case
              workerCount is decremented</div>
<a id="L1039" name="L1039"></a>1039     <strong class="reserved">private</strong> <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> <a href="../S/1117.html#L1127" title="Referred from 1127 in src/java/util/concurrent/ThreadPoolExecutor.java.">getTask</a>() <em class="brace">{</em>
<a id="L1040" name="L1040"></a>1040         <strong class="reserved">boolean</strong> timedOut = <strong class="reserved">false</strong>; <em class="comment">// Did the last poll() time out?</em>
<a id="L1041" name="L1041"></a>1041 
<a id="L1042" name="L1042"></a>1042         <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L1043" name="L1043"></a>1043             <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L1044" name="L1044"></a>1044             <strong class="reserved">int</strong> rs = <a href="../S/1117.html#L389" title="Defined at 389 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L1045" name="L1045"></a>1045 
<a id="L1046" name="L1046"></a>1046             <em class="comment">// Check if queue empty only if necessary.</em>
<a id="L1047" name="L1047"></a>1047             <strong class="reserved">if</strong> (rs &gt;= SHUTDOWN &amp;&amp; (rs &gt;= STOP || workQueue.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>())) <em class="brace">{</em>
<a id="L1048" name="L1048"></a>1048                 <a href="../S/1117.html#L429" title="Defined at 429 in src/java/util/concurrent/ThreadPoolExecutor.java.">decrementWorkerCount</a>();
<a id="L1049" name="L1049"></a>1049                 <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1050" name="L1050"></a>1050             <em class="brace">}</em>
<a id="L1051" name="L1051"></a>1051 
<a id="L1052" name="L1052"></a>1052             <strong class="reserved">int</strong> wc = <a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L1053" name="L1053"></a>1053 
<a id="L1054" name="L1054"></a>1054             <em class="comment">// Are workers subject to culling?</em>
<a id="L1055" name="L1055"></a>1055             <strong class="reserved">boolean</strong> timed = <a href="../S/1117.html#L1640" title="Defined at 1640 in src/java/util/concurrent/ThreadPoolExecutor.java.">allowCoreThreadTimeOut</a> || wc &gt; corePoolSize;
<a id="L1056" name="L1056"></a>1056 
<a id="L1057" name="L1057"></a>1057             <strong class="reserved">if</strong> ((wc &gt; maximumPoolSize || (timed &amp;&amp; timedOut))
<a id="L1058" name="L1058"></a>1058                 &amp;&amp; (wc &gt; 1 || workQueue.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>())) <em class="brace">{</em>
<a id="L1059" name="L1059"></a>1059                 <strong class="reserved">if</strong> (<a href="../S/1117.html#L420" title="Defined at 420 in src/java/util/concurrent/ThreadPoolExecutor.java.">compareAndDecrementWorkerCount</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>))
<a id="L1060" name="L1060"></a>1060                     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1061" name="L1061"></a>1061                 <strong class="reserved">continue</strong>;
<a id="L1062" name="L1062"></a>1062             <em class="brace">}</em>
<a id="L1063" name="L1063"></a>1063 
<a id="L1064" name="L1064"></a>1064             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1065" name="L1065"></a>1065                 <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r = timed ?
<a id="L1066" name="L1066"></a>1066                     workQueue.<a href="../D/29402.html" title="Multiple defined in 36 places.">poll</a>(keepAliveTime, <a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a>.NANOSECONDS) :
<a id="L1067" name="L1067"></a>1067                     workQueue.<a href="../D/35207.html" title="Multiple defined in 13 places.">take</a>();
<a id="L1068" name="L1068"></a>1068                 <strong class="reserved">if</strong> (r != <strong class="reserved">null</strong>)
<a id="L1069" name="L1069"></a>1069                     <strong class="reserved">return</strong> r;
<a id="L1070" name="L1070"></a>1070                 timedOut = <strong class="reserved">true</strong>;
<a id="L1071" name="L1071"></a>1071             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> retry) <em class="brace">{</em>
<a id="L1072" name="L1072"></a>1072                 timedOut = <strong class="reserved">false</strong>;
<a id="L1073" name="L1073"></a>1073             <em class="brace">}</em>
<a id="L1074" name="L1074"></a>1074         <em class="brace">}</em>
<a id="L1075" name="L1075"></a>1075     <em class="brace">}</em>
<a id="L1076" name="L1076"></a>1076 
<div class="comment">
      Main worker run loop.  Repeatedly gets tasks from queue and
      executes them, while coping with a number of issues:
      1. We may start out with an initial task, in which case we
      don't need to get the first one. Otherwise, as long as pool is
      running, we get tasks from getTask. If it returns null then the
      worker exits due to changed pool state or configuration
      parameters.  Other exits result from exception throws in
      external code, in which case completedAbruptly holds, which
      usually leads processWorkerExit to replace this thread.
      2. Before running any task, the lock is acquired to prevent
      other pool interrupts while the task is executing, and then we
      ensure that unless pool is stopping, this thread does not have
      its interrupt set.
      3. Each task run is preceded by a call to beforeExecute, which
      might throw an exception, in which case we cause thread to die
      (breaking loop with completedAbruptly true) without processing
      the task.
      4. Assuming beforeExecute completes normally, we run the task,
      gathering any of its thrown exceptions to send to afterExecute.
      We separately handle RuntimeException, Error (both of which the
      specs guarantee that we trap) and arbitrary Throwables.
      Because we cannot rethrow Throwables within Runnable.run, we
      wrap them within Errors on the way out (to the thread's
      UncaughtExceptionHandler).  Any thrown exception also
      conservatively causes thread to die.
      5. After task.run completes, we call afterExecute, which may
      also throw an exception, which will also cause thread to
      die. According to JLS Sec 14.20, this exception is the one that
      will be in effect even if task.run throws.
      The net effect of the exception mechanics is that afterExecute
      and the thread's UncaughtExceptionHandler have as accurate
      information as we can provide about any problems encountered by
      user code.
      @param w the worker</div>
<a id="L1120" name="L1120"></a>1120     <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/26563.html" title="Multiple referred from 2 places.">runWorker</a>(<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w) <em class="brace">{</em>
<a id="L1121" name="L1121"></a>1121         <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> wt = <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L264" title="Defined at 264 in src/java/lang/Thread.java.">currentThread</a>();
<a id="L1122" name="L1122"></a>1122         <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> task = w.firstTask;
<a id="L1123" name="L1123"></a>1123         w.firstTask = <strong class="reserved">null</strong>;
<a id="L1124" name="L1124"></a>1124         w.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>(); <em class="comment">// allow interrupts</em>
<a id="L1125" name="L1125"></a>1125         <strong class="reserved">boolean</strong> completedAbruptly = <strong class="reserved">true</strong>;
<a id="L1126" name="L1126"></a>1126         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1127" name="L1127"></a>1127             <strong class="reserved">while</strong> (task != <strong class="reserved">null</strong> || (task = <a href="../D/23025.html" title="Multiple defined in 3 places.">getTask</a>()) != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1128" name="L1128"></a>1128                 w.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1129" name="L1129"></a>1129                 <em class="comment">// If pool is stopping, ensure thread is interrupted;</em>
<a id="L1130" name="L1130"></a>1130                 <em class="comment">// if not, ensure thread is not interrupted.  This</em>
<a id="L1131" name="L1131"></a>1131                 <em class="comment">// requires a recheck in second case to deal with</em>
<a id="L1132" name="L1132"></a>1132                 <em class="comment">// shutdownNow race while clearing interrupt</em>
<a id="L1133" name="L1133"></a>1133                 <strong class="reserved">if</strong> ((<a href="../S/1117.html#L402" title="Defined at 402 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateAtLeast</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(), STOP) ||
<a id="L1134" name="L1134"></a>1134                      (<a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a>() &amp;&amp;
<a id="L1135" name="L1135"></a>1135                       <a href="../S/1117.html#L402" title="Defined at 402 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateAtLeast</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(), STOP))) &amp;&amp;
<a id="L1136" name="L1136"></a>1136                     !wt.<a href="../D/25738.html" title="Multiple defined in 2 places.">isInterrupted</a>())
<a id="L1137" name="L1137"></a>1137                     wt.<a href="../D/24969.html" title="Multiple defined in 3 places.">interrupt</a>();
<a id="L1138" name="L1138"></a>1138                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1139" name="L1139"></a>1139                     <a href="../S/1117.html#L1941" title="Defined at 1941 in src/java/util/concurrent/ThreadPoolExecutor.java.">beforeExecute</a>(wt, task);
<a id="L1140" name="L1140"></a>1140                     <a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a> thrown = <strong class="reserved">null</strong>;
<a id="L1141" name="L1141"></a>1141                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1142" name="L1142"></a>1142                         task.<a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>();
<a id="L1143" name="L1143"></a>1143                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L1144" name="L1144"></a>1144                         thrown = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>; <strong class="reserved">throw</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L1145" name="L1145"></a>1145                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L1146" name="L1146"></a>1146                         thrown = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>; <strong class="reserved">throw</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L1147" name="L1147"></a>1147                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L1148" name="L1148"></a>1148                         thrown = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>; <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L1149" name="L1149"></a>1149                     <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1150" name="L1150"></a>1150                         <a href="../S/1117.html#L1989" title="Defined at 1989 in src/java/util/concurrent/ThreadPoolExecutor.java.">afterExecute</a>(task, thrown);
<a id="L1151" name="L1151"></a>1151                     <em class="brace">}</em>
<a id="L1152" name="L1152"></a>1152                 <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1153" name="L1153"></a>1153                     task = <strong class="reserved">null</strong>;
<a id="L1154" name="L1154"></a>1154                     w.completedTasks++;
<a id="L1155" name="L1155"></a>1155                     w.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1156" name="L1156"></a>1156                 <em class="brace">}</em>
<a id="L1157" name="L1157"></a>1157             <em class="brace">}</em>
<a id="L1158" name="L1158"></a>1158             completedAbruptly = <strong class="reserved">false</strong>;
<a id="L1159" name="L1159"></a>1159         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1160" name="L1160"></a>1160             <a href="../S/1117.html#L994" title="Defined at 994 in src/java/util/concurrent/ThreadPoolExecutor.java.">processWorkerExit</a>(w, completedAbruptly);
<a id="L1161" name="L1161"></a>1161         <em class="brace">}</em>
<a id="L1162" name="L1162"></a>1162     <em class="brace">}</em>
<a id="L1163" name="L1163"></a>1163 
<a id="L1164" name="L1164"></a>1164     <em class="comment">// Public constructors and methods</em>
<a id="L1165" name="L1165"></a>1165 
<div class="comment">
      Creates a new <code>ThreadPoolExecutor</code> with the given initial
      parameters and default thread factory and rejected execution handler.
      It may be more convenient to use one of the {@link Executors} factory
      methods instead of this general purpose constructor.
      @param corePoolSize the number of threads to keep in the pool, even
             if they are idle, unless <code>allowCoreThreadTimeOut</code> is set
      @param maximumPoolSize the maximum number of threads to allow in the
             pool
      @param keepAliveTime when the number of threads is greater than
             the core, this is the maximum time that excess idle threads
             will wait for new tasks before terminating.
      @param unit the time unit for the <code>keepAliveTime</code> argument
      @param workQueue the queue to use for holding tasks before they are
             executed.  This queue will hold only the <code>Runnable</code>
             tasks submitted by the <code>execute</code> method.
      @throws IllegalArgumentException if one of the following holds:<br>
              <code>corePoolSize &lt; 0</code><br>
              <code>keepAliveTime &lt; 0</code><br>
              <code>maximumPoolSize &lt;= 0</code><br>
              <code>maximumPoolSize &lt; corePoolSize</code>
      @throws NullPointerException if <code>workQueue</code> is null</div>
<a id="L1190" name="L1190"></a>1190     <strong class="reserved">public</strong> ThreadPoolExecutor(<strong class="reserved">int</strong> corePoolSize,
<a id="L1191" name="L1191"></a>1191                               <strong class="reserved">int</strong> maximumPoolSize,
<a id="L1192" name="L1192"></a>1192                               <strong class="reserved">long</strong> keepAliveTime,
<a id="L1193" name="L1193"></a>1193                               <a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a> unit,
<a id="L1194" name="L1194"></a>1194                               <a href="../S/1109.html#L180" title="Defined at 180 in src/java/util/concurrent/BlockingQueue.java.">BlockingQueue</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; workQueue) <em class="brace">{</em>
<a id="L1195" name="L1195"></a>1195         <strong class="reserved">this</strong>(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,
<a id="L1196" name="L1196"></a>1196              <a href="../S/1124.html#L71" title="Defined at 71 in src/java/util/concurrent/Executors.java.">Executors</a>.<a href="../S/1124.html#L352" title="Defined at 352 in src/java/util/concurrent/Executors.java.">defaultThreadFactory</a>(), defaultHandler);
<a id="L1197" name="L1197"></a>1197     <em class="brace">}</em>
<a id="L1198" name="L1198"></a>1198 
<div class="comment">
      Creates a new <code>ThreadPoolExecutor</code> with the given initial
      parameters and default rejected execution handler.
      @param corePoolSize the number of threads to keep in the pool, even
             if they are idle, unless <code>allowCoreThreadTimeOut</code> is set
      @param maximumPoolSize the maximum number of threads to allow in the
             pool
      @param keepAliveTime when the number of threads is greater than
             the core, this is the maximum time that excess idle threads
             will wait for new tasks before terminating.
      @param unit the time unit for the <code>keepAliveTime</code> argument
      @param workQueue the queue to use for holding tasks before they are
             executed.  This queue will hold only the <code>Runnable</code>
             tasks submitted by the <code>execute</code> method.
      @param threadFactory the factory to use when the executor
             creates a new thread
      @throws IllegalArgumentException if one of the following holds:<br>
              <code>corePoolSize &lt; 0</code><br>
              <code>keepAliveTime &lt; 0</code><br>
              <code>maximumPoolSize &lt;= 0</code><br>
              <code>maximumPoolSize &lt; corePoolSize</code>
      @throws NullPointerException if <code>workQueue</code>
              or <code>threadFactory</code> is null</div>
<a id="L1224" name="L1224"></a>1224     <strong class="reserved">public</strong> ThreadPoolExecutor(<strong class="reserved">int</strong> corePoolSize,
<a id="L1225" name="L1225"></a>1225                               <strong class="reserved">int</strong> maximumPoolSize,
<a id="L1226" name="L1226"></a>1226                               <strong class="reserved">long</strong> keepAliveTime,
<a id="L1227" name="L1227"></a>1227                               <a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a> unit,
<a id="L1228" name="L1228"></a>1228                               <a href="../S/1109.html#L180" title="Defined at 180 in src/java/util/concurrent/BlockingQueue.java.">BlockingQueue</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; workQueue,
<a id="L1229" name="L1229"></a>1229                               <a href="../S/1104.html#L58" title="Defined at 58 in src/java/util/concurrent/ThreadFactory.java.">ThreadFactory</a> threadFactory) <em class="brace">{</em>
<a id="L1230" name="L1230"></a>1230         <strong class="reserved">this</strong>(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,
<a id="L1231" name="L1231"></a>1231              threadFactory, defaultHandler);
<a id="L1232" name="L1232"></a>1232     <em class="brace">}</em>
<a id="L1233" name="L1233"></a>1233 
<div class="comment">
      Creates a new <code>ThreadPoolExecutor</code> with the given initial
      parameters and default thread factory.
      @param corePoolSize the number of threads to keep in the pool, even
             if they are idle, unless <code>allowCoreThreadTimeOut</code> is set
      @param maximumPoolSize the maximum number of threads to allow in the
             pool
      @param keepAliveTime when the number of threads is greater than
             the core, this is the maximum time that excess idle threads
             will wait for new tasks before terminating.
      @param unit the time unit for the <code>keepAliveTime</code> argument
      @param workQueue the queue to use for holding tasks before they are
             executed.  This queue will hold only the <code>Runnable</code>
             tasks submitted by the <code>execute</code> method.
      @param handler the handler to use when execution is blocked
             because the thread bounds and queue capacities are reached
      @throws IllegalArgumentException if one of the following holds:<br>
              <code>corePoolSize &lt; 0</code><br>
              <code>keepAliveTime &lt; 0</code><br>
              <code>maximumPoolSize &lt;= 0</code><br>
              <code>maximumPoolSize &lt; corePoolSize</code>
      @throws NullPointerException if <code>workQueue</code>
              or <code>handler</code> is null</div>
<a id="L1259" name="L1259"></a>1259     <strong class="reserved">public</strong> ThreadPoolExecutor(<strong class="reserved">int</strong> corePoolSize,
<a id="L1260" name="L1260"></a>1260                               <strong class="reserved">int</strong> maximumPoolSize,
<a id="L1261" name="L1261"></a>1261                               <strong class="reserved">long</strong> keepAliveTime,
<a id="L1262" name="L1262"></a>1262                               <a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a> unit,
<a id="L1263" name="L1263"></a>1263                               <a href="../S/1109.html#L180" title="Defined at 180 in src/java/util/concurrent/BlockingQueue.java.">BlockingQueue</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; workQueue,
<a id="L1264" name="L1264"></a>1264                               <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>) <em class="brace">{</em>
<a id="L1265" name="L1265"></a>1265         <strong class="reserved">this</strong>(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,
<a id="L1266" name="L1266"></a>1266              <a href="../S/1124.html#L71" title="Defined at 71 in src/java/util/concurrent/Executors.java.">Executors</a>.<a href="../S/1124.html#L352" title="Defined at 352 in src/java/util/concurrent/Executors.java.">defaultThreadFactory</a>(), <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>);
<a id="L1267" name="L1267"></a>1267     <em class="brace">}</em>
<a id="L1268" name="L1268"></a>1268 
<div class="comment">
      Creates a new <code>ThreadPoolExecutor</code> with the given initial
      parameters.
      @param corePoolSize the number of threads to keep in the pool, even
             if they are idle, unless <code>allowCoreThreadTimeOut</code> is set
      @param maximumPoolSize the maximum number of threads to allow in the
             pool
      @param keepAliveTime when the number of threads is greater than
             the core, this is the maximum time that excess idle threads
             will wait for new tasks before terminating.
      @param unit the time unit for the <code>keepAliveTime</code> argument
      @param workQueue the queue to use for holding tasks before they are
             executed.  This queue will hold only the <code>Runnable</code>
             tasks submitted by the <code>execute</code> method.
      @param threadFactory the factory to use when the executor
             creates a new thread
      @param handler the handler to use when execution is blocked
             because the thread bounds and queue capacities are reached
      @throws IllegalArgumentException if one of the following holds:<br>
              <code>corePoolSize &lt; 0</code><br>
              <code>keepAliveTime &lt; 0</code><br>
              <code>maximumPoolSize &lt;= 0</code><br>
              <code>maximumPoolSize &lt; corePoolSize</code>
      @throws NullPointerException if <code>workQueue</code>
              or <code>threadFactory</code> or <code>handler</code> is null</div>
<a id="L1296" name="L1296"></a>1296     <strong class="reserved">public</strong> ThreadPoolExecutor(<strong class="reserved">int</strong> corePoolSize,
<a id="L1297" name="L1297"></a>1297                               <strong class="reserved">int</strong> maximumPoolSize,
<a id="L1298" name="L1298"></a>1298                               <strong class="reserved">long</strong> keepAliveTime,
<a id="L1299" name="L1299"></a>1299                               <a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a> unit,
<a id="L1300" name="L1300"></a>1300                               <a href="../S/1109.html#L180" title="Defined at 180 in src/java/util/concurrent/BlockingQueue.java.">BlockingQueue</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; workQueue,
<a id="L1301" name="L1301"></a>1301                               <a href="../S/1104.html#L58" title="Defined at 58 in src/java/util/concurrent/ThreadFactory.java.">ThreadFactory</a> threadFactory,
<a id="L1302" name="L1302"></a>1302                               <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>) <em class="brace">{</em>
<a id="L1303" name="L1303"></a>1303         <strong class="reserved">if</strong> (corePoolSize &lt; 0 ||
<a id="L1304" name="L1304"></a>1304             maximumPoolSize &lt;= 0 ||
<a id="L1305" name="L1305"></a>1305             maximumPoolSize &lt; corePoolSize ||
<a id="L1306" name="L1306"></a>1306             keepAliveTime &lt; 0)
<a id="L1307" name="L1307"></a>1307             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L1308" name="L1308"></a>1308         <strong class="reserved">if</strong> (workQueue == <strong class="reserved">null</strong> || threadFactory == <strong class="reserved">null</strong> || <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a> == <strong class="reserved">null</strong>)
<a id="L1309" name="L1309"></a>1309             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L1310" name="L1310"></a>1310         <strong class="reserved">this</strong>.corePoolSize = corePoolSize;
<a id="L1311" name="L1311"></a>1311         <strong class="reserved">this</strong>.maximumPoolSize = maximumPoolSize;
<a id="L1312" name="L1312"></a>1312         <strong class="reserved">this</strong>.workQueue = workQueue;
<a id="L1313" name="L1313"></a>1313         <strong class="reserved">this</strong>.keepAliveTime = unit.<a href="../D/35449.html" title="Multiple defined in 2 places.">toNanos</a>(keepAliveTime);
<a id="L1314" name="L1314"></a>1314         <strong class="reserved">this</strong>.threadFactory = threadFactory;
<a id="L1315" name="L1315"></a>1315         <strong class="reserved">this</strong>.<a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a> = <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>;
<a id="L1316" name="L1316"></a>1316     <em class="brace">}</em>
<a id="L1317" name="L1317"></a>1317 
<div class="comment">
      Executes the given task sometime in the future.  The task
      may execute in a new thread or in an existing pooled thread.
      If the task cannot be submitted for execution, either because this
      executor has been shutdown or because its capacity has been reached,
      the task is handled by the current <code>RejectedExecutionHandler</code>.
      @param command the task to execute
      @throws RejectedExecutionException at discretion of
              <code>RejectedExecutionHandler</code>, if the task
              cannot be accepted for execution
      @throws NullPointerException if <code>command</code> is null</div>
<a id="L1332" name="L1332"></a>1332     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/14093.html" title="Multiple referred from 117 places.">execute</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> <a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>) <em class="brace">{</em>
<a id="L1333" name="L1333"></a>1333         <strong class="reserved">if</strong> (<a href="../D/13010.html" title="Multiple defined in 4 places.">command</a> == <strong class="reserved">null</strong>)
<a id="L1334" name="L1334"></a>1334             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<div class="comment">
          Proceed in 3 steps:
          1. If fewer than corePoolSize threads are running, try to
          start a new thread with the given command as its first
          task.  The call to addWorker atomically checks runState and
          workerCount, and so prevents false alarms that would add
          threads when it shouldn't, by returning false.
          2. If a task can be successfully queued, then we still need
          to double-check whether we should have added a thread
          (because existing ones died since last checking) or that
          the pool shut down since entry into this method. So we
          recheck state and if necessary roll back the enqueuing if
          stopped, or start a new thread if there are none.
          3. If we cannot queue task, then we try to add a new
          thread.  If it fails, we know we are shut down or saturated
          and so reject the task.</div>
<a id="L1355" name="L1355"></a>1355         <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L1356" name="L1356"></a>1356         <strong class="reserved">if</strong> (<a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) &lt; corePoolSize) <em class="brace">{</em>
<a id="L1357" name="L1357"></a>1357             <strong class="reserved">if</strong> (<a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>, <strong class="reserved">true</strong>))
<a id="L1358" name="L1358"></a>1358                 <strong class="reserved">return</strong>;
<a id="L1359" name="L1359"></a>1359             <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L1360" name="L1360"></a>1360         <em class="brace">}</em>
<a id="L1361" name="L1361"></a>1361         <strong class="reserved">if</strong> (<a href="../D/26198.html" title="Multiple defined in 5 places.">isRunning</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) &amp;&amp; workQueue.<a href="../D/28469.html" title="Multiple defined in 29 places.">offer</a>(<a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>)) <em class="brace">{</em>
<a id="L1362" name="L1362"></a>1362             <strong class="reserved">int</strong> recheck = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L1363" name="L1363"></a>1363             <strong class="reserved">if</strong> (! <a href="../D/26198.html" title="Multiple defined in 5 places.">isRunning</a>(recheck) &amp;&amp; <a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(<a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>))
<a id="L1364" name="L1364"></a>1364                 <a href="../S/1117.html#L822" title="Defined at 822 in src/java/util/concurrent/ThreadPoolExecutor.java.">reject</a>(<a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>);
<a id="L1365" name="L1365"></a>1365             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(recheck) == 0)
<a id="L1366" name="L1366"></a>1366                 <a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<strong class="reserved">null</strong>, <strong class="reserved">false</strong>);
<a id="L1367" name="L1367"></a>1367         <em class="brace">}</em>
<a id="L1368" name="L1368"></a>1368         <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!<a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>, <strong class="reserved">false</strong>))
<a id="L1369" name="L1369"></a>1369             <a href="../S/1117.html#L822" title="Defined at 822 in src/java/util/concurrent/ThreadPoolExecutor.java.">reject</a>(<a href="../D/13010.html" title="Multiple defined in 4 places.">command</a>);
<a id="L1370" name="L1370"></a>1370     <em class="brace">}</em>
<a id="L1371" name="L1371"></a>1371 
<div class="comment">
      Initiates an orderly shutdown in which previously submitted
      tasks are executed, but no new tasks will be accepted.
      Invocation has no additional effect if already shut down.
      <p>This method does not wait for previously submitted tasks to
      complete execution.  Use {@link #awaitTermination awaitTermination}
      to do that.
      @throws SecurityException {@inheritDoc}</p></div>
<a id="L1383" name="L1383"></a>1383     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28585.html" title="Multiple referred from 25 places.">shutdown</a>() <em class="brace">{</em>
<a id="L1384" name="L1384"></a>1384         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1385" name="L1385"></a>1385         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1386" name="L1386"></a>1386         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1387" name="L1387"></a>1387             <a href="../S/1117.html#L732" title="Defined at 732 in src/java/util/concurrent/ThreadPoolExecutor.java.">checkShutdownAccess</a>();
<a id="L1388" name="L1388"></a>1388             <a href="../S/1117.html#L670" title="Defined at 670 in src/java/util/concurrent/ThreadPoolExecutor.java.">advanceRunState</a>(SHUTDOWN);
<a id="L1389" name="L1389"></a>1389             <a href="../D/24972.html" title="Multiple defined in 2 places.">interruptIdleWorkers</a>();
<a id="L1390" name="L1390"></a>1390             <a href="../D/28493.html" title="Multiple defined in 2 places.">onShutdown</a>(); <em class="comment">// hook for ScheduledThreadPoolExecutor</em>
<a id="L1391" name="L1391"></a>1391         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1392" name="L1392"></a>1392             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1393" name="L1393"></a>1393         <em class="brace">}</em>
<a id="L1394" name="L1394"></a>1394         <a href="../D/35739.html" title="Multiple defined in 2 places.">tryTerminate</a>();
<a id="L1395" name="L1395"></a>1395     <em class="brace">}</em>
<a id="L1396" name="L1396"></a>1396 
<div class="comment">
      Attempts to stop all actively executing tasks, halts the
      processing of waiting tasks, and returns a list of the tasks
      that were awaiting execution. These tasks are drained (removed)
      from the task queue upon return from this method.
      <p>This method does not wait for actively executing tasks to
      terminate.  Use {@link #awaitTermination awaitTermination} to
      do that.
      </p><p>There are no guarantees beyond best-effort attempts to stop
      processing actively executing tasks.  This implementation
      cancels tasks via {@link Thread#interrupt}, so any task that
      fails to respond to interrupts may never terminate.
      @throws SecurityException {@inheritDoc}</p></div>
<a id="L1414" name="L1414"></a>1414     <strong class="reserved">public</strong> <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; <a href="../R/28588.html" title="Multiple referred from 2 places.">shutdownNow</a>() <em class="brace">{</em>
<a id="L1415" name="L1415"></a>1415         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; tasks;
<a id="L1416" name="L1416"></a>1416         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1417" name="L1417"></a>1417         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1418" name="L1418"></a>1418         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1419" name="L1419"></a>1419             <a href="../S/1117.html#L732" title="Defined at 732 in src/java/util/concurrent/ThreadPoolExecutor.java.">checkShutdownAccess</a>();
<a id="L1420" name="L1420"></a>1420             <a href="../S/1117.html#L670" title="Defined at 670 in src/java/util/concurrent/ThreadPoolExecutor.java.">advanceRunState</a>(STOP);
<a id="L1421" name="L1421"></a>1421             <a href="../S/1117.html#L751" title="Defined at 751 in src/java/util/concurrent/ThreadPoolExecutor.java.">interruptWorkers</a>();
<a id="L1422" name="L1422"></a>1422             tasks = <a href="../S/1117.html#L851" title="Defined at 851 in src/java/util/concurrent/ThreadPoolExecutor.java.">drainQueue</a>();
<a id="L1423" name="L1423"></a>1423         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1424" name="L1424"></a>1424             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1425" name="L1425"></a>1425         <em class="brace">}</em>
<a id="L1426" name="L1426"></a>1426         <a href="../D/35739.html" title="Multiple defined in 2 places.">tryTerminate</a>();
<a id="L1427" name="L1427"></a>1427         <strong class="reserved">return</strong> tasks;
<a id="L1428" name="L1428"></a>1428     <em class="brace">}</em>
<a id="L1429" name="L1429"></a>1429 
<a id="L1430" name="L1430"></a>1430     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/22020.html" title="Multiple referred from 12 places.">isShutdown</a>() <em class="brace">{</em>
<a id="L1431" name="L1431"></a>1431         <strong class="reserved">return</strong> ! <a href="../D/26198.html" title="Multiple defined in 5 places.">isRunning</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>());
<a id="L1432" name="L1432"></a>1432     <em class="brace">}</em>
<a id="L1433" name="L1433"></a>1433 
<div class="comment">
      Returns true if this executor is in the process of terminating
      after {@link #shutdown} or {@link #shutdownNow} but has not
      completely terminated.  This method may be useful for
      debugging. A return of <code>true</code> reported a sufficient
      period after shutdown may indicate that submitted tasks have
      ignored or suppressed interruption, causing this executor not
      to properly terminate.
      @return <code>true</code> if terminating but not yet terminated</div>
<a id="L1445" name="L1445"></a>1445     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> isTerminating() <em class="brace">{</em>
<a id="L1446" name="L1446"></a>1446         <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L1447" name="L1447"></a>1447         <strong class="reserved">return</strong> ! <a href="../D/26198.html" title="Multiple defined in 5 places.">isRunning</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) &amp;&amp; <a href="../S/1117.html#L398" title="Defined at 398 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateLessThan</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, TERMINATED);
<a id="L1448" name="L1448"></a>1448     <em class="brace">}</em>
<a id="L1449" name="L1449"></a>1449 
<a id="L1450" name="L1450"></a>1450     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/22100.html" title="Multiple referred from 3 places.">isTerminated</a>() <em class="brace">{</em>
<a id="L1451" name="L1451"></a>1451         <strong class="reserved">return</strong> <a href="../S/1117.html#L402" title="Defined at 402 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateAtLeast</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(), TERMINATED);
<a id="L1452" name="L1452"></a>1452     <em class="brace">}</em>
<a id="L1453" name="L1453"></a>1453 
<a id="L1454" name="L1454"></a>1454     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../S/1124.html#L675" title="Referred from 675 in src/java/util/concurrent/Executors.java.">awaitTermination</a>(<strong class="reserved">long</strong> timeout, <a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a> unit)
<a id="L1455" name="L1455"></a>1455         <strong class="reserved">throws</strong> <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> <em class="brace">{</em>
<a id="L1456" name="L1456"></a>1456         <strong class="reserved">long</strong> nanos = unit.<a href="../D/35449.html" title="Multiple defined in 2 places.">toNanos</a>(timeout);
<a id="L1457" name="L1457"></a>1457         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1458" name="L1458"></a>1458         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1459" name="L1459"></a>1459         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1460" name="L1460"></a>1460             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L1461" name="L1461"></a>1461                 <strong class="reserved">if</strong> (<a href="../S/1117.html#L402" title="Defined at 402 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateAtLeast</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(), TERMINATED))
<a id="L1462" name="L1462"></a>1462                     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1463" name="L1463"></a>1463                 <strong class="reserved">if</strong> (nanos &lt;= 0)
<a id="L1464" name="L1464"></a>1464                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1465" name="L1465"></a>1465                 nanos = termination.<a href="../D/11677.html" title="Multiple defined in 3 places.">awaitNanos</a>(nanos);
<a id="L1466" name="L1466"></a>1466             <em class="brace">}</em>
<a id="L1467" name="L1467"></a>1467         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1468" name="L1468"></a>1468             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1469" name="L1469"></a>1469         <em class="brace">}</em>
<a id="L1470" name="L1470"></a>1470     <em class="brace">}</em>
<a id="L1471" name="L1471"></a>1471 
<div class="comment">
      Invokes <code>shutdown</code> when this executor is no longer
      referenced and it has no threads.</div>
<a id="L1476" name="L1476"></a>1476     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/14337.html" title="Multiple referred from 5 places.">finalize</a>() <em class="brace">{</em>
<a id="L1477" name="L1477"></a>1477         <a href="../D/34538.html" title="Multiple defined in 27 places.">shutdown</a>();
<a id="L1478" name="L1478"></a>1478     <em class="brace">}</em>
<a id="L1479" name="L1479"></a>1479 
<div class="comment">
      Sets the thread factory used to create new threads.
      @param threadFactory the new thread factory
      @throws NullPointerException if threadFactory is null
      @see #getThreadFactory</div>
<a id="L1487" name="L1487"></a>1487     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setThreadFactory(<a href="../S/1104.html#L58" title="Defined at 58 in src/java/util/concurrent/ThreadFactory.java.">ThreadFactory</a> threadFactory) <em class="brace">{</em>
<a id="L1488" name="L1488"></a>1488         <strong class="reserved">if</strong> (threadFactory == <strong class="reserved">null</strong>)
<a id="L1489" name="L1489"></a>1489             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L1490" name="L1490"></a>1490         <strong class="reserved">this</strong>.threadFactory = threadFactory;
<a id="L1491" name="L1491"></a>1491     <em class="brace">}</em>
<a id="L1492" name="L1492"></a>1492 
<div class="comment">
      Returns the thread factory used to create new threads.
      @return the current thread factory
      @see #setThreadFactory(ThreadFactory)</div>
<a id="L1499" name="L1499"></a>1499     <strong class="reserved">public</strong> <a href="../S/1104.html#L58" title="Defined at 58 in src/java/util/concurrent/ThreadFactory.java.">ThreadFactory</a> <a href="../R/19456.html" title="Multiple referred from 2 places.">getThreadFactory</a>() <em class="brace">{</em>
<a id="L1500" name="L1500"></a>1500         <strong class="reserved">return</strong> threadFactory;
<a id="L1501" name="L1501"></a>1501     <em class="brace">}</em>
<a id="L1502" name="L1502"></a>1502 
<div class="comment">
      Sets a new handler for unexecutable tasks.
      @param handler the new handler
      @throws NullPointerException if handler is null
      @see #getRejectedExecutionHandler</div>
<a id="L1510" name="L1510"></a>1510     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setRejectedExecutionHandler(<a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>) <em class="brace">{</em>
<a id="L1511" name="L1511"></a>1511         <strong class="reserved">if</strong> (<a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a> == <strong class="reserved">null</strong>)
<a id="L1512" name="L1512"></a>1512             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L1513" name="L1513"></a>1513         <strong class="reserved">this</strong>.<a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a> = <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>;
<a id="L1514" name="L1514"></a>1514     <em class="brace">}</em>
<a id="L1515" name="L1515"></a>1515 
<div class="comment">
      Returns the current handler for unexecutable tasks.
      @return the current handler
      @see #setRejectedExecutionHandler(RejectedExecutionHandler)</div>
<a id="L1522" name="L1522"></a>1522     <strong class="reserved">public</strong> <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> getRejectedExecutionHandler() <em class="brace">{</em>
<a id="L1523" name="L1523"></a>1523         <strong class="reserved">return</strong> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>;
<a id="L1524" name="L1524"></a>1524     <em class="brace">}</em>
<a id="L1525" name="L1525"></a>1525 
<div class="comment">
      Sets the core number of threads.  This overrides any value set
      in the constructor.  If the new value is smaller than the
      current value, excess existing threads will be terminated when
      they next become idle.  If larger, new threads will, if needed,
      be started to execute any queued tasks.
      @param corePoolSize the new core size
      @throws IllegalArgumentException if <code>corePoolSize &lt; 0</code>
      @see #getCorePoolSize</div>
<a id="L1537" name="L1537"></a>1537     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setCorePoolSize(<strong class="reserved">int</strong> corePoolSize) <em class="brace">{</em>
<a id="L1538" name="L1538"></a>1538         <strong class="reserved">if</strong> (corePoolSize &lt; 0)
<a id="L1539" name="L1539"></a>1539             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L1540" name="L1540"></a>1540         <strong class="reserved">int</strong> delta = corePoolSize - <strong class="reserved">this</strong>.corePoolSize;
<a id="L1541" name="L1541"></a>1541         <strong class="reserved">this</strong>.corePoolSize = corePoolSize;
<a id="L1542" name="L1542"></a>1542         <strong class="reserved">if</strong> (<a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>()) &gt; corePoolSize)
<a id="L1543" name="L1543"></a>1543             <a href="../D/24972.html" title="Multiple defined in 2 places.">interruptIdleWorkers</a>();
<a id="L1544" name="L1544"></a>1544         <strong class="reserved">else</strong> <strong class="reserved">if</strong> (delta &gt; 0) <em class="brace">{</em>
<a id="L1545" name="L1545"></a>1545             <em class="comment">// We don't really know how many new threads are "needed".</em>
<a id="L1546" name="L1546"></a>1546             <em class="comment">// As a heuristic, prestart enough new workers (up to new</em>
<a id="L1547" name="L1547"></a>1547             <em class="comment">// core size) to handle the current number of tasks in</em>
<a id="L1548" name="L1548"></a>1548             <em class="comment">// queue, but stop if queue becomes empty while doing so.</em>
<a id="L1549" name="L1549"></a>1549             <strong class="reserved">int</strong> k = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(delta, workQueue.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>());
<a id="L1550" name="L1550"></a>1550             <strong class="reserved">while</strong> (k-- &gt; 0 &amp;&amp; <a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<strong class="reserved">null</strong>, <strong class="reserved">true</strong>)) <em class="brace">{</em>
<a id="L1551" name="L1551"></a>1551                 <strong class="reserved">if</strong> (workQueue.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>())
<a id="L1552" name="L1552"></a>1552                     <strong class="reserved">break</strong>;
<a id="L1553" name="L1553"></a>1553             <em class="brace">}</em>
<a id="L1554" name="L1554"></a>1554         <em class="brace">}</em>
<a id="L1555" name="L1555"></a>1555     <em class="brace">}</em>
<a id="L1556" name="L1556"></a>1556 
<div class="comment">
      Returns the core number of threads.
      @return the core number of threads
      @see #setCorePoolSize</div>
<a id="L1563" name="L1563"></a>1563     <strong class="reserved">public</strong> <strong class="reserved">int</strong> getCorePoolSize() <em class="brace">{</em>
<a id="L1564" name="L1564"></a>1564         <strong class="reserved">return</strong> corePoolSize;
<a id="L1565" name="L1565"></a>1565     <em class="brace">}</em>
<a id="L1566" name="L1566"></a>1566 
<div class="comment">
      Starts a core thread, causing it to idly wait for work. This
      overrides the default policy of starting core threads only when
      new tasks are executed. This method will return <code>false</code>
      if all core threads have already been started.
      @return <code>true</code> if a thread was started</div>
<a id="L1575" name="L1575"></a>1575     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> prestartCoreThread() <em class="brace">{</em>
<a id="L1576" name="L1576"></a>1576         <strong class="reserved">return</strong> <a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>()) &lt; corePoolSize &amp;&amp;
<a id="L1577" name="L1577"></a>1577             <a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<strong class="reserved">null</strong>, <strong class="reserved">true</strong>);
<a id="L1578" name="L1578"></a>1578     <em class="brace">}</em>
<a id="L1579" name="L1579"></a>1579 
<div class="comment">
      Same as prestartCoreThread except arranges that at least one
      thread is started even if corePoolSize is 0.</div>
<a id="L1584" name="L1584"></a>1584     <strong class="reserved">void</strong> <a href="../R/13937.html" title="Multiple referred from 2 places.">ensurePrestart</a>() <em class="brace">{</em>
<a id="L1585" name="L1585"></a>1585         <strong class="reserved">int</strong> wc = <a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>());
<a id="L1586" name="L1586"></a>1586         <strong class="reserved">if</strong> (wc &lt; corePoolSize)
<a id="L1587" name="L1587"></a>1587             <a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<strong class="reserved">null</strong>, <strong class="reserved">true</strong>);
<a id="L1588" name="L1588"></a>1588         <strong class="reserved">else</strong> <strong class="reserved">if</strong> (wc == 0)
<a id="L1589" name="L1589"></a>1589             <a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<strong class="reserved">null</strong>, <strong class="reserved">false</strong>);
<a id="L1590" name="L1590"></a>1590     <em class="brace">}</em>
<a id="L1591" name="L1591"></a>1591 
<div class="comment">
      Starts all core threads, causing them to idly wait for work. This
      overrides the default policy of starting core threads only when
      new tasks are executed.
      @return the number of threads started</div>
<a id="L1599" name="L1599"></a>1599     <strong class="reserved">public</strong> <strong class="reserved">int</strong> prestartAllCoreThreads() <em class="brace">{</em>
<a id="L1600" name="L1600"></a>1600         <strong class="reserved">int</strong> n = 0;
<a id="L1601" name="L1601"></a>1601         <strong class="reserved">while</strong> (<a href="../S/1117.html#L894" title="Defined at 894 in src/java/util/concurrent/ThreadPoolExecutor.java.">addWorker</a>(<strong class="reserved">null</strong>, <strong class="reserved">true</strong>))
<a id="L1602" name="L1602"></a>1602             ++n;
<a id="L1603" name="L1603"></a>1603         <strong class="reserved">return</strong> n;
<a id="L1604" name="L1604"></a>1604     <em class="brace">}</em>
<a id="L1605" name="L1605"></a>1605 
<div class="comment">
      Returns true if this pool allows core threads to time out and
      terminate if no tasks arrive within the keepAlive time, being
      replaced if needed when new tasks arrive. When true, the same
      keep-alive policy applying to non-core threads applies also to
      core threads. When false (the default), core threads are never
      terminated due to lack of incoming tasks.
      @return <code>true</code> if core threads are allowed to time out,
              else <code>false</code>
      @since 1.6</div>
<a id="L1619" name="L1619"></a>1619     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../S/1117.html#L1697" title="Referred from 1697 in src/java/util/concurrent/ThreadPoolExecutor.java.">allowsCoreThreadTimeOut</a>() <em class="brace">{</em>
<a id="L1620" name="L1620"></a>1620         <strong class="reserved">return</strong> <a href="../S/1117.html#L1640" title="Defined at 1640 in src/java/util/concurrent/ThreadPoolExecutor.java.">allowCoreThreadTimeOut</a>;
<a id="L1621" name="L1621"></a>1621     <em class="brace">}</em>
<a id="L1622" name="L1622"></a>1622 
<div class="comment">
      Sets the policy governing whether core threads may time out and
      terminate if no tasks arrive within the keep-alive time, being
      replaced if needed when new tasks arrive. When false, core
      threads are never terminated due to lack of incoming
      tasks. When true, the same keep-alive policy applying to
      non-core threads applies also to core threads. To avoid
      continual thread replacement, the keep-alive time must be
      greater than zero when setting <code>true</code>. This method
      should in general be called before the pool is actively used.
      @param value <code>true</code> if should time out, else <code>false</code>
      @throws IllegalArgumentException if value is <code>true</code>
              and the current keep-alive time is not greater than zero
      @since 1.6</div>
<a id="L1640" name="L1640"></a>1640     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/10149.html" title="Multiple referred from 7 places.">allowCoreThreadTimeOut</a>(<strong class="reserved">boolean</strong> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>) <em class="brace">{</em>
<a id="L1641" name="L1641"></a>1641         <strong class="reserved">if</strong> (<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> &amp;&amp; keepAliveTime &lt;= 0)
<a id="L1642" name="L1642"></a>1642             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Core threads must have nonzero keep alive times");
<a id="L1643" name="L1643"></a>1643         <strong class="reserved">if</strong> (<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> != <a href="../S/1117.html#L1640" title="Defined at 1640 in src/java/util/concurrent/ThreadPoolExecutor.java.">allowCoreThreadTimeOut</a>) <em class="brace">{</em>
<a id="L1644" name="L1644"></a>1644             <a href="../S/1117.html#L1640" title="Defined at 1640 in src/java/util/concurrent/ThreadPoolExecutor.java.">allowCoreThreadTimeOut</a> = <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>;
<a id="L1645" name="L1645"></a>1645             <strong class="reserved">if</strong> (<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>)
<a id="L1646" name="L1646"></a>1646                 <a href="../D/24972.html" title="Multiple defined in 2 places.">interruptIdleWorkers</a>();
<a id="L1647" name="L1647"></a>1647         <em class="brace">}</em>
<a id="L1648" name="L1648"></a>1648     <em class="brace">}</em>
<a id="L1649" name="L1649"></a>1649 
<div class="comment">
      Sets the maximum allowed number of threads. This overrides any
      value set in the constructor. If the new value is smaller than
      the current value, excess existing threads will be
      terminated when they next become idle.
      @param maximumPoolSize the new maximum
      @throws IllegalArgumentException if the new maximum is
              less than or equal to zero, or
              less than the {@linkplain #getCorePoolSize core pool size}
      @see #getMaximumPoolSize</div>
<a id="L1662" name="L1662"></a>1662     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setMaximumPoolSize(<strong class="reserved">int</strong> maximumPoolSize) <em class="brace">{</em>
<a id="L1663" name="L1663"></a>1663         <strong class="reserved">if</strong> (maximumPoolSize &lt;= 0 || maximumPoolSize &lt; corePoolSize)
<a id="L1664" name="L1664"></a>1664             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L1665" name="L1665"></a>1665         <strong class="reserved">this</strong>.maximumPoolSize = maximumPoolSize;
<a id="L1666" name="L1666"></a>1666         <strong class="reserved">if</strong> (<a href="../S/1117.html#L390" title="Defined at 390 in src/java/util/concurrent/ThreadPoolExecutor.java.">workerCountOf</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>()) &gt; maximumPoolSize)
<a id="L1667" name="L1667"></a>1667             <a href="../D/24972.html" title="Multiple defined in 2 places.">interruptIdleWorkers</a>();
<a id="L1668" name="L1668"></a>1668     <em class="brace">}</em>
<a id="L1669" name="L1669"></a>1669 
<div class="comment">
      Returns the maximum allowed number of threads.
      @return the maximum allowed number of threads
      @see #setMaximumPoolSize</div>
<a id="L1676" name="L1676"></a>1676     <strong class="reserved">public</strong> <strong class="reserved">int</strong> getMaximumPoolSize() <em class="brace">{</em>
<a id="L1677" name="L1677"></a>1677         <strong class="reserved">return</strong> maximumPoolSize;
<a id="L1678" name="L1678"></a>1678     <em class="brace">}</em>
<a id="L1679" name="L1679"></a>1679 
<div class="comment">
      Sets the time limit for which threads may remain idle before
      being terminated.  If there are more than the core number of
      threads currently in the pool, after waiting this amount of
      time without processing a task, excess threads will be
      terminated.  This overrides any value set in the constructor.
      @param time the time to wait.  A time value of zero will cause
             excess threads to terminate immediately after executing tasks.
      @param unit the time unit of the <code>time</code> argument
      @throws IllegalArgumentException if <code>time</code> less than zero or
              if <code>time</code> is zero and <code>allowsCoreThreadTimeOut</code>
      @see #getKeepAliveTime(TimeUnit)</div>
<a id="L1694" name="L1694"></a>1694     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setKeepAliveTime(<strong class="reserved">long</strong> <a href="../D/35330.html" title="Multiple defined in 2 places.">time</a>, <a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a> unit) <em class="brace">{</em>
<a id="L1695" name="L1695"></a>1695         <strong class="reserved">if</strong> (<a href="../D/35330.html" title="Multiple defined in 2 places.">time</a> &lt; 0)
<a id="L1696" name="L1696"></a>1696             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L1697" name="L1697"></a>1697         <strong class="reserved">if</strong> (<a href="../D/35330.html" title="Multiple defined in 2 places.">time</a> == 0 &amp;&amp; <a href="../S/1117.html#L1619" title="Defined at 1619 in src/java/util/concurrent/ThreadPoolExecutor.java.">allowsCoreThreadTimeOut</a>())
<a id="L1698" name="L1698"></a>1698             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Core threads must have nonzero keep alive times");
<a id="L1699" name="L1699"></a>1699         <strong class="reserved">long</strong> keepAliveTime = unit.<a href="../D/35449.html" title="Multiple defined in 2 places.">toNanos</a>(<a href="../D/35330.html" title="Multiple defined in 2 places.">time</a>);
<a id="L1700" name="L1700"></a>1700         <strong class="reserved">long</strong> delta = keepAliveTime - <strong class="reserved">this</strong>.keepAliveTime;
<a id="L1701" name="L1701"></a>1701         <strong class="reserved">this</strong>.keepAliveTime = keepAliveTime;
<a id="L1702" name="L1702"></a>1702         <strong class="reserved">if</strong> (delta &lt; 0)
<a id="L1703" name="L1703"></a>1703             <a href="../D/24972.html" title="Multiple defined in 2 places.">interruptIdleWorkers</a>();
<a id="L1704" name="L1704"></a>1704     <em class="brace">}</em>
<a id="L1705" name="L1705"></a>1705 
<div class="comment">
      Returns the thread keep-alive time, which is the amount of time
      that threads in excess of the core pool size may remain
      idle before being terminated.
      @param unit the desired time unit of the result
      @return the time limit
      @see #setKeepAliveTime(long, TimeUnit)</div>
<a id="L1715" name="L1715"></a>1715     <strong class="reserved">public</strong> <strong class="reserved">long</strong> getKeepAliveTime(<a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a> unit) <em class="brace">{</em>
<a id="L1716" name="L1716"></a>1716         <strong class="reserved">return</strong> unit.<a href="../D/13388.html" title="Multiple defined in 7 places.">convert</a>(keepAliveTime, <a href="../S/1102.html#L71" title="Defined at 71 in src/java/util/concurrent/TimeUnit.java.">TimeUnit</a>.NANOSECONDS);
<a id="L1717" name="L1717"></a>1717     <em class="brace">}</em>
<a id="L1718" name="L1718"></a>1718 
<div class="comment">
     /* User-level queue utilities */</div>
<a id="L1720" name="L1720"></a>1720 
<div class="comment">
      Returns the task queue used by this executor. Access to the
      task queue is intended primarily for debugging and monitoring.
      This queue may be in active use.  Retrieving the task queue
      does not prevent queued tasks from executing.
      @return the task queue</div>
<a id="L1729" name="L1729"></a>1729     <strong class="reserved">public</strong> <a href="../S/1109.html#L180" title="Defined at 180 in src/java/util/concurrent/BlockingQueue.java.">BlockingQueue</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; <a href="../R/18571.html" title="Multiple referred from 7 places.">getQueue</a>() <em class="brace">{</em>
<a id="L1730" name="L1730"></a>1730         <strong class="reserved">return</strong> workQueue;
<a id="L1731" name="L1731"></a>1731     <em class="brace">}</em>
<a id="L1732" name="L1732"></a>1732 
<div class="comment">
      Removes this task from the executor's internal queue if it is
      present, thus causing it not to be run if it has not already
      started.
      <p>This method may be useful as one part of a cancellation
      scheme.  It may fail to remove tasks that have been converted
      into other forms before being placed on the internal queue. For
      example, a task entered using <code>submit</code> might be
      converted into a form that maintains <code>Future</code> status.
      However, in such cases, method {@link #purge} may be used to
      remove those Futures that have been cancelled.
      @param task the task to remove
      @return <code>true</code> if the task was removed</p></div>
<a id="L1749" name="L1749"></a>1749     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/25882.html" title="Multiple referred from 1115 places.">remove</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> task) <em class="brace">{</em>
<a id="L1750" name="L1750"></a>1750         <strong class="reserved">boolean</strong> removed = workQueue.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(task);
<a id="L1751" name="L1751"></a>1751         <a href="../D/35739.html" title="Multiple defined in 2 places.">tryTerminate</a>(); <em class="comment">// In case SHUTDOWN and now empty</em>
<a id="L1752" name="L1752"></a>1752         <strong class="reserved">return</strong> removed;
<a id="L1753" name="L1753"></a>1753     <em class="brace">}</em>
<a id="L1754" name="L1754"></a>1754 
<div class="comment">
      Tries to remove from the work queue all {@link Future}
      tasks that have been cancelled. This method can be useful as a
      storage reclamation operation, that has no other impact on
      functionality. Cancelled tasks are never executed, but may
      accumulate in work queues until worker threads can actively
      remove them. Invoking this method instead tries to remove them now.
      However, this method may fail to remove tasks in
      the presence of interference by other threads.</div>
<a id="L1765" name="L1765"></a>1765     <strong class="reserved">public</strong> <strong class="reserved">void</strong> purge() <em class="brace">{</em>
<a id="L1766" name="L1766"></a>1766         <strong class="reserved">final</strong> <a href="../S/1109.html#L180" title="Defined at 180 in src/java/util/concurrent/BlockingQueue.java.">BlockingQueue</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; q = workQueue;
<a id="L1767" name="L1767"></a>1767         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1768" name="L1768"></a>1768             <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>&gt; it = q.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L1769" name="L1769"></a>1769             <strong class="reserved">while</strong> (it.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L1770" name="L1770"></a>1770                 <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r = it.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L1771" name="L1771"></a>1771                 <strong class="reserved">if</strong> (r <strong class="reserved">instanceof</strong> <a href="../D/3465.html" title="Multiple defined in 2 places.">Future</a>&lt;?&gt; &amp;&amp; ((<a href="../D/3465.html" title="Multiple defined in 2 places.">Future</a>&lt;?&gt;)r).<a href="../D/25280.html" title="Multiple defined in 8 places.">isCancelled</a>())
<a id="L1772" name="L1772"></a>1772                     it.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>();
<a id="L1773" name="L1773"></a>1773             <em class="brace">}</em>
<a id="L1774" name="L1774"></a>1774         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/857.html#L70" title="Defined at 70 in src/java/util/ConcurrentModificationException.java.">ConcurrentModificationException</a> fallThrough) <em class="brace">{</em>
<a id="L1775" name="L1775"></a>1775             <em class="comment">// Take slow path if we encounter interference during traversal.</em>
<a id="L1776" name="L1776"></a>1776             <em class="comment">// Make copy for traversal and call remove for cancelled entries.</em>
<a id="L1777" name="L1777"></a>1777             <em class="comment">// The slow path is more likely to be O(N*N).</em>
<a id="L1778" name="L1778"></a>1778             <strong class="reserved">for</strong> (<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> r : q.<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>())
<a id="L1779" name="L1779"></a>1779                 <strong class="reserved">if</strong> (r <strong class="reserved">instanceof</strong> <a href="../D/3465.html" title="Multiple defined in 2 places.">Future</a>&lt;?&gt; &amp;&amp; ((<a href="../D/3465.html" title="Multiple defined in 2 places.">Future</a>&lt;?&gt;)r).<a href="../D/25280.html" title="Multiple defined in 8 places.">isCancelled</a>())
<a id="L1780" name="L1780"></a>1780                     q.<a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(r);
<a id="L1781" name="L1781"></a>1781         <em class="brace">}</em>
<a id="L1782" name="L1782"></a>1782 
<a id="L1783" name="L1783"></a>1783         <a href="../D/35739.html" title="Multiple defined in 2 places.">tryTerminate</a>(); <em class="comment">// In case SHUTDOWN and now empty</em>
<a id="L1784" name="L1784"></a>1784     <em class="brace">}</em>
<a id="L1785" name="L1785"></a>1785 
<div class="comment">
     /* Statistics */</div>
<a id="L1787" name="L1787"></a>1787 
<div class="comment">
      Returns the current number of threads in the pool.
      @return the number of threads</div>
<a id="L1793" name="L1793"></a>1793     <strong class="reserved">public</strong> <strong class="reserved">int</strong> getPoolSize() <em class="brace">{</em>
<a id="L1794" name="L1794"></a>1794         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1795" name="L1795"></a>1795         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1796" name="L1796"></a>1796         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1797" name="L1797"></a>1797             <em class="comment">// Remove rare and surprising possibility of</em>
<a id="L1798" name="L1798"></a>1798             <em class="comment">// isTerminated() &amp;&amp; getPoolSize() &gt; 0</em>
<a id="L1799" name="L1799"></a>1799             <strong class="reserved">return</strong> <a href="../S/1117.html#L402" title="Defined at 402 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateAtLeast</a>(ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(), TIDYING) ? 0
<a id="L1800" name="L1800"></a>1800                 : workers.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L1801" name="L1801"></a>1801         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1802" name="L1802"></a>1802             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1803" name="L1803"></a>1803         <em class="brace">}</em>
<a id="L1804" name="L1804"></a>1804     <em class="brace">}</em>
<a id="L1805" name="L1805"></a>1805 
<div class="comment">
      Returns the approximate number of threads that are actively
      executing tasks.
      @return the number of threads</div>
<a id="L1812" name="L1812"></a>1812     <strong class="reserved">public</strong> <strong class="reserved">int</strong> getActiveCount() <em class="brace">{</em>
<a id="L1813" name="L1813"></a>1813         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1814" name="L1814"></a>1814         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1815" name="L1815"></a>1815         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1816" name="L1816"></a>1816             <strong class="reserved">int</strong> n = 0;
<a id="L1817" name="L1817"></a>1817             <strong class="reserved">for</strong> (<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w : workers)
<a id="L1818" name="L1818"></a>1818                 <strong class="reserved">if</strong> (w.<a href="../D/25832.html" title="Multiple defined in 3 places.">isLocked</a>())
<a id="L1819" name="L1819"></a>1819                     ++n;
<a id="L1820" name="L1820"></a>1820             <strong class="reserved">return</strong> n;
<a id="L1821" name="L1821"></a>1821         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1822" name="L1822"></a>1822             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1823" name="L1823"></a>1823         <em class="brace">}</em>
<a id="L1824" name="L1824"></a>1824     <em class="brace">}</em>
<a id="L1825" name="L1825"></a>1825 
<div class="comment">
      Returns the largest number of threads that have ever
      simultaneously been in the pool.
      @return the number of threads</div>
<a id="L1832" name="L1832"></a>1832     <strong class="reserved">public</strong> <strong class="reserved">int</strong> getLargestPoolSize() <em class="brace">{</em>
<a id="L1833" name="L1833"></a>1833         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1834" name="L1834"></a>1834         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1835" name="L1835"></a>1835         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1836" name="L1836"></a>1836             <strong class="reserved">return</strong> largestPoolSize;
<a id="L1837" name="L1837"></a>1837         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1838" name="L1838"></a>1838             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1839" name="L1839"></a>1839         <em class="brace">}</em>
<a id="L1840" name="L1840"></a>1840     <em class="brace">}</em>
<a id="L1841" name="L1841"></a>1841 
<div class="comment">
      Returns the approximate total number of tasks that have ever been
      scheduled for execution. Because the states of tasks and
      threads may change dynamically during computation, the returned
      value is only an approximation.
      @return the number of tasks</div>
<a id="L1850" name="L1850"></a>1850     <strong class="reserved">public</strong> <strong class="reserved">long</strong> getTaskCount() <em class="brace">{</em>
<a id="L1851" name="L1851"></a>1851         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1852" name="L1852"></a>1852         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1853" name="L1853"></a>1853         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1854" name="L1854"></a>1854             <strong class="reserved">long</strong> n = completedTaskCount;
<a id="L1855" name="L1855"></a>1855             <strong class="reserved">for</strong> (<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w : workers) <em class="brace">{</em>
<a id="L1856" name="L1856"></a>1856                 n += w.completedTasks;
<a id="L1857" name="L1857"></a>1857                 <strong class="reserved">if</strong> (w.<a href="../D/25832.html" title="Multiple defined in 3 places.">isLocked</a>())
<a id="L1858" name="L1858"></a>1858                     ++n;
<a id="L1859" name="L1859"></a>1859             <em class="brace">}</em>
<a id="L1860" name="L1860"></a>1860             <strong class="reserved">return</strong> n + workQueue.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L1861" name="L1861"></a>1861         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1862" name="L1862"></a>1862             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1863" name="L1863"></a>1863         <em class="brace">}</em>
<a id="L1864" name="L1864"></a>1864     <em class="brace">}</em>
<a id="L1865" name="L1865"></a>1865 
<div class="comment">
      Returns the approximate total number of tasks that have
      completed execution. Because the states of tasks and threads
      may change dynamically during computation, the returned value
      is only an approximation, but one that does not ever decrease
      across successive calls.
      @return the number of tasks</div>
<a id="L1875" name="L1875"></a>1875     <strong class="reserved">public</strong> <strong class="reserved">long</strong> getCompletedTaskCount() <em class="brace">{</em>
<a id="L1876" name="L1876"></a>1876         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1877" name="L1877"></a>1877         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1878" name="L1878"></a>1878         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1879" name="L1879"></a>1879             <strong class="reserved">long</strong> n = completedTaskCount;
<a id="L1880" name="L1880"></a>1880             <strong class="reserved">for</strong> (<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w : workers)
<a id="L1881" name="L1881"></a>1881                 n += w.completedTasks;
<a id="L1882" name="L1882"></a>1882             <strong class="reserved">return</strong> n;
<a id="L1883" name="L1883"></a>1883         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1884" name="L1884"></a>1884             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1885" name="L1885"></a>1885         <em class="brace">}</em>
<a id="L1886" name="L1886"></a>1886     <em class="brace">}</em>
<a id="L1887" name="L1887"></a>1887 
<div class="comment">
      Returns a string identifying this pool, as well as its state,
      including indications of run state and estimated worker and
      task counts.
      @return a string identifying this pool, as well as its state</div>
<a id="L1895" name="L1895"></a>1895     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L1896" name="L1896"></a>1896         <strong class="reserved">long</strong> ncompleted;
<a id="L1897" name="L1897"></a>1897         <strong class="reserved">int</strong> nworkers, nactive;
<a id="L1898" name="L1898"></a>1898         <strong class="reserved">final</strong> <a href="../S/1047.html#L106" title="Defined at 106 in src/java/util/concurrent/locks/ReentrantLock.java.">ReentrantLock</a> mainLock = <strong class="reserved">this</strong>.mainLock;
<a id="L1899" name="L1899"></a>1899         mainLock.<a href="../D/27034.html" title="Multiple defined in 25 places.">lock</a>();
<a id="L1900" name="L1900"></a>1900         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1901" name="L1901"></a>1901             ncompleted = completedTaskCount;
<a id="L1902" name="L1902"></a>1902             nactive = 0;
<a id="L1903" name="L1903"></a>1903             nworkers = workers.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L1904" name="L1904"></a>1904             <strong class="reserved">for</strong> (<a href="../S/1117.html#L588" title="Defined at 588 in src/java/util/concurrent/ThreadPoolExecutor.java.">Worker</a> w : workers) <em class="brace">{</em>
<a id="L1905" name="L1905"></a>1905                 ncompleted += w.completedTasks;
<a id="L1906" name="L1906"></a>1906                 <strong class="reserved">if</strong> (w.<a href="../D/25832.html" title="Multiple defined in 3 places.">isLocked</a>())
<a id="L1907" name="L1907"></a>1907                     ++nactive;
<a id="L1908" name="L1908"></a>1908             <em class="brace">}</em>
<a id="L1909" name="L1909"></a>1909         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L1910" name="L1910"></a>1910             mainLock.<a href="../D/35916.html" title="Multiple defined in 13 places.">unlock</a>();
<a id="L1911" name="L1911"></a>1911         <em class="brace">}</em>
<a id="L1912" name="L1912"></a>1912         <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ctl.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L1913" name="L1913"></a>1913         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> rs = (<a href="../S/1117.html#L398" title="Defined at 398 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateLessThan</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, SHUTDOWN) ? "Running" :
<a id="L1914" name="L1914"></a>1914                      (<a href="../S/1117.html#L402" title="Defined at 402 in src/java/util/concurrent/ThreadPoolExecutor.java.">runStateAtLeast</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, TERMINATED) ? "Terminated" :
<a id="L1915" name="L1915"></a>1915                       "Shutting down"));
<a id="L1916" name="L1916"></a>1916         <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() +
<a id="L1917" name="L1917"></a>1917             "[" + rs +
<a id="L1918" name="L1918"></a>1918             ", pool size = " + nworkers +
<a id="L1919" name="L1919"></a>1919             ", active threads = " + nactive +
<a id="L1920" name="L1920"></a>1920             ", queued tasks = " + workQueue.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() +
<a id="L1921" name="L1921"></a>1921             ", completed tasks = " + ncompleted +
<a id="L1922" name="L1922"></a>1922             "]";
<a id="L1923" name="L1923"></a>1923     <em class="brace">}</em>
<a id="L1924" name="L1924"></a>1924 
<div class="comment">
     /* Extension hooks */</div>
<a id="L1926" name="L1926"></a>1926 
<div class="comment">
      Method invoked prior to executing the given Runnable in the
      given thread.  This method is invoked by thread <code>t</code> that
      will execute task <code>r</code>, and may be used to re-initialize
      ThreadLocals, or to perform logging.
      <p>This implementation does nothing, but may be customized in
      subclasses. Note: To properly nest multiple overridings, subclasses
      should generally invoke <code>super.beforeExecute</code> at the end of
      this method.
      @param t the thread that will run task <code>r</code>
      @param r the task that will be executed</p></div>
<a id="L1941" name="L1941"></a>1941     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L1139" title="Referred from 1139 in src/java/util/concurrent/ThreadPoolExecutor.java.">beforeExecute</a>(<a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> t, <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r) <em class="brace">{</em> <em class="brace">}</em>
<a id="L1942" name="L1942"></a>1942 
<div class="comment">
      Method invoked upon completion of execution of the given Runnable.
      This method is invoked by the thread that executed the task. If
      non-null, the Throwable is the uncaught <code>RuntimeException</code>
      or <code>Error</code> that caused execution to terminate abruptly.
      <p>This implementation does nothing, but may be customized in
      subclasses. Note: To properly nest multiple overridings, subclasses
      should generally invoke <code>super.afterExecute</code> at the
      beginning of this method.
      </p><p><b>Note:</b> When actions are enclosed in tasks (such as
      {@link FutureTask}) either explicitly or via methods such as
      <code>submit</code>, these task objects catch and maintain
      computational exceptions, and so they do not cause abrupt
      termination, and the internal exceptions are <em>not</em>
      passed to this method. If you would like to trap both kinds of
      failures in this method, you can further probe for such cases,
      as in this sample subclass that prints either the direct cause
      or the underlying exception if a task has been aborted:
       </p><pre> {@code
      class ExtendedExecutor extends ThreadPoolExecutor {
        // ...
        protected void afterExecute(Runnable r, Throwable t) {
          super.afterExecute(r, t);
          if (t == null &amp;&amp; r instanceof Future<!--?-->) {
            try {
              Object result = ((Future<!--?-->) r).get();
            } catch (CancellationException ce) {
                t = ce;
            } catch (ExecutionException ee) {
                t = ee.getCause();
            } catch (InterruptedException ie) {
                Thread.currentThread().interrupt(); // ignore/reset
            }
          }
          if (t != null)
            System.out.println(t);
        }
      }}</pre>
      @param r the runnable that has completed
      @param t the exception that caused termination, or null if
      execution completed normally</div>
<a id="L1989" name="L1989"></a>1989     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L1150" title="Referred from 1150 in src/java/util/concurrent/ThreadPoolExecutor.java.">afterExecute</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r, <a href="../S/1726.html#L114" title="Defined at 114 in src/java/lang/Throwable.java.">Throwable</a> t) <em class="brace">{</em> <em class="brace">}</em>
<a id="L1990" name="L1990"></a>1990 
<div class="comment">
      Method invoked when the Executor has terminated.  Default
      implementation does nothing. Note: To properly nest multiple
      overridings, subclasses should generally invoke
      <code>super.terminated</code> within this method.</div>
<a id="L1997" name="L1997"></a>1997     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/29128.html" title="Multiple referred from 34 places.">terminated</a>() <em class="brace">{</em> <em class="brace">}</em>
<a id="L1998" name="L1998"></a>1998 
<div class="comment">
     /* Predefined RejectedExecutionHandlers */</div>
<a id="L2000" name="L2000"></a>2000 
<div class="comment">
      A handler for rejected tasks that runs the rejected task
      directly in the calling thread of the <code>execute</code> method,
      unless the executor has been shut down, in which case the task
      is discarded.</div>
<a id="L2007" name="L2007"></a>2007     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> CallerRunsPolicy <strong class="reserved">implements</strong> <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> <em class="brace">{</em>
<div class="comment">
          Creates a <code>CallerRunsPolicy</code>.</div>
<a id="L2011" name="L2011"></a>2011         <strong class="reserved">public</strong> CallerRunsPolicy() <em class="brace">{</em> <em class="brace">}</em>
<a id="L2012" name="L2012"></a>2012 
<div class="comment">
          Executes task r in the caller's thread, unless the executor
          has been shut down, in which case the task is discarded.
          @param r the runnable task requested to be executed
          @param e the executor attempting to execute this task</div>
<a id="L2020" name="L2020"></a>2020         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L823" title="Referred from 823 in src/java/util/concurrent/ThreadPoolExecutor.java.">rejectedExecution</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r, <a href="../S/1117.html#L319" title="Defined at 319 in src/java/util/concurrent/ThreadPoolExecutor.java.">ThreadPoolExecutor</a> e) <em class="brace">{</em>
<a id="L2021" name="L2021"></a>2021             <strong class="reserved">if</strong> (!e.<a href="../D/26240.html" title="Multiple defined in 5 places.">isShutdown</a>()) <em class="brace">{</em>
<a id="L2022" name="L2022"></a>2022                 r.<a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>();
<a id="L2023" name="L2023"></a>2023             <em class="brace">}</em>
<a id="L2024" name="L2024"></a>2024         <em class="brace">}</em>
<a id="L2025" name="L2025"></a>2025     <em class="brace">}</em>
<a id="L2026" name="L2026"></a>2026 
<div class="comment">
      A handler for rejected tasks that throws a
      <code>RejectedExecutionException</code>.</div>
<a id="L2031" name="L2031"></a>2031     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> <a href="../S/1117.html#L547" title="Referred from 547 in src/java/util/concurrent/ThreadPoolExecutor.java.">AbortPolicy</a> <strong class="reserved">implements</strong> <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> <em class="brace">{</em>
<div class="comment">
          Creates an <code>AbortPolicy</code>.</div>
<a id="L2035" name="L2035"></a>2035         <strong class="reserved">public</strong> AbortPolicy() <em class="brace">{</em> <em class="brace">}</em>
<a id="L2036" name="L2036"></a>2036 
<div class="comment">
          Always throws RejectedExecutionException.
          @param r the runnable task requested to be executed
          @param e the executor attempting to execute this task
          @throws RejectedExecutionException always</div>
<a id="L2044" name="L2044"></a>2044         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L823" title="Referred from 823 in src/java/util/concurrent/ThreadPoolExecutor.java.">rejectedExecution</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r, <a href="../S/1117.html#L319" title="Defined at 319 in src/java/util/concurrent/ThreadPoolExecutor.java.">ThreadPoolExecutor</a> e) <em class="brace">{</em>
<a id="L2045" name="L2045"></a>2045             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1055.html#L45" title="Defined at 45 in src/java/util/concurrent/RejectedExecutionException.java.">RejectedExecutionException</a>("Task " + r.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() +
<a id="L2046" name="L2046"></a>2046                                                  " rejected from " +
<a id="L2047" name="L2047"></a>2047                                                  e.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L2048" name="L2048"></a>2048         <em class="brace">}</em>
<a id="L2049" name="L2049"></a>2049     <em class="brace">}</em>
<a id="L2050" name="L2050"></a>2050 
<div class="comment">
      A handler for rejected tasks that silently discards the
      rejected task.</div>
<a id="L2055" name="L2055"></a>2055     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> DiscardPolicy <strong class="reserved">implements</strong> <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> <em class="brace">{</em>
<div class="comment">
          Creates a <code>DiscardPolicy</code>.</div>
<a id="L2059" name="L2059"></a>2059         <strong class="reserved">public</strong> DiscardPolicy() <em class="brace">{</em> <em class="brace">}</em>
<a id="L2060" name="L2060"></a>2060 
<div class="comment">
          Does nothing, which has the effect of discarding task r.
          @param r the runnable task requested to be executed
          @param e the executor attempting to execute this task</div>
<a id="L2067" name="L2067"></a>2067         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L823" title="Referred from 823 in src/java/util/concurrent/ThreadPoolExecutor.java.">rejectedExecution</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r, <a href="../S/1117.html#L319" title="Defined at 319 in src/java/util/concurrent/ThreadPoolExecutor.java.">ThreadPoolExecutor</a> e) <em class="brace">{</em>
<a id="L2068" name="L2068"></a>2068         <em class="brace">}</em>
<a id="L2069" name="L2069"></a>2069     <em class="brace">}</em>
<a id="L2070" name="L2070"></a>2070 
<div class="comment">
      A handler for rejected tasks that discards the oldest unhandled
      request and then retries <code>execute</code>, unless the executor
      is shut down, in which case the task is discarded.</div>
<a id="L2076" name="L2076"></a>2076     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> DiscardOldestPolicy <strong class="reserved">implements</strong> <a href="../S/1100.html#L44" title="Defined at 44 in src/java/util/concurrent/RejectedExecutionHandler.java.">RejectedExecutionHandler</a> <em class="brace">{</em>
<div class="comment">
          Creates a <code>DiscardOldestPolicy</code> for the given executor.</div>
<a id="L2080" name="L2080"></a>2080         <strong class="reserved">public</strong> DiscardOldestPolicy() <em class="brace">{</em> <em class="brace">}</em>
<a id="L2081" name="L2081"></a>2081 
<div class="comment">
          Obtains and ignores the next task that the executor
          would otherwise execute, if one is immediately available,
          and then retries execution of task r, unless the executor
          is shut down, in which case task r is instead discarded.
          @param r the runnable task requested to be executed
          @param e the executor attempting to execute this task</div>
<a id="L2091" name="L2091"></a>2091         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/1117.html#L823" title="Referred from 823 in src/java/util/concurrent/ThreadPoolExecutor.java.">rejectedExecution</a>(<a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a> r, <a href="../S/1117.html#L319" title="Defined at 319 in src/java/util/concurrent/ThreadPoolExecutor.java.">ThreadPoolExecutor</a> e) <em class="brace">{</em>
<a id="L2092" name="L2092"></a>2092             <strong class="reserved">if</strong> (!e.<a href="../D/26240.html" title="Multiple defined in 5 places.">isShutdown</a>()) <em class="brace">{</em>
<a id="L2093" name="L2093"></a>2093                 e.<a href="../D/21805.html" title="Multiple defined in 3 places.">getQueue</a>().<a href="../D/29402.html" title="Multiple defined in 36 places.">poll</a>();
<a id="L2094" name="L2094"></a>2094                 e.<a href="../D/15800.html" title="Multiple defined in 82 places.">execute</a>(r);
<a id="L2095" name="L2095"></a>2095             <em class="brace">}</em>
<a id="L2096" name="L2096"></a>2096         <em class="brace">}</em>
<a id="L2097" name="L2097"></a>2097     <em class="brace">}</em>
<a id="L2098" name="L2098"></a>2098 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L389">[^]</a><a href="#L2091">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>