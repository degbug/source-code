<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/lang/invoke/Invokers.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L60">[^]</a><a href="#L404">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L60" title="Defined at 60.">exactInvoker</a></li>
<li><a href="#L67" title="Defined at 67.">genericInvoker</a></li>
<li><a href="#L74" title="Defined at 74.">basicInvoker</a></li>
<li><a href="#L92" title="Defined at 92.">cachedInvoker</a></li>
<li><a href="#L96" title="Defined at 96.">setCachedInvoker</a></li>
<li><a href="#L103" title="Defined at 103.">makeExactOrGeneralInvoker</a></li>
<li><a href="#L117" title="Defined at 117.">maybeCompileToBytecode</a></li>
<li><a href="#L126" title="Defined at 126.">invokeBasicMethod</a></li>
<li><a href="#L136" title="Defined at 136.">checkInvoker</a></li>
<li><a href="#L153" title="Defined at 153.">spreadInvoker</a></li>
<li><a href="#L170" title="Defined at 170.">impliedRestargType</a></li>
<li><a href="#L183" title="Defined at 183.">toString</a></li>
<li><a href="#L187" title="Defined at 187.">methodHandleInvokeLinkerMethod</a></li>
<li><a href="#L218" title="Defined at 218.">invokeHandleForm</a></li>
<li><a href="#L296" title="Defined at 296.">newWrongMethodTypeException</a></li>
<li><a href="#L304" title="Defined at 304.">checkExactType</a></li>
<li><a href="#L318" title="Defined at 318.">checkGenericType</a></li>
<li><a href="#L341" title="Defined at 341.">linkToCallSiteMethod</a></li>
<li><a href="#L346" title="Defined at 346.">linkToTargetMethod</a></li>
<li><a href="#L352" title="Defined at 352.">callSiteForm</a></li>
<li><a href="#L389" title="Defined at 389.">getCallSiteTarget</a></li>
<li><a href="#L395" title="Defined at 395.">checkCustomized</a></li>
<li><a href="#L404" title="Defined at 404.">maybeCustomize</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2008, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../D/25050.html" title="Multiple defined in 52 places.">invoke</a>;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.lang.reflect.Array;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.util.Arrays;
<a id="L30" name="L30"></a>  30 
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandleStatics.*;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandleNatives.Constants.*;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> static java.lang.invoke.MethodHandles.Lookup.IMPL_LOOKUP;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> static java.lang.invoke.LambdaForm.*;
<a id="L35" name="L35"></a>  35 
<div class="comment">
  Construction and caching of often-used invokers.
  @author jrose</div>
<a id="L40" name="L40"></a>  40 <strong class="reserved">class</strong> <a href="../R/4029.html" title="Multiple referred from 13 places.">Invokers</a> <em class="brace">{</em>
<a id="L41" name="L41"></a>  41     <em class="comment">// exact type (sans leading taget MH) for the outgoing call</em>
<a id="L42" name="L42"></a>  42     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType;
<a id="L43" name="L43"></a>  43 
<a id="L44" name="L44"></a>  44     <em class="comment">// Cached adapter information:</em>
<a id="L45" name="L45"></a>  45     <strong class="reserved">private</strong> <strong class="reserved">final</strong> @<a href="../S/1628.html#L72" title="Defined at 72 in src/java/lang/invoke/Stable.java.">Stable</a> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[] <a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a> = <strong class="reserved">new</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>[INV_LIMIT];
<a id="L46" name="L46"></a>  46     <em class="comment">// Indexes into invokers:</em>
<a id="L47" name="L47"></a>  47     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong>
<a id="L48" name="L48"></a>  48             INV_EXACT          =  0,  <em class="comment">// MethodHandles.exactInvoker</em>
<a id="L49" name="L49"></a>  49             INV_GENERIC        =  1,  <em class="comment">// MethodHandles.invoker (generic invocation)</em>
<a id="L50" name="L50"></a>  50             INV_BASIC          =  2,  <em class="comment">// MethodHandles.basicInvoker</em>
<a id="L51" name="L51"></a>  51             INV_LIMIT          =  3;
<a id="L52" name="L52"></a>  52 
<div class="comment">
 Compute and cache information common to all collecting adapters
       that implement members of the erasure-family of the given erased type.</div>
<div class="comment">
     /*non-public*/</div> Invokers(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> targetType) <em class="brace">{</em>
<a id="L57" name="L57"></a>  57         <strong class="reserved">this</strong>.targetType = targetType;
<a id="L58" name="L58"></a>  58     <em class="brace">}</em>
<a id="L59" name="L59"></a>  59 
<div class="comment">
     /*non-public*/</div> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14062.html" title="Multiple referred from 3 places.">exactInvoker</a>() <em class="brace">{</em>
<a id="L61" name="L61"></a>  61         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../S/1599.html#L92" title="Defined at 92 in src/java/lang/invoke/Invokers.java.">cachedInvoker</a>(INV_EXACT);
<a id="L62" name="L62"></a>  62         <strong class="reserved">if</strong> (<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>;
<a id="L63" name="L63"></a>  63         <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../S/1599.html#L103" title="Defined at 103 in src/java/lang/invoke/Invokers.java.">makeExactOrGeneralInvoker</a>(<strong class="reserved">true</strong>);
<a id="L64" name="L64"></a>  64         <strong class="reserved">return</strong> <a href="../S/1599.html#L96" title="Defined at 96 in src/java/lang/invoke/Invokers.java.">setCachedInvoker</a>(INV_EXACT, <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>);
<a id="L65" name="L65"></a>  65     <em class="brace">}</em>
<a id="L66" name="L66"></a>  66 
<div class="comment">
     /*non-public*/</div> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/14870.html" title="Multiple referred from 2 places.">genericInvoker</a>() <em class="brace">{</em>
<a id="L68" name="L68"></a>  68         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../S/1599.html#L92" title="Defined at 92 in src/java/lang/invoke/Invokers.java.">cachedInvoker</a>(INV_GENERIC);
<a id="L69" name="L69"></a>  69         <strong class="reserved">if</strong> (<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>;
<a id="L70" name="L70"></a>  70         <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../S/1599.html#L103" title="Defined at 103 in src/java/lang/invoke/Invokers.java.">makeExactOrGeneralInvoker</a>(<strong class="reserved">false</strong>);
<a id="L71" name="L71"></a>  71         <strong class="reserved">return</strong> <a href="../S/1599.html#L96" title="Defined at 96 in src/java/lang/invoke/Invokers.java.">setCachedInvoker</a>(INV_GENERIC, <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>);
<a id="L72" name="L72"></a>  72     <em class="brace">}</em>
<a id="L73" name="L73"></a>  73 
<div class="comment">
     /*non-public*/</div> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/10542.html" title="Multiple referred from 6 places.">basicInvoker</a>() <em class="brace">{</em>
<a id="L75" name="L75"></a>  75         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../S/1599.html#L92" title="Defined at 92 in src/java/lang/invoke/Invokers.java.">cachedInvoker</a>(INV_BASIC);
<a id="L76" name="L76"></a>  76         <strong class="reserved">if</strong> (<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>;
<a id="L77" name="L77"></a>  77         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a> = targetType.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>();
<a id="L78" name="L78"></a>  78         <strong class="reserved">if</strong> (<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a> != targetType) <em class="brace">{</em>
<a id="L79" name="L79"></a>  79             <em class="comment">// double cache; not used significantly</em>
<a id="L80" name="L80"></a>  80             <strong class="reserved">return</strong> <a href="../S/1599.html#L96" title="Defined at 96 in src/java/lang/invoke/Invokers.java.">setCachedInvoker</a>(INV_BASIC, <a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>.<a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>().<a href="../D/11784.html" title="Multiple defined in 2 places.">basicInvoker</a>());
<a id="L81" name="L81"></a>  81         <em class="brace">}</em>
<a id="L82" name="L82"></a>  82         <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>().<a href="../S/1614.html#L108" title="Defined at 108 in src/java/lang/invoke/MethodTypeForm.java.">cachedMethodHandle</a>(<a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.MH_BASIC_INV);
<a id="L83" name="L83"></a>  83         <strong class="reserved">if</strong> (<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L84" name="L84"></a>  84             <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> method = <a href="../S/1599.html#L126" title="Defined at 126 in src/java/lang/invoke/Invokers.java.">invokeBasicMethod</a>(<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>);
<a id="L85" name="L85"></a>  85             <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../S/1620.html#L47" title="Defined at 47 in src/java/lang/invoke/DirectMethodHandle.java.">DirectMethodHandle</a>.<a href="../D/27195.html" title="Multiple defined in 13 places.">make</a>(method);
<a id="L86" name="L86"></a>  86             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1599.html#L136" title="Defined at 136 in src/java/lang/invoke/Invokers.java.">checkInvoker</a>(<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>));
<a id="L87" name="L87"></a>  87             <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>().<a href="../D/32076.html" title="Multiple defined in 2 places.">setCachedMethodHandle</a>(<a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.MH_BASIC_INV, <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>);
<a id="L88" name="L88"></a>  88         <em class="brace">}</em>
<a id="L89" name="L89"></a>  89         <strong class="reserved">return</strong> <a href="../S/1599.html#L96" title="Defined at 96 in src/java/lang/invoke/Invokers.java.">setCachedInvoker</a>(INV_BASIC, <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>);
<a id="L90" name="L90"></a>  90     <em class="brace">}</em>
<a id="L91" name="L91"></a>  91 
<a id="L92" name="L92"></a>  92     <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/10767.html" title="Multiple referred from 3 places.">cachedInvoker</a>(<strong class="reserved">int</strong> idx) <em class="brace">{</em>
<a id="L93" name="L93"></a>  93         <strong class="reserved">return</strong> <a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>[idx];
<a id="L94" name="L94"></a>  94     <em class="brace">}</em>
<a id="L95" name="L95"></a>  95 
<a id="L96" name="L96"></a>  96     <strong class="reserved">private</strong> <strong class="reserved">synchronized</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/26989.html" title="Multiple referred from 4 places.">setCachedInvoker</a>(<strong class="reserved">int</strong> idx, <strong class="reserved">final</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>) <em class="brace">{</em>
<a id="L97" name="L97"></a>  97         <em class="comment">// Simulate a CAS, to avoid racy duplication of results.</em>
<a id="L98" name="L98"></a>  98         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> prev = <a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>[idx];
<a id="L99" name="L99"></a>  99         <strong class="reserved">if</strong> (prev != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> prev;
<a id="L100" name="L100"></a> 100         <strong class="reserved">return</strong> <a href="../S/1616.html#L990" title="Defined at 990 in src/java/lang/invoke/MethodType.java.">invokers</a>[idx] = <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>;
<a id="L101" name="L101"></a> 101     <em class="brace">}</em>
<a id="L102" name="L102"></a> 102 
<a id="L103" name="L103"></a> 103     <strong class="reserved">private</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/22877.html" title="Multiple referred from 2 places.">makeExactOrGeneralInvoker</a>(<strong class="reserved">boolean</strong> isExact) <em class="brace">{</em>
<a id="L104" name="L104"></a> 104         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype = targetType;
<a id="L105" name="L105"></a> 105         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../S/1616.html#L630" title="Defined at 630 in src/java/lang/invoke/MethodType.java.">invokerType</a> = mtype.<a href="../S/1616.html#L630" title="Defined at 630 in src/java/lang/invoke/MethodType.java.">invokerType</a>();
<a id="L106" name="L106"></a> 106         <strong class="reserved">int</strong> <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a> = (isExact ? <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_EX_INVOKER : <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_GEN_INVOKER);
<a id="L107" name="L107"></a> 107         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../S/1599.html#L218" title="Defined at 218 in src/java/lang/invoke/Invokers.java.">invokeHandleForm</a>(mtype, <strong class="reserved">false</strong>, <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>);
<a id="L108" name="L108"></a> 108         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a>.<a href="../D/11855.html" title="Multiple defined in 2 places.">bindSingle</a>(<a href="../S/1616.html#L630" title="Defined at 630 in src/java/lang/invoke/MethodType.java.">invokerType</a>, lform, mtype);
<a id="L109" name="L109"></a> 109         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> whichName = (isExact ? "invokeExact" : "invoke");
<a id="L110" name="L110"></a> 110         <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a> = <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>.<a href="../S/1623.html#L1378" title="Defined at 1378 in src/java/lang/invoke/MethodHandle.java.">withInternalMemberName</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<a href="../D/27337.html" title="Multiple defined in 2 places.">makeMethodHandleInvoke</a>(whichName, mtype), <strong class="reserved">false</strong>);
<a id="L111" name="L111"></a> 111         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1599.html#L136" title="Defined at 136 in src/java/lang/invoke/Invokers.java.">checkInvoker</a>(<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>));
<a id="L112" name="L112"></a> 112         <a href="../S/1599.html#L117" title="Defined at 117 in src/java/lang/invoke/Invokers.java.">maybeCompileToBytecode</a>(<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>);
<a id="L113" name="L113"></a> 113         <strong class="reserved">return</strong> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>;
<a id="L114" name="L114"></a> 114     <em class="brace">}</em>
<a id="L115" name="L115"></a> 115 
<div class="comment">
     /** If the target type seems to be common enough, eagerly compile the invoker to bytecodes. */</div>
<a id="L117" name="L117"></a> 117     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/1599.html#L112" title="Referred from 112 in src/java/lang/invoke/Invokers.java.">maybeCompileToBytecode</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>) <em class="brace">{</em>
<a id="L118" name="L118"></a> 118         <strong class="reserved">final</strong> <strong class="reserved">int</strong> EAGER_COMPILE_ARITY_LIMIT = 10;
<a id="L119" name="L119"></a> 119         <strong class="reserved">if</strong> (targetType == targetType.<a href="../S/1616.html#L613" title="Defined at 613 in src/java/lang/invoke/MethodType.java.">erase</a>() &amp;&amp;
<a id="L120" name="L120"></a> 120             targetType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() &lt; EAGER_COMPILE_ARITY_LIMIT) <em class="brace">{</em>
<a id="L121" name="L121"></a> 121             <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>.<a href="../S/1626.html#L647" title="Defined at 647 in src/java/lang/invoke/LambdaForm.java.">compileToBytecode</a>();
<a id="L122" name="L122"></a> 122         <em class="brace">}</em>
<a id="L123" name="L123"></a> 123     <em class="brace">}</em>
<a id="L124" name="L124"></a> 124 
<a id="L125" name="L125"></a> 125     <em class="comment">// This next one is called from LambdaForm.NamedFunction.&lt;init&gt;.</em>
<div class="comment">
     /*non-public*/</div> <strong class="reserved">static</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../R/21058.html" title="Multiple referred from 2 places.">invokeBasicMethod</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> <a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>) <em class="brace">{</em>
<a id="L127" name="L127"></a> 127         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a> == <a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>());
<a id="L128" name="L128"></a> 128         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L129" name="L129"></a> 129             <em class="comment">//Lookup.findVirtual(MethodHandle.class, name, type);</em>
<a id="L130" name="L130"></a> 130             <strong class="reserved">return</strong> IMPL_LOOKUP.<a href="../D/31289.html" title="Multiple defined in 4 places.">resolveOrFail</a>(REF_invokeVirtual, <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong>, "invokeBasic", <a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>);
<a id="L131" name="L131"></a> 131         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L132" name="L132"></a> 132             <strong class="reserved">throw</strong> <a href="../D/28023.html" title="Multiple defined in 3 places.">newInternalError</a>("JVM cannot find invoker for "+<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>, <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>);
<a id="L133" name="L133"></a> 133         <em class="brace">}</em>
<a id="L134" name="L134"></a> 134     <em class="brace">}</em>
<a id="L135" name="L135"></a> 135 
<a id="L136" name="L136"></a> 136     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/11211.html" title="Multiple referred from 2 places.">checkInvoker</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>) <em class="brace">{</em>
<a id="L137" name="L137"></a> 137         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(targetType.<a href="../S/1616.html#L630" title="Defined at 630 in src/java/lang/invoke/MethodType.java.">invokerType</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>()))
<a id="L138" name="L138"></a> 138                 : <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util.<a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/11544.html" title="Multiple defined in 4 places.">asList</a>(targetType, targetType.<a href="../S/1616.html#L630" title="Defined at 630 in src/java/lang/invoke/MethodType.java.">invokerType</a>(), <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>);
<a id="L139" name="L139"></a> 139         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>.<a href="../D/24941.html" title="Multiple defined in 5 places.">internalMemberName</a>() == <strong class="reserved">null</strong> ||
<a id="L140" name="L140"></a> 140                <a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>.<a href="../D/24941.html" title="Multiple defined in 5 places.">internalMemberName</a>().<a href="../D/20598.html" title="Multiple defined in 3 places.">getMethodType</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(targetType));
<a id="L141" name="L141"></a> 141         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(!<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>.<a href="../D/26478.html" title="Multiple defined in 2 places.">isVarargsCollector</a>());
<a id="L142" name="L142"></a> 142         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L143" name="L143"></a> 143     <em class="brace">}</em>
<a id="L144" name="L144"></a> 144 
<div class="comment">
      Find or create an invoker which passes unchanged a given number of arguments
      and spreads the rest from a trailing array argument.
      The invoker target type is the post-spread type <code>(TYPEOF(uarg*), TYPEOF(sarg*))=&gt;RT</code>.
      All the <code>sarg</code>s must have a common type <code>C</code>.  (If there are none, <code>Object</code> is assumed.}
      @param leadingArgCount the number of unchanged (non-spread) arguments
      @return <code>invoker.invokeExact(mh, uarg*, C[]{sarg*</code>) := (RT)mh.invoke(uarg*, sarg*)}</div>
<div class="comment">
     /*non-public*/</div> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> <a href="../R/28767.html" title="Multiple referred from 3 places.">spreadInvoker</a>(<strong class="reserved">int</strong> leadingArgCount) <em class="brace">{</em>
<a id="L154" name="L154"></a> 154         <strong class="reserved">int</strong> spreadArgCount = targetType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>() - leadingArgCount;
<a id="L155" name="L155"></a> 155         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> postSpreadType = targetType;
<a id="L156" name="L156"></a> 156         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; argArrayType = <a href="../S/1599.html#L170" title="Defined at 170 in src/java/lang/invoke/Invokers.java.">impliedRestargType</a>(postSpreadType, leadingArgCount);
<a id="L157" name="L157"></a> 157         <strong class="reserved">if</strong> (postSpreadType.<a href="../D/29058.html" title="Multiple defined in 2 places.">parameterSlotCount</a>() &lt;= <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.MAX_MH_INVOKER_ARITY) <em class="brace">{</em>
<a id="L158" name="L158"></a> 158             <strong class="reserved">return</strong> <a href="../S/1599.html#L67" title="Defined at 67 in src/java/lang/invoke/Invokers.java.">genericInvoker</a>().<a href="../S/1623.html#L868" title="Defined at 868 in src/java/lang/invoke/MethodHandle.java.">asSpreader</a>(argArrayType, spreadArgCount);
<a id="L159" name="L159"></a> 159         <em class="brace">}</em>
<a id="L160" name="L160"></a> 160         <em class="comment">// Cannot build a generic invoker here of type ginvoker.invoke(mh, a*[254]).</em>
<a id="L161" name="L161"></a> 161         <em class="comment">// Instead, factor sinvoker.invoke(mh, a) into ainvoker.invoke(filter(mh), a)</em>
<a id="L162" name="L162"></a> 162         <em class="comment">// where filter(mh) == mh.asSpreader(Object[], spreadArgCount)</em>
<a id="L163" name="L163"></a> 163         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> preSpreadType = postSpreadType
<a id="L164" name="L164"></a> 164             .<a href="../S/1616.html#L457" title="Defined at 457 in src/java/lang/invoke/MethodType.java.">replaceParameterTypes</a>(leadingArgCount, postSpreadType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>(), argArrayType);
<a id="L165" name="L165"></a> 165         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> arrayInvoker = <a href="../S/1619.html#L60" title="Defined at 60 in src/java/lang/invoke/MethodHandles.java.">MethodHandles</a>.<a href="../D/25113.html" title="Multiple defined in 2 places.">invoker</a>(preSpreadType);
<a id="L166" name="L166"></a> 166         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> makeSpreader = <a href="../S/1619.html#L60" title="Defined at 60 in src/java/lang/invoke/MethodHandles.java.">MethodHandles</a>.<a href="../S/1619.html#L2363" title="Defined at 2363 in src/java/lang/invoke/MethodHandles.java.">insertArguments</a>(<a href="../D/4992.html" title="Multiple defined in 3 places.">Lazy</a>.MH_asSpreader, 1, argArrayType, spreadArgCount);
<a id="L167" name="L167"></a> 167         <strong class="reserved">return</strong> <a href="../S/1619.html#L60" title="Defined at 60 in src/java/lang/invoke/MethodHandles.java.">MethodHandles</a>.<a href="../S/1619.html#L2607" title="Defined at 2607 in src/java/lang/invoke/MethodHandles.java.">filterArgument</a>(arrayInvoker, 0, makeSpreader);
<a id="L168" name="L168"></a> 168     <em class="brace">}</em>
<a id="L169" name="L169"></a> 169 
<a id="L170" name="L170"></a> 170     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; <a href="../S/1599.html#L156" title="Referred from 156 in src/java/lang/invoke/Invokers.java.">impliedRestargType</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> restargType, <strong class="reserved">int</strong> fromPos) <em class="brace">{</em>
<a id="L171" name="L171"></a> 171         <strong class="reserved">if</strong> (restargType.<a href="../S/1616.html#L645" title="Defined at 645 in src/java/lang/invoke/MethodType.java.">isGeneric</a>())  <strong class="reserved">return</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[].<strong class="reserved">class</strong>;  <em class="comment">// can be nothing else</em>
<a id="L172" name="L172"></a> 172         <strong class="reserved">int</strong> maxPos = restargType.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L173" name="L173"></a> 173         <strong class="reserved">if</strong> (fromPos &gt;= maxPos)  <strong class="reserved">return</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[].<strong class="reserved">class</strong>;  <em class="comment">// reasonable default</em>
<a id="L174" name="L174"></a> 174         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; argType = restargType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(fromPos);
<a id="L175" name="L175"></a> 175         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = fromPos+1; i &lt; maxPos; i++) <em class="brace">{</em>
<a id="L176" name="L176"></a> 176             <strong class="reserved">if</strong> (argType != restargType.<a href="../D/29061.html" title="Multiple defined in 3 places.">parameterType</a>(i))
<a id="L177" name="L177"></a> 177                 <strong class="reserved">throw</strong> <a href="../D/28010.html" title="Multiple defined in 3 places.">newIllegalArgumentException</a>("need homogeneous rest arguments", restargType);
<a id="L178" name="L178"></a> 178         <em class="brace">}</em>
<a id="L179" name="L179"></a> 179         <strong class="reserved">if</strong> (argType == <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>)  <strong class="reserved">return</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[].<strong class="reserved">class</strong>;
<a id="L180" name="L180"></a> 180         <strong class="reserved">return</strong> <a href="../D/487.html" title="Multiple defined in 2 places.">Array</a>.<a href="../D/28016.html" title="Multiple defined in 74 places.">newInstance</a>(argType, 0).<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>();
<a id="L181" name="L181"></a> 181     <em class="brace">}</em>
<a id="L182" name="L182"></a> 182 
<a id="L183" name="L183"></a> 183     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L184" name="L184"></a> 184         <strong class="reserved">return</strong> "Invokers"+targetType;
<a id="L185" name="L185"></a> 185     <em class="brace">}</em>
<a id="L186" name="L186"></a> 186 
<a id="L187" name="L187"></a> 187     <strong class="reserved">static</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../S/1603.html#L431" title="Referred from 431 in src/java/lang/invoke/MethodHandleNatives.java.">methodHandleInvokeLinkerMethod</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>,
<a id="L188" name="L188"></a> 188                                                      <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype,
<a id="L189" name="L189"></a> 189                                                      <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] appendixResult) <em class="brace">{</em>
<a id="L190" name="L190"></a> 190         <strong class="reserved">int</strong> <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>;
<a id="L191" name="L191"></a> 191         <strong class="reserved">switch</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>) <em class="brace">{</em>
<a id="L192" name="L192"></a> 192         <strong class="reserved">case</strong> "invokeExact":  <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a> = <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_EX_LINKER; <strong class="reserved">break</strong>;
<a id="L193" name="L193"></a> 193         <strong class="reserved">case</strong> "invoke":       <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a> = <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_GEN_LINKER; <strong class="reserved">break</strong>;
<a id="L194" name="L194"></a> 194         <strong class="reserved">default</strong>:             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>("not invoker: "+<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L195" name="L195"></a> 195         <em class="brace">}</em>
<a id="L196" name="L196"></a> 196         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform;
<a id="L197" name="L197"></a> 197         <strong class="reserved">if</strong> (mtype.<a href="../D/29058.html" title="Multiple defined in 2 places.">parameterSlotCount</a>() &lt;= <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.MAX_MH_ARITY - MH_LINKER_ARG_APPENDED) <em class="brace">{</em>
<a id="L198" name="L198"></a> 198             lform = <a href="../S/1599.html#L218" title="Defined at 218 in src/java/lang/invoke/Invokers.java.">invokeHandleForm</a>(mtype, <strong class="reserved">false</strong>, <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>);
<a id="L199" name="L199"></a> 199             appendixResult[0] = mtype;
<a id="L200" name="L200"></a> 200         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L201" name="L201"></a> 201             lform = <a href="../S/1599.html#L218" title="Defined at 218 in src/java/lang/invoke/Invokers.java.">invokeHandleForm</a>(mtype, <strong class="reserved">true</strong>, <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>);
<a id="L202" name="L202"></a> 202         <em class="brace">}</em>
<a id="L203" name="L203"></a> 203         <strong class="reserved">return</strong> lform.vmentry;
<a id="L204" name="L204"></a> 204     <em class="brace">}</em>
<a id="L205" name="L205"></a> 205 
<a id="L206" name="L206"></a> 206     <em class="comment">// argument count to account for trailing "appendix value" (typically the mtype)</em>
<a id="L207" name="L207"></a> 207     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> MH_LINKER_ARG_APPENDED = 1;
<a id="L208" name="L208"></a> 208 
<div class="comment">
 Returns an adapter for invokeExact or generic invoke, as a MH or constant pool linker.
      If !customized, caller is responsible for supplying, during adapter execution,
      a copy of the exact mtype.  This is because the adapter might be generalized to
      a basic type.
      @param mtype the caller's method type (either basic or full-custom)
      @param customized whether to use a trailing appendix argument (to carry the mtype)
      @param which bit-encoded 0x01 whether it is a CP adapter ("linker") or MHs.invoker value ("invoker");
                               0x02 whether it is for invokeExact or generic invoke</div>
<a id="L218" name="L218"></a> 218     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> <a href="../R/21066.html" title="Multiple referred from 3 places.">invokeHandleForm</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype, <strong class="reserved">boolean</strong> customized, <strong class="reserved">int</strong> <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>) <em class="brace">{</em>
<a id="L219" name="L219"></a> 219         <strong class="reserved">boolean</strong> <a href="../D/25274.html" title="Multiple defined in 6 places.">isCached</a>;
<a id="L220" name="L220"></a> 220         <strong class="reserved">if</strong> (!customized) <em class="brace">{</em>
<a id="L221" name="L221"></a> 221             mtype = mtype.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>();  <em class="comment">// normalize Z to I, String to Object, etc.</em>
<a id="L222" name="L222"></a> 222             <a href="../D/25274.html" title="Multiple defined in 6 places.">isCached</a> = <strong class="reserved">true</strong>;
<a id="L223" name="L223"></a> 223         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L224" name="L224"></a> 224             <a href="../D/25274.html" title="Multiple defined in 6 places.">isCached</a> = <strong class="reserved">false</strong>;  <em class="comment">// maybe cache if mtype == mtype.basicType()</em>
<a id="L225" name="L225"></a> 225         <em class="brace">}</em>
<a id="L226" name="L226"></a> 226         <strong class="reserved">boolean</strong> isLinker, <a href="../S/1616.html#L645" title="Defined at 645 in src/java/lang/invoke/MethodType.java.">isGeneric</a>;
<a id="L227" name="L227"></a> 227         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> debugName;
<a id="L228" name="L228"></a> 228         <strong class="reserved">switch</strong> (<a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>) <em class="brace">{</em>
<a id="L229" name="L229"></a> 229         <strong class="reserved">case</strong> <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_EX_LINKER:   isLinker = <strong class="reserved">true</strong>;  <a href="../S/1616.html#L645" title="Defined at 645 in src/java/lang/invoke/MethodType.java.">isGeneric</a> = <strong class="reserved">false</strong>; debugName = "invokeExact_MT"; <strong class="reserved">break</strong>;
<a id="L230" name="L230"></a> 230         <strong class="reserved">case</strong> <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_EX_INVOKER:  isLinker = <strong class="reserved">false</strong>; <a href="../S/1616.html#L645" title="Defined at 645 in src/java/lang/invoke/MethodType.java.">isGeneric</a> = <strong class="reserved">false</strong>; debugName = "exactInvoker"; <strong class="reserved">break</strong>;
<a id="L231" name="L231"></a> 231         <strong class="reserved">case</strong> <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_GEN_LINKER:  isLinker = <strong class="reserved">true</strong>;  <a href="../S/1616.html#L645" title="Defined at 645 in src/java/lang/invoke/MethodType.java.">isGeneric</a> = <strong class="reserved">true</strong>;  debugName = "invoke_MT"; <strong class="reserved">break</strong>;
<a id="L232" name="L232"></a> 232         <strong class="reserved">case</strong> <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_GEN_INVOKER: isLinker = <strong class="reserved">false</strong>; <a href="../S/1616.html#L645" title="Defined at 645 in src/java/lang/invoke/MethodType.java.">isGeneric</a> = <strong class="reserved">true</strong>;  debugName = "invoker"; <strong class="reserved">break</strong>;
<a id="L233" name="L233"></a> 233         <strong class="reserved">default</strong>: <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>();
<a id="L234" name="L234"></a> 234         <em class="brace">}</em>
<a id="L235" name="L235"></a> 235         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform;
<a id="L236" name="L236"></a> 236         <strong class="reserved">if</strong> (<a href="../D/25274.html" title="Multiple defined in 6 places.">isCached</a>) <em class="brace">{</em>
<a id="L237" name="L237"></a> 237             lform = mtype.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>().<a href="../S/1614.html#L127" title="Defined at 127 in src/java/lang/invoke/MethodTypeForm.java.">cachedLambdaForm</a>(<a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>);
<a id="L238" name="L238"></a> 238             <strong class="reserved">if</strong> (lform != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> lform;
<a id="L239" name="L239"></a> 239         <em class="brace">}</em>
<a id="L240" name="L240"></a> 240         <em class="comment">// exactInvokerForm (Object,Object)Object</em>
<a id="L241" name="L241"></a> 241         <em class="comment">//   link with java.lang.invoke.MethodHandle.invokeBasic(MethodHandle,Object,Object)Object/invokeSpecial</em>
<a id="L242" name="L242"></a> 242         <strong class="reserved">final</strong> <strong class="reserved">int</strong> THIS_MH      = 0;
<a id="L243" name="L243"></a> 243         <strong class="reserved">final</strong> <strong class="reserved">int</strong> CALL_MH      = THIS_MH + (isLinker ? 0 : 1);
<a id="L244" name="L244"></a> 244         <strong class="reserved">final</strong> <strong class="reserved">int</strong> ARG_BASE     = CALL_MH + 1;
<a id="L245" name="L245"></a> 245         <strong class="reserved">final</strong> <strong class="reserved">int</strong> OUTARG_LIMIT = ARG_BASE + mtype.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L246" name="L246"></a> 246         <strong class="reserved">final</strong> <strong class="reserved">int</strong> INARG_LIMIT  = OUTARG_LIMIT + (isLinker &amp;&amp; !customized ? 1 : 0);
<a id="L247" name="L247"></a> 247         <strong class="reserved">int</strong> nameCursor = OUTARG_LIMIT;
<a id="L248" name="L248"></a> 248         <strong class="reserved">final</strong> <strong class="reserved">int</strong> MTYPE_ARG    = customized ? -1 : nameCursor++;  <em class="comment">// might be last in-argument</em>
<a id="L249" name="L249"></a> 249         <strong class="reserved">final</strong> <strong class="reserved">int</strong> CHECK_TYPE   = nameCursor++;
<a id="L250" name="L250"></a> 250         <strong class="reserved">final</strong> <strong class="reserved">int</strong> CHECK_CUSTOM = (CUSTOMIZE_THRESHOLD &gt;= 0) ? nameCursor++ : -1;
<a id="L251" name="L251"></a> 251         <strong class="reserved">final</strong> <strong class="reserved">int</strong> LINKER_CALL  = nameCursor++;
<a id="L252" name="L252"></a> 252         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> invokerFormType = mtype.<a href="../S/1616.html#L630" title="Defined at 630 in src/java/lang/invoke/MethodType.java.">invokerType</a>();
<a id="L253" name="L253"></a> 253         <strong class="reserved">if</strong> (isLinker) <em class="brace">{</em>
<a id="L254" name="L254"></a> 254             <strong class="reserved">if</strong> (!customized)
<a id="L255" name="L255"></a> 255                 invokerFormType = invokerFormType.<a href="../D/11404.html" title="Multiple defined in 2 places.">appendParameterTypes</a>(<a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a>.<strong class="reserved">class</strong>);
<a id="L256" name="L256"></a> 256         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L257" name="L257"></a> 257             invokerFormType = invokerFormType.<a href="../S/1616.html#L630" title="Defined at 630 in src/java/lang/invoke/MethodType.java.">invokerType</a>();
<a id="L258" name="L258"></a> 258         <em class="brace">}</em>
<a id="L259" name="L259"></a> 259         <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>[] names = <a href="../D/11487.html" title="Multiple defined in 15 places.">arguments</a>(nameCursor - INARG_LIMIT, invokerFormType);
<a id="L260" name="L260"></a> 260         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(names.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> == nameCursor)
<a id="L261" name="L261"></a> 261                 : <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/11544.html" title="Multiple defined in 4 places.">asList</a>(mtype, customized, <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>, nameCursor, names.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L262" name="L262"></a> 262         <strong class="reserved">if</strong> (MTYPE_ARG &gt;= INARG_LIMIT) <em class="brace">{</em>
<a id="L263" name="L263"></a> 263             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(names[MTYPE_ARG] == <strong class="reserved">null</strong>);
<a id="L264" name="L264"></a> 264             <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a>.<a href="../S/1606.html#L284" title="Defined at 284 in src/java/lang/invoke/BoundMethodHandle.java.">SpeciesData</a> <a href="../D/34705.html" title="Multiple defined in 4 places.">speciesData</a> = <a href="../S/1606.html#L53" title="Defined at 53 in src/java/lang/invoke/BoundMethodHandle.java.">BoundMethodHandle</a>.<a href="../S/1606.html#L839" title="Defined at 839 in src/java/lang/invoke/BoundMethodHandle.java.">speciesData_L</a>();
<a id="L265" name="L265"></a> 265             names[THIS_MH] = names[THIS_MH].<a href="../S/1626.html#L1445" title="Defined at 1445 in src/java/lang/invoke/LambdaForm.java.">withConstraint</a>(<a href="../D/34705.html" title="Multiple defined in 4 places.">speciesData</a>);
<a id="L266" name="L266"></a> 266             <a href="../S/1626.html#L1025" title="Defined at 1025 in src/java/lang/invoke/LambdaForm.java.">NamedFunction</a> getter = <a href="../D/34705.html" title="Multiple defined in 4 places.">speciesData</a>.<a href="../S/1606.html#L319" title="Defined at 319 in src/java/lang/invoke/BoundMethodHandle.java.">getterFunction</a>(0);
<a id="L267" name="L267"></a> 267             names[MTYPE_ARG] = <strong class="reserved">new</strong> <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>(getter, names[THIS_MH]);
<a id="L268" name="L268"></a> 268             <em class="comment">// else if isLinker, then MTYPE is passed in from the caller (e.g., the JVM)</em>
<a id="L269" name="L269"></a> 269         <em class="brace">}</em>
<a id="L270" name="L270"></a> 270 
<a id="L271" name="L271"></a> 271         <em class="comment">// Make the final call.  If isGeneric, then prepend the result of type checking.</em>
<a id="L272" name="L272"></a> 272         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> outCallType = mtype.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>();
<a id="L273" name="L273"></a> 273         <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] outArgs = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13513.html" title="Multiple defined in 10 places.">copyOfRange</a>(names, CALL_MH, OUTARG_LIMIT, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[].<strong class="reserved">class</strong>);
<a id="L274" name="L274"></a> 274         <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> mtypeArg = (customized ? mtype : names[MTYPE_ARG]);
<a id="L275" name="L275"></a> 275         <strong class="reserved">if</strong> (!<a href="../S/1616.html#L645" title="Defined at 645 in src/java/lang/invoke/MethodType.java.">isGeneric</a>) <em class="brace">{</em>
<a id="L276" name="L276"></a> 276             names[CHECK_TYPE] = <strong class="reserved">new</strong> <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>(NF_checkExactType, names[CALL_MH], mtypeArg);
<a id="L277" name="L277"></a> 277             <em class="comment">// mh.invokeExact(a*):R =&gt; checkExactType(mh, TYPEOF(a*:R)); mh.invokeBasic(a*)</em>
<a id="L278" name="L278"></a> 278         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L279" name="L279"></a> 279             names[CHECK_TYPE] = <strong class="reserved">new</strong> <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>(NF_checkGenericType, names[CALL_MH], mtypeArg);
<a id="L280" name="L280"></a> 280             <em class="comment">// mh.invokeGeneric(a*):R =&gt; checkGenericType(mh, TYPEOF(a*:R)).invokeBasic(a*)</em>
<a id="L281" name="L281"></a> 281             outArgs[0] = names[CHECK_TYPE];
<a id="L282" name="L282"></a> 282         <em class="brace">}</em>
<a id="L283" name="L283"></a> 283         <strong class="reserved">if</strong> (CHECK_CUSTOM != -1) <em class="brace">{</em>
<a id="L284" name="L284"></a> 284             names[CHECK_CUSTOM] = <strong class="reserved">new</strong> <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>(NF_checkCustomized, outArgs[0]);
<a id="L285" name="L285"></a> 285         <em class="brace">}</em>
<a id="L286" name="L286"></a> 286         names[LINKER_CALL] = <strong class="reserved">new</strong> <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>(outCallType, outArgs);
<a id="L287" name="L287"></a> 287         lform = <strong class="reserved">new</strong> <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a>(debugName, INARG_LIMIT, names);
<a id="L288" name="L288"></a> 288         <strong class="reserved">if</strong> (isLinker)
<a id="L289" name="L289"></a> 289             lform.<a href="../S/1626.html#L647" title="Defined at 647 in src/java/lang/invoke/LambdaForm.java.">compileToBytecode</a>();  <em class="comment">// JVM needs a real methodOop</em>
<a id="L290" name="L290"></a> 290         <strong class="reserved">if</strong> (<a href="../D/25274.html" title="Multiple defined in 6 places.">isCached</a>)
<a id="L291" name="L291"></a> 291             lform = mtype.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>().<a href="../S/1614.html#L133" title="Defined at 133 in src/java/lang/invoke/MethodTypeForm.java.">setCachedLambdaForm</a>(<a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>, lform);
<a id="L292" name="L292"></a> 292         <strong class="reserved">return</strong> lform;
<a id="L293" name="L293"></a> 293     <em class="brace">}</em>
<a id="L294" name="L294"></a> 294 
<div class="comment">
     /*non-public*/</div> <strong class="reserved">static</strong>
<a id="L296" name="L296"></a> 296     <a href="../S/1605.html#L43" title="Defined at 43 in src/java/lang/invoke/WrongMethodTypeException.java.">WrongMethodTypeException</a> <a href="../S/1599.html#L309" title="Referred from 309 in src/java/lang/invoke/Invokers.java.">newWrongMethodTypeException</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> actual, <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> expected) <em class="brace">{</em>
<a id="L297" name="L297"></a> 297         <em class="comment">// FIXME: merge with JVM logic for throwing WMTE</em>
<a id="L298" name="L298"></a> 298         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1605.html#L43" title="Defined at 43 in src/java/lang/invoke/WrongMethodTypeException.java.">WrongMethodTypeException</a>("expected "+expected+" but found "+actual);
<a id="L299" name="L299"></a> 299     <em class="brace">}</em>
<a id="L300" name="L300"></a> 300 
<div class="comment">
     /** Static definition of MethodHandle.invokeExact checking code. */</div>
<div class="comment">
     /*non-public*/</div> <strong class="reserved">static</strong>
<a id="L303" name="L303"></a> 303     @<a href="../S/1604.html#L36" title="Defined at 36 in src/java/lang/invoke/ForceInline.java.">ForceInline</a>
<a id="L304" name="L304"></a> 304     <strong class="reserved">void</strong> checkExactType(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> mhObj, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> expectedObj) <em class="brace">{</em>
<a id="L305" name="L305"></a> 305         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = (<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>) mhObj;
<a id="L306" name="L306"></a> 306         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> expected = (<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>) expectedObj;
<a id="L307" name="L307"></a> 307         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> actual = mh.<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>();
<a id="L308" name="L308"></a> 308         <strong class="reserved">if</strong> (actual != expected)
<a id="L309" name="L309"></a> 309             <strong class="reserved">throw</strong> <a href="../S/1599.html#L296" title="Defined at 296 in src/java/lang/invoke/Invokers.java.">newWrongMethodTypeException</a>(expected, actual);
<a id="L310" name="L310"></a> 310     <em class="brace">}</em>
<a id="L311" name="L311"></a> 311 
<div class="comment">
 Static definition of MethodHandle.invokeGeneric checking code.
      Directly returns the type-adjusted MH to invoke, as follows:
      <code>(R)MH.invoke(a*) =&gt; MH.asType(TYPEOF(a*:R)).invokeBasic(a*)</code></div>
<div class="comment">
     /*non-public*/</div> <strong class="reserved">static</strong>
<a id="L317" name="L317"></a> 317     @<a href="../S/1604.html#L36" title="Defined at 36 in src/java/lang/invoke/ForceInline.java.">ForceInline</a>
<a id="L318" name="L318"></a> 318     <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> checkGenericType(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> mhObj, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> expectedObj) <em class="brace">{</em>
<a id="L319" name="L319"></a> 319         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = (<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>) mhObj;
<a id="L320" name="L320"></a> 320         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> expected = (<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>) expectedObj;
<a id="L321" name="L321"></a> 321         <strong class="reserved">return</strong> mh.<a href="../D/11568.html" title="Multiple defined in 2 places.">asType</a>(expected);
<div class="comment">
 Maybe add more paths here.  Possible optimizations:
          for (R)MH.invoke(a*),
          let MT0 = TYPEOF(a*:R), MT1 = MH.type
          if MT0==MT1 or MT1 can be safely called by MT0
           =&gt; MH.invokeBasic(a*)
          if MT1 can be safely called by MT0[R := Object]
           =&gt; MH.invokeBasic(a*) &amp; checkcast(R)
          if MT1 can be safely called by MT0[* := Object]
           =&gt; checkcast(A)* &amp; MH.invokeBasic(a*) &amp; checkcast(R)
          if a big adapter BA can be pulled out of (MT0,MT1)
           =&gt; BA.invokeBasic(MT0,MH,a*)
          if a local adapter LA can cached on static CS0 = new GICS(MT0)
           =&gt; CS0.LA.invokeBasic(MH,a*)
          else
           =&gt; MH.asType(MT0).invokeBasic(A*)</div>
<a id="L339" name="L339"></a> 339     <em class="brace">}</em>
<a id="L340" name="L340"></a> 340 
<a id="L341" name="L341"></a> 341     <strong class="reserved">static</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../S/1603.html#L317" title="Referred from 317 in src/java/lang/invoke/MethodHandleNatives.java.">linkToCallSiteMethod</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype) <em class="brace">{</em>
<a id="L342" name="L342"></a> 342         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../S/1599.html#L352" title="Defined at 352 in src/java/lang/invoke/Invokers.java.">callSiteForm</a>(mtype, <strong class="reserved">false</strong>);
<a id="L343" name="L343"></a> 343         <strong class="reserved">return</strong> lform.vmentry;
<a id="L344" name="L344"></a> 344     <em class="brace">}</em>
<a id="L345" name="L345"></a> 345 
<a id="L346" name="L346"></a> 346     <strong class="reserved">static</strong> <a href="../S/1611.html#L72" title="Defined at 72 in src/java/lang/invoke/MemberName.java.">MemberName</a> <a href="../S/1603.html#L314" title="Referred from 314 in src/java/lang/invoke/MethodHandleNatives.java.">linkToTargetMethod</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype) <em class="brace">{</em>
<a id="L347" name="L347"></a> 347         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = <a href="../S/1599.html#L352" title="Defined at 352 in src/java/lang/invoke/Invokers.java.">callSiteForm</a>(mtype, <strong class="reserved">true</strong>);
<a id="L348" name="L348"></a> 348         <strong class="reserved">return</strong> lform.vmentry;
<a id="L349" name="L349"></a> 349     <em class="brace">}</em>
<a id="L350" name="L350"></a> 350 
<a id="L351" name="L351"></a> 351     <em class="comment">// skipCallSite is true if we are optimizing a ConstantCallSite</em>
<a id="L352" name="L352"></a> 352     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> <a href="../R/10857.html" title="Multiple referred from 2 places.">callSiteForm</a>(<a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> mtype, <strong class="reserved">boolean</strong> skipCallSite) <em class="brace">{</em>
<a id="L353" name="L353"></a> 353         mtype = mtype.<a href="../D/11785.html" title="Multiple defined in 6 places.">basicType</a>();  <em class="comment">// normalize Z to I, String to Object, etc.</em>
<a id="L354" name="L354"></a> 354         <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/36852.html" title="Multiple defined in 6 places.">which</a> = (skipCallSite ? <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_MH_LINKER : <a href="../S/1614.html#L45" title="Defined at 45 in src/java/lang/invoke/MethodTypeForm.java.">MethodTypeForm</a>.LF_CS_LINKER);
<a id="L355" name="L355"></a> 355         <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a> lform = mtype.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>().<a href="../S/1614.html#L127" title="Defined at 127 in src/java/lang/invoke/MethodTypeForm.java.">cachedLambdaForm</a>(<a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>);
<a id="L356" name="L356"></a> 356         <strong class="reserved">if</strong> (lform != <strong class="reserved">null</strong>)  <strong class="reserved">return</strong> lform;
<a id="L357" name="L357"></a> 357         <em class="comment">// exactInvokerForm (Object,Object)Object</em>
<a id="L358" name="L358"></a> 358         <em class="comment">//   link with java.lang.invoke.MethodHandle.invokeBasic(MethodHandle,Object,Object)Object/invokeSpecial</em>
<a id="L359" name="L359"></a> 359         <strong class="reserved">final</strong> <strong class="reserved">int</strong> ARG_BASE     = 0;
<a id="L360" name="L360"></a> 360         <strong class="reserved">final</strong> <strong class="reserved">int</strong> OUTARG_LIMIT = ARG_BASE + mtype.<a href="../D/29054.html" title="Multiple defined in 2 places.">parameterCount</a>();
<a id="L361" name="L361"></a> 361         <strong class="reserved">final</strong> <strong class="reserved">int</strong> INARG_LIMIT  = OUTARG_LIMIT + 1;
<a id="L362" name="L362"></a> 362         <strong class="reserved">int</strong> nameCursor = OUTARG_LIMIT;
<a id="L363" name="L363"></a> 363         <strong class="reserved">final</strong> <strong class="reserved">int</strong> APPENDIX_ARG = nameCursor++;  <em class="comment">// the last in-argument</em>
<a id="L364" name="L364"></a> 364         <strong class="reserved">final</strong> <strong class="reserved">int</strong> CSITE_ARG    = skipCallSite ? -1 : APPENDIX_ARG;
<a id="L365" name="L365"></a> 365         <strong class="reserved">final</strong> <strong class="reserved">int</strong> CALL_MH      = skipCallSite ? APPENDIX_ARG : nameCursor++;  <em class="comment">// result of getTarget</em>
<a id="L366" name="L366"></a> 366         <strong class="reserved">final</strong> <strong class="reserved">int</strong> LINKER_CALL  = nameCursor++;
<a id="L367" name="L367"></a> 367         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a> invokerFormType = mtype.<a href="../D/11404.html" title="Multiple defined in 2 places.">appendParameterTypes</a>(skipCallSite ? <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong> : <a href="../S/1601.html#L86" title="Defined at 86 in src/java/lang/invoke/CallSite.java.">CallSite</a>.<strong class="reserved">class</strong>);
<a id="L368" name="L368"></a> 368         <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>[] names = <a href="../D/11487.html" title="Multiple defined in 15 places.">arguments</a>(nameCursor - INARG_LIMIT, invokerFormType);
<a id="L369" name="L369"></a> 369         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(names.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> == nameCursor);
<a id="L370" name="L370"></a> 370         <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(names[APPENDIX_ARG] != <strong class="reserved">null</strong>);
<a id="L371" name="L371"></a> 371         <strong class="reserved">if</strong> (!skipCallSite)
<a id="L372" name="L372"></a> 372             names[CALL_MH] = <strong class="reserved">new</strong> <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>(NF_getCallSiteTarget, names[CSITE_ARG]);
<a id="L373" name="L373"></a> 373         <em class="comment">// (site.)invokedynamic(a*):R =&gt; mh = site.getTarget(); mh.invokeBasic(a*)</em>
<a id="L374" name="L374"></a> 374         <strong class="reserved">final</strong> <strong class="reserved">int</strong> PREPEND_MH = 0, PREPEND_COUNT = 1;
<a id="L375" name="L375"></a> 375         <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] outArgs = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13513.html" title="Multiple defined in 10 places.">copyOfRange</a>(names, ARG_BASE, OUTARG_LIMIT + PREPEND_COUNT, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[].<strong class="reserved">class</strong>);
<a id="L376" name="L376"></a> 376         <em class="comment">// prepend MH argument:</em>
<a id="L377" name="L377"></a> 377         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(outArgs, 0, outArgs, PREPEND_COUNT, outArgs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> - PREPEND_COUNT);
<a id="L378" name="L378"></a> 378         outArgs[PREPEND_MH] = names[CALL_MH];
<a id="L379" name="L379"></a> 379         names[LINKER_CALL] = <strong class="reserved">new</strong> <a href="../D/5923.html" title="Multiple defined in 5 places.">Name</a>(mtype, outArgs);
<a id="L380" name="L380"></a> 380         lform = <strong class="reserved">new</strong> <a href="../S/1626.html#L119" title="Defined at 119 in src/java/lang/invoke/LambdaForm.java.">LambdaForm</a>((skipCallSite ? "linkToTargetMethod" : "linkToCallSite"), INARG_LIMIT, names);
<a id="L381" name="L381"></a> 381         lform.<a href="../S/1626.html#L647" title="Defined at 647 in src/java/lang/invoke/LambdaForm.java.">compileToBytecode</a>();  <em class="comment">// JVM needs a real methodOop</em>
<a id="L382" name="L382"></a> 382         lform = mtype.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>().<a href="../S/1614.html#L133" title="Defined at 133 in src/java/lang/invoke/MethodTypeForm.java.">setCachedLambdaForm</a>(<a href="../D/36852.html" title="Multiple defined in 6 places.">which</a>, lform);
<a id="L383" name="L383"></a> 383         <strong class="reserved">return</strong> lform;
<a id="L384" name="L384"></a> 384     <em class="brace">}</em>
<a id="L385" name="L385"></a> 385 
<div class="comment">
     /** Static definition of MethodHandle.invokeGeneric checking code. */</div>
<div class="comment">
     /*non-public*/</div> <strong class="reserved">static</strong>
<a id="L388" name="L388"></a> 388     @<a href="../S/1604.html#L36" title="Defined at 36 in src/java/lang/invoke/ForceInline.java.">ForceInline</a>
<a id="L389" name="L389"></a> 389     <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> getCallSiteTarget(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> site) <em class="brace">{</em>
<a id="L390" name="L390"></a> 390         <strong class="reserved">return</strong> ((<a href="../S/1601.html#L86" title="Defined at 86 in src/java/lang/invoke/CallSite.java.">CallSite</a>)site).<a href="../D/22997.html" title="Multiple defined in 36 places.">getTarget</a>();
<a id="L391" name="L391"></a> 391     <em class="brace">}</em>
<a id="L392" name="L392"></a> 392 
<div class="comment">
     /*non-public*/</div> <strong class="reserved">static</strong>
<a id="L394" name="L394"></a> 394     @<a href="../S/1604.html#L36" title="Defined at 36 in src/java/lang/invoke/ForceInline.java.">ForceInline</a>
<a id="L395" name="L395"></a> 395     <strong class="reserved">void</strong> checkCustomized(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>) <em class="brace">{</em>
<a id="L396" name="L396"></a> 396         <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh = (<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>)<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>;
<a id="L397" name="L397"></a> 397         <strong class="reserved">if</strong> (mh.<a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>.customized == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L398" name="L398"></a> 398             <a href="../S/1599.html#L404" title="Defined at 404 in src/java/lang/invoke/Invokers.java.">maybeCustomize</a>(mh);
<a id="L399" name="L399"></a> 399         <em class="brace">}</em>
<a id="L400" name="L400"></a> 400     <em class="brace">}</em>
<a id="L401" name="L401"></a> 401 
<div class="comment">
     /*non-public*/</div> <strong class="reserved">static</strong>
<a id="L403" name="L403"></a> 403     @<a href="../S/1631.html#L36" title="Defined at 36 in src/java/lang/invoke/DontInline.java.">DontInline</a>
<a id="L404" name="L404"></a> 404     <strong class="reserved">void</strong> <a href="../S/1599.html#L398" title="Referred from 398 in src/java/lang/invoke/Invokers.java.">maybeCustomize</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> mh) <em class="brace">{</em>
<a id="L405" name="L405"></a> 405         <strong class="reserved">byte</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = mh.customizationCount;
<a id="L406" name="L406"></a> 406         <strong class="reserved">if</strong> (<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> &gt;= CUSTOMIZE_THRESHOLD) <em class="brace">{</em>
<a id="L407" name="L407"></a> 407             mh.<a href="../D/14447.html" title="Multiple defined in 6 places.">customize</a>();
<a id="L408" name="L408"></a> 408         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L409" name="L409"></a> 409             mh.customizationCount = (<strong class="reserved">byte</strong>)(<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>+1);
<a id="L410" name="L410"></a> 410         <em class="brace">}</em>
<a id="L411" name="L411"></a> 411     <em class="brace">}</em>
<a id="L412" name="L412"></a> 412 
<a id="L413" name="L413"></a> 413     <em class="comment">// Local constant functions:</em>
<a id="L414" name="L414"></a> 414     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1626.html#L1025" title="Defined at 1025 in src/java/lang/invoke/LambdaForm.java.">NamedFunction</a>
<a id="L415" name="L415"></a> 415         NF_checkExactType,
<a id="L416" name="L416"></a> 416         NF_checkGenericType,
<a id="L417" name="L417"></a> 417         NF_getCallSiteTarget,
<a id="L418" name="L418"></a> 418         NF_checkCustomized;
<a id="L419" name="L419"></a> 419     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L420" name="L420"></a> 420         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L421" name="L421"></a> 421             <a href="../S/1626.html#L1025" title="Defined at 1025 in src/java/lang/invoke/LambdaForm.java.">NamedFunction</a> nfs[] = <em class="brace">{</em>
<a id="L422" name="L422"></a> 422                 NF_checkExactType = <strong class="reserved">new</strong> <a href="../S/1626.html#L1025" title="Defined at 1025 in src/java/lang/invoke/LambdaForm.java.">NamedFunction</a>(<a href="../S/1599.html#L40" title="Defined at 40 in src/java/lang/invoke/Invokers.java.">Invokers</a>.<strong class="reserved">class</strong>
<a id="L423" name="L423"></a> 423                         .<a href="../D/18255.html" title="Multiple defined in 2 places.">getDeclaredMethod</a>("checkExactType", <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>)),
<a id="L424" name="L424"></a> 424                 NF_checkGenericType = <strong class="reserved">new</strong> <a href="../S/1626.html#L1025" title="Defined at 1025 in src/java/lang/invoke/LambdaForm.java.">NamedFunction</a>(<a href="../S/1599.html#L40" title="Defined at 40 in src/java/lang/invoke/Invokers.java.">Invokers</a>.<strong class="reserved">class</strong>
<a id="L425" name="L425"></a> 425                         .<a href="../D/18255.html" title="Multiple defined in 2 places.">getDeclaredMethod</a>("checkGenericType", <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>)),
<a id="L426" name="L426"></a> 426                 NF_getCallSiteTarget = <strong class="reserved">new</strong> <a href="../S/1626.html#L1025" title="Defined at 1025 in src/java/lang/invoke/LambdaForm.java.">NamedFunction</a>(<a href="../S/1599.html#L40" title="Defined at 40 in src/java/lang/invoke/Invokers.java.">Invokers</a>.<strong class="reserved">class</strong>
<a id="L427" name="L427"></a> 427                         .<a href="../D/18255.html" title="Multiple defined in 2 places.">getDeclaredMethod</a>("getCallSiteTarget", <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>)),
<a id="L428" name="L428"></a> 428                 NF_checkCustomized = <strong class="reserved">new</strong> <a href="../S/1626.html#L1025" title="Defined at 1025 in src/java/lang/invoke/LambdaForm.java.">NamedFunction</a>(<a href="../S/1599.html#L40" title="Defined at 40 in src/java/lang/invoke/Invokers.java.">Invokers</a>.<strong class="reserved">class</strong>
<a id="L429" name="L429"></a> 429                         .<a href="../D/18255.html" title="Multiple defined in 2 places.">getDeclaredMethod</a>("checkCustomized", <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>.<strong class="reserved">class</strong>))
<a id="L430" name="L430"></a> 430             <em class="brace">}</em>;
<a id="L431" name="L431"></a> 431             <strong class="reserved">for</strong> (<a href="../S/1626.html#L1025" title="Defined at 1025 in src/java/lang/invoke/LambdaForm.java.">NamedFunction</a> nf : nfs) <em class="brace">{</em>
<a id="L432" name="L432"></a> 432                 <em class="comment">// Each nf must be statically invocable or we get tied up in our bootstraps.</em>
<a id="L433" name="L433"></a> 433                 <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a>(<a href="../S/1627.html#L49" title="Defined at 49 in src/java/lang/invoke/InvokerBytecodeGenerator.java.">InvokerBytecodeGenerator</a>.<a href="../D/26282.html" title="Multiple defined in 2 places.">isStaticallyInvocable</a>(nf.<a href="../D/27605.html" title="Multiple defined in 5 places.">member</a>)) : nf;
<a id="L434" name="L434"></a> 434                 nf.<a href="../D/31237.html" title="Multiple defined in 38 places.">resolve</a>();
<a id="L435" name="L435"></a> 435             <em class="brace">}</em>
<a id="L436" name="L436"></a> 436         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L437" name="L437"></a> 437             <strong class="reserved">throw</strong> <a href="../D/28023.html" title="Multiple defined in 3 places.">newInternalError</a>(<a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>);
<a id="L438" name="L438"></a> 438         <em class="brace">}</em>
<a id="L439" name="L439"></a> 439     <em class="brace">}</em>
<a id="L440" name="L440"></a> 440 
<a id="L441" name="L441"></a> 441     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> <a href="../R/4537.html" title="Multiple referred from 37 places.">Lazy</a> <em class="brace">{</em>
<a id="L442" name="L442"></a> 442         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a> MH_asSpreader;
<a id="L443" name="L443"></a> 443 
<a id="L444" name="L444"></a> 444         <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L445" name="L445"></a> 445             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L446" name="L446"></a> 446                 MH_asSpreader = IMPL_LOOKUP.<a href="../S/1619.html#L852" title="Defined at 852 in src/java/lang/invoke/MethodHandles.java.">findVirtual</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong>, "asSpreader",
<a id="L447" name="L447"></a> 447                         <a href="../D/5628.html" title="Multiple defined in 4 places.">MethodType</a>.<a href="../D/27690.html" title="Multiple defined in 8 places.">methodType</a>(<a href="../S/1623.html#L421" title="Defined at 421 in src/java/lang/invoke/MethodHandle.java.">MethodHandle</a>.<strong class="reserved">class</strong>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>.<strong class="reserved">class</strong>, <strong class="reserved">int</strong>.<strong class="reserved">class</strong>));
<a id="L448" name="L448"></a> 448             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1731.html#L35" title="Defined at 35 in src/java/lang/ReflectiveOperationException.java.">ReflectiveOperationException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L449" name="L449"></a> 449                 <strong class="reserved">throw</strong> <a href="../D/28023.html" title="Multiple defined in 3 places.">newInternalError</a>(<a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>);
<a id="L450" name="L450"></a> 450             <em class="brace">}</em>
<a id="L451" name="L451"></a> 451         <em class="brace">}</em>
<a id="L452" name="L452"></a> 452     <em class="brace">}</em>
<a id="L453" name="L453"></a> 453 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L60">[^]</a><a href="#L404">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>