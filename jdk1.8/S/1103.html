<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/util/concurrent/ConcurrentLinkedQueue.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L192">[^]</a><a href="#L921">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L192" title="Defined at 192.">casItem</a></li>
<li><a href="#L196" title="Defined at 196.">lazySetNext</a></li>
<li><a href="#L200" title="Defined at 200.">casNext</a></li>
<li><a href="#L296" title="Defined at 296.">add</a></li>
<li><a href="#L304" title="Defined at 304.">updateHead</a></li>
<li><a href="#L314" title="Defined at 314.">succ</a></li>
<li><a href="#L326" title="Defined at 326.">offer</a></li>
<li><a href="#L356" title="Defined at 356.">poll</a></li>
<li><a href="#L381" title="Defined at 381.">peek</a></li>
<li><a href="#L406" title="Defined at 406.">first</a></li>
<li><a href="#L428" title="Defined at 428.">isEmpty</a></li>
<li><a href="#L448" title="Defined at 448.">size</a></li>
<li><a href="#L466" title="Defined at 466.">contains</a></li>
<li><a href="#L487" title="Defined at 487.">remove</a></li>
<li><a href="#L517" title="Defined at 517.">addAll</a></li>
<li><a href="#L581" title="Defined at 581.">toArray</a></li>
<li><a href="#L627" title="Defined at 627.">SuppressWarnings</a></li>
<li><a href="#L628" title="Defined at 628.">toArray</a></li>
<li><a href="#L662" title="Defined at 662.">iterator</a></li>
<li><a href="#L693" title="Defined at 693.">advance</a></li>
<li><a href="#L727" title="Defined at 727.">hasNext</a></li>
<li><a href="#L731" title="Defined at 731.">next</a></li>
<li><a href="#L736" title="Defined at 736.">remove</a></li>
<li><a href="#L753" title="Defined at 753.">writeObject</a></li>
<li><a href="#L777" title="Defined at 777.">readObject</a></li>
<li><a href="#L811" title="Defined at 811.">trySplit</a></li>
<li><a href="#L839" title="Defined at 839.">forEachRemaining</a></li>
<li><a href="#L856" title="Defined at 856.">tryAdvance</a></li>
<li><a href="#L878" title="Defined at 878.">estimateSize</a></li>
<li><a href="#L880" title="Defined at 880.">characteristics</a></li>
<li><a href="#L903" title="Defined at 903.">spliterator</a></li>
<li><a href="#L912" title="Defined at 912.">checkNotNull</a></li>
<li><a href="#L917" title="Defined at 917.">casTail</a></li>
<li><a href="#L921" title="Defined at 921.">casHead</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L24" name="L24"></a>  24 
<div class="comment">
  Written by Doug Lea and Martin Buchholz with assistance from members of
  JCP JSR-166 Expert Group and released to the public domain, as explained
  at http://creativecommons.org/publicdomain/zero/1.0/</div>
<a id="L35" name="L35"></a>  35 
<a id="L36" name="L36"></a>  36 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util.concurrent;
<a id="L37" name="L37"></a>  37 
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> java.util.AbstractQueue;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> java.util.ArrayList;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.util.Collection;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> java.util.Iterator;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> java.util.NoSuchElementException;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> java.util.Queue;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> java.util.Spliterator;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> java.util.Spliterators;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> java.util.function.Consumer;
<a id="L47" name="L47"></a>  47 
<div class="comment">
  An unbounded thread-safe {@linkplain Queue queue} based on linked nodes.
  This queue orders elements FIFO (first-in-first-out).
  The <em>head</em> of the queue is that element that has been on the
  queue the longest time.
  The <em>tail</em> of the queue is that element that has been on the
  queue the shortest time. New elements
  are inserted at the tail of the queue, and the queue retrieval
  operations obtain elements at the head of the queue.
  A <code>ConcurrentLinkedQueue</code> is an appropriate choice when
  many threads will share access to a common collection.
  Like most other concurrent collection implementations, this class
  does not permit the use of <code>null</code> elements.
  <p>This implementation employs an efficient <em>non-blocking</em>
  algorithm based on one described in <a href="http://www.cs.rochester.edu/u/michael/PODC96.html"> Simple,
  Fast, and Practical Non-Blocking and Blocking Concurrent Queue
  Algorithms</a> by Maged M. Michael and Michael L. Scott.
  </p><p>Iterators are <i>weakly consistent</i>, returning elements
  reflecting the state of the queue at some point at or since the
  creation of the iterator.  They do <em>not</em> throw {@link
  java.util.ConcurrentModificationException}, and may proceed concurrently
  with other operations.  Elements contained in the queue since the creation
  of the iterator will be returned exactly once.
  </p><p>Beware that, unlike in most collections, the <code>size</code> method
  is <em>NOT</em> a constant-time operation. Because of the
  asynchronous nature of these queues, determining the current number
  of elements requires a traversal of the elements, and so may report
  inaccurate results if this collection is modified during traversal.
  Additionally, the bulk operations <code>addAll</code>,
  <code>removeAll</code>, <code>retainAll</code>, <code>containsAll</code>,
  <code>equals</code>, and <code>toArray</code> are <em>not</em> guaranteed
  to be performed atomically. For example, an iterator operating
  concurrently with an <code>addAll</code> operation might view only some
  of the added elements.
  </p><p>This class and its iterator implement all of the <em>optional</em>
  methods of the <a href="../D/6991.html" title="Multiple defined in 3 places.">Queue</a> and <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a> interfaces.
  </p><p>Memory consistency effects: As with other concurrent
  collections, actions in a thread prior to placing an object into a
  <code>ConcurrentLinkedQueue</code>
  <a href="package-summary.html#MemoryVisibility"><i>happen-before</i></a>
  actions subsequent to the access or removal of that element from
  the <code>ConcurrentLinkedQueue</code> in another thread.
  </p><p>This class is a member of the
  <a href="{@docRoot}/../technotes/guides/collections/index.html">
  Java Collections Framework</a>.
  @since 1.5
  @author Doug Lea
  @param <e> the type of elements held in this collection</e></p></div>
<a id="L105" name="L105"></a> 105 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/1630.html" title="Multiple referred from 8 places.">ConcurrentLinkedQueue</a>&lt;E&gt; <strong class="reserved">extends</strong> <a href="../S/994.html#L64" title="Defined at 64 in src/java/util/AbstractQueue.java.">AbstractQueue</a>&lt;E&gt;
<a id="L106" name="L106"></a> 106         <strong class="reserved">implements</strong> <a href="../D/6991.html" title="Multiple defined in 3 places.">Queue</a>&lt;E&gt;, <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1407.html#L169" title="Defined at 169 in src/java/io/Serializable.java.">Serializable</a> <em class="brace">{</em>
<a id="L107" name="L107"></a> 107     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = 196745693267521676L;
<a id="L108" name="L108"></a> 108 
<div class="comment">
      This is a modification of the Michael &amp; Scott algorithm,
      adapted for a garbage-collected environment, with support for
      interior node deletion (to support remove(Object)).  For
      explanation, read the paper.
      Note that like most non-blocking algorithms in this package,
      this implementation relies on the fact that in garbage
      collected systems, there is no possibility of ABA problems due
      to recycled nodes, so there is no need to use "counted
      pointers" or related techniques seen in versions used in
      non-GC'ed settings.
      The fundamental invariants are:
      - There is exactly one (last) Node with a null next reference,
        which is CASed when enqueueing.  This last Node can be
        reached in O(1) time from tail, but tail is merely an
        optimization - it can always be reached in O(N) time from
        head as well.
      - The elements contained in the queue are the non-null items in
        Nodes that are reachable from head.  CASing the item
        reference of a Node to null atomically removes it from the
        queue.  Reachability of all elements from head must remain
        true even in the case of concurrent modifications that cause
        head to advance.  A dequeued Node may remain in use
        indefinitely due to creation of an Iterator or simply a
        poll() that has lost its time slice.
      The above might appear to imply that all Nodes are GC-reachable
      from a predecessor dequeued Node.  That would cause two problems:
      - allow a rogue Iterator to cause unbounded memory retention
      - cause cross-generational linking of old Nodes to new Nodes if
        a Node was tenured while live, which generational GCs have a
        hard time dealing with, causing repeated major collections.
      However, only non-deleted Nodes need to be reachable from
      dequeued Nodes, and reachability does not necessarily have to
      be of the kind understood by the GC.  We use the trick of
      linking a Node that has just been dequeued to itself.  Such a
      self-link implicitly means to advance to head.
      Both head and tail are permitted to lag.  In fact, failing to
      update them every time one could is a significant optimization
      (fewer CASes). As with LinkedTransferQueue (see the internal
      documentation for that class), we use a slack threshold of two;
      that is, we update head/tail when the current pointer appears
      to be two or more steps away from the first/last node.
      Since head and tail are updated concurrently and independently,
      it is possible for tail to lag behind head (why not)?
      CASing a Node's item reference to null atomically removes the
      element from the queue.  Iterators skip over Nodes with null
      items.  Prior implementations of this class had a race between
      poll() and remove(Object) where the same element would appear
      to be successfully removed by two concurrent operations.  The
      method remove(Object) also lazily unlinks deleted Nodes, but
      this is merely an optimization.
      When constructing a Node (before enqueuing it) we avoid paying
      for a volatile write to item by using Unsafe.putObject instead
      of a normal write.  This allows the cost of enqueue to be
      "one-and-a-half" CASes.
      Both head and tail may or may not point to a Node with a
      non-null item.  If the queue is empty, all items must of course
      be null.  Upon creation, both head and tail refer to a dummy
      Node with null item.  Both head and tail are only updated using
      CAS, so they never regress, although again this is merely an
      optimization.</div>
<a id="L179" name="L179"></a> 179 
<a id="L180" name="L180"></a> 180     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> <a href="../R/5542.html" title="Multiple referred from 4060 places.">Node</a>&lt;E&gt; <em class="brace">{</em>
<a id="L181" name="L181"></a> 181         <strong class="reserved">volatile</strong> E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L182" name="L182"></a> 182         <strong class="reserved">volatile</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L183" name="L183"></a> 183 
<div class="comment">
          Constructs a new node.  Uses relaxed write because item can
          only be seen after publication via casNext.</div>
<a id="L188" name="L188"></a> 188         Node(E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>) <em class="brace">{</em>
<a id="L189" name="L189"></a> 189             UNSAFE.putObject(<strong class="reserved">this</strong>, itemOffset, <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L190" name="L190"></a> 190         <em class="brace">}</em>
<a id="L191" name="L191"></a> 191 
<a id="L192" name="L192"></a> 192         <strong class="reserved">boolean</strong> <a href="../R/10984.html" title="Multiple referred from 10 places.">casItem</a>(E cmp, E <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L193" name="L193"></a> 193             <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, itemOffset, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L194" name="L194"></a> 194         <em class="brace">}</em>
<a id="L195" name="L195"></a> 195 
<a id="L196" name="L196"></a> 196         <strong class="reserved">void</strong> <a href="../R/22451.html" title="Multiple referred from 18 places.">lazySetNext</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L197" name="L197"></a> 197             UNSAFE.putOrderedObject(<strong class="reserved">this</strong>, <a href="../D/28171.html" title="Multiple defined in 2 places.">nextOffset</a>, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L198" name="L198"></a> 198         <em class="brace">}</em>
<a id="L199" name="L199"></a> 199 
<a id="L200" name="L200"></a> 200         <strong class="reserved">boolean</strong> <a href="../R/10985.html" title="Multiple referred from 26 places.">casNext</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; cmp, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L201" name="L201"></a> 201             <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, <a href="../D/28171.html" title="Multiple defined in 2 places.">nextOffset</a>, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L202" name="L202"></a> 202         <em class="brace">}</em>
<a id="L203" name="L203"></a> 203 
<a id="L204" name="L204"></a> 204         <em class="comment">// Unsafe mechanics</em>
<a id="L205" name="L205"></a> 205 
<a id="L206" name="L206"></a> 206         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> sun.misc.Unsafe UNSAFE;
<a id="L207" name="L207"></a> 207         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> itemOffset;
<a id="L208" name="L208"></a> 208         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> <a href="../D/28171.html" title="Multiple defined in 2 places.">nextOffset</a>;
<a id="L209" name="L209"></a> 209 
<a id="L210" name="L210"></a> 210         <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L211" name="L211"></a> 211             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L212" name="L212"></a> 212                 UNSAFE = sun.misc.Unsafe.getUnsafe();
<a id="L213" name="L213"></a> 213                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; k = <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.<strong class="reserved">class</strong>;
<a id="L214" name="L214"></a> 214                 itemOffset = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L215" name="L215"></a> 215                     (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("item"));
<a id="L216" name="L216"></a> 216                 <a href="../D/28171.html" title="Multiple defined in 2 places.">nextOffset</a> = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L217" name="L217"></a> 217                     (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("next"));
<a id="L218" name="L218"></a> 218             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L219" name="L219"></a> 219                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>(e);
<a id="L220" name="L220"></a> 220             <em class="brace">}</em>
<a id="L221" name="L221"></a> 221         <em class="brace">}</em>
<a id="L222" name="L222"></a> 222     <em class="brace">}</em>
<a id="L223" name="L223"></a> 223 
<div class="comment">
      A node from which the first live (non-deleted) node (if any)
      can be reached in O(1) time.
      Invariants:
      - all live nodes are reachable from head via succ()
      - head != null
      - (tmp = head).next != tmp || tmp != head
      Non-invariants:
      - head.item may or may not be null.
      - it is permitted for tail to lag behind head, that is, for tail
        to not be reachable from head!</div>
<a id="L236" name="L236"></a> 236     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <strong class="reserved">volatile</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; head;
<a id="L237" name="L237"></a> 237 
<div class="comment">
      A node from which the last node on list (that is, the unique
      node with node.next == null) can be reached in O(1) time.
      Invariants:
      - the last node is always reachable from tail via succ()
      - tail != null
      Non-invariants:
      - tail.item may or may not be null.
      - it is permitted for tail to lag behind head, that is, for tail
        to not be reachable from head!
      - tail.next may or may not be self-pointing to tail.</div>
<a id="L250" name="L250"></a> 250     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <strong class="reserved">volatile</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; tail;
<a id="L251" name="L251"></a> 251 
<div class="comment">
      Creates a <code>ConcurrentLinkedQueue</code> that is initially empty.</div>
<a id="L255" name="L255"></a> 255     <strong class="reserved">public</strong> ConcurrentLinkedQueue() <em class="brace">{</em>
<a id="L256" name="L256"></a> 256         head = tail = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(<strong class="reserved">null</strong>);
<a id="L257" name="L257"></a> 257     <em class="brace">}</em>
<a id="L258" name="L258"></a> 258 
<div class="comment">
      Creates a <code>ConcurrentLinkedQueue</code>
      initially containing the elements of the given collection,
      added in traversal order of the collection's iterator.
      @param c the collection of elements to initially contain
      @throws NullPointerException if the specified collection or any
              of its elements are null</div>
<a id="L268" name="L268"></a> 268     <strong class="reserved">public</strong> ConcurrentLinkedQueue(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;? <strong class="reserved">extends</strong> E&gt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L269" name="L269"></a> 269         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = <strong class="reserved">null</strong>, t = <strong class="reserved">null</strong>;
<a id="L270" name="L270"></a> 270         <strong class="reserved">for</strong> (E e : <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L271" name="L271"></a> 271             <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(e);
<a id="L272" name="L272"></a> 272             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(e);
<a id="L273" name="L273"></a> 273             <strong class="reserved">if</strong> (h == <strong class="reserved">null</strong>)
<a id="L274" name="L274"></a> 274                 h = t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L275" name="L275"></a> 275             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L276" name="L276"></a> 276                 t.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);
<a id="L277" name="L277"></a> 277                 t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L278" name="L278"></a> 278             <em class="brace">}</em>
<a id="L279" name="L279"></a> 279         <em class="brace">}</em>
<a id="L280" name="L280"></a> 280         <strong class="reserved">if</strong> (h == <strong class="reserved">null</strong>)
<a id="L281" name="L281"></a> 281             h = t = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(<strong class="reserved">null</strong>);
<a id="L282" name="L282"></a> 282         head = h;
<a id="L283" name="L283"></a> 283         tail = t;
<a id="L284" name="L284"></a> 284     <em class="brace">}</em>
<a id="L285" name="L285"></a> 285 
<a id="L286" name="L286"></a> 286     <em class="comment">// Have to override just to update the javadoc</em>
<a id="L287" name="L287"></a> 287 
<div class="comment">
      Inserts the specified element at the tail of this queue.
      As the queue is unbounded, this method will never throw
      <a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a> or return <code>false</code>.
      @return <code>true</code> (as specified by {@link Collection#add})
      @throws NullPointerException if the specified element is null</div>
<a id="L296" name="L296"></a> 296     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/9592.html" title="Multiple referred from 2612 places.">add</a>(E e) <em class="brace">{</em>
<a id="L297" name="L297"></a> 297         <strong class="reserved">return</strong> <a href="../D/28469.html" title="Multiple defined in 29 places.">offer</a>(e);
<a id="L298" name="L298"></a> 298     <em class="brace">}</em>
<a id="L299" name="L299"></a> 299 
<div class="comment">
      Tries to CAS head to p. If successful, repoint old head to itself
      as sentinel for succ(), below.</div>
<a id="L304" name="L304"></a> 304     <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/29877.html" title="Multiple referred from 7 places.">updateHead</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p) <em class="brace">{</em>
<a id="L305" name="L305"></a> 305         <strong class="reserved">if</strong> (h != p &amp;&amp; <a href="../D/12261.html" title="Multiple defined in 5 places.">casHead</a>(h, p))
<a id="L306" name="L306"></a> 306             h.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(h);
<a id="L307" name="L307"></a> 307     <em class="brace">}</em>
<a id="L308" name="L308"></a> 308 
<div class="comment">
      Returns the successor of p, or the head node if p.next has been
      linked to self, which will only be true if traversing with a
      stale pointer that is now off the list.</div>
<a id="L314" name="L314"></a> 314     <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/29027.html" title="Multiple referred from 54 places.">succ</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p) <em class="brace">{</em>
<a id="L315" name="L315"></a> 315         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L316" name="L316"></a> 316         <strong class="reserved">return</strong> (p == <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) ? head : <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L317" name="L317"></a> 317     <em class="brace">}</em>
<a id="L318" name="L318"></a> 318 
<div class="comment">
      Inserts the specified element at the tail of this queue.
      As the queue is unbounded, this method will never return <code>false</code>.
      @return <code>true</code> (as specified by {@link Queue#offer})
      @throws NullPointerException if the specified element is null</div>
<a id="L326" name="L326"></a> 326     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/23932.html" title="Multiple referred from 17 places.">offer</a>(E e) <em class="brace">{</em>
<a id="L327" name="L327"></a> 327         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(e);
<a id="L328" name="L328"></a> 328         <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(e);
<a id="L329" name="L329"></a> 329 
<a id="L330" name="L330"></a> 330         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; t = tail, p = t;;) <em class="brace">{</em>
<a id="L331" name="L331"></a> 331             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L332" name="L332"></a> 332             <strong class="reserved">if</strong> (q == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L333" name="L333"></a> 333                 <em class="comment">// p is last node</em>
<a id="L334" name="L334"></a> 334                 <strong class="reserved">if</strong> (p.<a href="../D/12263.html" title="Multiple defined in 6 places.">casNext</a>(<strong class="reserved">null</strong>, <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>)) <em class="brace">{</em>
<a id="L335" name="L335"></a> 335                     <em class="comment">// Successful CAS is the linearization point</em>
<a id="L336" name="L336"></a> 336                     <em class="comment">// for e to become an element of this queue,</em>
<a id="L337" name="L337"></a> 337                     <em class="comment">// and for newNode to become "live".</em>
<a id="L338" name="L338"></a> 338                     <strong class="reserved">if</strong> (p != t) <em class="comment">// hop two nodes at a time</em>
<a id="L339" name="L339"></a> 339                         <a href="../D/12271.html" title="Multiple defined in 3 places.">casTail</a>(t, <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);  <em class="comment">// Failure is OK.</em>
<a id="L340" name="L340"></a> 340                     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L341" name="L341"></a> 341                 <em class="brace">}</em>
<a id="L342" name="L342"></a> 342                 <em class="comment">// Lost CAS race to another thread; re-read next</em>
<a id="L343" name="L343"></a> 343             <em class="brace">}</em>
<a id="L344" name="L344"></a> 344             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L345" name="L345"></a> 345                 <em class="comment">// We have fallen off list.  If tail is unchanged, it</em>
<a id="L346" name="L346"></a> 346                 <em class="comment">// will also be off-list, in which case we need to</em>
<a id="L347" name="L347"></a> 347                 <em class="comment">// jump to head, from which all live nodes are always</em>
<a id="L348" name="L348"></a> 348                 <em class="comment">// reachable.  Else the new tail is a better bet.</em>
<a id="L349" name="L349"></a> 349                 p = (t != (t = tail)) ? t : head;
<a id="L350" name="L350"></a> 350             <strong class="reserved">else</strong>
<a id="L351" name="L351"></a> 351                 <em class="comment">// Check for tail updates after two hops.</em>
<a id="L352" name="L352"></a> 352                 p = (p != t &amp;&amp; t != (t = tail)) ? t : q;
<a id="L353" name="L353"></a> 353         <em class="brace">}</em>
<a id="L354" name="L354"></a> 354     <em class="brace">}</em>
<a id="L355" name="L355"></a> 355 
<a id="L356" name="L356"></a> 356     <strong class="reserved">public</strong> E <a href="../R/24795.html" title="Multiple referred from 51 places.">poll</a>() <em class="brace">{</em>
<a id="L357" name="L357"></a> 357         restartFromHead:
<a id="L358" name="L358"></a> 358         <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L359" name="L359"></a> 359             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = head, p = h, q;;) <em class="brace">{</em>
<a id="L360" name="L360"></a> 360                 E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L361" name="L361"></a> 361 
<a id="L362" name="L362"></a> 362                 <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> &amp;&amp; p.<a href="../D/12262.html" title="Multiple defined in 4 places.">casItem</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>, <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L363" name="L363"></a> 363                     <em class="comment">// Successful CAS is the linearization point</em>
<a id="L364" name="L364"></a> 364                     <em class="comment">// for item to be removed from this queue.</em>
<a id="L365" name="L365"></a> 365                     <strong class="reserved">if</strong> (p != h) <em class="comment">// hop two nodes at a time</em>
<a id="L366" name="L366"></a> 366                         <a href="../D/36118.html" title="Multiple defined in 2 places.">updateHead</a>(h, ((q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) != <strong class="reserved">null</strong>) ? q : p);
<a id="L367" name="L367"></a> 367                     <strong class="reserved">return</strong> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L368" name="L368"></a> 368                 <em class="brace">}</em>
<a id="L369" name="L369"></a> 369                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L370" name="L370"></a> 370                     <a href="../D/36118.html" title="Multiple defined in 2 places.">updateHead</a>(h, p);
<a id="L371" name="L371"></a> 371                     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L372" name="L372"></a> 372                 <em class="brace">}</em>
<a id="L373" name="L373"></a> 373                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L374" name="L374"></a> 374                     <strong class="reserved">continue</strong> restartFromHead;
<a id="L375" name="L375"></a> 375                 <strong class="reserved">else</strong>
<a id="L376" name="L376"></a> 376                     p = q;
<a id="L377" name="L377"></a> 377             <em class="brace">}</em>
<a id="L378" name="L378"></a> 378         <em class="brace">}</em>
<a id="L379" name="L379"></a> 379     <em class="brace">}</em>
<a id="L380" name="L380"></a> 380 
<a id="L381" name="L381"></a> 381     <strong class="reserved">public</strong> E <a href="../R/24689.html" title="Multiple referred from 168 places.">peek</a>() <em class="brace">{</em>
<a id="L382" name="L382"></a> 382         restartFromHead:
<a id="L383" name="L383"></a> 383         <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L384" name="L384"></a> 384             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = head, p = h, q;;) <em class="brace">{</em>
<a id="L385" name="L385"></a> 385                 E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L386" name="L386"></a> 386                 <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> || (q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L387" name="L387"></a> 387                     <a href="../D/36118.html" title="Multiple defined in 2 places.">updateHead</a>(h, p);
<a id="L388" name="L388"></a> 388                     <strong class="reserved">return</strong> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L389" name="L389"></a> 389                 <em class="brace">}</em>
<a id="L390" name="L390"></a> 390                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L391" name="L391"></a> 391                     <strong class="reserved">continue</strong> restartFromHead;
<a id="L392" name="L392"></a> 392                 <strong class="reserved">else</strong>
<a id="L393" name="L393"></a> 393                     p = q;
<a id="L394" name="L394"></a> 394             <em class="brace">}</em>
<a id="L395" name="L395"></a> 395         <em class="brace">}</em>
<a id="L396" name="L396"></a> 396     <em class="brace">}</em>
<a id="L397" name="L397"></a> 397 
<div class="comment">
      Returns the first live (non-deleted) node on list, or null if none.
      This is yet another variant of poll/peek; here returning the
      first node, not element.  We could make peek() a wrapper around
      first(), but that would cost an extra volatile read of item,
      and the need to add a retry loop to deal with the possibility
      of losing a race to a concurrent poll().</div>
<a id="L406" name="L406"></a> 406     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/14628.html" title="Multiple referred from 688 places.">first</a>() <em class="brace">{</em>
<a id="L407" name="L407"></a> 407         restartFromHead:
<a id="L408" name="L408"></a> 408         <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L409" name="L409"></a> 409             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = head, p = h, q;;) <em class="brace">{</em>
<a id="L410" name="L410"></a> 410                 <strong class="reserved">boolean</strong> hasItem = (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>);
<a id="L411" name="L411"></a> 411                 <strong class="reserved">if</strong> (hasItem || (q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L412" name="L412"></a> 412                     <a href="../D/36118.html" title="Multiple defined in 2 places.">updateHead</a>(h, p);
<a id="L413" name="L413"></a> 413                     <strong class="reserved">return</strong> hasItem ? p : <strong class="reserved">null</strong>;
<a id="L414" name="L414"></a> 414                 <em class="brace">}</em>
<a id="L415" name="L415"></a> 415                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L416" name="L416"></a> 416                     <strong class="reserved">continue</strong> restartFromHead;
<a id="L417" name="L417"></a> 417                 <strong class="reserved">else</strong>
<a id="L418" name="L418"></a> 418                     p = q;
<a id="L419" name="L419"></a> 419             <em class="brace">}</em>
<a id="L420" name="L420"></a> 420         <em class="brace">}</em>
<a id="L421" name="L421"></a> 421     <em class="brace">}</em>
<a id="L422" name="L422"></a> 422 
<div class="comment">
      Returns <code>true</code> if this queue contains no elements.
      @return <code>true</code> if this queue contains no elements</div>
<a id="L428" name="L428"></a> 428     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21404.html" title="Multiple referred from 435 places.">isEmpty</a>() <em class="brace">{</em>
<a id="L429" name="L429"></a> 429         <strong class="reserved">return</strong> <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>() == <strong class="reserved">null</strong>;
<a id="L430" name="L430"></a> 430     <em class="brace">}</em>
<a id="L431" name="L431"></a> 431 
<div class="comment">
      Returns the number of elements in this queue.  If this queue
      contains more than <code>Integer.MAX_VALUE</code> elements, returns
      <code>Integer.MAX_VALUE</code>.
      <p>Beware that, unlike in most collections, this method is
      <em>NOT</em> a constant-time operation. Because of the
      asynchronous nature of these queues, determining the current
      number of elements requires an O(n) traversal.
      Additionally, if elements are added or removed during execution
      of this method, the returned result may be inaccurate.  Thus,
      this method is typically not very useful in concurrent
      applications.
      @return the number of elements in this queue</p></div>
<a id="L448" name="L448"></a> 448     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/28639.html" title="Multiple referred from 5617 places.">size</a>() <em class="brace">{</em>
<a id="L449" name="L449"></a> 449         <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L450" name="L450"></a> 450         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p))
<a id="L451" name="L451"></a> 451             <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L452" name="L452"></a> 452                 <em class="comment">// Collection.size() spec says to max out</em>
<a id="L453" name="L453"></a> 453                 <strong class="reserved">if</strong> (++<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> == <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MAX_VALUE)
<a id="L454" name="L454"></a> 454                     <strong class="reserved">break</strong>;
<a id="L455" name="L455"></a> 455         <strong class="reserved">return</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;
<a id="L456" name="L456"></a> 456     <em class="brace">}</em>
<a id="L457" name="L457"></a> 457 
<div class="comment">
      Returns <code>true</code> if this queue contains the specified element.
      More formally, returns <code>true</code> if and only if this queue contains
      at least one element <code>e</code> such that <code>o.equals(e)</code>.
      @param o object to be checked for containment in this queue
      @return <code>true</code> if this queue contains the specified element</div>
<a id="L466" name="L466"></a> 466     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/11949.html" title="Multiple referred from 682 places.">contains</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>) <em class="brace">{</em>
<a id="L467" name="L467"></a> 467         <strong class="reserved">if</strong> (<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L468" name="L468"></a> 468         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L469" name="L469"></a> 469             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L470" name="L470"></a> 470             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> &amp;&amp; <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>))
<a id="L471" name="L471"></a> 471                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L472" name="L472"></a> 472         <em class="brace">}</em>
<a id="L473" name="L473"></a> 473         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L474" name="L474"></a> 474     <em class="brace">}</em>
<a id="L475" name="L475"></a> 475 
<div class="comment">
      Removes a single instance of the specified element from this queue,
      if it is present.  More formally, removes an element <code>e</code> such
      that <code>o.equals(e)</code>, if this queue contains one or more such
      elements.
      Returns <code>true</code> if this queue contained the specified element
      (or equivalently, if this queue changed as a result of the call).
      @param o element to be removed from this queue, if present
      @return <code>true</code> if this queue changed as a result of the call</div>
<a id="L487" name="L487"></a> 487     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/25882.html" title="Multiple referred from 1115 places.">remove</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>) <em class="brace">{</em>
<a id="L488" name="L488"></a> 488         <strong class="reserved">if</strong> (<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L489" name="L489"></a> 489         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> = <strong class="reserved">null</strong>;
<a id="L490" name="L490"></a> 490         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L491" name="L491"></a> 491             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L492" name="L492"></a> 492             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> &amp;&amp;
<a id="L493" name="L493"></a> 493                 <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>) &amp;&amp;
<a id="L494" name="L494"></a> 494                 p.<a href="../D/12262.html" title="Multiple defined in 4 places.">casItem</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>, <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L495" name="L495"></a> 495                 <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p);
<a id="L496" name="L496"></a> 496                 <strong class="reserved">if</strong> (<a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> != <strong class="reserved">null</strong> &amp;&amp; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> != <strong class="reserved">null</strong>)
<a id="L497" name="L497"></a> 497                     <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/12263.html" title="Multiple defined in 6 places.">casNext</a>(p, <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>);
<a id="L498" name="L498"></a> 498                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L499" name="L499"></a> 499             <em class="brace">}</em>
<a id="L500" name="L500"></a> 500             <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> = p;
<a id="L501" name="L501"></a> 501         <em class="brace">}</em>
<a id="L502" name="L502"></a> 502         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L503" name="L503"></a> 503     <em class="brace">}</em>
<a id="L504" name="L504"></a> 504 
<div class="comment">
      Appends all of the elements in the specified collection to the end of
      this queue, in the order that they are returned by the specified
      collection's iterator.  Attempts to <code>addAll</code> of a queue to
      itself result in <code>IllegalArgumentException</code>.
      @param c the elements to be inserted into this queue
      @return <code>true</code> if this queue changed as a result of the call
      @throws NullPointerException if the specified collection or any
              of its elements are null
      @throws IllegalArgumentException if the collection is this queue</div>
<a id="L517" name="L517"></a> 517     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/9603.html" title="Multiple referred from 145 places.">addAll</a>(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;? <strong class="reserved">extends</strong> E&gt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L518" name="L518"></a> 518         <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == <strong class="reserved">this</strong>)
<a id="L519" name="L519"></a> 519             <em class="comment">// As historically specified in AbstractQueue#addAll</em>
<a id="L520" name="L520"></a> 520             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L521" name="L521"></a> 521 
<a id="L522" name="L522"></a> 522         <em class="comment">// Copy c into a private chain of Nodes</em>
<a id="L523" name="L523"></a> 523         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; beginningOfTheEnd = <strong class="reserved">null</strong>, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = <strong class="reserved">null</strong>;
<a id="L524" name="L524"></a> 524         <strong class="reserved">for</strong> (E e : <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L525" name="L525"></a> 525             <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(e);
<a id="L526" name="L526"></a> 526             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(e);
<a id="L527" name="L527"></a> 527             <strong class="reserved">if</strong> (beginningOfTheEnd == <strong class="reserved">null</strong>)
<a id="L528" name="L528"></a> 528                 beginningOfTheEnd = <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L529" name="L529"></a> 529             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L530" name="L530"></a> 530                 <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);
<a id="L531" name="L531"></a> 531                 <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L532" name="L532"></a> 532             <em class="brace">}</em>
<a id="L533" name="L533"></a> 533         <em class="brace">}</em>
<a id="L534" name="L534"></a> 534         <strong class="reserved">if</strong> (beginningOfTheEnd == <strong class="reserved">null</strong>)
<a id="L535" name="L535"></a> 535             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L536" name="L536"></a> 536 
<a id="L537" name="L537"></a> 537         <em class="comment">// Atomically append the chain at the tail of this collection</em>
<a id="L538" name="L538"></a> 538         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; t = tail, p = t;;) <em class="brace">{</em>
<a id="L539" name="L539"></a> 539             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L540" name="L540"></a> 540             <strong class="reserved">if</strong> (q == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L541" name="L541"></a> 541                 <em class="comment">// p is last node</em>
<a id="L542" name="L542"></a> 542                 <strong class="reserved">if</strong> (p.<a href="../D/12263.html" title="Multiple defined in 6 places.">casNext</a>(<strong class="reserved">null</strong>, beginningOfTheEnd)) <em class="brace">{</em>
<a id="L543" name="L543"></a> 543                     <em class="comment">// Successful CAS is the linearization point</em>
<a id="L544" name="L544"></a> 544                     <em class="comment">// for all elements to be added to this queue.</em>
<a id="L545" name="L545"></a> 545                     <strong class="reserved">if</strong> (!<a href="../D/12271.html" title="Multiple defined in 3 places.">casTail</a>(t, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>)) <em class="brace">{</em>
<a id="L546" name="L546"></a> 546                         <em class="comment">// Try a little harder to update tail,</em>
<a id="L547" name="L547"></a> 547                         <em class="comment">// since we may be adding many elements.</em>
<a id="L548" name="L548"></a> 548                         t = tail;
<a id="L549" name="L549"></a> 549                         <strong class="reserved">if</strong> (<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == <strong class="reserved">null</strong>)
<a id="L550" name="L550"></a> 550                             <a href="../D/12271.html" title="Multiple defined in 3 places.">casTail</a>(t, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>);
<a id="L551" name="L551"></a> 551                     <em class="brace">}</em>
<a id="L552" name="L552"></a> 552                     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L553" name="L553"></a> 553                 <em class="brace">}</em>
<a id="L554" name="L554"></a> 554                 <em class="comment">// Lost CAS race to another thread; re-read next</em>
<a id="L555" name="L555"></a> 555             <em class="brace">}</em>
<a id="L556" name="L556"></a> 556             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L557" name="L557"></a> 557                 <em class="comment">// We have fallen off list.  If tail is unchanged, it</em>
<a id="L558" name="L558"></a> 558                 <em class="comment">// will also be off-list, in which case we need to</em>
<a id="L559" name="L559"></a> 559                 <em class="comment">// jump to head, from which all live nodes are always</em>
<a id="L560" name="L560"></a> 560                 <em class="comment">// reachable.  Else the new tail is a better bet.</em>
<a id="L561" name="L561"></a> 561                 p = (t != (t = tail)) ? t : head;
<a id="L562" name="L562"></a> 562             <strong class="reserved">else</strong>
<a id="L563" name="L563"></a> 563                 <em class="comment">// Check for tail updates after two hops.</em>
<a id="L564" name="L564"></a> 564                 p = (p != t &amp;&amp; t != (t = tail)) ? t : q;
<a id="L565" name="L565"></a> 565         <em class="brace">}</em>
<a id="L566" name="L566"></a> 566     <em class="brace">}</em>
<a id="L567" name="L567"></a> 567 
<div class="comment">
      Returns an array containing all of the elements in this queue, in
      proper sequence.
      <p>The returned array will be "safe" in that no references to it are
      maintained by this queue.  (In other words, this method must allocate
      a new array).  The caller is thus free to modify the returned array.
      </p><p>This method acts as bridge between array-based and collection-based
      APIs.
      @return an array containing all of the elements in this queue</p></div>
<a id="L581" name="L581"></a> 581     <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <a href="../R/29213.html" title="Multiple referred from 289 places.">toArray</a>() <em class="brace">{</em>
<a id="L582" name="L582"></a> 582         <em class="comment">// Use ArrayList to deal with resizing.</em>
<a id="L583" name="L583"></a> 583         <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;E&gt; al = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;E&gt;();
<a id="L584" name="L584"></a> 584         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L585" name="L585"></a> 585             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L586" name="L586"></a> 586             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L587" name="L587"></a> 587                 al.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L588" name="L588"></a> 588         <em class="brace">}</em>
<a id="L589" name="L589"></a> 589         <strong class="reserved">return</strong> al.<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>();
<a id="L590" name="L590"></a> 590     <em class="brace">}</em>
<a id="L591" name="L591"></a> 591 
<div class="comment">
      Returns an array containing all of the elements in this queue, in
      proper sequence; the runtime type of the returned array is that of
      the specified array.  If the queue fits in the specified array, it
      is returned therein.  Otherwise, a new array is allocated with the
      runtime type of the specified array and the size of this queue.
      <p>If this queue fits in the specified array with room to spare
      (i.e., the array has more elements than this queue), the element in
      the array immediately following the end of the queue is set to
      <code>null</code>.
      </p><p>Like the {@link #toArray()} method, this method acts as bridge between
      array-based and collection-based APIs.  Further, this method allows
      precise control over the runtime type of the output array, and may,
      under certain circumstances, be used to save allocation costs.
      </p><p>Suppose <code>x</code> is a queue known to contain only strings.
      The following code can be used to dump the queue into a newly
      allocated array of <code>String</code>:
       </p><pre> <code>String[] y = x.toArray(new String[0]);</code></pre>
      Note that <code>toArray(new Object[0])</code> is identical in function to
      <code>toArray()</code>.
      @param a the array into which the elements of the queue are to
               be stored, if it is big enough; otherwise, a new array of the
               same runtime type is allocated for this purpose
      @return an array containing all of the elements in this queue
      @throws ArrayStoreException if the runtime type of the specified array
              is not a supertype of the runtime type of every element in
              this queue
      @throws NullPointerException if the specified array is null</div>
<a id="L627" name="L627"></a> 627     @<a href="../R/7764.html" title="Multiple referred from 264 places.">SuppressWarnings</a>("unchecked")
<a id="L628" name="L628"></a> 628     <strong class="reserved">public</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>[] <a href="../R/29213.html" title="Multiple referred from 289 places.">toArray</a>(<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>[] <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) <em class="brace">{</em>
<a id="L629" name="L629"></a> 629         <em class="comment">// try to use sent-in array</em>
<a id="L630" name="L630"></a> 630         <strong class="reserved">int</strong> k = 0;
<a id="L631" name="L631"></a> 631         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p;
<a id="L632" name="L632"></a> 632         <strong class="reserved">for</strong> (p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong> &amp;&amp; k &lt; <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L633" name="L633"></a> 633             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L634" name="L634"></a> 634             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L635" name="L635"></a> 635                 <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>[k++] = (<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>)<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L636" name="L636"></a> 636         <em class="brace">}</em>
<a id="L637" name="L637"></a> 637         <strong class="reserved">if</strong> (p == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L638" name="L638"></a> 638             <strong class="reserved">if</strong> (k &lt; <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>)
<a id="L639" name="L639"></a> 639                 <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>[k] = <strong class="reserved">null</strong>;
<a id="L640" name="L640"></a> 640             <strong class="reserved">return</strong> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>;
<a id="L641" name="L641"></a> 641         <em class="brace">}</em>
<a id="L642" name="L642"></a> 642 
<a id="L643" name="L643"></a> 643         <em class="comment">// If won't fit, use ArrayList version</em>
<a id="L644" name="L644"></a> 644         <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;E&gt; al = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;E&gt;();
<a id="L645" name="L645"></a> 645         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); q != <strong class="reserved">null</strong>; q = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(q)) <em class="brace">{</em>
<a id="L646" name="L646"></a> 646             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = q.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L647" name="L647"></a> 647             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L648" name="L648"></a> 648                 al.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L649" name="L649"></a> 649         <em class="brace">}</em>
<a id="L650" name="L650"></a> 650         <strong class="reserved">return</strong> al.<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>(<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L651" name="L651"></a> 651     <em class="brace">}</em>
<a id="L652" name="L652"></a> 652 
<div class="comment">
      Returns an iterator over the elements in this queue in proper sequence.
      The elements will be returned in order from first (head) to last (tail).
      <p>The returned iterator is
      <a href="package-summary.html#Weakly"><i>weakly consistent</i></a>.
      @return an iterator over the elements in this queue in proper sequence</p></div>
<a id="L662" name="L662"></a> 662     <strong class="reserved">public</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;E&gt; <a href="../R/22304.html" title="Multiple referred from 905 places.">iterator</a>() <em class="brace">{</em>
<a id="L663" name="L663"></a> 663         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/4466.html" title="Multiple defined in 13 places.">Itr</a>();
<a id="L664" name="L664"></a> 664     <em class="brace">}</em>
<a id="L665" name="L665"></a> 665 
<a id="L666" name="L666"></a> 666     <strong class="reserved">private</strong> <strong class="reserved">class</strong> <a href="../R/4056.html" title="Multiple referred from 24 places.">Itr</a> <strong class="reserved">implements</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;E&gt; <em class="brace">{</em>
<div class="comment">
          Next node to return item for.</div>
<a id="L670" name="L670"></a> 670         <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>;
<a id="L671" name="L671"></a> 671 
<div class="comment">
          nextItem holds on to item fields because once we claim
          that an element exists in hasNext(), we must return it in
          the following next() call even if it was in the process of
          being removed when hasNext() was called.</div>
<a id="L678" name="L678"></a> 678         <strong class="reserved">private</strong> E nextItem;
<a id="L679" name="L679"></a> 679 
<div class="comment">
          Node of the last returned item, to support remove.</div>
<a id="L683" name="L683"></a> 683         <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; lastRet;
<a id="L684" name="L684"></a> 684 
<a id="L685" name="L685"></a> 685         Itr() <em class="brace">{</em>
<a id="L686" name="L686"></a> 686             <a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>();
<a id="L687" name="L687"></a> 687         <em class="brace">}</em>
<a id="L688" name="L688"></a> 688 
<div class="comment">
          Moves to next valid node and returns item to return for
          next(), or null if no such.</div>
<a id="L693" name="L693"></a> 693         <strong class="reserved">private</strong> E <a href="../R/10102.html" title="Multiple referred from 119 places.">advance</a>() <em class="brace">{</em>
<a id="L694" name="L694"></a> 694             lastRet = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>;
<a id="L695" name="L695"></a> 695             E <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = nextItem;
<a id="L696" name="L696"></a> 696 
<a id="L697" name="L697"></a> 697             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>, p;
<a id="L698" name="L698"></a> 698             <strong class="reserved">if</strong> (<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L699" name="L699"></a> 699                 p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L700" name="L700"></a> 700                 <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> = <strong class="reserved">null</strong>;
<a id="L701" name="L701"></a> 701             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L702" name="L702"></a> 702                 <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>;
<a id="L703" name="L703"></a> 703                 p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>);
<a id="L704" name="L704"></a> 704             <em class="brace">}</em>
<a id="L705" name="L705"></a> 705 
<a id="L706" name="L706"></a> 706             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L707" name="L707"></a> 707                 <strong class="reserved">if</strong> (p == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L708" name="L708"></a> 708                     <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> = <strong class="reserved">null</strong>;
<a id="L709" name="L709"></a> 709                     nextItem = <strong class="reserved">null</strong>;
<a id="L710" name="L710"></a> 710                     <strong class="reserved">return</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L711" name="L711"></a> 711                 <em class="brace">}</em>
<a id="L712" name="L712"></a> 712                 E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L713" name="L713"></a> 713                 <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L714" name="L714"></a> 714                     <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> = p;
<a id="L715" name="L715"></a> 715                     nextItem = <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L716" name="L716"></a> 716                     <strong class="reserved">return</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L717" name="L717"></a> 717                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L718" name="L718"></a> 718                     <em class="comment">// skip over nulls</em>
<a id="L719" name="L719"></a> 719                     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p);
<a id="L720" name="L720"></a> 720                     <strong class="reserved">if</strong> (<a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a> != <strong class="reserved">null</strong> &amp;&amp; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> != <strong class="reserved">null</strong>)
<a id="L721" name="L721"></a> 721                         <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>.<a href="../D/12263.html" title="Multiple defined in 6 places.">casNext</a>(p, <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>);
<a id="L722" name="L722"></a> 722                     p = <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L723" name="L723"></a> 723                 <em class="brace">}</em>
<a id="L724" name="L724"></a> 724             <em class="brace">}</em>
<a id="L725" name="L725"></a> 725         <em class="brace">}</em>
<a id="L726" name="L726"></a> 726 
<a id="L727" name="L727"></a> 727         <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/20233.html" title="Multiple referred from 653 places.">hasNext</a>() <em class="brace">{</em>
<a id="L728" name="L728"></a> 728             <strong class="reserved">return</strong> <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> != <strong class="reserved">null</strong>;
<a id="L729" name="L729"></a> 729         <em class="brace">}</em>
<a id="L730" name="L730"></a> 730 
<a id="L731" name="L731"></a> 731         <strong class="reserved">public</strong> E <a href="../R/23650.html" title="Multiple referred from 3301 places.">next</a>() <em class="brace">{</em>
<a id="L732" name="L732"></a> 732             <strong class="reserved">if</strong> (<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> == <strong class="reserved">null</strong>) <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1128.html#L38" title="Defined at 38 in src/java/util/NoSuchElementException.java.">NoSuchElementException</a>();
<a id="L733" name="L733"></a> 733             <strong class="reserved">return</strong> <a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>();
<a id="L734" name="L734"></a> 734         <em class="brace">}</em>
<a id="L735" name="L735"></a> 735 
<a id="L736" name="L736"></a> 736         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25882.html" title="Multiple referred from 1115 places.">remove</a>() <em class="brace">{</em>
<a id="L737" name="L737"></a> 737             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; l = lastRet;
<a id="L738" name="L738"></a> 738             <strong class="reserved">if</strong> (l == <strong class="reserved">null</strong>) <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a>();
<a id="L739" name="L739"></a> 739             <em class="comment">// rely on a future traversal to relink.</em>
<a id="L740" name="L740"></a> 740             l.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = <strong class="reserved">null</strong>;
<a id="L741" name="L741"></a> 741             lastRet = <strong class="reserved">null</strong>;
<a id="L742" name="L742"></a> 742         <em class="brace">}</em>
<a id="L743" name="L743"></a> 743     <em class="brace">}</em>
<a id="L744" name="L744"></a> 744 
<div class="comment">
      Saves this queue to a stream (that is, serializes it).
      @param s the stream
      @throws java.io.IOException if an I/O error occurs
      @serialData All of the elements (each an <code>E</code>) in
      the proper order, followed by a null</div>
<a id="L753" name="L753"></a> 753     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/30680.html" title="Multiple referred from 184 places.">writeObject</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1381.html#L162" title="Defined at 162 in src/java/io/ObjectOutputStream.java.">ObjectOutputStream</a> s)
<a id="L754" name="L754"></a> 754         <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L755" name="L755"></a> 755 
<a id="L756" name="L756"></a> 756         <em class="comment">// Write out any hidden stuff</em>
<a id="L757" name="L757"></a> 757         s.<a href="../D/14752.html" title="Multiple defined in 6 places.">defaultWriteObject</a>();
<a id="L758" name="L758"></a> 758 
<a id="L759" name="L759"></a> 759         <em class="comment">// Write out all elements in the proper order.</em>
<a id="L760" name="L760"></a> 760         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L761" name="L761"></a> 761             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L762" name="L762"></a> 762             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L763" name="L763"></a> 763                 s.<a href="../D/37124.html" title="Multiple defined in 263 places.">writeObject</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L764" name="L764"></a> 764         <em class="brace">}</em>
<a id="L765" name="L765"></a> 765 
<a id="L766" name="L766"></a> 766         <em class="comment">// Use trailing null as sentinel</em>
<a id="L767" name="L767"></a> 767         s.<a href="../D/37124.html" title="Multiple defined in 263 places.">writeObject</a>(<strong class="reserved">null</strong>);
<a id="L768" name="L768"></a> 768     <em class="brace">}</em>
<a id="L769" name="L769"></a> 769 
<div class="comment">
      Reconstitutes this queue from a stream (that is, deserializes it).
      @param s the stream
      @throws ClassNotFoundException if the class of a serialized object
              could not be found
      @throws java.io.IOException if an I/O error occurs</div>
<a id="L777" name="L777"></a> 777     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25518.html" title="Multiple referred from 189 places.">readObject</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1378.html#L206" title="Defined at 206 in src/java/io/ObjectInputStream.java.">ObjectInputStream</a> s)
<a id="L778" name="L778"></a> 778         <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a> <em class="brace">{</em>
<a id="L779" name="L779"></a> 779         s.<a href="../D/14746.html" title="Multiple defined in 2 places.">defaultReadObject</a>();
<a id="L780" name="L780"></a> 780 
<a id="L781" name="L781"></a> 781         <em class="comment">// Read in elements until trailing null sentinel found</em>
<a id="L782" name="L782"></a> 782         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = <strong class="reserved">null</strong>, t = <strong class="reserved">null</strong>;
<a id="L783" name="L783"></a> 783         <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L784" name="L784"></a> 784         <strong class="reserved">while</strong> ((<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = s.<a href="../D/30232.html" title="Multiple defined in 322 places.">readObject</a>()) != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L785" name="L785"></a> 785             @<a href="../D/8551.html" title="Multiple defined in 725 places.">SuppressWarnings</a>("unchecked")
<a id="L786" name="L786"></a> 786             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;((E) <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L787" name="L787"></a> 787             <strong class="reserved">if</strong> (h == <strong class="reserved">null</strong>)
<a id="L788" name="L788"></a> 788                 h = t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L789" name="L789"></a> 789             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L790" name="L790"></a> 790                 t.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);
<a id="L791" name="L791"></a> 791                 t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L792" name="L792"></a> 792             <em class="brace">}</em>
<a id="L793" name="L793"></a> 793         <em class="brace">}</em>
<a id="L794" name="L794"></a> 794         <strong class="reserved">if</strong> (h == <strong class="reserved">null</strong>)
<a id="L795" name="L795"></a> 795             h = t = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(<strong class="reserved">null</strong>);
<a id="L796" name="L796"></a> 796         head = h;
<a id="L797" name="L797"></a> 797         tail = t;
<a id="L798" name="L798"></a> 798     <em class="brace">}</em>
<a id="L799" name="L799"></a> 799 
<div class="comment">
     /** A customized variant of Spliterators.IteratorSpliterator */</div>
<a id="L801" name="L801"></a> 801     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../S/1103.html#L904" title="Referred from 904 in src/java/util/concurrent/ConcurrentLinkedQueue.java.">CLQSpliterator</a>&lt;E&gt; <strong class="reserved">implements</strong> <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>&lt;E&gt; <em class="brace">{</em>
<a id="L802" name="L802"></a> 802         <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> MAX_BATCH = 1 &lt;&lt; 25;  <em class="comment">// max batch array size;</em>
<a id="L803" name="L803"></a> 803         <strong class="reserved">final</strong> <a href="../S/1103.html#L105" title="Defined at 105 in src/java/util/concurrent/ConcurrentLinkedQueue.java.">ConcurrentLinkedQueue</a>&lt;E&gt; queue;
<a id="L804" name="L804"></a> 804         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>;    <em class="comment">// current node; null until initialized</em>
<a id="L805" name="L805"></a> 805         <strong class="reserved">int</strong> batch;          <em class="comment">// batch size for splits</em>
<a id="L806" name="L806"></a> 806         <strong class="reserved">boolean</strong> exhausted;  <em class="comment">// true when no more nodes</em>
<a id="L807" name="L807"></a> 807         CLQSpliterator(<a href="../S/1103.html#L105" title="Defined at 105 in src/java/util/concurrent/ConcurrentLinkedQueue.java.">ConcurrentLinkedQueue</a>&lt;E&gt; queue) <em class="brace">{</em>
<a id="L808" name="L808"></a> 808             <strong class="reserved">this</strong>.queue = queue;
<a id="L809" name="L809"></a> 809         <em class="brace">}</em>
<a id="L810" name="L810"></a> 810 
<a id="L811" name="L811"></a> 811         <strong class="reserved">public</strong> <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>&lt;E&gt; <a href="../R/29563.html" title="Multiple referred from 18 places.">trySplit</a>() <em class="brace">{</em>
<a id="L812" name="L812"></a> 812             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p;
<a id="L813" name="L813"></a> 813             <strong class="reserved">final</strong> <a href="../S/1103.html#L105" title="Defined at 105 in src/java/util/concurrent/ConcurrentLinkedQueue.java.">ConcurrentLinkedQueue</a>&lt;E&gt; q = <strong class="reserved">this</strong>.queue;
<a id="L814" name="L814"></a> 814             <strong class="reserved">int</strong> b = batch;
<a id="L815" name="L815"></a> 815             <strong class="reserved">int</strong> n = (b &lt;= 0) ? 1 : (b &gt;= MAX_BATCH) ? MAX_BATCH : b + 1;
<a id="L816" name="L816"></a> 816             <strong class="reserved">if</strong> (!exhausted &amp;&amp;
<a id="L817" name="L817"></a> 817                 ((p = <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>) != <strong class="reserved">null</strong> || (p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>()) != <strong class="reserved">null</strong>) &amp;&amp;
<a id="L818" name="L818"></a> 818                 p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L819" name="L819"></a> 819                 <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a> = <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[n];
<a id="L820" name="L820"></a> 820                 <strong class="reserved">int</strong> i = 0;
<a id="L821" name="L821"></a> 821                 <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L822" name="L822"></a> 822                     <strong class="reserved">if</strong> ((<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>[i] = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>) != <strong class="reserved">null</strong>)
<a id="L823" name="L823"></a> 823                         ++i;
<a id="L824" name="L824"></a> 824                     <strong class="reserved">if</strong> (p == (p = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>))
<a id="L825" name="L825"></a> 825                         p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L826" name="L826"></a> 826                 <em class="brace">}</em> <strong class="reserved">while</strong> (p != <strong class="reserved">null</strong> &amp;&amp; i &lt; n);
<a id="L827" name="L827"></a> 827                 <strong class="reserved">if</strong> ((<a href="../D/14417.html" title="Multiple defined in 10 places.">current</a> = p) == <strong class="reserved">null</strong>)
<a id="L828" name="L828"></a> 828                     exhausted = <strong class="reserved">true</strong>;
<a id="L829" name="L829"></a> 829                 <strong class="reserved">if</strong> (i &gt; 0) <em class="brace">{</em>
<a id="L830" name="L830"></a> 830                     batch = i;
<a id="L831" name="L831"></a> 831                     <strong class="reserved">return</strong> <a href="../S/1188.html#L41" title="Defined at 41 in src/java/util/Spliterators.java.">Spliterators</a>.<a href="../D/34729.html" title="Multiple defined in 111 places.">spliterator</a>
<a id="L832" name="L832"></a> 832                         (<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, 0, i, <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.<a href="../S/915.html#L281" title="Defined at 281 in src/java/util/stream/StreamOpFlag.java.">ORDERED</a> | <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.NONNULL |
<a id="L833" name="L833"></a> 833                          <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.CONCURRENT);
<a id="L834" name="L834"></a> 834                 <em class="brace">}</em>
<a id="L835" name="L835"></a> 835             <em class="brace">}</em>
<a id="L836" name="L836"></a> 836             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L837" name="L837"></a> 837         <em class="brace">}</em>
<a id="L838" name="L838"></a> 838 
<a id="L839" name="L839"></a> 839         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/14732.html" title="Multiple referred from 54 places.">forEachRemaining</a>(<a href="../S/963.html#L42" title="Defined at 42 in src/java/util/function/Consumer.java.">Consumer</a>&lt;? <strong class="reserved">super</strong> E&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>) <em class="brace">{</em>
<a id="L840" name="L840"></a> 840             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p;
<a id="L841" name="L841"></a> 841             <strong class="reserved">if</strong> (<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a> == <strong class="reserved">null</strong>) <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L842" name="L842"></a> 842             <strong class="reserved">final</strong> <a href="../S/1103.html#L105" title="Defined at 105 in src/java/util/concurrent/ConcurrentLinkedQueue.java.">ConcurrentLinkedQueue</a>&lt;E&gt; q = <strong class="reserved">this</strong>.queue;
<a id="L843" name="L843"></a> 843             <strong class="reserved">if</strong> (!exhausted &amp;&amp;
<a id="L844" name="L844"></a> 844                 ((p = <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>) != <strong class="reserved">null</strong> || (p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>()) != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L845" name="L845"></a> 845                 exhausted = <strong class="reserved">true</strong>;
<a id="L846" name="L846"></a> 846                 <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L847" name="L847"></a> 847                     E e = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L848" name="L848"></a> 848                     <strong class="reserved">if</strong> (p == (p = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>))
<a id="L849" name="L849"></a> 849                         p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L850" name="L850"></a> 850                     <strong class="reserved">if</strong> (e != <strong class="reserved">null</strong>)
<a id="L851" name="L851"></a> 851                         <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>.<a href="../D/10537.html" title="Multiple defined in 327 places.">accept</a>(e);
<a id="L852" name="L852"></a> 852                 <em class="brace">}</em> <strong class="reserved">while</strong> (p != <strong class="reserved">null</strong>);
<a id="L853" name="L853"></a> 853             <em class="brace">}</em>
<a id="L854" name="L854"></a> 854         <em class="brace">}</em>
<a id="L855" name="L855"></a> 855 
<a id="L856" name="L856"></a> 856         <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/29541.html" title="Multiple referred from 73 places.">tryAdvance</a>(<a href="../S/963.html#L42" title="Defined at 42 in src/java/util/function/Consumer.java.">Consumer</a>&lt;? <strong class="reserved">super</strong> E&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>) <em class="brace">{</em>
<a id="L857" name="L857"></a> 857             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p;
<a id="L858" name="L858"></a> 858             <strong class="reserved">if</strong> (<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a> == <strong class="reserved">null</strong>) <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L859" name="L859"></a> 859             <strong class="reserved">final</strong> <a href="../S/1103.html#L105" title="Defined at 105 in src/java/util/concurrent/ConcurrentLinkedQueue.java.">ConcurrentLinkedQueue</a>&lt;E&gt; q = <strong class="reserved">this</strong>.queue;
<a id="L860" name="L860"></a> 860             <strong class="reserved">if</strong> (!exhausted &amp;&amp;
<a id="L861" name="L861"></a> 861                 ((p = <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>) != <strong class="reserved">null</strong> || (p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>()) != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L862" name="L862"></a> 862                 E e;
<a id="L863" name="L863"></a> 863                 <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L864" name="L864"></a> 864                     e = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L865" name="L865"></a> 865                     <strong class="reserved">if</strong> (p == (p = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>))
<a id="L866" name="L866"></a> 866                         p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L867" name="L867"></a> 867                 <em class="brace">}</em> <strong class="reserved">while</strong> (e == <strong class="reserved">null</strong> &amp;&amp; p != <strong class="reserved">null</strong>);
<a id="L868" name="L868"></a> 868                 <strong class="reserved">if</strong> ((<a href="../D/14417.html" title="Multiple defined in 10 places.">current</a> = p) == <strong class="reserved">null</strong>)
<a id="L869" name="L869"></a> 869                     exhausted = <strong class="reserved">true</strong>;
<a id="L870" name="L870"></a> 870                 <strong class="reserved">if</strong> (e != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L871" name="L871"></a> 871                     <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>.<a href="../D/10537.html" title="Multiple defined in 327 places.">accept</a>(e);
<a id="L872" name="L872"></a> 872                     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L873" name="L873"></a> 873                 <em class="brace">}</em>
<a id="L874" name="L874"></a> 874             <em class="brace">}</em>
<a id="L875" name="L875"></a> 875             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L876" name="L876"></a> 876         <em class="brace">}</em>
<a id="L877" name="L877"></a> 877 
<a id="L878" name="L878"></a> 878         <strong class="reserved">public</strong> <strong class="reserved">long</strong> <a href="../R/14042.html" title="Multiple referred from 29 places.">estimateSize</a>() <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.MAX_VALUE; <em class="brace">}</em>
<a id="L879" name="L879"></a> 879 
<a id="L880" name="L880"></a> 880         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/11055.html" title="Multiple referred from 149 places.">characteristics</a>() <em class="brace">{</em>
<a id="L881" name="L881"></a> 881             <strong class="reserved">return</strong> <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.<a href="../S/915.html#L281" title="Defined at 281 in src/java/util/stream/StreamOpFlag.java.">ORDERED</a> | <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.NONNULL |
<a id="L882" name="L882"></a> 882                 <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.CONCURRENT;
<a id="L883" name="L883"></a> 883         <em class="brace">}</em>
<a id="L884" name="L884"></a> 884     <em class="brace">}</em>
<a id="L885" name="L885"></a> 885 
<div class="comment">
      Returns a <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a> over the elements in this queue.
      <p>The returned spliterator is
      <a href="package-summary.html#Weakly"><i>weakly consistent</i></a>.
      </p><p>The <code>Spliterator</code> reports {@link Spliterator#CONCURRENT},
      {@link Spliterator#ORDERED}, and {@link Spliterator#NONNULL}.
      @implNote
      The <code>Spliterator</code> implements <code>trySplit</code> to permit limited
      parallelism.
      @return a <code>Spliterator</code> over the elements in this queue
      @since 1.8</p></div>
<a id="L902" name="L902"></a> 902     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L903" name="L903"></a> 903     <strong class="reserved">public</strong> <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>&lt;E&gt; <a href="../R/28762.html" title="Multiple referred from 435 places.">spliterator</a>() <em class="brace">{</em>
<a id="L904" name="L904"></a> 904         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1103.html#L801" title="Defined at 801 in src/java/util/concurrent/ConcurrentLinkedQueue.java.">CLQSpliterator</a>&lt;E&gt;(<strong class="reserved">this</strong>);
<a id="L905" name="L905"></a> 905     <em class="brace">}</em>
<a id="L906" name="L906"></a> 906 
<div class="comment">
      Throws NullPointerException if argument is null.
      @param v the element</div>
<a id="L912" name="L912"></a> 912     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/11267.html" title="Multiple referred from 30 places.">checkNotNull</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> v) <em class="brace">{</em>
<a id="L913" name="L913"></a> 913         <strong class="reserved">if</strong> (v == <strong class="reserved">null</strong>)
<a id="L914" name="L914"></a> 914             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L915" name="L915"></a> 915     <em class="brace">}</em>
<a id="L916" name="L916"></a> 916 
<a id="L917" name="L917"></a> 917     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/10993.html" title="Multiple referred from 9 places.">casTail</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; cmp, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L918" name="L918"></a> 918         <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, tailOffset, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L919" name="L919"></a> 919     <em class="brace">}</em>
<a id="L920" name="L920"></a> 920 
<a id="L921" name="L921"></a> 921     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/10983.html" title="Multiple referred from 20 places.">casHead</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; cmp, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L922" name="L922"></a> 922         <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, headOffset, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L923" name="L923"></a> 923     <em class="brace">}</em>
<a id="L924" name="L924"></a> 924 
<a id="L925" name="L925"></a> 925     <em class="comment">// Unsafe mechanics</em>
<a id="L926" name="L926"></a> 926 
<a id="L927" name="L927"></a> 927     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> sun.misc.Unsafe UNSAFE;
<a id="L928" name="L928"></a> 928     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> headOffset;
<a id="L929" name="L929"></a> 929     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> tailOffset;
<a id="L930" name="L930"></a> 930     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L931" name="L931"></a> 931         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L932" name="L932"></a> 932             UNSAFE = sun.misc.Unsafe.getUnsafe();
<a id="L933" name="L933"></a> 933             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; k = <a href="../S/1103.html#L105" title="Defined at 105 in src/java/util/concurrent/ConcurrentLinkedQueue.java.">ConcurrentLinkedQueue</a>.<strong class="reserved">class</strong>;
<a id="L934" name="L934"></a> 934             headOffset = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L935" name="L935"></a> 935                 (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("head"));
<a id="L936" name="L936"></a> 936             tailOffset = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L937" name="L937"></a> 937                 (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("tail"));
<a id="L938" name="L938"></a> 938         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L939" name="L939"></a> 939             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>(e);
<a id="L940" name="L940"></a> 940         <em class="brace">}</em>
<a id="L941" name="L941"></a> 941     <em class="brace">}</em>
<a id="L942" name="L942"></a> 942 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L192">[^]</a><a href="#L921">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>