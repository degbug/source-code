<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/launcher/version_comp.c</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L60">[^]</a><a href="#L337">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L60" title="Defined at 60.">isjavaint</a></li>
<li><a href="#L82" title="Defined at 82.">comp_string</a></li>
<li><a href="#L96" title="Defined at 96.">JLI_PrefixVersionId</a></li>
<li><a href="#L136" title="Defined at 136.">JLI_ExactVersionId</a></li>
<li><a href="#L193" title="Defined at 193.">acceptable_simple_element</a></li>
<li><a href="#L218" title="Defined at 218.">acceptable_element</a></li>
<li><a href="#L239" title="Defined at 239.">JLI_AcceptableRelease</a></li>
<li><a href="#L287" title="Defined at 287.">valid_simple_element</a></li>
<li><a href="#L317" title="Defined at 317.">valid_element</a></li>
<li><a href="#L337" title="Defined at 337.">JLI_ValidVersionString</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2003, 2006, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <em class="sharp">#include</em> &lt;ctype.h&gt;
<a id="L27" name="L27"></a>  27 <em class="sharp">#include</em> &lt;stdlib.h&gt;
<a id="L28" name="L28"></a>  28 <em class="sharp">#include</em> &lt;string.h&gt;
<a id="L29" name="L29"></a>  29 <em class="sharp">#include</em> &lt;sys/types.h&gt;
<a id="L30" name="L30"></a>  30 <em class="sharp">#include</em> "jni.h"
<a id="L31" name="L31"></a>  31 <em class="sharp">#include</em> "<a href="9.html">jli_util.h</a>"
<a id="L32" name="L32"></a>  32 <em class="sharp">#include</em> "<a href="3.html">version_comp.h</a>"
<a id="L33" name="L33"></a>  33 
<div class="comment">
       A collection of useful strings. One should think of these as #define
       entries, but actual strings can be more efficient (with many compilers).</div>
<a id="L38" name="L38"></a>  38 <strong class="reserved">static</strong> <strong class="reserved">const</strong> <strong class="reserved">char</strong> *separators   = ".-_";
<a id="L39" name="L39"></a>  39 <strong class="reserved">static</strong> <strong class="reserved">const</strong> <strong class="reserved">char</strong> *zero_string  = "0";
<a id="L40" name="L40"></a>  40 
<div class="comment">
       Validate a string as parsable as a "Java int". If so parsable,
       return true (non-zero) and store the numeric value at the address
       passed in as "value"; otherwise return false (zero).
       Note that the maximum allowable value is 2147483647 as defined by
       the "Java Language Specification" which precludes the use of native
       conversion routines which may have other limits.
       Also note that we don't have to worry about the alternate maximum
       allowable value of 2147483648 because it is only allowed after
       the unary negation operator and this grammar doesn't have one
       of those.
       Finally, note that a value which exceeds the maximum jint value will
       return false (zero). This results in the otherwise purely numeric
       string being compared as a string of characters (as per the spec.)</div>
<a id="L59" name="L59"></a>  59 <strong class="reserved">static</strong> <strong class="reserved">int</strong>
<a id="L60" name="L60"></a>  60 <a href="../S/14.html#L85" title="Referred from 85 in src/launcher/version_comp.c.">isjavaint</a>(<strong class="reserved">const</strong> <strong class="reserved">char</strong> *s, jint *<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>)
<a id="L61" name="L61"></a>  61 <em class="brace">{</em>
<a id="L62" name="L62"></a>  62     jlong <a href="../D/35029.html" title="Multiple defined in 15 places.">sum</a> = 0;
<a id="L63" name="L63"></a>  63     jint <a href="../D/14902.html" title="Multiple defined in 10 places.">digit</a>;
<a id="L64" name="L64"></a>  64     <strong class="reserved">while</strong> (*s != '\0')
<a id="L65" name="L65"></a>  65         <strong class="reserved">if</strong> (isdigit(*s)) <em class="brace">{</em>
<a id="L66" name="L66"></a>  66             <a href="../D/14902.html" title="Multiple defined in 10 places.">digit</a> = (jint)((<strong class="reserved">int</strong>)(*s++) - (<strong class="reserved">int</strong>)('0'));
<a id="L67" name="L67"></a>  67             <a href="../D/35029.html" title="Multiple defined in 15 places.">sum</a> = (<a href="../D/35029.html" title="Multiple defined in 15 places.">sum</a> * 10) + <a href="../D/14902.html" title="Multiple defined in 10 places.">digit</a>;
<a id="L68" name="L68"></a>  68             <strong class="reserved">if</strong> (<a href="../D/35029.html" title="Multiple defined in 15 places.">sum</a> &gt; 2147483647)
<a id="L69" name="L69"></a>  69                 <div class="comment">
);     /* Overflows jint (but not jlong) */</div>
<a id="L70" name="L70"></a>  70         <em class="brace">}</em> <strong class="reserved">else</strong>
<a id="L71" name="L71"></a>  71             <strong class="reserved">return</strong> (0);
<a id="L72" name="L72"></a>  72     *<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = (jint)<a href="../D/35029.html" title="Multiple defined in 15 places.">sum</a>;
<a id="L73" name="L73"></a>  73     <strong class="reserved">return</strong> (1);
<a id="L74" name="L74"></a>  74 <em class="brace">}</em>
<a id="L75" name="L75"></a>  75 
<div class="comment">
       Modeled after strcmp(), compare two strings (as in the grammar defined
       in Appendix A of JSR 56).  If both strings can be interpreted as
       Java ints, do a numeric comparison, else it is strcmp().</div>
<a id="L81" name="L81"></a>  81 <strong class="reserved">static</strong> <strong class="reserved">int</strong>
<a id="L82" name="L82"></a>  82 <a href="../R/11682.html" title="Multiple referred from 4 places.">comp_string</a>(<strong class="reserved">const</strong> <strong class="reserved">char</strong> *s1, <strong class="reserved">const</strong> <strong class="reserved">char</strong> *s2)
<a id="L83" name="L83"></a>  83 <em class="brace">{</em>
<a id="L84" name="L84"></a>  84     jint v1, v2;
<a id="L85" name="L85"></a>  85     <strong class="reserved">if</strong> (<a href="../S/14.html#L60" title="Defined at 60 in src/launcher/version_comp.c.">isjavaint</a>(s1, &amp;v1) &amp;&amp; <a href="../S/14.html#L60" title="Defined at 60 in src/launcher/version_comp.c.">isjavaint</a>(s2, &amp;v2))
<a id="L86" name="L86"></a>  86         <strong class="reserved">return</strong> ((<strong class="reserved">int</strong>)(v1 - v2));
<a id="L87" name="L87"></a>  87     <strong class="reserved">else</strong>
<a id="L88" name="L88"></a>  88         <strong class="reserved">return</strong> (<a href="../S/9.html#L52" title="Defined at 52 in src/launcher/jli_util.h.">JLI_StrCmp</a>(s1, s2));
<a id="L89" name="L89"></a>  89 <em class="brace">}</em>
<a id="L90" name="L90"></a>  90 
<div class="comment">
       Modeled after strcmp(), compare two version-ids for a Prefix
       Match as defined in JSR 56.</div>
<a id="L95" name="L95"></a>  95 <strong class="reserved">int</strong>
<a id="L96" name="L96"></a>  96 <a href="../R/4157.html" title="Multiple referred from 2 places.">JLI_PrefixVersionId</a>(<strong class="reserved">const</strong> <strong class="reserved">char</strong> *id1, <strong class="reserved">char</strong> *id2)
<a id="L97" name="L97"></a>  97 <em class="brace">{</em>
<a id="L98" name="L98"></a>  98     <strong class="reserved">char</strong>        *s1 = <a href="../S/16.html#L67" title="Defined at 67 in src/launcher/jli_util.c.">JLI_StringDup</a>(id1);
<a id="L99" name="L99"></a>  99     <strong class="reserved">char</strong>        *s2 = <a href="../S/16.html#L67" title="Defined at 67 in src/launcher/jli_util.c.">JLI_StringDup</a>(id2);
<a id="L100" name="L100"></a> 100     <strong class="reserved">char</strong>        *m1 = s1;
<a id="L101" name="L101"></a> 101     <strong class="reserved">char</strong>        *m2 = s2;
<a id="L102" name="L102"></a> 102     <strong class="reserved">char</strong>        *end1 = <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L103" name="L103"></a> 103     <strong class="reserved">char</strong>        *end2 = <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L104" name="L104"></a> 104     <strong class="reserved">int</strong> res = 0;
<a id="L105" name="L105"></a> 105 
<a id="L106" name="L106"></a> 106     <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L107" name="L107"></a> 107 
<a id="L108" name="L108"></a> 108         <strong class="reserved">if</strong> ((s1 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) &amp;&amp; ((end1 = <a href="../S/9.html#L60" title="Defined at 60 in src/launcher/jli_util.h.">JLI_StrPBrk</a>(s1, ".-_")) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>))
<a id="L109" name="L109"></a> 109             *end1 = '\0';
<a id="L110" name="L110"></a> 110         <strong class="reserved">if</strong> ((s2 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) &amp;&amp; ((end2 = <a href="../S/9.html#L60" title="Defined at 60 in src/launcher/jli_util.h.">JLI_StrPBrk</a>(s2, ".-_")) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>))
<a id="L111" name="L111"></a> 111             *end2 = '\0';
<a id="L112" name="L112"></a> 112 
<a id="L113" name="L113"></a> 113         res = <a href="../S/14.html#L82" title="Defined at 82 in src/launcher/version_comp.c.">comp_string</a>(s1, s2);
<a id="L114" name="L114"></a> 114 
<a id="L115" name="L115"></a> 115         <strong class="reserved">if</strong> (end1 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L116" name="L116"></a> 116             s1 = end1 + 1;
<a id="L117" name="L117"></a> 117         <strong class="reserved">else</strong>
<a id="L118" name="L118"></a> 118             s1 = <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L119" name="L119"></a> 119         <strong class="reserved">if</strong> (end2 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L120" name="L120"></a> 120             s2 = end2 + 1;
<a id="L121" name="L121"></a> 121         <strong class="reserved">else</strong>
<a id="L122" name="L122"></a> 122             s2 = <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L123" name="L123"></a> 123 
<a id="L124" name="L124"></a> 124     <em class="brace">}</em> <strong class="reserved">while</strong> (res == 0 &amp;&amp; ((s1 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) &amp;&amp; (s2 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)));
<a id="L125" name="L125"></a> 125 
<a id="L126" name="L126"></a> 126     <a href="../S/16.html#L82" title="Defined at 82 in src/launcher/jli_util.c.">JLI_MemFree</a>(m1);
<a id="L127" name="L127"></a> 127     <a href="../S/16.html#L82" title="Defined at 82 in src/launcher/jli_util.c.">JLI_MemFree</a>(m2);
<a id="L128" name="L128"></a> 128     <strong class="reserved">return</strong> (res);
<a id="L129" name="L129"></a> 129 <em class="brace">}</em>
<a id="L130" name="L130"></a> 130 
<div class="comment">
       Modeled after strcmp(), compare two version-ids for an Exact
       Match as defined in JSR 56.</div>
<a id="L135" name="L135"></a> 135 <strong class="reserved">int</strong>
<a id="L136" name="L136"></a> 136 <a href="../R/4145.html" title="Multiple referred from 4 places.">JLI_ExactVersionId</a>(<strong class="reserved">const</strong> <strong class="reserved">char</strong> *id1, <strong class="reserved">char</strong> *id2)
<a id="L137" name="L137"></a> 137 <em class="brace">{</em>
<a id="L138" name="L138"></a> 138     <strong class="reserved">char</strong>        *s1 = <a href="../S/16.html#L67" title="Defined at 67 in src/launcher/jli_util.c.">JLI_StringDup</a>(id1);
<a id="L139" name="L139"></a> 139     <strong class="reserved">char</strong>        *s2 = <a href="../S/16.html#L67" title="Defined at 67 in src/launcher/jli_util.c.">JLI_StringDup</a>(id2);
<a id="L140" name="L140"></a> 140     <strong class="reserved">char</strong>        *m1 = s1;
<a id="L141" name="L141"></a> 141     <strong class="reserved">char</strong>        *m2 = s2;
<a id="L142" name="L142"></a> 142     <strong class="reserved">char</strong>        *end1 = <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L143" name="L143"></a> 143     <strong class="reserved">char</strong>        *end2 = <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L144" name="L144"></a> 144     <strong class="reserved">int</strong> res = 0;
<a id="L145" name="L145"></a> 145 
<a id="L146" name="L146"></a> 146     <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L147" name="L147"></a> 147 
<a id="L148" name="L148"></a> 148         <strong class="reserved">if</strong> ((s1 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) &amp;&amp; ((end1 = <a href="../S/9.html#L60" title="Defined at 60 in src/launcher/jli_util.h.">JLI_StrPBrk</a>(s1, separators)) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>))
<a id="L149" name="L149"></a> 149             *end1 = '\0';
<a id="L150" name="L150"></a> 150         <strong class="reserved">if</strong> ((s2 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) &amp;&amp; ((end2 = <a href="../S/9.html#L60" title="Defined at 60 in src/launcher/jli_util.h.">JLI_StrPBrk</a>(s2, separators)) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>))
<a id="L151" name="L151"></a> 151             *end2 = '\0';
<a id="L152" name="L152"></a> 152 
<a id="L153" name="L153"></a> 153         <strong class="reserved">if</strong> ((s1 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) &amp;&amp; (s2 == <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>))
<a id="L154" name="L154"></a> 154             res = <a href="../S/14.html#L82" title="Defined at 82 in src/launcher/version_comp.c.">comp_string</a>(s1, zero_string);
<a id="L155" name="L155"></a> 155         <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((s1 == <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) &amp;&amp; (s2 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>))
<a id="L156" name="L156"></a> 156             res = <a href="../S/14.html#L82" title="Defined at 82 in src/launcher/version_comp.c.">comp_string</a>(zero_string, s2);
<a id="L157" name="L157"></a> 157         <strong class="reserved">else</strong>
<a id="L158" name="L158"></a> 158             res = <a href="../S/14.html#L82" title="Defined at 82 in src/launcher/version_comp.c.">comp_string</a>(s1, s2);
<a id="L159" name="L159"></a> 159 
<a id="L160" name="L160"></a> 160         <strong class="reserved">if</strong> (end1 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L161" name="L161"></a> 161             s1 = end1 + 1;
<a id="L162" name="L162"></a> 162         <strong class="reserved">else</strong>
<a id="L163" name="L163"></a> 163             s1 = <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L164" name="L164"></a> 164         <strong class="reserved">if</strong> (end2 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L165" name="L165"></a> 165             s2 = end2 + 1;
<a id="L166" name="L166"></a> 166         <strong class="reserved">else</strong>
<a id="L167" name="L167"></a> 167             s2 = <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>;
<a id="L168" name="L168"></a> 168 
<a id="L169" name="L169"></a> 169     <em class="brace">}</em> <strong class="reserved">while</strong> (res == 0 &amp;&amp; ((s1 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) || (s2 != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)));
<a id="L170" name="L170"></a> 170 
<a id="L171" name="L171"></a> 171     <a href="../S/16.html#L82" title="Defined at 82 in src/launcher/jli_util.c.">JLI_MemFree</a>(m1);
<a id="L172" name="L172"></a> 172     <a href="../S/16.html#L82" title="Defined at 82 in src/launcher/jli_util.c.">JLI_MemFree</a>(m2);
<a id="L173" name="L173"></a> 173     <strong class="reserved">return</strong> (res);
<a id="L174" name="L174"></a> 174 <em class="brace">}</em>
<a id="L175" name="L175"></a> 175 
<div class="comment">
       Return true if this simple-element (as defined in JSR 56) forms
       an acceptable match.
       JSR 56 is modified by the Java Web Start <rel> Developer Guide
       where it is stated "... Java Web Start will not consider an installed
       non-FCS (i.e., milestone) JRE as a match. ... a JRE from Sun
       Microsystems, Inc., is by convention a non-FCS (milestone) JRE
       if there is a dash (-) in the version string."
       An undocumented caveat to the above is that an exact match with a
       hyphen is accepted as a development extension.
       These modifications are addressed by the specific comparisons
       for releases with hyphens.</rel></div>
<a id="L192" name="L192"></a> 192 <strong class="reserved">static</strong> <strong class="reserved">int</strong>
<a id="L193" name="L193"></a> 193 <a href="../S/14.html#L224" title="Referred from 224 in src/launcher/version_comp.c.">acceptable_simple_element</a>(<strong class="reserved">const</strong> <strong class="reserved">char</strong> *<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, <strong class="reserved">char</strong> *simple_element)
<a id="L194" name="L194"></a> 194 <em class="brace">{</em>
<a id="L195" name="L195"></a> 195     <strong class="reserved">char</strong>        *modifier;
<a id="L196" name="L196"></a> 196     modifier = simple_element + <a href="../S/9.html#L49" title="Defined at 49 in src/launcher/jli_util.h.">JLI_StrLen</a>(simple_element) - 1;
<a id="L197" name="L197"></a> 197     <strong class="reserved">if</strong> (*modifier == '*') <em class="brace">{</em>
<a id="L198" name="L198"></a> 198         *modifier = '\0';
<a id="L199" name="L199"></a> 199         <strong class="reserved">if</strong> (<a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, '-'))
<a id="L200" name="L200"></a> 200             <strong class="reserved">return</strong> ((<a href="../S/9.html#L52" title="Defined at 52 in src/launcher/jli_util.h.">JLI_StrCmp</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, simple_element) == 0)?1:0);
<a id="L201" name="L201"></a> 201         <strong class="reserved">return</strong> ((<a href="../S/14.html#L96" title="Defined at 96 in src/launcher/version_comp.c.">JLI_PrefixVersionId</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, simple_element) == 0)?1:0);
<a id="L202" name="L202"></a> 202     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (*modifier == '+') <em class="brace">{</em>
<a id="L203" name="L203"></a> 203         *modifier = '\0';
<a id="L204" name="L204"></a> 204         <strong class="reserved">if</strong> (<a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, '-'))
<a id="L205" name="L205"></a> 205             <strong class="reserved">return</strong> ((<a href="../S/9.html#L52" title="Defined at 52 in src/launcher/jli_util.h.">JLI_StrCmp</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, simple_element) == 0)?1:0);
<a id="L206" name="L206"></a> 206         <strong class="reserved">return</strong> ((<a href="../S/14.html#L136" title="Defined at 136 in src/launcher/version_comp.c.">JLI_ExactVersionId</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, simple_element) &gt;= 0)?1:0);
<a id="L207" name="L207"></a> 207     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L208" name="L208"></a> 208         <strong class="reserved">return</strong> ((<a href="../S/14.html#L136" title="Defined at 136 in src/launcher/version_comp.c.">JLI_ExactVersionId</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, simple_element) == 0)?1:0);
<a id="L209" name="L209"></a> 209     <em class="brace">}</em>
<a id="L210" name="L210"></a> 210 <em class="brace">}</em>
<a id="L211" name="L211"></a> 211 
<div class="comment">
       Return true if this element (as defined in JSR 56) forms
       an acceptable match. An element is the intersection (and)
       of multiple simple-elements.</div>
<a id="L217" name="L217"></a> 217 <strong class="reserved">static</strong> <strong class="reserved">int</strong>
<a id="L218" name="L218"></a> 218 <a href="../S/14.html#L248" title="Referred from 248 in src/launcher/version_comp.c.">acceptable_element</a>(<strong class="reserved">const</strong> <strong class="reserved">char</strong> *<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, <strong class="reserved">char</strong> *<a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>)
<a id="L219" name="L219"></a> 219 <em class="brace">{</em>
<a id="L220" name="L220"></a> 220     <strong class="reserved">char</strong>        *<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>;
<a id="L221" name="L221"></a> 221     <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L222" name="L222"></a> 222         <strong class="reserved">if</strong> ((<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = <a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(<a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>, '&amp;')) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L223" name="L223"></a> 223             *<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = '\0';
<a id="L224" name="L224"></a> 224         <strong class="reserved">if</strong> (!<a href="../S/14.html#L193" title="Defined at 193 in src/launcher/version_comp.c.">acceptable_simple_element</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>))
<a id="L225" name="L225"></a> 225             <strong class="reserved">return</strong> (0);
<a id="L226" name="L226"></a> 226         <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L227" name="L227"></a> 227             <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a> = <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> + 1;
<a id="L228" name="L228"></a> 228     <em class="brace">}</em> <strong class="reserved">while</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L229" name="L229"></a> 229     <strong class="reserved">return</strong> (1);
<a id="L230" name="L230"></a> 230 <em class="brace">}</em>
<a id="L231" name="L231"></a> 231 
<div class="comment">
       Checks if release is acceptable by the specification version-string.
       Return true if this version-string (as defined in JSR 56) forms
       an acceptable match. A version-string is the union (or) of multiple
       elements.</div>
<a id="L238" name="L238"></a> 238 <strong class="reserved">int</strong>
<a id="L239" name="L239"></a> 239 <a href="../R/4144.html" title="Multiple referred from 3 places.">JLI_AcceptableRelease</a>(<strong class="reserved">const</strong> <strong class="reserved">char</strong> *<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, <strong class="reserved">char</strong> *version_string)
<a id="L240" name="L240"></a> 240 <em class="brace">{</em>
<a id="L241" name="L241"></a> 241     <strong class="reserved">char</strong>        *vs;
<a id="L242" name="L242"></a> 242     <strong class="reserved">char</strong>        *m1;
<a id="L243" name="L243"></a> 243     <strong class="reserved">char</strong>        *<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>;
<a id="L244" name="L244"></a> 244     m1 = vs = <a href="../S/16.html#L67" title="Defined at 67 in src/launcher/jli_util.c.">JLI_StringDup</a>(version_string);
<a id="L245" name="L245"></a> 245     <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L246" name="L246"></a> 246         <strong class="reserved">if</strong> ((<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = <a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(vs, ' ')) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L247" name="L247"></a> 247             *<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = '\0';
<a id="L248" name="L248"></a> 248         <strong class="reserved">if</strong> (<a href="../S/14.html#L218" title="Defined at 218 in src/launcher/version_comp.c.">acceptable_element</a>(<a href="../D/30632.html" title="Multiple defined in 19 places.">release</a>, vs)) <em class="brace">{</em>
<a id="L249" name="L249"></a> 249             <a href="../S/16.html#L82" title="Defined at 82 in src/launcher/jli_util.c.">JLI_MemFree</a>(m1);
<a id="L250" name="L250"></a> 250             <strong class="reserved">return</strong> (1);
<a id="L251" name="L251"></a> 251         <em class="brace">}</em>
<a id="L252" name="L252"></a> 252         <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L253" name="L253"></a> 253             vs = <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> + 1;
<a id="L254" name="L254"></a> 254     <em class="brace">}</em> <strong class="reserved">while</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L255" name="L255"></a> 255     <a href="../S/16.html#L82" title="Defined at 82 in src/launcher/jli_util.c.">JLI_MemFree</a>(m1);
<a id="L256" name="L256"></a> 256     <strong class="reserved">return</strong> (0);
<a id="L257" name="L257"></a> 257 <em class="brace">}</em>
<a id="L258" name="L258"></a> 258 
<div class="comment">
       Return true if this is a valid simple-element (as defined in JSR 56).
       The official grammar for a simple-element is:
               simple-element  ::= version-id | version-id modifier
               modifier        ::= '+' | '*'
               version-id      ::= string ( separator  string )*
               string          ::= char ( char )*
               char            ::= Any ASCII character except a space, an
                                   ampersand, a separator or a modifier
               separator       ::= '.' | '-' | '_'
       However, for efficiency, it is time to abandon the top down parser
       implementation.  After deleting the potential trailing modifier, we
       are left with a version-id.
       Note that a valid version-id has three simple properties:
       1) Doesn't contain a space, an ampersand or a modifier.
       2) Doesn't begin or end with a separator.
       3) Doesn't contain two adjacent separators.
       Any other line noise constitutes a valid version-id.</div>
<a id="L286" name="L286"></a> 286 <strong class="reserved">static</strong> <strong class="reserved">int</strong>
<a id="L287" name="L287"></a> 287 <a href="../S/14.html#L325" title="Referred from 325 in src/launcher/version_comp.c.">valid_simple_element</a>(<strong class="reserved">char</strong> *simple_element)
<a id="L288" name="L288"></a> 288 <em class="brace">{</em>
<a id="L289" name="L289"></a> 289     <strong class="reserved">char</strong>        *<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>;
<a id="L290" name="L290"></a> 290     size_t      len;
<a id="L291" name="L291"></a> 291 
<a id="L292" name="L292"></a> 292     <strong class="reserved">if</strong> ((simple_element == <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) || ((len = <a href="../S/9.html#L49" title="Defined at 49 in src/launcher/jli_util.h.">JLI_StrLen</a>(simple_element)) == 0))
<a id="L293" name="L293"></a> 293         <strong class="reserved">return</strong> (0);
<a id="L294" name="L294"></a> 294     <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = simple_element + len - 1;
<a id="L295" name="L295"></a> 295     <strong class="reserved">if</strong> (*<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> == '*' || *<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> == '+') <em class="brace">{</em>
<a id="L296" name="L296"></a> 296         <strong class="reserved">if</strong> (--len == 0)
<a id="L297" name="L297"></a> 297             <strong class="reserved">return</strong> (0);
<a id="L298" name="L298"></a> 298         *<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>-- = '\0';
<a id="L299" name="L299"></a> 299     <em class="brace">}</em>
<a id="L300" name="L300"></a> 300     <strong class="reserved">if</strong> (<a href="../S/9.html#L60" title="Defined at 60 in src/launcher/jli_util.h.">JLI_StrPBrk</a>(simple_element, " &amp;+*") != <div class="comment">
/* Property #1 */</div>
<a id="L301" name="L301"></a> 301         <strong class="reserved">return</strong> (0);
<a id="L302" name="L302"></a> 302     <strong class="reserved">if</strong> ((<a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(".-_", *simple_element) != <div class="comment">
/* Property #2 */</div>
<a id="L303" name="L303"></a> 303       (<a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(".-_", *<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>))
<a id="L304" name="L304"></a> 304         <strong class="reserved">return</strong> (0);
<a id="L305" name="L305"></a> 305     <strong class="reserved">for</strong> (; simple_element != <div class="comment">
/* Property #3 */</div>
<a id="L306" name="L306"></a> 306         <strong class="reserved">if</strong> ((<a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(".-_", *simple_element) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) &amp;&amp;
<a id="L307" name="L307"></a> 307           (<a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(".-_", *(simple_element + 1)) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>))
<a id="L308" name="L308"></a> 308             <strong class="reserved">return</strong> (0);
<a id="L309" name="L309"></a> 309     <strong class="reserved">return</strong> (1);
<a id="L310" name="L310"></a> 310 <em class="brace">}</em>
<a id="L311" name="L311"></a> 311 
<div class="comment">
       Return true if this is a valid element (as defined in JSR 56).
       An element is the intersection (and) of multiple simple-elements.</div>
<a id="L316" name="L316"></a> 316 <strong class="reserved">static</strong> <strong class="reserved">int</strong>
<a id="L317" name="L317"></a> 317 <a href="../S/14.html#L348" title="Referred from 348 in src/launcher/version_comp.c.">valid_element</a>(<strong class="reserved">char</strong> *<a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>)
<a id="L318" name="L318"></a> 318 <em class="brace">{</em>
<a id="L319" name="L319"></a> 319     <strong class="reserved">char</strong>        *<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>;
<a id="L320" name="L320"></a> 320     <strong class="reserved">if</strong> ((<a href="../D/15287.html" title="Multiple defined in 20 places.">element</a> == <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) || (<a href="../S/9.html#L49" title="Defined at 49 in src/launcher/jli_util.h.">JLI_StrLen</a>(<a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>) == 0))
<a id="L321" name="L321"></a> 321         <strong class="reserved">return</strong> (0);
<a id="L322" name="L322"></a> 322     <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L323" name="L323"></a> 323         <strong class="reserved">if</strong> ((<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = <a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(<a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>, '&amp;')) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L324" name="L324"></a> 324             *<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = '\0';
<a id="L325" name="L325"></a> 325         <strong class="reserved">if</strong> (!<a href="../S/14.html#L287" title="Defined at 287 in src/launcher/version_comp.c.">valid_simple_element</a>(<a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>))
<a id="L326" name="L326"></a> 326             <strong class="reserved">return</strong> (0);
<a id="L327" name="L327"></a> 327         <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L328" name="L328"></a> 328             <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a> = <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> + 1;
<a id="L329" name="L329"></a> 329     <em class="brace">}</em> <strong class="reserved">while</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L330" name="L330"></a> 330     <strong class="reserved">return</strong> (1);
<a id="L331" name="L331"></a> 331 <em class="brace">}</em>
<a id="L332" name="L332"></a> 332 
<div class="comment">
       Validates a version string by the extended JSR 56 grammar.</div>
<a id="L336" name="L336"></a> 336 <strong class="reserved">int</strong>
<a id="L337" name="L337"></a> 337 <a href="../R/4180.html" title="Multiple referred from 2 places.">JLI_ValidVersionString</a>(<strong class="reserved">char</strong> *version_string)
<a id="L338" name="L338"></a> 338 <em class="brace">{</em>
<a id="L339" name="L339"></a> 339     <strong class="reserved">char</strong>        *vs;
<a id="L340" name="L340"></a> 340     <strong class="reserved">char</strong>        *m1;
<a id="L341" name="L341"></a> 341     <strong class="reserved">char</strong>        *<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>;
<a id="L342" name="L342"></a> 342     <strong class="reserved">if</strong> ((version_string == <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) || (<a href="../S/9.html#L49" title="Defined at 49 in src/launcher/jli_util.h.">JLI_StrLen</a>(version_string) == 0))
<a id="L343" name="L343"></a> 343         <strong class="reserved">return</strong> (0);
<a id="L344" name="L344"></a> 344     m1 = vs = <a href="../S/16.html#L67" title="Defined at 67 in src/launcher/jli_util.c.">JLI_StringDup</a>(version_string);
<a id="L345" name="L345"></a> 345     <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L346" name="L346"></a> 346         <strong class="reserved">if</strong> ((<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = <a href="../S/9.html#L50" title="Defined at 50 in src/launcher/jli_util.h.">JLI_StrChr</a>(vs, ' ')) != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L347" name="L347"></a> 347             *<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = '\0';
<a id="L348" name="L348"></a> 348         <strong class="reserved">if</strong> (!<a href="../S/14.html#L317" title="Defined at 317 in src/launcher/version_comp.c.">valid_element</a>(vs)) <em class="brace">{</em>
<a id="L349" name="L349"></a> 349             <a href="../S/16.html#L82" title="Defined at 82 in src/launcher/jli_util.c.">JLI_MemFree</a>(m1);
<a id="L350" name="L350"></a> 350             <strong class="reserved">return</strong> (0);
<a id="L351" name="L351"></a> 351         <em class="brace">}</em>
<a id="L352" name="L352"></a> 352         <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L353" name="L353"></a> 353             vs = <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> + 1;
<a id="L354" name="L354"></a> 354     <em class="brace">}</em> <strong class="reserved">while</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> != <a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>);
<a id="L355" name="L355"></a> 355     <a href="../S/16.html#L82" title="Defined at 82 in src/launcher/jli_util.c.">JLI_MemFree</a>(m1);
<a id="L356" name="L356"></a> 356     <strong class="reserved">return</strong> (1);
<a id="L357" name="L357"></a> 357 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L60">[^]</a><a href="#L337">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>