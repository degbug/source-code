<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/awt/image/ColorConvertOp.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L229">[^]</a><a href="#L1097">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L229" title="Defined at 229.">getICC_Profiles</a></li>
<li><a href="#L254" title="Defined at 254.">filter</a></li>
<li><a href="#L298" title="Defined at 298.">ICCBIFilter</a></li>
<li><a href="#L360" title="Defined at 360.">updateBITransform</a></li>
<li><a href="#L470" title="Defined at 470.">filter</a></li>
<li><a href="#L586" title="Defined at 586.">getBounds2D</a></li>
<li><a href="#L598" title="Defined at 598.">getBounds2D</a></li>
<li><a href="#L618" title="Defined at 618.">createCompatibleDestImage</a></li>
<li><a href="#L640" title="Defined at 640.">createCompatibleDestImage</a></li>
<li><a href="#L679" title="Defined at 679.">createCompatibleDestRaster</a></li>
<li><a href="#L719" title="Defined at 719.">getPoint2D</a></li>
<li><a href="#L732" title="Defined at 732.">getRenderingIntent</a></li>
<li><a href="#L752" title="Defined at 752.">getRenderingHints</a></li>
<li><a href="#L756" title="Defined at 756.">nonICCBIFilter</a></li>
<li><a href="#L950" title="Defined at 950.">nonICCRasterFilter</a></li>
<li><a href="#L1064" title="Defined at 1064.">getMinMaxValsFromProfiles</a></li>
<li><a href="#L1078" title="Defined at 1078.">setMinMax</a></li>
<li><a href="#L1097" title="Defined at 1097.">getMinMaxValsFromColorSpaces</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<div class="comment">
 *********************************************************************
 *********************************************************************
 *********************************************************************
 ** COPYRIGHT (c) Eastman Kodak Company, 1997                      ***
 ** As  an unpublished  work pursuant to Title 17 of the United    ***
 ** States Code.  All rights reserved.                             ***
 *********************************************************************
 *********************************************************************
 *********************************************************************</div>
<a id="L36" name="L36"></a>  36 
<a id="L37" name="L37"></a>  37 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.awt.image;
<a id="L38" name="L38"></a>  38 
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> java.awt.Point;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.awt.Graphics2D;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> java.awt.color.*;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> sun.java2d.cmm.ColorTransform;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> sun.java2d.cmm.CMSManager;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> sun.java2d.cmm.ProfileDeferralMgr;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> sun.java2d.cmm.PCMM;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> java.awt.geom.Rectangle2D;
<a id="L47" name="L47"></a>  47 <strong class="reserved">import</strong> java.awt.geom.Point2D;
<a id="L48" name="L48"></a>  48 <strong class="reserved">import</strong> java.awt.RenderingHints;
<a id="L49" name="L49"></a>  49 
<div class="comment">
  This class performs a pixel-by-pixel color conversion of the data in
  the source image.  The resulting color values are scaled to the precision
  of the destination image.  Color conversion can be specified
  via an array of ColorSpace objects or an array of ICC_Profile objects.
  <p>
  If the source is a BufferedImage with premultiplied alpha, the
  color components are divided by the alpha component before color conversion.
  If the destination is a BufferedImage with premultiplied alpha, the
  color components are multiplied by the alpha component after conversion.
  Rasters are treated as having no alpha channel, i.e. all bands are
  color bands.
  </p><p>
  If a RenderingHints object is specified in the constructor, the
  color rendering hint and the dithering hint may be used to control
  color conversion.
  </p><p>
  Note that Source and Destination may be the same object.
  @see java.awt.RenderingHints#KEY_COLOR_RENDERING
  @see java.awt.RenderingHints#KEY_DITHERING</p></div>
<a id="L71" name="L71"></a>  71 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/1496.html" title="Multiple referred from 13 places.">ColorConvertOp</a> <strong class="reserved">implements</strong> <a href="../S/2237.html#L61" title="Defined at 61 in src/java/awt/image/BufferedImageOp.java.">BufferedImageOp</a>, <a href="../S/2234.html#L52" title="Defined at 52 in src/java/awt/image/RasterOp.java.">RasterOp</a> <em class="brace">{</em>
<a id="L72" name="L72"></a>  72     <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>[]    profileList;
<a id="L73" name="L73"></a>  73     <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a>[]     CSList;
<a id="L74" name="L74"></a>  74     ColorTransform    thisTransform, thisRasterTransform;
<a id="L75" name="L75"></a>  75     <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>      thisSrcProfile, thisDestProfile;
<a id="L76" name="L76"></a>  76     <a href="../S/2116.html#L82" title="Defined at 82 in src/java/awt/RenderingHints.java.">RenderingHints</a>   hints;
<a id="L77" name="L77"></a>  77     <strong class="reserved">boolean</strong>          gotProfiles;
<a id="L78" name="L78"></a>  78     <strong class="reserved">float</strong>[]          srcMinVals, srcMaxVals, dstMinVals, dstMaxVals;
<a id="L79" name="L79"></a>  79 
<div class="comment">
     /* the class initializer */</div>
<a id="L81" name="L81"></a>  81     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L82" name="L82"></a>  82         <strong class="reserved">if</strong> (ProfileDeferralMgr.deferring) <em class="brace">{</em>
<a id="L83" name="L83"></a>  83             ProfileDeferralMgr.activateProfiles();
<a id="L84" name="L84"></a>  84         <em class="brace">}</em>
<a id="L85" name="L85"></a>  85     <em class="brace">}</em>
<a id="L86" name="L86"></a>  86 
<div class="comment">
      Constructs a new ColorConvertOp which will convert
      from a source color space to a destination color space.
      The RenderingHints argument may be null.
      This Op can be used only with BufferedImages, and will convert
      directly from the ColorSpace of the source image to that of the
      destination.  The destination argument of the filter method
      cannot be specified as null.
      @param hints the <code>RenderingHints</code> object used to control
             the color conversion, or <code>null</code></div>
<a id="L98" name="L98"></a>  98     <strong class="reserved">public</strong> ColorConvertOp (<a href="../S/2116.html#L82" title="Defined at 82 in src/java/awt/RenderingHints.java.">RenderingHints</a> hints)
<a id="L99" name="L99"></a>  99     <em class="brace">{</em>
<a id="L100" name="L100"></a> 100         profileList = <strong class="reserved">new</strong> <div class="comment">
];    /* 0 length list */</div>
<a id="L101" name="L101"></a> 101         <strong class="reserved">this</strong>.hints  = hints;
<a id="L102" name="L102"></a> 102     <em class="brace">}</em>
<a id="L103" name="L103"></a> 103 
<div class="comment">
      Constructs a new ColorConvertOp from a ColorSpace object.
      The RenderingHints argument may be null.  This
      Op can be used only with BufferedImages, and is primarily useful
      when the {@link #filter(BufferedImage, BufferedImage) filter}
      method is invoked with a destination argument of null.
      In that case, the ColorSpace defines the destination color space
      for the destination created by the filter method.  Otherwise, the
      ColorSpace defines an intermediate space to which the source is
      converted before being converted to the destination space.
      @param cspace defines the destination <code>ColorSpace</code> or an
             intermediate <code>ColorSpace</code>
      @param hints the <code>RenderingHints</code> object used to control
             the color conversion, or <code>null</code>
      @throws NullPointerException if cspace is null</div>
<a id="L120" name="L120"></a> 120     <strong class="reserved">public</strong> ColorConvertOp (<a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> cspace, <a href="../S/2116.html#L82" title="Defined at 82 in src/java/awt/RenderingHints.java.">RenderingHints</a> hints)
<a id="L121" name="L121"></a> 121     <em class="brace">{</em>
<a id="L122" name="L122"></a> 122         <strong class="reserved">if</strong> (cspace == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L123" name="L123"></a> 123             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("ColorSpace cannot be null");
<a id="L124" name="L124"></a> 124         <em class="brace">}</em>
<a id="L125" name="L125"></a> 125         <strong class="reserved">if</strong> (cspace <strong class="reserved">instanceof</strong> <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) <em class="brace">{</em>
<a id="L126" name="L126"></a> 126             profileList = <strong class="reserved">new</strong> <div class="comment">
];    /* 1 profile in the list */</div>
<a id="L127" name="L127"></a> 127 
<a id="L128" name="L128"></a> 128             profileList [0] = ((<a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) cspace).<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L129" name="L129"></a> 129         <em class="brace">}</em>
<a id="L130" name="L130"></a> 130         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L131" name="L131"></a> 131             CSList = <strong class="reserved">new</strong> <div class="comment">
]; /* non-ICC case: 1 ColorSpace in list */</div>
<a id="L132" name="L132"></a> 132             CSList[0] = cspace;
<a id="L133" name="L133"></a> 133         <em class="brace">}</em>
<a id="L134" name="L134"></a> 134         <strong class="reserved">this</strong>.hints  = hints;
<a id="L135" name="L135"></a> 135     <em class="brace">}</em>
<a id="L136" name="L136"></a> 136 
<a id="L137" name="L137"></a> 137 
<div class="comment">
      Constructs a new ColorConvertOp from two ColorSpace objects.
      The RenderingHints argument may be null.
      This Op is primarily useful for calling the filter method on
      Rasters, in which case the two ColorSpaces define the operation
      to be performed on the Rasters.  In that case, the number of bands
      in the source Raster must match the number of components in
      srcCspace, and the number of bands in the destination Raster
      must match the number of components in dstCspace.  For BufferedImages,
      the two ColorSpaces define intermediate spaces through which the
      source is converted before being converted to the destination space.
      @param srcCspace the source <code>ColorSpace</code>
      @param dstCspace the destination <code>ColorSpace</code>
      @param hints the <code>RenderingHints</code> object used to control
             the color conversion, or <code>null</code>
      @throws NullPointerException if either srcCspace or dstCspace is null</div>
<a id="L155" name="L155"></a> 155     <strong class="reserved">public</strong> ColorConvertOp(<a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> srcCspace, <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> dstCspace,
<a id="L156" name="L156"></a> 156                            <a href="../S/2116.html#L82" title="Defined at 82 in src/java/awt/RenderingHints.java.">RenderingHints</a> hints)
<a id="L157" name="L157"></a> 157     <em class="brace">{</em>
<a id="L158" name="L158"></a> 158         <strong class="reserved">if</strong> ((srcCspace == <strong class="reserved">null</strong>) || (dstCspace == <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L159" name="L159"></a> 159             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("ColorSpaces cannot be null");
<a id="L160" name="L160"></a> 160         <em class="brace">}</em>
<a id="L161" name="L161"></a> 161         <strong class="reserved">if</strong> ((srcCspace <strong class="reserved">instanceof</strong> <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) &amp;&amp;
<a id="L162" name="L162"></a> 162             (dstCspace <strong class="reserved">instanceof</strong> <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>)) <em class="brace">{</em>
<a id="L163" name="L163"></a> 163             profileList = <strong class="reserved">new</strong> <div class="comment">
];    /* 2 profiles in the list */</div>
<a id="L164" name="L164"></a> 164 
<a id="L165" name="L165"></a> 165             profileList [0] = ((<a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) srcCspace).<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L166" name="L166"></a> 166             profileList [1] = ((<a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) dstCspace).<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L167" name="L167"></a> 167 
<a id="L168" name="L168"></a> 168             <a href="../S/2278.html#L1097" title="Defined at 1097 in src/java/awt/image/ColorConvertOp.java.">getMinMaxValsFromColorSpaces</a>(srcCspace, dstCspace);
<a id="L169" name="L169"></a> 169         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<div class="comment">
             /* non-ICC case: 2 ColorSpaces in list */</div>
<a id="L171" name="L171"></a> 171             CSList = <strong class="reserved">new</strong> <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a>[2];
<a id="L172" name="L172"></a> 172             CSList[0] = srcCspace;
<a id="L173" name="L173"></a> 173             CSList[1] = dstCspace;
<a id="L174" name="L174"></a> 174         <em class="brace">}</em>
<a id="L175" name="L175"></a> 175         <strong class="reserved">this</strong>.hints  = hints;
<a id="L176" name="L176"></a> 176     <em class="brace">}</em>
<a id="L177" name="L177"></a> 177 
<a id="L178" name="L178"></a> 178 
<div class="comment">
      Constructs a new ColorConvertOp from an array of ICC_Profiles.
      The RenderingHints argument may be null.
      The sequence of profiles may include profiles that represent color
      spaces, profiles that represent effects, etc.  If the whole sequence
      does not represent a well-defined color conversion, an exception is
      thrown.
      <p>For BufferedImages, if the ColorSpace
      of the source BufferedImage does not match the requirements of the
      first profile in the array,
      the first conversion is to an appropriate ColorSpace.
      If the requirements of the last profile in the array are not met
      by the ColorSpace of the destination BufferedImage,
      the last conversion is to the destination's ColorSpace.
      </p><p>For Rasters, the number of bands in the source Raster must match
      the requirements of the first profile in the array, and the
      number of bands in the destination Raster must match the requirements
      of the last profile in the array.  The array must have at least two
      elements or calling the filter method for Rasters will throw an
      IllegalArgumentException.
      @param profiles the array of <code>ICC_Profile</code> objects
      @param hints the <code>RenderingHints</code> object used to control
             the color conversion, or <code>null</code>
      @exception IllegalArgumentException when the profile sequence does not
                  specify a well-defined color conversion
      @exception NullPointerException if profiles is null</p></div>
<a id="L206" name="L206"></a> 206     <strong class="reserved">public</strong> ColorConvertOp (<a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>[] profiles, <a href="../S/2116.html#L82" title="Defined at 82 in src/java/awt/RenderingHints.java.">RenderingHints</a> hints)
<a id="L207" name="L207"></a> 207     <em class="brace">{</em>
<a id="L208" name="L208"></a> 208         <strong class="reserved">if</strong> (profiles == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L209" name="L209"></a> 209             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("Profiles cannot be null");
<a id="L210" name="L210"></a> 210         <em class="brace">}</em>
<a id="L211" name="L211"></a> 211         gotProfiles = <strong class="reserved">true</strong>;
<a id="L212" name="L212"></a> 212         profileList = <strong class="reserved">new</strong> <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>[profiles.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L213" name="L213"></a> 213         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i1 = 0; i1 &lt; profiles.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i1++) <em class="brace">{</em>
<a id="L214" name="L214"></a> 214             profileList[i1] = profiles[i1];
<a id="L215" name="L215"></a> 215         <em class="brace">}</em>
<a id="L216" name="L216"></a> 216         <strong class="reserved">this</strong>.hints  = hints;
<a id="L217" name="L217"></a> 217     <em class="brace">}</em>
<a id="L218" name="L218"></a> 218 
<a id="L219" name="L219"></a> 219 
<div class="comment">
      Returns the array of ICC_Profiles used to construct this ColorConvertOp.
      Returns null if the ColorConvertOp was not constructed from such an
      array.
      @return the array of <code>ICC_Profile</code> objects of this
              <code>ColorConvertOp</code>, or <code>null</code> if this
              <code>ColorConvertOp</code> was not constructed with an
              array of <code>ICC_Profile</code> objects.</div>
<a id="L229" name="L229"></a> 229     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>[] getICC_Profiles() <em class="brace">{</em>
<a id="L230" name="L230"></a> 230         <strong class="reserved">if</strong> (gotProfiles) <em class="brace">{</em>
<a id="L231" name="L231"></a> 231             <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>[] profiles = <strong class="reserved">new</strong> <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>[profileList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L232" name="L232"></a> 232             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i1 = 0; i1 &lt; profileList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i1++) <em class="brace">{</em>
<a id="L233" name="L233"></a> 233                 profiles[i1] = profileList[i1];
<a id="L234" name="L234"></a> 234             <em class="brace">}</em>
<a id="L235" name="L235"></a> 235             <strong class="reserved">return</strong> profiles;
<a id="L236" name="L236"></a> 236         <em class="brace">}</em>
<a id="L237" name="L237"></a> 237         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L238" name="L238"></a> 238     <em class="brace">}</em>
<a id="L239" name="L239"></a> 239 
<div class="comment">
      ColorConverts the source BufferedImage.
      If the destination image is null,
      a BufferedImage will be created with an appropriate ColorModel.
      @param src the source <code>BufferedImage</code> to be converted
      @param dest the destination <code>BufferedImage</code>,
             or <code>null</code>
      @return <code>dest</code> color converted from <code>src</code>
              or a new, converted <code>BufferedImage</code>
              if <code>dest</code> is <code>null</code>
      @exception IllegalArgumentException if dest is null and this op was
                  constructed using the constructor which takes only a
                  RenderingHints argument, since the operation is ill defined.</div>
<a id="L254" name="L254"></a> 254     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> <a href="../R/14321.html" title="Multiple referred from 472 places.">filter</a>(<a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> src, <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> dest) <em class="brace">{</em>
<a id="L255" name="L255"></a> 255         <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> srcColorSpace, destColorSpace;
<a id="L256" name="L256"></a> 256         <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> savdest = <strong class="reserved">null</strong>;
<a id="L257" name="L257"></a> 257 
<a id="L258" name="L258"></a> 258         <strong class="reserved">if</strong> (src.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>() <strong class="reserved">instanceof</strong> <a href="../S/2242.html#L125" title="Defined at 125 in src/java/awt/image/IndexColorModel.java.">IndexColorModel</a>) <em class="brace">{</em>
<a id="L259" name="L259"></a> 259             <a href="../S/2242.html#L125" title="Defined at 125 in src/java/awt/image/IndexColorModel.java.">IndexColorModel</a> icm = (<a href="../S/2242.html#L125" title="Defined at 125 in src/java/awt/image/IndexColorModel.java.">IndexColorModel</a>) src.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>();
<a id="L260" name="L260"></a> 260             src = icm.<a href="../S/2242.html#L1425" title="Defined at 1425 in src/java/awt/image/IndexColorModel.java.">convertToIntDiscrete</a>(src.<a href="../D/21845.html" title="Multiple defined in 8 places.">getRaster</a>(), <strong class="reserved">true</strong>);
<a id="L261" name="L261"></a> 261         <em class="brace">}</em>
<a id="L262" name="L262"></a> 262         srcColorSpace = src.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>().<a href="../D/17792.html" title="Multiple defined in 3 places.">getColorSpace</a>();
<a id="L263" name="L263"></a> 263         <strong class="reserved">if</strong> (dest != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L264" name="L264"></a> 264             <strong class="reserved">if</strong> (dest.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>() <strong class="reserved">instanceof</strong> <a href="../S/2242.html#L125" title="Defined at 125 in src/java/awt/image/IndexColorModel.java.">IndexColorModel</a>) <em class="brace">{</em>
<a id="L265" name="L265"></a> 265                 savdest = dest;
<a id="L266" name="L266"></a> 266                 dest = <strong class="reserved">null</strong>;
<a id="L267" name="L267"></a> 267                 destColorSpace = <strong class="reserved">null</strong>;
<a id="L268" name="L268"></a> 268             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L269" name="L269"></a> 269                 destColorSpace = dest.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>().<a href="../D/17792.html" title="Multiple defined in 3 places.">getColorSpace</a>();
<a id="L270" name="L270"></a> 270             <em class="brace">}</em>
<a id="L271" name="L271"></a> 271         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L272" name="L272"></a> 272             destColorSpace = <strong class="reserved">null</strong>;
<a id="L273" name="L273"></a> 273         <em class="brace">}</em>
<a id="L274" name="L274"></a> 274 
<a id="L275" name="L275"></a> 275         <strong class="reserved">if</strong> ((CSList != <strong class="reserved">null</strong>) ||
<a id="L276" name="L276"></a> 276             (!(srcColorSpace <strong class="reserved">instanceof</strong> <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>)) ||
<a id="L277" name="L277"></a> 277             ((dest != <strong class="reserved">null</strong>) &amp;&amp;
<a id="L278" name="L278"></a> 278              (!(destColorSpace <strong class="reserved">instanceof</strong> <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>)))) <em class="brace">{</em>
<div class="comment">
             /* non-ICC case */</div>
<a id="L280" name="L280"></a> 280             dest = <a href="../S/2278.html#L756" title="Defined at 756 in src/java/awt/image/ColorConvertOp.java.">nonICCBIFilter</a>(src, srcColorSpace, dest, destColorSpace);
<a id="L281" name="L281"></a> 281         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L282" name="L282"></a> 282             dest = <a href="../S/2278.html#L298" title="Defined at 298 in src/java/awt/image/ColorConvertOp.java.">ICCBIFilter</a>(src, srcColorSpace, dest, destColorSpace);
<a id="L283" name="L283"></a> 283         <em class="brace">}</em>
<a id="L284" name="L284"></a> 284 
<a id="L285" name="L285"></a> 285         <strong class="reserved">if</strong> (savdest != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L286" name="L286"></a> 286             <a href="../S/2098.html#L407" title="Defined at 407 in src/java/awt/Graphics2D.java.">Graphics2D</a> big = savdest.<a href="../D/13920.html" title="Multiple defined in 4 places.">createGraphics</a>();
<a id="L287" name="L287"></a> 287             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L288" name="L288"></a> 288                 big.<a href="../D/15196.html" title="Multiple defined in 16 places.">drawImage</a>(dest, 0, 0, <strong class="reserved">null</strong>);
<a id="L289" name="L289"></a> 289             <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L290" name="L290"></a> 290                 big.<a href="../D/14970.html" title="Multiple defined in 65 places.">dispose</a>();
<a id="L291" name="L291"></a> 291             <em class="brace">}</em>
<a id="L292" name="L292"></a> 292             <strong class="reserved">return</strong> savdest;
<a id="L293" name="L293"></a> 293         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L294" name="L294"></a> 294             <strong class="reserved">return</strong> dest;
<a id="L295" name="L295"></a> 295         <em class="brace">}</em>
<a id="L296" name="L296"></a> 296     <em class="brace">}</em>
<a id="L297" name="L297"></a> 297 
<a id="L298" name="L298"></a> 298     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> <a href="../S/2278.html#L282" title="Referred from 282 in src/java/awt/image/ColorConvertOp.java.">ICCBIFilter</a>(<a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> src,
<a id="L299" name="L299"></a> 299                                             <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> srcColorSpace,
<a id="L300" name="L300"></a> 300                                             <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> dest,
<a id="L301" name="L301"></a> 301                                             <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> destColorSpace) <em class="brace">{</em>
<a id="L302" name="L302"></a> 302     <strong class="reserved">int</strong>              nProfiles = profileList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L303" name="L303"></a> 303     <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>      srcProfile = <strong class="reserved">null</strong>, destProfile = <strong class="reserved">null</strong>;
<a id="L304" name="L304"></a> 304 
<a id="L305" name="L305"></a> 305         srcProfile = ((<a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) srcColorSpace).<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L306" name="L306"></a> 306 
<a id="L307" name="L307"></a> 307         <strong class="reserved">if</strong> (dest == <strong class="reserved">null</strong>) 
<div class="comment">
 last profile in the list defines
                                      the output color space </div>
<a id="L309" name="L309"></a> 309             <strong class="reserved">if</strong> (nProfiles == 0) <em class="brace">{</em>
<a id="L310" name="L310"></a> 310                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L311" name="L311"></a> 311                     "Destination ColorSpace is undefined");
<a id="L312" name="L312"></a> 312             <em class="brace">}</em>
<a id="L313" name="L313"></a> 313             destProfile = profileList [nProfiles - 1];
<a id="L314" name="L314"></a> 314             dest = <a href="../D/13704.html" title="Multiple defined in 7 places.">createCompatibleDestImage</a>(src, <strong class="reserved">null</strong>);
<a id="L315" name="L315"></a> 315         <em class="brace">}</em>
<a id="L316" name="L316"></a> 316         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L317" name="L317"></a> 317             <strong class="reserved">if</strong> (src.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>() != dest.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>() ||
<a id="L318" name="L318"></a> 318                 src.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>() != dest.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>()) <em class="brace">{</em>
<a id="L319" name="L319"></a> 319                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L320" name="L320"></a> 320                     "Width or height of BufferedImages do not match");
<a id="L321" name="L321"></a> 321             <em class="brace">}</em>
<a id="L322" name="L322"></a> 322             destProfile = ((<a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) destColorSpace).<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L323" name="L323"></a> 323         <em class="brace">}</em>
<a id="L324" name="L324"></a> 324 
<div class="comment">
 Checking if all profiles in the transform sequence are the same.
          If so, performing just copying the data.</div>
<a id="L328" name="L328"></a> 328         <strong class="reserved">if</strong> (srcProfile == destProfile) <em class="brace">{</em>
<a id="L329" name="L329"></a> 329             <strong class="reserved">boolean</strong> noTrans = <strong class="reserved">true</strong>;
<a id="L330" name="L330"></a> 330             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nProfiles; i++) <em class="brace">{</em>
<a id="L331" name="L331"></a> 331                 <strong class="reserved">if</strong> (srcProfile != profileList[i]) <em class="brace">{</em>
<a id="L332" name="L332"></a> 332                     noTrans = <strong class="reserved">false</strong>;
<a id="L333" name="L333"></a> 333                     <strong class="reserved">break</strong>;
<a id="L334" name="L334"></a> 334                 <em class="brace">}</em>
<a id="L335" name="L335"></a> 335             <em class="brace">}</em>
<a id="L336" name="L336"></a> 336             <strong class="reserved">if</strong> (noTrans) <em class="brace">{</em>
<a id="L337" name="L337"></a> 337                 <a href="../S/2098.html#L407" title="Defined at 407 in src/java/awt/Graphics2D.java.">Graphics2D</a> g = dest.<a href="../D/13920.html" title="Multiple defined in 4 places.">createGraphics</a>();
<a id="L338" name="L338"></a> 338                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L339" name="L339"></a> 339                     g.<a href="../D/15196.html" title="Multiple defined in 16 places.">drawImage</a>(src, 0, 0, <strong class="reserved">null</strong>);
<a id="L340" name="L340"></a> 340                 <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L341" name="L341"></a> 341                     g.<a href="../D/14970.html" title="Multiple defined in 65 places.">dispose</a>();
<a id="L342" name="L342"></a> 342                 <em class="brace">}</em>
<a id="L343" name="L343"></a> 343 
<a id="L344" name="L344"></a> 344                 <strong class="reserved">return</strong> dest;
<a id="L345" name="L345"></a> 345             <em class="brace">}</em>
<a id="L346" name="L346"></a> 346         <em class="brace">}</em>
<a id="L347" name="L347"></a> 347 
<div class="comment">
         /* make a new transform if needed */</div>
<a id="L349" name="L349"></a> 349         <strong class="reserved">if</strong> ((thisTransform == <strong class="reserved">null</strong>) || (thisSrcProfile != srcProfile) ||
<a id="L350" name="L350"></a> 350             (thisDestProfile != destProfile) ) <em class="brace">{</em>
<a id="L351" name="L351"></a> 351             <a href="../S/2278.html#L360" title="Defined at 360 in src/java/awt/image/ColorConvertOp.java.">updateBITransform</a>(srcProfile, destProfile);
<a id="L352" name="L352"></a> 352         <em class="brace">}</em>
<a id="L353" name="L353"></a> 353 
<div class="comment">
         /* color convert the image */</div>
<a id="L355" name="L355"></a> 355         thisTransform.colorConvert(src, dest);
<a id="L356" name="L356"></a> 356 
<a id="L357" name="L357"></a> 357         <strong class="reserved">return</strong> dest;
<a id="L358" name="L358"></a> 358     <em class="brace">}</em>
<a id="L359" name="L359"></a> 359 
<a id="L360" name="L360"></a> 360     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/29811.html" title="Multiple referred from 2 places.">updateBITransform</a>(<a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a> srcProfile,
<a id="L361" name="L361"></a> 361                                    <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a> destProfile) <em class="brace">{</em>
<a id="L362" name="L362"></a> 362         <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>[]    theProfiles;
<a id="L363" name="L363"></a> 363         <strong class="reserved">int</strong>              i1, nProfiles, nTransforms, whichTrans, renderState;
<a id="L364" name="L364"></a> 364         ColorTransform[]  theTransforms;
<a id="L365" name="L365"></a> 365         <strong class="reserved">boolean</strong>          useSrc = <strong class="reserved">false</strong>, useDest = <strong class="reserved">false</strong>;
<a id="L366" name="L366"></a> 366 
<a id="L367" name="L367"></a> 367         nProfiles = profileList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L368" name="L368"></a> 368         nTransforms = nProfiles;
<a id="L369" name="L369"></a> 369         <strong class="reserved">if</strong> ((nProfiles == 0) || (srcProfile != profileList[0])) <em class="brace">{</em>
<a id="L370" name="L370"></a> 370             nTransforms += 1;
<a id="L371" name="L371"></a> 371             useSrc = <strong class="reserved">true</strong>;
<a id="L372" name="L372"></a> 372         <em class="brace">}</em>
<a id="L373" name="L373"></a> 373         <strong class="reserved">if</strong> ((nProfiles == 0) || (destProfile != profileList[nProfiles - 1]) ||
<a id="L374" name="L374"></a> 374             (nTransforms &lt; 2)) <em class="brace">{</em>
<a id="L375" name="L375"></a> 375             nTransforms += 1;
<a id="L376" name="L376"></a> 376             useDest = <strong class="reserved">true</strong>;
<a id="L377" name="L377"></a> 377         <em class="brace">}</em>
<a id="L378" name="L378"></a> 378 
<div class="comment">
         /* make the profile list */</div>
<a id="L380" name="L380"></a> 380         theProfiles = <strong class="reserved">new</strong> 
<div class="comment">
 the list of profiles
                                                       for this Op </div>
<a id="L382" name="L382"></a> 382 
<a id="L383" name="L383"></a> 383         <strong class="reserved">int</strong> idx = 0;
<a id="L384" name="L384"></a> 384         <strong class="reserved">if</strong> (useSrc) <em class="brace">{</em>
<div class="comment">
             /* insert source as first profile */</div>
<a id="L386" name="L386"></a> 386             theProfiles[idx++] = srcProfile;
<a id="L387" name="L387"></a> 387         <em class="brace">}</em>
<a id="L388" name="L388"></a> 388 
<a id="L389" name="L389"></a> 389         <strong class="reserved">for</strong> (i1 = 0; i1 &lt; nProfiles; i1++) <em class="brace">{</em>
<div class="comment">
                                    /* insert profiles defined in this Op */</div>
<a id="L391" name="L391"></a> 391             theProfiles[idx++] = profileList [i1];
<a id="L392" name="L392"></a> 392         <em class="brace">}</em>
<a id="L393" name="L393"></a> 393 
<a id="L394" name="L394"></a> 394         <strong class="reserved">if</strong> (useDest) <em class="brace">{</em>
<div class="comment">
             /* insert dest as last profile */</div>
<a id="L396" name="L396"></a> 396             theProfiles[idx] = destProfile;
<a id="L397" name="L397"></a> 397         <em class="brace">}</em>
<a id="L398" name="L398"></a> 398 
<div class="comment">
         /* make the transform list */</div>
<a id="L400" name="L400"></a> 400         theTransforms = <strong class="reserved">new</strong> ColorTransform [nTransforms];
<a id="L401" name="L401"></a> 401 
<div class="comment">
         /* initialize transform get loop */</div>
<a id="L403" name="L403"></a> 403         <strong class="reserved">if</strong> (theProfiles[0].<a href="../S/2160.html#L1163" title="Defined at 1163 in src/java/awt/color/ICC_Profile.java.">getProfileClass</a>() == <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.CLASS_OUTPUT) <em class="brace">{</em>
<div class="comment">
 if first profile is a printer
                                           render as colorimetric </div>
<a id="L406" name="L406"></a> 406             renderState = <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.icRelativeColorimetric;
<a id="L407" name="L407"></a> 407         <em class="brace">}</em>
<a id="L408" name="L408"></a> 408         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L409" name="L409"></a> 409             renderState = 
<div class="comment">
 render any other
                                                       class perceptually </div>
<a id="L411" name="L411"></a> 411         <em class="brace">}</em>
<a id="L412" name="L412"></a> 412 
<a id="L413" name="L413"></a> 413         whichTrans = ColorTransform.In;
<a id="L414" name="L414"></a> 414 
<a id="L415" name="L415"></a> 415         PCMM mdl = CMSManager.getModule();
<a id="L416" name="L416"></a> 416 
<div class="comment">
         /* get the transforms from each profile */</div>
<a id="L418" name="L418"></a> 418         <strong class="reserved">for</strong> (i1 = 0; i1 &lt; nTransforms; i1++) <em class="brace">{</em>
<a id="L419" name="L419"></a> 419             <strong class="reserved">if</strong> (i1 == nTransforms -1) <div class="comment">
/* last profile? */</div>
<div class="comment">
                 whichTrans = ColorTransform.Out; /* get output transform */</div>
<a id="L421" name="L421"></a> 421             <em class="brace">}</em>
<a id="L422" name="L422"></a> 422             <strong class="reserved">else</strong> <div class="comment">
/* check for abstract profile */</div>
<a id="L423" name="L423"></a> 423                 <strong class="reserved">if</strong> ((whichTrans == ColorTransform.Simulation) &amp;&amp;
<a id="L424" name="L424"></a> 424                     (theProfiles[i1].<a href="../S/2160.html#L1163" title="Defined at 1163 in src/java/awt/color/ICC_Profile.java.">getProfileClass</a> () ==
<a id="L425" name="L425"></a> 425                      <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.CLASS_ABSTRACT)) <em class="brace">{</em>
<a id="L426" name="L426"></a> 426                 renderState = <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.icPerceptual;
<a id="L427" name="L427"></a> 427                     whichTrans = ColorTransform.In;
<a id="L428" name="L428"></a> 428                 <em class="brace">}</em>
<a id="L429" name="L429"></a> 429             <em class="brace">}</em>
<a id="L430" name="L430"></a> 430 
<a id="L431" name="L431"></a> 431             theTransforms[i1] = mdl.createTransform (
<a id="L432" name="L432"></a> 432                 theProfiles[i1], renderState, whichTrans);
<a id="L433" name="L433"></a> 433 
<div class="comment">
 get this profile's rendering intent to select transform
               from next profile </div>
<a id="L436" name="L436"></a> 436             renderState = <a href="../D/21976.html" title="Multiple defined in 2 places.">getRenderingIntent</a>(theProfiles[i1]);
<a id="L437" name="L437"></a> 437 
<div class="comment">
             /* "middle" profiles use simulation transform */</div>
<a id="L439" name="L439"></a> 439             whichTrans = ColorTransform.Simulation;
<a id="L440" name="L440"></a> 440         <em class="brace">}</em>
<a id="L441" name="L441"></a> 441 
<div class="comment">
         /* make the net transform */</div>
<a id="L443" name="L443"></a> 443         thisTransform = mdl.createTransform(theTransforms);
<a id="L444" name="L444"></a> 444 
<div class="comment">
         /* update corresponding source and dest profiles */</div>
<a id="L446" name="L446"></a> 446         thisSrcProfile = srcProfile;
<a id="L447" name="L447"></a> 447         thisDestProfile = destProfile;
<a id="L448" name="L448"></a> 448     <em class="brace">}</em>
<a id="L449" name="L449"></a> 449 
<div class="comment">
      ColorConverts the image data in the source Raster.
      If the destination Raster is null, a new Raster will be created.
      The number of bands in the source and destination Rasters must
      meet the requirements explained above.  The constructor used to
      create this ColorConvertOp must have provided enough information
      to define both source and destination color spaces.  See above.
      Otherwise, an exception is thrown.
      @param src the source <code>Raster</code> to be converted
      @param dest the destination <code>WritableRaster</code>,
             or <code>null</code>
      @return <code>dest</code> color converted from <code>src</code>
              or a new, converted <code>WritableRaster</code>
              if <code>dest</code> is <code>null</code>
      @exception IllegalArgumentException if the number of source or
                  destination bands is incorrect, the source or destination
                  color spaces are undefined, or this op was constructed
                  with one of the constructors that applies only to
                  operations on BufferedImages.</div>
<a id="L470" name="L470"></a> 470     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/2280.html#L49" title="Defined at 49 in src/java/awt/image/WritableRaster.java.">WritableRaster</a> <a href="../R/14321.html" title="Multiple referred from 472 places.">filter</a> (<a href="../S/2238.html#L126" title="Defined at 126 in src/java/awt/image/Raster.java.">Raster</a> src, <a href="../S/2280.html#L49" title="Defined at 49 in src/java/awt/image/WritableRaster.java.">WritableRaster</a> dest)  <em class="brace">{</em>
<a id="L471" name="L471"></a> 471 
<a id="L472" name="L472"></a> 472         <strong class="reserved">if</strong> (CSList != <strong class="reserved">null</strong>) <em class="brace">{</em>
<div class="comment">
             /* non-ICC case */</div>
<a id="L474" name="L474"></a> 474             <strong class="reserved">return</strong> <a href="../S/2278.html#L950" title="Defined at 950 in src/java/awt/image/ColorConvertOp.java.">nonICCRasterFilter</a>(src, dest);
<a id="L475" name="L475"></a> 475         <em class="brace">}</em>
<a id="L476" name="L476"></a> 476         <strong class="reserved">int</strong> nProfiles = profileList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L477" name="L477"></a> 477         <strong class="reserved">if</strong> (nProfiles &lt; 2) <em class="brace">{</em>
<a id="L478" name="L478"></a> 478             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L479" name="L479"></a> 479                 "Source or Destination ColorSpace is undefined");
<a id="L480" name="L480"></a> 480         <em class="brace">}</em>
<a id="L481" name="L481"></a> 481         <strong class="reserved">if</strong> (src.<a href="../D/21054.html" title="Multiple defined in 3 places.">getNumBands</a>() != profileList[0].<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>()) <em class="brace">{</em>
<a id="L482" name="L482"></a> 482             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L483" name="L483"></a> 483                 "Numbers of source Raster bands and source color space " +
<a id="L484" name="L484"></a> 484                 "components do not match");
<a id="L485" name="L485"></a> 485         <em class="brace">}</em>
<a id="L486" name="L486"></a> 486         <strong class="reserved">if</strong> (dest == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L487" name="L487"></a> 487             dest = <a href="../D/13705.html" title="Multiple defined in 7 places.">createCompatibleDestRaster</a>(src);
<a id="L488" name="L488"></a> 488         <em class="brace">}</em>
<a id="L489" name="L489"></a> 489         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L490" name="L490"></a> 490             <strong class="reserved">if</strong> (src.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>() != dest.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>() ||
<a id="L491" name="L491"></a> 491                 src.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>() != dest.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>()) <em class="brace">{</em>
<a id="L492" name="L492"></a> 492                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L493" name="L493"></a> 493                     "Width or height of Rasters do not match");
<a id="L494" name="L494"></a> 494             <em class="brace">}</em>
<a id="L495" name="L495"></a> 495             <strong class="reserved">if</strong> (dest.<a href="../D/21054.html" title="Multiple defined in 3 places.">getNumBands</a>() !=
<a id="L496" name="L496"></a> 496                 profileList[nProfiles-1].<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>()) <em class="brace">{</em>
<a id="L497" name="L497"></a> 497                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L498" name="L498"></a> 498                     "Numbers of destination Raster bands and destination " +
<a id="L499" name="L499"></a> 499                     "color space components do not match");
<a id="L500" name="L500"></a> 500             <em class="brace">}</em>
<a id="L501" name="L501"></a> 501         <em class="brace">}</em>
<a id="L502" name="L502"></a> 502 
<div class="comment">
         /* make a new transform if needed */</div>
<a id="L504" name="L504"></a> 504         <strong class="reserved">if</strong> (thisRasterTransform == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L505" name="L505"></a> 505             <strong class="reserved">int</strong>              i1, whichTrans, renderState;
<a id="L506" name="L506"></a> 506             ColorTransform[]  theTransforms;
<a id="L507" name="L507"></a> 507 
<div class="comment">
             /* make the transform list */</div>
<a id="L509" name="L509"></a> 509             theTransforms = <strong class="reserved">new</strong> ColorTransform [nProfiles];
<a id="L510" name="L510"></a> 510 
<div class="comment">
             /* initialize transform get loop */</div>
<a id="L512" name="L512"></a> 512             <strong class="reserved">if</strong> (profileList[0].<a href="../S/2160.html#L1163" title="Defined at 1163 in src/java/awt/color/ICC_Profile.java.">getProfileClass</a>() == <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.CLASS_OUTPUT) <em class="brace">{</em>
<div class="comment">
 if first profile is a printer
                                               render as colorimetric </div>
<a id="L515" name="L515"></a> 515                 renderState = <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.icRelativeColorimetric;
<a id="L516" name="L516"></a> 516             <em class="brace">}</em>
<a id="L517" name="L517"></a> 517             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L518" name="L518"></a> 518                 renderState = 
<div class="comment">
 render any other
                                                           class perceptually </div>
<a id="L520" name="L520"></a> 520             <em class="brace">}</em>
<a id="L521" name="L521"></a> 521 
<a id="L522" name="L522"></a> 522             whichTrans = ColorTransform.In;
<a id="L523" name="L523"></a> 523 
<a id="L524" name="L524"></a> 524             PCMM mdl = CMSManager.getModule();
<a id="L525" name="L525"></a> 525 
<div class="comment">
             /* get the transforms from each profile */</div>
<a id="L527" name="L527"></a> 527             <strong class="reserved">for</strong> (i1 = 0; i1 &lt; nProfiles; i1++) <em class="brace">{</em>
<a id="L528" name="L528"></a> 528                 <strong class="reserved">if</strong> (i1 == nProfiles -1) <div class="comment">
/* last profile? */</div>
<div class="comment">
                     whichTrans = ColorTransform.Out; /* get output transform */</div>
<a id="L530" name="L530"></a> 530                 <em class="brace">}</em>
<a id="L531" name="L531"></a> 531                 <strong class="reserved">else</strong> <div class="comment">
/* check for abstract profile */</div>
<a id="L532" name="L532"></a> 532                     <strong class="reserved">if</strong> ((whichTrans == ColorTransform.Simulation) &amp;&amp;
<a id="L533" name="L533"></a> 533                         (profileList[i1].<a href="../S/2160.html#L1163" title="Defined at 1163 in src/java/awt/color/ICC_Profile.java.">getProfileClass</a> () ==
<a id="L534" name="L534"></a> 534                          <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.CLASS_ABSTRACT)) <em class="brace">{</em>
<a id="L535" name="L535"></a> 535                         renderState = <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.icPerceptual;
<a id="L536" name="L536"></a> 536                         whichTrans = ColorTransform.In;
<a id="L537" name="L537"></a> 537                     <em class="brace">}</em>
<a id="L538" name="L538"></a> 538                 <em class="brace">}</em>
<a id="L539" name="L539"></a> 539 
<a id="L540" name="L540"></a> 540                 theTransforms[i1] = mdl.createTransform (
<a id="L541" name="L541"></a> 541                     profileList[i1], renderState, whichTrans);
<a id="L542" name="L542"></a> 542 
<div class="comment">
 get this profile's rendering intent to select transform
                   from next profile </div>
<a id="L545" name="L545"></a> 545                 renderState = <a href="../D/21976.html" title="Multiple defined in 2 places.">getRenderingIntent</a>(profileList[i1]);
<a id="L546" name="L546"></a> 546 
<div class="comment">
                 /* "middle" profiles use simulation transform */</div>
<a id="L548" name="L548"></a> 548                 whichTrans = ColorTransform.Simulation;
<a id="L549" name="L549"></a> 549             <em class="brace">}</em>
<a id="L550" name="L550"></a> 550 
<div class="comment">
             /* make the net transform */</div>
<a id="L552" name="L552"></a> 552             thisRasterTransform = mdl.createTransform(theTransforms);
<a id="L553" name="L553"></a> 553         <em class="brace">}</em>
<a id="L554" name="L554"></a> 554 
<a id="L555" name="L555"></a> 555         <strong class="reserved">int</strong> srcTransferType = src.<a href="../D/23246.html" title="Multiple defined in 4 places.">getTransferType</a>();
<a id="L556" name="L556"></a> 556         <strong class="reserved">int</strong> dstTransferType = dest.<a href="../D/23246.html" title="Multiple defined in 4 places.">getTransferType</a>();
<a id="L557" name="L557"></a> 557         <strong class="reserved">if</strong> ((srcTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_FLOAT) ||
<a id="L558" name="L558"></a> 558             (srcTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_DOUBLE) ||
<a id="L559" name="L559"></a> 559             (dstTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_FLOAT) ||
<a id="L560" name="L560"></a> 560             (dstTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_DOUBLE)) <em class="brace">{</em>
<a id="L561" name="L561"></a> 561             <strong class="reserved">if</strong> (srcMinVals == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L562" name="L562"></a> 562                 <a href="../S/2278.html#L1064" title="Defined at 1064 in src/java/awt/image/ColorConvertOp.java.">getMinMaxValsFromProfiles</a>(profileList[0],
<a id="L563" name="L563"></a> 563                                           profileList[nProfiles-1]);
<a id="L564" name="L564"></a> 564             <em class="brace">}</em>
<div class="comment">
             /* color convert the raster */</div>
<a id="L566" name="L566"></a> 566             thisRasterTransform.colorConvert(src, dest,
<a id="L567" name="L567"></a> 567                                              srcMinVals, srcMaxVals,
<a id="L568" name="L568"></a> 568                                              dstMinVals, dstMaxVals);
<a id="L569" name="L569"></a> 569         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<div class="comment">
             /* color convert the raster */</div>
<a id="L571" name="L571"></a> 571             thisRasterTransform.colorConvert(src, dest);
<a id="L572" name="L572"></a> 572         <em class="brace">}</em>
<a id="L573" name="L573"></a> 573 
<a id="L574" name="L574"></a> 574 
<a id="L575" name="L575"></a> 575         <strong class="reserved">return</strong> dest;
<a id="L576" name="L576"></a> 576     <em class="brace">}</em>
<a id="L577" name="L577"></a> 577 
<div class="comment">
      Returns the bounding box of the destination, given this source.
      Note that this will be the same as the the bounding box of the
      source.
      @param src the source <code>BufferedImage</code>
      @return a <code>Rectangle2D</code> that is the bounding box
              of the destination, given the specified <code>src</code></div>
<a id="L586" name="L586"></a> 586     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../R/15323.html" title="Multiple referred from 370 places.">getBounds2D</a> (<a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> src) <em class="brace">{</em>
<a id="L587" name="L587"></a> 587         <strong class="reserved">return</strong> <a href="../D/17336.html" title="Multiple defined in 36 places.">getBounds2D</a>(src.<a href="../D/21845.html" title="Multiple defined in 8 places.">getRaster</a>());
<a id="L588" name="L588"></a> 588     <em class="brace">}</em>
<a id="L589" name="L589"></a> 589 
<div class="comment">
      Returns the bounding box of the destination, given this source.
      Note that this will be the same as the the bounding box of the
      source.
      @param src the source <code>Raster</code>
      @return a <code>Rectangle2D</code> that is the bounding box
              of the destination, given the specified <code>src</code></div>
<a id="L598" name="L598"></a> 598     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../R/15323.html" title="Multiple referred from 370 places.">getBounds2D</a> (<a href="../S/2238.html#L126" title="Defined at 126 in src/java/awt/image/Raster.java.">Raster</a> src) <em class="brace">{</em>
<div class="comment">
        return new Rectangle (src.getXOffset(),
                              src.getYOffset(),
                              src.getWidth(), src.getHeight()); </div>
<a id="L602" name="L602"></a> 602         <strong class="reserved">return</strong> src.<a href="../D/17335.html" title="Multiple defined in 41 places.">getBounds</a>();
<a id="L603" name="L603"></a> 603     <em class="brace">}</em>
<a id="L604" name="L604"></a> 604 
<div class="comment">
      Creates a zeroed destination image with the correct size and number of
      bands, given this source.
      @param src       Source image for the filter operation.
      @param destCM    ColorModel of the destination.  If null, an
                       appropriate ColorModel will be used.
      @return a <code>BufferedImage</code> with the correct size and
      number of bands from the specified <code>src</code>.
      @throws IllegalArgumentException if <code>destCM</code> is
              <code>null</code> and this <code>ColorConvertOp</code> was
              created without any <code>ICC_Profile</code> or
              <code>ColorSpace</code> defined for the destination</div>
<a id="L618" name="L618"></a> 618     <strong class="reserved">public</strong> <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> <a href="../R/12285.html" title="Multiple referred from 12 places.">createCompatibleDestImage</a> (<a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> src,
<a id="L619" name="L619"></a> 619                                                     <a href="../D/1637.html" title="Multiple defined in 2 places.">ColorModel</a> destCM) <em class="brace">{</em>
<a id="L620" name="L620"></a> 620         <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> cs = <strong class="reserved">null</strong>;;
<a id="L621" name="L621"></a> 621         <strong class="reserved">if</strong> (destCM == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L622" name="L622"></a> 622             <strong class="reserved">if</strong> (CSList == <strong class="reserved">null</strong>) <em class="brace">{</em>
<div class="comment">
                 /* ICC case */</div>
<a id="L624" name="L624"></a> 624                 <strong class="reserved">int</strong> nProfiles = profileList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L625" name="L625"></a> 625                 <strong class="reserved">if</strong> (nProfiles == 0) <em class="brace">{</em>
<a id="L626" name="L626"></a> 626                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L627" name="L627"></a> 627                         "Destination ColorSpace is undefined");
<a id="L628" name="L628"></a> 628                 <em class="brace">}</em>
<a id="L629" name="L629"></a> 629                 <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a> destProfile = profileList[nProfiles - 1];
<a id="L630" name="L630"></a> 630                 cs = <strong class="reserved">new</strong> <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>(destProfile);
<a id="L631" name="L631"></a> 631             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<div class="comment">
                 /* non-ICC case */</div>
<a id="L633" name="L633"></a> 633                 <strong class="reserved">int</strong> nSpaces = CSList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L634" name="L634"></a> 634                 cs = CSList[nSpaces - 1];
<a id="L635" name="L635"></a> 635             <em class="brace">}</em>
<a id="L636" name="L636"></a> 636         <em class="brace">}</em>
<a id="L637" name="L637"></a> 637         <strong class="reserved">return</strong> <a href="../D/13704.html" title="Multiple defined in 7 places.">createCompatibleDestImage</a>(src, destCM, cs);
<a id="L638" name="L638"></a> 638     <em class="brace">}</em>
<a id="L639" name="L639"></a> 639 
<a id="L640" name="L640"></a> 640     <strong class="reserved">private</strong> <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> <a href="../R/12285.html" title="Multiple referred from 12 places.">createCompatibleDestImage</a>(<a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> src,
<a id="L641" name="L641"></a> 641                                                     <a href="../D/1637.html" title="Multiple defined in 2 places.">ColorModel</a> destCM,
<a id="L642" name="L642"></a> 642                                                     <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> destCS) <em class="brace">{</em>
<a id="L643" name="L643"></a> 643         <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> image;
<a id="L644" name="L644"></a> 644         <strong class="reserved">if</strong> (destCM == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L645" name="L645"></a> 645             <a href="../D/1637.html" title="Multiple defined in 2 places.">ColorModel</a> srcCM = src.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>();
<a id="L646" name="L646"></a> 646             <strong class="reserved">int</strong> nbands = destCS.<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>();
<a id="L647" name="L647"></a> 647             <strong class="reserved">boolean</strong> <a href="../S/2256.html#L406" title="Defined at 406 in src/java/awt/image/ColorModel.java.">hasAlpha</a> = srcCM.<a href="../S/2256.html#L406" title="Defined at 406 in src/java/awt/image/ColorModel.java.">hasAlpha</a>();
<a id="L648" name="L648"></a> 648             <strong class="reserved">if</strong> (<a href="../S/2256.html#L406" title="Defined at 406 in src/java/awt/image/ColorModel.java.">hasAlpha</a>) <em class="brace">{</em>
<a id="L649" name="L649"></a> 649                nbands += 1;
<a id="L650" name="L650"></a> 650             <em class="brace">}</em>
<a id="L651" name="L651"></a> 651             <strong class="reserved">int</strong>[] nbits = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[nbands];
<a id="L652" name="L652"></a> 652             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nbands; i++) <em class="brace">{</em>
<a id="L653" name="L653"></a> 653                 nbits[i] = 8;
<a id="L654" name="L654"></a> 654             <em class="brace">}</em>
<a id="L655" name="L655"></a> 655             destCM = <strong class="reserved">new</strong> <a href="../S/2267.html#L177" title="Defined at 177 in src/java/awt/image/ComponentColorModel.java.">ComponentColorModel</a>(destCS, nbits, <a href="../S/2256.html#L406" title="Defined at 406 in src/java/awt/image/ColorModel.java.">hasAlpha</a>,
<a id="L656" name="L656"></a> 656                                              srcCM.<a href="../D/25179.html" title="Multiple defined in 2 places.">isAlphaPremultiplied</a>(),
<a id="L657" name="L657"></a> 657                                              srcCM.<a href="../D/23273.html" title="Multiple defined in 9 places.">getTransparency</a>(),
<a id="L658" name="L658"></a> 658                                              <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_BYTE);
<a id="L659" name="L659"></a> 659         <em class="brace">}</em>
<a id="L660" name="L660"></a> 660         <strong class="reserved">int</strong> w = src.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>();
<a id="L661" name="L661"></a> 661         <strong class="reserved">int</strong> h = src.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>();
<a id="L662" name="L662"></a> 662         image = <strong class="reserved">new</strong> <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a>(destCM,
<a id="L663" name="L663"></a> 663                                   destCM.<a href="../D/13710.html" title="Multiple defined in 8 places.">createCompatibleWritableRaster</a>(w, h),
<a id="L664" name="L664"></a> 664                                   destCM.<a href="../D/25179.html" title="Multiple defined in 2 places.">isAlphaPremultiplied</a>(), <strong class="reserved">null</strong>);
<a id="L665" name="L665"></a> 665         <strong class="reserved">return</strong> image;
<a id="L666" name="L666"></a> 666     <em class="brace">}</em>
<a id="L667" name="L667"></a> 667 
<a id="L668" name="L668"></a> 668 
<div class="comment">
      Creates a zeroed destination Raster with the correct size and number of
      bands, given this source.
      @param src the specified <code>Raster</code>
      @return a <code>WritableRaster</code> with the correct size and number
              of bands from the specified <code>src</code>
      @throws IllegalArgumentException if this <code>ColorConvertOp</code>
              was created without sufficient information to define the
              <code>dst</code> and <code>src</code> color spaces</div>
<a id="L679" name="L679"></a> 679     <strong class="reserved">public</strong> <a href="../S/2280.html#L49" title="Defined at 49 in src/java/awt/image/WritableRaster.java.">WritableRaster</a> <a href="../R/12286.html" title="Multiple referred from 7 places.">createCompatibleDestRaster</a> (<a href="../S/2238.html#L126" title="Defined at 126 in src/java/awt/image/Raster.java.">Raster</a> src) <em class="brace">{</em>
<a id="L680" name="L680"></a> 680         <strong class="reserved">int</strong> ncomponents;
<a id="L681" name="L681"></a> 681 
<a id="L682" name="L682"></a> 682         <strong class="reserved">if</strong> (CSList != <strong class="reserved">null</strong>) <em class="brace">{</em>
<div class="comment">
             /* non-ICC case */</div>
<a id="L684" name="L684"></a> 684             <strong class="reserved">if</strong> (CSList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != 2) <em class="brace">{</em>
<a id="L685" name="L685"></a> 685                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L686" name="L686"></a> 686                     "Destination ColorSpace is undefined");
<a id="L687" name="L687"></a> 687             <em class="brace">}</em>
<a id="L688" name="L688"></a> 688             ncomponents = CSList[1].<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>();
<a id="L689" name="L689"></a> 689         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<div class="comment">
             /* ICC case */</div>
<a id="L691" name="L691"></a> 691             <strong class="reserved">int</strong> nProfiles = profileList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L692" name="L692"></a> 692             <strong class="reserved">if</strong> (nProfiles &lt; 2) <em class="brace">{</em>
<a id="L693" name="L693"></a> 693                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L694" name="L694"></a> 694                     "Destination ColorSpace is undefined");
<a id="L695" name="L695"></a> 695             <em class="brace">}</em>
<a id="L696" name="L696"></a> 696             ncomponents = profileList[nProfiles-1].<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>();
<a id="L697" name="L697"></a> 697         <em class="brace">}</em>
<a id="L698" name="L698"></a> 698 
<a id="L699" name="L699"></a> 699         <a href="../S/2280.html#L49" title="Defined at 49 in src/java/awt/image/WritableRaster.java.">WritableRaster</a> dest =
<a id="L700" name="L700"></a> 700             <a href="../S/2238.html#L126" title="Defined at 126 in src/java/awt/image/Raster.java.">Raster</a>.<a href="../D/13973.html" title="Multiple defined in 3 places.">createInterleavedRaster</a>(<a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_BYTE,
<a id="L701" name="L701"></a> 701                                   src.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>(),
<a id="L702" name="L702"></a> 702                                   src.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>(),
<a id="L703" name="L703"></a> 703                                   ncomponents,
<a id="L704" name="L704"></a> 704                                   <strong class="reserved">new</strong> <a href="../S/2123.html#L38" title="Defined at 38 in src/java/awt/Point.java.">Point</a>(src.<a href="../D/20651.html" title="Multiple defined in 6 places.">getMinX</a>(), src.<a href="../D/20652.html" title="Multiple defined in 6 places.">getMinY</a>()));
<a id="L705" name="L705"></a> 705         <strong class="reserved">return</strong> dest;
<a id="L706" name="L706"></a> 706     <em class="brace">}</em>
<a id="L707" name="L707"></a> 707 
<div class="comment">
      Returns the location of the destination point given a
      point in the source.  If <code>dstPt</code> is non-null,
      it will be used to hold the return value.  Note that
      for this class, the destination point will be the same
      as the source point.
      @param srcPt the specified source <code>Point2D</code>
      @param dstPt the destination <code>Point2D</code>
      @return <code>dstPt</code> after setting its location to be
              the same as <code>srcPt</code></div>
<a id="L719" name="L719"></a> 719     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/2319.html#L42" title="Defined at 42 in src/java/awt/geom/Point2D.java.">Point2D</a> getPoint2D (<a href="../S/2319.html#L42" title="Defined at 42 in src/java/awt/geom/Point2D.java.">Point2D</a> srcPt, <a href="../S/2319.html#L42" title="Defined at 42 in src/java/awt/geom/Point2D.java.">Point2D</a> dstPt) <em class="brace">{</em>
<a id="L720" name="L720"></a> 720         <strong class="reserved">if</strong> (dstPt == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L721" name="L721"></a> 721             dstPt = <strong class="reserved">new</strong> <a href="../S/2319.html#L42" title="Defined at 42 in src/java/awt/geom/Point2D.java.">Point2D</a>.<a href="../D/3293.html" title="Multiple defined in 10 places.">Float</a>();
<a id="L722" name="L722"></a> 722         <em class="brace">}</em>
<a id="L723" name="L723"></a> 723         dstPt.<a href="../D/33134.html" title="Multiple defined in 29 places.">setLocation</a>(srcPt.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>(), srcPt.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>());
<a id="L724" name="L724"></a> 724 
<a id="L725" name="L725"></a> 725         <strong class="reserved">return</strong> dstPt;
<a id="L726" name="L726"></a> 726     <em class="brace">}</em>
<a id="L727" name="L727"></a> 727 
<a id="L728" name="L728"></a> 728 
<div class="comment">
      Returns the RenderingIntent from the specified ICC Profile.</div>
<a id="L732" name="L732"></a> 732     <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/18669.html" title="Multiple referred from 2 places.">getRenderingIntent</a> (<a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a> <a href="../D/29884.html" title="Multiple defined in 3 places.">profile</a>) <em class="brace">{</em>
<a id="L733" name="L733"></a> 733         <strong class="reserved">byte</strong>[] <a href="../S/776.html#L991" title="Defined at 991 in src/java/net/HttpCookie.java.">header</a> = <a href="../D/29884.html" title="Multiple defined in 3 places.">profile</a>.<a href="../D/18190.html" title="Multiple defined in 47 places.">getData</a>(<a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.icSigHead);
<a id="L734" name="L734"></a> 734         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a>.icHdrRenderingIntent;
<a id="L735" name="L735"></a> 735 
<div class="comment">
 According to ICC spec, only the least-significant 16 bits shall be
          used to encode the rendering intent. The most significant 16 bits
          shall be set to zero. Thus, we are ignoring two most significant
          bytes here.
           See http://www.color.org/ICC1v42_2006-05.pdf, section 7.2.15.</div>
<a id="L743" name="L743"></a> 743         <strong class="reserved">return</strong> ((<a href="../S/776.html#L991" title="Defined at 991 in src/java/net/HttpCookie.java.">header</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>+2] &amp; 0xff) &lt;&lt;  8) |
<a id="L744" name="L744"></a> 744                 (<a href="../S/776.html#L991" title="Defined at 991 in src/java/net/HttpCookie.java.">header</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>+3] &amp; 0xff);
<a id="L745" name="L745"></a> 745     <em class="brace">}</em>
<a id="L746" name="L746"></a> 746 
<div class="comment">
      Returns the rendering hints used by this op.
      @return the <code>RenderingHints</code> object of this
              <code>ColorConvertOp</code></div>
<a id="L752" name="L752"></a> 752     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/2116.html#L82" title="Defined at 82 in src/java/awt/RenderingHints.java.">RenderingHints</a> getRenderingHints() <em class="brace">{</em>
<a id="L753" name="L753"></a> 753         <strong class="reserved">return</strong> hints;
<a id="L754" name="L754"></a> 754     <em class="brace">}</em>
<a id="L755" name="L755"></a> 755 
<a id="L756" name="L756"></a> 756     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> <a href="../S/2278.html#L280" title="Referred from 280 in src/java/awt/image/ColorConvertOp.java.">nonICCBIFilter</a>(<a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> src,
<a id="L757" name="L757"></a> 757                                                <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> srcColorSpace,
<a id="L758" name="L758"></a> 758                                                <a href="../S/2258.html#L68" title="Defined at 68 in src/java/awt/image/BufferedImage.java.">BufferedImage</a> dst,
<a id="L759" name="L759"></a> 759                                                <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> dstColorSpace) <em class="brace">{</em>
<a id="L760" name="L760"></a> 760 
<a id="L761" name="L761"></a> 761         <strong class="reserved">int</strong> w = src.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>();
<a id="L762" name="L762"></a> 762         <strong class="reserved">int</strong> h = src.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>();
<a id="L763" name="L763"></a> 763         <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a> ciespace =
<a id="L764" name="L764"></a> 764             (<a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>(<a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a>.CS_CIEXYZ);
<a id="L765" name="L765"></a> 765         <strong class="reserved">if</strong> (dst == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L766" name="L766"></a> 766             dst = <a href="../D/13704.html" title="Multiple defined in 7 places.">createCompatibleDestImage</a>(src, <strong class="reserved">null</strong>);
<a id="L767" name="L767"></a> 767             dstColorSpace = dst.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>().<a href="../D/17792.html" title="Multiple defined in 3 places.">getColorSpace</a>();
<a id="L768" name="L768"></a> 768         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L769" name="L769"></a> 769             <strong class="reserved">if</strong> ((h != dst.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>()) || (w != dst.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>())) <em class="brace">{</em>
<a id="L770" name="L770"></a> 770                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L771" name="L771"></a> 771                     "Width or height of BufferedImages do not match");
<a id="L772" name="L772"></a> 772             <em class="brace">}</em>
<a id="L773" name="L773"></a> 773         <em class="brace">}</em>
<a id="L774" name="L774"></a> 774         <a href="../S/2238.html#L126" title="Defined at 126 in src/java/awt/image/Raster.java.">Raster</a> srcRas = src.<a href="../D/21845.html" title="Multiple defined in 8 places.">getRaster</a>();
<a id="L775" name="L775"></a> 775         <a href="../S/2280.html#L49" title="Defined at 49 in src/java/awt/image/WritableRaster.java.">WritableRaster</a> dstRas = dst.<a href="../D/21845.html" title="Multiple defined in 8 places.">getRaster</a>();
<a id="L776" name="L776"></a> 776         <a href="../D/1637.html" title="Multiple defined in 2 places.">ColorModel</a> srcCM = src.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>();
<a id="L777" name="L777"></a> 777         <a href="../D/1637.html" title="Multiple defined in 2 places.">ColorModel</a> dstCM = dst.<a href="../D/17790.html" title="Multiple defined in 14 places.">getColorModel</a>();
<a id="L778" name="L778"></a> 778         <strong class="reserved">int</strong> srcNumComp = srcCM.<a href="../S/2256.html#L519" title="Defined at 519 in src/java/awt/image/ColorModel.java.">getNumColorComponents</a>();
<a id="L779" name="L779"></a> 779         <strong class="reserved">int</strong> dstNumComp = dstCM.<a href="../S/2256.html#L519" title="Defined at 519 in src/java/awt/image/ColorModel.java.">getNumColorComponents</a>();
<a id="L780" name="L780"></a> 780         <strong class="reserved">boolean</strong> dstHasAlpha = dstCM.<a href="../S/2256.html#L406" title="Defined at 406 in src/java/awt/image/ColorModel.java.">hasAlpha</a>();
<a id="L781" name="L781"></a> 781         <strong class="reserved">boolean</strong> needSrcAlpha = srcCM.<a href="../S/2256.html#L406" title="Defined at 406 in src/java/awt/image/ColorModel.java.">hasAlpha</a>() &amp;&amp; dstHasAlpha;
<a id="L782" name="L782"></a> 782         <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a>[] <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>;
<a id="L783" name="L783"></a> 783         <strong class="reserved">if</strong> ((CSList == <strong class="reserved">null</strong>) &amp;&amp; (profileList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != 0)) <em class="brace">{</em>
<div class="comment">
             /* possible non-ICC src, some profiles, possible non-ICC dst */</div>
<a id="L785" name="L785"></a> 785             <strong class="reserved">boolean</strong> nonICCSrc, nonICCDst;
<a id="L786" name="L786"></a> 786             <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a> srcProfile, dstProfile;
<a id="L787" name="L787"></a> 787             <strong class="reserved">if</strong> (!(srcColorSpace <strong class="reserved">instanceof</strong> <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>)) <em class="brace">{</em>
<a id="L788" name="L788"></a> 788                 nonICCSrc = <strong class="reserved">true</strong>;
<a id="L789" name="L789"></a> 789                 srcProfile = ciespace.<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L790" name="L790"></a> 790             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L791" name="L791"></a> 791                 nonICCSrc = <strong class="reserved">false</strong>;
<a id="L792" name="L792"></a> 792                 srcProfile = ((<a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) srcColorSpace).<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L793" name="L793"></a> 793             <em class="brace">}</em>
<a id="L794" name="L794"></a> 794             <strong class="reserved">if</strong> (!(dstColorSpace <strong class="reserved">instanceof</strong> <a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>)) <em class="brace">{</em>
<a id="L795" name="L795"></a> 795                 nonICCDst = <strong class="reserved">true</strong>;
<a id="L796" name="L796"></a> 796                 dstProfile = ciespace.<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L797" name="L797"></a> 797             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L798" name="L798"></a> 798                 nonICCDst = <strong class="reserved">false</strong>;
<a id="L799" name="L799"></a> 799                 dstProfile = ((<a href="../S/2161.html#L87" title="Defined at 87 in src/java/awt/color/ICC_ColorSpace.java.">ICC_ColorSpace</a>) dstColorSpace).<a href="../D/21701.html" title="Multiple defined in 4 places.">getProfile</a>();
<a id="L800" name="L800"></a> 800             <em class="brace">}</em>
<div class="comment">
             /* make a new transform if needed */</div>
<a id="L802" name="L802"></a> 802             <strong class="reserved">if</strong> ((thisTransform == <strong class="reserved">null</strong>) || (thisSrcProfile != srcProfile) ||
<a id="L803" name="L803"></a> 803                 (thisDestProfile != dstProfile) ) <em class="brace">{</em>
<a id="L804" name="L804"></a> 804                 <a href="../S/2278.html#L360" title="Defined at 360 in src/java/awt/image/ColorConvertOp.java.">updateBITransform</a>(srcProfile, dstProfile);
<a id="L805" name="L805"></a> 805             <em class="brace">}</em>
<a id="L806" name="L806"></a> 806             <em class="comment">// process per scanline</em>
<a id="L807" name="L807"></a> 807             <strong class="reserved">float</strong> maxNum = 65535.0f; <em class="comment">// use 16-bit precision in CMM</em>
<a id="L808" name="L808"></a> 808             <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> cs;
<a id="L809" name="L809"></a> 809             <strong class="reserved">int</strong> iccSrcNumComp;
<a id="L810" name="L810"></a> 810             <strong class="reserved">if</strong> (nonICCSrc) <em class="brace">{</em>
<a id="L811" name="L811"></a> 811                 cs = ciespace;
<a id="L812" name="L812"></a> 812                 iccSrcNumComp = 3;
<a id="L813" name="L813"></a> 813             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L814" name="L814"></a> 814                 cs = srcColorSpace;
<a id="L815" name="L815"></a> 815                 iccSrcNumComp = srcNumComp;
<a id="L816" name="L816"></a> 816             <em class="brace">}</em>
<a id="L817" name="L817"></a> 817             <strong class="reserved">float</strong>[] srcMinVal = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[iccSrcNumComp];
<a id="L818" name="L818"></a> 818             <strong class="reserved">float</strong>[] srcInvDiffMinMax = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[iccSrcNumComp];
<a id="L819" name="L819"></a> 819             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; srcNumComp; i++) <em class="brace">{</em>
<a id="L820" name="L820"></a> 820                 srcMinVal[i] = cs.<a href="../D/20649.html" title="Multiple defined in 5 places.">getMinValue</a>(i);
<a id="L821" name="L821"></a> 821                 srcInvDiffMinMax[i] = maxNum / (cs.<a href="../D/20486.html" title="Multiple defined in 5 places.">getMaxValue</a>(i) - srcMinVal[i]);
<a id="L822" name="L822"></a> 822             <em class="brace">}</em>
<a id="L823" name="L823"></a> 823             <strong class="reserved">int</strong> iccDstNumComp;
<a id="L824" name="L824"></a> 824             <strong class="reserved">if</strong> (nonICCDst) <em class="brace">{</em>
<a id="L825" name="L825"></a> 825                 cs = ciespace;
<a id="L826" name="L826"></a> 826                 iccDstNumComp = 3;
<a id="L827" name="L827"></a> 827             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L828" name="L828"></a> 828                 cs = dstColorSpace;
<a id="L829" name="L829"></a> 829                 iccDstNumComp = dstNumComp;
<a id="L830" name="L830"></a> 830             <em class="brace">}</em>
<a id="L831" name="L831"></a> 831             <strong class="reserved">float</strong>[] dstMinVal = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[iccDstNumComp];
<a id="L832" name="L832"></a> 832             <strong class="reserved">float</strong>[] dstDiffMinMax = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[iccDstNumComp];
<a id="L833" name="L833"></a> 833             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; dstNumComp; i++) <em class="brace">{</em>
<a id="L834" name="L834"></a> 834                 dstMinVal[i] = cs.<a href="../D/20649.html" title="Multiple defined in 5 places.">getMinValue</a>(i);
<a id="L835" name="L835"></a> 835                 dstDiffMinMax[i] = (cs.<a href="../D/20486.html" title="Multiple defined in 5 places.">getMaxValue</a>(i) - dstMinVal[i]) / maxNum;
<a id="L836" name="L836"></a> 836             <em class="brace">}</em>
<a id="L837" name="L837"></a> 837             <strong class="reserved">float</strong>[] dstColor;
<a id="L838" name="L838"></a> 838             <strong class="reserved">if</strong> (dstHasAlpha) <em class="brace">{</em>
<a id="L839" name="L839"></a> 839                 <strong class="reserved">int</strong> <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a> = ((dstNumComp + 1) &gt; 3) ? (dstNumComp + 1) : 3;
<a id="L840" name="L840"></a> 840                 dstColor = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>];
<a id="L841" name="L841"></a> 841             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L842" name="L842"></a> 842                 <strong class="reserved">int</strong> <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a> = (dstNumComp  &gt; 3) ? dstNumComp : 3;
<a id="L843" name="L843"></a> 843                 dstColor = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>];
<a id="L844" name="L844"></a> 844             <em class="brace">}</em>
<a id="L845" name="L845"></a> 845             <strong class="reserved">short</strong>[] srcLine = <strong class="reserved">new</strong> <strong class="reserved">short</strong>[w * iccSrcNumComp];
<a id="L846" name="L846"></a> 846             <strong class="reserved">short</strong>[] dstLine = <strong class="reserved">new</strong> <strong class="reserved">short</strong>[w * iccDstNumComp];
<a id="L847" name="L847"></a> 847             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> pixel;
<a id="L848" name="L848"></a> 848             <strong class="reserved">float</strong>[] color;
<a id="L849" name="L849"></a> 849             <strong class="reserved">float</strong>[] alpha = <strong class="reserved">null</strong>;
<a id="L850" name="L850"></a> 850             <strong class="reserved">if</strong> (needSrcAlpha) <em class="brace">{</em>
<a id="L851" name="L851"></a> 851                 alpha = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[w];
<a id="L852" name="L852"></a> 852             <em class="brace">}</em>
<a id="L853" name="L853"></a> 853             <strong class="reserved">int</strong> idx;
<a id="L854" name="L854"></a> 854             <em class="comment">// process each scanline</em>
<a id="L855" name="L855"></a> 855             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> y = 0; y &lt; h; y++) <em class="brace">{</em>
<a id="L856" name="L856"></a> 856                 <em class="comment">// convert src scanline</em>
<a id="L857" name="L857"></a> 857                 pixel = <strong class="reserved">null</strong>;
<a id="L858" name="L858"></a> 858                 color = <strong class="reserved">null</strong>;
<a id="L859" name="L859"></a> 859                 idx = 0;
<a id="L860" name="L860"></a> 860                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = 0; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &lt; w; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>++) <em class="brace">{</em>
<a id="L861" name="L861"></a> 861                     pixel = srcRas.<a href="../D/18198.html" title="Multiple defined in 18 places.">getDataElements</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, pixel);
<a id="L862" name="L862"></a> 862                     color = srcCM.<a href="../D/21011.html" title="Multiple defined in 4 places.">getNormalizedComponents</a>(pixel, color, 0);
<a id="L863" name="L863"></a> 863                     <strong class="reserved">if</strong> (needSrcAlpha) <em class="brace">{</em>
<a id="L864" name="L864"></a> 864                         alpha[<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>] = color[srcNumComp];
<a id="L865" name="L865"></a> 865                     <em class="brace">}</em>
<a id="L866" name="L866"></a> 866                     <strong class="reserved">if</strong> (nonICCSrc) <em class="brace">{</em>
<a id="L867" name="L867"></a> 867                         color = srcColorSpace.<a href="../D/35364.html" title="Multiple defined in 3 places.">toCIEXYZ</a>(color);
<a id="L868" name="L868"></a> 868                     <em class="brace">}</em>
<a id="L869" name="L869"></a> 869                     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; iccSrcNumComp; i++) <em class="brace">{</em>
<a id="L870" name="L870"></a> 870                         srcLine[idx++] = (<strong class="reserved">short</strong>)
<a id="L871" name="L871"></a> 871                             ((color[i] - srcMinVal[i]) * srcInvDiffMinMax[i] +
<a id="L872" name="L872"></a> 872                              0.5f);
<a id="L873" name="L873"></a> 873                     <em class="brace">}</em>
<a id="L874" name="L874"></a> 874                 <em class="brace">}</em>
<a id="L875" name="L875"></a> 875                 <em class="comment">// color convert srcLine to dstLine</em>
<a id="L876" name="L876"></a> 876                 thisTransform.colorConvert(srcLine, dstLine);
<a id="L877" name="L877"></a> 877                 <em class="comment">// convert dst scanline</em>
<a id="L878" name="L878"></a> 878                 pixel = <strong class="reserved">null</strong>;
<a id="L879" name="L879"></a> 879                 idx = 0;
<a id="L880" name="L880"></a> 880                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = 0; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &lt; w; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>++) <em class="brace">{</em>
<a id="L881" name="L881"></a> 881                     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; iccDstNumComp; i++) <em class="brace">{</em>
<a id="L882" name="L882"></a> 882                         dstColor[i] = ((<strong class="reserved">float</strong>) (dstLine[idx++] &amp; 0xffff)) *
<a id="L883" name="L883"></a> 883                                       dstDiffMinMax[i] + dstMinVal[i];
<a id="L884" name="L884"></a> 884                     <em class="brace">}</em>
<a id="L885" name="L885"></a> 885                     <strong class="reserved">if</strong> (nonICCDst) <em class="brace">{</em>
<a id="L886" name="L886"></a> 886                         color = srcColorSpace.<a href="../D/16587.html" title="Multiple defined in 3 places.">fromCIEXYZ</a>(dstColor);
<a id="L887" name="L887"></a> 887                         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; dstNumComp; i++) <em class="brace">{</em>
<a id="L888" name="L888"></a> 888                             dstColor[i] = color[i];
<a id="L889" name="L889"></a> 889                         <em class="brace">}</em>
<a id="L890" name="L890"></a> 890                     <em class="brace">}</em>
<a id="L891" name="L891"></a> 891                     <strong class="reserved">if</strong> (needSrcAlpha) <em class="brace">{</em>
<a id="L892" name="L892"></a> 892                         dstColor[dstNumComp] = alpha[<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>];
<a id="L893" name="L893"></a> 893                     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (dstHasAlpha) <em class="brace">{</em>
<a id="L894" name="L894"></a> 894                         dstColor[dstNumComp] = 1.0f;
<a id="L895" name="L895"></a> 895                     <em class="brace">}</em>
<a id="L896" name="L896"></a> 896                     pixel = dstCM.<a href="../D/18198.html" title="Multiple defined in 18 places.">getDataElements</a>(dstColor, 0, pixel);
<a id="L897" name="L897"></a> 897                     dstRas.<a href="../D/32349.html" title="Multiple defined in 9 places.">setDataElements</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, pixel);
<a id="L898" name="L898"></a> 898                 <em class="brace">}</em>
<a id="L899" name="L899"></a> 899             <em class="brace">}</em>
<a id="L900" name="L900"></a> 900         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<div class="comment">
             /* possible non-ICC src, possible CSList, possible non-ICC dst */</div>
<a id="L902" name="L902"></a> 902             <em class="comment">// process per pixel</em>
<a id="L903" name="L903"></a> 903             <strong class="reserved">int</strong> numCS;
<a id="L904" name="L904"></a> 904             <strong class="reserved">if</strong> (CSList == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L905" name="L905"></a> 905                 numCS = 0;
<a id="L906" name="L906"></a> 906             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L907" name="L907"></a> 907                 numCS = CSList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L908" name="L908"></a> 908             <em class="brace">}</em>
<a id="L909" name="L909"></a> 909             <strong class="reserved">float</strong>[] dstColor;
<a id="L910" name="L910"></a> 910             <strong class="reserved">if</strong> (dstHasAlpha) <em class="brace">{</em>
<a id="L911" name="L911"></a> 911                 dstColor = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[dstNumComp + 1];
<a id="L912" name="L912"></a> 912             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L913" name="L913"></a> 913                 dstColor = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[dstNumComp];
<a id="L914" name="L914"></a> 914             <em class="brace">}</em>
<a id="L915" name="L915"></a> 915             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> spixel = <strong class="reserved">null</strong>;
<a id="L916" name="L916"></a> 916             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> dpixel = <strong class="reserved">null</strong>;
<a id="L917" name="L917"></a> 917             <strong class="reserved">float</strong>[] color = <strong class="reserved">null</strong>;
<a id="L918" name="L918"></a> 918             <strong class="reserved">float</strong>[] tmpColor;
<a id="L919" name="L919"></a> 919             <em class="comment">// process each pixel</em>
<a id="L920" name="L920"></a> 920             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> y = 0; y &lt; h; y++) <em class="brace">{</em>
<a id="L921" name="L921"></a> 921                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = 0; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &lt; w; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>++) <em class="brace">{</em>
<a id="L922" name="L922"></a> 922                     spixel = srcRas.<a href="../D/18198.html" title="Multiple defined in 18 places.">getDataElements</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, spixel);
<a id="L923" name="L923"></a> 923                     color = srcCM.<a href="../D/21011.html" title="Multiple defined in 4 places.">getNormalizedComponents</a>(spixel, color, 0);
<a id="L924" name="L924"></a> 924                     tmpColor = srcColorSpace.<a href="../D/35364.html" title="Multiple defined in 3 places.">toCIEXYZ</a>(color);
<a id="L925" name="L925"></a> 925                     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; numCS; i++) <em class="brace">{</em>
<a id="L926" name="L926"></a> 926                         tmpColor = CSList[i].<a href="../D/16587.html" title="Multiple defined in 3 places.">fromCIEXYZ</a>(tmpColor);
<a id="L927" name="L927"></a> 927                         tmpColor = CSList[i].<a href="../D/35364.html" title="Multiple defined in 3 places.">toCIEXYZ</a>(tmpColor);
<a id="L928" name="L928"></a> 928                     <em class="brace">}</em>
<a id="L929" name="L929"></a> 929                     tmpColor = dstColorSpace.<a href="../D/16587.html" title="Multiple defined in 3 places.">fromCIEXYZ</a>(tmpColor);
<a id="L930" name="L930"></a> 930                     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; dstNumComp; i++) <em class="brace">{</em>
<a id="L931" name="L931"></a> 931                         dstColor[i] = tmpColor[i];
<a id="L932" name="L932"></a> 932                     <em class="brace">}</em>
<a id="L933" name="L933"></a> 933                     <strong class="reserved">if</strong> (needSrcAlpha) <em class="brace">{</em>
<a id="L934" name="L934"></a> 934                         dstColor[dstNumComp] = color[srcNumComp];
<a id="L935" name="L935"></a> 935                     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (dstHasAlpha) <em class="brace">{</em>
<a id="L936" name="L936"></a> 936                         dstColor[dstNumComp] = 1.0f;
<a id="L937" name="L937"></a> 937                     <em class="brace">}</em>
<a id="L938" name="L938"></a> 938                     dpixel = dstCM.<a href="../D/18198.html" title="Multiple defined in 18 places.">getDataElements</a>(dstColor, 0, dpixel);
<a id="L939" name="L939"></a> 939                     dstRas.<a href="../D/32349.html" title="Multiple defined in 9 places.">setDataElements</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, dpixel);
<a id="L940" name="L940"></a> 940 
<a id="L941" name="L941"></a> 941                 <em class="brace">}</em>
<a id="L942" name="L942"></a> 942             <em class="brace">}</em>
<a id="L943" name="L943"></a> 943         <em class="brace">}</em>
<a id="L944" name="L944"></a> 944 
<a id="L945" name="L945"></a> 945         <strong class="reserved">return</strong> dst;
<a id="L946" name="L946"></a> 946     <em class="brace">}</em>
<a id="L947" name="L947"></a> 947 
<div class="comment">
 color convert a Raster - handles byte, ushort, int, short, float,
       or double transferTypes </div>
<a id="L950" name="L950"></a> 950     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/2280.html#L49" title="Defined at 49 in src/java/awt/image/WritableRaster.java.">WritableRaster</a> <a href="../S/2278.html#L474" title="Referred from 474 in src/java/awt/image/ColorConvertOp.java.">nonICCRasterFilter</a>(<a href="../S/2238.html#L126" title="Defined at 126 in src/java/awt/image/Raster.java.">Raster</a> src,
<a id="L951" name="L951"></a> 951                                                     <a href="../S/2280.html#L49" title="Defined at 49 in src/java/awt/image/WritableRaster.java.">WritableRaster</a> dst)  <em class="brace">{</em>
<a id="L952" name="L952"></a> 952 
<a id="L953" name="L953"></a> 953         <strong class="reserved">if</strong> (CSList.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != 2) <em class="brace">{</em>
<a id="L954" name="L954"></a> 954             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L955" name="L955"></a> 955                 "Destination ColorSpace is undefined");
<a id="L956" name="L956"></a> 956         <em class="brace">}</em>
<a id="L957" name="L957"></a> 957         <strong class="reserved">if</strong> (src.<a href="../D/21054.html" title="Multiple defined in 3 places.">getNumBands</a>() != CSList[0].<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>()) <em class="brace">{</em>
<a id="L958" name="L958"></a> 958             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L959" name="L959"></a> 959                 "Numbers of source Raster bands and source color space " +
<a id="L960" name="L960"></a> 960                 "components do not match");
<a id="L961" name="L961"></a> 961         <em class="brace">}</em>
<a id="L962" name="L962"></a> 962         <strong class="reserved">if</strong> (dst == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L963" name="L963"></a> 963             dst = <a href="../D/13705.html" title="Multiple defined in 7 places.">createCompatibleDestRaster</a>(src);
<a id="L964" name="L964"></a> 964         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L965" name="L965"></a> 965             <strong class="reserved">if</strong> (src.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>() != dst.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>() ||
<a id="L966" name="L966"></a> 966                 src.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>() != dst.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>()) <em class="brace">{</em>
<a id="L967" name="L967"></a> 967                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L968" name="L968"></a> 968                     "Width or height of Rasters do not match");
<a id="L969" name="L969"></a> 969             <em class="brace">}</em>
<a id="L970" name="L970"></a> 970             <strong class="reserved">if</strong> (dst.<a href="../D/21054.html" title="Multiple defined in 3 places.">getNumBands</a>() != CSList[1].<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>()) <em class="brace">{</em>
<a id="L971" name="L971"></a> 971                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L972" name="L972"></a> 972                     "Numbers of destination Raster bands and destination " +
<a id="L973" name="L973"></a> 973                     "color space components do not match");
<a id="L974" name="L974"></a> 974             <em class="brace">}</em>
<a id="L975" name="L975"></a> 975         <em class="brace">}</em>
<a id="L976" name="L976"></a> 976 
<a id="L977" name="L977"></a> 977         <strong class="reserved">if</strong> (srcMinVals == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L978" name="L978"></a> 978             <a href="../S/2278.html#L1097" title="Defined at 1097 in src/java/awt/image/ColorConvertOp.java.">getMinMaxValsFromColorSpaces</a>(CSList[0], CSList[1]);
<a id="L979" name="L979"></a> 979         <em class="brace">}</em>
<a id="L980" name="L980"></a> 980 
<a id="L981" name="L981"></a> 981         <a href="../S/2227.html#L81" title="Defined at 81 in src/java/awt/image/SampleModel.java.">SampleModel</a> srcSM = src.<a href="../D/22223.html" title="Multiple defined in 5 places.">getSampleModel</a>();
<a id="L982" name="L982"></a> 982         <a href="../S/2227.html#L81" title="Defined at 81 in src/java/awt/image/SampleModel.java.">SampleModel</a> dstSM = dst.<a href="../D/22223.html" title="Multiple defined in 5 places.">getSampleModel</a>();
<a id="L983" name="L983"></a> 983         <strong class="reserved">boolean</strong> srcIsFloat, dstIsFloat;
<a id="L984" name="L984"></a> 984         <strong class="reserved">int</strong> srcTransferType = src.<a href="../D/23246.html" title="Multiple defined in 4 places.">getTransferType</a>();
<a id="L985" name="L985"></a> 985         <strong class="reserved">int</strong> dstTransferType = dst.<a href="../D/23246.html" title="Multiple defined in 4 places.">getTransferType</a>();
<a id="L986" name="L986"></a> 986         <strong class="reserved">if</strong> ((srcTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_FLOAT) ||
<a id="L987" name="L987"></a> 987             (srcTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_DOUBLE)) <em class="brace">{</em>
<a id="L988" name="L988"></a> 988             srcIsFloat = <strong class="reserved">true</strong>;
<a id="L989" name="L989"></a> 989         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L990" name="L990"></a> 990             srcIsFloat = <strong class="reserved">false</strong>;
<a id="L991" name="L991"></a> 991         <em class="brace">}</em>
<a id="L992" name="L992"></a> 992         <strong class="reserved">if</strong> ((dstTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_FLOAT) ||
<a id="L993" name="L993"></a> 993             (dstTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_DOUBLE)) <em class="brace">{</em>
<a id="L994" name="L994"></a> 994             dstIsFloat = <strong class="reserved">true</strong>;
<a id="L995" name="L995"></a> 995         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L996" name="L996"></a> 996             dstIsFloat = <strong class="reserved">false</strong>;
<a id="L997" name="L997"></a> 997         <em class="brace">}</em>
<a id="L998" name="L998"></a> 998         <strong class="reserved">int</strong> w = src.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>();
<a id="L999" name="L999"></a> 999         <strong class="reserved">int</strong> h = src.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>();
<a id="L1000" name="L1000"></a>1000         <strong class="reserved">int</strong> srcNumBands = src.<a href="../D/21054.html" title="Multiple defined in 3 places.">getNumBands</a>();
<a id="L1001" name="L1001"></a>1001         <strong class="reserved">int</strong> dstNumBands = dst.<a href="../D/21054.html" title="Multiple defined in 3 places.">getNumBands</a>();
<a id="L1002" name="L1002"></a>1002         <strong class="reserved">float</strong>[] srcScaleFactor = <strong class="reserved">null</strong>;
<a id="L1003" name="L1003"></a>1003         <strong class="reserved">float</strong>[] dstScaleFactor = <strong class="reserved">null</strong>;
<a id="L1004" name="L1004"></a>1004         <strong class="reserved">if</strong> (!srcIsFloat) <em class="brace">{</em>
<a id="L1005" name="L1005"></a>1005             srcScaleFactor = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[srcNumBands];
<a id="L1006" name="L1006"></a>1006             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; srcNumBands; i++) <em class="brace">{</em>
<a id="L1007" name="L1007"></a>1007                 <strong class="reserved">if</strong> (srcTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_SHORT) <em class="brace">{</em>
<a id="L1008" name="L1008"></a>1008                     srcScaleFactor[i] = (srcMaxVals[i] - srcMinVals[i]) /
<a id="L1009" name="L1009"></a>1009                                         32767.0f;
<a id="L1010" name="L1010"></a>1010                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1011" name="L1011"></a>1011                     srcScaleFactor[i] = (srcMaxVals[i] - srcMinVals[i]) /
<a id="L1012" name="L1012"></a>1012                         ((<strong class="reserved">float</strong>) ((1 &lt;&lt; srcSM.<a href="../D/22227.html" title="Multiple defined in 8 places.">getSampleSize</a>(i)) - 1));
<a id="L1013" name="L1013"></a>1013                 <em class="brace">}</em>
<a id="L1014" name="L1014"></a>1014             <em class="brace">}</em>
<a id="L1015" name="L1015"></a>1015         <em class="brace">}</em>
<a id="L1016" name="L1016"></a>1016         <strong class="reserved">if</strong> (!dstIsFloat) <em class="brace">{</em>
<a id="L1017" name="L1017"></a>1017             dstScaleFactor = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[dstNumBands];
<a id="L1018" name="L1018"></a>1018             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; dstNumBands; i++) <em class="brace">{</em>
<a id="L1019" name="L1019"></a>1019                 <strong class="reserved">if</strong> (dstTransferType == <a href="../S/2284.html#L70" title="Defined at 70 in src/java/awt/image/DataBuffer.java.">DataBuffer</a>.TYPE_SHORT) <em class="brace">{</em>
<a id="L1020" name="L1020"></a>1020                     dstScaleFactor[i] = 32767.0f /
<a id="L1021" name="L1021"></a>1021                                         (dstMaxVals[i] - dstMinVals[i]);
<a id="L1022" name="L1022"></a>1022                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1023" name="L1023"></a>1023                     dstScaleFactor[i] =
<a id="L1024" name="L1024"></a>1024                         ((<strong class="reserved">float</strong>) ((1 &lt;&lt; dstSM.<a href="../D/22227.html" title="Multiple defined in 8 places.">getSampleSize</a>(i)) - 1)) /
<a id="L1025" name="L1025"></a>1025                         (dstMaxVals[i] - dstMinVals[i]);
<a id="L1026" name="L1026"></a>1026                 <em class="brace">}</em>
<a id="L1027" name="L1027"></a>1027             <em class="brace">}</em>
<a id="L1028" name="L1028"></a>1028         <em class="brace">}</em>
<a id="L1029" name="L1029"></a>1029         <strong class="reserved">int</strong> ys = src.<a href="../D/20652.html" title="Multiple defined in 6 places.">getMinY</a>();
<a id="L1030" name="L1030"></a>1030         <strong class="reserved">int</strong> yd = dst.<a href="../D/20652.html" title="Multiple defined in 6 places.">getMinY</a>();
<a id="L1031" name="L1031"></a>1031         <strong class="reserved">int</strong> xs, xd;
<a id="L1032" name="L1032"></a>1032         <strong class="reserved">float</strong> <a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a>;
<a id="L1033" name="L1033"></a>1033         <strong class="reserved">float</strong>[] color = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[srcNumBands];
<a id="L1034" name="L1034"></a>1034         <strong class="reserved">float</strong>[] tmpColor;
<a id="L1035" name="L1035"></a>1035         <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> srcColorSpace = CSList[0];
<a id="L1036" name="L1036"></a>1036         <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> dstColorSpace = CSList[1];
<a id="L1037" name="L1037"></a>1037         <em class="comment">// process each pixel</em>
<a id="L1038" name="L1038"></a>1038         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> y = 0; y &lt; h; y++, ys++, yd++) <em class="brace">{</em>
<a id="L1039" name="L1039"></a>1039             <em class="comment">// get src scanline</em>
<a id="L1040" name="L1040"></a>1040             xs = src.<a href="../D/20651.html" title="Multiple defined in 6 places.">getMinX</a>();
<a id="L1041" name="L1041"></a>1041             xd = dst.<a href="../D/20651.html" title="Multiple defined in 6 places.">getMinX</a>();
<a id="L1042" name="L1042"></a>1042             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = 0; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &lt; w; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>++, xs++, xd++) <em class="brace">{</em>
<a id="L1043" name="L1043"></a>1043                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; srcNumBands; i++) <em class="brace">{</em>
<a id="L1044" name="L1044"></a>1044                     <a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a> = src.<a href="../D/22222.html" title="Multiple defined in 4 places.">getSampleFloat</a>(xs, ys, i);
<a id="L1045" name="L1045"></a>1045                     <strong class="reserved">if</strong> (!srcIsFloat) <em class="brace">{</em>
<a id="L1046" name="L1046"></a>1046                         <a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a> = <a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a> * srcScaleFactor[i] + srcMinVals[i];
<a id="L1047" name="L1047"></a>1047                     <em class="brace">}</em>
<a id="L1048" name="L1048"></a>1048                     color[i] = <a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a>;
<a id="L1049" name="L1049"></a>1049                 <em class="brace">}</em>
<a id="L1050" name="L1050"></a>1050                 tmpColor = srcColorSpace.<a href="../D/35364.html" title="Multiple defined in 3 places.">toCIEXYZ</a>(color);
<a id="L1051" name="L1051"></a>1051                 tmpColor = dstColorSpace.<a href="../D/16587.html" title="Multiple defined in 3 places.">fromCIEXYZ</a>(tmpColor);
<a id="L1052" name="L1052"></a>1052                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; dstNumBands; i++) <em class="brace">{</em>
<a id="L1053" name="L1053"></a>1053                     <a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a> = tmpColor[i];
<a id="L1054" name="L1054"></a>1054                     <strong class="reserved">if</strong> (!dstIsFloat) <em class="brace">{</em>
<a id="L1055" name="L1055"></a>1055                         <a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a> = (<a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a> - dstMinVals[i]) * dstScaleFactor[i];
<a id="L1056" name="L1056"></a>1056                     <em class="brace">}</em>
<a id="L1057" name="L1057"></a>1057                     dst.<a href="../D/33797.html" title="Multiple defined in 14 places.">setSample</a>(xd, yd, i, <a href="../S/7544.html#L89" title="Defined at 89 in src/com/sun/corba/se/spi/monitoring/StatisticsAccumulator.java.">sample</a>);
<a id="L1058" name="L1058"></a>1058                 <em class="brace">}</em>
<a id="L1059" name="L1059"></a>1059             <em class="brace">}</em>
<a id="L1060" name="L1060"></a>1060         <em class="brace">}</em>
<a id="L1061" name="L1061"></a>1061         <strong class="reserved">return</strong> dst;
<a id="L1062" name="L1062"></a>1062     <em class="brace">}</em>
<a id="L1063" name="L1063"></a>1063 
<a id="L1064" name="L1064"></a>1064     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/2278.html#L562" title="Referred from 562 in src/java/awt/image/ColorConvertOp.java.">getMinMaxValsFromProfiles</a>(<a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a> srcProfile,
<a id="L1065" name="L1065"></a>1065                                            <a href="../S/2160.html#L94" title="Defined at 94 in src/java/awt/color/ICC_Profile.java.">ICC_Profile</a> dstProfile) <em class="brace">{</em>
<a id="L1066" name="L1066"></a>1066         <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = srcProfile.<a href="../D/17793.html" title="Multiple defined in 2 places.">getColorSpaceType</a>();
<a id="L1067" name="L1067"></a>1067         <strong class="reserved">int</strong> nc = srcProfile.<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>();
<a id="L1068" name="L1068"></a>1068         srcMinVals = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[nc];
<a id="L1069" name="L1069"></a>1069         srcMaxVals = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[nc];
<a id="L1070" name="L1070"></a>1070         <a href="../D/33255.html" title="Multiple defined in 2 places.">setMinMax</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, nc, srcMinVals, srcMaxVals);
<a id="L1071" name="L1071"></a>1071         <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = dstProfile.<a href="../D/17793.html" title="Multiple defined in 2 places.">getColorSpaceType</a>();
<a id="L1072" name="L1072"></a>1072         nc = dstProfile.<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>();
<a id="L1073" name="L1073"></a>1073         dstMinVals = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[nc];
<a id="L1074" name="L1074"></a>1074         dstMaxVals = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[nc];
<a id="L1075" name="L1075"></a>1075         <a href="../D/33255.html" title="Multiple defined in 2 places.">setMinMax</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, nc, dstMinVals, dstMaxVals);
<a id="L1076" name="L1076"></a>1076     <em class="brace">}</em>
<a id="L1077" name="L1077"></a>1077 
<a id="L1078" name="L1078"></a>1078     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/27754.html" title="Multiple referred from 3 places.">setMinMax</a>(<strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <strong class="reserved">int</strong> nc, <strong class="reserved">float</strong>[] minVals, <strong class="reserved">float</strong>[] maxVals) <em class="brace">{</em>
<a id="L1079" name="L1079"></a>1079         <strong class="reserved">if</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a>.TYPE_Lab) <em class="brace">{</em>
<a id="L1080" name="L1080"></a>1080             minVals[0] = 0.0f;    <em class="comment">// L</em>
<a id="L1081" name="L1081"></a>1081             maxVals[0] = 100.0f;
<a id="L1082" name="L1082"></a>1082             minVals[1] = -128.0f; <em class="comment">// a</em>
<a id="L1083" name="L1083"></a>1083             maxVals[1] = 127.0f;
<a id="L1084" name="L1084"></a>1084             minVals[2] = -128.0f; <em class="comment">// b</em>
<a id="L1085" name="L1085"></a>1085             maxVals[2] = 127.0f;
<a id="L1086" name="L1086"></a>1086         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> == <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a>.TYPE_XYZ) <em class="brace">{</em>
<a id="L1087" name="L1087"></a>1087             minVals[0] = minVals[1] = minVals[2] = 0.0f; <em class="comment">// X, Y, Z</em>
<a id="L1088" name="L1088"></a>1088             maxVals[0] = maxVals[1] = maxVals[2] = 1.0f + (32767.0f/ 32768.0f);
<a id="L1089" name="L1089"></a>1089         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1090" name="L1090"></a>1090             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nc; i++) <em class="brace">{</em>
<a id="L1091" name="L1091"></a>1091                 minVals[i] = 0.0f;
<a id="L1092" name="L1092"></a>1092                 maxVals[i] = 1.0f;
<a id="L1093" name="L1093"></a>1093             <em class="brace">}</em>
<a id="L1094" name="L1094"></a>1094         <em class="brace">}</em>
<a id="L1095" name="L1095"></a>1095     <em class="brace">}</em>
<a id="L1096" name="L1096"></a>1096 
<a id="L1097" name="L1097"></a>1097     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/17714.html" title="Multiple referred from 2 places.">getMinMaxValsFromColorSpaces</a>(<a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> srcCspace,
<a id="L1098" name="L1098"></a>1098                                               <a href="../S/2159.html#L98" title="Defined at 98 in src/java/awt/color/ColorSpace.java.">ColorSpace</a> dstCspace) <em class="brace">{</em>
<a id="L1099" name="L1099"></a>1099         <strong class="reserved">int</strong> nc = srcCspace.<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>();
<a id="L1100" name="L1100"></a>1100         srcMinVals = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[nc];
<a id="L1101" name="L1101"></a>1101         srcMaxVals = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[nc];
<a id="L1102" name="L1102"></a>1102         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nc; i++) <em class="brace">{</em>
<a id="L1103" name="L1103"></a>1103             srcMinVals[i] = srcCspace.<a href="../D/20649.html" title="Multiple defined in 5 places.">getMinValue</a>(i);
<a id="L1104" name="L1104"></a>1104             srcMaxVals[i] = srcCspace.<a href="../D/20486.html" title="Multiple defined in 5 places.">getMaxValue</a>(i);
<a id="L1105" name="L1105"></a>1105         <em class="brace">}</em>
<a id="L1106" name="L1106"></a>1106         nc = dstCspace.<a href="../D/21061.html" title="Multiple defined in 6 places.">getNumComponents</a>();
<a id="L1107" name="L1107"></a>1107         dstMinVals = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[nc];
<a id="L1108" name="L1108"></a>1108         dstMaxVals = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[nc];
<a id="L1109" name="L1109"></a>1109         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nc; i++) <em class="brace">{</em>
<a id="L1110" name="L1110"></a>1110             dstMinVals[i] = dstCspace.<a href="../D/20649.html" title="Multiple defined in 5 places.">getMinValue</a>(i);
<a id="L1111" name="L1111"></a>1111             dstMaxVals[i] = dstCspace.<a href="../D/20486.html" title="Multiple defined in 5 places.">getMaxValue</a>(i);
<a id="L1112" name="L1112"></a>1112         <em class="brace">}</em>
<a id="L1113" name="L1113"></a>1113     <em class="brace">}</em>
<a id="L1114" name="L1114"></a>1114 
<a id="L1115" name="L1115"></a>1115 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L229">[^]</a><a href="#L1097">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>