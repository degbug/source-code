<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/nio/channels/Channels.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L65">[^]</a><a href="#L609">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L65" title="Defined at 65.">checkNotNull</a></li>
<li><a href="#L74" title="Defined at 74.">writeFullyImpl</a></li>
<li><a href="#L90" title="Defined at 90.">writeFully</a></li>
<li><a href="#L123" title="Defined at 123.">newInputStream</a></li>
<li><a href="#L142" title="Defined at 142.">newOutputStream</a></li>
<li><a href="#L199" title="Defined at 199.">newInputStream</a></li>
<li><a href="#L273" title="Defined at 273.">newOutputStream</a></li>
<li><a href="#L346" title="Defined at 346.">newChannel</a></li>
<li><a href="#L371" title="Defined at 371.">read</a></li>
<li><a href="#L402" title="Defined at 402.">implCloseChannel</a></li>
<li><a href="#L421" title="Defined at 421.">newChannel</a></li>
<li><a href="#L446" title="Defined at 446.">write</a></li>
<li><a href="#L468" title="Defined at 468.">implCloseChannel</a></li>
<li><a href="#L503" title="Defined at 503.">newReader</a></li>
<li><a href="#L540" title="Defined at 540.">newReader</a></li>
<li><a href="#L572" title="Defined at 572.">newWriter</a></li>
<li><a href="#L609" title="Defined at 609.">newWriter</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.nio.channels;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.FileInputStream;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.io.FileOutputStream;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.io.InputStream;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.io.OutputStream;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> java.io.Reader;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> java.io.Writer;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> java.io.IOException;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> java.nio.ByteBuffer;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> java.nio.charset.Charset;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> java.nio.charset.CharsetDecoder;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> java.nio.charset.CharsetEncoder;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> java.nio.charset.UnsupportedCharsetException;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.nio.channels.spi.AbstractInterruptibleChannel;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> java.util.concurrent.ExecutionException;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> sun.nio.ch.ChannelInputStream;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> sun.nio.cs.StreamDecoder;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> sun.nio.cs.StreamEncoder;
<a id="L45" name="L45"></a>  45 
<a id="L46" name="L46"></a>  46 
<div class="comment">
  Utility methods for channels and streams.
  <p> This class defines static methods that support the interoperation of the
  stream classes of the <tt>{@link java.io}</tt> package with the channel
  classes of this package.  </p>
  @author Mark Reinhold
  @author Mike McCloskey
  @author JSR-51 Expert Group
  @since 1.4</div>
<a id="L60" name="L60"></a>  60 
<a id="L61" name="L61"></a>  61 <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/1250.html" title="Multiple referred from 6 places.">Channels</a> <em class="brace">{</em>
<a id="L62" name="L62"></a>  62 
<a id="L63" name="L63"></a>  63     <strong class="reserved">private</strong> Channels() <em class="brace">{</em> <em class="brace">}</em>              <em class="comment">// No instantiation</em>
<a id="L64" name="L64"></a>  64 
<a id="L65" name="L65"></a>  65     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/11267.html" title="Multiple referred from 30 places.">checkNotNull</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>) <em class="brace">{</em>
<a id="L66" name="L66"></a>  66         <strong class="reserved">if</strong> (<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> == <strong class="reserved">null</strong>)
<a id="L67" name="L67"></a>  67             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("\"" + <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> + "\" is null!");
<a id="L68" name="L68"></a>  68     <em class="brace">}</em>
<a id="L69" name="L69"></a>  69 
<div class="comment">
      Write all remaining bytes in buffer to the given channel.
      If the channel is selectable then it must be configured blocking.</div>
<a id="L74" name="L74"></a>  74     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/30631.html" title="Multiple referred from 2 places.">writeFullyImpl</a>(<a href="../S/2022.html#L48" title="Defined at 48 in src/java/nio/channels/WritableByteChannel.java.">WritableByteChannel</a> ch, <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb)
<a id="L75" name="L75"></a>  75         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L76" name="L76"></a>  76     <em class="brace">{</em>
<a id="L77" name="L77"></a>  77         <strong class="reserved">while</strong> (bb.<a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a>() &gt; 0) <em class="brace">{</em>
<a id="L78" name="L78"></a>  78             <strong class="reserved">int</strong> n = ch.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(bb);
<a id="L79" name="L79"></a>  79             <strong class="reserved">if</strong> (n &lt;= 0)
<a id="L80" name="L80"></a>  80                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>("no bytes written");
<a id="L81" name="L81"></a>  81         <em class="brace">}</em>
<a id="L82" name="L82"></a>  82     <em class="brace">}</em>
<a id="L83" name="L83"></a>  83 
<div class="comment">
      Write all remaining bytes in buffer to the given channel.
      @throws  IllegalBlockingModeException
               If the channel is selectable and configured non-blocking.</div>
<a id="L90" name="L90"></a>  90     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/2052.html#L174" title="Referred from 174 in src/java/nio/channels/Channels.java.">writeFully</a>(<a href="../S/2022.html#L48" title="Defined at 48 in src/java/nio/channels/WritableByteChannel.java.">WritableByteChannel</a> ch, <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb)
<a id="L91" name="L91"></a>  91         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L92" name="L92"></a>  92     <em class="brace">{</em>
<a id="L93" name="L93"></a>  93         <strong class="reserved">if</strong> (ch <strong class="reserved">instanceof</strong> <a href="../S/2030.html#L92" title="Defined at 92 in src/java/nio/channels/SelectableChannel.java.">SelectableChannel</a>) <em class="brace">{</em>
<a id="L94" name="L94"></a>  94             <a href="../S/2030.html#L92" title="Defined at 92 in src/java/nio/channels/SelectableChannel.java.">SelectableChannel</a> sc = (<a href="../S/2030.html#L92" title="Defined at 92 in src/java/nio/channels/SelectableChannel.java.">SelectableChannel</a>)ch;
<a id="L95" name="L95"></a>  95             <strong class="reserved">synchronized</strong> (sc.<a href="../D/11884.html" title="Multiple defined in 2 places.">blockingLock</a>()) <em class="brace">{</em>
<a id="L96" name="L96"></a>  96                 <strong class="reserved">if</strong> (!sc.<a href="../D/25251.html" title="Multiple defined in 2 places.">isBlocking</a>())
<a id="L97" name="L97"></a>  97                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/2026.html#L40" title="Defined at 40 in src/java/nio/channels/IllegalBlockingModeException.java.">IllegalBlockingModeException</a>();
<a id="L98" name="L98"></a>  98                 <a href="../S/2052.html#L74" title="Defined at 74 in src/java/nio/channels/Channels.java.">writeFullyImpl</a>(ch, bb);
<a id="L99" name="L99"></a>  99             <em class="brace">}</em>
<a id="L100" name="L100"></a> 100         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L101" name="L101"></a> 101             <a href="../S/2052.html#L74" title="Defined at 74 in src/java/nio/channels/Channels.java.">writeFullyImpl</a>(ch, bb);
<a id="L102" name="L102"></a> 102         <em class="brace">}</em>
<a id="L103" name="L103"></a> 103     <em class="brace">}</em>
<a id="L104" name="L104"></a> 104 
<a id="L105" name="L105"></a> 105     <em class="comment">// -- Byte streams from channels --</em>
<a id="L106" name="L106"></a> 106 
<div class="comment">
      Constructs a stream that reads bytes from the given channel.
      <p> The <tt>read</tt> methods of the resulting stream will throw an
      {@link IllegalBlockingModeException} if invoked while the underlying
      channel is in non-blocking mode.  The stream will not be buffered, and
      it will not support the {@link InputStream#mark mark} or {@link
      InputStream#reset reset} methods.  The stream will be safe for access by
      multiple concurrent threads.  Closing the stream will in turn cause the
      channel to be closed.  </p>
      @param  ch
              The channel from which bytes will be read
      @return  A new input stream</div>
<a id="L123" name="L123"></a> 123     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../R/23565.html" title="Multiple referred from 9 places.">newInputStream</a>(<a href="../S/2051.html#L48" title="Defined at 48 in src/java/nio/channels/ReadableByteChannel.java.">ReadableByteChannel</a> ch) <em class="brace">{</em>
<a id="L124" name="L124"></a> 124         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(ch, "ch");
<a id="L125" name="L125"></a> 125         <strong class="reserved">return</strong> <strong class="reserved">new</strong> sun.nio.ch.ChannelInputStream(ch);
<a id="L126" name="L126"></a> 126     <em class="brace">}</em>
<a id="L127" name="L127"></a> 127 
<div class="comment">
      Constructs a stream that writes bytes to the given channel.
      <p> The <tt>write</tt> methods of the resulting stream will throw an
      {@link IllegalBlockingModeException} if invoked while the underlying
      channel is in non-blocking mode.  The stream will not be buffered.  The
      stream will be safe for access by multiple concurrent threads.  Closing
      the stream will in turn cause the channel to be closed.  </p>
      @param  ch
              The channel to which bytes will be written
      @return  A new output stream</div>
<a id="L142" name="L142"></a> 142     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> <a href="../R/23591.html" title="Multiple referred from 7 places.">newOutputStream</a>(<strong class="reserved">final</strong> <a href="../S/2022.html#L48" title="Defined at 48 in src/java/nio/channels/WritableByteChannel.java.">WritableByteChannel</a> ch) <em class="brace">{</em>
<a id="L143" name="L143"></a> 143         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(ch, "ch");
<a id="L144" name="L144"></a> 144 
<a id="L145" name="L145"></a> 145         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a>() <em class="brace">{</em>
<a id="L146" name="L146"></a> 146 
<a id="L147" name="L147"></a> 147                 <strong class="reserved">private</strong> <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = <strong class="reserved">null</strong>;
<a id="L148" name="L148"></a> 148                 <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] bs = <strong class="reserved">null</strong>;       <em class="comment">// Invoker's previous array</em>
<a id="L149" name="L149"></a> 149                 <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] b1 = <strong class="reserved">null</strong>;
<a id="L150" name="L150"></a> 150 
<a id="L151" name="L151"></a> 151                 <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(<strong class="reserved">int</strong> b) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L152" name="L152"></a> 152                    <strong class="reserved">if</strong> (b1 == <strong class="reserved">null</strong>)
<a id="L153" name="L153"></a> 153                         b1 = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[1];
<a id="L154" name="L154"></a> 154                     b1[0] = (<strong class="reserved">byte</strong>)b;
<a id="L155" name="L155"></a> 155                     <strong class="reserved">this</strong>.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(b1);
<a id="L156" name="L156"></a> 156                 <em class="brace">}</em>
<a id="L157" name="L157"></a> 157 
<a id="L158" name="L158"></a> 158                 <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(<strong class="reserved">byte</strong>[] bs, <strong class="reserved">int</strong> off, <strong class="reserved">int</strong> len)
<a id="L159" name="L159"></a> 159                     <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L160" name="L160"></a> 160                 <em class="brace">{</em>
<a id="L161" name="L161"></a> 161                     <strong class="reserved">if</strong> ((off &lt; 0) || (off &gt; bs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) || (len &lt; 0) ||
<a id="L162" name="L162"></a> 162                         ((off + len) &gt; bs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) || ((off + len) &lt; 0)) <em class="brace">{</em>
<a id="L163" name="L163"></a> 163                         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1778.html#L38" title="Defined at 38 in src/java/lang/IndexOutOfBoundsException.java.">IndexOutOfBoundsException</a>();
<a id="L164" name="L164"></a> 164                     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (len == 0) <em class="brace">{</em>
<a id="L165" name="L165"></a> 165                         <strong class="reserved">return</strong>;
<a id="L166" name="L166"></a> 166                     <em class="brace">}</em>
<a id="L167" name="L167"></a> 167                     <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = ((<strong class="reserved">this</strong>.bs == bs)
<a id="L168" name="L168"></a> 168                                      ? <strong class="reserved">this</strong>.bb
<a id="L169" name="L169"></a> 169                                      : <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a>.<a href="../D/36957.html" title="Multiple defined in 35 places.">wrap</a>(bs));
<a id="L170" name="L170"></a> 170                     bb.<a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(off + len, bb.<a href="../D/12244.html" title="Multiple defined in 10 places.">capacity</a>()));
<a id="L171" name="L171"></a> 171                     bb.<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>(off);
<a id="L172" name="L172"></a> 172                     <strong class="reserved">this</strong>.bb = bb;
<a id="L173" name="L173"></a> 173                     <strong class="reserved">this</strong>.bs = bs;
<a id="L174" name="L174"></a> 174                     <a href="../S/2052.html#L61" title="Defined at 61 in src/java/nio/channels/Channels.java.">Channels</a>.<a href="../S/2052.html#L90" title="Defined at 90 in src/java/nio/channels/Channels.java.">writeFully</a>(ch, bb);
<a id="L175" name="L175"></a> 175                 <em class="brace">}</em>
<a id="L176" name="L176"></a> 176 
<a id="L177" name="L177"></a> 177                 <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L178" name="L178"></a> 178                     ch.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L179" name="L179"></a> 179                 <em class="brace">}</em>
<a id="L180" name="L180"></a> 180 
<a id="L181" name="L181"></a> 181             <em class="brace">}</em>;
<a id="L182" name="L182"></a> 182     <em class="brace">}</em>
<a id="L183" name="L183"></a> 183 
<div class="comment">
      Constructs a stream that reads bytes from the given channel.
      <p> The stream will not be buffered, and it will not support the {@link
      InputStream#mark mark} or {@link InputStream#reset reset} methods.  The
      stream will be safe for access by multiple concurrent threads.  Closing
      the stream will in turn cause the channel to be closed.  </p>
      @param  ch
              The channel from which bytes will be read
      @return  A new input stream
      @since 1.7</div>
<a id="L199" name="L199"></a> 199     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../R/23565.html" title="Multiple referred from 9 places.">newInputStream</a>(<strong class="reserved">final</strong> <a href="../S/2076.html#L53" title="Defined at 53 in src/java/nio/channels/AsynchronousByteChannel.java.">AsynchronousByteChannel</a> ch) <em class="brace">{</em>
<a id="L200" name="L200"></a> 200         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(ch, "ch");
<a id="L201" name="L201"></a> 201         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a>() <em class="brace">{</em>
<a id="L202" name="L202"></a> 202 
<a id="L203" name="L203"></a> 203             <strong class="reserved">private</strong> <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = <strong class="reserved">null</strong>;
<a id="L204" name="L204"></a> 204             <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] bs = <strong class="reserved">null</strong>;           <em class="comment">// Invoker's previous array</em>
<a id="L205" name="L205"></a> 205             <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] b1 = <strong class="reserved">null</strong>;
<a id="L206" name="L206"></a> 206 
<a id="L207" name="L207"></a> 207             @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L208" name="L208"></a> 208             <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">int</strong> <a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L209" name="L209"></a> 209                 <strong class="reserved">if</strong> (b1 == <strong class="reserved">null</strong>)
<a id="L210" name="L210"></a> 210                     b1 = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[1];
<a id="L211" name="L211"></a> 211                 <strong class="reserved">int</strong> n = <strong class="reserved">this</strong>.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(b1);
<a id="L212" name="L212"></a> 212                 <strong class="reserved">if</strong> (n == 1)
<a id="L213" name="L213"></a> 213                     <strong class="reserved">return</strong> b1[0] &amp; 0xff;
<a id="L214" name="L214"></a> 214                 <strong class="reserved">return</strong> -1;
<a id="L215" name="L215"></a> 215             <em class="brace">}</em>
<a id="L216" name="L216"></a> 216 
<a id="L217" name="L217"></a> 217             @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L218" name="L218"></a> 218             <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">int</strong> <a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(<strong class="reserved">byte</strong>[] bs, <strong class="reserved">int</strong> off, <strong class="reserved">int</strong> len)
<a id="L219" name="L219"></a> 219                 <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L220" name="L220"></a> 220             <em class="brace">{</em>
<a id="L221" name="L221"></a> 221                 <strong class="reserved">if</strong> ((off &lt; 0) || (off &gt; bs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) || (len &lt; 0) ||
<a id="L222" name="L222"></a> 222                     ((off + len) &gt; bs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) || ((off + len) &lt; 0)) <em class="brace">{</em>
<a id="L223" name="L223"></a> 223                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1778.html#L38" title="Defined at 38 in src/java/lang/IndexOutOfBoundsException.java.">IndexOutOfBoundsException</a>();
<a id="L224" name="L224"></a> 224                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (len == 0)
<a id="L225" name="L225"></a> 225                     <strong class="reserved">return</strong> 0;
<a id="L226" name="L226"></a> 226 
<a id="L227" name="L227"></a> 227                 <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = ((<strong class="reserved">this</strong>.bs == bs)
<a id="L228" name="L228"></a> 228                                  ? <strong class="reserved">this</strong>.bb
<a id="L229" name="L229"></a> 229                                  : <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a>.<a href="../D/36957.html" title="Multiple defined in 35 places.">wrap</a>(bs));
<a id="L230" name="L230"></a> 230                 bb.<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>(off);
<a id="L231" name="L231"></a> 231                 bb.<a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(off + len, bb.<a href="../D/12244.html" title="Multiple defined in 10 places.">capacity</a>()));
<a id="L232" name="L232"></a> 232                 <strong class="reserved">this</strong>.bb = bb;
<a id="L233" name="L233"></a> 233                 <strong class="reserved">this</strong>.bs = bs;
<a id="L234" name="L234"></a> 234 
<a id="L235" name="L235"></a> 235                 <strong class="reserved">boolean</strong> <a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a> = <strong class="reserved">false</strong>;
<a id="L236" name="L236"></a> 236                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L237" name="L237"></a> 237                     <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L238" name="L238"></a> 238                         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L239" name="L239"></a> 239                             <strong class="reserved">return</strong> ch.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(bb).<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L240" name="L240"></a> 240                         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1069.html#L47" title="Defined at 47 in src/java/util/concurrent/ExecutionException.java.">ExecutionException</a> ee) <em class="brace">{</em>
<a id="L241" name="L241"></a> 241                             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>(ee.<a href="../D/17525.html" title="Multiple defined in 41 places.">getCause</a>());
<a id="L242" name="L242"></a> 242                         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> ie) <em class="brace">{</em>
<a id="L243" name="L243"></a> 243                             <a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a> = <strong class="reserved">true</strong>;
<a id="L244" name="L244"></a> 244                         <em class="brace">}</em>
<a id="L245" name="L245"></a> 245                     <em class="brace">}</em>
<a id="L246" name="L246"></a> 246                 <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L247" name="L247"></a> 247                     <strong class="reserved">if</strong> (<a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a>)
<a id="L248" name="L248"></a> 248                         <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L264" title="Defined at 264 in src/java/lang/Thread.java.">currentThread</a>().<a href="../D/24969.html" title="Multiple defined in 3 places.">interrupt</a>();
<a id="L249" name="L249"></a> 249                 <em class="brace">}</em>
<a id="L250" name="L250"></a> 250             <em class="brace">}</em>
<a id="L251" name="L251"></a> 251 
<a id="L252" name="L252"></a> 252             @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L253" name="L253"></a> 253             <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L254" name="L254"></a> 254                 ch.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L255" name="L255"></a> 255             <em class="brace">}</em>
<a id="L256" name="L256"></a> 256         <em class="brace">}</em>;
<a id="L257" name="L257"></a> 257     <em class="brace">}</em>
<a id="L258" name="L258"></a> 258 
<div class="comment">
      Constructs a stream that writes bytes to the given channel.
      <p> The stream will not be buffered. The stream will be safe for access
      by multiple concurrent threads.  Closing the stream will in turn cause
      the channel to be closed.  </p>
      @param  ch
              The channel to which bytes will be written
      @return  A new output stream
      @since 1.7</div>
<a id="L273" name="L273"></a> 273     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> <a href="../R/23591.html" title="Multiple referred from 7 places.">newOutputStream</a>(<strong class="reserved">final</strong> <a href="../S/2076.html#L53" title="Defined at 53 in src/java/nio/channels/AsynchronousByteChannel.java.">AsynchronousByteChannel</a> ch) <em class="brace">{</em>
<a id="L274" name="L274"></a> 274         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(ch, "ch");
<a id="L275" name="L275"></a> 275         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a>() <em class="brace">{</em>
<a id="L276" name="L276"></a> 276 
<a id="L277" name="L277"></a> 277             <strong class="reserved">private</strong> <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = <strong class="reserved">null</strong>;
<a id="L278" name="L278"></a> 278             <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] bs = <strong class="reserved">null</strong>;   <em class="comment">// Invoker's previous array</em>
<a id="L279" name="L279"></a> 279             <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] b1 = <strong class="reserved">null</strong>;
<a id="L280" name="L280"></a> 280 
<a id="L281" name="L281"></a> 281             @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L282" name="L282"></a> 282             <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(<strong class="reserved">int</strong> b) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L283" name="L283"></a> 283                <strong class="reserved">if</strong> (b1 == <strong class="reserved">null</strong>)
<a id="L284" name="L284"></a> 284                     b1 = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[1];
<a id="L285" name="L285"></a> 285                 b1[0] = (<strong class="reserved">byte</strong>)b;
<a id="L286" name="L286"></a> 286                 <strong class="reserved">this</strong>.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(b1);
<a id="L287" name="L287"></a> 287             <em class="brace">}</em>
<a id="L288" name="L288"></a> 288 
<a id="L289" name="L289"></a> 289             @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L290" name="L290"></a> 290             <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(<strong class="reserved">byte</strong>[] bs, <strong class="reserved">int</strong> off, <strong class="reserved">int</strong> len)
<a id="L291" name="L291"></a> 291                 <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L292" name="L292"></a> 292             <em class="brace">{</em>
<a id="L293" name="L293"></a> 293                 <strong class="reserved">if</strong> ((off &lt; 0) || (off &gt; bs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) || (len &lt; 0) ||
<a id="L294" name="L294"></a> 294                     ((off + len) &gt; bs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) || ((off + len) &lt; 0)) <em class="brace">{</em>
<a id="L295" name="L295"></a> 295                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1778.html#L38" title="Defined at 38 in src/java/lang/IndexOutOfBoundsException.java.">IndexOutOfBoundsException</a>();
<a id="L296" name="L296"></a> 296                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (len == 0) <em class="brace">{</em>
<a id="L297" name="L297"></a> 297                     <strong class="reserved">return</strong>;
<a id="L298" name="L298"></a> 298                 <em class="brace">}</em>
<a id="L299" name="L299"></a> 299                 <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> bb = ((<strong class="reserved">this</strong>.bs == bs)
<a id="L300" name="L300"></a> 300                                  ? <strong class="reserved">this</strong>.bb
<a id="L301" name="L301"></a> 301                                  : <a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a>.<a href="../D/36957.html" title="Multiple defined in 35 places.">wrap</a>(bs));
<a id="L302" name="L302"></a> 302                 bb.<a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(off + len, bb.<a href="../D/12244.html" title="Multiple defined in 10 places.">capacity</a>()));
<a id="L303" name="L303"></a> 303                 bb.<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>(off);
<a id="L304" name="L304"></a> 304                 <strong class="reserved">this</strong>.bb = bb;
<a id="L305" name="L305"></a> 305                 <strong class="reserved">this</strong>.bs = bs;
<a id="L306" name="L306"></a> 306 
<a id="L307" name="L307"></a> 307                 <strong class="reserved">boolean</strong> <a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a> = <strong class="reserved">false</strong>;
<a id="L308" name="L308"></a> 308                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L309" name="L309"></a> 309                     <strong class="reserved">while</strong> (bb.<a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a>() &gt; 0) <em class="brace">{</em>
<a id="L310" name="L310"></a> 310                         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L311" name="L311"></a> 311                             ch.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(bb).<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L312" name="L312"></a> 312                         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1069.html#L47" title="Defined at 47 in src/java/util/concurrent/ExecutionException.java.">ExecutionException</a> ee) <em class="brace">{</em>
<a id="L313" name="L313"></a> 313                             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>(ee.<a href="../D/17525.html" title="Multiple defined in 41 places.">getCause</a>());
<a id="L314" name="L314"></a> 314                         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> ie) <em class="brace">{</em>
<a id="L315" name="L315"></a> 315                             <a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a> = <strong class="reserved">true</strong>;
<a id="L316" name="L316"></a> 316                         <em class="brace">}</em>
<a id="L317" name="L317"></a> 317                     <em class="brace">}</em>
<a id="L318" name="L318"></a> 318                 <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L319" name="L319"></a> 319                     <strong class="reserved">if</strong> (<a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a>)
<a id="L320" name="L320"></a> 320                         <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L264" title="Defined at 264 in src/java/lang/Thread.java.">currentThread</a>().<a href="../D/24969.html" title="Multiple defined in 3 places.">interrupt</a>();
<a id="L321" name="L321"></a> 321                 <em class="brace">}</em>
<a id="L322" name="L322"></a> 322             <em class="brace">}</em>
<a id="L323" name="L323"></a> 323 
<a id="L324" name="L324"></a> 324             @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L325" name="L325"></a> 325             <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L326" name="L326"></a> 326                 ch.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L327" name="L327"></a> 327             <em class="brace">}</em>
<a id="L328" name="L328"></a> 328         <em class="brace">}</em>;
<a id="L329" name="L329"></a> 329     <em class="brace">}</em>
<a id="L330" name="L330"></a> 330 
<a id="L331" name="L331"></a> 331 
<a id="L332" name="L332"></a> 332     <em class="comment">// -- Channels from streams --</em>
<a id="L333" name="L333"></a> 333 
<div class="comment">
      Constructs a channel that reads bytes from the given stream.
      <p> The resulting channel will not be buffered; it will simply redirect
      its I/O operations to the given stream.  Closing the channel will in
      turn cause the stream to be closed.  </p>
      @param  in
              The stream from which bytes are to be read
      @return  A new readable byte channel</div>
<a id="L346" name="L346"></a> 346     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/2051.html#L48" title="Defined at 48 in src/java/nio/channels/ReadableByteChannel.java.">ReadableByteChannel</a> newChannel(<strong class="reserved">final</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>) <em class="brace">{</em>
<a id="L347" name="L347"></a> 347         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>, "in");
<a id="L348" name="L348"></a> 348 
<a id="L349" name="L349"></a> 349         <strong class="reserved">if</strong> (<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> <strong class="reserved">instanceof</strong> <a href="../S/1386.html#L49" title="Defined at 49 in src/java/io/FileInputStream.java.">FileInputStream</a> &amp;&amp;
<a id="L350" name="L350"></a> 350             <a href="../S/1386.html#L49" title="Defined at 49 in src/java/io/FileInputStream.java.">FileInputStream</a>.<strong class="reserved">class</strong>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>())) <em class="brace">{</em>
<a id="L351" name="L351"></a> 351             <strong class="reserved">return</strong> ((<a href="../S/1386.html#L49" title="Defined at 49 in src/java/io/FileInputStream.java.">FileInputStream</a>)<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>).<a href="../D/17571.html" title="Multiple defined in 12 places.">getChannel</a>();
<a id="L352" name="L352"></a> 352         <em class="brace">}</em>
<a id="L353" name="L353"></a> 353 
<a id="L354" name="L354"></a> 354         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/2052.html#L357" title="Defined at 357 in src/java/nio/channels/Channels.java.">ReadableByteChannelImpl</a>(<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>);
<a id="L355" name="L355"></a> 355     <em class="brace">}</em>
<a id="L356" name="L356"></a> 356 
<a id="L357" name="L357"></a> 357     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> <a href="../S/2052.html#L354" title="Referred from 354 in src/java/nio/channels/Channels.java.">ReadableByteChannelImpl</a>
<a id="L358" name="L358"></a> 358         <strong class="reserved">extends</strong> <a href="../S/2045.html#L87" title="Defined at 87 in src/java/nio/channels/spi/AbstractInterruptibleChannel.java.">AbstractInterruptibleChannel</a>    <em class="comment">// Not really interruptible</em>
<a id="L359" name="L359"></a> 359         <strong class="reserved">implements</strong> <a href="../S/2051.html#L48" title="Defined at 48 in src/java/nio/channels/ReadableByteChannel.java.">ReadableByteChannel</a>
<a id="L360" name="L360"></a> 360     <em class="brace">{</em>
<a id="L361" name="L361"></a> 361         <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>;
<a id="L362" name="L362"></a> 362         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> TRANSFER_SIZE = 8192;
<a id="L363" name="L363"></a> 363         <strong class="reserved">private</strong> <strong class="reserved">byte</strong> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>[] = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[0];
<a id="L364" name="L364"></a> 364         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../D/28509.html" title="Multiple defined in 32 places.">open</a> = <strong class="reserved">true</strong>;
<a id="L365" name="L365"></a> 365         <strong class="reserved">private</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/30215.html" title="Multiple defined in 5 places.">readLock</a> = <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>();
<a id="L366" name="L366"></a> 366 
<a id="L367" name="L367"></a> 367         ReadableByteChannelImpl(<a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>) <em class="brace">{</em>
<a id="L368" name="L368"></a> 368             <strong class="reserved">this</strong>.<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> = <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>;
<a id="L369" name="L369"></a> 369         <em class="brace">}</em>
<a id="L370" name="L370"></a> 370 
<a id="L371" name="L371"></a> 371         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/25407.html" title="Multiple referred from 1300 places.">read</a>(<a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> dst) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L372" name="L372"></a> 372             <strong class="reserved">int</strong> len = dst.<a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a>();
<a id="L373" name="L373"></a> 373             <strong class="reserved">int</strong> totalRead = 0;
<a id="L374" name="L374"></a> 374             <strong class="reserved">int</strong> bytesRead = 0;
<a id="L375" name="L375"></a> 375             <strong class="reserved">synchronized</strong> (<a href="../D/30215.html" title="Multiple defined in 5 places.">readLock</a>) <em class="brace">{</em>
<a id="L376" name="L376"></a> 376                 <strong class="reserved">while</strong> (totalRead &lt; len) <em class="brace">{</em>
<a id="L377" name="L377"></a> 377                     <strong class="reserved">int</strong> bytesToRead = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>((len - totalRead),
<a id="L378" name="L378"></a> 378                                                TRANSFER_SIZE);
<a id="L379" name="L379"></a> 379                     <strong class="reserved">if</strong> (<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &lt; bytesToRead)
<a id="L380" name="L380"></a> 380                         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a> = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[bytesToRead];
<a id="L381" name="L381"></a> 381                     <strong class="reserved">if</strong> ((totalRead &gt; 0) &amp;&amp; !(<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.<a href="../D/11656.html" title="Multiple defined in 33 places.">available</a>() &gt; 0))
<a id="L382" name="L382"></a> 382                         <strong class="reserved">break</strong>; <em class="comment">// block at most once</em>
<a id="L383" name="L383"></a> 383                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L384" name="L384"></a> 384                         <a href="../D/11808.html" title="Multiple defined in 37 places.">begin</a>();
<a id="L385" name="L385"></a> 385                         bytesRead = <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>, 0, bytesToRead);
<a id="L386" name="L386"></a> 386                     <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L387" name="L387"></a> 387                         <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>(bytesRead &gt; 0);
<a id="L388" name="L388"></a> 388                     <em class="brace">}</em>
<a id="L389" name="L389"></a> 389                     <strong class="reserved">if</strong> (bytesRead &lt; 0)
<a id="L390" name="L390"></a> 390                         <strong class="reserved">break</strong>;
<a id="L391" name="L391"></a> 391                     <strong class="reserved">else</strong>
<a id="L392" name="L392"></a> 392                         totalRead += bytesRead;
<a id="L393" name="L393"></a> 393                     dst.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>, 0, bytesRead);
<a id="L394" name="L394"></a> 394                 <em class="brace">}</em>
<a id="L395" name="L395"></a> 395                 <strong class="reserved">if</strong> ((bytesRead &lt; 0) &amp;&amp; (totalRead == 0))
<a id="L396" name="L396"></a> 396                     <strong class="reserved">return</strong> -1;
<a id="L397" name="L397"></a> 397 
<a id="L398" name="L398"></a> 398                 <strong class="reserved">return</strong> totalRead;
<a id="L399" name="L399"></a> 399             <em class="brace">}</em>
<a id="L400" name="L400"></a> 400         <em class="brace">}</em>
<a id="L401" name="L401"></a> 401 
<a id="L402" name="L402"></a> 402         <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/20407.html" title="Multiple referred from 2 places.">implCloseChannel</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L403" name="L403"></a> 403             <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L404" name="L404"></a> 404             <a href="../D/28509.html" title="Multiple defined in 32 places.">open</a> = <strong class="reserved">false</strong>;
<a id="L405" name="L405"></a> 405         <em class="brace">}</em>
<a id="L406" name="L406"></a> 406     <em class="brace">}</em>
<a id="L407" name="L407"></a> 407 
<a id="L408" name="L408"></a> 408 
<div class="comment">
      Constructs a channel that writes bytes to the given stream.
      <p> The resulting channel will not be buffered; it will simply redirect
      its I/O operations to the given stream.  Closing the channel will in
      turn cause the stream to be closed.  </p>
      @param  out
              The stream to which bytes are to be written
      @return  A new writable byte channel</div>
<a id="L421" name="L421"></a> 421     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/2022.html#L48" title="Defined at 48 in src/java/nio/channels/WritableByteChannel.java.">WritableByteChannel</a> newChannel(<strong class="reserved">final</strong> <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>) <em class="brace">{</em>
<a id="L422" name="L422"></a> 422         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>, "out");
<a id="L423" name="L423"></a> 423 
<a id="L424" name="L424"></a> 424         <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> <strong class="reserved">instanceof</strong> <a href="../S/1382.html#L53" title="Defined at 53 in src/java/io/FileOutputStream.java.">FileOutputStream</a> &amp;&amp;
<a id="L425" name="L425"></a> 425             <a href="../S/1382.html#L53" title="Defined at 53 in src/java/io/FileOutputStream.java.">FileOutputStream</a>.<strong class="reserved">class</strong>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>())) <em class="brace">{</em>
<a id="L426" name="L426"></a> 426                 <strong class="reserved">return</strong> ((<a href="../S/1382.html#L53" title="Defined at 53 in src/java/io/FileOutputStream.java.">FileOutputStream</a>)<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>).<a href="../D/17571.html" title="Multiple defined in 12 places.">getChannel</a>();
<a id="L427" name="L427"></a> 427         <em class="brace">}</em>
<a id="L428" name="L428"></a> 428 
<a id="L429" name="L429"></a> 429         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/2052.html#L432" title="Defined at 432 in src/java/nio/channels/Channels.java.">WritableByteChannelImpl</a>(<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>);
<a id="L430" name="L430"></a> 430     <em class="brace">}</em>
<a id="L431" name="L431"></a> 431 
<a id="L432" name="L432"></a> 432     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> <a href="../S/2052.html#L429" title="Referred from 429 in src/java/nio/channels/Channels.java.">WritableByteChannelImpl</a>
<a id="L433" name="L433"></a> 433         <strong class="reserved">extends</strong> <a href="../S/2045.html#L87" title="Defined at 87 in src/java/nio/channels/spi/AbstractInterruptibleChannel.java.">AbstractInterruptibleChannel</a>    <em class="comment">// Not really interruptible</em>
<a id="L434" name="L434"></a> 434         <strong class="reserved">implements</strong> <a href="../S/2022.html#L48" title="Defined at 48 in src/java/nio/channels/WritableByteChannel.java.">WritableByteChannel</a>
<a id="L435" name="L435"></a> 435     <em class="brace">{</em>
<a id="L436" name="L436"></a> 436         <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>;
<a id="L437" name="L437"></a> 437         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> TRANSFER_SIZE = 8192;
<a id="L438" name="L438"></a> 438         <strong class="reserved">private</strong> <strong class="reserved">byte</strong> <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>[] = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[0];
<a id="L439" name="L439"></a> 439         <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../D/28509.html" title="Multiple defined in 32 places.">open</a> = <strong class="reserved">true</strong>;
<a id="L440" name="L440"></a> 440         <strong class="reserved">private</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/37100.html" title="Multiple defined in 7 places.">writeLock</a> = <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>();
<a id="L441" name="L441"></a> 441 
<a id="L442" name="L442"></a> 442         WritableByteChannelImpl(<a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>) <em class="brace">{</em>
<a id="L443" name="L443"></a> 443             <strong class="reserved">this</strong>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> = <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>;
<a id="L444" name="L444"></a> 444         <em class="brace">}</em>
<a id="L445" name="L445"></a> 445 
<a id="L446" name="L446"></a> 446         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/30544.html" title="Multiple referred from 1880 places.">write</a>(<a href="../D/1042.html" title="Multiple defined in 2 places.">ByteBuffer</a> src) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L447" name="L447"></a> 447             <strong class="reserved">int</strong> len = src.<a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a>();
<a id="L448" name="L448"></a> 448             <strong class="reserved">int</strong> totalWritten = 0;
<a id="L449" name="L449"></a> 449             <strong class="reserved">synchronized</strong> (<a href="../D/37100.html" title="Multiple defined in 7 places.">writeLock</a>) <em class="brace">{</em>
<a id="L450" name="L450"></a> 450                 <strong class="reserved">while</strong> (totalWritten &lt; len) <em class="brace">{</em>
<a id="L451" name="L451"></a> 451                     <strong class="reserved">int</strong> bytesToWrite = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>((len - totalWritten),
<a id="L452" name="L452"></a> 452                                                 TRANSFER_SIZE);
<a id="L453" name="L453"></a> 453                     <strong class="reserved">if</strong> (<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &lt; bytesToWrite)
<a id="L454" name="L454"></a> 454                         <a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a> = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[bytesToWrite];
<a id="L455" name="L455"></a> 455                     src.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>, 0, bytesToWrite);
<a id="L456" name="L456"></a> 456                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L457" name="L457"></a> 457                         <a href="../D/11808.html" title="Multiple defined in 37 places.">begin</a>();
<a id="L458" name="L458"></a> 458                         <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(<a href="../D/11927.html" title="Multiple defined in 8 places.">buf</a>, 0, bytesToWrite);
<a id="L459" name="L459"></a> 459                     <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L460" name="L460"></a> 460                         <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>(bytesToWrite &gt; 0);
<a id="L461" name="L461"></a> 461                     <em class="brace">}</em>
<a id="L462" name="L462"></a> 462                     totalWritten += bytesToWrite;
<a id="L463" name="L463"></a> 463                 <em class="brace">}</em>
<a id="L464" name="L464"></a> 464                 <strong class="reserved">return</strong> totalWritten;
<a id="L465" name="L465"></a> 465             <em class="brace">}</em>
<a id="L466" name="L466"></a> 466         <em class="brace">}</em>
<a id="L467" name="L467"></a> 467 
<a id="L468" name="L468"></a> 468         <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/20407.html" title="Multiple referred from 2 places.">implCloseChannel</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L469" name="L469"></a> 469             <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L470" name="L470"></a> 470             <a href="../D/28509.html" title="Multiple defined in 32 places.">open</a> = <strong class="reserved">false</strong>;
<a id="L471" name="L471"></a> 471         <em class="brace">}</em>
<a id="L472" name="L472"></a> 472     <em class="brace">}</em>
<a id="L473" name="L473"></a> 473 
<a id="L474" name="L474"></a> 474 
<a id="L475" name="L475"></a> 475     <em class="comment">// -- Character streams from channels --</em>
<a id="L476" name="L476"></a> 476 
<div class="comment">
      Constructs a reader that decodes bytes from the given channel using the
      given decoder.
      <p> The resulting stream will contain an internal input buffer of at
      least <tt>minBufferCap</tt> bytes.  The stream's <tt>read</tt> methods
      will, as needed, fill the buffer by reading bytes from the underlying
      channel; if the channel is in non-blocking mode when bytes are to be
      read then an {@link IllegalBlockingModeException} will be thrown.  The
      resulting stream will not otherwise be buffered, and it will not support
      the {@link Reader#mark mark} or {@link Reader#reset reset} methods.
      Closing the stream will in turn cause the channel to be closed.  </p>
      @param  ch
              The channel from which bytes will be read
      @param  dec
              The charset decoder to be used
      @param  minBufferCap
              The minimum capacity of the internal byte buffer,
              or <tt>-1</tt> if an implementation-dependent
              default capacity is to be used
      @return  A new reader</div>
<a id="L503" name="L503"></a> 503     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1412.html#L51" title="Defined at 51 in src/java/io/Reader.java.">Reader</a> <a href="../R/23601.html" title="Multiple referred from 2 places.">newReader</a>(<a href="../S/2051.html#L48" title="Defined at 48 in src/java/nio/channels/ReadableByteChannel.java.">ReadableByteChannel</a> ch,
<a id="L504" name="L504"></a> 504                                    <a href="../S/2001.html#L137" title="Defined at 137 in src/java/nio/charset/CharsetDecoder.java.">CharsetDecoder</a> <a href="../S/1118.html#L131" title="Defined at 131 in src/java/util/concurrent/ArrayBlockingQueue.java.">dec</a>,
<a id="L505" name="L505"></a> 505                                    <strong class="reserved">int</strong> minBufferCap)
<a id="L506" name="L506"></a> 506     <em class="brace">{</em>
<a id="L507" name="L507"></a> 507         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(ch, "ch");
<a id="L508" name="L508"></a> 508         <strong class="reserved">return</strong> StreamDecoder.forDecoder(ch, <a href="../S/1118.html#L131" title="Defined at 131 in src/java/util/concurrent/ArrayBlockingQueue.java.">dec</a>.<a href="../D/31151.html" title="Multiple defined in 296 places.">reset</a>(), minBufferCap);
<a id="L509" name="L509"></a> 509     <em class="brace">}</em>
<a id="L510" name="L510"></a> 510 
<div class="comment">
      Constructs a reader that decodes bytes from the given channel according
      to the named charset.
      <p> An invocation of this method of the form
      </p><blockquote><pre>      Channels.newReader(ch, csname)</pre></blockquote>
      behaves in exactly the same way as the expression
      <blockquote><pre>      Channels.newReader(ch,
                         Charset.forName(csName)
                             .newDecoder(),
                         -1);</pre></blockquote>
      @param  ch
              The channel from which bytes will be read
      @param  csName
              The name of the charset to be used
      @return  A new reader
      @throws  UnsupportedCharsetException
               If no support for the named charset is available
               in this instance of the Java virtual machine</div>
<a id="L540" name="L540"></a> 540     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1412.html#L51" title="Defined at 51 in src/java/io/Reader.java.">Reader</a> <a href="../R/23601.html" title="Multiple referred from 2 places.">newReader</a>(<a href="../S/2051.html#L48" title="Defined at 48 in src/java/nio/channels/ReadableByteChannel.java.">ReadableByteChannel</a> ch,
<a id="L541" name="L541"></a> 541                                    <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> csName)
<a id="L542" name="L542"></a> 542     <em class="brace">{</em>
<a id="L543" name="L543"></a> 543         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(csName, "csName");
<a id="L544" name="L544"></a> 544         <strong class="reserved">return</strong> <a href="../D/28060.html" title="Multiple defined in 2 places.">newReader</a>(ch, <a href="../S/2005.html#L271" title="Defined at 271 in src/java/nio/charset/Charset.java.">Charset</a>.<a href="../D/16518.html" title="Multiple defined in 6 places.">forName</a>(csName).<a href="../S/2005.html#L748" title="Defined at 748 in src/java/nio/charset/Charset.java.">newDecoder</a>(), -1);
<a id="L545" name="L545"></a> 545     <em class="brace">}</em>
<a id="L546" name="L546"></a> 546 
<div class="comment">
      Constructs a writer that encodes characters using the given encoder and
      writes the resulting bytes to the given channel.
      <p> The resulting stream will contain an internal output buffer of at
      least <tt>minBufferCap</tt> bytes.  The stream's <tt>write</tt> methods
      will, as needed, flush the buffer by writing bytes to the underlying
      channel; if the channel is in non-blocking mode when bytes are to be
      written then an {@link IllegalBlockingModeException} will be thrown.
      The resulting stream will not otherwise be buffered.  Closing the stream
      will in turn cause the channel to be closed.  </p>
      @param  ch
              The channel to which bytes will be written
      @param  enc
              The charset encoder to be used
      @param  minBufferCap
              The minimum capacity of the internal byte buffer,
              or <tt>-1</tt> if an implementation-dependent
              default capacity is to be used
      @return  A new writer</div>
<a id="L572" name="L572"></a> 572     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1393.html#L50" title="Defined at 50 in src/java/io/Writer.java.">Writer</a> <a href="../S/2052.html#L613" title="Referred from 613 in src/java/nio/channels/Channels.java.">newWriter</a>(<strong class="reserved">final</strong> <a href="../S/2022.html#L48" title="Defined at 48 in src/java/nio/channels/WritableByteChannel.java.">WritableByteChannel</a> ch,
<a id="L573" name="L573"></a> 573                                    <strong class="reserved">final</strong> <a href="../S/2009.html#L137" title="Defined at 137 in src/java/nio/charset/CharsetEncoder.java.">CharsetEncoder</a> enc,
<a id="L574" name="L574"></a> 574                                    <strong class="reserved">final</strong> <strong class="reserved">int</strong> minBufferCap)
<a id="L575" name="L575"></a> 575     <em class="brace">{</em>
<a id="L576" name="L576"></a> 576         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(ch, "ch");
<a id="L577" name="L577"></a> 577         <strong class="reserved">return</strong> StreamEncoder.forEncoder(ch, enc.<a href="../D/31151.html" title="Multiple defined in 296 places.">reset</a>(), minBufferCap);
<a id="L578" name="L578"></a> 578     <em class="brace">}</em>
<a id="L579" name="L579"></a> 579 
<div class="comment">
      Constructs a writer that encodes characters according to the named
      charset and writes the resulting bytes to the given channel.
      <p> An invocation of this method of the form
      </p><blockquote><pre>      Channels.newWriter(ch, csname)</pre></blockquote>
      behaves in exactly the same way as the expression
      <blockquote><pre>      Channels.newWriter(ch,
                         Charset.forName(csName)
                             .newEncoder(),
                         -1);</pre></blockquote>
      @param  ch
              The channel to which bytes will be written
      @param  csName
              The name of the charset to be used
      @return  A new writer
      @throws  UnsupportedCharsetException
               If no support for the named charset is available
               in this instance of the Java virtual machine</div>
<a id="L609" name="L609"></a> 609     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1393.html#L50" title="Defined at 50 in src/java/io/Writer.java.">Writer</a> <a href="../S/2052.html#L613" title="Referred from 613 in src/java/nio/channels/Channels.java.">newWriter</a>(<a href="../S/2022.html#L48" title="Defined at 48 in src/java/nio/channels/WritableByteChannel.java.">WritableByteChannel</a> ch,
<a id="L610" name="L610"></a> 610                                    <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> csName)
<a id="L611" name="L611"></a> 611     <em class="brace">{</em>
<a id="L612" name="L612"></a> 612         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(csName, "csName");
<a id="L613" name="L613"></a> 613         <strong class="reserved">return</strong> <a href="../D/28114.html" title="Multiple defined in 2 places.">newWriter</a>(ch, <a href="../S/2005.html#L271" title="Defined at 271 in src/java/nio/charset/Charset.java.">Charset</a>.<a href="../D/16518.html" title="Multiple defined in 6 places.">forName</a>(csName).<a href="../S/2005.html#L758" title="Defined at 758 in src/java/nio/charset/Charset.java.">newEncoder</a>(), -1);
<a id="L614" name="L614"></a> 614     <em class="brace">}</em>
<a id="L615" name="L615"></a> 615 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L65">[^]</a><a href="#L609">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>