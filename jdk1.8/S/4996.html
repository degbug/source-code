<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xpath/internal/compiler/OpMap.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L47">[^]</a><a href="#L420">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L47" title="Defined at 47.">toString</a></li>
<li><a href="#L57" title="Defined at 57.">getPatternString</a></li>
<li><a href="#L84" title="Defined at 84.">getTokenQueue</a></li>
<li><a href="#L96" title="Defined at 96.">getToken</a></li>
<li><a href="#L111" title="Defined at 111.">getTokenQueueSize</a></li>
<li><a href="#L133" title="Defined at 133.">getOpMap</a></li>
<li><a href="#L151" title="Defined at 151.">shrink</a></li>
<li><a href="#L176" title="Defined at 176.">getOp</a></li>
<li><a href="#L187" title="Defined at 187.">setOp</a></li>
<li><a href="#L200" title="Defined at 200.">getNextOpPos</a></li>
<li><a href="#L212" title="Defined at 212.">getNextStepPos</a></li>
<li><a href="#L258" title="Defined at 258.">getNextOpPos</a></li>
<li><a href="#L275" title="Defined at 275.">getFirstPredicateOpPos</a></li>
<li><a href="#L316" title="Defined at 316.">error</a></li>
<li><a href="#L333" title="Defined at 333.">getFirstChildPos</a></li>
<li><a href="#L345" title="Defined at 345.">getArgLength</a></li>
<li><a href="#L357" title="Defined at 357.">getArgLengthOfStep</a></li>
<li><a href="#L369" title="Defined at 369.">getFirstChildPosOfStep</a></li>
<li><a href="#L381" title="Defined at 381.">getStepTestType</a></li>
<li><a href="#L393" title="Defined at 393.">getStepNS</a></li>
<li><a href="#L420" title="Defined at 420.">getStepLocalName</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: OpMap.java,v 1.1.2.1 2005/08/01 01:30:31 jeffsuttor Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xpath.internal.compiler;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.res.XSLMessages;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.ObjectVector;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.patterns.NodeTest;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.res.XPATHErrorResources;
<a id="L29" name="L29"></a>  29 
<div class="comment">
  This class represents the data structure basics of the XPath
  object.</div>
<a id="L34" name="L34"></a>  34 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/5810.html" title="Multiple referred from 174 places.">OpMap</a>
<a id="L35" name="L35"></a>  35 <em class="brace">{</em>
<a id="L36" name="L36"></a>  36 
<div class="comment">
    The current pattern string, for diagnostics purposes</div>
<a id="L40" name="L40"></a>  40   <strong class="reserved">protected</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> m_currentPattern;
<a id="L41" name="L41"></a>  41 
<div class="comment">
    Return the expression as a string for diagnostics.
    @return The expression string.</div>
<a id="L47" name="L47"></a>  47   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>()
<a id="L48" name="L48"></a>  48   <em class="brace">{</em>
<a id="L49" name="L49"></a>  49     <strong class="reserved">return</strong> m_currentPattern;
<a id="L50" name="L50"></a>  50   <em class="brace">}</em>
<a id="L51" name="L51"></a>  51 
<div class="comment">
    Return the expression as a string for diagnostics.
    @return The expression string.</div>
<a id="L57" name="L57"></a>  57   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/18319.html" title="Multiple referred from 11 places.">getPatternString</a>()
<a id="L58" name="L58"></a>  58   <em class="brace">{</em>
<a id="L59" name="L59"></a>  59     <strong class="reserved">return</strong> m_currentPattern;
<a id="L60" name="L60"></a>  60   <em class="brace">}</em>
<a id="L61" name="L61"></a>  61 
<div class="comment">
    The starting size of the token queue.</div>
<a id="L65" name="L65"></a>  65   <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> MAXTOKENQUEUESIZE = 500;
<a id="L66" name="L66"></a>  66 
<div class="comment">
    Amount to grow token queue when it becomes full</div>
<a id="L70" name="L70"></a>  70   <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> BLOCKTOKENQUEUESIZE = 500;
<a id="L71" name="L71"></a>  71 
<div class="comment">
     TokenStack is the queue of used tokens. The current token is the token at the
    end of the m_tokenQueue. The idea is that the queue can be marked and a sequence
    of tokens can be reused.</div>
<a id="L77" name="L77"></a>  77   <a href="../S/5861.html#L35" title="Defined at 35 in src/com/sun/org/apache/xml/internal/utils/ObjectVector.java.">ObjectVector</a> m_tokenQueue = <strong class="reserved">new</strong> <a href="../S/5861.html#L35" title="Defined at 35 in src/com/sun/org/apache/xml/internal/utils/ObjectVector.java.">ObjectVector</a>(MAXTOKENQUEUESIZE, BLOCKTOKENQUEUESIZE);
<a id="L78" name="L78"></a>  78 
<div class="comment">
    Get the XPath as a list of tokens.
    @return ObjectVector of tokens.</div>
<a id="L84" name="L84"></a>  84   <strong class="reserved">public</strong> <a href="../S/5861.html#L35" title="Defined at 35 in src/com/sun/org/apache/xml/internal/utils/ObjectVector.java.">ObjectVector</a> <a href="../R/19525.html" title="Multiple referred from 9 places.">getTokenQueue</a>()
<a id="L85" name="L85"></a>  85   <em class="brace">{</em>
<a id="L86" name="L86"></a>  86     <strong class="reserved">return</strong> m_tokenQueue;
<a id="L87" name="L87"></a>  87   <em class="brace">}</em>
<a id="L88" name="L88"></a>  88 
<div class="comment">
    Get the XPath as a list of tokens.
    @param pos index into token queue.
    @return The token, normally a string.</div>
<a id="L96" name="L96"></a>  96   <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/19522.html" title="Multiple referred from 2 places.">getToken</a>(<strong class="reserved">int</strong> pos)
<a id="L97" name="L97"></a>  97   <em class="brace">{</em>
<a id="L98" name="L98"></a>  98     <strong class="reserved">return</strong> m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(pos);
<a id="L99" name="L99"></a>  99   <em class="brace">}</em>
<a id="L100" name="L100"></a> 100 
<div class="comment">
    The current size of the token queue.</div>
<a id="L104" name="L104"></a> 104 <em class="comment">//  public int m_tokenQueueSize = 0;</em>
<a id="L105" name="L105"></a> 105 
<div class="comment">
     Get size of the token queue.
    @return The size of the token queue.</div>
<a id="L111" name="L111"></a> 111   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/19527.html" title="Multiple referred from 10 places.">getTokenQueueSize</a>()
<a id="L112" name="L112"></a> 112   <em class="brace">{</em>
<a id="L113" name="L113"></a> 113     <strong class="reserved">return</strong> m_tokenQueue.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L114" name="L114"></a> 114 
<a id="L115" name="L115"></a> 115   <em class="brace">}</em>
<a id="L116" name="L116"></a> 116 
<div class="comment">
    An operations map is used instead of a proper parse tree.  It contains
    operations codes and indexes into the m_tokenQueue.
    I use an array instead of a full parse tree in order to cut down
    on the number of objects created.</div>
<a id="L123" name="L123"></a> 123   <a href="../S/5003.html#L33" title="Defined at 33 in src/com/sun/org/apache/xpath/internal/compiler/OpMapVector.java.">OpMapVector</a> m_opMap = <strong class="reserved">null</strong>;
<a id="L124" name="L124"></a> 124 
<div class="comment">
     Get the opcode list that describes the XPath operations.  It contains
    operations codes and indexes into the m_tokenQueue.
    I use an array instead of a full parse tree in order to cut down
    on the number of objects created.
    @return An IntVector that is the opcode list that describes the XPath operations.</div>
<a id="L133" name="L133"></a> 133   <strong class="reserved">public</strong> <a href="../S/5003.html#L33" title="Defined at 33 in src/com/sun/org/apache/xpath/internal/compiler/OpMapVector.java.">OpMapVector</a> getOpMap()
<a id="L134" name="L134"></a> 134   <em class="brace">{</em>
<a id="L135" name="L135"></a> 135     <strong class="reserved">return</strong> m_opMap;
<a id="L136" name="L136"></a> 136   <em class="brace">}</em>
<a id="L137" name="L137"></a> 137 
<a id="L138" name="L138"></a> 138   <em class="comment">// Position indexes</em>
<a id="L139" name="L139"></a> 139 
<div class="comment">
    The length is always the opcode position + 1.
    Length is always expressed as the opcode+length bytes,
    so it is always 2 or greater.</div>
<a id="L145" name="L145"></a> 145   <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> MAPINDEX_LENGTH = 1;
<a id="L146" name="L146"></a> 146 
<div class="comment">
    Replace the large arrays
    with a small array.</div>
<a id="L151" name="L151"></a> 151   <strong class="reserved">void</strong> <a href="../R/28583.html" title="Multiple referred from 3 places.">shrink</a>()
<a id="L152" name="L152"></a> 152   <em class="brace">{</em>
<a id="L153" name="L153"></a> 153 
<a id="L154" name="L154"></a> 154     <strong class="reserved">int</strong> n = m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(MAPINDEX_LENGTH);
<a id="L155" name="L155"></a> 155     m_opMap.<a href="../D/34164.html" title="Multiple defined in 2 places.">setToSize</a>(n + 4);
<a id="L156" name="L156"></a> 156 
<a id="L157" name="L157"></a> 157     m_opMap.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(0,n);
<a id="L158" name="L158"></a> 158     m_opMap.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(0,n+1);
<a id="L159" name="L159"></a> 159     m_opMap.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(0,n+2);
<a id="L160" name="L160"></a> 160 
<a id="L161" name="L161"></a> 161 
<a id="L162" name="L162"></a> 162     n = m_tokenQueue.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L163" name="L163"></a> 163     m_tokenQueue.<a href="../D/34164.html" title="Multiple defined in 2 places.">setToSize</a>(n + 4);
<a id="L164" name="L164"></a> 164 
<a id="L165" name="L165"></a> 165     m_tokenQueue.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<strong class="reserved">null</strong>,n);
<a id="L166" name="L166"></a> 166     m_tokenQueue.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<strong class="reserved">null</strong>,n + 1);
<a id="L167" name="L167"></a> 167     m_tokenQueue.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<strong class="reserved">null</strong>,n + 2);
<a id="L168" name="L168"></a> 168   <em class="brace">}</em>
<a id="L169" name="L169"></a> 169 
<div class="comment">
   Given an operation position, return the current op.
    @param opPos index into op map.
    @return the op that corresponds to the opPos argument.</div>
<a id="L176" name="L176"></a> 176   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/18133.html" title="Multiple referred from 168 places.">getOp</a>(<strong class="reserved">int</strong> opPos)
<a id="L177" name="L177"></a> 177   <em class="brace">{</em>
<a id="L178" name="L178"></a> 178     <strong class="reserved">return</strong> m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPos);
<a id="L179" name="L179"></a> 179   <em class="brace">}</em>
<a id="L180" name="L180"></a> 180 
<div class="comment">
   Set the op at index to the given int.
    @param opPos index into op map.
    @param value Value to set</div>
<a id="L187" name="L187"></a> 187   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27854.html" title="Multiple referred from 97 places.">setOp</a>(<strong class="reserved">int</strong> opPos, <strong class="reserved">int</strong> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>)
<a id="L188" name="L188"></a> 188   <em class="brace">{</em>
<a id="L189" name="L189"></a> 189      m_opMap.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>,opPos);
<a id="L190" name="L190"></a> 190   <em class="brace">}</em>
<a id="L191" name="L191"></a> 191 
<div class="comment">
    Given an operation position, return the end position, i.e. the
    beginning of the next operation.
    @param opPos An op position of an operation for which there is a size
                 entry following.
    @return position of next operation in m_opMap.</div>
<a id="L200" name="L200"></a> 200   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/17939.html" title="Multiple referred from 17 places.">getNextOpPos</a>(<strong class="reserved">int</strong> opPos)
<a id="L201" name="L201"></a> 201   <em class="brace">{</em>
<a id="L202" name="L202"></a> 202     <strong class="reserved">return</strong> opPos + m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPos + 1);
<a id="L203" name="L203"></a> 203   <em class="brace">}</em>
<a id="L204" name="L204"></a> 204 
<div class="comment">
    Given a location step position, return the end position, i.e. the
    beginning of the next step.
    @param opPos the position of a location step.
    @return the position of the next location step.</div>
<a id="L212" name="L212"></a> 212   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/17951.html" title="Multiple referred from 7 places.">getNextStepPos</a>(<strong class="reserved">int</strong> opPos)
<a id="L213" name="L213"></a> 213   <em class="brace">{</em>
<a id="L214" name="L214"></a> 214 
<a id="L215" name="L215"></a> 215     <strong class="reserved">int</strong> stepType = <a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(opPos);
<a id="L216" name="L216"></a> 216 
<a id="L217" name="L217"></a> 217     <strong class="reserved">if</strong> ((stepType &gt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.AXES_START_TYPES)
<a id="L218" name="L218"></a> 218             &amp;&amp; (stepType &lt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.AXES_END_TYPES))
<a id="L219" name="L219"></a> 219     <em class="brace">{</em>
<a id="L220" name="L220"></a> 220       <strong class="reserved">return</strong> <a href="../D/20927.html" title="Multiple defined in 2 places.">getNextOpPos</a>(opPos);
<a id="L221" name="L221"></a> 221     <em class="brace">}</em>
<a id="L222" name="L222"></a> 222     <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((stepType &gt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FIRST_NODESET_OP)
<a id="L223" name="L223"></a> 223              &amp;&amp; (stepType &lt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.LAST_NODESET_OP))
<a id="L224" name="L224"></a> 224     <em class="brace">{</em>
<a id="L225" name="L225"></a> 225       <strong class="reserved">int</strong> newOpPos = <a href="../D/20927.html" title="Multiple defined in 2 places.">getNextOpPos</a>(opPos);
<a id="L226" name="L226"></a> 226 
<a id="L227" name="L227"></a> 227       <strong class="reserved">while</strong> (<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_PREDICATE == <a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(newOpPos))
<a id="L228" name="L228"></a> 228       <em class="brace">{</em>
<a id="L229" name="L229"></a> 229         newOpPos = <a href="../D/20927.html" title="Multiple defined in 2 places.">getNextOpPos</a>(newOpPos);
<a id="L230" name="L230"></a> 230       <em class="brace">}</em>
<a id="L231" name="L231"></a> 231 
<a id="L232" name="L232"></a> 232       stepType = <a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(newOpPos);
<a id="L233" name="L233"></a> 233 
<a id="L234" name="L234"></a> 234       <strong class="reserved">if</strong> (!((stepType &gt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.AXES_START_TYPES)
<a id="L235" name="L235"></a> 235             &amp;&amp; (stepType &lt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.AXES_END_TYPES)))
<a id="L236" name="L236"></a> 236       <em class="brace">{</em>
<a id="L237" name="L237"></a> 237         <strong class="reserved">return</strong> <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ENDOP;
<a id="L238" name="L238"></a> 238       <em class="brace">}</em>
<a id="L239" name="L239"></a> 239 
<a id="L240" name="L240"></a> 240       <strong class="reserved">return</strong> newOpPos;
<a id="L241" name="L241"></a> 241     <em class="brace">}</em>
<a id="L242" name="L242"></a> 242     <strong class="reserved">else</strong>
<a id="L243" name="L243"></a> 243     <em class="brace">{</em>
<a id="L244" name="L244"></a> 244       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>(
<a id="L245" name="L245"></a> 245         <a href="../S/5961.html#L36" title="Defined at 36 in src/com/sun/org/apache/xalan/internal/res/XSLMessages.java.">XSLMessages</a>.<a href="../S/4842.html#L56" title="Defined at 56 in src/com/sun/org/apache/xpath/internal/res/XPATHMessages.java.">createXPATHMessage</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_UNKNOWN_STEP, <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em><a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(stepType)<em class="brace">}</em>));
<a id="L246" name="L246"></a> 246       <em class="comment">//"Programmer's assertion in getNextStepPos: unknown stepType: " + stepType);</em>
<a id="L247" name="L247"></a> 247     <em class="brace">}</em>
<a id="L248" name="L248"></a> 248   <em class="brace">}</em>
<a id="L249" name="L249"></a> 249 
<div class="comment">
    Given an operation position, return the end position, i.e. the
    beginning of the next operation.
    @param opMap The operations map.
    @param opPos index to operation, for which there is a size entry following.
    @return position of next operation in m_opMap.</div>
<a id="L258" name="L258"></a> 258   <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/17939.html" title="Multiple referred from 17 places.">getNextOpPos</a>(<strong class="reserved">int</strong>[] opMap, <strong class="reserved">int</strong> opPos)
<a id="L259" name="L259"></a> 259   <em class="brace">{</em>
<a id="L260" name="L260"></a> 260     <strong class="reserved">return</strong> opPos + opMap[opPos + 1];
<a id="L261" name="L261"></a> 261   <em class="brace">}</em>
<a id="L262" name="L262"></a> 262 
<div class="comment">
    Given an FROM_stepType position, return the position of the
    first predicate, if there is one, or else this will point
    to the end of the FROM_stepType.
    Example:
     int posOfPredicate = xpath.getNextOpPos(stepPos);
     boolean hasPredicates =
               OpCodes.OP_PREDICATE == xpath.getOp(posOfPredicate);
    @param opPos position of FROM_stepType op.
    @return position of predicate in FROM_stepType structure.</div>
<a id="L275" name="L275"></a> 275   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/16627.html" title="Multiple referred from 4 places.">getFirstPredicateOpPos</a>(<strong class="reserved">int</strong> opPos)
<a id="L276" name="L276"></a> 276      <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L277" name="L277"></a> 277   <em class="brace">{</em>
<a id="L278" name="L278"></a> 278 
<a id="L279" name="L279"></a> 279     <strong class="reserved">int</strong> stepType = m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPos);
<a id="L280" name="L280"></a> 280 
<a id="L281" name="L281"></a> 281     <strong class="reserved">if</strong> ((stepType &gt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.AXES_START_TYPES)
<a id="L282" name="L282"></a> 282             &amp;&amp; (stepType &lt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.AXES_END_TYPES))
<a id="L283" name="L283"></a> 283     <em class="brace">{</em>
<a id="L284" name="L284"></a> 284       <strong class="reserved">return</strong> opPos + m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPos + 2);
<a id="L285" name="L285"></a> 285     <em class="brace">}</em>
<a id="L286" name="L286"></a> 286     <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((stepType &gt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FIRST_NODESET_OP)
<a id="L287" name="L287"></a> 287              &amp;&amp; (stepType &lt;= <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.LAST_NODESET_OP))
<a id="L288" name="L288"></a> 288     <em class="brace">{</em>
<a id="L289" name="L289"></a> 289       <strong class="reserved">return</strong> opPos + m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPos + 1);
<a id="L290" name="L290"></a> 290     <em class="brace">}</em>
<a id="L291" name="L291"></a> 291     <strong class="reserved">else</strong> <strong class="reserved">if</strong>(-2 == stepType)
<a id="L292" name="L292"></a> 292     <em class="brace">{</em>
<a id="L293" name="L293"></a> 293       <strong class="reserved">return</strong> -2;
<a id="L294" name="L294"></a> 294     <em class="brace">}</em>
<a id="L295" name="L295"></a> 295     <strong class="reserved">else</strong>
<a id="L296" name="L296"></a> 296     <em class="brace">{</em>
<a id="L297" name="L297"></a> 297       <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(com.sun.org.apache.xpath.internal.res.<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_UNKNOWN_OPCODE,
<a id="L298" name="L298"></a> 298             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(stepType) <em class="brace">}</em>);  <em class="comment">//"ERROR! Unknown op code: "+m_opMap[opPos]);</em>
<a id="L299" name="L299"></a> 299       <strong class="reserved">return</strong> -1;
<a id="L300" name="L300"></a> 300     <em class="brace">}</em>
<a id="L301" name="L301"></a> 301   <em class="brace">}</em>
<a id="L302" name="L302"></a> 302 
<div class="comment">
    Tell the user of an error, and probably throw an
    exception.
    @param msg An error msgkey that corresponds to one of the constants found
               in {@link com.sun.org.apache.xpath.internal.res.XPATHErrorResources}, which is
               a key for a format string.
    @param args An array of arguments represented in the format string, which
                may be null.
    @throws TransformerException if the current ErrorListoner determines to
                                 throw an exception.</div>
<a id="L316" name="L316"></a> 316   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/14003.html" title="Multiple referred from 408 places.">error</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] args) <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L317" name="L317"></a> 317   <em class="brace">{</em>
<a id="L318" name="L318"></a> 318 
<a id="L319" name="L319"></a> 319     <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fmsg = com.sun.org.apache.xalan.internal.res.<a href="../S/5961.html#L36" title="Defined at 36 in src/com/sun/org/apache/xalan/internal/res/XSLMessages.java.">XSLMessages</a>.<a href="../S/4842.html#L56" title="Defined at 56 in src/com/sun/org/apache/xpath/internal/res/XPATHMessages.java.">createXPATHMessage</a>(<a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, args);
<a id="L320" name="L320"></a> 320 
<a id="L321" name="L321"></a> 321 
<a id="L322" name="L322"></a> 322     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>(fmsg);
<a id="L323" name="L323"></a> 323   <em class="brace">}</em>
<a id="L324" name="L324"></a> 324 
<a id="L325" name="L325"></a> 325 
<div class="comment">
    Go to the first child of a given operation.
    @param opPos position of operation.
    @return The position of the first child of the operation.</div>
<a id="L333" name="L333"></a> 333   <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/16608.html" title="Multiple referred from 19 places.">getFirstChildPos</a>(<strong class="reserved">int</strong> opPos)
<a id="L334" name="L334"></a> 334   <em class="brace">{</em>
<a id="L335" name="L335"></a> 335     <strong class="reserved">return</strong> opPos + 2;
<a id="L336" name="L336"></a> 336   <em class="brace">}</em>
<a id="L337" name="L337"></a> 337 
<div class="comment">
    Get the length of an operation.
    @param opPos The position of the operation in the op map.
    @return The size of the operation.</div>
<a id="L345" name="L345"></a> 345   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/15109.html" title="Multiple referred from 2 places.">getArgLength</a>(<strong class="reserved">int</strong> opPos)
<a id="L346" name="L346"></a> 346   <em class="brace">{</em>
<a id="L347" name="L347"></a> 347     <strong class="reserved">return</strong> m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPos + MAPINDEX_LENGTH);
<a id="L348" name="L348"></a> 348   <em class="brace">}</em>
<a id="L349" name="L349"></a> 349 
<div class="comment">
    Given a location step, get the length of that step.
    @param opPos Position of location step in op map.
    @return The length of the step.</div>
<a id="L357" name="L357"></a> 357   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/15110.html" title="Multiple referred from 8 places.">getArgLengthOfStep</a>(<strong class="reserved">int</strong> opPos)
<a id="L358" name="L358"></a> 358   <em class="brace">{</em>
<a id="L359" name="L359"></a> 359     <strong class="reserved">return</strong> m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPos + MAPINDEX_LENGTH + 1) - 3;
<a id="L360" name="L360"></a> 360   <em class="brace">}</em>
<a id="L361" name="L361"></a> 361 
<div class="comment">
    Get the first child position of a given location step.
    @param opPos Position of location step in the location map.
    @return The first child position of the step.</div>
<a id="L369" name="L369"></a> 369   <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/16609.html" title="Multiple referred from 4 places.">getFirstChildPosOfStep</a>(<strong class="reserved">int</strong> opPos)
<a id="L370" name="L370"></a> 370   <em class="brace">{</em>
<a id="L371" name="L371"></a> 371     <strong class="reserved">return</strong> opPos + 3;
<a id="L372" name="L372"></a> 372   <em class="brace">}</em>
<a id="L373" name="L373"></a> 373 
<div class="comment">
    Get the test type of the step, i.e. NODETYPE_XXX value.
    @param opPosOfStep The position of the FROM_XXX step.
    @return NODETYPE_XXX value.</div>
<a id="L381" name="L381"></a> 381   <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/4868.html#L630" title="Referred from 630 in src/com/sun/org/apache/xpath/internal/axes/WalkerFactory.java.">getStepTestType</a>(<strong class="reserved">int</strong> opPosOfStep)
<a id="L382" name="L382"></a> 382   <em class="brace">{</em>
<a id="L383" name="L383"></a> 383     <strong class="reserved">return</strong> m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPosOfStep + 3);  <em class="comment">// skip past op, len, len without predicates</em>
<a id="L384" name="L384"></a> 384   <em class="brace">}</em>
<a id="L385" name="L385"></a> 385 
<div class="comment">
    Get the namespace of the step.
    @param opPosOfStep The position of the FROM_XXX step.
    @return The step's namespace, NodeTest.WILD, or null for null namespace.</div>
<a id="L393" name="L393"></a> 393   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/19193.html" title="Multiple referred from 7 places.">getStepNS</a>(<strong class="reserved">int</strong> opPosOfStep)
<a id="L394" name="L394"></a> 394   <em class="brace">{</em>
<a id="L395" name="L395"></a> 395 
<a id="L396" name="L396"></a> 396     <strong class="reserved">int</strong> argLenOfStep = <a href="../S/4996.html#L357" title="Defined at 357 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getArgLengthOfStep</a>(opPosOfStep);
<a id="L397" name="L397"></a> 397 
<a id="L398" name="L398"></a> 398     <em class="comment">// System.out.println("getStepNS.argLenOfStep: "+argLenOfStep);</em>
<a id="L399" name="L399"></a> 399     <strong class="reserved">if</strong> (argLenOfStep == 3)
<a id="L400" name="L400"></a> 400     <em class="brace">{</em>
<a id="L401" name="L401"></a> 401       <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPosOfStep + 4);
<a id="L402" name="L402"></a> 402 
<a id="L403" name="L403"></a> 403       <strong class="reserved">if</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt;= 0)
<a id="L404" name="L404"></a> 404         <strong class="reserved">return</strong> (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>);
<a id="L405" name="L405"></a> 405       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ELEMWILDCARD == <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>)
<a id="L406" name="L406"></a> 406         <strong class="reserved">return</strong> <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.WILD;
<a id="L407" name="L407"></a> 407       <strong class="reserved">else</strong>
<a id="L408" name="L408"></a> 408         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L409" name="L409"></a> 409     <em class="brace">}</em>
<a id="L410" name="L410"></a> 410     <strong class="reserved">else</strong>
<a id="L411" name="L411"></a> 411       <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L412" name="L412"></a> 412   <em class="brace">}</em>
<a id="L413" name="L413"></a> 413 
<div class="comment">
    Get the local name of the step.
    @param opPosOfStep The position of the FROM_XXX step.
    @return OpCodes.EMPTY, OpCodes.ELEMWILDCARD, or the local name.</div>
<a id="L420" name="L420"></a> 420   <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/19192.html" title="Multiple referred from 11 places.">getStepLocalName</a>(<strong class="reserved">int</strong> opPosOfStep)
<a id="L421" name="L421"></a> 421   <em class="brace">{</em>
<a id="L422" name="L422"></a> 422 
<a id="L423" name="L423"></a> 423     <strong class="reserved">int</strong> argLenOfStep = <a href="../S/4996.html#L357" title="Defined at 357 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getArgLengthOfStep</a>(opPosOfStep);
<a id="L424" name="L424"></a> 424 
<a id="L425" name="L425"></a> 425     <em class="comment">// System.out.println("getStepLocalName.argLenOfStep: "+argLenOfStep);</em>
<a id="L426" name="L426"></a> 426     <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L427" name="L427"></a> 427 
<a id="L428" name="L428"></a> 428     <strong class="reserved">switch</strong> (argLenOfStep)
<a id="L429" name="L429"></a> 429     <em class="brace">{</em>
<a id="L430" name="L430"></a> 430     <strong class="reserved">case</strong> 0 :
<a id="L431" name="L431"></a> 431       <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.EMPTY;
<a id="L432" name="L432"></a> 432       <strong class="reserved">break</strong>;
<a id="L433" name="L433"></a> 433     <strong class="reserved">case</strong> 1 :
<a id="L434" name="L434"></a> 434       <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ELEMWILDCARD;
<a id="L435" name="L435"></a> 435       <strong class="reserved">break</strong>;
<a id="L436" name="L436"></a> 436     <strong class="reserved">case</strong> 2 :
<a id="L437" name="L437"></a> 437       <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPosOfStep + 4);
<a id="L438" name="L438"></a> 438       <strong class="reserved">break</strong>;
<a id="L439" name="L439"></a> 439     <strong class="reserved">case</strong> 3 :
<a id="L440" name="L440"></a> 440       <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = m_opMap.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(opPosOfStep + 5);
<a id="L441" name="L441"></a> 441       <strong class="reserved">break</strong>;
<a id="L442" name="L442"></a> 442     <strong class="reserved">default</strong> :
<a id="L443" name="L443"></a> 443       <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.EMPTY;
<a id="L444" name="L444"></a> 444       <strong class="reserved">break</strong>;  <em class="comment">// Should assert error</em>
<a id="L445" name="L445"></a> 445     <em class="brace">}</em>
<a id="L446" name="L446"></a> 446 
<a id="L447" name="L447"></a> 447     <em class="comment">// int index = (argLenOfStep == 3) ? m_opMap[opPosOfStep+5]</em>
<a id="L448" name="L448"></a> 448     <em class="comment">//                                  : ((argLenOfStep == 1) ? -3 : -2);</em>
<a id="L449" name="L449"></a> 449     <strong class="reserved">if</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt;= 0)
<a id="L450" name="L450"></a> 450       <strong class="reserved">return</strong> (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>).<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L451" name="L451"></a> 451     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ELEMWILDCARD == <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>)
<a id="L452" name="L452"></a> 452       <strong class="reserved">return</strong> <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>.WILD;
<a id="L453" name="L453"></a> 453     <strong class="reserved">else</strong>
<a id="L454" name="L454"></a> 454       <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L455" name="L455"></a> 455   <em class="brace">}</em>
<a id="L456" name="L456"></a> 456 
<a id="L457" name="L457"></a> 457 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L47">[^]</a><a href="#L420">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>