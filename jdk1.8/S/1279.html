<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/security/cert/X509CertSelector.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L174">[^]</a><a href="#L2603">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L174" title="Defined at 174.">setCertificate</a></li>
<li><a href="#L188" title="Defined at 188.">setSerialNumber</a></li>
<li><a href="#L202" title="Defined at 202.">setIssuer</a></li>
<li><a href="#L226" title="Defined at 226.">setIssuer</a></li>
<li><a href="#L276" title="Defined at 276.">setIssuer</a></li>
<li><a href="#L294" title="Defined at 294.">setSubject</a></li>
<li><a href="#L317" title="Defined at 317.">setSubject</a></li>
<li><a href="#L340" title="Defined at 340.">setSubject</a></li>
<li><a href="#L380" title="Defined at 380.">setSubjectKeyIdentifier</a></li>
<li><a href="#L441" title="Defined at 441.">setAuthorityKeyIdentifier</a></li>
<li><a href="#L461" title="Defined at 461.">setCertificateValid</a></li>
<li><a href="#L482" title="Defined at 482.">setPrivateKeyValid</a></li>
<li><a href="#L505" title="Defined at 505.">setSubjectPublicKeyAlgID</a></li>
<li><a href="#L521" title="Defined at 521.">setSubjectPublicKey</a></li>
<li><a href="#L564" title="Defined at 564.">setSubjectPublicKey</a></li>
<li><a href="#L589" title="Defined at 589.">setKeyUsage</a></li>
<li><a href="#L616" title="Defined at 616.">setExtendedKeyUsage</a></li>
<li><a href="#L646" title="Defined at 646.">setMatchAllSubjectAltNames</a></li>
<li><a href="#L697" title="Defined at 697.">setSubjectAlternativeNames</a></li>
<li><a href="#L753" title="Defined at 753.">addSubjectAlternativeName</a></li>
<li><a href="#L797" title="Defined at 797.">addSubjectAlternativeName</a></li>
<li><a href="#L813" title="Defined at 813.">addSubjectAlternativeNameInternal</a></li>
<li><a href="#L847" title="Defined at 847.">parseNames</a></li>
<li><a href="#L875" title="Defined at 875.">equalNames</a></li>
<li><a href="#L897" title="Defined at 897.">makeGeneralNameInterface</a></li>
<li><a href="#L1039" title="Defined at 1039.">setNameConstraints</a></li>
<li><a href="#L1065" title="Defined at 1065.">setBasicConstraints</a></li>
<li><a href="#L1092" title="Defined at 1092.">setPolicy</a></li>
<li><a href="#L1168" title="Defined at 1168.">setPathToNames</a></li>
<li><a href="#L1181" title="Defined at 1181.">setPathToNamesInternal</a></li>
<li><a href="#L1221" title="Defined at 1221.">addPathToName</a></li>
<li><a href="#L1250" title="Defined at 1250.">addPathToName</a></li>
<li><a href="#L1265" title="Defined at 1265.">addPathToNameInternal</a></li>
<li><a href="#L1289" title="Defined at 1289.">getCertificate</a></li>
<li><a href="#L1303" title="Defined at 1303.">getSerialNumber</a></li>
<li><a href="#L1317" title="Defined at 1317.">getIssuer</a></li>
<li><a href="#L1339" title="Defined at 1339.">getIssuerAsString</a></li>
<li><a href="#L1362" title="Defined at 1362.">getIssuerAsBytes</a></li>
<li><a href="#L1376" title="Defined at 1376.">getSubject</a></li>
<li><a href="#L1398" title="Defined at 1398.">getSubjectAsString</a></li>
<li><a href="#L1421" title="Defined at 1421.">getSubjectAsBytes</a></li>
<li><a href="#L1437" title="Defined at 1437.">getSubjectKeyIdentifier</a></li>
<li><a href="#L1456" title="Defined at 1456.">getAuthorityKeyIdentifier</a></li>
<li><a href="#L1475" title="Defined at 1475.">getCertificateValid</a></li>
<li><a href="#L1494" title="Defined at 1494.">getPrivateKeyValid</a></li>
<li><a href="#L1512" title="Defined at 1512.">getSubjectPublicKeyAlgID</a></li>
<li><a href="#L1527" title="Defined at 1527.">getSubjectPublicKey</a></li>
<li><a href="#L1545" title="Defined at 1545.">getKeyUsage</a></li>
<li><a href="#L1564" title="Defined at 1564.">getExtendedKeyUsage</a></li>
<li><a href="#L1584" title="Defined at 1584.">getMatchAllSubjectAltNames</a></li>
<li><a href="#L1621" title="Defined at 1621.">getSubjectAlternativeNames</a></li>
<li><a href="#L1648" title="Defined at 1648.">cloneNames</a></li>
<li><a href="#L1672" title="Defined at 1672.">cloneAndCheckNames</a></li>
<li><a href="#L1731" title="Defined at 1731.">getNameConstraints</a></li>
<li><a href="#L1749" title="Defined at 1749.">getBasicConstraints</a></li>
<li><a href="#L1765" title="Defined at 1765.">getPolicy</a></li>
<li><a href="#L1800" title="Defined at 1800.">getPathToNames</a></li>
<li><a href="#L1813" title="Defined at 1813.">toString</a></li>
<li><a href="#L1891" title="Defined at 1891.">keyUsageToString</a></li>
<li><a href="#L1947" title="Defined at 1947.">getExtensionObject</a></li>
<li><a href="#L1999" title="Defined at 1999.">match</a></li>
<li><a href="#L2100" title="Defined at 2100.">matchSubjectKeyID</a></li>
<li><a href="#L2134" title="Defined at 2134.">matchAuthorityKeyID</a></li>
<li><a href="#L2168" title="Defined at 2168.">matchPrivateKeyValid</a></li>
<li><a href="#L2224" title="Defined at 2224.">matchSubjectPublicKeyAlgID</a></li>
<li><a href="#L2259" title="Defined at 2259.">matchKeyUsage</a></li>
<li><a href="#L2280" title="Defined at 2280.">matchExtendedKeyUsage</a></li>
<li><a href="#L2311" title="Defined at 2311.">matchSubjectAlternativeNames</a></li>
<li><a href="#L2358" title="Defined at 2358.">matchNameConstraints</a></li>
<li><a href="#L2381" title="Defined at 2381.">matchPolicy</a></li>
<li><a href="#L2446" title="Defined at 2446.">matchPathToNames</a></li>
<li><a href="#L2489" title="Defined at 2489.">matchExcluded</a></li>
<li><a href="#L2520" title="Defined at 2520.">matchPermitted</a></li>
<li><a href="#L2562" title="Defined at 2562.">matchBasicConstraints</a></li>
<li><a href="#L2588" title="Defined at 2588.">SuppressWarnings</a></li>
<li><a href="#L2589" title="Defined at 2589.">cloneSet</a></li>
<li><a href="#L2603" title="Defined at 2603.">clone</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.IOException;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.math.BigInteger;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.security.PublicKey;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.util.*;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> javax.security.auth.x500.X500Principal;
<a id="L33" name="L33"></a>  33 
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> sun.misc.HexDumpEncoder;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> sun.security.util.Debug;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> sun.security.util.DerInputStream;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> sun.security.util.DerValue;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> sun.security.util.ObjectIdentifier;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> sun.security.x509.*;
<a id="L40" name="L40"></a>  40 
<div class="comment">
  A <code>CertSelector</code> that selects <code>X509Certificates</code> that
  match all specified criteria. This class is particularly useful when
  selecting certificates from a <code>CertStore</code> to build a
  PKIX-compliant certification path.
  <p>
  When first constructed, an <code>X509CertSelector</code> has no criteria
  enabled and each of the <code>get</code> methods return a default value
  (<code>null</code>, or <code>-1</code> for the {@link #getBasicConstraints
  getBasicConstraints} method). Therefore, the {@link #match match}
  method would return <code>true</code> for any <code>X509Certificate</code>.
  Typically, several criteria are enabled (by calling
  {@link #setIssuer setIssuer} or
  {@link #setKeyUsage setKeyUsage}, for instance) and then the
  <code>X509CertSelector</code> is passed to
  {@link CertStore#getCertificates CertStore.getCertificates} or some similar
  method.
  </p><p>
  Several criteria can be enabled (by calling {@link #setIssuer setIssuer}
  and {@link #setSerialNumber setSerialNumber},
  for example) such that the <code>match</code> method
  usually uniquely matches a single <code>X509Certificate</code>. We say
  usually, since it is possible for two issuing CAs to have the same
  distinguished name and each issue a certificate with the same serial
  number. Other unique combinations include the issuer, subject,
  subjectKeyIdentifier and/or the subjectPublicKey criteria.
  </p><p>
  Please refer to <a href="http://www.ietf.org/rfc/rfc3280.txt">RFC 3280:
  Internet X.509 Public Key Infrastructure Certificate and CRL Profile</a> for
  definitions of the X.509 certificate extensions mentioned below.
  </p><p>
  <b>Concurrent Access</b>
  </p><p>
  Unless otherwise specified, the methods defined in this class are not
  thread-safe. Multiple threads that need to access a single
  object concurrently should synchronize amongst themselves and
  provide the necessary locking. Multiple threads each manipulating
  separate objects need not synchronize.
  @see CertSelector
  @see X509Certificate
  @since       1.4
  @author      Steve Hanna</p></div>
<a id="L86" name="L86"></a>  86 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/8910.html" title="Multiple referred from 2 places.">X509CertSelector</a> <strong class="reserved">implements</strong> <a href="../S/1289.html#L49" title="Defined at 49 in src/java/security/cert/CertSelector.java.">CertSelector</a> <em class="brace">{</em>
<a id="L87" name="L87"></a>  87 
<a id="L88" name="L88"></a>  88     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a> <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> = <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>("certpath");
<a id="L89" name="L89"></a>  89 
<a id="L90" name="L90"></a>  90     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">static</strong> ObjectIdentifier ANY_EXTENDED_KEY_USAGE =
<a id="L91" name="L91"></a>  91         ObjectIdentifier.newInternal(<strong class="reserved">new</strong> <strong class="reserved">int</strong>[] <em class="brace">{</em>2, 5, 29, 37, 0<em class="brace">}</em>);
<a id="L92" name="L92"></a>  92 
<a id="L93" name="L93"></a>  93     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L94" name="L94"></a>  94         <a href="../S/1295.html#L40" title="Defined at 40 in src/java/security/cert/CertPathHelperImpl.java.">CertPathHelperImpl</a>.<a href="../D/24646.html" title="Multiple defined in 91 places.">initialize</a>();
<a id="L95" name="L95"></a>  95     <em class="brace">}</em>
<a id="L96" name="L96"></a>  96 
<a id="L97" name="L97"></a>  97     <strong class="reserved">private</strong> <a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> <a href="../S/997.html#L123" title="Defined at 123 in src/java/util/Timer.java.">serialNumber</a>;
<a id="L98" name="L98"></a>  98     <strong class="reserved">private</strong> <a href="../D/9807.html" title="Multiple defined in 2 places.">X500Principal</a> issuer;
<a id="L99" name="L99"></a>  99     <strong class="reserved">private</strong> <a href="../D/9807.html" title="Multiple defined in 2 places.">X500Principal</a> subject;
<a id="L100" name="L100"></a> 100     <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] subjectKeyID;
<a id="L101" name="L101"></a> 101     <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] authorityKeyID;
<a id="L102" name="L102"></a> 102     <strong class="reserved">private</strong> <a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a> certificateValid;
<a id="L103" name="L103"></a> 103     <strong class="reserved">private</strong> <a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a> privateKeyValid;
<a id="L104" name="L104"></a> 104     <strong class="reserved">private</strong> ObjectIdentifier subjectPublicKeyAlgID;
<a id="L105" name="L105"></a> 105     <strong class="reserved">private</strong> <a href="../S/1329.html#L46" title="Defined at 46 in src/java/security/PublicKey.java.">PublicKey</a> subjectPublicKey;
<a id="L106" name="L106"></a> 106     <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] subjectPublicKeyBytes;
<a id="L107" name="L107"></a> 107     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong>[] keyUsage;
<a id="L108" name="L108"></a> 108     <strong class="reserved">private</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; keyPurposeSet;
<a id="L109" name="L109"></a> 109     <strong class="reserved">private</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;ObjectIdentifier&gt; keyPurposeOIDSet;
<a id="L110" name="L110"></a> 110     <strong class="reserved">private</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; subjectAlternativeNames;
<a id="L111" name="L111"></a> 111     <strong class="reserved">private</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;GeneralNameInterface&gt; subjectAlternativeGeneralNames;
<a id="L112" name="L112"></a> 112     <strong class="reserved">private</strong> CertificatePolicySet policy;
<a id="L113" name="L113"></a> 113     <strong class="reserved">private</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; policySet;
<a id="L114" name="L114"></a> 114     <strong class="reserved">private</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; pathToNames;
<a id="L115" name="L115"></a> 115     <strong class="reserved">private</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;GeneralNameInterface&gt; pathToGeneralNames;
<a id="L116" name="L116"></a> 116     <strong class="reserved">private</strong> NameConstraintsExtension nc;
<a id="L117" name="L117"></a> 117     <strong class="reserved">private</strong> <strong class="reserved">byte</strong>[] ncBytes;
<a id="L118" name="L118"></a> 118     <strong class="reserved">private</strong> <strong class="reserved">int</strong> basicConstraints = -1;
<a id="L119" name="L119"></a> 119     <strong class="reserved">private</strong> <a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> x509Cert;
<a id="L120" name="L120"></a> 120     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> matchAllSubjectAltNames = <strong class="reserved">true</strong>;
<a id="L121" name="L121"></a> 121 
<a id="L122" name="L122"></a> 122     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1770.html#L43" title="Defined at 43 in src/java/lang/Boolean.java.">Boolean</a> FALSE = <a href="../S/1770.html#L43" title="Defined at 43 in src/java/lang/Boolean.java.">Boolean</a>.FALSE;
<a id="L123" name="L123"></a> 123 
<a id="L124" name="L124"></a> 124     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> PRIVATE_KEY_USAGE_ID = 0;
<a id="L125" name="L125"></a> 125     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> SUBJECT_ALT_NAME_ID = 1;
<a id="L126" name="L126"></a> 126     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_CONSTRAINTS_ID = 2;
<a id="L127" name="L127"></a> 127     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> CERT_POLICIES_ID = 3;
<a id="L128" name="L128"></a> 128     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> EXTENDED_KEY_USAGE_ID = 4;
<a id="L129" name="L129"></a> 129     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NUM_OF_EXTENSIONS = 5;
<a id="L130" name="L130"></a> 130     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] EXTENSION_OIDS = <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[NUM_OF_EXTENSIONS];
<a id="L131" name="L131"></a> 131 
<a id="L132" name="L132"></a> 132     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L133" name="L133"></a> 133         EXTENSION_OIDS[PRIVATE_KEY_USAGE_ID]  = "2.5.29.16";
<a id="L134" name="L134"></a> 134         EXTENSION_OIDS[SUBJECT_ALT_NAME_ID]   = "2.5.29.17";
<a id="L135" name="L135"></a> 135         EXTENSION_OIDS[NAME_CONSTRAINTS_ID]   = "2.5.29.30";
<a id="L136" name="L136"></a> 136         EXTENSION_OIDS[CERT_POLICIES_ID]      = "2.5.29.32";
<a id="L137" name="L137"></a> 137         EXTENSION_OIDS[EXTENDED_KEY_USAGE_ID] = "2.5.29.37";
<a id="L138" name="L138"></a> 138     <em class="brace">}</em>;
<a id="L139" name="L139"></a> 139 
<div class="comment">
     /* Constants representing the GeneralName types */</div>
<a id="L141" name="L141"></a> 141     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_ANY = 0;
<a id="L142" name="L142"></a> 142     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_RFC822 = 1;
<a id="L143" name="L143"></a> 143     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_DNS = 2;
<a id="L144" name="L144"></a> 144     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_X400 = 3;
<a id="L145" name="L145"></a> 145     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_DIRECTORY = 4;
<a id="L146" name="L146"></a> 146     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_EDI = 5;
<a id="L147" name="L147"></a> 147     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_URI = 6;
<a id="L148" name="L148"></a> 148     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_IP = 7;
<a id="L149" name="L149"></a> 149     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> NAME_OID = 8;
<a id="L150" name="L150"></a> 150 
<div class="comment">
      Creates an <code>X509CertSelector</code>. Initially, no criteria are set
      so any <code>X509Certificate</code> will match.</div>
<a id="L155" name="L155"></a> 155     <strong class="reserved">public</strong> X509CertSelector() <em class="brace">{</em>
<a id="L156" name="L156"></a> 156         <em class="comment">// empty</em>
<a id="L157" name="L157"></a> 157     <em class="brace">}</em>
<a id="L158" name="L158"></a> 158 
<div class="comment">
      Sets the certificateEquals criterion. The specified
      <code>X509Certificate</code> must be equal to the
      <code>X509Certificate</code> passed to the <code>match</code> method.
      If <code>null</code>, then this check is not applied.
      <p>This method is particularly useful when it is necessary to
      match a single certificate. Although other criteria can be specified
      in conjunction with the certificateEquals criterion, it is usually not
      practical or necessary.
      @param cert the <code>X509Certificate</code> to match (or
      <code>null</code>)
      @see #getCertificate</p></div>
<a id="L174" name="L174"></a> 174     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setCertificate(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> cert) <em class="brace">{</em>
<a id="L175" name="L175"></a> 175         x509Cert = cert;
<a id="L176" name="L176"></a> 176     <em class="brace">}</em>
<a id="L177" name="L177"></a> 177 
<div class="comment">
      Sets the serialNumber criterion. The specified serial number
      must match the certificate serial number in the
      <code>X509Certificate</code>. If <code>null</code>, any certificate
      serial number will do.
      @param serial the certificate serial number to match
             (or <code>null</code>)
      @see #getSerialNumber</div>
<a id="L188" name="L188"></a> 188     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSerialNumber(<a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> serial) <em class="brace">{</em>
<a id="L189" name="L189"></a> 189         <a href="../S/997.html#L123" title="Defined at 123 in src/java/util/Timer.java.">serialNumber</a> = serial;
<a id="L190" name="L190"></a> 190     <em class="brace">}</em>
<a id="L191" name="L191"></a> 191 
<div class="comment">
      Sets the issuer criterion. The specified distinguished name
      must match the issuer distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, any issuer
      distinguished name will do.
      @param issuer a distinguished name as X500Principal
                      (or <code>null</code>)
      @since 1.5</div>
<a id="L202" name="L202"></a> 202     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setIssuer(<a href="../D/9807.html" title="Multiple defined in 2 places.">X500Principal</a> issuer) <em class="brace">{</em>
<a id="L203" name="L203"></a> 203         <strong class="reserved">this</strong>.issuer = issuer;
<a id="L204" name="L204"></a> 204     <em class="brace">}</em>
<a id="L205" name="L205"></a> 205 
<div class="comment">
      <strong>Denigrated</strong>, use {@linkplain #setIssuer(X500Principal)}
      or {@linkplain #setIssuer(byte[])} instead. This method should not be
      relied on as it can fail to match some certificates because of a loss of
      encoding information in the
      <a href="http://www.ietf.org/rfc/rfc2253.txt">RFC 2253</a> String form
      of some distinguished names.
      <p>
      Sets the issuer criterion. The specified distinguished name
      must match the issuer distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, any issuer
      distinguished name will do.
      </p><p>
      If <code>issuerDN</code> is not <code>null</code>, it should contain a
      distinguished name, in RFC 2253 format.
      @param issuerDN a distinguished name in RFC 2253 format
                      (or <code>null</code>)
      @throws IOException if a parsing error occurs (incorrect form for DN)</p></div>
<a id="L226" name="L226"></a> 226     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setIssuer(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> issuerDN) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L227" name="L227"></a> 227         <strong class="reserved">if</strong> (issuerDN == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L228" name="L228"></a> 228             issuer = <strong class="reserved">null</strong>;
<a id="L229" name="L229"></a> 229         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L230" name="L230"></a> 230             issuer = <strong class="reserved">new</strong> X500Name(issuerDN).asX500Principal();
<a id="L231" name="L231"></a> 231         <em class="brace">}</em>
<a id="L232" name="L232"></a> 232     <em class="brace">}</em>
<a id="L233" name="L233"></a> 233 
<div class="comment">
      Sets the issuer criterion. The specified distinguished name
      must match the issuer distinguished name in the
      <code>X509Certificate</code>. If <code>null</code> is specified,
      the issuer criterion is disabled and any issuer distinguished name will
      do.
      <p>
      If <code>issuerDN</code> is not <code>null</code>, it should contain a
      single DER encoded distinguished name, as defined in X.501. The ASN.1
      notation for this structure is as follows.
      </p><pre>{@code
      Name ::= CHOICE {
        RDNSequence }
      RDNSequence ::= SEQUENCE OF RelativeDistinguishedName
      RelativeDistinguishedName ::=
        SET SIZE (1 .. MAX) OF AttributeTypeAndValue
      AttributeTypeAndValue ::= SEQUENCE {
        type     AttributeType,
        value    AttributeValue }
      AttributeType ::= OBJECT IDENTIFIER
      AttributeValue ::= ANY DEFINED BY AttributeType
      ....
      DirectoryString ::= CHOICE {
            teletexString           TeletexString (SIZE (1..MAX)),
            printableString         PrintableString (SIZE (1..MAX)),
            universalString         UniversalString (SIZE (1..MAX)),
            utf8String              UTF8String (SIZE (1.. MAX)),
            bmpString               BMPString (SIZE (1..MAX)) }
      }</pre>
      <p>
      Note that the byte array specified here is cloned to protect against
      subsequent modifications.
      @param issuerDN a byte array containing the distinguished name
                      in ASN.1 DER encoded form (or <code>null</code>)
      @throws IOException if an encoding error occurs (incorrect form for DN)</p></div>
<a id="L276" name="L276"></a> 276     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setIssuer(<strong class="reserved">byte</strong>[] issuerDN) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L277" name="L277"></a> 277         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L278" name="L278"></a> 278             issuer = (issuerDN == <strong class="reserved">null</strong> ? <strong class="reserved">null</strong> : <strong class="reserved">new</strong> <a href="../D/9807.html" title="Multiple defined in 2 places.">X500Principal</a>(issuerDN));
<a id="L279" name="L279"></a> 279         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> e) <em class="brace">{</em>
<a id="L280" name="L280"></a> 280             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("Invalid name", e);
<a id="L281" name="L281"></a> 281         <em class="brace">}</em>
<a id="L282" name="L282"></a> 282     <em class="brace">}</em>
<a id="L283" name="L283"></a> 283 
<div class="comment">
      Sets the subject criterion. The specified distinguished name
      must match the subject distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, any subject
      distinguished name will do.
      @param subject a distinguished name as X500Principal
                       (or <code>null</code>)
      @since 1.5</div>
<a id="L294" name="L294"></a> 294     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSubject(<a href="../D/9807.html" title="Multiple defined in 2 places.">X500Principal</a> subject) <em class="brace">{</em>
<a id="L295" name="L295"></a> 295         <strong class="reserved">this</strong>.subject = subject;
<a id="L296" name="L296"></a> 296     <em class="brace">}</em>
<a id="L297" name="L297"></a> 297 
<div class="comment">
      <strong>Denigrated</strong>, use {@linkplain #setSubject(X500Principal)}
      or {@linkplain #setSubject(byte[])} instead. This method should not be
      relied on as it can fail to match some certificates because of a loss of
      encoding information in the RFC 2253 String form of some distinguished
      names.
      <p>
      Sets the subject criterion. The specified distinguished name
      must match the subject distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, any subject
      distinguished name will do.
      </p><p>
      If <code>subjectDN</code> is not <code>null</code>, it should contain a
      distinguished name, in RFC 2253 format.
      @param subjectDN a distinguished name in RFC 2253 format
                       (or <code>null</code>)
      @throws IOException if a parsing error occurs (incorrect form for DN)</p></div>
<a id="L317" name="L317"></a> 317     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSubject(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> subjectDN) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L318" name="L318"></a> 318         <strong class="reserved">if</strong> (subjectDN == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L319" name="L319"></a> 319             subject = <strong class="reserved">null</strong>;
<a id="L320" name="L320"></a> 320         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L321" name="L321"></a> 321             subject = <strong class="reserved">new</strong> X500Name(subjectDN).asX500Principal();
<a id="L322" name="L322"></a> 322         <em class="brace">}</em>
<a id="L323" name="L323"></a> 323     <em class="brace">}</em>
<a id="L324" name="L324"></a> 324 
<div class="comment">
      Sets the subject criterion. The specified distinguished name
      must match the subject distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, any subject
      distinguished name will do.
      <p>
      If <code>subjectDN</code> is not <code>null</code>, it should contain a
      single DER encoded distinguished name, as defined in X.501. For the ASN.1
      notation for this structure, see
      {@link #setIssuer(byte [] issuerDN) setIssuer(byte [] issuerDN)}.
      @param subjectDN a byte array containing the distinguished name in
                       ASN.1 DER format (or <code>null</code>)
      @throws IOException if an encoding error occurs (incorrect form for DN)</p></div>
<a id="L340" name="L340"></a> 340     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSubject(<strong class="reserved">byte</strong>[] subjectDN) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L341" name="L341"></a> 341         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L342" name="L342"></a> 342             subject = (subjectDN == <strong class="reserved">null</strong> ? <strong class="reserved">null</strong> : <strong class="reserved">new</strong> <a href="../D/9807.html" title="Multiple defined in 2 places.">X500Principal</a>(subjectDN));
<a id="L343" name="L343"></a> 343         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> e) <em class="brace">{</em>
<a id="L344" name="L344"></a> 344             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("Invalid name", e);
<a id="L345" name="L345"></a> 345         <em class="brace">}</em>
<a id="L346" name="L346"></a> 346     <em class="brace">}</em>
<a id="L347" name="L347"></a> 347 
<div class="comment">
      Sets the subjectKeyIdentifier criterion. The
      <code>X509Certificate</code> must contain a SubjectKeyIdentifier
      extension for which the contents of the extension
      matches the specified criterion value.
      If the criterion value is <code>null</code>, no
      subjectKeyIdentifier check will be done.
      <p>
      If <code>subjectKeyID</code> is not <code>null</code>, it
      should contain a single DER encoded value corresponding to the contents
      of the extension value (not including the object identifier,
      criticality setting, and encapsulating OCTET STRING)
      for a SubjectKeyIdentifier extension.
      The ASN.1 notation for this structure follows.
      </p><pre>{@code
      SubjectKeyIdentifier ::= KeyIdentifier
      KeyIdentifier ::= OCTET STRING
      }</pre>
      <p>
      Since the format of subject key identifiers is not mandated by
      any standard, subject key identifiers are not parsed by the
      <code>X509CertSelector</code>. Instead, the values are compared using
      a byte-by-byte comparison.
      </p><p>
      Note that the byte array supplied here is cloned to protect against
      subsequent modifications.
      @param subjectKeyID the subject key identifier (or <code>null</code>)
      @see #getSubjectKeyIdentifier</p></div>
<a id="L380" name="L380"></a> 380     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSubjectKeyIdentifier(<strong class="reserved">byte</strong>[] subjectKeyID) <em class="brace">{</em>
<a id="L381" name="L381"></a> 381         <strong class="reserved">if</strong> (subjectKeyID == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L382" name="L382"></a> 382             <strong class="reserved">this</strong>.subjectKeyID = <strong class="reserved">null</strong>;
<a id="L383" name="L383"></a> 383         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L384" name="L384"></a> 384             <strong class="reserved">this</strong>.subjectKeyID = subjectKeyID.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L385" name="L385"></a> 385         <em class="brace">}</em>
<a id="L386" name="L386"></a> 386     <em class="brace">}</em>
<a id="L387" name="L387"></a> 387 
<div class="comment">
      Sets the authorityKeyIdentifier criterion. The
      <code>X509Certificate</code> must contain an
      AuthorityKeyIdentifier extension for which the contents of the
      extension value matches the specified criterion value.
      If the criterion value is <code>null</code>, no
      authorityKeyIdentifier check will be done.
      <p>
      If <code>authorityKeyID</code> is not <code>null</code>, it
      should contain a single DER encoded value corresponding to the contents
      of the extension value (not including the object identifier,
      criticality setting, and encapsulating OCTET STRING)
      for an AuthorityKeyIdentifier extension.
      The ASN.1 notation for this structure follows.
      </p><pre>{@code
      AuthorityKeyIdentifier ::= SEQUENCE {
         keyIdentifier             [0] KeyIdentifier           OPTIONAL,
         authorityCertIssuer       [1] GeneralNames            OPTIONAL,
         authorityCertSerialNumber [2] CertificateSerialNumber OPTIONAL  }
      KeyIdentifier ::= OCTET STRING
      }</pre>
      <p>
      Authority key identifiers are not parsed by the
      <code>X509CertSelector</code>.  Instead, the values are
      compared using a byte-by-byte comparison.
      </p><p>
      When the <code>keyIdentifier</code> field of
      <code>AuthorityKeyIdentifier</code> is populated, the value is
      usually taken from the <code>SubjectKeyIdentifier</code> extension
      in the issuer's certificate.  Note, however, that the result of
      {@code X509Certificate.getExtensionValue(<subjectkeyidentifier object identifier>)} on the issuer's certificate may NOT be used
      directly as the input to <code>setAuthorityKeyIdentifier</code>.
      This is because the SubjectKeyIdentifier contains
      only a KeyIdentifier OCTET STRING, and not a SEQUENCE of
      KeyIdentifier, GeneralNames, and CertificateSerialNumber.
      In order to use the extension value of the issuer certificate's
      <code>SubjectKeyIdentifier</code>
      extension, it will be necessary to extract the value of the embedded
      <code>KeyIdentifier</code> OCTET STRING, then DER encode this OCTET
      STRING inside a SEQUENCE.
      For more details on SubjectKeyIdentifier, see
      {@link #setSubjectKeyIdentifier(byte[] subjectKeyID)}.
      </subjectkeyidentifier></p><p>
      Note also that the byte array supplied here is cloned to protect against
      subsequent modifications.
      @param authorityKeyID the authority key identifier
             (or <code>null</code>)
      @see #getAuthorityKeyIdentifier</p></div>
<a id="L441" name="L441"></a> 441     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setAuthorityKeyIdentifier(<strong class="reserved">byte</strong>[] authorityKeyID) <em class="brace">{</em>
<a id="L442" name="L442"></a> 442         <strong class="reserved">if</strong> (authorityKeyID == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L443" name="L443"></a> 443             <strong class="reserved">this</strong>.authorityKeyID = <strong class="reserved">null</strong>;
<a id="L444" name="L444"></a> 444         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L445" name="L445"></a> 445             <strong class="reserved">this</strong>.authorityKeyID = authorityKeyID.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L446" name="L446"></a> 446         <em class="brace">}</em>
<a id="L447" name="L447"></a> 447     <em class="brace">}</em>
<a id="L448" name="L448"></a> 448 
<div class="comment">
      Sets the certificateValid criterion. The specified date must fall
      within the certificate validity period for the
      <code>X509Certificate</code>. If <code>null</code>, no certificateValid
      check will be done.
      <p>
      Note that the <code>Date</code> supplied here is cloned to protect
      against subsequent modifications.
      @param certValid the <code>Date</code> to check (or <code>null</code>)
      @see #getCertificateValid</p></div>
<a id="L461" name="L461"></a> 461     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setCertificateValid(<a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a> certValid) <em class="brace">{</em>
<a id="L462" name="L462"></a> 462         <strong class="reserved">if</strong> (certValid == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L463" name="L463"></a> 463             certificateValid = <strong class="reserved">null</strong>;
<a id="L464" name="L464"></a> 464         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L465" name="L465"></a> 465             certificateValid = (<a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a>)certValid.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L466" name="L466"></a> 466         <em class="brace">}</em>
<a id="L467" name="L467"></a> 467     <em class="brace">}</em>
<a id="L468" name="L468"></a> 468 
<div class="comment">
      Sets the privateKeyValid criterion. The specified date must fall
      within the private key validity period for the
      <code>X509Certificate</code>. If <code>null</code>, no privateKeyValid
      check will be done.
      <p>
      Note that the <code>Date</code> supplied here is cloned to protect
      against subsequent modifications.
      @param privateKeyValid the <code>Date</code> to check (or
                             <code>null</code>)
      @see #getPrivateKeyValid</p></div>
<a id="L482" name="L482"></a> 482     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setPrivateKeyValid(<a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a> privateKeyValid) <em class="brace">{</em>
<a id="L483" name="L483"></a> 483         <strong class="reserved">if</strong> (privateKeyValid == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L484" name="L484"></a> 484             <strong class="reserved">this</strong>.privateKeyValid = <strong class="reserved">null</strong>;
<a id="L485" name="L485"></a> 485         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L486" name="L486"></a> 486             <strong class="reserved">this</strong>.privateKeyValid = (<a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a>)privateKeyValid.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L487" name="L487"></a> 487         <em class="brace">}</em>
<a id="L488" name="L488"></a> 488     <em class="brace">}</em>
<a id="L489" name="L489"></a> 489 
<div class="comment">
      Sets the subjectPublicKeyAlgID criterion. The
      <code>X509Certificate</code> must contain a subject public key
      with the specified algorithm. If <code>null</code>, no
      subjectPublicKeyAlgID check will be done.
      @param oid The object identifier (OID) of the algorithm to check
                 for (or <code>null</code>). An OID is represented by a
                 set of nonnegative integers separated by periods.
      @throws IOException if the OID is invalid, such as
      the first component being not 0, 1 or 2 or the second component
      being greater than 39.
      @see #getSubjectPublicKeyAlgID</div>
<a id="L505" name="L505"></a> 505     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSubjectPublicKeyAlgID(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> oid) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L506" name="L506"></a> 506         <strong class="reserved">if</strong> (oid == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L507" name="L507"></a> 507             subjectPublicKeyAlgID = <strong class="reserved">null</strong>;
<a id="L508" name="L508"></a> 508         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L509" name="L509"></a> 509             subjectPublicKeyAlgID = <strong class="reserved">new</strong> ObjectIdentifier(oid);
<a id="L510" name="L510"></a> 510         <em class="brace">}</em>
<a id="L511" name="L511"></a> 511     <em class="brace">}</em>
<a id="L512" name="L512"></a> 512 
<div class="comment">
      Sets the subjectPublicKey criterion. The
      <code>X509Certificate</code> must contain the specified subject public
      key. If <code>null</code>, no subjectPublicKey check will be done.
      @param key the subject public key to check for (or <code>null</code>)
      @see #getSubjectPublicKey</div>
<a id="L521" name="L521"></a> 521     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSubjectPublicKey(<a href="../S/1329.html#L46" title="Defined at 46 in src/java/security/PublicKey.java.">PublicKey</a> <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>) <em class="brace">{</em>
<a id="L522" name="L522"></a> 522         <strong class="reserved">if</strong> (<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L523" name="L523"></a> 523             subjectPublicKey = <strong class="reserved">null</strong>;
<a id="L524" name="L524"></a> 524             subjectPublicKeyBytes = <strong class="reserved">null</strong>;
<a id="L525" name="L525"></a> 525         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L526" name="L526"></a> 526             subjectPublicKey = <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>;
<a id="L527" name="L527"></a> 527             subjectPublicKeyBytes = <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>.<a href="../D/18742.html" title="Multiple defined in 18 places.">getEncoded</a>();
<a id="L528" name="L528"></a> 528         <em class="brace">}</em>
<a id="L529" name="L529"></a> 529     <em class="brace">}</em>
<a id="L530" name="L530"></a> 530 
<div class="comment">
      Sets the subjectPublicKey criterion. The <code>X509Certificate</code>
      must contain the specified subject public key. If <code>null</code>,
      no subjectPublicKey check will be done.
      <p>
      Because this method allows the public key to be specified as a byte
      array, it may be used for unknown key types.
      </p><p>
      If <code>key</code> is not <code>null</code>, it should contain a
      single DER encoded SubjectPublicKeyInfo structure, as defined in X.509.
      The ASN.1 notation for this structure is as follows.
      </p><pre>{@code
      SubjectPublicKeyInfo  ::=  SEQUENCE  {
        algorithm            AlgorithmIdentifier,
        subjectPublicKey     BIT STRING  }
      AlgorithmIdentifier  ::=  SEQUENCE  {
        algorithm               OBJECT IDENTIFIER,
        parameters              ANY DEFINED BY algorithm OPTIONAL  }
                                   -- contains a value of the type
                                   -- registered for use with the
                                   -- algorithm object identifier value
      }</pre>
      <p>
      Note that the byte array supplied here is cloned to protect against
      subsequent modifications.
      @param key a byte array containing the subject public key in ASN.1 DER
                 form (or <code>null</code>)
      @throws IOException if an encoding error occurs (incorrect form for
      subject public key)
      @see #getSubjectPublicKey</p></div>
<a id="L564" name="L564"></a> 564     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSubjectPublicKey(<strong class="reserved">byte</strong>[] <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L565" name="L565"></a> 565         <strong class="reserved">if</strong> (<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L566" name="L566"></a> 566             subjectPublicKey = <strong class="reserved">null</strong>;
<a id="L567" name="L567"></a> 567             subjectPublicKeyBytes = <strong class="reserved">null</strong>;
<a id="L568" name="L568"></a> 568         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L569" name="L569"></a> 569             subjectPublicKeyBytes = <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L570" name="L570"></a> 570             subjectPublicKey = X509Key.<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<strong class="reserved">new</strong> DerValue(subjectPublicKeyBytes));
<a id="L571" name="L571"></a> 571         <em class="brace">}</em>
<a id="L572" name="L572"></a> 572     <em class="brace">}</em>
<a id="L573" name="L573"></a> 573 
<div class="comment">
      Sets the keyUsage criterion. The <code>X509Certificate</code>
      must allow the specified keyUsage values. If <code>null</code>, no
      keyUsage check will be done. Note that an <code>X509Certificate</code>
      that has no keyUsage extension implicitly allows all keyUsage values.
      <p>
      Note that the boolean array supplied here is cloned to protect against
      subsequent modifications.
      @param keyUsage a boolean array in the same format as the boolean
                      array returned by
      {@link X509Certificate#getKeyUsage() X509Certificate.getKeyUsage()}.
                      Or <code>null</code>.
      @see #getKeyUsage</p></div>
<a id="L589" name="L589"></a> 589     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setKeyUsage(<strong class="reserved">boolean</strong>[] keyUsage) <em class="brace">{</em>
<a id="L590" name="L590"></a> 590         <strong class="reserved">if</strong> (keyUsage == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L591" name="L591"></a> 591             <strong class="reserved">this</strong>.keyUsage = <strong class="reserved">null</strong>;
<a id="L592" name="L592"></a> 592         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L593" name="L593"></a> 593             <strong class="reserved">this</strong>.keyUsage = keyUsage.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L594" name="L594"></a> 594         <em class="brace">}</em>
<a id="L595" name="L595"></a> 595     <em class="brace">}</em>
<a id="L596" name="L596"></a> 596 
<div class="comment">
      Sets the extendedKeyUsage criterion. The <code>X509Certificate</code>
      must allow the specified key purposes in its extended key usage
      extension. If <code>keyPurposeSet</code> is empty or <code>null</code>,
      no extendedKeyUsage check will be done. Note that an
      <code>X509Certificate</code> that has no extendedKeyUsage extension
      implicitly allows all key purposes.
      <p>
      Note that the <code>Set</code> is cloned to protect against
      subsequent modifications.
      @param keyPurposeSet a <code>Set</code> of key purpose OIDs in string
      format (or <code>null</code>). Each OID is represented by a set of
      nonnegative integers separated by periods.
      @throws IOException if the OID is invalid, such as
      the first component being not 0, 1 or 2 or the second component
      being greater than 39.
      @see #getExtendedKeyUsage</p></div>
<a id="L616" name="L616"></a> 616     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setExtendedKeyUsage(<a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; keyPurposeSet) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L617" name="L617"></a> 617         <strong class="reserved">if</strong> ((keyPurposeSet == <strong class="reserved">null</strong>) || keyPurposeSet.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L618" name="L618"></a> 618             <strong class="reserved">this</strong>.keyPurposeSet = <strong class="reserved">null</strong>;
<a id="L619" name="L619"></a> 619             keyPurposeOIDSet = <strong class="reserved">null</strong>;
<a id="L620" name="L620"></a> 620         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L621" name="L621"></a> 621             <strong class="reserved">this</strong>.keyPurposeSet =
<a id="L622" name="L622"></a> 622                 <a href="../S/1147.html#L80" title="Defined at 80 in src/java/util/Collections.java.">Collections</a>.<a href="../S/1147.html#L1117" title="Defined at 1117 in src/java/util/Collections.java.">unmodifiableSet</a>(<strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt;(keyPurposeSet));
<a id="L623" name="L623"></a> 623             keyPurposeOIDSet = <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;ObjectIdentifier&gt;();
<a id="L624" name="L624"></a> 624             <strong class="reserved">for</strong> (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s : <strong class="reserved">this</strong>.keyPurposeSet) <em class="brace">{</em>
<a id="L625" name="L625"></a> 625                 keyPurposeOIDSet.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<strong class="reserved">new</strong> ObjectIdentifier(s));
<a id="L626" name="L626"></a> 626             <em class="brace">}</em>
<a id="L627" name="L627"></a> 627         <em class="brace">}</em>
<a id="L628" name="L628"></a> 628     <em class="brace">}</em>
<a id="L629" name="L629"></a> 629 
<div class="comment">
      Enables/disables matching all of the subjectAlternativeNames
      specified in the {@link #setSubjectAlternativeNames
      setSubjectAlternativeNames} or {@link #addSubjectAlternativeName
      addSubjectAlternativeName} methods. If enabled,
      the <code>X509Certificate</code> must contain all of the
      specified subject alternative names. If disabled, the
      <code>X509Certificate</code> must contain at least one of the
      specified subject alternative names.
      <p>The matchAllNames flag is <code>true</code> by default.
      @param matchAllNames if <code>true</code>, the flag is enabled;
      if <code>false</code>, the flag is disabled.
      @see #getMatchAllSubjectAltNames</p></div>
<a id="L646" name="L646"></a> 646     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setMatchAllSubjectAltNames(<strong class="reserved">boolean</strong> matchAllNames) <em class="brace">{</em>
<a id="L647" name="L647"></a> 647         <strong class="reserved">this</strong>.matchAllSubjectAltNames = matchAllNames;
<a id="L648" name="L648"></a> 648     <em class="brace">}</em>
<a id="L649" name="L649"></a> 649 
<div class="comment">
      Sets the subjectAlternativeNames criterion. The
      <code>X509Certificate</code> must contain all or at least one of the
      specified subjectAlternativeNames, depending on the value of
      the matchAllNames flag (see {@link #setMatchAllSubjectAltNames
      setMatchAllSubjectAltNames}).
      <p>
      This method allows the caller to specify, with a single method call,
      the complete set of subject alternative names for the
      subjectAlternativeNames criterion. The specified value replaces
      the previous value for the subjectAlternativeNames criterion.
      </p><p>
      The <code>names</code> parameter (if not <code>null</code>) is a
      <code>Collection</code> with one
      entry for each name to be included in the subject alternative name
      criterion. Each entry is a <code>List</code> whose first entry is an
      <code>Integer</code> (the name type, 0-8) and whose second
      entry is a <code>String</code> or a byte array (the name, in
      string or ASN.1 DER encoded form, respectively).
      There can be multiple names of the same type. If <code>null</code>
      is supplied as the value for this argument, no
      subjectAlternativeNames check will be performed.
      </p><p>
      Each subject alternative name in the <code>Collection</code>
      may be specified either as a <code>String</code> or as an ASN.1 encoded
      byte array. For more details about the formats used, see
      {@link #addSubjectAlternativeName(int type, String name)
      addSubjectAlternativeName(int type, String name)} and
      {@link #addSubjectAlternativeName(int type, byte [] name)
      addSubjectAlternativeName(int type, byte [] name)}.
      </p><p>
      <strong>Note:</strong> for distinguished names, specify the byte
      array form instead of the String form. See the note in
      {@link #addSubjectAlternativeName(int, String)} for more information.
      </p><p>
      Note that the <code>names</code> parameter can contain duplicate
      names (same name and name type), but they may be removed from the
      <code>Collection</code> of names returned by the
      {@link #getSubjectAlternativeNames getSubjectAlternativeNames} method.
      </p><p>
      Note that a deep copy is performed on the <code>Collection</code> to
      protect against subsequent modifications.
      @param names a <code>Collection</code> of names (or <code>null</code>)
      @throws IOException if a parsing error occurs
      @see #getSubjectAlternativeNames</p></div>
<a id="L697" name="L697"></a> 697     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setSubjectAlternativeNames(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; names)
<a id="L698" name="L698"></a> 698             <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L699" name="L699"></a> 699         <strong class="reserved">if</strong> (names == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L700" name="L700"></a> 700             subjectAlternativeNames = <strong class="reserved">null</strong>;
<a id="L701" name="L701"></a> 701             subjectAlternativeGeneralNames = <strong class="reserved">null</strong>;
<a id="L702" name="L702"></a> 702         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L703" name="L703"></a> 703             <strong class="reserved">if</strong> (names.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L704" name="L704"></a> 704                 subjectAlternativeNames = <strong class="reserved">null</strong>;
<a id="L705" name="L705"></a> 705                 subjectAlternativeGeneralNames = <strong class="reserved">null</strong>;
<a id="L706" name="L706"></a> 706                 <strong class="reserved">return</strong>;
<a id="L707" name="L707"></a> 707             <em class="brace">}</em>
<a id="L708" name="L708"></a> 708             <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; tempNames = <a href="../S/1279.html#L1672" title="Defined at 1672 in src/java/security/cert/X509CertSelector.java.">cloneAndCheckNames</a>(names);
<a id="L709" name="L709"></a> 709             <em class="comment">// Ensure that we either set both of these or neither</em>
<a id="L710" name="L710"></a> 710             subjectAlternativeGeneralNames = <a href="../S/1279.html#L847" title="Defined at 847 in src/java/security/cert/X509CertSelector.java.">parseNames</a>(tempNames);
<a id="L711" name="L711"></a> 711             subjectAlternativeNames = tempNames;
<a id="L712" name="L712"></a> 712         <em class="brace">}</em>
<a id="L713" name="L713"></a> 713     <em class="brace">}</em>
<a id="L714" name="L714"></a> 714 
<div class="comment">
      Adds a name to the subjectAlternativeNames criterion. The
      <code>X509Certificate</code> must contain all or at least one
      of the specified subjectAlternativeNames, depending on the value of
      the matchAllNames flag (see {@link #setMatchAllSubjectAltNames
      setMatchAllSubjectAltNames}).
      <p>
      This method allows the caller to add a name to the set of subject
      alternative names.
      The specified name is added to any previous value for the
      subjectAlternativeNames criterion. If the specified name is a
      duplicate, it may be ignored.
      </p><p>
      The name is provided in string format.
      <a href="http://www.ietf.org/rfc/rfc822.txt">RFC 822</a>, DNS, and URI
      names use the well-established string formats for those types (subject to
      the restrictions included in RFC 3280). IPv4 address names are
      supplied using dotted quad notation. OID address names are represented
      as a series of nonnegative integers separated by periods. And
      directory names (distinguished names) are supplied in RFC 2253 format.
      No standard string format is defined for otherNames, X.400 names,
      EDI party names, IPv6 address names, or any other type of names. They
      should be specified using the
      {@link #addSubjectAlternativeName(int type, byte [] name)
      addSubjectAlternativeName(int type, byte [] name)}
      method.
      </p><p>
      <strong>Note:</strong> for distinguished names, use
      {@linkplain #addSubjectAlternativeName(int, byte[])} instead.
      This method should not be relied on as it can fail to match some
      certificates because of a loss of encoding information in the RFC 2253
      String form of some distinguished names.
      @param type the name type (0-8, as specified in
                  RFC 3280, section 4.2.1.7)
      @param name the name in string form (not <code>null</code>)
      @throws IOException if a parsing error occurs</p></div>
<a id="L753" name="L753"></a> 753     <strong class="reserved">public</strong> <strong class="reserved">void</strong> addSubjectAlternativeName(<strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L754" name="L754"></a> 754             <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L755" name="L755"></a> 755         <a href="../S/1279.html#L813" title="Defined at 813 in src/java/security/cert/X509CertSelector.java.">addSubjectAlternativeNameInternal</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L756" name="L756"></a> 756     <em class="brace">}</em>
<a id="L757" name="L757"></a> 757 
<div class="comment">
      Adds a name to the subjectAlternativeNames criterion. The
      <code>X509Certificate</code> must contain all or at least one
      of the specified subjectAlternativeNames, depending on the value of
      the matchAllNames flag (see {@link #setMatchAllSubjectAltNames
      setMatchAllSubjectAltNames}).
      <p>
      This method allows the caller to add a name to the set of subject
      alternative names.
      The specified name is added to any previous value for the
      subjectAlternativeNames criterion. If the specified name is a
      duplicate, it may be ignored.
      </p><p>
      The name is provided as a byte array. This byte array should contain
      the DER encoded name, as it would appear in the GeneralName structure
      defined in RFC 3280 and X.509. The encoded byte array should only contain
      the encoded value of the name, and should not include the tag associated
      with the name in the GeneralName structure. The ASN.1 definition of this
      structure appears below.
      </p><pre>{@code
       GeneralName ::= CHOICE {
            otherName                       [0]     OtherName,
            rfc822Name                      [1]     IA5String,
            dNSName                         [2]     IA5String,
            x400Address                     [3]     ORAddress,
            directoryName                   [4]     Name,
            ediPartyName                    [5]     EDIPartyName,
            uniformResourceIdentifier       [6]     IA5String,
            iPAddress                       [7]     OCTET STRING,
            registeredID                    [8]     OBJECT IDENTIFIER}
      }</pre>
      <p>
      Note that the byte array supplied here is cloned to protect against
      subsequent modifications.
      @param type the name type (0-8, as listed above)
      @param name a byte array containing the name in ASN.1 DER encoded form
      @throws IOException if a parsing error occurs</p></div>
<a id="L797" name="L797"></a> 797     <strong class="reserved">public</strong> <strong class="reserved">void</strong> addSubjectAlternativeName(<strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <strong class="reserved">byte</strong>[] <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L798" name="L798"></a> 798             <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L799" name="L799"></a> 799         <em class="comment">// clone because byte arrays are modifiable</em>
<a id="L800" name="L800"></a> 800         <a href="../S/1279.html#L813" title="Defined at 813 in src/java/security/cert/X509CertSelector.java.">addSubjectAlternativeNameInternal</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>());
<a id="L801" name="L801"></a> 801     <em class="brace">}</em>
<a id="L802" name="L802"></a> 802 
<div class="comment">
      A private method that adds a name (String or byte array) to the
      subjectAlternativeNames criterion. The <code>X509Certificate</code>
      must contain the specified subjectAlternativeName.
      @param type the name type (0-8, as specified in
                  RFC 3280, section 4.2.1.7)
      @param name the name in string or byte array form
      @throws IOException if a parsing error occurs</div>
<a id="L813" name="L813"></a> 813     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/9976.html" title="Multiple referred from 2 places.">addSubjectAlternativeNameInternal</a>(<strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L814" name="L814"></a> 814             <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L815" name="L815"></a> 815         <em class="comment">// First, ensure that the name parses</em>
<a id="L816" name="L816"></a> 816         GeneralNameInterface tempName = <a href="../S/1279.html#L897" title="Defined at 897 in src/java/security/cert/X509CertSelector.java.">makeGeneralNameInterface</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L817" name="L817"></a> 817         <strong class="reserved">if</strong> (subjectAlternativeNames == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L818" name="L818"></a> 818             subjectAlternativeNames = <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt;();
<a id="L819" name="L819"></a> 819         <em class="brace">}</em>
<a id="L820" name="L820"></a> 820         <strong class="reserved">if</strong> (subjectAlternativeGeneralNames == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L821" name="L821"></a> 821             subjectAlternativeGeneralNames = <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;GeneralNameInterface&gt;();
<a id="L822" name="L822"></a> 822         <em class="brace">}</em>
<a id="L823" name="L823"></a> 823         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt; <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a> = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt;(2);
<a id="L824" name="L824"></a> 824         <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>));
<a id="L825" name="L825"></a> 825         <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L826" name="L826"></a> 826         subjectAlternativeNames.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>);
<a id="L827" name="L827"></a> 827         subjectAlternativeGeneralNames.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(tempName);
<a id="L828" name="L828"></a> 828     <em class="brace">}</em>
<a id="L829" name="L829"></a> 829 
<div class="comment">
      Parse an argument of the form passed to setSubjectAlternativeNames,
      returning a <code>Collection</code> of
      <code>GeneralNameInterface</code>s.
      Throw an IllegalArgumentException or a ClassCastException
      if the argument is malformed.
      @param names a Collection with one entry per name.
                   Each entry is a <code>List</code> whose first entry
                   is an Integer (the name type, 0-8) and whose second
                   entry is a String or a byte array (the name, in
                   string or ASN.1 DER encoded form, respectively).
                   There can be multiple names of the same type. Null is
                   not an acceptable value.
      @return a Set of <code>GeneralNameInterface</code>s
      @throws IOException if a parsing error occurs</div>
<a id="L847" name="L847"></a> 847     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;GeneralNameInterface&gt; <a href="../R/24580.html" title="Multiple referred from 2 places.">parseNames</a>(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; names) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L848" name="L848"></a> 848         <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;GeneralNameInterface&gt; genNames = <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;GeneralNameInterface&gt;();
<a id="L849" name="L849"></a> 849         <strong class="reserved">for</strong> (<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt; nameList : names) <em class="brace">{</em>
<a id="L850" name="L850"></a> 850             <strong class="reserved">if</strong> (nameList.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() != 2) <em class="brace">{</em>
<a id="L851" name="L851"></a> 851                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("name list size not 2");
<a id="L852" name="L852"></a> 852             <em class="brace">}</em>
<a id="L853" name="L853"></a> 853             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> =  nameList.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(0);
<a id="L854" name="L854"></a> 854             <strong class="reserved">if</strong> (!(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> <strong class="reserved">instanceof</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>)) <em class="brace">{</em>
<a id="L855" name="L855"></a> 855                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("expected an Integer");
<a id="L856" name="L856"></a> 856             <em class="brace">}</em>
<a id="L857" name="L857"></a> 857             <strong class="reserved">int</strong> nameType = ((<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>)<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>).<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>();
<a id="L858" name="L858"></a> 858             <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> = nameList.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(1);
<a id="L859" name="L859"></a> 859             genNames.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../S/1279.html#L897" title="Defined at 897 in src/java/security/cert/X509CertSelector.java.">makeGeneralNameInterface</a>(nameType, <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>));
<a id="L860" name="L860"></a> 860         <em class="brace">}</em>
<a id="L861" name="L861"></a> 861 
<a id="L862" name="L862"></a> 862         <strong class="reserved">return</strong> genNames;
<a id="L863" name="L863"></a> 863     <em class="brace">}</em>
<a id="L864" name="L864"></a> 864 
<div class="comment">
      Compare for equality two objects of the form passed to
      setSubjectAlternativeNames (or X509CRLSelector.setIssuerNames).
      Throw an <code>IllegalArgumentException</code> or a
      <code>ClassCastException</code> if one of the objects is malformed.
      @param object1 a Collection containing the first object to compare
      @param object2 a Collection containing the second object to compare
      @return true if the objects are equal, false otherwise</div>
<a id="L875" name="L875"></a> 875     <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> equalNames(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;?&gt; object1, <a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;?&gt; object2) <em class="brace">{</em>
<a id="L876" name="L876"></a> 876         <strong class="reserved">if</strong> ((object1 == <strong class="reserved">null</strong>) || (object2 == <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L877" name="L877"></a> 877             <strong class="reserved">return</strong> object1 == object2;
<a id="L878" name="L878"></a> 878         <em class="brace">}</em>
<a id="L879" name="L879"></a> 879         <strong class="reserved">return</strong> object1.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(object2);
<a id="L880" name="L880"></a> 880     <em class="brace">}</em>
<a id="L881" name="L881"></a> 881 
<div class="comment">
      Make a <code>GeneralNameInterface</code> out of a name type (0-8) and an
      Object that may be a byte array holding the ASN.1 DER encoded
      name or a String form of the name.  Except for X.509
      Distinguished Names, the String form of the name must not be the
      result from calling toString on an existing GeneralNameInterface
      implementing class.  The output of toString is not compatible
      with the String constructors for names other than Distinguished
      Names.
      @param type name type (0-8)
      @param name name as ASN.1 Der-encoded byte array or String
      @return a GeneralNameInterface name
      @throws IOException if a parsing error occurs</div>
<a id="L897" name="L897"></a> 897     <strong class="reserved">static</strong> GeneralNameInterface <a href="../R/22889.html" title="Multiple referred from 3 places.">makeGeneralNameInterface</a>(<strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L898" name="L898"></a> 898             <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L899" name="L899"></a> 899         GeneralNameInterface <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L900" name="L900"></a> 900         <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L901" name="L901"></a> 901             <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.makeGeneralNameInterface("
<a id="L902" name="L902"></a> 902                 + <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> + ")...");
<a id="L903" name="L903"></a> 903         <em class="brace">}</em>
<a id="L904" name="L904"></a> 904 
<a id="L905" name="L905"></a> 905         <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> <strong class="reserved">instanceof</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) <em class="brace">{</em>
<a id="L906" name="L906"></a> 906             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L907" name="L907"></a> 907                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.makeGeneralNameInterface() "
<a id="L908" name="L908"></a> 908                     + "name is String: " + <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L909" name="L909"></a> 909             <em class="brace">}</em>
<a id="L910" name="L910"></a> 910             <strong class="reserved">switch</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L911" name="L911"></a> 911             <strong class="reserved">case</strong> NAME_RFC822:
<a id="L912" name="L912"></a> 912                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> RFC822Name((<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L913" name="L913"></a> 913                 <strong class="reserved">break</strong>;
<a id="L914" name="L914"></a> 914             <strong class="reserved">case</strong> NAME_DNS:
<a id="L915" name="L915"></a> 915                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> DNSName((<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L916" name="L916"></a> 916                 <strong class="reserved">break</strong>;
<a id="L917" name="L917"></a> 917             <strong class="reserved">case</strong> NAME_DIRECTORY:
<a id="L918" name="L918"></a> 918                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> X500Name((<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L919" name="L919"></a> 919                 <strong class="reserved">break</strong>;
<a id="L920" name="L920"></a> 920             <strong class="reserved">case</strong> NAME_URI:
<a id="L921" name="L921"></a> 921                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> URIName((<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L922" name="L922"></a> 922                 <strong class="reserved">break</strong>;
<a id="L923" name="L923"></a> 923             <strong class="reserved">case</strong> NAME_IP:
<a id="L924" name="L924"></a> 924                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> IPAddressName((<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L925" name="L925"></a> 925                 <strong class="reserved">break</strong>;
<a id="L926" name="L926"></a> 926             <strong class="reserved">case</strong> NAME_OID:
<a id="L927" name="L927"></a> 927                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> OIDName((<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L928" name="L928"></a> 928                 <strong class="reserved">break</strong>;
<a id="L929" name="L929"></a> 929             <strong class="reserved">default</strong>:
<a id="L930" name="L930"></a> 930                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("unable to parse String names of type "
<a id="L931" name="L931"></a> 931                                       + <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L932" name="L932"></a> 932             <em class="brace">}</em>
<a id="L933" name="L933"></a> 933             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L934" name="L934"></a> 934                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.makeGeneralNameInterface() "
<a id="L935" name="L935"></a> 935                     + "result: " + <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L936" name="L936"></a> 936             <em class="brace">}</em>
<a id="L937" name="L937"></a> 937         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> <strong class="reserved">instanceof</strong> <strong class="reserved">byte</strong>[]) <em class="brace">{</em>
<a id="L938" name="L938"></a> 938             DerValue <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a> = <strong class="reserved">new</strong> DerValue((<strong class="reserved">byte</strong>[]) <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L939" name="L939"></a> 939             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L940" name="L940"></a> 940                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>
<a id="L941" name="L941"></a> 941                     ("X509CertSelector.makeGeneralNameInterface() is byte[]");
<a id="L942" name="L942"></a> 942             <em class="brace">}</em>
<a id="L943" name="L943"></a> 943 
<a id="L944" name="L944"></a> 944             <strong class="reserved">switch</strong> (<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>) <em class="brace">{</em>
<a id="L945" name="L945"></a> 945             <strong class="reserved">case</strong> NAME_ANY:
<a id="L946" name="L946"></a> 946                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> OtherName(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L947" name="L947"></a> 947                 <strong class="reserved">break</strong>;
<a id="L948" name="L948"></a> 948             <strong class="reserved">case</strong> NAME_RFC822:
<a id="L949" name="L949"></a> 949                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> RFC822Name(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L950" name="L950"></a> 950                 <strong class="reserved">break</strong>;
<a id="L951" name="L951"></a> 951             <strong class="reserved">case</strong> NAME_DNS:
<a id="L952" name="L952"></a> 952                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> DNSName(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L953" name="L953"></a> 953                 <strong class="reserved">break</strong>;
<a id="L954" name="L954"></a> 954             <strong class="reserved">case</strong> NAME_X400:
<a id="L955" name="L955"></a> 955                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> X400Address(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L956" name="L956"></a> 956                 <strong class="reserved">break</strong>;
<a id="L957" name="L957"></a> 957             <strong class="reserved">case</strong> NAME_DIRECTORY:
<a id="L958" name="L958"></a> 958                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> X500Name(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L959" name="L959"></a> 959                 <strong class="reserved">break</strong>;
<a id="L960" name="L960"></a> 960             <strong class="reserved">case</strong> NAME_EDI:
<a id="L961" name="L961"></a> 961                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> EDIPartyName(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L962" name="L962"></a> 962                 <strong class="reserved">break</strong>;
<a id="L963" name="L963"></a> 963             <strong class="reserved">case</strong> NAME_URI:
<a id="L964" name="L964"></a> 964                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> URIName(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L965" name="L965"></a> 965                 <strong class="reserved">break</strong>;
<a id="L966" name="L966"></a> 966             <strong class="reserved">case</strong> NAME_IP:
<a id="L967" name="L967"></a> 967                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> IPAddressName(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L968" name="L968"></a> 968                 <strong class="reserved">break</strong>;
<a id="L969" name="L969"></a> 969             <strong class="reserved">case</strong> NAME_OID:
<a id="L970" name="L970"></a> 970                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> OIDName(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L971" name="L971"></a> 971                 <strong class="reserved">break</strong>;
<a id="L972" name="L972"></a> 972             <strong class="reserved">default</strong>:
<a id="L973" name="L973"></a> 973                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("unable to parse byte array names of "
<a id="L974" name="L974"></a> 974                     + "type " + <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>);
<a id="L975" name="L975"></a> 975             <em class="brace">}</em>
<a id="L976" name="L976"></a> 976             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L977" name="L977"></a> 977                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.makeGeneralNameInterface() result: "
<a id="L978" name="L978"></a> 978                     + <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L979" name="L979"></a> 979             <em class="brace">}</em>
<a id="L980" name="L980"></a> 980         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L981" name="L981"></a> 981             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L982" name="L982"></a> 982                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.makeGeneralName() input name "
<a id="L983" name="L983"></a> 983                     + "not String or byte array");
<a id="L984" name="L984"></a> 984             <em class="brace">}</em>
<a id="L985" name="L985"></a> 985             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("name not String or byte array");
<a id="L986" name="L986"></a> 986         <em class="brace">}</em>
<a id="L987" name="L987"></a> 987         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L988" name="L988"></a> 988     <em class="brace">}</em>
<a id="L989" name="L989"></a> 989 
<a id="L990" name="L990"></a> 990 
<div class="comment">
      Sets the name constraints criterion. The <code>X509Certificate</code>
      must have subject and subject alternative names that
      meet the specified name constraints.
      <p>
      The name constraints are specified as a byte array. This byte array
      should contain the DER encoded form of the name constraints, as they
      would appear in the NameConstraints structure defined in RFC 3280
      and X.509. The ASN.1 definition of this structure appears below.
      </p><pre>{@code
       NameConstraints ::= SEQUENCE {
            permittedSubtrees       [0]     GeneralSubtrees OPTIONAL,
            excludedSubtrees        [1]     GeneralSubtrees OPTIONAL }
       GeneralSubtrees ::= SEQUENCE SIZE (1..MAX) OF GeneralSubtree
       GeneralSubtree ::= SEQUENCE {
            base                    GeneralName,
            minimum         [0]     BaseDistance DEFAULT 0,
            maximum         [1]     BaseDistance OPTIONAL }
       BaseDistance ::= INTEGER (0..MAX)
       GeneralName ::= CHOICE {
            otherName                       [0]     OtherName,
            rfc822Name                      [1]     IA5String,
            dNSName                         [2]     IA5String,
            x400Address                     [3]     ORAddress,
            directoryName                   [4]     Name,
            ediPartyName                    [5]     EDIPartyName,
            uniformResourceIdentifier       [6]     IA5String,
            iPAddress                       [7]     OCTET STRING,
            registeredID                    [8]     OBJECT IDENTIFIER}
      }</pre>
      <p>
      Note that the byte array supplied here is cloned to protect against
      subsequent modifications.
      @param bytes a byte array containing the ASN.1 DER encoding of
                   a NameConstraints extension to be used for checking
                   name constraints. Only the value of the extension is
                   included, not the OID or criticality flag. Can be
                   <code>null</code>,
                   in which case no name constraints check will be performed.
      @throws IOException if a parsing error occurs
      @see #getNameConstraints</p></div>
<a id="L1039" name="L1039"></a>1039     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27795.html" title="Multiple referred from 3 places.">setNameConstraints</a>(<strong class="reserved">byte</strong>[] bytes) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1040" name="L1040"></a>1040         <strong class="reserved">if</strong> (bytes == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1041" name="L1041"></a>1041             ncBytes = <strong class="reserved">null</strong>;
<a id="L1042" name="L1042"></a>1042             nc = <strong class="reserved">null</strong>;
<a id="L1043" name="L1043"></a>1043         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1044" name="L1044"></a>1044             ncBytes = bytes.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L1045" name="L1045"></a>1045             nc = <strong class="reserved">new</strong> NameConstraintsExtension(FALSE, bytes);
<a id="L1046" name="L1046"></a>1046         <em class="brace">}</em>
<a id="L1047" name="L1047"></a>1047     <em class="brace">}</em>
<a id="L1048" name="L1048"></a>1048 
<div class="comment">
      Sets the basic constraints constraint. If the value is greater than or
      equal to zero, <code>X509Certificates</code> must include a
      basicConstraints extension with
      a pathLen of at least this value. If the value is -2, only end-entity
      certificates are accepted. If the value is -1, no check is done.
      <p>
      This constraint is useful when building a certification path forward
      (from the target toward the trust anchor. If a partial path has been
      built, any candidate certificate must have a maxPathLen value greater
      than or equal to the number of certificates in the partial path.
      @param minMaxPathLen the value for the basic constraints constraint
      @throws IllegalArgumentException if the value is less than -2
      @see #getBasicConstraints</p></div>
<a id="L1065" name="L1065"></a>1065     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setBasicConstraints(<strong class="reserved">int</strong> minMaxPathLen) <em class="brace">{</em>
<a id="L1066" name="L1066"></a>1066         <strong class="reserved">if</strong> (minMaxPathLen &lt; -2) <em class="brace">{</em>
<a id="L1067" name="L1067"></a>1067             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("basic constraints less than -2");
<a id="L1068" name="L1068"></a>1068         <em class="brace">}</em>
<a id="L1069" name="L1069"></a>1069         basicConstraints = minMaxPathLen;
<a id="L1070" name="L1070"></a>1070     <em class="brace">}</em>
<a id="L1071" name="L1071"></a>1071 
<div class="comment">
      Sets the policy constraint. The <code>X509Certificate</code> must
      include at least one of the specified policies in its certificate
      policies extension. If <code>certPolicySet</code> is empty, then the
      <code>X509Certificate</code> must include at least some specified policy
      in its certificate policies extension. If <code>certPolicySet</code> is
      <code>null</code>, no policy check will be performed.
      <p>
      Note that the <code>Set</code> is cloned to protect against
      subsequent modifications.
      @param certPolicySet a <code>Set</code> of certificate policy OIDs in
                           string format (or <code>null</code>). Each OID is
                           represented by a set of nonnegative integers
                         separated by periods.
      @throws IOException if a parsing error occurs on the OID such as
      the first component is not 0, 1 or 2 or the second component is
      greater than 39.
      @see #getPolicy</p></div>
<a id="L1092" name="L1092"></a>1092     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/2677.html#L242" title="Referred from 242 in src/javax/security/auth/Policy.java.">setPolicy</a>(<a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; certPolicySet) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1093" name="L1093"></a>1093         <strong class="reserved">if</strong> (certPolicySet == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1094" name="L1094"></a>1094             policySet = <strong class="reserved">null</strong>;
<a id="L1095" name="L1095"></a>1095             policy = <strong class="reserved">null</strong>;
<a id="L1096" name="L1096"></a>1096         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1097" name="L1097"></a>1097             <em class="comment">// Snapshot set and parse it</em>
<a id="L1098" name="L1098"></a>1098             <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; tempSet = <a href="../S/1147.html#L80" title="Defined at 80 in src/java/util/Collections.java.">Collections</a>.<a href="../S/1147.html#L1117" title="Defined at 1117 in src/java/util/Collections.java.">unmodifiableSet</a>
<a id="L1099" name="L1099"></a>1099                                         (<strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt;(certPolicySet));
<div class="comment">
             /* Convert to Vector of ObjectIdentifiers */</div>
<a id="L1101" name="L1101"></a>1101             <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; i = tempSet.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L1102" name="L1102"></a>1102             <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;CertificatePolicyId&gt; polIdVector = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;CertificatePolicyId&gt;();
<a id="L1103" name="L1103"></a>1103             <strong class="reserved">while</strong> (i.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L1104" name="L1104"></a>1104                 <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> = i.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L1105" name="L1105"></a>1105                 <strong class="reserved">if</strong> (!(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> <strong class="reserved">instanceof</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)) <em class="brace">{</em>
<a id="L1106" name="L1106"></a>1106                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("non String in certPolicySet");
<a id="L1107" name="L1107"></a>1107                 <em class="brace">}</em>
<a id="L1108" name="L1108"></a>1108                 polIdVector.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<strong class="reserved">new</strong> CertificatePolicyId(<strong class="reserved">new</strong> ObjectIdentifier(
<a id="L1109" name="L1109"></a>1109                   (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>)));
<a id="L1110" name="L1110"></a>1110             <em class="brace">}</em>
<a id="L1111" name="L1111"></a>1111             <em class="comment">// If everything went OK, make the changes</em>
<a id="L1112" name="L1112"></a>1112             policySet = tempSet;
<a id="L1113" name="L1113"></a>1113             policy = <strong class="reserved">new</strong> CertificatePolicySet(polIdVector);
<a id="L1114" name="L1114"></a>1114         <em class="brace">}</em>
<a id="L1115" name="L1115"></a>1115     <em class="brace">}</em>
<a id="L1116" name="L1116"></a>1116 
<div class="comment">
      Sets the pathToNames criterion. The <code>X509Certificate</code> must
      not include name constraints that would prohibit building a
      path to the specified names.
      <p>
      This method allows the caller to specify, with a single method call,
      the complete set of names which the <code>X509Certificates</code>'s
      name constraints must permit. The specified value replaces
      the previous value for the pathToNames criterion.
      </p><p>
      This constraint is useful when building a certification path forward
      (from the target toward the trust anchor. If a partial path has been
      built, any candidate certificate must not include name constraints that
      would prohibit building a path to any of the names in the partial path.
      </p><p>
      The <code>names</code> parameter (if not <code>null</code>) is a
      <code>Collection</code> with one
      entry for each name to be included in the pathToNames
      criterion. Each entry is a <code>List</code> whose first entry is an
      <code>Integer</code> (the name type, 0-8) and whose second
      entry is a <code>String</code> or a byte array (the name, in
      string or ASN.1 DER encoded form, respectively).
      There can be multiple names of the same type. If <code>null</code>
      is supplied as the value for this argument, no
      pathToNames check will be performed.
      </p><p>
      Each name in the <code>Collection</code>
      may be specified either as a <code>String</code> or as an ASN.1 encoded
      byte array. For more details about the formats used, see
      {@link #addPathToName(int type, String name)
      addPathToName(int type, String name)} and
      {@link #addPathToName(int type, byte [] name)
      addPathToName(int type, byte [] name)}.
      </p><p>
      <strong>Note:</strong> for distinguished names, specify the byte
      array form instead of the String form. See the note in
      {@link #addPathToName(int, String)} for more information.
      </p><p>
      Note that the <code>names</code> parameter can contain duplicate
      names (same name and name type), but they may be removed from the
      <code>Collection</code> of names returned by the
      {@link #getPathToNames getPathToNames} method.
      </p><p>
      Note that a deep copy is performed on the <code>Collection</code> to
      protect against subsequent modifications.
      @param names a <code>Collection</code> with one entry per name
                   (or <code>null</code>)
      @throws IOException if a parsing error occurs
      @see #getPathToNames</p></div>
<a id="L1168" name="L1168"></a>1168     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setPathToNames(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; names) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1169" name="L1169"></a>1169         <strong class="reserved">if</strong> ((names == <strong class="reserved">null</strong>) || names.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L1170" name="L1170"></a>1170             pathToNames = <strong class="reserved">null</strong>;
<a id="L1171" name="L1171"></a>1171             pathToGeneralNames = <strong class="reserved">null</strong>;
<a id="L1172" name="L1172"></a>1172         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1173" name="L1173"></a>1173             <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; tempNames = <a href="../S/1279.html#L1672" title="Defined at 1672 in src/java/security/cert/X509CertSelector.java.">cloneAndCheckNames</a>(names);
<a id="L1174" name="L1174"></a>1174             pathToGeneralNames = <a href="../S/1279.html#L847" title="Defined at 847 in src/java/security/cert/X509CertSelector.java.">parseNames</a>(tempNames);
<a id="L1175" name="L1175"></a>1175             <em class="comment">// Ensure that we either set both of these or neither</em>
<a id="L1176" name="L1176"></a>1176             pathToNames = tempNames;
<a id="L1177" name="L1177"></a>1177         <em class="brace">}</em>
<a id="L1178" name="L1178"></a>1178     <em class="brace">}</em>
<a id="L1179" name="L1179"></a>1179 
<a id="L1180" name="L1180"></a>1180     <em class="comment">// called from CertPathHelper</em>
<a id="L1181" name="L1181"></a>1181     <strong class="reserved">void</strong> <a href="../S/1295.html#L60" title="Referred from 60 in src/java/security/cert/CertPathHelperImpl.java.">setPathToNamesInternal</a>(<a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;GeneralNameInterface&gt; names) <em class="brace">{</em>
<a id="L1182" name="L1182"></a>1182         <em class="comment">// set names to non-null dummy value</em>
<a id="L1183" name="L1183"></a>1183         <em class="comment">// this breaks getPathToNames()</em>
<a id="L1184" name="L1184"></a>1184         pathToNames = <a href="../S/1147.html#L80" title="Defined at 80 in src/java/util/Collections.java.">Collections</a>.&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt;<a href="../S/1147.html#L4301" title="Defined at 4301 in src/java/util/Collections.java.">emptySet</a>();
<a id="L1185" name="L1185"></a>1185         pathToGeneralNames = names;
<a id="L1186" name="L1186"></a>1186     <em class="brace">}</em>
<a id="L1187" name="L1187"></a>1187 
<div class="comment">
      Adds a name to the pathToNames criterion. The <code>X509Certificate</code>
      must not include name constraints that would prohibit building a
      path to the specified name.
      <p>
      This method allows the caller to add a name to the set of names which
      the <code>X509Certificates</code>'s name constraints must permit.
      The specified name is added to any previous value for the
      pathToNames criterion.  If the name is a duplicate, it may be ignored.
      </p><p>
      The name is provided in string format. RFC 822, DNS, and URI names
      use the well-established string formats for those types (subject to
      the restrictions included in RFC 3280). IPv4 address names are
      supplied using dotted quad notation. OID address names are represented
      as a series of nonnegative integers separated by periods. And
      directory names (distinguished names) are supplied in RFC 2253 format.
      No standard string format is defined for otherNames, X.400 names,
      EDI party names, IPv6 address names, or any other type of names. They
      should be specified using the
      {@link #addPathToName(int type, byte [] name)
      addPathToName(int type, byte [] name)} method.
      </p><p>
      <strong>Note:</strong> for distinguished names, use
      {@linkplain #addPathToName(int, byte[])} instead.
      This method should not be relied on as it can fail to match some
      certificates because of a loss of encoding information in the RFC 2253
      String form of some distinguished names.
      @param type the name type (0-8, as specified in
                  RFC 3280, section 4.2.1.7)
      @param name the name in string form
      @throws IOException if a parsing error occurs</p></div>
<a id="L1221" name="L1221"></a>1221     <strong class="reserved">public</strong> <strong class="reserved">void</strong> addPathToName(<strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1222" name="L1222"></a>1222         <a href="../S/1279.html#L1265" title="Defined at 1265 in src/java/security/cert/X509CertSelector.java.">addPathToNameInternal</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L1223" name="L1223"></a>1223     <em class="brace">}</em>
<a id="L1224" name="L1224"></a>1224 
<div class="comment">
      Adds a name to the pathToNames criterion. The <code>X509Certificate</code>
      must not include name constraints that would prohibit building a
      path to the specified name.
      <p>
      This method allows the caller to add a name to the set of names which
      the <code>X509Certificates</code>'s name constraints must permit.
      The specified name is added to any previous value for the
      pathToNames criterion. If the name is a duplicate, it may be ignored.
      </p><p>
      The name is provided as a byte array. This byte array should contain
      the DER encoded name, as it would appear in the GeneralName structure
      defined in RFC 3280 and X.509. The ASN.1 definition of this structure
      appears in the documentation for
      {@link #addSubjectAlternativeName(int type, byte [] name)
      addSubjectAlternativeName(int type, byte [] name)}.
      </p><p>
      Note that the byte array supplied here is cloned to protect against
      subsequent modifications.
      @param type the name type (0-8, as specified in
                  RFC 3280, section 4.2.1.7)
      @param name a byte array containing the name in ASN.1 DER encoded form
      @throws IOException if a parsing error occurs</p></div>
<a id="L1250" name="L1250"></a>1250     <strong class="reserved">public</strong> <strong class="reserved">void</strong> addPathToName(<strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <strong class="reserved">byte</strong> [] <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1251" name="L1251"></a>1251         <em class="comment">// clone because byte arrays are modifiable</em>
<a id="L1252" name="L1252"></a>1252         <a href="../S/1279.html#L1265" title="Defined at 1265 in src/java/security/cert/X509CertSelector.java.">addPathToNameInternal</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>());
<a id="L1253" name="L1253"></a>1253     <em class="brace">}</em>
<a id="L1254" name="L1254"></a>1254 
<div class="comment">
      A private method that adds a name (String or byte array) to the
      pathToNames criterion. The <code>X509Certificate</code> must contain
      the specified pathToName.
      @param type the name type (0-8, as specified in
                  RFC 3280, section 4.2.1.7)
      @param name the name in string or byte array form
      @throws IOException if an encoding error occurs (incorrect form for DN)</div>
<a id="L1265" name="L1265"></a>1265     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/9897.html" title="Multiple referred from 2 places.">addPathToNameInternal</a>(<strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L1266" name="L1266"></a>1266             <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1267" name="L1267"></a>1267         <em class="comment">// First, ensure that the name parses</em>
<a id="L1268" name="L1268"></a>1268         GeneralNameInterface tempName = <a href="../S/1279.html#L897" title="Defined at 897 in src/java/security/cert/X509CertSelector.java.">makeGeneralNameInterface</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L1269" name="L1269"></a>1269         <strong class="reserved">if</strong> (pathToGeneralNames == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1270" name="L1270"></a>1270             pathToNames = <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt;();
<a id="L1271" name="L1271"></a>1271             pathToGeneralNames = <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;GeneralNameInterface&gt;();
<a id="L1272" name="L1272"></a>1272         <em class="brace">}</em>
<a id="L1273" name="L1273"></a>1273         <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt; <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a> = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt;(2);
<a id="L1274" name="L1274"></a>1274         <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>));
<a id="L1275" name="L1275"></a>1275         <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L1276" name="L1276"></a>1276         pathToNames.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>);
<a id="L1277" name="L1277"></a>1277         pathToGeneralNames.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(tempName);
<a id="L1278" name="L1278"></a>1278     <em class="brace">}</em>
<a id="L1279" name="L1279"></a>1279 
<div class="comment">
      Returns the certificateEquals criterion. The specified
      <code>X509Certificate</code> must be equal to the
      <code>X509Certificate</code> passed to the <code>match</code> method.
      If <code>null</code>, this check is not applied.
      @return the <code>X509Certificate</code> to match (or <code>null</code>)
      @see #setCertificate</div>
<a id="L1289" name="L1289"></a>1289     <strong class="reserved">public</strong> <a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> <a href="../R/15485.html" title="Multiple referred from 7 places.">getCertificate</a>() <em class="brace">{</em>
<a id="L1290" name="L1290"></a>1290         <strong class="reserved">return</strong> x509Cert;
<a id="L1291" name="L1291"></a>1291     <em class="brace">}</em>
<a id="L1292" name="L1292"></a>1292 
<div class="comment">
      Returns the serialNumber criterion. The specified serial number
      must match the certificate serial number in the
      <code>X509Certificate</code>. If <code>null</code>, any certificate
      serial number will do.
      @return the certificate serial number to match
                     (or <code>null</code>)
      @see #setSerialNumber</div>
<a id="L1303" name="L1303"></a>1303     <strong class="reserved">public</strong> <a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> <a href="../R/18961.html" title="Multiple referred from 10 places.">getSerialNumber</a>() <em class="brace">{</em>
<a id="L1304" name="L1304"></a>1304         <strong class="reserved">return</strong> <a href="../S/997.html#L123" title="Defined at 123 in src/java/util/Timer.java.">serialNumber</a>;
<a id="L1305" name="L1305"></a>1305     <em class="brace">}</em>
<a id="L1306" name="L1306"></a>1306 
<div class="comment">
      Returns the issuer criterion as an <code>X500Principal</code>. This
      distinguished name must match the issuer distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, the issuer criterion
      is disabled and any issuer distinguished name will do.
      @return the required issuer distinguished name as X500Principal
              (or <code>null</code>)
      @since 1.5</div>
<a id="L1317" name="L1317"></a>1317     <strong class="reserved">public</strong> <a href="../D/9807.html" title="Multiple defined in 2 places.">X500Principal</a> getIssuer() <em class="brace">{</em>
<a id="L1318" name="L1318"></a>1318         <strong class="reserved">return</strong> issuer;
<a id="L1319" name="L1319"></a>1319     <em class="brace">}</em>
<a id="L1320" name="L1320"></a>1320 
<div class="comment">
      <strong>Denigrated</strong>, use {@linkplain #getIssuer()} or
      {@linkplain #getIssuerAsBytes()} instead. This method should not be
      relied on as it can fail to match some certificates because of a loss of
      encoding information in the RFC 2253 String form of some distinguished
      names.
      <p>
      Returns the issuer criterion as a <code>String</code>. This
      distinguished name must match the issuer distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, the issuer criterion
      is disabled and any issuer distinguished name will do.
      </p><p>
      If the value returned is not <code>null</code>, it is a
      distinguished name, in RFC 2253 format.
      @return the required issuer distinguished name in RFC 2253 format
              (or <code>null</code>)</p></div>
<a id="L1339" name="L1339"></a>1339     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1279.html#L1823" title="Referred from 1823 in src/java/security/cert/X509CertSelector.java.">getIssuerAsString</a>() <em class="brace">{</em>
<a id="L1340" name="L1340"></a>1340         <strong class="reserved">return</strong> (issuer == <strong class="reserved">null</strong> ? <strong class="reserved">null</strong> : issuer.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>());
<a id="L1341" name="L1341"></a>1341     <em class="brace">}</em>
<a id="L1342" name="L1342"></a>1342 
<div class="comment">
      Returns the issuer criterion as a byte array. This distinguished name
      must match the issuer distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, the issuer criterion
      is disabled and any issuer distinguished name will do.
      <p>
      If the value returned is not <code>null</code>, it is a byte
      array containing a single DER encoded distinguished name, as defined in
      X.501. The ASN.1 notation for this structure is supplied in the
      documentation for
      {@link #setIssuer(byte [] issuerDN) setIssuer(byte [] issuerDN)}.
      </p><p>
      Note that the byte array returned is cloned to protect against
      subsequent modifications.
      @return a byte array containing the required issuer distinguished name
              in ASN.1 DER format (or <code>null</code>)
      @throws IOException if an encoding error occurs</p></div>
<a id="L1362" name="L1362"></a>1362     <strong class="reserved">public</strong> <strong class="reserved">byte</strong>[] getIssuerAsBytes() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1363" name="L1363"></a>1363         <strong class="reserved">return</strong> (issuer == <strong class="reserved">null</strong> ? <strong class="reserved">null</strong>: issuer.<a href="../D/18742.html" title="Multiple defined in 18 places.">getEncoded</a>());
<a id="L1364" name="L1364"></a>1364     <em class="brace">}</em>
<a id="L1365" name="L1365"></a>1365 
<div class="comment">
      Returns the subject criterion as an <code>X500Principal</code>. This
      distinguished name must match the subject distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, the subject criterion
      is disabled and any subject distinguished name will do.
      @return the required subject distinguished name as X500Principal
              (or <code>null</code>)
      @since 1.5</div>
<a id="L1376" name="L1376"></a>1376     <strong class="reserved">public</strong> <a href="../D/9807.html" title="Multiple defined in 2 places.">X500Principal</a> <a href="../R/19265.html" title="Multiple referred from 8 places.">getSubject</a>() <em class="brace">{</em>
<a id="L1377" name="L1377"></a>1377         <strong class="reserved">return</strong> subject;
<a id="L1378" name="L1378"></a>1378     <em class="brace">}</em>
<a id="L1379" name="L1379"></a>1379 
<div class="comment">
      <strong>Denigrated</strong>, use {@linkplain #getSubject()} or
      {@linkplain #getSubjectAsBytes()} instead. This method should not be
      relied on as it can fail to match some certificates because of a loss of
      encoding information in the RFC 2253 String form of some distinguished
      names.
      <p>
      Returns the subject criterion as a <code>String</code>. This
      distinguished name must match the subject distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, the subject criterion
      is disabled and any subject distinguished name will do.
      </p><p>
      If the value returned is not <code>null</code>, it is a
      distinguished name, in RFC 2253 format.
      @return the required subject distinguished name in RFC 2253 format
              (or <code>null</code>)</p></div>
<a id="L1398" name="L1398"></a>1398     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1279.html#L1826" title="Referred from 1826 in src/java/security/cert/X509CertSelector.java.">getSubjectAsString</a>() <em class="brace">{</em>
<a id="L1399" name="L1399"></a>1399         <strong class="reserved">return</strong> (subject == <strong class="reserved">null</strong> ? <strong class="reserved">null</strong> : subject.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>());
<a id="L1400" name="L1400"></a>1400     <em class="brace">}</em>
<a id="L1401" name="L1401"></a>1401 
<div class="comment">
      Returns the subject criterion as a byte array. This distinguished name
      must match the subject distinguished name in the
      <code>X509Certificate</code>. If <code>null</code>, the subject criterion
      is disabled and any subject distinguished name will do.
      <p>
      If the value returned is not <code>null</code>, it is a byte
      array containing a single DER encoded distinguished name, as defined in
      X.501. The ASN.1 notation for this structure is supplied in the
      documentation for
      {@link #setSubject(byte [] subjectDN) setSubject(byte [] subjectDN)}.
      </p><p>
      Note that the byte array returned is cloned to protect against
      subsequent modifications.
      @return a byte array containing the required subject distinguished name
              in ASN.1 DER format (or <code>null</code>)
      @throws IOException if an encoding error occurs</p></div>
<a id="L1421" name="L1421"></a>1421     <strong class="reserved">public</strong> <strong class="reserved">byte</strong>[] getSubjectAsBytes() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1422" name="L1422"></a>1422         <strong class="reserved">return</strong> (subject == <strong class="reserved">null</strong> ? <strong class="reserved">null</strong> : subject.<a href="../D/18742.html" title="Multiple defined in 18 places.">getEncoded</a>());
<a id="L1423" name="L1423"></a>1423     <em class="brace">}</em>
<a id="L1424" name="L1424"></a>1424 
<div class="comment">
      Returns the subjectKeyIdentifier criterion. The
      <code>X509Certificate</code> must contain a SubjectKeyIdentifier
      extension with the specified value. If <code>null</code>, no
      subjectKeyIdentifier check will be done.
      <p>
      Note that the byte array returned is cloned to protect against
      subsequent modifications.
      @return the key identifier (or <code>null</code>)
      @see #setSubjectKeyIdentifier</p></div>
<a id="L1437" name="L1437"></a>1437     <strong class="reserved">public</strong> <strong class="reserved">byte</strong>[] getSubjectKeyIdentifier() <em class="brace">{</em>
<a id="L1438" name="L1438"></a>1438         <strong class="reserved">if</strong> (subjectKeyID == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1439" name="L1439"></a>1439             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1440" name="L1440"></a>1440         <em class="brace">}</em>
<a id="L1441" name="L1441"></a>1441         <strong class="reserved">return</strong> subjectKeyID.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L1442" name="L1442"></a>1442     <em class="brace">}</em>
<a id="L1443" name="L1443"></a>1443 
<div class="comment">
      Returns the authorityKeyIdentifier criterion. The
      <code>X509Certificate</code> must contain a AuthorityKeyIdentifier
      extension with the specified value. If <code>null</code>, no
      authorityKeyIdentifier check will be done.
      <p>
      Note that the byte array returned is cloned to protect against
      subsequent modifications.
      @return the key identifier (or <code>null</code>)
      @see #setAuthorityKeyIdentifier</p></div>
<a id="L1456" name="L1456"></a>1456     <strong class="reserved">public</strong> <strong class="reserved">byte</strong>[] getAuthorityKeyIdentifier() <em class="brace">{</em>
<a id="L1457" name="L1457"></a>1457         <strong class="reserved">if</strong> (authorityKeyID == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1458" name="L1458"></a>1458           <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1459" name="L1459"></a>1459         <em class="brace">}</em>
<a id="L1460" name="L1460"></a>1460         <strong class="reserved">return</strong> authorityKeyID.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L1461" name="L1461"></a>1461     <em class="brace">}</em>
<a id="L1462" name="L1462"></a>1462 
<div class="comment">
      Returns the certificateValid criterion. The specified date must fall
      within the certificate validity period for the
      <code>X509Certificate</code>. If <code>null</code>, no certificateValid
      check will be done.
      <p>
      Note that the <code>Date</code> returned is cloned to protect against
      subsequent modifications.
      @return the <code>Date</code> to check (or <code>null</code>)
      @see #setCertificateValid</p></div>
<a id="L1475" name="L1475"></a>1475     <strong class="reserved">public</strong> <a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a> getCertificateValid() <em class="brace">{</em>
<a id="L1476" name="L1476"></a>1476         <strong class="reserved">if</strong> (certificateValid == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1477" name="L1477"></a>1477             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1478" name="L1478"></a>1478         <em class="brace">}</em>
<a id="L1479" name="L1479"></a>1479         <strong class="reserved">return</strong> (<a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a>)certificateValid.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L1480" name="L1480"></a>1480     <em class="brace">}</em>
<a id="L1481" name="L1481"></a>1481 
<div class="comment">
      Returns the privateKeyValid criterion. The specified date must fall
      within the private key validity period for the
      <code>X509Certificate</code>. If <code>null</code>, no privateKeyValid
      check will be done.
      <p>
      Note that the <code>Date</code> returned is cloned to protect against
      subsequent modifications.
      @return the <code>Date</code> to check (or <code>null</code>)
      @see #setPrivateKeyValid</p></div>
<a id="L1494" name="L1494"></a>1494     <strong class="reserved">public</strong> <a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a> getPrivateKeyValid() <em class="brace">{</em>
<a id="L1495" name="L1495"></a>1495         <strong class="reserved">if</strong> (privateKeyValid == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1496" name="L1496"></a>1496             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1497" name="L1497"></a>1497         <em class="brace">}</em>
<a id="L1498" name="L1498"></a>1498         <strong class="reserved">return</strong> (<a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a>)privateKeyValid.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L1499" name="L1499"></a>1499     <em class="brace">}</em>
<a id="L1500" name="L1500"></a>1500 
<div class="comment">
      Returns the subjectPublicKeyAlgID criterion. The
      <code>X509Certificate</code> must contain a subject public key
      with the specified algorithm. If <code>null</code>, no
      subjectPublicKeyAlgID check will be done.
      @return the object identifier (OID) of the signature algorithm to check
              for (or <code>null</code>). An OID is represented by a set of
              nonnegative integers separated by periods.
      @see #setSubjectPublicKeyAlgID</div>
<a id="L1512" name="L1512"></a>1512     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> getSubjectPublicKeyAlgID() <em class="brace">{</em>
<a id="L1513" name="L1513"></a>1513         <strong class="reserved">if</strong> (subjectPublicKeyAlgID == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1514" name="L1514"></a>1514             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1515" name="L1515"></a>1515         <em class="brace">}</em>
<a id="L1516" name="L1516"></a>1516         <strong class="reserved">return</strong> subjectPublicKeyAlgID.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L1517" name="L1517"></a>1517     <em class="brace">}</em>
<a id="L1518" name="L1518"></a>1518 
<div class="comment">
      Returns the subjectPublicKey criterion. The
      <code>X509Certificate</code> must contain the specified subject
      public key. If <code>null</code>, no subjectPublicKey check will be done.
      @return the subject public key to check for (or <code>null</code>)
      @see #setSubjectPublicKey</div>
<a id="L1527" name="L1527"></a>1527     <strong class="reserved">public</strong> <a href="../S/1329.html#L46" title="Defined at 46 in src/java/security/PublicKey.java.">PublicKey</a> getSubjectPublicKey() <em class="brace">{</em>
<a id="L1528" name="L1528"></a>1528         <strong class="reserved">return</strong> subjectPublicKey;
<a id="L1529" name="L1529"></a>1529     <em class="brace">}</em>
<a id="L1530" name="L1530"></a>1530 
<div class="comment">
      Returns the keyUsage criterion. The <code>X509Certificate</code>
      must allow the specified keyUsage values. If null, no keyUsage
      check will be done.
      <p>
      Note that the boolean array returned is cloned to protect against
      subsequent modifications.
      @return a boolean array in the same format as the boolean
                      array returned by
      {@link X509Certificate#getKeyUsage() X509Certificate.getKeyUsage()}.
                      Or <code>null</code>.
      @see #setKeyUsage</p></div>
<a id="L1545" name="L1545"></a>1545     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong>[] <a href="../R/17250.html" title="Multiple referred from 2 places.">getKeyUsage</a>() <em class="brace">{</em>
<a id="L1546" name="L1546"></a>1546         <strong class="reserved">if</strong> (keyUsage == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1547" name="L1547"></a>1547             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1548" name="L1548"></a>1548         <em class="brace">}</em>
<a id="L1549" name="L1549"></a>1549         <strong class="reserved">return</strong> keyUsage.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L1550" name="L1550"></a>1550     <em class="brace">}</em>
<a id="L1551" name="L1551"></a>1551 
<div class="comment">
      Returns the extendedKeyUsage criterion. The <code>X509Certificate</code>
      must allow the specified key purposes in its extended key usage
      extension. If the <code>keyPurposeSet</code> returned is empty or
      <code>null</code>, no extendedKeyUsage check will be done. Note that an
      <code>X509Certificate</code> that has no extendedKeyUsage extension
      implicitly allows all key purposes.
      @return an immutable <code>Set</code> of key purpose OIDs in string
      format (or <code>null</code>)
      @see #setExtendedKeyUsage</div>
<a id="L1564" name="L1564"></a>1564     <strong class="reserved">public</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; <a href="../S/1292.html#L508" title="Referred from 508 in src/java/security/cert/X509Certificate.java.">getExtendedKeyUsage</a>() <em class="brace">{</em>
<a id="L1565" name="L1565"></a>1565         <strong class="reserved">return</strong> keyPurposeSet;
<a id="L1566" name="L1566"></a>1566     <em class="brace">}</em>
<a id="L1567" name="L1567"></a>1567 
<div class="comment">
      Indicates if the <code>X509Certificate</code> must contain all
      or at least one of the subjectAlternativeNames
      specified in the {@link #setSubjectAlternativeNames
      setSubjectAlternativeNames} or {@link #addSubjectAlternativeName
      addSubjectAlternativeName} methods. If <code>true</code>,
      the <code>X509Certificate</code> must contain all of the
      specified subject alternative names. If <code>false</code>, the
      <code>X509Certificate</code> must contain at least one of the
      specified subject alternative names.
      @return <code>true</code> if the flag is enabled;
      <code>false</code> if the flag is disabled. The flag is
      <code>true</code> by default.
      @see #setMatchAllSubjectAltNames</div>
<a id="L1584" name="L1584"></a>1584     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> getMatchAllSubjectAltNames() <em class="brace">{</em>
<a id="L1585" name="L1585"></a>1585         <strong class="reserved">return</strong> matchAllSubjectAltNames;
<a id="L1586" name="L1586"></a>1586     <em class="brace">}</em>
<a id="L1587" name="L1587"></a>1587 
<div class="comment">
      Returns a copy of the subjectAlternativeNames criterion.
      The <code>X509Certificate</code> must contain all or at least one
      of the specified subjectAlternativeNames, depending on the value
      of the matchAllNames flag (see {@link #getMatchAllSubjectAltNames
      getMatchAllSubjectAltNames}). If the value returned is
      <code>null</code>, no subjectAlternativeNames check will be performed.
      <p>
      If the value returned is not <code>null</code>, it is a
      <code>Collection</code> with
      one entry for each name to be included in the subject alternative name
      criterion. Each entry is a <code>List</code> whose first entry is an
      <code>Integer</code> (the name type, 0-8) and whose second
      entry is a <code>String</code> or a byte array (the name, in
      string or ASN.1 DER encoded form, respectively).
      There can be multiple names of the same type.  Note that the
      <code>Collection</code> returned may contain duplicate names (same name
      and name type).
      </p><p>
      Each subject alternative name in the <code>Collection</code>
      may be specified either as a <code>String</code> or as an ASN.1 encoded
      byte array. For more details about the formats used, see
      {@link #addSubjectAlternativeName(int type, String name)
      addSubjectAlternativeName(int type, String name)} and
      {@link #addSubjectAlternativeName(int type, byte [] name)
      addSubjectAlternativeName(int type, byte [] name)}.
      </p><p>
      Note that a deep copy is performed on the <code>Collection</code> to
      protect against subsequent modifications.
      @return a <code>Collection</code> of names (or <code>null</code>)
      @see #setSubjectAlternativeNames</p></div>
<a id="L1621" name="L1621"></a>1621     <strong class="reserved">public</strong> <a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; <a href="../S/1292.html#L605" title="Referred from 605 in src/java/security/cert/X509Certificate.java.">getSubjectAlternativeNames</a>() <em class="brace">{</em>
<a id="L1622" name="L1622"></a>1622         <strong class="reserved">if</strong> (subjectAlternativeNames == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1623" name="L1623"></a>1623             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1624" name="L1624"></a>1624         <em class="brace">}</em>
<a id="L1625" name="L1625"></a>1625         <strong class="reserved">return</strong> <a href="../S/1279.html#L1648" title="Defined at 1648 in src/java/security/cert/X509CertSelector.java.">cloneNames</a>(subjectAlternativeNames);
<a id="L1626" name="L1626"></a>1626     <em class="brace">}</em>
<a id="L1627" name="L1627"></a>1627 
<div class="comment">
      Clone an object of the form passed to
      setSubjectAlternativeNames and setPathToNames.
      Throw a <code>RuntimeException</code> if the argument is malformed.
      <p>
      This method wraps cloneAndCheckNames, changing any
      <code>IOException</code> into a <code>RuntimeException</code>. This
      method should be used when the object being
      cloned has already been checked, so there should never be any exceptions.
      @param names a <code>Collection</code> with one entry per name.
                   Each entry is a <code>List</code> whose first entry
                   is an Integer (the name type, 0-8) and whose second
                   entry is a String or a byte array (the name, in
                   string or ASN.1 DER encoded form, respectively).
                   There can be multiple names of the same type. Null
                   is not an acceptable value.
      @return a deep copy of the specified <code>Collection</code>
      @throws RuntimeException if a parsing error occurs</p></div>
<a id="L1648" name="L1648"></a>1648     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; <a href="../R/11573.html" title="Multiple referred from 2 places.">cloneNames</a>(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; names) <em class="brace">{</em>
<a id="L1649" name="L1649"></a>1649         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1650" name="L1650"></a>1650             <strong class="reserved">return</strong> <a href="../S/1279.html#L1672" title="Defined at 1672 in src/java/security/cert/X509CertSelector.java.">cloneAndCheckNames</a>(names);
<a id="L1651" name="L1651"></a>1651         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> e) <em class="brace">{</em>
<a id="L1652" name="L1652"></a>1652             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>("cloneNames encountered IOException: " +
<a id="L1653" name="L1653"></a>1653                                        e.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L1654" name="L1654"></a>1654         <em class="brace">}</em>
<a id="L1655" name="L1655"></a>1655     <em class="brace">}</em>
<a id="L1656" name="L1656"></a>1656 
<div class="comment">
      Clone and check an argument of the form passed to
      setSubjectAlternativeNames and setPathToNames.
      Throw an <code>IOException</code> if the argument is malformed.
      @param names a <code>Collection</code> with one entry per name.
                   Each entry is a <code>List</code> whose first entry
                   is an Integer (the name type, 0-8) and whose second
                   entry is a String or a byte array (the name, in
                   string or ASN.1 DER encoded form, respectively).
                   There can be multiple names of the same type.
                   <code>null</code> is not an acceptable value.
      @return a deep copy of the specified <code>Collection</code>
      @throws IOException if a parsing error occurs</div>
<a id="L1672" name="L1672"></a>1672     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; <a href="../R/11557.html" title="Multiple referred from 3 places.">cloneAndCheckNames</a>(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; names) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1673" name="L1673"></a>1673         <em class="comment">// Copy the Lists and Collection</em>
<a id="L1674" name="L1674"></a>1674         <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; namesCopy = <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt;();
<a id="L1675" name="L1675"></a>1675         <strong class="reserved">for</strong> (<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt; <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> : names)
<a id="L1676" name="L1676"></a>1676         <em class="brace">{</em>
<a id="L1677" name="L1677"></a>1677             namesCopy.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt;(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>));
<a id="L1678" name="L1678"></a>1678         <em class="brace">}</em>
<a id="L1679" name="L1679"></a>1679 
<a id="L1680" name="L1680"></a>1680         <em class="comment">// Check the contents of the Lists and clone any byte arrays</em>
<a id="L1681" name="L1681"></a>1681         <strong class="reserved">for</strong> (<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt; <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a> : namesCopy) <em class="brace">{</em>
<a id="L1682" name="L1682"></a>1682             @<a href="../D/8551.html" title="Multiple defined in 725 places.">SuppressWarnings</a>("unchecked") <em class="comment">// See javadoc for parameter "names".</em>
<a id="L1683" name="L1683"></a>1683             <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt; nameList = (<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt;)<a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>;
<a id="L1684" name="L1684"></a>1684             <strong class="reserved">if</strong> (nameList.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() != 2) <em class="brace">{</em>
<a id="L1685" name="L1685"></a>1685                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("name list size not 2");
<a id="L1686" name="L1686"></a>1686             <em class="brace">}</em>
<a id="L1687" name="L1687"></a>1687             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> = nameList.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(0);
<a id="L1688" name="L1688"></a>1688             <strong class="reserved">if</strong> (!(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> <strong class="reserved">instanceof</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>)) <em class="brace">{</em>
<a id="L1689" name="L1689"></a>1689                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("expected an Integer");
<a id="L1690" name="L1690"></a>1690             <em class="brace">}</em>
<a id="L1691" name="L1691"></a>1691             <strong class="reserved">int</strong> nameType = ((<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>)<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>).<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>();
<a id="L1692" name="L1692"></a>1692             <strong class="reserved">if</strong> ((nameType &lt; 0) || (nameType &gt; 8)) <em class="brace">{</em>
<a id="L1693" name="L1693"></a>1693                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("name type not 0-8");
<a id="L1694" name="L1694"></a>1694             <em class="brace">}</em>
<a id="L1695" name="L1695"></a>1695             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> nameObject = nameList.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(1);
<a id="L1696" name="L1696"></a>1696             <strong class="reserved">if</strong> (!(nameObject <strong class="reserved">instanceof</strong> <strong class="reserved">byte</strong>[]) &amp;&amp;
<a id="L1697" name="L1697"></a>1697                 !(nameObject <strong class="reserved">instanceof</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)) <em class="brace">{</em>
<a id="L1698" name="L1698"></a>1698                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1699" name="L1699"></a>1699                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.cloneAndCheckNames() "
<a id="L1700" name="L1700"></a>1700                         + "name not byte array");
<a id="L1701" name="L1701"></a>1701                 <em class="brace">}</em>
<a id="L1702" name="L1702"></a>1702                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("name not byte array or String");
<a id="L1703" name="L1703"></a>1703             <em class="brace">}</em>
<a id="L1704" name="L1704"></a>1704             <strong class="reserved">if</strong> (nameObject <strong class="reserved">instanceof</strong> <strong class="reserved">byte</strong>[]) <em class="brace">{</em>
<a id="L1705" name="L1705"></a>1705                 nameList.<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>(1, ((<strong class="reserved">byte</strong>[]) nameObject).<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>());
<a id="L1706" name="L1706"></a>1706             <em class="brace">}</em>
<a id="L1707" name="L1707"></a>1707         <em class="brace">}</em>
<a id="L1708" name="L1708"></a>1708         <strong class="reserved">return</strong> namesCopy;
<a id="L1709" name="L1709"></a>1709     <em class="brace">}</em>
<a id="L1710" name="L1710"></a>1710 
<div class="comment">
      Returns the name constraints criterion. The <code>X509Certificate</code>
      must have subject and subject alternative names that
      meet the specified name constraints.
      <p>
      The name constraints are returned as a byte array. This byte array
      contains the DER encoded form of the name constraints, as they
      would appear in the NameConstraints structure defined in RFC 3280
      and X.509. The ASN.1 notation for this structure is supplied in the
      documentation for
      {@link #setNameConstraints(byte [] bytes) setNameConstraints(byte [] bytes)}.
      </p><p>
      Note that the byte array returned is cloned to protect against
      subsequent modifications.
      @return a byte array containing the ASN.1 DER encoding of
              a NameConstraints extension used for checking name constraints.
              <code>null</code> if no name constraints check will be performed.
      @see #setNameConstraints</p></div>
<a id="L1731" name="L1731"></a>1731     <strong class="reserved">public</strong> <strong class="reserved">byte</strong>[] getNameConstraints() <em class="brace">{</em>
<a id="L1732" name="L1732"></a>1732         <strong class="reserved">if</strong> (ncBytes == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1733" name="L1733"></a>1733             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1734" name="L1734"></a>1734         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1735" name="L1735"></a>1735             <strong class="reserved">return</strong> ncBytes.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L1736" name="L1736"></a>1736         <em class="brace">}</em>
<a id="L1737" name="L1737"></a>1737     <em class="brace">}</em>
<a id="L1738" name="L1738"></a>1738 
<div class="comment">
      Returns the basic constraints constraint. If the value is greater than
      or equal to zero, the <code>X509Certificates</code> must include a
      basicConstraints extension with a pathLen of at least this value.
      If the value is -2, only end-entity certificates are accepted. If
      the value is -1, no basicConstraints check is done.
      @return the value for the basic constraints constraint
      @see #setBasicConstraints</div>
<a id="L1749" name="L1749"></a>1749     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/15243.html" title="Multiple referred from 2 places.">getBasicConstraints</a>() <em class="brace">{</em>
<a id="L1750" name="L1750"></a>1750         <strong class="reserved">return</strong> basicConstraints;
<a id="L1751" name="L1751"></a>1751     <em class="brace">}</em>
<a id="L1752" name="L1752"></a>1752 
<div class="comment">
      Returns the policy criterion. The <code>X509Certificate</code> must
      include at least one of the specified policies in its certificate policies
      extension. If the <code>Set</code> returned is empty, then the
      <code>X509Certificate</code> must include at least some specified policy
      in its certificate policies extension. If the <code>Set</code> returned is
      <code>null</code>, no policy check will be performed.
      @return an immutable <code>Set</code> of certificate policy OIDs in
              string format (or <code>null</code>)
      @see #setPolicy</div>
<a id="L1765" name="L1765"></a>1765     <strong class="reserved">public</strong> <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>&gt; <a href="../R/18358.html" title="Multiple referred from 5 places.">getPolicy</a>() <em class="brace">{</em>
<a id="L1766" name="L1766"></a>1766         <strong class="reserved">return</strong> policySet;
<a id="L1767" name="L1767"></a>1767     <em class="brace">}</em>
<a id="L1768" name="L1768"></a>1768 
<div class="comment">
      Returns a copy of the pathToNames criterion. The
      <code>X509Certificate</code> must not include name constraints that would
      prohibit building a path to the specified names. If the value
      returned is <code>null</code>, no pathToNames check will be performed.
      <p>
      If the value returned is not <code>null</code>, it is a
      <code>Collection</code> with one
      entry for each name to be included in the pathToNames
      criterion. Each entry is a <code>List</code> whose first entry is an
      <code>Integer</code> (the name type, 0-8) and whose second
      entry is a <code>String</code> or a byte array (the name, in
      string or ASN.1 DER encoded form, respectively).
      There can be multiple names of the same type. Note that the
      <code>Collection</code> returned may contain duplicate names (same
      name and name type).
      </p><p>
      Each name in the <code>Collection</code>
      may be specified either as a <code>String</code> or as an ASN.1 encoded
      byte array. For more details about the formats used, see
      {@link #addPathToName(int type, String name)
      addPathToName(int type, String name)} and
      {@link #addPathToName(int type, byte [] name)
      addPathToName(int type, byte [] name)}.
      </p><p>
      Note that a deep copy is performed on the <code>Collection</code> to
      protect against subsequent modifications.
      @return a <code>Collection</code> of names (or <code>null</code>)
      @see #setPathToNames</p></div>
<a id="L1800" name="L1800"></a>1800     <strong class="reserved">public</strong> <a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; getPathToNames() <em class="brace">{</em>
<a id="L1801" name="L1801"></a>1801         <strong class="reserved">if</strong> (pathToNames == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1802" name="L1802"></a>1802             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1803" name="L1803"></a>1803         <em class="brace">}</em>
<a id="L1804" name="L1804"></a>1804         <strong class="reserved">return</strong> <a href="../S/1279.html#L1648" title="Defined at 1648 in src/java/security/cert/X509CertSelector.java.">cloneNames</a>(pathToNames);
<a id="L1805" name="L1805"></a>1805     <em class="brace">}</em>
<a id="L1806" name="L1806"></a>1806 
<div class="comment">
      Return a printable representation of the <code>CertSelector</code>.
      @return a <code>String</code> describing the contents of the
              <code>CertSelector</code></div>
<a id="L1813" name="L1813"></a>1813     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L1814" name="L1814"></a>1814         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L1815" name="L1815"></a>1815         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("X509CertSelector: [\n");
<a id="L1816" name="L1816"></a>1816         <strong class="reserved">if</strong> (x509Cert != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1817" name="L1817"></a>1817             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Certificate: " + x509Cert.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() + "\n");
<a id="L1818" name="L1818"></a>1818         <em class="brace">}</em>
<a id="L1819" name="L1819"></a>1819         <strong class="reserved">if</strong> (<a href="../S/997.html#L123" title="Defined at 123 in src/java/util/Timer.java.">serialNumber</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1820" name="L1820"></a>1820             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Serial Number: " + <a href="../S/997.html#L123" title="Defined at 123 in src/java/util/Timer.java.">serialNumber</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() + "\n");
<a id="L1821" name="L1821"></a>1821         <em class="brace">}</em>
<a id="L1822" name="L1822"></a>1822         <strong class="reserved">if</strong> (issuer != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1823" name="L1823"></a>1823             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Issuer: " + <a href="../S/1279.html#L1339" title="Defined at 1339 in src/java/security/cert/X509CertSelector.java.">getIssuerAsString</a>() + "\n");
<a id="L1824" name="L1824"></a>1824         <em class="brace">}</em>
<a id="L1825" name="L1825"></a>1825         <strong class="reserved">if</strong> (subject != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1826" name="L1826"></a>1826             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Subject: " + <a href="../S/1279.html#L1398" title="Defined at 1398 in src/java/security/cert/X509CertSelector.java.">getSubjectAsString</a>() + "\n");
<a id="L1827" name="L1827"></a>1827         <em class="brace">}</em>
<a id="L1828" name="L1828"></a>1828         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  matchAllSubjectAltNames flag: "
<a id="L1829" name="L1829"></a>1829                   + <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(matchAllSubjectAltNames) + "\n");
<a id="L1830" name="L1830"></a>1830         <strong class="reserved">if</strong> (subjectAlternativeNames != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1831" name="L1831"></a>1831             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  SubjectAlternativeNames:\n");
<a id="L1832" name="L1832"></a>1832             <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;<a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt;&gt; i = subjectAlternativeNames.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L1833" name="L1833"></a>1833             <strong class="reserved">while</strong> (i.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L1834" name="L1834"></a>1834                 <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;?&gt; <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a> = i.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L1835" name="L1835"></a>1835                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("    type " + <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(0) +
<a id="L1836" name="L1836"></a>1836                           ", name " + <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(1) + "\n");
<a id="L1837" name="L1837"></a>1837             <em class="brace">}</em>
<a id="L1838" name="L1838"></a>1838         <em class="brace">}</em>
<a id="L1839" name="L1839"></a>1839         <strong class="reserved">if</strong> (subjectKeyID != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1840" name="L1840"></a>1840             HexDumpEncoder enc = <strong class="reserved">new</strong> HexDumpEncoder();
<a id="L1841" name="L1841"></a>1841             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Subject Key Identifier: " +
<a id="L1842" name="L1842"></a>1842                       enc.encodeBuffer(subjectKeyID) + "\n");
<a id="L1843" name="L1843"></a>1843         <em class="brace">}</em>
<a id="L1844" name="L1844"></a>1844         <strong class="reserved">if</strong> (authorityKeyID != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1845" name="L1845"></a>1845             HexDumpEncoder enc = <strong class="reserved">new</strong> HexDumpEncoder();
<a id="L1846" name="L1846"></a>1846             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Authority Key Identifier: " +
<a id="L1847" name="L1847"></a>1847                       enc.encodeBuffer(authorityKeyID) + "\n");
<a id="L1848" name="L1848"></a>1848         <em class="brace">}</em>
<a id="L1849" name="L1849"></a>1849         <strong class="reserved">if</strong> (certificateValid != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1850" name="L1850"></a>1850             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Certificate Valid: " +
<a id="L1851" name="L1851"></a>1851                       certificateValid.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() + "\n");
<a id="L1852" name="L1852"></a>1852         <em class="brace">}</em>
<a id="L1853" name="L1853"></a>1853         <strong class="reserved">if</strong> (privateKeyValid != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1854" name="L1854"></a>1854             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Private Key Valid: " +
<a id="L1855" name="L1855"></a>1855                       privateKeyValid.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() + "\n");
<a id="L1856" name="L1856"></a>1856         <em class="brace">}</em>
<a id="L1857" name="L1857"></a>1857         <strong class="reserved">if</strong> (subjectPublicKeyAlgID != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1858" name="L1858"></a>1858             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Subject Public Key AlgID: " +
<a id="L1859" name="L1859"></a>1859                       subjectPublicKeyAlgID.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() + "\n");
<a id="L1860" name="L1860"></a>1860         <em class="brace">}</em>
<a id="L1861" name="L1861"></a>1861         <strong class="reserved">if</strong> (subjectPublicKey != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1862" name="L1862"></a>1862             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Subject Public Key: " +
<a id="L1863" name="L1863"></a>1863                       subjectPublicKey.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() + "\n");
<a id="L1864" name="L1864"></a>1864         <em class="brace">}</em>
<a id="L1865" name="L1865"></a>1865         <strong class="reserved">if</strong> (keyUsage != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1866" name="L1866"></a>1866             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Key Usage: " + <a href="../S/1279.html#L1891" title="Defined at 1891 in src/java/security/cert/X509CertSelector.java.">keyUsageToString</a>(keyUsage) + "\n");
<a id="L1867" name="L1867"></a>1867         <em class="brace">}</em>
<a id="L1868" name="L1868"></a>1868         <strong class="reserved">if</strong> (keyPurposeSet != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1869" name="L1869"></a>1869             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Extended Key Usage: " +
<a id="L1870" name="L1870"></a>1870                       keyPurposeSet.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() + "\n");
<a id="L1871" name="L1871"></a>1871         <em class="brace">}</em>
<a id="L1872" name="L1872"></a>1872         <strong class="reserved">if</strong> (policy != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1873" name="L1873"></a>1873             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Policy: " + policy.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() + "\n");
<a id="L1874" name="L1874"></a>1874         <em class="brace">}</em>
<a id="L1875" name="L1875"></a>1875         <strong class="reserved">if</strong> (pathToGeneralNames != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1876" name="L1876"></a>1876             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("  Path to names:\n");
<a id="L1877" name="L1877"></a>1877             <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;GeneralNameInterface&gt; i = pathToGeneralNames.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L1878" name="L1878"></a>1878             <strong class="reserved">while</strong> (i.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L1879" name="L1879"></a>1879                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("    " + i.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>() + "\n");
<a id="L1880" name="L1880"></a>1880             <em class="brace">}</em>
<a id="L1881" name="L1881"></a>1881         <em class="brace">}</em>
<a id="L1882" name="L1882"></a>1882         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("]");
<a id="L1883" name="L1883"></a>1883         <strong class="reserved">return</strong> sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L1884" name="L1884"></a>1884     <em class="brace">}</em>
<a id="L1885" name="L1885"></a>1885 
<a id="L1886" name="L1886"></a>1886     <em class="comment">// Copied from sun.security.x509.KeyUsageExtension</em>
<a id="L1887" name="L1887"></a>1887     <em class="comment">// (without calling the superclass)</em>
<div class="comment">
      Returns a printable representation of the KeyUsage.</div>
<a id="L1891" name="L1891"></a>1891     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/1279.html#L1866" title="Referred from 1866 in src/java/security/cert/X509CertSelector.java.">keyUsageToString</a>(<strong class="reserved">boolean</strong>[] k) <em class="brace">{</em>
<a id="L1892" name="L1892"></a>1892         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s = "KeyUsage [\n";
<a id="L1893" name="L1893"></a>1893         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1894" name="L1894"></a>1894             <strong class="reserved">if</strong> (k[0]) <em class="brace">{</em>
<a id="L1895" name="L1895"></a>1895                 s += "  DigitalSignature\n";
<a id="L1896" name="L1896"></a>1896             <em class="brace">}</em>
<a id="L1897" name="L1897"></a>1897             <strong class="reserved">if</strong> (k[1]) <em class="brace">{</em>
<a id="L1898" name="L1898"></a>1898                 s += "  Non_repudiation\n";
<a id="L1899" name="L1899"></a>1899             <em class="brace">}</em>
<a id="L1900" name="L1900"></a>1900             <strong class="reserved">if</strong> (k[2]) <em class="brace">{</em>
<a id="L1901" name="L1901"></a>1901                 s += "  Key_Encipherment\n";
<a id="L1902" name="L1902"></a>1902             <em class="brace">}</em>
<a id="L1903" name="L1903"></a>1903             <strong class="reserved">if</strong> (k[3]) <em class="brace">{</em>
<a id="L1904" name="L1904"></a>1904                 s += "  Data_Encipherment\n";
<a id="L1905" name="L1905"></a>1905             <em class="brace">}</em>
<a id="L1906" name="L1906"></a>1906             <strong class="reserved">if</strong> (k[4]) <em class="brace">{</em>
<a id="L1907" name="L1907"></a>1907                 s += "  Key_Agreement\n";
<a id="L1908" name="L1908"></a>1908             <em class="brace">}</em>
<a id="L1909" name="L1909"></a>1909             <strong class="reserved">if</strong> (k[5]) <em class="brace">{</em>
<a id="L1910" name="L1910"></a>1910                 s += "  Key_CertSign\n";
<a id="L1911" name="L1911"></a>1911             <em class="brace">}</em>
<a id="L1912" name="L1912"></a>1912             <strong class="reserved">if</strong> (k[6]) <em class="brace">{</em>
<a id="L1913" name="L1913"></a>1913                 s += "  Crl_Sign\n";
<a id="L1914" name="L1914"></a>1914             <em class="brace">}</em>
<a id="L1915" name="L1915"></a>1915             <strong class="reserved">if</strong> (k[7]) <em class="brace">{</em>
<a id="L1916" name="L1916"></a>1916                 s += "  Encipher_Only\n";
<a id="L1917" name="L1917"></a>1917             <em class="brace">}</em>
<a id="L1918" name="L1918"></a>1918             <strong class="reserved">if</strong> (k[8]) <em class="brace">{</em>
<a id="L1919" name="L1919"></a>1919                 s += "  Decipher_Only\n";
<a id="L1920" name="L1920"></a>1920             <em class="brace">}</em>
<a id="L1921" name="L1921"></a>1921         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1761.html#L37" title="Defined at 37 in src/java/lang/ArrayIndexOutOfBoundsException.java.">ArrayIndexOutOfBoundsException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em><em class="brace">}</em>
<a id="L1922" name="L1922"></a>1922 
<a id="L1923" name="L1923"></a>1923         s += "]\n";
<a id="L1924" name="L1924"></a>1924 
<a id="L1925" name="L1925"></a>1925         <strong class="reserved">return</strong> (s);
<a id="L1926" name="L1926"></a>1926     <em class="brace">}</em>
<a id="L1927" name="L1927"></a>1927 
<div class="comment">
      Returns an Extension object given any X509Certificate and extension oid.
      Throw an <code>IOException</code> if the extension byte value is
      malformed.
      @param cert a <code>X509Certificate</code>
      @param extId an <code>integer</code> which specifies the extension index.
      Currently, the supported extensions are as follows:
      index 0 - PrivateKeyUsageExtension
      index 1 - SubjectAlternativeNameExtension
      index 2 - NameConstraintsExtension
      index 3 - CertificatePoliciesExtension
      index 4 - ExtendedKeyUsageExtension
      @return an <code>Extension</code> object whose real type is as specified
      by the extension oid.
      @throws IOException if cannot construct the <code>Extension</code>
      object with the extension encoding retrieved from the passed in
      <code>X509Certificate</code>.</div>
<a id="L1947" name="L1947"></a>1947     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1273.html#L66" title="Defined at 66 in src/java/security/cert/Extension.java.">Extension</a> <a href="../R/16508.html" title="Multiple referred from 5 places.">getExtensionObject</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> cert, <strong class="reserved">int</strong> extId)
<a id="L1948" name="L1948"></a>1948             <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1949" name="L1949"></a>1949         <strong class="reserved">if</strong> (cert <strong class="reserved">instanceof</strong> X509CertImpl) <em class="brace">{</em>
<a id="L1950" name="L1950"></a>1950             X509CertImpl <a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a> = (X509CertImpl)cert;
<a id="L1951" name="L1951"></a>1951             <strong class="reserved">switch</strong> (extId) <em class="brace">{</em>
<a id="L1952" name="L1952"></a>1952             <strong class="reserved">case</strong> PRIVATE_KEY_USAGE_ID:
<a id="L1953" name="L1953"></a>1953                 <strong class="reserved">return</strong> <a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>.getPrivateKeyUsageExtension();
<a id="L1954" name="L1954"></a>1954             <strong class="reserved">case</strong> SUBJECT_ALT_NAME_ID:
<a id="L1955" name="L1955"></a>1955                 <strong class="reserved">return</strong> <a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>.getSubjectAlternativeNameExtension();
<a id="L1956" name="L1956"></a>1956             <strong class="reserved">case</strong> NAME_CONSTRAINTS_ID:
<a id="L1957" name="L1957"></a>1957                 <strong class="reserved">return</strong> <a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>.getNameConstraintsExtension();
<a id="L1958" name="L1958"></a>1958             <strong class="reserved">case</strong> CERT_POLICIES_ID:
<a id="L1959" name="L1959"></a>1959                 <strong class="reserved">return</strong> <a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>.getCertificatePoliciesExtension();
<a id="L1960" name="L1960"></a>1960             <strong class="reserved">case</strong> EXTENDED_KEY_USAGE_ID:
<a id="L1961" name="L1961"></a>1961                 <strong class="reserved">return</strong> <a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>.getExtendedKeyUsageExtension();
<a id="L1962" name="L1962"></a>1962             <strong class="reserved">default</strong>:
<a id="L1963" name="L1963"></a>1963                 <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1964" name="L1964"></a>1964             <em class="brace">}</em>
<a id="L1965" name="L1965"></a>1965         <em class="brace">}</em>
<a id="L1966" name="L1966"></a>1966         <strong class="reserved">byte</strong>[] rawExtVal = cert.<a href="../S/1308.html#L185" title="Defined at 185 in src/java/security/cert/X509Extension.java.">getExtensionValue</a>(EXTENSION_OIDS[extId]);
<a id="L1967" name="L1967"></a>1967         <strong class="reserved">if</strong> (rawExtVal == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1968" name="L1968"></a>1968             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1969" name="L1969"></a>1969         <em class="brace">}</em>
<a id="L1970" name="L1970"></a>1970         DerInputStream <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> = <strong class="reserved">new</strong> DerInputStream(rawExtVal);
<a id="L1971" name="L1971"></a>1971         <strong class="reserved">byte</strong>[] encoded = <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.getOctetString();
<a id="L1972" name="L1972"></a>1972         <strong class="reserved">switch</strong> (extId) <em class="brace">{</em>
<a id="L1973" name="L1973"></a>1973         <strong class="reserved">case</strong> PRIVATE_KEY_USAGE_ID:
<a id="L1974" name="L1974"></a>1974             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1975" name="L1975"></a>1975                 <strong class="reserved">return</strong> <strong class="reserved">new</strong> PrivateKeyUsageExtension(FALSE, encoded);
<a id="L1976" name="L1976"></a>1976             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1348.html" title="Multiple defined in 2 places.">CertificateException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L1977" name="L1977"></a>1977                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>(<a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L1978" name="L1978"></a>1978             <em class="brace">}</em>
<a id="L1979" name="L1979"></a>1979         <strong class="reserved">case</strong> SUBJECT_ALT_NAME_ID:
<a id="L1980" name="L1980"></a>1980             <strong class="reserved">return</strong> <strong class="reserved">new</strong> SubjectAlternativeNameExtension(FALSE, encoded);
<a id="L1981" name="L1981"></a>1981         <strong class="reserved">case</strong> NAME_CONSTRAINTS_ID:
<a id="L1982" name="L1982"></a>1982             <strong class="reserved">return</strong> <strong class="reserved">new</strong> NameConstraintsExtension(FALSE, encoded);
<a id="L1983" name="L1983"></a>1983         <strong class="reserved">case</strong> CERT_POLICIES_ID:
<a id="L1984" name="L1984"></a>1984             <strong class="reserved">return</strong> <strong class="reserved">new</strong> CertificatePoliciesExtension(FALSE, encoded);
<a id="L1985" name="L1985"></a>1985         <strong class="reserved">case</strong> EXTENDED_KEY_USAGE_ID:
<a id="L1986" name="L1986"></a>1986             <strong class="reserved">return</strong> <strong class="reserved">new</strong> ExtendedKeyUsageExtension(FALSE, encoded);
<a id="L1987" name="L1987"></a>1987         <strong class="reserved">default</strong>:
<a id="L1988" name="L1988"></a>1988             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1989" name="L1989"></a>1989         <em class="brace">}</em>
<a id="L1990" name="L1990"></a>1990     <em class="brace">}</em>
<a id="L1991" name="L1991"></a>1991 
<div class="comment">
      Decides whether a <code>Certificate</code> should be selected.
      @param cert the <code>Certificate</code> to be checked
      @return <code>true</code> if the <code>Certificate</code> should be
              selected, <code>false</code> otherwise</div>
<a id="L1999" name="L1999"></a>1999     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/23117.html" title="Multiple referred from 460 places.">match</a>(<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a> cert) <em class="brace">{</em>
<a id="L2000" name="L2000"></a>2000         <strong class="reserved">if</strong> (!(cert <strong class="reserved">instanceof</strong> <a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a>)) <em class="brace">{</em>
<a id="L2001" name="L2001"></a>2001             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2002" name="L2002"></a>2002         <em class="brace">}</em>
<a id="L2003" name="L2003"></a>2003         <a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert = (<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a>)cert;
<a id="L2004" name="L2004"></a>2004 
<a id="L2005" name="L2005"></a>2005         <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2006" name="L2006"></a>2006             <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match(SN: "
<a id="L2007" name="L2007"></a>2007                 + (xcert.<a href="../D/22401.html" title="Multiple defined in 6 places.">getSerialNumber</a>()).<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(16) + "\n  Issuer: "
<a id="L2008" name="L2008"></a>2008                 + xcert.<a href="../D/19843.html" title="Multiple defined in 3 places.">getIssuerDN</a>() + "\n  Subject: " + xcert.<a href="../D/22837.html" title="Multiple defined in 2 places.">getSubjectDN</a>()
<a id="L2009" name="L2009"></a>2009                 + ")");
<a id="L2010" name="L2010"></a>2010         <em class="brace">}</em>
<a id="L2011" name="L2011"></a>2011 
<div class="comment">
         /* match on X509Certificate */</div>
<a id="L2013" name="L2013"></a>2013         <strong class="reserved">if</strong> (x509Cert != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2014" name="L2014"></a>2014             <strong class="reserved">if</strong> (!x509Cert.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(xcert)) <em class="brace">{</em>
<a id="L2015" name="L2015"></a>2015                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2016" name="L2016"></a>2016                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2017" name="L2017"></a>2017                         + "certs don't match");
<a id="L2018" name="L2018"></a>2018                 <em class="brace">}</em>
<a id="L2019" name="L2019"></a>2019                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2020" name="L2020"></a>2020             <em class="brace">}</em>
<a id="L2021" name="L2021"></a>2021         <em class="brace">}</em>
<a id="L2022" name="L2022"></a>2022 
<div class="comment">
         /* match on serial number */</div>
<a id="L2024" name="L2024"></a>2024         <strong class="reserved">if</strong> (<a href="../S/997.html#L123" title="Defined at 123 in src/java/util/Timer.java.">serialNumber</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2025" name="L2025"></a>2025             <strong class="reserved">if</strong> (!<a href="../S/997.html#L123" title="Defined at 123 in src/java/util/Timer.java.">serialNumber</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(xcert.<a href="../D/22401.html" title="Multiple defined in 6 places.">getSerialNumber</a>())) <em class="brace">{</em>
<a id="L2026" name="L2026"></a>2026                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2027" name="L2027"></a>2027                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2028" name="L2028"></a>2028                         + "serial numbers don't match");
<a id="L2029" name="L2029"></a>2029                 <em class="brace">}</em>
<a id="L2030" name="L2030"></a>2030                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2031" name="L2031"></a>2031             <em class="brace">}</em>
<a id="L2032" name="L2032"></a>2032         <em class="brace">}</em>
<a id="L2033" name="L2033"></a>2033 
<div class="comment">
         /* match on issuer name */</div>
<a id="L2035" name="L2035"></a>2035         <strong class="reserved">if</strong> (issuer != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2036" name="L2036"></a>2036             <strong class="reserved">if</strong> (!issuer.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(xcert.<a href="../D/19847.html" title="Multiple defined in 2 places.">getIssuerX500Principal</a>())) <em class="brace">{</em>
<a id="L2037" name="L2037"></a>2037                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2038" name="L2038"></a>2038                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2039" name="L2039"></a>2039                         + "issuer DNs don't match");
<a id="L2040" name="L2040"></a>2040                 <em class="brace">}</em>
<a id="L2041" name="L2041"></a>2041                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2042" name="L2042"></a>2042             <em class="brace">}</em>
<a id="L2043" name="L2043"></a>2043         <em class="brace">}</em>
<a id="L2044" name="L2044"></a>2044 
<div class="comment">
         /* match on subject name */</div>
<a id="L2046" name="L2046"></a>2046         <strong class="reserved">if</strong> (subject != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2047" name="L2047"></a>2047             <strong class="reserved">if</strong> (!subject.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(xcert.<a href="../S/1292.html#L289" title="Defined at 289 in src/java/security/cert/X509Certificate.java.">getSubjectX500Principal</a>())) <em class="brace">{</em>
<a id="L2048" name="L2048"></a>2048                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2049" name="L2049"></a>2049                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2050" name="L2050"></a>2050                         + "subject DNs don't match");
<a id="L2051" name="L2051"></a>2051                 <em class="brace">}</em>
<a id="L2052" name="L2052"></a>2052                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2053" name="L2053"></a>2053             <em class="brace">}</em>
<a id="L2054" name="L2054"></a>2054         <em class="brace">}</em>
<a id="L2055" name="L2055"></a>2055 
<div class="comment">
         /* match on certificate validity range */</div>
<a id="L2057" name="L2057"></a>2057         <strong class="reserved">if</strong> (certificateValid != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2058" name="L2058"></a>2058             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2059" name="L2059"></a>2059                 xcert.<a href="../D/12707.html" title="Multiple defined in 5 places.">checkValidity</a>(certificateValid);
<a id="L2060" name="L2060"></a>2060             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1348.html" title="Multiple defined in 2 places.">CertificateException</a> e) <em class="brace">{</em>
<a id="L2061" name="L2061"></a>2061                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2062" name="L2062"></a>2062                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2063" name="L2063"></a>2063                         + "certificate not within validity period");
<a id="L2064" name="L2064"></a>2064                 <em class="brace">}</em>
<a id="L2065" name="L2065"></a>2065                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2066" name="L2066"></a>2066             <em class="brace">}</em>
<a id="L2067" name="L2067"></a>2067         <em class="brace">}</em>
<a id="L2068" name="L2068"></a>2068 
<div class="comment">
         /* match on subject public key */</div>
<a id="L2070" name="L2070"></a>2070         <strong class="reserved">if</strong> (subjectPublicKeyBytes != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2071" name="L2071"></a>2071             <strong class="reserved">byte</strong>[] certKey = xcert.<a href="../D/21782.html" title="Multiple defined in 14 places.">getPublicKey</a>().<a href="../D/18742.html" title="Multiple defined in 18 places.">getEncoded</a>();
<a id="L2072" name="L2072"></a>2072             <strong class="reserved">if</strong> (!<a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(subjectPublicKeyBytes, certKey)) <em class="brace">{</em>
<a id="L2073" name="L2073"></a>2073                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2074" name="L2074"></a>2074                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2075" name="L2075"></a>2075                         + "subject public keys don't match");
<a id="L2076" name="L2076"></a>2076                 <em class="brace">}</em>
<a id="L2077" name="L2077"></a>2077                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2078" name="L2078"></a>2078             <em class="brace">}</em>
<a id="L2079" name="L2079"></a>2079         <em class="brace">}</em>
<a id="L2080" name="L2080"></a>2080 
<a id="L2081" name="L2081"></a>2081         <strong class="reserved">boolean</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/1279.html#L2562" title="Defined at 2562 in src/java/security/cert/X509CertSelector.java.">matchBasicConstraints</a>(xcert)
<a id="L2082" name="L2082"></a>2082                       &amp;&amp; <a href="../S/1279.html#L2259" title="Defined at 2259 in src/java/security/cert/X509CertSelector.java.">matchKeyUsage</a>(xcert)
<a id="L2083" name="L2083"></a>2083                       &amp;&amp; <a href="../S/1279.html#L2280" title="Defined at 2280 in src/java/security/cert/X509CertSelector.java.">matchExtendedKeyUsage</a>(xcert)
<a id="L2084" name="L2084"></a>2084                       &amp;&amp; <a href="../S/1279.html#L2100" title="Defined at 2100 in src/java/security/cert/X509CertSelector.java.">matchSubjectKeyID</a>(xcert)
<a id="L2085" name="L2085"></a>2085                       &amp;&amp; <a href="../S/1279.html#L2134" title="Defined at 2134 in src/java/security/cert/X509CertSelector.java.">matchAuthorityKeyID</a>(xcert)
<a id="L2086" name="L2086"></a>2086                       &amp;&amp; <a href="../S/1279.html#L2168" title="Defined at 2168 in src/java/security/cert/X509CertSelector.java.">matchPrivateKeyValid</a>(xcert)
<a id="L2087" name="L2087"></a>2087                       &amp;&amp; <a href="../S/1279.html#L2224" title="Defined at 2224 in src/java/security/cert/X509CertSelector.java.">matchSubjectPublicKeyAlgID</a>(xcert)
<a id="L2088" name="L2088"></a>2088                       &amp;&amp; <a href="../S/1279.html#L2381" title="Defined at 2381 in src/java/security/cert/X509CertSelector.java.">matchPolicy</a>(xcert)
<a id="L2089" name="L2089"></a>2089                       &amp;&amp; <a href="../S/1279.html#L2311" title="Defined at 2311 in src/java/security/cert/X509CertSelector.java.">matchSubjectAlternativeNames</a>(xcert)
<a id="L2090" name="L2090"></a>2090                       &amp;&amp; <a href="../S/1279.html#L2446" title="Defined at 2446 in src/java/security/cert/X509CertSelector.java.">matchPathToNames</a>(xcert)
<a id="L2091" name="L2091"></a>2091                       &amp;&amp; <a href="../S/1279.html#L2358" title="Defined at 2358 in src/java/security/cert/X509CertSelector.java.">matchNameConstraints</a>(xcert);
<a id="L2092" name="L2092"></a>2092 
<a id="L2093" name="L2093"></a>2093         <strong class="reserved">if</strong> (<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> &amp;&amp; (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L2094" name="L2094"></a>2094             <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match returning: true");
<a id="L2095" name="L2095"></a>2095         <em class="brace">}</em>
<a id="L2096" name="L2096"></a>2096         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2097" name="L2097"></a>2097     <em class="brace">}</em>
<a id="L2098" name="L2098"></a>2098 
<div class="comment">
     /* match on subject key identifier extension value */</div>
<a id="L2100" name="L2100"></a>2100     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2084" title="Referred from 2084 in src/java/security/cert/X509CertSelector.java.">matchSubjectKeyID</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2101" name="L2101"></a>2101         <strong class="reserved">if</strong> (subjectKeyID == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2102" name="L2102"></a>2102             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2103" name="L2103"></a>2103         <em class="brace">}</em>
<a id="L2104" name="L2104"></a>2104         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2105" name="L2105"></a>2105             <strong class="reserved">byte</strong>[] extVal = xcert.<a href="../S/1308.html#L185" title="Defined at 185 in src/java/security/cert/X509Extension.java.">getExtensionValue</a>("2.5.29.14");
<a id="L2106" name="L2106"></a>2106             <strong class="reserved">if</strong> (extVal == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2107" name="L2107"></a>2107                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2108" name="L2108"></a>2108                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2109" name="L2109"></a>2109                         + "no subject key ID extension");
<a id="L2110" name="L2110"></a>2110                 <em class="brace">}</em>
<a id="L2111" name="L2111"></a>2111                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2112" name="L2112"></a>2112             <em class="brace">}</em>
<a id="L2113" name="L2113"></a>2113             DerInputStream <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> = <strong class="reserved">new</strong> DerInputStream(extVal);
<a id="L2114" name="L2114"></a>2114             <strong class="reserved">byte</strong>[] certSubjectKeyID = <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.getOctetString();
<a id="L2115" name="L2115"></a>2115             <strong class="reserved">if</strong> (certSubjectKeyID == <strong class="reserved">null</strong> ||
<a id="L2116" name="L2116"></a>2116                     !<a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(subjectKeyID, certSubjectKeyID)) <em class="brace">{</em>
<a id="L2117" name="L2117"></a>2117                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2118" name="L2118"></a>2118                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2119" name="L2119"></a>2119                         + "subject key IDs don't match");
<a id="L2120" name="L2120"></a>2120                 <em class="brace">}</em>
<a id="L2121" name="L2121"></a>2121                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2122" name="L2122"></a>2122             <em class="brace">}</em>
<a id="L2123" name="L2123"></a>2123         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L2124" name="L2124"></a>2124             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2125" name="L2125"></a>2125                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2126" name="L2126"></a>2126                     + "exception in subject key ID check");
<a id="L2127" name="L2127"></a>2127             <em class="brace">}</em>
<a id="L2128" name="L2128"></a>2128             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2129" name="L2129"></a>2129         <em class="brace">}</em>
<a id="L2130" name="L2130"></a>2130         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2131" name="L2131"></a>2131     <em class="brace">}</em>
<a id="L2132" name="L2132"></a>2132 
<div class="comment">
     /* match on authority key identifier extension value */</div>
<a id="L2134" name="L2134"></a>2134     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2085" title="Referred from 2085 in src/java/security/cert/X509CertSelector.java.">matchAuthorityKeyID</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2135" name="L2135"></a>2135         <strong class="reserved">if</strong> (authorityKeyID == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2136" name="L2136"></a>2136             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2137" name="L2137"></a>2137         <em class="brace">}</em>
<a id="L2138" name="L2138"></a>2138         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2139" name="L2139"></a>2139             <strong class="reserved">byte</strong>[] extVal = xcert.<a href="../S/1308.html#L185" title="Defined at 185 in src/java/security/cert/X509Extension.java.">getExtensionValue</a>("2.5.29.35");
<a id="L2140" name="L2140"></a>2140             <strong class="reserved">if</strong> (extVal == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2141" name="L2141"></a>2141                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2142" name="L2142"></a>2142                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2143" name="L2143"></a>2143                         + "no authority key ID extension");
<a id="L2144" name="L2144"></a>2144                 <em class="brace">}</em>
<a id="L2145" name="L2145"></a>2145                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2146" name="L2146"></a>2146             <em class="brace">}</em>
<a id="L2147" name="L2147"></a>2147             DerInputStream <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> = <strong class="reserved">new</strong> DerInputStream(extVal);
<a id="L2148" name="L2148"></a>2148             <strong class="reserved">byte</strong>[] certAuthKeyID = <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.getOctetString();
<a id="L2149" name="L2149"></a>2149             <strong class="reserved">if</strong> (certAuthKeyID == <strong class="reserved">null</strong> ||
<a id="L2150" name="L2150"></a>2150                     !<a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(authorityKeyID, certAuthKeyID)) <em class="brace">{</em>
<a id="L2151" name="L2151"></a>2151                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2152" name="L2152"></a>2152                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2153" name="L2153"></a>2153                         + "authority key IDs don't match");
<a id="L2154" name="L2154"></a>2154                 <em class="brace">}</em>
<a id="L2155" name="L2155"></a>2155                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2156" name="L2156"></a>2156             <em class="brace">}</em>
<a id="L2157" name="L2157"></a>2157         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L2158" name="L2158"></a>2158             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2159" name="L2159"></a>2159                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2160" name="L2160"></a>2160                     + "exception in authority key ID check");
<a id="L2161" name="L2161"></a>2161             <em class="brace">}</em>
<a id="L2162" name="L2162"></a>2162             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2163" name="L2163"></a>2163         <em class="brace">}</em>
<a id="L2164" name="L2164"></a>2164         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2165" name="L2165"></a>2165     <em class="brace">}</em>
<a id="L2166" name="L2166"></a>2166 
<div class="comment">
     /* match on private key usage range */</div>
<a id="L2168" name="L2168"></a>2168     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2086" title="Referred from 2086 in src/java/security/cert/X509CertSelector.java.">matchPrivateKeyValid</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2169" name="L2169"></a>2169         <strong class="reserved">if</strong> (privateKeyValid == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2170" name="L2170"></a>2170             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2171" name="L2171"></a>2171         <em class="brace">}</em>
<a id="L2172" name="L2172"></a>2172         PrivateKeyUsageExtension ext = <strong class="reserved">null</strong>;
<a id="L2173" name="L2173"></a>2173         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2174" name="L2174"></a>2174             ext = (PrivateKeyUsageExtension)
<a id="L2175" name="L2175"></a>2175                 <a href="../S/1279.html#L1947" title="Defined at 1947 in src/java/security/cert/X509CertSelector.java.">getExtensionObject</a>(xcert, PRIVATE_KEY_USAGE_ID);
<a id="L2176" name="L2176"></a>2176             <strong class="reserved">if</strong> (ext != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2177" name="L2177"></a>2177                 ext.<a href="../D/36305.html" title="Multiple defined in 2 places.">valid</a>(privateKeyValid);
<a id="L2178" name="L2178"></a>2178             <em class="brace">}</em>
<a id="L2179" name="L2179"></a>2179         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1349.html" title="Multiple defined in 2 places.">CertificateExpiredException</a> e1) <em class="brace">{</em>
<a id="L2180" name="L2180"></a>2180             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2181" name="L2181"></a>2181                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/35330.html" title="Multiple defined in 2 places.">time</a> = "n/a";
<a id="L2182" name="L2182"></a>2182                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2183" name="L2183"></a>2183                     <a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a> notAfter = ext.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(PrivateKeyUsageExtension.NOT_AFTER);
<a id="L2184" name="L2184"></a>2184                     <a href="../D/35330.html" title="Multiple defined in 2 places.">time</a> = notAfter.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L2185" name="L2185"></a>2185                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1348.html" title="Multiple defined in 2 places.">CertificateException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L2186" name="L2186"></a>2186                     <em class="comment">// not able to retrieve notAfter value</em>
<a id="L2187" name="L2187"></a>2187                 <em class="brace">}</em>
<a id="L2188" name="L2188"></a>2188                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: private key usage not "
<a id="L2189" name="L2189"></a>2189                     + "within validity date; ext.NOT_After: "
<a id="L2190" name="L2190"></a>2190                     + <a href="../D/35330.html" title="Multiple defined in 2 places.">time</a> + "; X509CertSelector: "
<a id="L2191" name="L2191"></a>2191                     + <strong class="reserved">this</strong>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L2192" name="L2192"></a>2192                 e1.<a href="../D/29703.html" title="Multiple defined in 46 places.">printStackTrace</a>();
<a id="L2193" name="L2193"></a>2193             <em class="brace">}</em>
<a id="L2194" name="L2194"></a>2194             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2195" name="L2195"></a>2195         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1352.html" title="Multiple defined in 2 places.">CertificateNotYetValidException</a> e2) <em class="brace">{</em>
<a id="L2196" name="L2196"></a>2196             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2197" name="L2197"></a>2197                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/35330.html" title="Multiple defined in 2 places.">time</a> = "n/a";
<a id="L2198" name="L2198"></a>2198                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2199" name="L2199"></a>2199                     <a href="../D/2208.html" title="Multiple defined in 2 places.">Date</a> notBefore = ext.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(PrivateKeyUsageExtension.NOT_BEFORE);
<a id="L2200" name="L2200"></a>2200                     <a href="../D/35330.html" title="Multiple defined in 2 places.">time</a> = notBefore.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L2201" name="L2201"></a>2201                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1348.html" title="Multiple defined in 2 places.">CertificateException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L2202" name="L2202"></a>2202                     <em class="comment">// not able to retrieve notBefore value</em>
<a id="L2203" name="L2203"></a>2203                 <em class="brace">}</em>
<a id="L2204" name="L2204"></a>2204                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: private key usage not "
<a id="L2205" name="L2205"></a>2205                     + "within validity date; ext.NOT_BEFORE: "
<a id="L2206" name="L2206"></a>2206                     + <a href="../D/35330.html" title="Multiple defined in 2 places.">time</a> + "; X509CertSelector: "
<a id="L2207" name="L2207"></a>2207                     + <strong class="reserved">this</strong>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L2208" name="L2208"></a>2208                 e2.<a href="../D/29703.html" title="Multiple defined in 46 places.">printStackTrace</a>();
<a id="L2209" name="L2209"></a>2209             <em class="brace">}</em>
<a id="L2210" name="L2210"></a>2210             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2211" name="L2211"></a>2211         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> e4) <em class="brace">{</em>
<a id="L2212" name="L2212"></a>2212             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2213" name="L2213"></a>2213                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: IOException in "
<a id="L2214" name="L2214"></a>2214                     + "private key usage check; X509CertSelector: "
<a id="L2215" name="L2215"></a>2215                     + <strong class="reserved">this</strong>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L2216" name="L2216"></a>2216                 e4.<a href="../D/29703.html" title="Multiple defined in 46 places.">printStackTrace</a>();
<a id="L2217" name="L2217"></a>2217             <em class="brace">}</em>
<a id="L2218" name="L2218"></a>2218             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2219" name="L2219"></a>2219         <em class="brace">}</em>
<a id="L2220" name="L2220"></a>2220         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2221" name="L2221"></a>2221     <em class="brace">}</em>
<a id="L2222" name="L2222"></a>2222 
<div class="comment">
     /* match on subject public key algorithm OID */</div>
<a id="L2224" name="L2224"></a>2224     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2087" title="Referred from 2087 in src/java/security/cert/X509CertSelector.java.">matchSubjectPublicKeyAlgID</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2225" name="L2225"></a>2225         <strong class="reserved">if</strong> (subjectPublicKeyAlgID == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2226" name="L2226"></a>2226             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2227" name="L2227"></a>2227         <em class="brace">}</em>
<a id="L2228" name="L2228"></a>2228         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2229" name="L2229"></a>2229             <strong class="reserved">byte</strong>[] encodedKey = xcert.<a href="../D/21782.html" title="Multiple defined in 14 places.">getPublicKey</a>().<a href="../D/18742.html" title="Multiple defined in 18 places.">getEncoded</a>();
<a id="L2230" name="L2230"></a>2230             DerValue <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a> = <strong class="reserved">new</strong> DerValue(encodedKey);
<a id="L2231" name="L2231"></a>2231             <strong class="reserved">if</strong> (<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>.tag != DerValue.tag_Sequence) <em class="brace">{</em>
<a id="L2232" name="L2232"></a>2232                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("invalid key format");
<a id="L2233" name="L2233"></a>2233             <em class="brace">}</em>
<a id="L2234" name="L2234"></a>2234 
<a id="L2235" name="L2235"></a>2235             AlgorithmId algID = AlgorithmId.<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>.<a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>.getDerValue());
<a id="L2236" name="L2236"></a>2236             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2237" name="L2237"></a>2237                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: subjectPublicKeyAlgID = "
<a id="L2238" name="L2238"></a>2238                     + subjectPublicKeyAlgID + ", xcert subjectPublicKeyAlgID = "
<a id="L2239" name="L2239"></a>2239                     + algID.getOID());
<a id="L2240" name="L2240"></a>2240             <em class="brace">}</em>
<a id="L2241" name="L2241"></a>2241             <strong class="reserved">if</strong> (!subjectPublicKeyAlgID.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>((<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>)algID.getOID())) <em class="brace">{</em>
<a id="L2242" name="L2242"></a>2242                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2243" name="L2243"></a>2243                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2244" name="L2244"></a>2244                         + "subject public key alg IDs don't match");
<a id="L2245" name="L2245"></a>2245                 <em class="brace">}</em>
<a id="L2246" name="L2246"></a>2246                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2247" name="L2247"></a>2247             <em class="brace">}</em>
<a id="L2248" name="L2248"></a>2248         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> e5) <em class="brace">{</em>
<a id="L2249" name="L2249"></a>2249             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2250" name="L2250"></a>2250                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: IOException in subject "
<a id="L2251" name="L2251"></a>2251                     + "public key algorithm OID check");
<a id="L2252" name="L2252"></a>2252             <em class="brace">}</em>
<a id="L2253" name="L2253"></a>2253             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2254" name="L2254"></a>2254         <em class="brace">}</em>
<a id="L2255" name="L2255"></a>2255         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2256" name="L2256"></a>2256     <em class="brace">}</em>
<a id="L2257" name="L2257"></a>2257 
<div class="comment">
     /* match on key usage extension value */</div>
<a id="L2259" name="L2259"></a>2259     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2082" title="Referred from 2082 in src/java/security/cert/X509CertSelector.java.">matchKeyUsage</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2260" name="L2260"></a>2260         <strong class="reserved">if</strong> (keyUsage == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2261" name="L2261"></a>2261             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2262" name="L2262"></a>2262         <em class="brace">}</em>
<a id="L2263" name="L2263"></a>2263         <strong class="reserved">boolean</strong>[] certKeyUsage = xcert.<a href="../D/19959.html" title="Multiple defined in 2 places.">getKeyUsage</a>();
<a id="L2264" name="L2264"></a>2264         <strong class="reserved">if</strong> (certKeyUsage != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2265" name="L2265"></a>2265             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> keyBit = 0; keyBit &lt; keyUsage.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; keyBit++) <em class="brace">{</em>
<a id="L2266" name="L2266"></a>2266                 <strong class="reserved">if</strong> (keyUsage[keyBit] &amp;&amp;
<a id="L2267" name="L2267"></a>2267                     ((keyBit &gt;= certKeyUsage.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) || !certKeyUsage[keyBit])) <em class="brace">{</em>
<a id="L2268" name="L2268"></a>2268                     <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2269" name="L2269"></a>2269                         <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2270" name="L2270"></a>2270                             + "key usage bits don't match");
<a id="L2271" name="L2271"></a>2271                     <em class="brace">}</em>
<a id="L2272" name="L2272"></a>2272                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2273" name="L2273"></a>2273                 <em class="brace">}</em>
<a id="L2274" name="L2274"></a>2274             <em class="brace">}</em>
<a id="L2275" name="L2275"></a>2275         <em class="brace">}</em>
<a id="L2276" name="L2276"></a>2276         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2277" name="L2277"></a>2277     <em class="brace">}</em>
<a id="L2278" name="L2278"></a>2278 
<div class="comment">
     /* match on extended key usage purpose OIDs */</div>
<a id="L2280" name="L2280"></a>2280     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2083" title="Referred from 2083 in src/java/security/cert/X509CertSelector.java.">matchExtendedKeyUsage</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2281" name="L2281"></a>2281         <strong class="reserved">if</strong> ((keyPurposeSet == <strong class="reserved">null</strong>) || keyPurposeSet.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L2282" name="L2282"></a>2282             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2283" name="L2283"></a>2283         <em class="brace">}</em>
<a id="L2284" name="L2284"></a>2284         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2285" name="L2285"></a>2285             ExtendedKeyUsageExtension ext =
<a id="L2286" name="L2286"></a>2286                 (ExtendedKeyUsageExtension)<a href="../S/1279.html#L1947" title="Defined at 1947 in src/java/security/cert/X509CertSelector.java.">getExtensionObject</a>(xcert,
<a id="L2287" name="L2287"></a>2287                                                 EXTENDED_KEY_USAGE_ID);
<a id="L2288" name="L2288"></a>2288             <strong class="reserved">if</strong> (ext != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2289" name="L2289"></a>2289                 <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;ObjectIdentifier&gt; certKeyPurposeVector =
<a id="L2290" name="L2290"></a>2290                     ext.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(ExtendedKeyUsageExtension.USAGES);
<a id="L2291" name="L2291"></a>2291                 <strong class="reserved">if</strong> (!certKeyPurposeVector.<a href="../D/13313.html" title="Multiple defined in 245 places.">contains</a>(ANY_EXTENDED_KEY_USAGE)
<a id="L2292" name="L2292"></a>2292                         &amp;&amp; !certKeyPurposeVector.<a href="../D/13315.html" title="Multiple defined in 21 places.">containsAll</a>(keyPurposeOIDSet)) <em class="brace">{</em>
<a id="L2293" name="L2293"></a>2293                     <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2294" name="L2294"></a>2294                         <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: cert failed "
<a id="L2295" name="L2295"></a>2295                             + "extendedKeyUsage criterion");
<a id="L2296" name="L2296"></a>2296                     <em class="brace">}</em>
<a id="L2297" name="L2297"></a>2297                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2298" name="L2298"></a>2298                 <em class="brace">}</em>
<a id="L2299" name="L2299"></a>2299             <em class="brace">}</em>
<a id="L2300" name="L2300"></a>2300         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L2301" name="L2301"></a>2301             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2302" name="L2302"></a>2302                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2303" name="L2303"></a>2303                     + "IOException in extended key usage check");
<a id="L2304" name="L2304"></a>2304             <em class="brace">}</em>
<a id="L2305" name="L2305"></a>2305             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2306" name="L2306"></a>2306         <em class="brace">}</em>
<a id="L2307" name="L2307"></a>2307         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2308" name="L2308"></a>2308     <em class="brace">}</em>
<a id="L2309" name="L2309"></a>2309 
<div class="comment">
     /* match on subject alternative name extension names */</div>
<a id="L2311" name="L2311"></a>2311     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2089" title="Referred from 2089 in src/java/security/cert/X509CertSelector.java.">matchSubjectAlternativeNames</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2312" name="L2312"></a>2312         <strong class="reserved">if</strong> ((subjectAlternativeNames == <strong class="reserved">null</strong>) || subjectAlternativeNames.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L2313" name="L2313"></a>2313             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2314" name="L2314"></a>2314         <em class="brace">}</em>
<a id="L2315" name="L2315"></a>2315         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2316" name="L2316"></a>2316             SubjectAlternativeNameExtension sanExt =
<a id="L2317" name="L2317"></a>2317                 (SubjectAlternativeNameExtension) <a href="../S/1279.html#L1947" title="Defined at 1947 in src/java/security/cert/X509CertSelector.java.">getExtensionObject</a>(xcert,
<a id="L2318" name="L2318"></a>2318                                                       SUBJECT_ALT_NAME_ID);
<a id="L2319" name="L2319"></a>2319             <strong class="reserved">if</strong> (sanExt == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2320" name="L2320"></a>2320                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2321" name="L2321"></a>2321                   <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2322" name="L2322"></a>2322                       + "no subject alternative name extension");
<a id="L2323" name="L2323"></a>2323                 <em class="brace">}</em>
<a id="L2324" name="L2324"></a>2324                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2325" name="L2325"></a>2325             <em class="brace">}</em>
<a id="L2326" name="L2326"></a>2326             GeneralNames certNames =
<a id="L2327" name="L2327"></a>2327                     sanExt.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(SubjectAlternativeNameExtension.SUBJECT_NAME);
<a id="L2328" name="L2328"></a>2328             <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;GeneralNameInterface&gt; i =
<a id="L2329" name="L2329"></a>2329                                 subjectAlternativeGeneralNames.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L2330" name="L2330"></a>2330             <strong class="reserved">while</strong> (i.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L2331" name="L2331"></a>2331                 GeneralNameInterface matchName = i.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L2332" name="L2332"></a>2332                 <strong class="reserved">boolean</strong> found = <strong class="reserved">false</strong>;
<a id="L2333" name="L2333"></a>2333                 <strong class="reserved">for</strong> (<a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;GeneralName&gt; t = certNames.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L2334" name="L2334"></a>2334                                                 t.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>() &amp;&amp; !found; ) <em class="brace">{</em>
<a id="L2335" name="L2335"></a>2335                     GeneralNameInterface certName = (t.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>()).<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L2336" name="L2336"></a>2336                     found = certName.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(matchName);
<a id="L2337" name="L2337"></a>2337                 <em class="brace">}</em>
<a id="L2338" name="L2338"></a>2338                 <strong class="reserved">if</strong> (!found &amp;&amp; (matchAllSubjectAltNames || !i.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>())) <em class="brace">{</em>
<a id="L2339" name="L2339"></a>2339                     <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2340" name="L2340"></a>2340                       <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: subject alternative "
<a id="L2341" name="L2341"></a>2341                           + "name " + matchName + " not found");
<a id="L2342" name="L2342"></a>2342                     <em class="brace">}</em>
<a id="L2343" name="L2343"></a>2343                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2344" name="L2344"></a>2344                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (found &amp;&amp; !matchAllSubjectAltNames) <em class="brace">{</em>
<a id="L2345" name="L2345"></a>2345                     <strong class="reserved">break</strong>;
<a id="L2346" name="L2346"></a>2346                 <em class="brace">}</em>
<a id="L2347" name="L2347"></a>2347             <em class="brace">}</em>
<a id="L2348" name="L2348"></a>2348         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L2349" name="L2349"></a>2349             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>)
<a id="L2350" name="L2350"></a>2350                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: IOException in subject "
<a id="L2351" name="L2351"></a>2351                     + "alternative name check");
<a id="L2352" name="L2352"></a>2352             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2353" name="L2353"></a>2353         <em class="brace">}</em>
<a id="L2354" name="L2354"></a>2354         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2355" name="L2355"></a>2355     <em class="brace">}</em>
<a id="L2356" name="L2356"></a>2356 
<div class="comment">
     /* match on name constraints */</div>
<a id="L2358" name="L2358"></a>2358     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2091" title="Referred from 2091 in src/java/security/cert/X509CertSelector.java.">matchNameConstraints</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2359" name="L2359"></a>2359         <strong class="reserved">if</strong> (nc == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2360" name="L2360"></a>2360             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2361" name="L2361"></a>2361         <em class="brace">}</em>
<a id="L2362" name="L2362"></a>2362         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2363" name="L2363"></a>2363             <strong class="reserved">if</strong> (!nc.<a href="../D/36390.html" title="Multiple defined in 23 places.">verify</a>(xcert)) <em class="brace">{</em>
<a id="L2364" name="L2364"></a>2364                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2365" name="L2365"></a>2365                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2366" name="L2366"></a>2366                         + "name constraints not satisfied");
<a id="L2367" name="L2367"></a>2367                 <em class="brace">}</em>
<a id="L2368" name="L2368"></a>2368                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2369" name="L2369"></a>2369             <em class="brace">}</em>
<a id="L2370" name="L2370"></a>2370         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> e) <em class="brace">{</em>
<a id="L2371" name="L2371"></a>2371             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2372" name="L2372"></a>2372                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2373" name="L2373"></a>2373                     + "IOException in name constraints check");
<a id="L2374" name="L2374"></a>2374             <em class="brace">}</em>
<a id="L2375" name="L2375"></a>2375             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2376" name="L2376"></a>2376         <em class="brace">}</em>
<a id="L2377" name="L2377"></a>2377         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2378" name="L2378"></a>2378     <em class="brace">}</em>
<a id="L2379" name="L2379"></a>2379 
<div class="comment">
     /* match on policy OIDs */</div>
<a id="L2381" name="L2381"></a>2381     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2088" title="Referred from 2088 in src/java/security/cert/X509CertSelector.java.">matchPolicy</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2382" name="L2382"></a>2382         <strong class="reserved">if</strong> (policy == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2383" name="L2383"></a>2383             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2384" name="L2384"></a>2384         <em class="brace">}</em>
<a id="L2385" name="L2385"></a>2385         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2386" name="L2386"></a>2386             CertificatePoliciesExtension ext = (CertificatePoliciesExtension)
<a id="L2387" name="L2387"></a>2387                 <a href="../S/1279.html#L1947" title="Defined at 1947 in src/java/security/cert/X509CertSelector.java.">getExtensionObject</a>(xcert, CERT_POLICIES_ID);
<a id="L2388" name="L2388"></a>2388             <strong class="reserved">if</strong> (ext == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2389" name="L2389"></a>2389                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2390" name="L2390"></a>2390                   <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2391" name="L2391"></a>2391                       + "no certificate policy extension");
<a id="L2392" name="L2392"></a>2392                 <em class="brace">}</em>
<a id="L2393" name="L2393"></a>2393                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2394" name="L2394"></a>2394             <em class="brace">}</em>
<a id="L2395" name="L2395"></a>2395             <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;PolicyInformation&gt; policies = ext.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(CertificatePoliciesExtension.POLICIES);
<div class="comment">
              Convert the Vector of PolicyInformation to a Vector
              of CertificatePolicyIds for easier comparison.</div>
<a id="L2400" name="L2400"></a>2400             <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;CertificatePolicyId&gt; policyIDs = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;CertificatePolicyId&gt;(policies.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>());
<a id="L2401" name="L2401"></a>2401             <strong class="reserved">for</strong> (PolicyInformation <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a> : policies) <em class="brace">{</em>
<a id="L2402" name="L2402"></a>2402                 policyIDs.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>.getPolicyIdentifier());
<a id="L2403" name="L2403"></a>2403             <em class="brace">}</em>
<a id="L2404" name="L2404"></a>2404             <strong class="reserved">if</strong> (policy != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2405" name="L2405"></a>2405                 <strong class="reserved">boolean</strong> foundOne = <strong class="reserved">false</strong>;
<div class="comment">
                  if the user passes in an empty policy Set, then
                  we just want to make sure that the candidate certificate
                  has some policy OID in its CertPoliciesExtension</div>
<a id="L2411" name="L2411"></a>2411                 <strong class="reserved">if</strong> (policy.getCertPolicyIds().<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L2412" name="L2412"></a>2412                     <strong class="reserved">if</strong> (policyIDs.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L2413" name="L2413"></a>2413                         <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2414" name="L2414"></a>2414                             <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2415" name="L2415"></a>2415                                 + "cert failed policyAny criterion");
<a id="L2416" name="L2416"></a>2416                         <em class="brace">}</em>
<a id="L2417" name="L2417"></a>2417                         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2418" name="L2418"></a>2418                     <em class="brace">}</em>
<a id="L2419" name="L2419"></a>2419                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2420" name="L2420"></a>2420                     <strong class="reserved">for</strong> (CertificatePolicyId <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a> : policy.getCertPolicyIds()) <em class="brace">{</em>
<a id="L2421" name="L2421"></a>2421                         <strong class="reserved">if</strong> (policyIDs.<a href="../D/13313.html" title="Multiple defined in 245 places.">contains</a>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>)) <em class="brace">{</em>
<a id="L2422" name="L2422"></a>2422                             foundOne = <strong class="reserved">true</strong>;
<a id="L2423" name="L2423"></a>2423                             <strong class="reserved">break</strong>;
<a id="L2424" name="L2424"></a>2424                         <em class="brace">}</em>
<a id="L2425" name="L2425"></a>2425                     <em class="brace">}</em>
<a id="L2426" name="L2426"></a>2426                     <strong class="reserved">if</strong> (!foundOne) <em class="brace">{</em>
<a id="L2427" name="L2427"></a>2427                         <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2428" name="L2428"></a>2428                             <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2429" name="L2429"></a>2429                                 + "cert failed policyAny criterion");
<a id="L2430" name="L2430"></a>2430                         <em class="brace">}</em>
<a id="L2431" name="L2431"></a>2431                         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2432" name="L2432"></a>2432                     <em class="brace">}</em>
<a id="L2433" name="L2433"></a>2433                 <em class="brace">}</em>
<a id="L2434" name="L2434"></a>2434             <em class="brace">}</em>
<a id="L2435" name="L2435"></a>2435         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L2436" name="L2436"></a>2436             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2437" name="L2437"></a>2437                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2438" name="L2438"></a>2438                     + "IOException in certificate policy ID check");
<a id="L2439" name="L2439"></a>2439             <em class="brace">}</em>
<a id="L2440" name="L2440"></a>2440             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2441" name="L2441"></a>2441         <em class="brace">}</em>
<a id="L2442" name="L2442"></a>2442         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2443" name="L2443"></a>2443     <em class="brace">}</em>
<a id="L2444" name="L2444"></a>2444 
<div class="comment">
     /* match on pathToNames */</div>
<a id="L2446" name="L2446"></a>2446     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2090" title="Referred from 2090 in src/java/security/cert/X509CertSelector.java.">matchPathToNames</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2447" name="L2447"></a>2447         <strong class="reserved">if</strong> (pathToGeneralNames == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2448" name="L2448"></a>2448             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2449" name="L2449"></a>2449         <em class="brace">}</em>
<a id="L2450" name="L2450"></a>2450         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2451" name="L2451"></a>2451             NameConstraintsExtension ext = (NameConstraintsExtension)
<a id="L2452" name="L2452"></a>2452                 <a href="../S/1279.html#L1947" title="Defined at 1947 in src/java/security/cert/X509CertSelector.java.">getExtensionObject</a>(xcert, NAME_CONSTRAINTS_ID);
<a id="L2453" name="L2453"></a>2453             <strong class="reserved">if</strong> (ext == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2454" name="L2454"></a>2454                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2455" name="L2455"></a>2455             <em class="brace">}</em>
<a id="L2456" name="L2456"></a>2456             <strong class="reserved">if</strong> ((<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) &amp;&amp; <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.isOn("certpath")) <em class="brace">{</em>
<a id="L2457" name="L2457"></a>2457                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match pathToNames:\n");
<a id="L2458" name="L2458"></a>2458                 <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;GeneralNameInterface&gt; i =
<a id="L2459" name="L2459"></a>2459                                         pathToGeneralNames.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L2460" name="L2460"></a>2460                 <strong class="reserved">while</strong> (i.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L2461" name="L2461"></a>2461                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("    " + i.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>() + "\n");
<a id="L2462" name="L2462"></a>2462                 <em class="brace">}</em>
<a id="L2463" name="L2463"></a>2463             <em class="brace">}</em>
<a id="L2464" name="L2464"></a>2464 
<a id="L2465" name="L2465"></a>2465             GeneralSubtrees permitted =
<a id="L2466" name="L2466"></a>2466                     ext.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(NameConstraintsExtension.PERMITTED_SUBTREES);
<a id="L2467" name="L2467"></a>2467             GeneralSubtrees <a href="../S/3310.html#L123" title="Defined at 123 in src/javax/swing/text/html/parser/TagStack.java.">excluded</a> =
<a id="L2468" name="L2468"></a>2468                     ext.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(NameConstraintsExtension.EXCLUDED_SUBTREES);
<a id="L2469" name="L2469"></a>2469             <strong class="reserved">if</strong> (<a href="../S/3310.html#L123" title="Defined at 123 in src/javax/swing/text/html/parser/TagStack.java.">excluded</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2470" name="L2470"></a>2470                 <strong class="reserved">if</strong> (<a href="../S/1279.html#L2489" title="Defined at 2489 in src/java/security/cert/X509CertSelector.java.">matchExcluded</a>(<a href="../S/3310.html#L123" title="Defined at 123 in src/javax/swing/text/html/parser/TagStack.java.">excluded</a>) == <strong class="reserved">false</strong>) <em class="brace">{</em>
<a id="L2471" name="L2471"></a>2471                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2472" name="L2472"></a>2472                 <em class="brace">}</em>
<a id="L2473" name="L2473"></a>2473             <em class="brace">}</em>
<a id="L2474" name="L2474"></a>2474             <strong class="reserved">if</strong> (permitted != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2475" name="L2475"></a>2475                 <strong class="reserved">if</strong> (<a href="../S/1279.html#L2520" title="Defined at 2520 in src/java/security/cert/X509CertSelector.java.">matchPermitted</a>(permitted) == <strong class="reserved">false</strong>) <em class="brace">{</em>
<a id="L2476" name="L2476"></a>2476                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2477" name="L2477"></a>2477                 <em class="brace">}</em>
<a id="L2478" name="L2478"></a>2478             <em class="brace">}</em>
<a id="L2479" name="L2479"></a>2479         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>) <em class="brace">{</em>
<a id="L2480" name="L2480"></a>2480             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2481" name="L2481"></a>2481                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: "
<a id="L2482" name="L2482"></a>2482                     + "IOException in name constraints check");
<a id="L2483" name="L2483"></a>2483             <em class="brace">}</em>
<a id="L2484" name="L2484"></a>2484             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2485" name="L2485"></a>2485         <em class="brace">}</em>
<a id="L2486" name="L2486"></a>2486         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2487" name="L2487"></a>2487     <em class="brace">}</em>
<a id="L2488" name="L2488"></a>2488 
<a id="L2489" name="L2489"></a>2489     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2470" title="Referred from 2470 in src/java/security/cert/X509CertSelector.java.">matchExcluded</a>(GeneralSubtrees <a href="../S/3310.html#L123" title="Defined at 123 in src/javax/swing/text/html/parser/TagStack.java.">excluded</a>) <em class="brace">{</em>
<div class="comment">
          Enumerate through excluded and compare each entry
          to all pathToNames. If any pathToName is within any of the
          subtrees listed in excluded, return false.</div>
<a id="L2495" name="L2495"></a>2495         <strong class="reserved">for</strong> (<a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;GeneralSubtree&gt; t = <a href="../S/3310.html#L123" title="Defined at 123 in src/javax/swing/text/html/parser/TagStack.java.">excluded</a>.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>(); t.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>(); ) <em class="brace">{</em>
<a id="L2496" name="L2496"></a>2496             GeneralSubtree tree = t.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L2497" name="L2497"></a>2497             GeneralNameInterface excludedName = tree.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L2498" name="L2498"></a>2498             <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;GeneralNameInterface&gt; i = pathToGeneralNames.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L2499" name="L2499"></a>2499             <strong class="reserved">while</strong> (i.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L2500" name="L2500"></a>2500                 GeneralNameInterface pathToName = i.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L2501" name="L2501"></a>2501                 <strong class="reserved">if</strong> (excludedName.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>() == pathToName.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>()) <em class="brace">{</em>
<a id="L2502" name="L2502"></a>2502                     <strong class="reserved">switch</strong> (pathToName.constrains(excludedName)) <em class="brace">{</em>
<a id="L2503" name="L2503"></a>2503                     <strong class="reserved">case</strong> GeneralNameInterface.NAME_WIDENS:
<a id="L2504" name="L2504"></a>2504                     <strong class="reserved">case</strong> GeneralNameInterface.NAME_MATCH:
<a id="L2505" name="L2505"></a>2505                         <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2506" name="L2506"></a>2506                             <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: name constraints "
<a id="L2507" name="L2507"></a>2507                                 + "inhibit path to specified name");
<a id="L2508" name="L2508"></a>2508                             <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: excluded name: " +
<a id="L2509" name="L2509"></a>2509                                 pathToName);
<a id="L2510" name="L2510"></a>2510                         <em class="brace">}</em>
<a id="L2511" name="L2511"></a>2511                         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2512" name="L2512"></a>2512                     <strong class="reserved">default</strong>:
<a id="L2513" name="L2513"></a>2513                     <em class="brace">}</em>
<a id="L2514" name="L2514"></a>2514                 <em class="brace">}</em>
<a id="L2515" name="L2515"></a>2515             <em class="brace">}</em>
<a id="L2516" name="L2516"></a>2516         <em class="brace">}</em>
<a id="L2517" name="L2517"></a>2517         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2518" name="L2518"></a>2518     <em class="brace">}</em>
<a id="L2519" name="L2519"></a>2519 
<a id="L2520" name="L2520"></a>2520     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2475" title="Referred from 2475 in src/java/security/cert/X509CertSelector.java.">matchPermitted</a>(GeneralSubtrees permitted) <em class="brace">{</em>
<div class="comment">
          Enumerate through pathToNames, checking that each pathToName
          is in at least one of the subtrees listed in permitted.
          If not, return false. However, if no subtrees of a given type
          are listed, all names of that type are permitted.</div>
<a id="L2527" name="L2527"></a>2527         <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;GeneralNameInterface&gt; i = pathToGeneralNames.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L2528" name="L2528"></a>2528         <strong class="reserved">while</strong> (i.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>()) <em class="brace">{</em>
<a id="L2529" name="L2529"></a>2529             GeneralNameInterface pathToName = i.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L2530" name="L2530"></a>2530             <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;GeneralSubtree&gt; t = permitted.<a href="../D/26592.html" title="Multiple defined in 126 places.">iterator</a>();
<a id="L2531" name="L2531"></a>2531             <strong class="reserved">boolean</strong> permittedNameFound = <strong class="reserved">false</strong>;
<a id="L2532" name="L2532"></a>2532             <strong class="reserved">boolean</strong> nameTypeFound = <strong class="reserved">false</strong>;
<a id="L2533" name="L2533"></a>2533             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> names = "";
<a id="L2534" name="L2534"></a>2534             <strong class="reserved">while</strong> (t.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>() &amp;&amp; !permittedNameFound) <em class="brace">{</em>
<a id="L2535" name="L2535"></a>2535                 GeneralSubtree tree = t.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L2536" name="L2536"></a>2536                 GeneralNameInterface permittedName = tree.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>();
<a id="L2537" name="L2537"></a>2537                 <strong class="reserved">if</strong> (permittedName.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>() == pathToName.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>()) <em class="brace">{</em>
<a id="L2538" name="L2538"></a>2538                     nameTypeFound = <strong class="reserved">true</strong>;
<a id="L2539" name="L2539"></a>2539                     names = names + "  " + permittedName;
<a id="L2540" name="L2540"></a>2540                     <strong class="reserved">switch</strong> (pathToName.constrains(permittedName)) <em class="brace">{</em>
<a id="L2541" name="L2541"></a>2541                     <strong class="reserved">case</strong> GeneralNameInterface.NAME_WIDENS:
<a id="L2542" name="L2542"></a>2542                     <strong class="reserved">case</strong> GeneralNameInterface.NAME_MATCH:
<a id="L2543" name="L2543"></a>2543                         permittedNameFound = <strong class="reserved">true</strong>;
<a id="L2544" name="L2544"></a>2544                         <strong class="reserved">break</strong>;
<a id="L2545" name="L2545"></a>2545                     <strong class="reserved">default</strong>:
<a id="L2546" name="L2546"></a>2546                     <em class="brace">}</em>
<a id="L2547" name="L2547"></a>2547                 <em class="brace">}</em>
<a id="L2548" name="L2548"></a>2548             <em class="brace">}</em>
<a id="L2549" name="L2549"></a>2549             <strong class="reserved">if</strong> (!permittedNameFound &amp;&amp; nameTypeFound) <em class="brace">{</em>
<a id="L2550" name="L2550"></a>2550                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>)
<a id="L2551" name="L2551"></a>2551                   <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: " +
<a id="L2552" name="L2552"></a>2552                             "name constraints inhibit path to specified name; " +
<a id="L2553" name="L2553"></a>2553                             "permitted names of type " + pathToName.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>() +
<a id="L2554" name="L2554"></a>2554                             ": " + names);
<a id="L2555" name="L2555"></a>2555                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2556" name="L2556"></a>2556             <em class="brace">}</em>
<a id="L2557" name="L2557"></a>2557         <em class="brace">}</em>
<a id="L2558" name="L2558"></a>2558         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2559" name="L2559"></a>2559     <em class="brace">}</em>
<a id="L2560" name="L2560"></a>2560 
<div class="comment">
     /* match on basic constraints */</div>
<a id="L2562" name="L2562"></a>2562     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1279.html#L2081" title="Referred from 2081 in src/java/security/cert/X509CertSelector.java.">matchBasicConstraints</a>(<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> xcert) <em class="brace">{</em>
<a id="L2563" name="L2563"></a>2563         <strong class="reserved">if</strong> (basicConstraints == -1) <em class="brace">{</em>
<a id="L2564" name="L2564"></a>2564             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2565" name="L2565"></a>2565         <em class="brace">}</em>
<a id="L2566" name="L2566"></a>2566         <strong class="reserved">int</strong> maxPathLen = xcert.<a href="../D/17215.html" title="Multiple defined in 2 places.">getBasicConstraints</a>();
<a id="L2567" name="L2567"></a>2567         <strong class="reserved">if</strong> (basicConstraints == -2) <em class="brace">{</em>
<a id="L2568" name="L2568"></a>2568             <strong class="reserved">if</strong> (maxPathLen != -1) <em class="brace">{</em>
<a id="L2569" name="L2569"></a>2569                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2570" name="L2570"></a>2570                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: not an EE cert");
<a id="L2571" name="L2571"></a>2571                 <em class="brace">}</em>
<a id="L2572" name="L2572"></a>2572                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2573" name="L2573"></a>2573             <em class="brace">}</em>
<a id="L2574" name="L2574"></a>2574         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2575" name="L2575"></a>2575             <strong class="reserved">if</strong> (maxPathLen &lt; basicConstraints) <em class="brace">{</em>
<a id="L2576" name="L2576"></a>2576                 <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2577" name="L2577"></a>2577                     <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("X509CertSelector.match: cert's maxPathLen " +
<a id="L2578" name="L2578"></a>2578                             "is less than the min maxPathLen set by " +
<a id="L2579" name="L2579"></a>2579                             "basicConstraints. " +
<a id="L2580" name="L2580"></a>2580                             "(" + maxPathLen + " &lt; " + basicConstraints + ")");
<a id="L2581" name="L2581"></a>2581                 <em class="brace">}</em>
<a id="L2582" name="L2582"></a>2582                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2583" name="L2583"></a>2583             <em class="brace">}</em>
<a id="L2584" name="L2584"></a>2584         <em class="brace">}</em>
<a id="L2585" name="L2585"></a>2585         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2586" name="L2586"></a>2586     <em class="brace">}</em>
<a id="L2587" name="L2587"></a>2587 
<a id="L2588" name="L2588"></a>2588     @<a href="../R/7764.html" title="Multiple referred from 264 places.">SuppressWarnings</a>("unchecked") <em class="comment">// Safe casts assuming clone() works correctly</em>
<a id="L2589" name="L2589"></a>2589     <strong class="reserved">private</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../R/11579.html" title="Multiple referred from 4 places.">cloneSet</a>(<a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>) <em class="brace">{</em>
<a id="L2590" name="L2590"></a>2590         <strong class="reserved">if</strong> (<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a> <strong class="reserved">instanceof</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>) <em class="brace">{</em>
<a id="L2591" name="L2591"></a>2591             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a> = ((<a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt;)<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>).<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L2592" name="L2592"></a>2592             <strong class="reserved">return</strong> (<a href="../S/1160.html#L85" title="Defined at 85 in src/java/util/Set.java.">Set</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt;)<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>;
<a id="L2593" name="L2593"></a>2593         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2594" name="L2594"></a>2594             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1136.html#L89" title="Defined at 89 in src/java/util/HashSet.java.">HashSet</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt;(<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>);
<a id="L2595" name="L2595"></a>2595         <em class="brace">}</em>
<a id="L2596" name="L2596"></a>2596     <em class="brace">}</em>
<a id="L2597" name="L2597"></a>2597 
<div class="comment">
      Returns a copy of this object.
      @return the copy</div>
<a id="L2603" name="L2603"></a>2603     <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/11555.html" title="Multiple referred from 1378 places.">clone</a>() <em class="brace">{</em>
<a id="L2604" name="L2604"></a>2604         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L2605" name="L2605"></a>2605             <a href="../S/1279.html#L86" title="Defined at 86 in src/java/security/cert/X509CertSelector.java.">X509CertSelector</a> <a href="../D/13475.html" title="Multiple defined in 92 places.">copy</a> = (<a href="../S/1279.html#L86" title="Defined at 86 in src/java/security/cert/X509CertSelector.java.">X509CertSelector</a>)<strong class="reserved">super</strong>.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L2606" name="L2606"></a>2606             <em class="comment">// Must clone these because addPathToName et al. modify them</em>
<a id="L2607" name="L2607"></a>2607             <strong class="reserved">if</strong> (subjectAlternativeNames != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2608" name="L2608"></a>2608                 <a href="../D/13475.html" title="Multiple defined in 92 places.">copy</a>.subjectAlternativeNames =
<a id="L2609" name="L2609"></a>2609                         <a href="../S/1279.html#L2589" title="Defined at 2589 in src/java/security/cert/X509CertSelector.java.">cloneSet</a>(subjectAlternativeNames);
<a id="L2610" name="L2610"></a>2610                 <a href="../D/13475.html" title="Multiple defined in 92 places.">copy</a>.subjectAlternativeGeneralNames =
<a id="L2611" name="L2611"></a>2611                         <a href="../S/1279.html#L2589" title="Defined at 2589 in src/java/security/cert/X509CertSelector.java.">cloneSet</a>(subjectAlternativeGeneralNames);
<a id="L2612" name="L2612"></a>2612             <em class="brace">}</em>
<a id="L2613" name="L2613"></a>2613             <strong class="reserved">if</strong> (pathToGeneralNames != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2614" name="L2614"></a>2614                 <a href="../D/13475.html" title="Multiple defined in 92 places.">copy</a>.pathToNames = <a href="../S/1279.html#L2589" title="Defined at 2589 in src/java/security/cert/X509CertSelector.java.">cloneSet</a>(pathToNames);
<a id="L2615" name="L2615"></a>2615                 <a href="../D/13475.html" title="Multiple defined in 92 places.">copy</a>.pathToGeneralNames = <a href="../S/1279.html#L2589" title="Defined at 2589 in src/java/security/cert/X509CertSelector.java.">cloneSet</a>(pathToGeneralNames);
<a id="L2616" name="L2616"></a>2616             <em class="brace">}</em>
<a id="L2617" name="L2617"></a>2617             <strong class="reserved">return</strong> <a href="../D/13475.html" title="Multiple defined in 92 places.">copy</a>;
<a id="L2618" name="L2618"></a>2618         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1725.html#L45" title="Defined at 45 in src/java/lang/CloneNotSupportedException.java.">CloneNotSupportedException</a> e) <em class="brace">{</em>
<div class="comment">
             /* Cannot happen */</div>
<a id="L2620" name="L2620"></a>2620             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>(e.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(), e);
<a id="L2621" name="L2621"></a>2621         <em class="brace">}</em>
<a id="L2622" name="L2622"></a>2622     <em class="brace">}</em>
<a id="L2623" name="L2623"></a>2623 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L174">[^]</a><a href="#L2603">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>