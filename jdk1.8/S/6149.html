<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L192">[^]</a><a href="#L1521">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L192" title="Defined at 192.">functionName</a></li>
<li><a href="#L196" title="Defined at 196.">functionName</a></li>
<li><a href="#L207" title="Defined at 207.">getClassName</a></li>
<li><a href="#L211" title="Defined at 211.">getStylesheet</a></li>
<li><a href="#L215" title="Defined at 215.">addTemplate</a></li>
<li><a href="#L219" title="Defined at 219.">quicksort</a></li>
<li><a href="#L228" title="Defined at 228.">partition</a></li>
<li><a href="#L247" title="Defined at 247.">processPatterns</a></li>
<li><a href="#L301" title="Defined at 301.">flattenAlternative</a></li>
<li><a href="#L331" title="Defined at 331.">addPatternToGroup</a></li>
<li><a href="#L353" title="Defined at 353.">addPattern</a></li>
<li><a href="#L406" title="Defined at 406.">completeTestSequences</a></li>
<li><a href="#L426" title="Defined at 426.">prepareTestSequences</a></li>
<li><a href="#L514" title="Defined at 514.">compileNamedTemplate</a></li>
<li><a href="#L559" title="Defined at 559.">compileTemplates</a></li>
<li><a href="#L586" title="Defined at 586.">appendTemplateCode</a></li>
<li><a href="#L597" title="Defined at 597.">appendTestSequences</a></li>
<li><a href="#L610" title="Defined at 610.">compileGetChildren</a></li>
<li><a href="#L626" title="Defined at 626.">compileDefaultRecursion</a></li>
<li><a href="#L654" title="Defined at 654.">compileDefaultText</a></li>
<li><a href="#L671" title="Defined at 671.">compileNamespaces</a></li>
<li><a href="#L739" title="Defined at 739.">compileApplyTemplates</a></li>
<li><a href="#L1055" title="Defined at 1055.">compileTemplateCalls</a></li>
<li><a href="#L1078" title="Defined at 1078.">compileApplyImports</a></li>
<li><a href="#L1404" title="Defined at 1404.">peepHoleOptimization</a></li>
<li><a href="#L1505" title="Defined at 1505.">getTemplateInstructionHandle</a></li>
<li><a href="#L1512" title="Defined at 1512.">isAttributeName</a></li>
<li><a href="#L1521" title="Defined at 1521.">isNamespaceName</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 2001-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: Mode.java,v 1.2.4.1 2005/09/19 05:18:11 pvedula Exp $</div>
<a id="L23" name="L23"></a>  23 
<a id="L24" name="L24"></a>  24 <strong class="reserved">package</strong> com.sun.org.apache.xalan.internal.xsltc.compiler;
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> java.util.Enumeration;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.util.Hashtable;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.util.Iterator;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.util.Vector;
<a id="L30" name="L30"></a>  30 
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.Instruction;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.BranchHandle;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.ConstantPoolGen;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.DUP;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.GOTO_W;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.IFLT;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.ILOAD;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.INVOKEINTERFACE;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.INVOKEVIRTUAL;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.ISTORE;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.InstructionHandle;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.InstructionList;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.LocalVariableGen;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.SWITCH;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.generic.TargetLostException;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> com.sun.org.apache.bcel.internal.util.InstructionFinder;
<a id="L47" name="L47"></a>  47 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.xsltc.DOM;
<a id="L48" name="L48"></a>  48 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.xsltc.compiler.util.ClassGenerator;
<a id="L49" name="L49"></a>  49 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.xsltc.compiler.util.MethodGenerator;
<a id="L50" name="L50"></a>  50 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.xsltc.compiler.util.NamedMethodGenerator;
<a id="L51" name="L51"></a>  51 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.xsltc.compiler.util.Util;
<a id="L52" name="L52"></a>  52 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.Axis;
<a id="L53" name="L53"></a>  53 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTM;
<a id="L54" name="L54"></a>  54 
<div class="comment">
  Mode gathers all the templates belonging to a given mode;
  it is responsible for generating an appropriate
  applyTemplates + (mode name) method in the translet.
  @author Jacek Ambroziak
  @author Santiago Pericas-Geertsen
  @author Morten Jorgensen
  @author Erwin Bolwidt <ejb@klomp.org>
  @author G. Todd Miller</ejb@klomp.org></div>
<a id="L65" name="L65"></a>  65 <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/5173.html" title="Multiple referred from 35 places.">Mode</a> <strong class="reserved">implements</strong> <a href="../D/1829.html" title="Multiple defined in 9 places.">Constants</a> <em class="brace">{</em>
<a id="L66" name="L66"></a>  66 
<div class="comment">
      The name of this mode as defined in the stylesheet.</div>
<a id="L70" name="L70"></a>  70     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../D/6976.html" title="Multiple defined in 5 places.">QName</a> _name;
<a id="L71" name="L71"></a>  71 
<div class="comment">
      A reference to the stylesheet object that owns this mode.</div>
<a id="L75" name="L75"></a>  75     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/6198.html#L68" title="Defined at 68 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Stylesheet.java.">Stylesheet</a> _stylesheet;
<a id="L76" name="L76"></a>  76 
<div class="comment">
      The name of the method in which this mode is compiled.</div>
<a id="L80" name="L80"></a>  80     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> _methodName;
<a id="L81" name="L81"></a>  81 
<div class="comment">
      A vector of all the templates in this mode.</div>
<a id="L85" name="L85"></a>  85     <strong class="reserved">private</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> _templates;
<a id="L86" name="L86"></a>  86 
<div class="comment">
      Group for patterns with node()-type kernel and child axis.</div>
<a id="L90" name="L90"></a>  90     <strong class="reserved">private</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> _childNodeGroup = <strong class="reserved">null</strong>;
<a id="L91" name="L91"></a>  91 
<div class="comment">
      Test sequence for patterns with node()-type kernel and child axis.</div>
<a id="L95" name="L95"></a>  95     <strong class="reserved">private</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> _childNodeTestSeq = <strong class="reserved">null</strong>;
<a id="L96" name="L96"></a>  96 
<div class="comment">
      Group for patterns with node()-type kernel and attribute axis.</div>
<a id="L100" name="L100"></a> 100     <strong class="reserved">private</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> _attribNodeGroup = <strong class="reserved">null</strong>;
<a id="L101" name="L101"></a> 101 
<div class="comment">
      Test sequence for patterns with node()-type kernel and attribute axis.</div>
<a id="L105" name="L105"></a> 105     <strong class="reserved">private</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> _attribNodeTestSeq = <strong class="reserved">null</strong>;
<a id="L106" name="L106"></a> 106 
<div class="comment">
      Group for patterns with id() or key()-type kernel.</div>
<a id="L110" name="L110"></a> 110     <strong class="reserved">private</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> _idxGroup = <strong class="reserved">null</strong>;
<a id="L111" name="L111"></a> 111 
<div class="comment">
      Test sequence for patterns with id() or key()-type kernel.</div>
<a id="L115" name="L115"></a> 115     <strong class="reserved">private</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> _idxTestSeq = <strong class="reserved">null</strong>;
<a id="L116" name="L116"></a> 116 
<div class="comment">
      Group for patterns with any other kernel type.</div>
<a id="L120" name="L120"></a> 120     <strong class="reserved">private</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>[] _patternGroups;
<a id="L121" name="L121"></a> 121 
<div class="comment">
      Test sequence for patterns with any other kernel type.</div>
<a id="L125" name="L125"></a> 125     <strong class="reserved">private</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a>[] _testSeq;
<a id="L126" name="L126"></a> 126 
<a id="L127" name="L127"></a> 127 
<div class="comment">
      A mapping between templates and test sequences.</div>
<a id="L131" name="L131"></a> 131     <strong class="reserved">private</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a> _neededTemplates = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L132" name="L132"></a> 132 
<div class="comment">
      A mapping between named templates and Mode objects.</div>
<a id="L136" name="L136"></a> 136     <strong class="reserved">private</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a> _namedTemplates = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L137" name="L137"></a> 137 
<div class="comment">
      A mapping between templates and instruction handles.</div>
<a id="L141" name="L141"></a> 141     <strong class="reserved">private</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a> _templateIHs = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L142" name="L142"></a> 142 
<div class="comment">
      A mapping between templates and instruction lists.</div>
<a id="L146" name="L146"></a> 146     <strong class="reserved">private</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a> _templateILs = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L147" name="L147"></a> 147 
<div class="comment">
      A reference to the pattern matching the root node.</div>
<a id="L151" name="L151"></a> 151     <strong class="reserved">private</strong> <a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a> _rootPattern = <strong class="reserved">null</strong>;
<a id="L152" name="L152"></a> 152 
<div class="comment">
      Stores ranges of template precendences for the compilation
      of apply-imports (a Hashtable for historical reasons).</div>
<a id="L157" name="L157"></a> 157     <strong class="reserved">private</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a> _importLevels = <strong class="reserved">null</strong>;
<a id="L158" name="L158"></a> 158 
<div class="comment">
      A mapping between key names and keys.</div>
<a id="L162" name="L162"></a> 162     <strong class="reserved">private</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a> _keys = <strong class="reserved">null</strong>;
<a id="L163" name="L163"></a> 163 
<div class="comment">
      Variable index for the current node used in code generation.</div>
<a id="L167" name="L167"></a> 167     <strong class="reserved">private</strong> <strong class="reserved">int</strong> _currentIndex;
<a id="L168" name="L168"></a> 168 
<div class="comment">
      Creates a new Mode.
      @param name A textual representation of the mode's QName
      @param stylesheet The Stylesheet in which the mode occured
      @param suffix A suffix to append to the method name for this mode
                    (normally a sequence number - still in a String).</div>
<a id="L177" name="L177"></a> 177     <strong class="reserved">public</strong> Mode(<a href="../D/6976.html" title="Multiple defined in 5 places.">QName</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../S/6198.html#L68" title="Defined at 68 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Stylesheet.java.">Stylesheet</a> stylesheet, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> suffix) <em class="brace">{</em>
<a id="L178" name="L178"></a> 178         _name = <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>;
<a id="L179" name="L179"></a> 179         _stylesheet = stylesheet;
<a id="L180" name="L180"></a> 180         _methodName = APPLY_TEMPLATES + suffix;
<a id="L181" name="L181"></a> 181         _templates = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>();
<a id="L182" name="L182"></a> 182         _patternGroups = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>[32];
<a id="L183" name="L183"></a> 183     <em class="brace">}</em>
<a id="L184" name="L184"></a> 184 
<div class="comment">
      Returns the name of the method (_not_ function) that will be
      compiled for this mode. Normally takes the form 'applyTemplates()'
      or * 'applyTemplates2()'.
      @return Method name for this mode</div>
<a id="L192" name="L192"></a> 192     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/14830.html" title="Multiple referred from 15 places.">functionName</a>() <em class="brace">{</em>
<a id="L193" name="L193"></a> 193         <strong class="reserved">return</strong> _methodName;
<a id="L194" name="L194"></a> 194     <em class="brace">}</em>
<a id="L195" name="L195"></a> 195 
<a id="L196" name="L196"></a> 196     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/14830.html" title="Multiple referred from 15 places.">functionName</a>(<strong class="reserved">int</strong> <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>, <strong class="reserved">int</strong> <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>) <em class="brace">{</em>
<a id="L197" name="L197"></a> 197         <strong class="reserved">if</strong> (_importLevels == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L198" name="L198"></a> 198             _importLevels = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L199" name="L199"></a> 199         <em class="brace">}</em>
<a id="L200" name="L200"></a> 200         _importLevels.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(<strong class="reserved">new</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>(<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>), <strong class="reserved">new</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>(<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>));
<a id="L201" name="L201"></a> 201         <strong class="reserved">return</strong> _methodName + '_' + <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>;
<a id="L202" name="L202"></a> 202     <em class="brace">}</em>
<a id="L203" name="L203"></a> 203 
<div class="comment">
      Shortcut to get the class compiled for this mode (will be inlined).</div>
<a id="L207" name="L207"></a> 207     <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/15596.html" title="Multiple referred from 186 places.">getClassName</a>() <em class="brace">{</em>
<a id="L208" name="L208"></a> 208         <strong class="reserved">return</strong> _stylesheet.<a href="../D/17698.html" title="Multiple defined in 41 places.">getClassName</a>();
<a id="L209" name="L209"></a> 209     <em class="brace">}</em>
<a id="L210" name="L210"></a> 210 
<a id="L211" name="L211"></a> 211     <strong class="reserved">public</strong> <a href="../S/6198.html#L68" title="Defined at 68 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Stylesheet.java.">Stylesheet</a> <a href="../R/19247.html" title="Multiple referred from 23 places.">getStylesheet</a>() <em class="brace">{</em>
<a id="L212" name="L212"></a> 212         <strong class="reserved">return</strong> _stylesheet;
<a id="L213" name="L213"></a> 213     <em class="brace">}</em>
<a id="L214" name="L214"></a> 214 
<a id="L215" name="L215"></a> 215     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/9988.html" title="Multiple referred from 5 places.">addTemplate</a>(<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template) <em class="brace">{</em>
<a id="L216" name="L216"></a> 216         _templates.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(template);
<a id="L217" name="L217"></a> 217     <em class="brace">}</em>
<a id="L218" name="L218"></a> 218 
<a id="L219" name="L219"></a> 219     <strong class="reserved">private</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> <a href="../R/25382.html" title="Multiple referred from 10 places.">quicksort</a>(<a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> templates, <strong class="reserved">int</strong> p, <strong class="reserved">int</strong> r) <em class="brace">{</em>
<a id="L220" name="L220"></a> 220         <strong class="reserved">if</strong> (p &lt; r) <em class="brace">{</em>
<a id="L221" name="L221"></a> 221             <strong class="reserved">final</strong> <strong class="reserved">int</strong> q = <a href="../D/29263.html" title="Multiple defined in 4 places.">partition</a>(templates, p, r);
<a id="L222" name="L222"></a> 222             <a href="../D/30078.html" title="Multiple defined in 4 places.">quicksort</a>(templates, p, q);
<a id="L223" name="L223"></a> 223             <a href="../D/30078.html" title="Multiple defined in 4 places.">quicksort</a>(templates, q + 1, r);
<a id="L224" name="L224"></a> 224         <em class="brace">}</em>
<a id="L225" name="L225"></a> 225         <strong class="reserved">return</strong> templates;
<a id="L226" name="L226"></a> 226     <em class="brace">}</em>
<a id="L227" name="L227"></a> 227 
<a id="L228" name="L228"></a> 228     <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/24670.html" title="Multiple referred from 4 places.">partition</a>(<a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> templates, <strong class="reserved">int</strong> p, <strong class="reserved">int</strong> r) <em class="brace">{</em>
<a id="L229" name="L229"></a> 229         <strong class="reserved">final</strong> <a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = (<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a>)templates.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(p);
<a id="L230" name="L230"></a> 230         <strong class="reserved">int</strong> i = p - 1;
<a id="L231" name="L231"></a> 231         <strong class="reserved">int</strong> j = r + 1;
<a id="L232" name="L232"></a> 232         <strong class="reserved">while</strong> (<strong class="reserved">true</strong>) <em class="brace">{</em>
<a id="L233" name="L233"></a> 233             <strong class="reserved">while</strong> (<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/13068.html" title="Multiple defined in 86 places.">compareTo</a>((<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a>)templates.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(--j)) &gt; 0);
<a id="L234" name="L234"></a> 234             <strong class="reserved">while</strong> (<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/13068.html" title="Multiple defined in 86 places.">compareTo</a>((<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a>)templates.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(++i)) &lt; 0);
<a id="L235" name="L235"></a> 235             <strong class="reserved">if</strong> (i &lt; j) <em class="brace">{</em>
<a id="L236" name="L236"></a> 236                 templates.<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>(j, templates.<a href="../D/31832.html" title="Multiple defined in 134 places.">set</a>(i, templates.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(j)));
<a id="L237" name="L237"></a> 237             <em class="brace">}</em>
<a id="L238" name="L238"></a> 238             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L239" name="L239"></a> 239                 <strong class="reserved">return</strong> j;
<a id="L240" name="L240"></a> 240             <em class="brace">}</em>
<a id="L241" name="L241"></a> 241         <em class="brace">}</em>
<a id="L242" name="L242"></a> 242     <em class="brace">}</em>
<a id="L243" name="L243"></a> 243 
<div class="comment">
      Process all the test patterns in this mode</div>
<a id="L247" name="L247"></a> 247     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25176.html" title="Multiple referred from 3 places.">processPatterns</a>(<a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a> <a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>) <em class="brace">{</em>
<a id="L248" name="L248"></a> 248         _keys = <a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>;
<a id="L249" name="L249"></a> 249 
<div class="comment">
System.out.println("Before Sort " + _name);
for (int i = 0; i &lt; _templates.size(); i++) {
    System.out.println("name = " + ((Template)_templates.elementAt(i)).getName());
    System.out.println("pattern = " + ((Template)_templates.elementAt(i)).getPattern());
    System.out.println("priority = " + ((Template)_templates.elementAt(i)).getPriority());
    System.out.println("position = " + ((Template)_templates.elementAt(i)).getPosition());
}</div>
<a id="L259" name="L259"></a> 259 
<a id="L260" name="L260"></a> 260         _templates = <a href="../D/30078.html" title="Multiple defined in 4 places.">quicksort</a>(_templates, 0, _templates.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() - 1);
<a id="L261" name="L261"></a> 261 
<div class="comment">
System.out.println("\n After Sort " + _name);
for (int i = 0; i &lt; _templates.size(); i++) {
    System.out.println("name = " + ((Template)_templates.elementAt(i)).getName());
    System.out.println("pattern = " + ((Template)_templates.elementAt(i)).getPattern());
    System.out.println("priority = " + ((Template)_templates.elementAt(i)).getPriority());
    System.out.println("position = " + ((Template)_templates.elementAt(i)).getPosition());
}</div>
<a id="L271" name="L271"></a> 271 
<a id="L272" name="L272"></a> 272         <em class="comment">// Traverse all templates</em>
<a id="L273" name="L273"></a> 273         <strong class="reserved">final</strong> <a href="../S/1134.html#L61" title="Defined at 61 in src/java/util/Enumeration.java.">Enumeration</a> templates = _templates.<a href="../D/15313.html" title="Multiple defined in 25 places.">elements</a>();
<a id="L274" name="L274"></a> 274         <strong class="reserved">while</strong> (templates.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>()) <em class="brace">{</em>
<a id="L275" name="L275"></a> 275             <em class="comment">// Get the next template</em>
<a id="L276" name="L276"></a> 276             <strong class="reserved">final</strong> <a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template = (<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a>)templates.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>();
<a id="L277" name="L277"></a> 277 
<div class="comment">
              Add this template to a table of named templates if it has a name.
              If there are multiple templates with the same name, all but one
              (the one with highest priority) will be disabled.</div>
<a id="L283" name="L283"></a> 283             <strong class="reserved">if</strong> (template.<a href="../S/6217.html#L107" title="Defined at 107 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">isNamed</a>() &amp;&amp; !template.<a href="../S/6217.html#L95" title="Defined at 95 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">disabled</a>()) <em class="brace">{</em>
<a id="L284" name="L284"></a> 284                 _namedTemplates.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(template, <strong class="reserved">this</strong>);
<a id="L285" name="L285"></a> 285             <em class="brace">}</em>
<a id="L286" name="L286"></a> 286 
<a id="L287" name="L287"></a> 287             <em class="comment">// Add this template to a test sequence if it has a pattern</em>
<a id="L288" name="L288"></a> 288             <strong class="reserved">final</strong> <a href="../D/6677.html" title="Multiple defined in 3 places.">Pattern</a> <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> = template.<a href="../D/21453.html" title="Multiple defined in 7 places.">getPattern</a>();
<a id="L289" name="L289"></a> 289             <strong class="reserved">if</strong> (<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L290" name="L290"></a> 290                 <a href="../S/6149.html#L301" title="Defined at 301 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">flattenAlternative</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>, template, <a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>);
<a id="L291" name="L291"></a> 291             <em class="brace">}</em>
<a id="L292" name="L292"></a> 292         <em class="brace">}</em>
<a id="L293" name="L293"></a> 293         <a href="../S/6149.html#L426" title="Defined at 426 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">prepareTestSequences</a>();
<a id="L294" name="L294"></a> 294     <em class="brace">}</em>
<a id="L295" name="L295"></a> 295 
<div class="comment">
      This method will break up alternative patterns (ie. unions of patterns,
      such as match="A/B | C/B") and add the basic patterns to their
      respective pattern groups.</div>
<a id="L301" name="L301"></a> 301     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/14676.html" title="Multiple referred from 3 places.">flattenAlternative</a>(<a href="../D/6677.html" title="Multiple defined in 3 places.">Pattern</a> <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>,
<a id="L302" name="L302"></a> 302                                     <a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template,
<a id="L303" name="L303"></a> 303                                     <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a> <a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>) <em class="brace">{</em>
<a id="L304" name="L304"></a> 304         <em class="comment">// Patterns on type id() and key() are special since they do not have</em>
<a id="L305" name="L305"></a> 305         <em class="comment">// any kernel node type (it can be anything as long as the node is in</em>
<a id="L306" name="L306"></a> 306         <em class="comment">// the id's or key's index).</em>
<a id="L307" name="L307"></a> 307         <strong class="reserved">if</strong> (<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> <strong class="reserved">instanceof</strong> <a href="../D/4021.html" title="Multiple defined in 2 places.">IdKeyPattern</a>) <em class="brace">{</em>
<a id="L308" name="L308"></a> 308             <strong class="reserved">final</strong> <a href="../D/4021.html" title="Multiple defined in 2 places.">IdKeyPattern</a> idkey = (<a href="../D/4021.html" title="Multiple defined in 2 places.">IdKeyPattern</a>)<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>;
<a id="L309" name="L309"></a> 309             idkey.<a href="../D/34088.html" title="Multiple defined in 2 places.">setTemplate</a>(template);
<a id="L310" name="L310"></a> 310             <strong class="reserved">if</strong> (_idxGroup == <strong class="reserved">null</strong>) _idxGroup = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>();
<a id="L311" name="L311"></a> 311             _idxGroup.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>);
<a id="L312" name="L312"></a> 312         <em class="brace">}</em>
<a id="L313" name="L313"></a> 313         <em class="comment">// Alternative patterns are broken up and re-processed recursively</em>
<a id="L314" name="L314"></a> 314         <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> <strong class="reserved">instanceof</strong> <a href="../S/6161.html#L38" title="Defined at 38 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/AlternativePattern.java.">AlternativePattern</a>) <em class="brace">{</em>
<a id="L315" name="L315"></a> 315             <strong class="reserved">final</strong> <a href="../S/6161.html#L38" title="Defined at 38 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/AlternativePattern.java.">AlternativePattern</a> alt = (<a href="../S/6161.html#L38" title="Defined at 38 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/AlternativePattern.java.">AlternativePattern</a>)<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>;
<a id="L316" name="L316"></a> 316             <a href="../S/6149.html#L301" title="Defined at 301 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">flattenAlternative</a>(alt.<a href="../D/20063.html" title="Multiple defined in 6 places.">getLeft</a>(), template, <a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>);
<a id="L317" name="L317"></a> 317             <a href="../S/6149.html#L301" title="Defined at 301 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">flattenAlternative</a>(alt.<a href="../D/22096.html" title="Multiple defined in 6 places.">getRight</a>(), template, <a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>);
<a id="L318" name="L318"></a> 318         <em class="brace">}</em>
<a id="L319" name="L319"></a> 319         <em class="comment">// Finally we have a pattern that can be added to a test sequence!</em>
<a id="L320" name="L320"></a> 320         <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> <strong class="reserved">instanceof</strong> <a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a>) <em class="brace">{</em>
<a id="L321" name="L321"></a> 321             <strong class="reserved">final</strong> <a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a> lpp = (<a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a>)<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>;
<a id="L322" name="L322"></a> 322             lpp.<a href="../D/34088.html" title="Multiple defined in 2 places.">setTemplate</a>(template);
<a id="L323" name="L323"></a> 323             <a href="../S/6149.html#L331" title="Defined at 331 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">addPatternToGroup</a>(lpp);
<a id="L324" name="L324"></a> 324         <em class="brace">}</em>
<a id="L325" name="L325"></a> 325     <em class="brace">}</em>
<a id="L326" name="L326"></a> 326 
<div class="comment">
      Group patterns by NodeTests of their last Step
      Keep them sorted by priority within group</div>
<a id="L331" name="L331"></a> 331     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6149.html#L323" title="Referred from 323 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">addPatternToGroup</a>(<strong class="reserved">final</strong> <a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a> lpp) <em class="brace">{</em>
<a id="L332" name="L332"></a> 332         <em class="comment">// id() and key()-type patterns do not have a kernel type</em>
<a id="L333" name="L333"></a> 333         <strong class="reserved">if</strong> (lpp <strong class="reserved">instanceof</strong> <a href="../D/4021.html" title="Multiple defined in 2 places.">IdKeyPattern</a>) <em class="brace">{</em>
<a id="L334" name="L334"></a> 334             <a href="../D/10995.html" title="Multiple defined in 2 places.">addPattern</a>(-1, lpp);
<a id="L335" name="L335"></a> 335         <em class="brace">}</em>
<a id="L336" name="L336"></a> 336         <em class="comment">// Otherwise get the kernel pattern from the LPP</em>
<a id="L337" name="L337"></a> 337         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L338" name="L338"></a> 338             <em class="comment">// kernel pattern is the last (maybe only) Step</em>
<a id="L339" name="L339"></a> 339             <strong class="reserved">final</strong> <a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a> kernel = lpp.<a href="../D/19918.html" title="Multiple defined in 6 places.">getKernelPattern</a>();
<a id="L340" name="L340"></a> 340             <strong class="reserved">if</strong> (kernel != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L341" name="L341"></a> 341                 <a href="../D/10995.html" title="Multiple defined in 2 places.">addPattern</a>(kernel.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(), lpp);
<a id="L342" name="L342"></a> 342             <em class="brace">}</em>
<a id="L343" name="L343"></a> 343             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (_rootPattern == <strong class="reserved">null</strong> ||
<a id="L344" name="L344"></a> 344                      lpp.<a href="../S/6172.html#L78" title="Defined at 78 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/LocationPathPattern.java.">noSmallerThan</a>(_rootPattern)) <em class="brace">{</em>
<a id="L345" name="L345"></a> 345                 _rootPattern = lpp;
<a id="L346" name="L346"></a> 346             <em class="brace">}</em>
<a id="L347" name="L347"></a> 347         <em class="brace">}</em>
<a id="L348" name="L348"></a> 348     <em class="brace">}</em>
<a id="L349" name="L349"></a> 349 
<div class="comment">
      Adds a pattern to a pattern group</div>
<a id="L353" name="L353"></a> 353     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/9898.html" title="Multiple referred from 4 places.">addPattern</a>(<strong class="reserved">int</strong> kernelType, <a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a> <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>) <em class="brace">{</em>
<a id="L354" name="L354"></a> 354         <em class="comment">// Make sure the array of pattern groups is long enough</em>
<a id="L355" name="L355"></a> 355         <strong class="reserved">final</strong> <strong class="reserved">int</strong> oldLength = _patternGroups.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L356" name="L356"></a> 356         <strong class="reserved">if</strong> (kernelType &gt;= oldLength) <em class="brace">{</em>
<a id="L357" name="L357"></a> 357             <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>[] newGroups = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>[kernelType * 2];
<a id="L358" name="L358"></a> 358             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(_patternGroups, 0, newGroups, 0, oldLength);
<a id="L359" name="L359"></a> 359             _patternGroups = newGroups;
<a id="L360" name="L360"></a> 360         <em class="brace">}</em>
<a id="L361" name="L361"></a> 361 
<a id="L362" name="L362"></a> 362         <em class="comment">// Find the vector to put this pattern into</em>
<a id="L363" name="L363"></a> 363         <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> patterns;
<a id="L364" name="L364"></a> 364 
<a id="L365" name="L365"></a> 365         <strong class="reserved">if</strong> (kernelType == <a href="../S/6026.html#L38" title="Defined at 38 in src/com/sun/org/apache/xalan/internal/xsltc/DOM.java.">DOM</a>.NO_TYPE) <em class="brace">{</em>
<a id="L366" name="L366"></a> 366             <strong class="reserved">if</strong> (<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>.<a href="../D/17162.html" title="Multiple defined in 25 places.">getAxis</a>() == <a href="../D/639.html" title="Multiple defined in 2 places.">Axis</a>.ATTRIBUTE) <em class="brace">{</em>
<a id="L367" name="L367"></a> 367                 patterns = (_attribNodeGroup == <strong class="reserved">null</strong>) ?
<a id="L368" name="L368"></a> 368                     (_attribNodeGroup = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>(2)) : _attribNodeGroup;
<a id="L369" name="L369"></a> 369             <em class="brace">}</em>
<a id="L370" name="L370"></a> 370             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L371" name="L371"></a> 371                 patterns = (_childNodeGroup == <strong class="reserved">null</strong>) ?
<a id="L372" name="L372"></a> 372                     (_childNodeGroup = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>(2)) : _childNodeGroup;
<a id="L373" name="L373"></a> 373             <em class="brace">}</em>
<a id="L374" name="L374"></a> 374         <em class="brace">}</em>
<a id="L375" name="L375"></a> 375         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L376" name="L376"></a> 376             patterns = (_patternGroups[kernelType] == <strong class="reserved">null</strong>) ?
<a id="L377" name="L377"></a> 377                 (_patternGroups[kernelType] = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>(2)) :
<a id="L378" name="L378"></a> 378                 _patternGroups[kernelType];
<a id="L379" name="L379"></a> 379         <em class="brace">}</em>
<a id="L380" name="L380"></a> 380 
<a id="L381" name="L381"></a> 381         <strong class="reserved">if</strong> (patterns.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() == 0) <em class="brace">{</em>
<a id="L382" name="L382"></a> 382             patterns.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>);
<a id="L383" name="L383"></a> 383         <em class="brace">}</em>
<a id="L384" name="L384"></a> 384         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L385" name="L385"></a> 385             <strong class="reserved">boolean</strong> inserted = <strong class="reserved">false</strong>;
<a id="L386" name="L386"></a> 386             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; patterns.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>(); i++) <em class="brace">{</em>
<a id="L387" name="L387"></a> 387                 <strong class="reserved">final</strong> <a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a> lppToCompare =
<a id="L388" name="L388"></a> 388                     (<a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a>)patterns.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L389" name="L389"></a> 389 
<a id="L390" name="L390"></a> 390                 <strong class="reserved">if</strong> (<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>.<a href="../S/6172.html#L78" title="Defined at 78 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/LocationPathPattern.java.">noSmallerThan</a>(lppToCompare)) <em class="brace">{</em>
<a id="L391" name="L391"></a> 391                     inserted = <strong class="reserved">true</strong>;
<a id="L392" name="L392"></a> 392                     patterns.<a href="../D/24745.html" title="Multiple defined in 12 places.">insertElementAt</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>, i);
<a id="L393" name="L393"></a> 393                     <strong class="reserved">break</strong>;
<a id="L394" name="L394"></a> 394                 <em class="brace">}</em>
<a id="L395" name="L395"></a> 395             <em class="brace">}</em>
<a id="L396" name="L396"></a> 396             <strong class="reserved">if</strong> (inserted == <strong class="reserved">false</strong>) <em class="brace">{</em>
<a id="L397" name="L397"></a> 397                 patterns.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>);
<a id="L398" name="L398"></a> 398             <em class="brace">}</em>
<a id="L399" name="L399"></a> 399         <em class="brace">}</em>
<a id="L400" name="L400"></a> 400     <em class="brace">}</em>
<a id="L401" name="L401"></a> 401 
<div class="comment">
      Complete test sequences of a given type by adding all patterns
      from a given group.</div>
<a id="L406" name="L406"></a> 406     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/11777.html" title="Multiple referred from 9 places.">completeTestSequences</a>(<strong class="reserved">int</strong> nodeType, <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> patterns) <em class="brace">{</em>
<a id="L407" name="L407"></a> 407         <strong class="reserved">if</strong> (patterns != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L408" name="L408"></a> 408             <strong class="reserved">if</strong> (_patternGroups[nodeType] == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L409" name="L409"></a> 409                 _patternGroups[nodeType] = patterns;
<a id="L410" name="L410"></a> 410             <em class="brace">}</em>
<a id="L411" name="L411"></a> 411             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L412" name="L412"></a> 412                 <strong class="reserved">final</strong> <strong class="reserved">int</strong> m = patterns.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L413" name="L413"></a> 413                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> j = 0; j &lt; m; j++) <em class="brace">{</em>
<a id="L414" name="L414"></a> 414                     <a href="../D/10995.html" title="Multiple defined in 2 places.">addPattern</a>(nodeType,
<a id="L415" name="L415"></a> 415                         (<a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a>) patterns.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(j));
<a id="L416" name="L416"></a> 416                 <em class="brace">}</em>
<a id="L417" name="L417"></a> 417             <em class="brace">}</em>
<a id="L418" name="L418"></a> 418         <em class="brace">}</em>
<a id="L419" name="L419"></a> 419     <em class="brace">}</em>
<a id="L420" name="L420"></a> 420 
<div class="comment">
      Build test sequences. The first step is to complete the test sequences
      by including patterns of "*" and "node()" kernel to all element test
      sequences, and of "@*" to all attribute test sequences.</div>
<a id="L426" name="L426"></a> 426     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6149.html#L293" title="Referred from 293 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">prepareTestSequences</a>() <em class="brace">{</em>
<a id="L427" name="L427"></a> 427         <strong class="reserved">final</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> starGroup = _patternGroups[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE];
<a id="L428" name="L428"></a> 428         <strong class="reserved">final</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> atStarGroup = _patternGroups[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE];
<a id="L429" name="L429"></a> 429 
<a id="L430" name="L430"></a> 430         <em class="comment">// Complete test sequence for "text()" with "child::node()"</em>
<a id="L431" name="L431"></a> 431         <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE, _childNodeGroup);
<a id="L432" name="L432"></a> 432 
<a id="L433" name="L433"></a> 433         <em class="comment">// Complete test sequence for "*" with "child::node()"</em>
<a id="L434" name="L434"></a> 434         <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE, _childNodeGroup);
<a id="L435" name="L435"></a> 435 
<a id="L436" name="L436"></a> 436         <em class="comment">// Complete test sequence for "pi()" with "child::node()"</em>
<a id="L437" name="L437"></a> 437         <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE, _childNodeGroup);
<a id="L438" name="L438"></a> 438 
<a id="L439" name="L439"></a> 439         <em class="comment">// Complete test sequence for "comment()" with "child::node()"</em>
<a id="L440" name="L440"></a> 440         <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.COMMENT_NODE, _childNodeGroup);
<a id="L441" name="L441"></a> 441 
<a id="L442" name="L442"></a> 442         <em class="comment">// Complete test sequence for "@*" with "attribute::node()"</em>
<a id="L443" name="L443"></a> 443         <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE, _attribNodeGroup);
<a id="L444" name="L444"></a> 444 
<a id="L445" name="L445"></a> 445         <strong class="reserved">final</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> names = _stylesheet.<a href="../D/23784.html" title="Multiple defined in 2 places.">getXSLTC</a>().<a href="../S/6196.html#L862" title="Defined at 862 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/XSLTC.java.">getNamesIndex</a>();
<a id="L446" name="L446"></a> 446         <strong class="reserved">if</strong> (starGroup != <strong class="reserved">null</strong> || atStarGroup != <strong class="reserved">null</strong> ||
<a id="L447" name="L447"></a> 447             _childNodeGroup != <strong class="reserved">null</strong> || _attribNodeGroup != <strong class="reserved">null</strong>)
<a id="L448" name="L448"></a> 448         <em class="brace">{</em>
<a id="L449" name="L449"></a> 449             <strong class="reserved">final</strong> <strong class="reserved">int</strong> n = _patternGroups.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L450" name="L450"></a> 450 
<a id="L451" name="L451"></a> 451             <em class="comment">// Complete test sequence for user-defined types</em>
<a id="L452" name="L452"></a> 452             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES; i &lt; n; i++) <em class="brace">{</em>
<a id="L453" name="L453"></a> 453                 <strong class="reserved">if</strong> (_patternGroups[i] == <strong class="reserved">null</strong>) <strong class="reserved">continue</strong>;
<a id="L454" name="L454"></a> 454 
<a id="L455" name="L455"></a> 455                 <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) names.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i - <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES);
<a id="L456" name="L456"></a> 456 
<a id="L457" name="L457"></a> 457                 <strong class="reserved">if</strong> (<a href="../S/6149.html#L1512" title="Defined at 1512 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">isAttributeName</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)) <em class="brace">{</em>
<a id="L458" name="L458"></a> 458                     <em class="comment">// If an attribute then copy "@*" to its test sequence</em>
<a id="L459" name="L459"></a> 459                     <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(i, atStarGroup);
<a id="L460" name="L460"></a> 460 
<a id="L461" name="L461"></a> 461                     <em class="comment">// And also copy "attribute::node()" to its test sequence</em>
<a id="L462" name="L462"></a> 462                     <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(i, _attribNodeGroup);
<a id="L463" name="L463"></a> 463                 <em class="brace">}</em>
<a id="L464" name="L464"></a> 464                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L465" name="L465"></a> 465                     <em class="comment">// If an element then copy "*" to its test sequence</em>
<a id="L466" name="L466"></a> 466                     <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(i, starGroup);
<a id="L467" name="L467"></a> 467 
<a id="L468" name="L468"></a> 468                     <em class="comment">// And also copy "child::node()" to its test sequence</em>
<a id="L469" name="L469"></a> 469                     <a href="../S/6149.html#L406" title="Defined at 406 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">completeTestSequences</a>(i, _childNodeGroup);
<a id="L470" name="L470"></a> 470                 <em class="brace">}</em>
<a id="L471" name="L471"></a> 471             <em class="brace">}</em>
<a id="L472" name="L472"></a> 472         <em class="brace">}</em>
<a id="L473" name="L473"></a> 473 
<a id="L474" name="L474"></a> 474         _testSeq = <strong class="reserved">new</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a>[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES + names.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()];
<a id="L475" name="L475"></a> 475 
<a id="L476" name="L476"></a> 476         <strong class="reserved">final</strong> <strong class="reserved">int</strong> n = _patternGroups.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L477" name="L477"></a> 477         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L478" name="L478"></a> 478             <strong class="reserved">final</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> patterns = _patternGroups[i];
<a id="L479" name="L479"></a> 479             <strong class="reserved">if</strong> (patterns != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L480" name="L480"></a> 480                 <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> testSeq = <strong class="reserved">new</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a>(patterns, i, <strong class="reserved">this</strong>);
<a id="L481" name="L481"></a> 481 <em class="comment">// System.out.println("testSeq[" + i + "] = " + testSeq);</em>
<a id="L482" name="L482"></a> 482                 testSeq.<a href="../D/30439.html" title="Multiple defined in 22 places.">reduce</a>();
<a id="L483" name="L483"></a> 483                 _testSeq[i] = testSeq;
<a id="L484" name="L484"></a> 484                 testSeq.<a href="../S/6189.html#L182" title="Defined at 182 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">findTemplates</a>(_neededTemplates);
<a id="L485" name="L485"></a> 485             <em class="brace">}</em>
<a id="L486" name="L486"></a> 486         <em class="brace">}</em>
<a id="L487" name="L487"></a> 487 
<a id="L488" name="L488"></a> 488         <strong class="reserved">if</strong> (_childNodeGroup != <strong class="reserved">null</strong> &amp;&amp; _childNodeGroup.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() &gt; 0) <em class="brace">{</em>
<a id="L489" name="L489"></a> 489             _childNodeTestSeq = <strong class="reserved">new</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a>(_childNodeGroup, -1, <strong class="reserved">this</strong>);
<a id="L490" name="L490"></a> 490             _childNodeTestSeq.<a href="../D/30439.html" title="Multiple defined in 22 places.">reduce</a>();
<a id="L491" name="L491"></a> 491             _childNodeTestSeq.<a href="../S/6189.html#L182" title="Defined at 182 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">findTemplates</a>(_neededTemplates);
<a id="L492" name="L492"></a> 492         <em class="brace">}</em>
<a id="L493" name="L493"></a> 493 
<div class="comment">
        if (_attribNodeGroup != null &amp;&amp; _attribNodeGroup.size() &gt; 0) {
            _attribNodeTestSeq = new TestSeq(_attribNodeGroup, -1, this);
            _attribNodeTestSeq.reduce();
            _attribNodeTestSeq.findTemplates(_neededTemplates);
        }</div>
<a id="L501" name="L501"></a> 501 
<a id="L502" name="L502"></a> 502         <strong class="reserved">if</strong> (_idxGroup != <strong class="reserved">null</strong> &amp;&amp; _idxGroup.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() &gt; 0) <em class="brace">{</em>
<a id="L503" name="L503"></a> 503             _idxTestSeq = <strong class="reserved">new</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a>(_idxGroup, <strong class="reserved">this</strong>);
<a id="L504" name="L504"></a> 504             _idxTestSeq.<a href="../D/30439.html" title="Multiple defined in 22 places.">reduce</a>();
<a id="L505" name="L505"></a> 505             _idxTestSeq.<a href="../S/6189.html#L182" title="Defined at 182 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">findTemplates</a>(_neededTemplates);
<a id="L506" name="L506"></a> 506         <em class="brace">}</em>
<a id="L507" name="L507"></a> 507 
<a id="L508" name="L508"></a> 508         <strong class="reserved">if</strong> (_rootPattern != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L509" name="L509"></a> 509             <em class="comment">// doesn't matter what is 'put', only key matters</em>
<a id="L510" name="L510"></a> 510             _neededTemplates.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(_rootPattern.<a href="../D/23029.html" title="Multiple defined in 5 places.">getTemplate</a>(), <strong class="reserved">this</strong>);
<a id="L511" name="L511"></a> 511         <em class="brace">}</em>
<a id="L512" name="L512"></a> 512     <em class="brace">}</em>
<a id="L513" name="L513"></a> 513 
<a id="L514" name="L514"></a> 514     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6149.html#L566" title="Referred from 566 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileNamedTemplate</a>(<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template,
<a id="L515" name="L515"></a> 515                                       <a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen) <em class="brace">{</em>
<a id="L516" name="L516"></a> 516         <strong class="reserved">final</strong> <a href="../S/4764.html#L78" title="Defined at 78 in src/com/sun/org/apache/bcel/internal/generic/ConstantPoolGen.java.">ConstantPoolGen</a> cpg = classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>();
<a id="L517" name="L517"></a> 517         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> il = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L518" name="L518"></a> 518         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6276.html#L204" title="Defined at 204 in src/com/sun/jmx/mbeanserver/ConvertingMethod.java.">methodName</a> = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../D/15727.html" title="Multiple defined in 5 places.">escape</a>(template.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>().<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L519" name="L519"></a> 519 
<a id="L520" name="L520"></a> 520         <strong class="reserved">int</strong> numParams = 0;
<a id="L521" name="L521"></a> 521         <strong class="reserved">if</strong> (template.<a href="../S/6217.html#L79" title="Defined at 79 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">isSimpleNamedTemplate</a>()) <em class="brace">{</em>
<a id="L522" name="L522"></a> 522             <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> <a href="../D/29062.html" title="Multiple defined in 2 places.">parameters</a> = template.<a href="../D/21383.html" title="Multiple defined in 13 places.">getParameters</a>();
<a id="L523" name="L523"></a> 523             numParams = <a href="../D/29062.html" title="Multiple defined in 2 places.">parameters</a>.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L524" name="L524"></a> 524         <em class="brace">}</em>
<a id="L525" name="L525"></a> 525 
<a id="L526" name="L526"></a> 526         <em class="comment">// Initialize the types and names arrays for the NamedMethodGenerator.</em>
<a id="L527" name="L527"></a> 527         com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>[] types =
<a id="L528" name="L528"></a> 528             <strong class="reserved">new</strong> com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>[4 + numParams];
<a id="L529" name="L529"></a> 529         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] names = <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[4 + numParams];
<a id="L530" name="L530"></a> 530         types[0] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(DOM_INTF_SIG);
<a id="L531" name="L531"></a> 531         types[1] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(NODE_ITERATOR_SIG);
<a id="L532" name="L532"></a> 532         types[2] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(TRANSLET_OUTPUT_SIG);
<a id="L533" name="L533"></a> 533         types[3] = com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>.INT;
<a id="L534" name="L534"></a> 534         names[0] = DOCUMENT_PNAME;
<a id="L535" name="L535"></a> 535         names[1] = ITERATOR_PNAME;
<a id="L536" name="L536"></a> 536         names[2] = TRANSLET_OUTPUT_PNAME;
<a id="L537" name="L537"></a> 537         names[3] = NODE_PNAME;
<a id="L538" name="L538"></a> 538 
<a id="L539" name="L539"></a> 539         <em class="comment">// For simple named templates, the signature of the generated method</em>
<a id="L540" name="L540"></a> 540         <em class="comment">// is not fixed. It depends on the number of parameters declared in the</em>
<a id="L541" name="L541"></a> 541         <em class="comment">// template.</em>
<a id="L542" name="L542"></a> 542         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 4; i &lt; 4 + numParams; i++) <em class="brace">{</em>
<a id="L543" name="L543"></a> 543             types[i] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(OBJECT_SIG);
<a id="L544" name="L544"></a> 544             names[i] = "param" + <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(i-4);
<a id="L545" name="L545"></a> 545         <em class="brace">}</em>
<a id="L546" name="L546"></a> 546 
<a id="L547" name="L547"></a> 547         <a href="../S/6115.html#L39" title="Defined at 39 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/NamedMethodGenerator.java.">NamedMethodGenerator</a> methodGen =
<a id="L548" name="L548"></a> 548                 <strong class="reserved">new</strong> <a href="../S/6115.html#L39" title="Defined at 39 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/NamedMethodGenerator.java.">NamedMethodGenerator</a>(ACC_PUBLIC,
<a id="L549" name="L549"></a> 549                                      com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>.VOID,
<a id="L550" name="L550"></a> 550                                      types, names, <a href="../S/6276.html#L204" title="Defined at 204 in src/com/sun/jmx/mbeanserver/ConvertingMethod.java.">methodName</a>,
<a id="L551" name="L551"></a> 551                                      <a href="../D/17698.html" title="Multiple defined in 41 places.">getClassName</a>(), il, cpg);
<a id="L552" name="L552"></a> 552 
<a id="L553" name="L553"></a> 553         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(template.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen));
<a id="L554" name="L554"></a> 554         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/7024.html" title="Multiple defined in 4 places.">RETURN</a>);
<a id="L555" name="L555"></a> 555 
<a id="L556" name="L556"></a> 556         classGen.<a href="../D/10936.html" title="Multiple defined in 3 places.">addMethod</a>(methodGen);
<a id="L557" name="L557"></a> 557     <em class="brace">}</em>
<a id="L558" name="L558"></a> 558 
<a id="L559" name="L559"></a> 559     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6149.html#L827" title="Referred from 827 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileTemplates</a>(<a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen,
<a id="L560" name="L560"></a> 560                                   <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen,
<a id="L561" name="L561"></a> 561                                   <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>)
<a id="L562" name="L562"></a> 562     <em class="brace">{</em>
<a id="L563" name="L563"></a> 563         <a href="../S/1134.html#L61" title="Defined at 61 in src/java/util/Enumeration.java.">Enumeration</a> templates = _namedTemplates.<a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>();
<a id="L564" name="L564"></a> 564         <strong class="reserved">while</strong> (templates.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>()) <em class="brace">{</em>
<a id="L565" name="L565"></a> 565             <strong class="reserved">final</strong> <a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template = (<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a>)templates.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>();
<a id="L566" name="L566"></a> 566             <a href="../S/6149.html#L514" title="Defined at 514 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileNamedTemplate</a>(template, classGen);
<a id="L567" name="L567"></a> 567         <em class="brace">}</em>
<a id="L568" name="L568"></a> 568 
<a id="L569" name="L569"></a> 569         templates = _neededTemplates.<a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>();
<a id="L570" name="L570"></a> 570         <strong class="reserved">while</strong> (templates.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>()) <em class="brace">{</em>
<a id="L571" name="L571"></a> 571             <strong class="reserved">final</strong> <a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template = (<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a>)templates.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>();
<a id="L572" name="L572"></a> 572             <strong class="reserved">if</strong> (template.<a href="../S/6076.html#L822" title="Defined at 822 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/SyntaxTreeNode.java.">hasContents</a>()) <em class="brace">{</em>
<a id="L573" name="L573"></a> 573                 <em class="comment">// !!! TODO templates both named and matched</em>
<a id="L574" name="L574"></a> 574                 <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> til = template.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen);
<a id="L575" name="L575"></a> 575                 til.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4668.html#L68" title="Defined at 68 in src/com/sun/org/apache/bcel/internal/generic/GOTO_W.java.">GOTO_W</a>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>));
<a id="L576" name="L576"></a> 576                 _templateILs.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(template, til);
<a id="L577" name="L577"></a> 577                 _templateIHs.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(template, til.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>());
<a id="L578" name="L578"></a> 578             <em class="brace">}</em>
<a id="L579" name="L579"></a> 579             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L580" name="L580"></a> 580                 <em class="comment">// empty template</em>
<a id="L581" name="L581"></a> 581                 _templateIHs.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(template, <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>);
<a id="L582" name="L582"></a> 582             <em class="brace">}</em>
<a id="L583" name="L583"></a> 583         <em class="brace">}</em>
<a id="L584" name="L584"></a> 584     <em class="brace">}</em>
<a id="L585" name="L585"></a> 585 
<a id="L586" name="L586"></a> 586     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/10245.html" title="Multiple referred from 2 places.">appendTemplateCode</a>(<a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> body) <em class="brace">{</em>
<a id="L587" name="L587"></a> 587         <strong class="reserved">final</strong> <a href="../S/1134.html#L61" title="Defined at 61 in src/java/util/Enumeration.java.">Enumeration</a> templates = _neededTemplates.<a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>();
<a id="L588" name="L588"></a> 588         <strong class="reserved">while</strong> (templates.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>()) <em class="brace">{</em>
<a id="L589" name="L589"></a> 589             <strong class="reserved">final</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> iList =
<a id="L590" name="L590"></a> 590                 _templateILs.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(templates.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>());
<a id="L591" name="L591"></a> 591             <strong class="reserved">if</strong> (iList != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L592" name="L592"></a> 592                 body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>)iList);
<a id="L593" name="L593"></a> 593             <em class="brace">}</em>
<a id="L594" name="L594"></a> 594         <em class="brace">}</em>
<a id="L595" name="L595"></a> 595     <em class="brace">}</em>
<a id="L596" name="L596"></a> 596 
<a id="L597" name="L597"></a> 597     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/10246.html" title="Multiple referred from 2 places.">appendTestSequences</a>(<a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> body) <em class="brace">{</em>
<a id="L598" name="L598"></a> 598         <strong class="reserved">final</strong> <strong class="reserved">int</strong> n = _testSeq.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L599" name="L599"></a> 599         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L600" name="L600"></a> 600             <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> testSeq = _testSeq[i];
<a id="L601" name="L601"></a> 601             <strong class="reserved">if</strong> (testSeq != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L602" name="L602"></a> 602                 <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> il = testSeq.<a href="../D/19776.html" title="Multiple defined in 7 places.">getInstructionList</a>();
<a id="L603" name="L603"></a> 603                 <strong class="reserved">if</strong> (il != <strong class="reserved">null</strong>)
<a id="L604" name="L604"></a> 604                     body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(il);
<a id="L605" name="L605"></a> 605                 <em class="comment">// else trivial TestSeq</em>
<a id="L606" name="L606"></a> 606             <em class="brace">}</em>
<a id="L607" name="L607"></a> 607         <em class="brace">}</em>
<a id="L608" name="L608"></a> 608     <em class="brace">}</em>
<a id="L609" name="L609"></a> 609 
<a id="L610" name="L610"></a> 610     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../S/6082.html#L176" title="Referred from 176 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/ApplyTemplates.java.">compileGetChildren</a>(<a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen,
<a id="L611" name="L611"></a> 611                                           <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen,
<a id="L612" name="L612"></a> 612                                           <strong class="reserved">int</strong> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>) <em class="brace">{</em>
<a id="L613" name="L613"></a> 613         <strong class="reserved">final</strong> <a href="../S/4764.html#L78" title="Defined at 78 in src/com/sun/org/apache/bcel/internal/generic/ConstantPoolGen.java.">ConstantPoolGen</a> cpg = classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>();
<a id="L614" name="L614"></a> 614         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> il = methodGen.<a href="../D/19776.html" title="Multiple defined in 7 places.">getInstructionList</a>();
<a id="L615" name="L615"></a> 615         <strong class="reserved">final</strong> <strong class="reserved">int</strong> git = cpg.<a href="../D/10875.html" title="Multiple defined in 2 places.">addInterfaceMethodref</a>(DOM_INTF,
<a id="L616" name="L616"></a> 616                                                   GET_CHILDREN,
<a id="L617" name="L617"></a> 617                                                   GET_CHILDREN_SIG);
<a id="L618" name="L618"></a> 618         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26912.html" title="Multiple defined in 4 places.">loadDOM</a>());
<a id="L619" name="L619"></a> 619         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>));
<a id="L620" name="L620"></a> 620         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4624.html#L73" title="Defined at 73 in src/com/sun/org/apache/bcel/internal/generic/INVOKEINTERFACE.java.">INVOKEINTERFACE</a>(git, 2));
<a id="L621" name="L621"></a> 621     <em class="brace">}</em>
<a id="L622" name="L622"></a> 622 
<div class="comment">
      Compiles the default handling for DOM elements: traverse all children</div>
<a id="L626" name="L626"></a> 626     <strong class="reserved">private</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> <a href="../R/11740.html" title="Multiple referred from 2 places.">compileDefaultRecursion</a>(<a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen,
<a id="L627" name="L627"></a> 627                                                     <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen,
<a id="L628" name="L628"></a> 628                                                     <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L629" name="L629"></a> 629         <strong class="reserved">final</strong> <a href="../S/4764.html#L78" title="Defined at 78 in src/com/sun/org/apache/bcel/internal/generic/ConstantPoolGen.java.">ConstantPoolGen</a> cpg = classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>();
<a id="L630" name="L630"></a> 630         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> il = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L631" name="L631"></a> 631         <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> applyTemplatesSig = classGen.<a href="../S/6130.html#L123" title="Defined at 123 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">getApplyTemplatesSig</a>();
<a id="L632" name="L632"></a> 632         <strong class="reserved">final</strong> <strong class="reserved">int</strong> git = cpg.<a href="../D/10875.html" title="Multiple defined in 2 places.">addInterfaceMethodref</a>(DOM_INTF,
<a id="L633" name="L633"></a> 633                                                   GET_CHILDREN,
<a id="L634" name="L634"></a> 634                                                   GET_CHILDREN_SIG);
<a id="L635" name="L635"></a> 635         <strong class="reserved">final</strong> <strong class="reserved">int</strong> applyTemplates = cpg.<a href="../D/10937.html" title="Multiple defined in 2 places.">addMethodref</a>(<a href="../D/17698.html" title="Multiple defined in 41 places.">getClassName</a>(),
<a id="L636" name="L636"></a> 636                                                     <a href="../D/16620.html" title="Multiple defined in 2 places.">functionName</a>(),
<a id="L637" name="L637"></a> 637                                                     applyTemplatesSig);
<a id="L638" name="L638"></a> 638         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(classGen.<a href="../D/26993.html" title="Multiple defined in 4 places.">loadTranslet</a>());
<a id="L639" name="L639"></a> 639         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26912.html" title="Multiple defined in 4 places.">loadDOM</a>());
<a id="L640" name="L640"></a> 640 
<a id="L641" name="L641"></a> 641         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26912.html" title="Multiple defined in 4 places.">loadDOM</a>());
<a id="L642" name="L642"></a> 642         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>(_currentIndex));
<a id="L643" name="L643"></a> 643         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4624.html#L73" title="Defined at 73 in src/com/sun/org/apache/bcel/internal/generic/INVOKEINTERFACE.java.">INVOKEINTERFACE</a>(git, 2));
<a id="L644" name="L644"></a> 644         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26931.html" title="Multiple defined in 2 places.">loadHandler</a>());
<a id="L645" name="L645"></a> 645         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4737.html#L70" title="Defined at 70 in src/com/sun/org/apache/bcel/internal/generic/INVOKEVIRTUAL.java.">INVOKEVIRTUAL</a>(applyTemplates));
<a id="L646" name="L646"></a> 646         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4668.html#L68" title="Defined at 68 in src/com/sun/org/apache/bcel/internal/generic/GOTO_W.java.">GOTO_W</a>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>));
<a id="L647" name="L647"></a> 647         <strong class="reserved">return</strong> il;
<a id="L648" name="L648"></a> 648     <em class="brace">}</em>
<a id="L649" name="L649"></a> 649 
<div class="comment">
      Compiles the default action for DOM text nodes and attribute nodes:
      output the node's text value</div>
<a id="L654" name="L654"></a> 654     <strong class="reserved">private</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> <a href="../R/11741.html" title="Multiple referred from 2 places.">compileDefaultText</a>(<a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen,
<a id="L655" name="L655"></a> 655                                                <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen,
<a id="L656" name="L656"></a> 656                                                <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L657" name="L657"></a> 657         <strong class="reserved">final</strong> <a href="../S/4764.html#L78" title="Defined at 78 in src/com/sun/org/apache/bcel/internal/generic/ConstantPoolGen.java.">ConstantPoolGen</a> cpg = classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>();
<a id="L658" name="L658"></a> 658         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> il = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L659" name="L659"></a> 659 
<a id="L660" name="L660"></a> 660         <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a> = cpg.<a href="../D/10875.html" title="Multiple defined in 2 places.">addInterfaceMethodref</a>(DOM_INTF,
<a id="L661" name="L661"></a> 661                                                     CHARACTERS,
<a id="L662" name="L662"></a> 662                                                     CHARACTERS_SIG);
<a id="L663" name="L663"></a> 663         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26912.html" title="Multiple defined in 4 places.">loadDOM</a>());
<a id="L664" name="L664"></a> 664         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>(_currentIndex));
<a id="L665" name="L665"></a> 665         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26931.html" title="Multiple defined in 2 places.">loadHandler</a>());
<a id="L666" name="L666"></a> 666         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4624.html#L73" title="Defined at 73 in src/com/sun/org/apache/bcel/internal/generic/INVOKEINTERFACE.java.">INVOKEINTERFACE</a>(<a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, 3));
<a id="L667" name="L667"></a> 667         il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4668.html#L68" title="Defined at 68 in src/com/sun/org/apache/bcel/internal/generic/GOTO_W.java.">GOTO_W</a>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>));
<a id="L668" name="L668"></a> 668         <strong class="reserved">return</strong> il;
<a id="L669" name="L669"></a> 669     <em class="brace">}</em>
<a id="L670" name="L670"></a> 670 
<a id="L671" name="L671"></a> 671     <strong class="reserved">private</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> <a href="../R/11751.html" title="Multiple referred from 4 places.">compileNamespaces</a>(<a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen,
<a id="L672" name="L672"></a> 672                                               <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen,
<a id="L673" name="L673"></a> 673                                               <strong class="reserved">boolean</strong>[] <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>,
<a id="L674" name="L674"></a> 674                                               <strong class="reserved">boolean</strong>[] <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>,
<a id="L675" name="L675"></a> 675                                               <strong class="reserved">boolean</strong> attrFlag,
<a id="L676" name="L676"></a> 676                                               <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> defaultTarget) <em class="brace">{</em>
<a id="L677" name="L677"></a> 677         <strong class="reserved">final</strong> <a href="../S/6196.html#L66" title="Defined at 66 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/XSLTC.java.">XSLTC</a> xsltc = classGen.<a href="../D/21413.html" title="Multiple defined in 8 places.">getParser</a>().<a href="../D/23784.html" title="Multiple defined in 2 places.">getXSLTC</a>();
<a id="L678" name="L678"></a> 678         <strong class="reserved">final</strong> <a href="../S/4764.html#L78" title="Defined at 78 in src/com/sun/org/apache/bcel/internal/generic/ConstantPoolGen.java.">ConstantPoolGen</a> cpg = classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>();
<a id="L679" name="L679"></a> 679 
<a id="L680" name="L680"></a> 680         <em class="comment">// Append switch() statement - namespace test dispatch loop</em>
<a id="L681" name="L681"></a> 681         <strong class="reserved">final</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> namespaces = xsltc.<a href="../S/6196.html#L866" title="Defined at 866 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/XSLTC.java.">getNamespaceIndex</a>();
<a id="L682" name="L682"></a> 682         <strong class="reserved">final</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> names = xsltc.<a href="../S/6196.html#L862" title="Defined at 862 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/XSLTC.java.">getNamesIndex</a>();
<a id="L683" name="L683"></a> 683         <strong class="reserved">final</strong> <strong class="reserved">int</strong> namespaceCount = namespaces.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() + 1;
<a id="L684" name="L684"></a> 684         <strong class="reserved">final</strong> <strong class="reserved">int</strong> namesCount = names.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L685" name="L685"></a> 685 
<a id="L686" name="L686"></a> 686         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> il = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L687" name="L687"></a> 687         <strong class="reserved">final</strong> <strong class="reserved">int</strong>[] types = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[namespaceCount];
<a id="L688" name="L688"></a> 688         <strong class="reserved">final</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[] targets = <strong class="reserved">new</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L689" name="L689"></a> 689 
<a id="L690" name="L690"></a> 690         <strong class="reserved">if</strong> (namespaceCount &gt; 0) <em class="brace">{</em>
<a id="L691" name="L691"></a> 691             <strong class="reserved">boolean</strong> compiled = <strong class="reserved">false</strong>;
<a id="L692" name="L692"></a> 692 
<a id="L693" name="L693"></a> 693             <em class="comment">// Initialize targets for namespace() switch statement</em>
<a id="L694" name="L694"></a> 694             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; namespaceCount; i++) <em class="brace">{</em>
<a id="L695" name="L695"></a> 695                 targets[i] = defaultTarget;
<a id="L696" name="L696"></a> 696                 types[i] = i;
<a id="L697" name="L697"></a> 697             <em class="brace">}</em>
<a id="L698" name="L698"></a> 698 
<a id="L699" name="L699"></a> 699             <em class="comment">// Add test sequences for known namespace types</em>
<a id="L700" name="L700"></a> 700             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES; i &lt; (<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES+namesCount); i++) <em class="brace">{</em>
<a id="L701" name="L701"></a> 701                 <strong class="reserved">if</strong> ((<a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>[i]) &amp;&amp; (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i] == attrFlag)) <em class="brace">{</em>
<a id="L702" name="L702"></a> 702                     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)names.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i-<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES);
<a id="L703" name="L703"></a> 703                     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a> = <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0,<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.<a href="../D/26748.html" title="Multiple defined in 44 places.">lastIndexOf</a>(':'));
<a id="L704" name="L704"></a> 704                     <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/35749.html" title="Multiple defined in 239 places.">type</a> = xsltc.<a href="../D/30568.html" title="Multiple defined in 2 places.">registerNamespace</a>(<a href="../D/27870.html" title="Multiple defined in 10 places.">namespace</a>);
<a id="L705" name="L705"></a> 705 
<a id="L706" name="L706"></a> 706                     <strong class="reserved">if</strong> ((i &lt; _testSeq.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) &amp;&amp;
<a id="L707" name="L707"></a> 707                         (_testSeq[i] != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L708" name="L708"></a> 708                         targets[<a href="../D/35749.html" title="Multiple defined in 239 places.">type</a>] =
<a id="L709" name="L709"></a> 709                             (_testSeq[i]).<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen,
<a id="L710" name="L710"></a> 710                                                        methodGen,
<a id="L711" name="L711"></a> 711                                                        defaultTarget);
<a id="L712" name="L712"></a> 712                         compiled = <strong class="reserved">true</strong>;
<a id="L713" name="L713"></a> 713                     <em class="brace">}</em>
<a id="L714" name="L714"></a> 714                 <em class="brace">}</em>
<a id="L715" name="L715"></a> 715             <em class="brace">}</em>
<a id="L716" name="L716"></a> 716 
<a id="L717" name="L717"></a> 717             <em class="comment">// Return "null" if no test sequences were compiled</em>
<a id="L718" name="L718"></a> 718             <strong class="reserved">if</strong> (!compiled) <strong class="reserved">return</strong>(<strong class="reserved">null</strong>);
<a id="L719" name="L719"></a> 719 
<a id="L720" name="L720"></a> 720             <em class="comment">// Append first code in applyTemplates() - get type of current node</em>
<a id="L721" name="L721"></a> 721             <strong class="reserved">final</strong> <strong class="reserved">int</strong> getNS = cpg.<a href="../D/10875.html" title="Multiple defined in 2 places.">addInterfaceMethodref</a>(DOM_INTF,
<a id="L722" name="L722"></a> 722                                                         "getNamespaceType",
<a id="L723" name="L723"></a> 723                                                         "(I)I");
<a id="L724" name="L724"></a> 724             il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26912.html" title="Multiple defined in 4 places.">loadDOM</a>());
<a id="L725" name="L725"></a> 725             il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>(_currentIndex));
<a id="L726" name="L726"></a> 726             il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4624.html#L73" title="Defined at 73 in src/com/sun/org/apache/bcel/internal/generic/INVOKEINTERFACE.java.">INVOKEINTERFACE</a>(getNS, 2));
<a id="L727" name="L727"></a> 727             il.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../D/7577.html" title="Multiple defined in 2 places.">SWITCH</a>(types, targets, defaultTarget));
<a id="L728" name="L728"></a> 728             <strong class="reserved">return</strong>(il);
<a id="L729" name="L729"></a> 729         <em class="brace">}</em>
<a id="L730" name="L730"></a> 730         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L731" name="L731"></a> 731             <strong class="reserved">return</strong>(<strong class="reserved">null</strong>);
<a id="L732" name="L732"></a> 732         <em class="brace">}</em>
<a id="L733" name="L733"></a> 733     <em class="brace">}</em>
<a id="L734" name="L734"></a> 734 
<div class="comment">
      Compiles the applyTemplates() method and adds it to the translet.
      This is the main dispatch method.</div>
<a id="L739" name="L739"></a> 739     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11736.html" title="Multiple referred from 2 places.">compileApplyTemplates</a>(<a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen) <em class="brace">{</em>
<a id="L740" name="L740"></a> 740         <strong class="reserved">final</strong> <a href="../S/6196.html#L66" title="Defined at 66 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/XSLTC.java.">XSLTC</a> xsltc = classGen.<a href="../D/21413.html" title="Multiple defined in 8 places.">getParser</a>().<a href="../D/23784.html" title="Multiple defined in 2 places.">getXSLTC</a>();
<a id="L741" name="L741"></a> 741         <strong class="reserved">final</strong> <a href="../S/4764.html#L78" title="Defined at 78 in src/com/sun/org/apache/bcel/internal/generic/ConstantPoolGen.java.">ConstantPoolGen</a> cpg = classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>();
<a id="L742" name="L742"></a> 742         <strong class="reserved">final</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> names = xsltc.<a href="../S/6196.html#L862" title="Defined at 862 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/XSLTC.java.">getNamesIndex</a>();
<a id="L743" name="L743"></a> 743 
<a id="L744" name="L744"></a> 744         <em class="comment">// Create the applyTemplates() method</em>
<a id="L745" name="L745"></a> 745         <strong class="reserved">final</strong> com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>[] argTypes =
<a id="L746" name="L746"></a> 746             <strong class="reserved">new</strong> com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>[3];
<a id="L747" name="L747"></a> 747         argTypes[0] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(DOM_INTF_SIG);
<a id="L748" name="L748"></a> 748         argTypes[1] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(NODE_ITERATOR_SIG);
<a id="L749" name="L749"></a> 749         argTypes[2] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(TRANSLET_OUTPUT_SIG);
<a id="L750" name="L750"></a> 750 
<a id="L751" name="L751"></a> 751         <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] argNames = <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[3];
<a id="L752" name="L752"></a> 752         argNames[0] = DOCUMENT_PNAME;
<a id="L753" name="L753"></a> 753         argNames[1] = ITERATOR_PNAME;
<a id="L754" name="L754"></a> 754         argNames[2] = TRANSLET_OUTPUT_PNAME;
<a id="L755" name="L755"></a> 755 
<a id="L756" name="L756"></a> 756         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> mainIL = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L757" name="L757"></a> 757         <strong class="reserved">final</strong> <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen =
<a id="L758" name="L758"></a> 758             <strong class="reserved">new</strong> <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a>(ACC_PUBLIC | ACC_FINAL,
<a id="L759" name="L759"></a> 759                                 com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>.VOID,
<a id="L760" name="L760"></a> 760                                 argTypes, argNames, <a href="../D/16620.html" title="Multiple defined in 2 places.">functionName</a>(),
<a id="L761" name="L761"></a> 761                                 <a href="../D/17698.html" title="Multiple defined in 41 places.">getClassName</a>(), mainIL,
<a id="L762" name="L762"></a> 762                                 classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>());
<a id="L763" name="L763"></a> 763         methodGen.<a href="../S/4802.html#L633" title="Defined at 633 in src/com/sun/org/apache/bcel/internal/generic/MethodGen.java.">addException</a>("com.sun.org.apache.xalan.internal.xsltc.TransletException");
<a id="L764" name="L764"></a> 764         <em class="comment">// Insert an extra NOP just to keep "current" from appearing as if it</em>
<a id="L765" name="L765"></a> 765         <em class="comment">// has a value before the start of the loop.</em>
<a id="L766" name="L766"></a> 766         mainIL.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/4691.html#L66" title="Defined at 66 in src/com/sun/org/apache/bcel/internal/generic/NOP.java.">NOP</a>);
<a id="L767" name="L767"></a> 767 
<a id="L768" name="L768"></a> 768 
<a id="L769" name="L769"></a> 769         <em class="comment">// Create a local variable to hold the current node</em>
<a id="L770" name="L770"></a> 770         <strong class="reserved">final</strong> <a href="../S/4694.html#L75" title="Defined at 75 in src/com/sun/org/apache/bcel/internal/generic/LocalVariableGen.java.">LocalVariableGen</a> <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>;
<a id="L771" name="L771"></a> 771         <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a> = methodGen.<a href="../S/6132.html#L239" title="Defined at 239 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">addLocalVariable2</a>("current",
<a id="L772" name="L772"></a> 772                                               com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>.INT,
<a id="L773" name="L773"></a> 773                                               <strong class="reserved">null</strong>);
<a id="L774" name="L774"></a> 774         _currentIndex = <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>();
<a id="L775" name="L775"></a> 775 
<a id="L776" name="L776"></a> 776         <em class="comment">// Create the "body" instruction list that will eventually hold the</em>
<a id="L777" name="L777"></a> 777         <em class="comment">// code for the entire method (other ILs will be appended).</em>
<a id="L778" name="L778"></a> 778         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> body = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L779" name="L779"></a> 779         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/4691.html#L66" title="Defined at 66 in src/com/sun/org/apache/bcel/internal/generic/NOP.java.">NOP</a>);
<a id="L780" name="L780"></a> 780 
<a id="L781" name="L781"></a> 781         <em class="comment">// Create an instruction list that contains the default next-node</em>
<a id="L782" name="L782"></a> 782         <em class="comment">// iteration</em>
<a id="L783" name="L783"></a> 783         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> ilLoop = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L784" name="L784"></a> 784         ilLoop.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26944.html" title="Multiple defined in 3 places.">loadIterator</a>());
<a id="L785" name="L785"></a> 785         ilLoop.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>());
<a id="L786" name="L786"></a> 786         ilLoop.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/2160.html" title="Multiple defined in 3 places.">DUP</a>);
<a id="L787" name="L787"></a> 787         ilLoop.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4787.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ISTORE.java.">ISTORE</a>(_currentIndex));
<a id="L788" name="L788"></a> 788 
<a id="L789" name="L789"></a> 789         <em class="comment">// The body of this code can get very large - large than can be handled</em>
<a id="L790" name="L790"></a> 790         <em class="comment">// by a single IFNE(body.getStart()) instruction - need workaround:</em>
<a id="L791" name="L791"></a> 791         <strong class="reserved">final</strong> <a href="../S/4742.html#L72" title="Defined at 72 in src/com/sun/org/apache/bcel/internal/generic/BranchHandle.java.">BranchHandle</a> ifeq = ilLoop.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4649.html#L68" title="Defined at 68 in src/com/sun/org/apache/bcel/internal/generic/IFLT.java.">IFLT</a>(<strong class="reserved">null</strong>));
<a id="L792" name="L792"></a> 792         <strong class="reserved">final</strong> <a href="../S/4742.html#L72" title="Defined at 72 in src/com/sun/org/apache/bcel/internal/generic/BranchHandle.java.">BranchHandle</a> <a href="../D/27168.html" title="Multiple defined in 2 places.">loop</a> = ilLoop.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4668.html#L68" title="Defined at 68 in src/com/sun/org/apache/bcel/internal/generic/GOTO_W.java.">GOTO_W</a>(<strong class="reserved">null</strong>));
<a id="L793" name="L793"></a> 793         ifeq.<a href="../D/34078.html" title="Multiple defined in 20 places.">setTarget</a>(ilLoop.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/7024.html" title="Multiple defined in 4 places.">RETURN</a>));  <em class="comment">// applyTemplates() ends here!</em>
<a id="L794" name="L794"></a> 794         <strong class="reserved">final</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihLoop = ilLoop.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L795" name="L795"></a> 795 
<a id="L796" name="L796"></a> 796         <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>.<a href="../D/33997.html" title="Multiple defined in 5 places.">setStart</a>(mainIL.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4668.html#L68" title="Defined at 68 in src/com/sun/org/apache/bcel/internal/generic/GOTO_W.java.">GOTO_W</a>(ihLoop)));
<a id="L797" name="L797"></a> 797 
<a id="L798" name="L798"></a> 798         <em class="comment">// Live range of "current" ends at end of loop</em>
<a id="L799" name="L799"></a> 799         <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>.<a href="../D/32584.html" title="Multiple defined in 5 places.">setEnd</a>(<a href="../D/27168.html" title="Multiple defined in 2 places.">loop</a>);
<a id="L800" name="L800"></a> 800 
<a id="L801" name="L801"></a> 801         <em class="comment">// Compile default handling of elements (traverse children)</em>
<a id="L802" name="L802"></a> 802         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> ilRecurse =
<a id="L803" name="L803"></a> 803             <a href="../S/6149.html#L626" title="Defined at 626 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileDefaultRecursion</a>(classGen, methodGen, ihLoop);
<a id="L804" name="L804"></a> 804         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihRecurse = ilRecurse.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L805" name="L805"></a> 805 
<a id="L806" name="L806"></a> 806         <em class="comment">// Compile default handling of text/attribute nodes (output text)</em>
<a id="L807" name="L807"></a> 807         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> ilText =
<a id="L808" name="L808"></a> 808             <a href="../S/6149.html#L654" title="Defined at 654 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileDefaultText</a>(classGen, methodGen, ihLoop);
<a id="L809" name="L809"></a> 809         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihText = ilText.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L810" name="L810"></a> 810 
<a id="L811" name="L811"></a> 811         <em class="comment">// Distinguish attribute/element/namespace tests for further processing</em>
<a id="L812" name="L812"></a> 812         <strong class="reserved">final</strong> <strong class="reserved">int</strong>[] types = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES + names.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()];
<a id="L813" name="L813"></a> 813         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L814" name="L814"></a> 814             types[i] = i;
<a id="L815" name="L815"></a> 815         <em class="brace">}</em>
<a id="L816" name="L816"></a> 816 
<a id="L817" name="L817"></a> 817         <em class="comment">// Initialize isAttribute[] and isNamespace[] arrays</em>
<a id="L818" name="L818"></a> 818         <strong class="reserved">final</strong> <strong class="reserved">boolean</strong>[] <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a> = <strong class="reserved">new</strong> <strong class="reserved">boolean</strong>[types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L819" name="L819"></a> 819         <strong class="reserved">final</strong> <strong class="reserved">boolean</strong>[] <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a> = <strong class="reserved">new</strong> <strong class="reserved">boolean</strong>[types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L820" name="L820"></a> 820         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; names.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>(); i++) <em class="brace">{</em>
<a id="L821" name="L821"></a> 821             <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)names.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L822" name="L822"></a> 822             <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i + <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES] = <a href="../S/6149.html#L1512" title="Defined at 1512 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">isAttributeName</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L823" name="L823"></a> 823             <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>[i + <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES] = <a href="../S/6149.html#L1521" title="Defined at 1521 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">isNamespaceName</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L824" name="L824"></a> 824         <em class="brace">}</em>
<a id="L825" name="L825"></a> 825 
<a id="L826" name="L826"></a> 826         <em class="comment">// Compile all templates - regardless of pattern type</em>
<a id="L827" name="L827"></a> 827         <a href="../S/6149.html#L559" title="Defined at 559 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileTemplates</a>(classGen, methodGen, ihLoop);
<a id="L828" name="L828"></a> 828 
<a id="L829" name="L829"></a> 829         <em class="comment">// Handle template with explicit "*" pattern</em>
<a id="L830" name="L830"></a> 830         <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> elemTest = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE];
<a id="L831" name="L831"></a> 831         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihElem = ihRecurse;
<a id="L832" name="L832"></a> 832         <strong class="reserved">if</strong> (elemTest != <strong class="reserved">null</strong>)
<a id="L833" name="L833"></a> 833             ihElem = elemTest.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihRecurse);
<a id="L834" name="L834"></a> 834 
<a id="L835" name="L835"></a> 835         <em class="comment">// Handle template with explicit "@*" pattern</em>
<a id="L836" name="L836"></a> 836         <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> attrTest = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE];
<a id="L837" name="L837"></a> 837         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihAttr = ihText;
<a id="L838" name="L838"></a> 838         <strong class="reserved">if</strong> (attrTest != <strong class="reserved">null</strong>)
<a id="L839" name="L839"></a> 839             ihAttr = attrTest.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihAttr);
<a id="L840" name="L840"></a> 840 
<a id="L841" name="L841"></a> 841         <em class="comment">// Do tests for id() and key() patterns first</em>
<a id="L842" name="L842"></a> 842         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> ilKey = <strong class="reserved">null</strong>;
<a id="L843" name="L843"></a> 843         <strong class="reserved">if</strong> (_idxTestSeq != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L844" name="L844"></a> 844             <a href="../D/27168.html" title="Multiple defined in 2 places.">loop</a>.<a href="../D/34078.html" title="Multiple defined in 20 places.">setTarget</a>(_idxTestSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, body.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>()));
<a id="L845" name="L845"></a> 845             ilKey = _idxTestSeq.<a href="../D/19776.html" title="Multiple defined in 7 places.">getInstructionList</a>();
<a id="L846" name="L846"></a> 846         <em class="brace">}</em>
<a id="L847" name="L847"></a> 847         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L848" name="L848"></a> 848             <a href="../D/27168.html" title="Multiple defined in 2 places.">loop</a>.<a href="../D/34078.html" title="Multiple defined in 20 places.">setTarget</a>(body.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>());
<a id="L849" name="L849"></a> 849         <em class="brace">}</em>
<a id="L850" name="L850"></a> 850 
<a id="L851" name="L851"></a> 851         <em class="comment">// If there is a match on node() we need to replace ihElem</em>
<a id="L852" name="L852"></a> 852         <em class="comment">// and ihText if the priority of node() is higher</em>
<a id="L853" name="L853"></a> 853         <strong class="reserved">if</strong> (_childNodeTestSeq != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L854" name="L854"></a> 854             <em class="comment">// Compare priorities of node() and "*"</em>
<a id="L855" name="L855"></a> 855             <strong class="reserved">double</strong> nodePrio = _childNodeTestSeq.<a href="../D/21675.html" title="Multiple defined in 8 places.">getPriority</a>();
<a id="L856" name="L856"></a> 856             <strong class="reserved">int</strong>    nodePos  = _childNodeTestSeq.<a href="../D/21546.html" title="Multiple defined in 41 places.">getPosition</a>();
<a id="L857" name="L857"></a> 857             <strong class="reserved">double</strong> elemPrio = (0 - <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.MAX_VALUE);
<a id="L858" name="L858"></a> 858             <strong class="reserved">int</strong>    elemPos  = <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MIN_VALUE;
<a id="L859" name="L859"></a> 859 
<a id="L860" name="L860"></a> 860             <strong class="reserved">if</strong> (elemTest != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L861" name="L861"></a> 861                 elemPrio = elemTest.<a href="../D/21675.html" title="Multiple defined in 8 places.">getPriority</a>();
<a id="L862" name="L862"></a> 862                 elemPos  = elemTest.<a href="../D/21546.html" title="Multiple defined in 41 places.">getPosition</a>();
<a id="L863" name="L863"></a> 863             <em class="brace">}</em>
<a id="L864" name="L864"></a> 864             <strong class="reserved">if</strong> (elemPrio == <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NaN || elemPrio &lt; nodePrio ||
<a id="L865" name="L865"></a> 865                 (elemPrio == nodePrio &amp;&amp; elemPos &lt; nodePos))
<a id="L866" name="L866"></a> 866             <em class="brace">{</em>
<a id="L867" name="L867"></a> 867                 ihElem = _childNodeTestSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihLoop);
<a id="L868" name="L868"></a> 868             <em class="brace">}</em>
<a id="L869" name="L869"></a> 869 
<a id="L870" name="L870"></a> 870             <em class="comment">// Compare priorities of node() and text()</em>
<a id="L871" name="L871"></a> 871             <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> textTest = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE];
<a id="L872" name="L872"></a> 872             <strong class="reserved">double</strong> textPrio = (0 - <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.MAX_VALUE);
<a id="L873" name="L873"></a> 873             <strong class="reserved">int</strong>    textPos  = <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MIN_VALUE;
<a id="L874" name="L874"></a> 874 
<a id="L875" name="L875"></a> 875             <strong class="reserved">if</strong> (textTest != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L876" name="L876"></a> 876                 textPrio = textTest.<a href="../D/21675.html" title="Multiple defined in 8 places.">getPriority</a>();
<a id="L877" name="L877"></a> 877                 textPos  = textTest.<a href="../D/21546.html" title="Multiple defined in 41 places.">getPosition</a>();
<a id="L878" name="L878"></a> 878             <em class="brace">}</em>
<a id="L879" name="L879"></a> 879             <strong class="reserved">if</strong> (textPrio == <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NaN || textPrio &lt; nodePrio ||
<a id="L880" name="L880"></a> 880                 (textPrio == nodePrio &amp;&amp; textPos &lt; nodePos))
<a id="L881" name="L881"></a> 881             <em class="brace">{</em>
<a id="L882" name="L882"></a> 882                 ihText = _childNodeTestSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihLoop);
<a id="L883" name="L883"></a> 883                 _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE] = _childNodeTestSeq;
<a id="L884" name="L884"></a> 884             <em class="brace">}</em>
<a id="L885" name="L885"></a> 885         <em class="brace">}</em>
<a id="L886" name="L886"></a> 886 
<a id="L887" name="L887"></a> 887         <em class="comment">// Handle templates with "ns:*" pattern</em>
<a id="L888" name="L888"></a> 888         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> elemNamespaceHandle = ihElem;
<a id="L889" name="L889"></a> 889         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> nsElem = <a href="../S/6149.html#L671" title="Defined at 671 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileNamespaces</a>(classGen, methodGen,
<a id="L890" name="L890"></a> 890                                                    <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>, <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>,
<a id="L891" name="L891"></a> 891                                                    <strong class="reserved">false</strong>, ihElem);
<a id="L892" name="L892"></a> 892         <strong class="reserved">if</strong> (nsElem != <strong class="reserved">null</strong>) elemNamespaceHandle = nsElem.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L893" name="L893"></a> 893 
<a id="L894" name="L894"></a> 894         <em class="comment">// Handle templates with "ns:@*" pattern</em>
<a id="L895" name="L895"></a> 895         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> attrNamespaceHandle = ihAttr;
<a id="L896" name="L896"></a> 896         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> nsAttr = <a href="../S/6149.html#L671" title="Defined at 671 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileNamespaces</a>(classGen, methodGen,
<a id="L897" name="L897"></a> 897                                                    <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>, <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>,
<a id="L898" name="L898"></a> 898                                                    <strong class="reserved">true</strong>, ihAttr);
<a id="L899" name="L899"></a> 899         <strong class="reserved">if</strong> (nsAttr != <strong class="reserved">null</strong>) attrNamespaceHandle = nsAttr.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L900" name="L900"></a> 900 
<a id="L901" name="L901"></a> 901         <em class="comment">// Handle templates with "ns:elem" or "ns:@attr" pattern</em>
<a id="L902" name="L902"></a> 902         <strong class="reserved">final</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[] targets = <strong class="reserved">new</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L903" name="L903"></a> 903         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES; i &lt; targets.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L904" name="L904"></a> 904             <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> testSeq = _testSeq[i];
<a id="L905" name="L905"></a> 905             <em class="comment">// Jump straight to namespace tests ?</em>
<a id="L906" name="L906"></a> 906             <strong class="reserved">if</strong> (<a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>[i]) <em class="brace">{</em>
<a id="L907" name="L907"></a> 907                 <strong class="reserved">if</strong> (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i])
<a id="L908" name="L908"></a> 908                     targets[i] = attrNamespaceHandle;
<a id="L909" name="L909"></a> 909                 <strong class="reserved">else</strong>
<a id="L910" name="L910"></a> 910                     targets[i] = elemNamespaceHandle;
<a id="L911" name="L911"></a> 911             <em class="brace">}</em>
<a id="L912" name="L912"></a> 912             <em class="comment">// Test first, then jump to namespace tests</em>
<a id="L913" name="L913"></a> 913             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (testSeq != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L914" name="L914"></a> 914                 <strong class="reserved">if</strong> (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i])
<a id="L915" name="L915"></a> 915                     targets[i] = testSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen,
<a id="L916" name="L916"></a> 916                                                  attrNamespaceHandle);
<a id="L917" name="L917"></a> 917                 <strong class="reserved">else</strong>
<a id="L918" name="L918"></a> 918                     targets[i] = testSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen,
<a id="L919" name="L919"></a> 919                                                  elemNamespaceHandle);
<a id="L920" name="L920"></a> 920             <em class="brace">}</em>
<a id="L921" name="L921"></a> 921             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L922" name="L922"></a> 922                 targets[i] = ihLoop;
<a id="L923" name="L923"></a> 923             <em class="brace">}</em>
<a id="L924" name="L924"></a> 924         <em class="brace">}</em>
<a id="L925" name="L925"></a> 925 
<a id="L926" name="L926"></a> 926 
<a id="L927" name="L927"></a> 927         <em class="comment">// Handle pattern with match on root node - default: traverse children</em>
<a id="L928" name="L928"></a> 928         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ROOT_NODE] = _rootPattern != <strong class="reserved">null</strong>
<a id="L929" name="L929"></a> 929             ? <a href="../S/6149.html#L1505" title="Defined at 1505 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">getTemplateInstructionHandle</a>(_rootPattern.<a href="../D/23029.html" title="Multiple defined in 5 places.">getTemplate</a>())
<a id="L930" name="L930"></a> 930             : ihRecurse;
<a id="L931" name="L931"></a> 931 
<a id="L932" name="L932"></a> 932         <em class="comment">// Handle pattern with match on root node - default: traverse children</em>
<a id="L933" name="L933"></a> 933         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.DOCUMENT_NODE] = _rootPattern != <strong class="reserved">null</strong>
<a id="L934" name="L934"></a> 934             ? <a href="../S/6149.html#L1505" title="Defined at 1505 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">getTemplateInstructionHandle</a>(_rootPattern.<a href="../D/23029.html" title="Multiple defined in 5 places.">getTemplate</a>())
<a id="L935" name="L935"></a> 935             : ihRecurse;
<a id="L936" name="L936"></a> 936 
<a id="L937" name="L937"></a> 937         <em class="comment">// Handle any pattern with match on text nodes - default: output text</em>
<a id="L938" name="L938"></a> 938         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE] = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE] != <strong class="reserved">null</strong>
<a id="L939" name="L939"></a> 939             ? _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE].<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihText)
<a id="L940" name="L940"></a> 940             : ihText;
<a id="L941" name="L941"></a> 941 
<a id="L942" name="L942"></a> 942         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L943" name="L943"></a> 943         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE] = ihLoop;
<a id="L944" name="L944"></a> 944 
<a id="L945" name="L945"></a> 945         <em class="comment">// Match unknown element in DOM - default: check for namespace match</em>
<a id="L946" name="L946"></a> 946         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE] = elemNamespaceHandle;
<a id="L947" name="L947"></a> 947 
<a id="L948" name="L948"></a> 948         <em class="comment">// Match unknown attribute in DOM - default: check for namespace match</em>
<a id="L949" name="L949"></a> 949         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE] = attrNamespaceHandle;
<a id="L950" name="L950"></a> 950 
<a id="L951" name="L951"></a> 951         <em class="comment">// Match on processing instruction - default: process next node</em>
<a id="L952" name="L952"></a> 952         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihPI = ihLoop;
<a id="L953" name="L953"></a> 953         <strong class="reserved">if</strong> (_childNodeTestSeq != <strong class="reserved">null</strong>) ihPI = ihElem;
<a id="L954" name="L954"></a> 954         <strong class="reserved">if</strong> (_testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE] != <strong class="reserved">null</strong>)
<a id="L955" name="L955"></a> 955             targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE] =
<a id="L956" name="L956"></a> 956                 _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE].
<a id="L957" name="L957"></a> 957                 <a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihPI);
<a id="L958" name="L958"></a> 958         <strong class="reserved">else</strong>
<a id="L959" name="L959"></a> 959             targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE] = ihPI;
<a id="L960" name="L960"></a> 960 
<a id="L961" name="L961"></a> 961         <em class="comment">// Match on comments - default: process next node</em>
<a id="L962" name="L962"></a> 962         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihComment = ihLoop;
<a id="L963" name="L963"></a> 963         <strong class="reserved">if</strong> (_childNodeTestSeq != <strong class="reserved">null</strong>) ihComment = ihElem;
<a id="L964" name="L964"></a> 964         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.COMMENT_NODE] = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.COMMENT_NODE] != <strong class="reserved">null</strong>
<a id="L965" name="L965"></a> 965             ? _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.COMMENT_NODE].<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihComment)
<a id="L966" name="L966"></a> 966             : ihComment;
<a id="L967" name="L967"></a> 967 
<a id="L968" name="L968"></a> 968             <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L969" name="L969"></a> 969         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.CDATA_SECTION_NODE] = ihLoop;
<a id="L970" name="L970"></a> 970 
<a id="L971" name="L971"></a> 971         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L972" name="L972"></a> 972         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.DOCUMENT_FRAGMENT_NODE] = ihLoop;
<a id="L973" name="L973"></a> 973 
<a id="L974" name="L974"></a> 974         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L975" name="L975"></a> 975         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.DOCUMENT_TYPE_NODE] = ihLoop;
<a id="L976" name="L976"></a> 976 
<a id="L977" name="L977"></a> 977         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L978" name="L978"></a> 978         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ENTITY_NODE] = ihLoop;
<a id="L979" name="L979"></a> 979 
<a id="L980" name="L980"></a> 980         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L981" name="L981"></a> 981         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ENTITY_REFERENCE_NODE] = ihLoop;
<a id="L982" name="L982"></a> 982 
<a id="L983" name="L983"></a> 983         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L984" name="L984"></a> 984         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NOTATION_NODE] = ihLoop;
<a id="L985" name="L985"></a> 985 
<a id="L986" name="L986"></a> 986 
<a id="L987" name="L987"></a> 987         <em class="comment">// Now compile test sequences for various match patterns:</em>
<a id="L988" name="L988"></a> 988         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES; i &lt; targets.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L989" name="L989"></a> 989             <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> testSeq = _testSeq[i];
<a id="L990" name="L990"></a> 990             <em class="comment">// Jump straight to namespace tests ?</em>
<a id="L991" name="L991"></a> 991             <strong class="reserved">if</strong> ((testSeq == <strong class="reserved">null</strong>) || (<a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>[i])) <em class="brace">{</em>
<a id="L992" name="L992"></a> 992                 <strong class="reserved">if</strong> (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i])
<a id="L993" name="L993"></a> 993                     targets[i] = attrNamespaceHandle;
<a id="L994" name="L994"></a> 994                 <strong class="reserved">else</strong>
<a id="L995" name="L995"></a> 995                     targets[i] = elemNamespaceHandle;
<a id="L996" name="L996"></a> 996             <em class="brace">}</em>
<a id="L997" name="L997"></a> 997             <em class="comment">// Match on node type</em>
<a id="L998" name="L998"></a> 998             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L999" name="L999"></a> 999                 <strong class="reserved">if</strong> (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i])
<a id="L1000" name="L1000"></a>1000                     targets[i] = testSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen,
<a id="L1001" name="L1001"></a>1001                                                  attrNamespaceHandle);
<a id="L1002" name="L1002"></a>1002                 <strong class="reserved">else</strong>
<a id="L1003" name="L1003"></a>1003                     targets[i] = testSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen,
<a id="L1004" name="L1004"></a>1004                                                  elemNamespaceHandle);
<a id="L1005" name="L1005"></a>1005             <em class="brace">}</em>
<a id="L1006" name="L1006"></a>1006         <em class="brace">}</em>
<a id="L1007" name="L1007"></a>1007 
<a id="L1008" name="L1008"></a>1008         <strong class="reserved">if</strong> (ilKey != <strong class="reserved">null</strong>) body.<a href="../D/24721.html" title="Multiple defined in 265 places.">insert</a>(ilKey);
<a id="L1009" name="L1009"></a>1009 
<a id="L1010" name="L1010"></a>1010         <em class="comment">// Append first code in applyTemplates() - get type of current node</em>
<a id="L1011" name="L1011"></a>1011         <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a> = cpg.<a href="../D/10875.html" title="Multiple defined in 2 places.">addInterfaceMethodref</a>(DOM_INTF,
<a id="L1012" name="L1012"></a>1012                                                       "getExpandedTypeID",
<a id="L1013" name="L1013"></a>1013                                                       "(I)I");
<a id="L1014" name="L1014"></a>1014         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26912.html" title="Multiple defined in 4 places.">loadDOM</a>());
<a id="L1015" name="L1015"></a>1015         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>(_currentIndex));
<a id="L1016" name="L1016"></a>1016         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4624.html#L73" title="Defined at 73 in src/com/sun/org/apache/bcel/internal/generic/INVOKEINTERFACE.java.">INVOKEINTERFACE</a>(<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>, 2));
<a id="L1017" name="L1017"></a>1017 
<a id="L1018" name="L1018"></a>1018         <em class="comment">// Append switch() statement - main dispatch loop in applyTemplates()</em>
<a id="L1019" name="L1019"></a>1019         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> disp = body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../D/7577.html" title="Multiple defined in 2 places.">SWITCH</a>(types, targets, ihLoop));
<a id="L1020" name="L1020"></a>1020 
<a id="L1021" name="L1021"></a>1021         <em class="comment">// Append all the "case:" statements</em>
<a id="L1022" name="L1022"></a>1022         <a href="../S/6149.html#L597" title="Defined at 597 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">appendTestSequences</a>(body);
<a id="L1023" name="L1023"></a>1023         <em class="comment">// Append the actual template code</em>
<a id="L1024" name="L1024"></a>1024         <a href="../S/6149.html#L586" title="Defined at 586 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">appendTemplateCode</a>(body);
<a id="L1025" name="L1025"></a>1025 
<a id="L1026" name="L1026"></a>1026         <em class="comment">// Append NS:* node tests (if any)</em>
<a id="L1027" name="L1027"></a>1027         <strong class="reserved">if</strong> (nsElem != <strong class="reserved">null</strong>) body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(nsElem);
<a id="L1028" name="L1028"></a>1028         <em class="comment">// Append NS:@* node tests (if any)</em>
<a id="L1029" name="L1029"></a>1029         <strong class="reserved">if</strong> (nsAttr != <strong class="reserved">null</strong>) body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(nsAttr);
<a id="L1030" name="L1030"></a>1030 
<a id="L1031" name="L1031"></a>1031         <em class="comment">// Append default action for element and root nodes</em>
<a id="L1032" name="L1032"></a>1032         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ilRecurse);
<a id="L1033" name="L1033"></a>1033         <em class="comment">// Append default action for text and attribute nodes</em>
<a id="L1034" name="L1034"></a>1034         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ilText);
<a id="L1035" name="L1035"></a>1035 
<a id="L1036" name="L1036"></a>1036         <em class="comment">// putting together constituent instruction lists</em>
<a id="L1037" name="L1037"></a>1037         mainIL.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(body);
<a id="L1038" name="L1038"></a>1038         <em class="comment">// fall through to ilLoop</em>
<a id="L1039" name="L1039"></a>1039         mainIL.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ilLoop);
<a id="L1040" name="L1040"></a>1040 
<a id="L1041" name="L1041"></a>1041         <a href="../D/29312.html" title="Multiple defined in 2 places.">peepHoleOptimization</a>(methodGen);
<a id="L1042" name="L1042"></a>1042         classGen.<a href="../D/10936.html" title="Multiple defined in 3 places.">addMethod</a>(methodGen);
<a id="L1043" name="L1043"></a>1043 
<a id="L1044" name="L1044"></a>1044         <em class="comment">// Compile method(s) for &lt;xsl:apply-imports/&gt; for this mode</em>
<a id="L1045" name="L1045"></a>1045         <strong class="reserved">if</strong> (_importLevels != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1046" name="L1046"></a>1046             <a href="../S/1134.html#L61" title="Defined at 61 in src/java/util/Enumeration.java.">Enumeration</a> levels = _importLevels.<a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>();
<a id="L1047" name="L1047"></a>1047             <strong class="reserved">while</strong> (levels.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>()) <em class="brace">{</em>
<a id="L1048" name="L1048"></a>1048                 <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a> <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a> = (<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>)levels.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>();
<a id="L1049" name="L1049"></a>1049                 <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a> <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a> = (<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>)_importLevels.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>);
<a id="L1050" name="L1050"></a>1050                 <a href="../S/6149.html#L1078" title="Defined at 1078 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileApplyImports</a>(classGen, <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>.<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>(), <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>.<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>());
<a id="L1051" name="L1051"></a>1051             <em class="brace">}</em>
<a id="L1052" name="L1052"></a>1052         <em class="brace">}</em>
<a id="L1053" name="L1053"></a>1053     <em class="brace">}</em>
<a id="L1054" name="L1054"></a>1054 
<a id="L1055" name="L1055"></a>1055     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6149.html#L1175" title="Referred from 1175 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileTemplateCalls</a>(<a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen,
<a id="L1056" name="L1056"></a>1056                                       <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen,
<a id="L1057" name="L1057"></a>1057                                       <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>, <strong class="reserved">int</strong> <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>, <strong class="reserved">int</strong> <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>)<em class="brace">{</em>
<a id="L1058" name="L1058"></a>1058         <a href="../S/1134.html#L61" title="Defined at 61 in src/java/util/Enumeration.java.">Enumeration</a> templates = _neededTemplates.<a href="../D/26726.html" title="Multiple defined in 22 places.">keys</a>();
<a id="L1059" name="L1059"></a>1059         <strong class="reserved">while</strong> (templates.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>()) <em class="brace">{</em>
<a id="L1060" name="L1060"></a>1060             <strong class="reserved">final</strong> <a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template = (<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a>)templates.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>();
<a id="L1061" name="L1061"></a>1061             <strong class="reserved">final</strong> <strong class="reserved">int</strong> prec = template.<a href="../D/19631.html" title="Multiple defined in 2 places.">getImportPrecedence</a>();
<a id="L1062" name="L1062"></a>1062             <strong class="reserved">if</strong> ((prec &gt;= <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>) &amp;&amp; (prec &lt; <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>)) <em class="brace">{</em>
<a id="L1063" name="L1063"></a>1063                 <strong class="reserved">if</strong> (template.<a href="../S/6076.html#L822" title="Defined at 822 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/SyntaxTreeNode.java.">hasContents</a>()) <em class="brace">{</em>
<a id="L1064" name="L1064"></a>1064                     <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> til = template.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen);
<a id="L1065" name="L1065"></a>1065                     til.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4668.html#L68" title="Defined at 68 in src/com/sun/org/apache/bcel/internal/generic/GOTO_W.java.">GOTO_W</a>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>));
<a id="L1066" name="L1066"></a>1066                     _templateILs.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(template, til);
<a id="L1067" name="L1067"></a>1067                     _templateIHs.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(template, til.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>());
<a id="L1068" name="L1068"></a>1068                 <em class="brace">}</em>
<a id="L1069" name="L1069"></a>1069                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1070" name="L1070"></a>1070                     <em class="comment">// empty template</em>
<a id="L1071" name="L1071"></a>1071                     _templateIHs.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(template, <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>);
<a id="L1072" name="L1072"></a>1072                 <em class="brace">}</em>
<a id="L1073" name="L1073"></a>1073             <em class="brace">}</em>
<a id="L1074" name="L1074"></a>1074         <em class="brace">}</em>
<a id="L1075" name="L1075"></a>1075     <em class="brace">}</em>
<a id="L1076" name="L1076"></a>1076 
<a id="L1077" name="L1077"></a>1077 
<a id="L1078" name="L1078"></a>1078     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/6149.html#L1050" title="Referred from 1050 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileApplyImports</a>(<a href="../S/6130.html#L50" title="Defined at 50 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/ClassGenerator.java.">ClassGenerator</a> classGen, <strong class="reserved">int</strong> <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>, <strong class="reserved">int</strong> <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>) <em class="brace">{</em>
<a id="L1079" name="L1079"></a>1079         <strong class="reserved">final</strong> <a href="../S/6196.html#L66" title="Defined at 66 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/XSLTC.java.">XSLTC</a> xsltc = classGen.<a href="../D/21413.html" title="Multiple defined in 8 places.">getParser</a>().<a href="../D/23784.html" title="Multiple defined in 2 places.">getXSLTC</a>();
<a id="L1080" name="L1080"></a>1080         <strong class="reserved">final</strong> <a href="../S/4764.html#L78" title="Defined at 78 in src/com/sun/org/apache/bcel/internal/generic/ConstantPoolGen.java.">ConstantPoolGen</a> cpg = classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>();
<a id="L1081" name="L1081"></a>1081         <strong class="reserved">final</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> names      = xsltc.<a href="../S/6196.html#L862" title="Defined at 862 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/XSLTC.java.">getNamesIndex</a>();
<a id="L1082" name="L1082"></a>1082 
<a id="L1083" name="L1083"></a>1083         <em class="comment">// Clear some datastructures</em>
<a id="L1084" name="L1084"></a>1084         _namedTemplates = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L1085" name="L1085"></a>1085         _neededTemplates = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L1086" name="L1086"></a>1086         _templateIHs = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L1087" name="L1087"></a>1087         _templateILs = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>();
<a id="L1088" name="L1088"></a>1088         _patternGroups = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>[32];
<a id="L1089" name="L1089"></a>1089         _rootPattern = <strong class="reserved">null</strong>;
<a id="L1090" name="L1090"></a>1090 
<a id="L1091" name="L1091"></a>1091         <em class="comment">// IMPORTANT: Save orignal &amp; complete set of templates!!!!</em>
<a id="L1092" name="L1092"></a>1092         <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> oldTemplates = _templates;
<a id="L1093" name="L1093"></a>1093 
<a id="L1094" name="L1094"></a>1094         <em class="comment">// Gather templates that are within the scope of this import</em>
<a id="L1095" name="L1095"></a>1095         _templates = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>();
<a id="L1096" name="L1096"></a>1096         <strong class="reserved">final</strong> <a href="../S/1134.html#L61" title="Defined at 61 in src/java/util/Enumeration.java.">Enumeration</a> templates = oldTemplates.<a href="../D/15313.html" title="Multiple defined in 25 places.">elements</a>();
<a id="L1097" name="L1097"></a>1097         <strong class="reserved">while</strong> (templates.<a href="../D/24128.html" title="Multiple defined in 32 places.">hasMoreElements</a>()) <em class="brace">{</em>
<a id="L1098" name="L1098"></a>1098             <strong class="reserved">final</strong> <a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template = (<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a>)templates.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>();
<a id="L1099" name="L1099"></a>1099             <strong class="reserved">final</strong> <strong class="reserved">int</strong> prec = template.<a href="../D/19631.html" title="Multiple defined in 2 places.">getImportPrecedence</a>();
<a id="L1100" name="L1100"></a>1100             <strong class="reserved">if</strong> ((prec &gt;= <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>) &amp;&amp; (prec &lt; <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>)) <a href="../D/11109.html" title="Multiple defined in 3 places.">addTemplate</a>(template);
<a id="L1101" name="L1101"></a>1101         <em class="brace">}</em>
<a id="L1102" name="L1102"></a>1102 
<a id="L1103" name="L1103"></a>1103         <em class="comment">// Process all patterns from those templates</em>
<a id="L1104" name="L1104"></a>1104         <a href="../S/6149.html#L247" title="Defined at 247 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">processPatterns</a>(_keys);
<a id="L1105" name="L1105"></a>1105 
<a id="L1106" name="L1106"></a>1106         <em class="comment">// Create the applyTemplates() method</em>
<a id="L1107" name="L1107"></a>1107         <strong class="reserved">final</strong> com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>[] argTypes =
<a id="L1108" name="L1108"></a>1108             <strong class="reserved">new</strong> com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>[4];
<a id="L1109" name="L1109"></a>1109         argTypes[0] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(DOM_INTF_SIG);
<a id="L1110" name="L1110"></a>1110         argTypes[1] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(NODE_ITERATOR_SIG);
<a id="L1111" name="L1111"></a>1111         argTypes[2] = <a href="../D/9440.html" title="Multiple defined in 6 places.">Util</a>.<a href="../S/6101.html#L103" title="Defined at 103 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/Util.java.">getJCRefType</a>(TRANSLET_OUTPUT_SIG);
<a id="L1112" name="L1112"></a>1112         argTypes[3] = com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>.INT;
<a id="L1113" name="L1113"></a>1113 
<a id="L1114" name="L1114"></a>1114         <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] argNames = <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[4];
<a id="L1115" name="L1115"></a>1115         argNames[0] = DOCUMENT_PNAME;
<a id="L1116" name="L1116"></a>1116         argNames[1] = ITERATOR_PNAME;
<a id="L1117" name="L1117"></a>1117         argNames[2] = TRANSLET_OUTPUT_PNAME;
<a id="L1118" name="L1118"></a>1118         argNames[3] = NODE_PNAME;
<a id="L1119" name="L1119"></a>1119 
<a id="L1120" name="L1120"></a>1120         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> mainIL = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L1121" name="L1121"></a>1121         <strong class="reserved">final</strong> <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen =
<a id="L1122" name="L1122"></a>1122             <strong class="reserved">new</strong> <a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a>(ACC_PUBLIC | ACC_FINAL,
<a id="L1123" name="L1123"></a>1123                                 com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>.VOID,
<a id="L1124" name="L1124"></a>1124                                 argTypes, argNames, <a href="../D/16620.html" title="Multiple defined in 2 places.">functionName</a>()+'_'+<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>,
<a id="L1125" name="L1125"></a>1125                                 <a href="../D/17698.html" title="Multiple defined in 41 places.">getClassName</a>(), mainIL,
<a id="L1126" name="L1126"></a>1126                                 classGen.<a href="../D/17923.html" title="Multiple defined in 12 places.">getConstantPool</a>());
<a id="L1127" name="L1127"></a>1127         methodGen.<a href="../S/4802.html#L633" title="Defined at 633 in src/com/sun/org/apache/bcel/internal/generic/MethodGen.java.">addException</a>("com.sun.org.apache.xalan.internal.xsltc.TransletException");
<a id="L1128" name="L1128"></a>1128 
<a id="L1129" name="L1129"></a>1129         <em class="comment">// Create the local variable to hold the current node</em>
<a id="L1130" name="L1130"></a>1130         <strong class="reserved">final</strong> <a href="../S/4694.html#L75" title="Defined at 75 in src/com/sun/org/apache/bcel/internal/generic/LocalVariableGen.java.">LocalVariableGen</a> <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>;
<a id="L1131" name="L1131"></a>1131         <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a> = methodGen.<a href="../S/6132.html#L239" title="Defined at 239 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">addLocalVariable2</a>("current",
<a id="L1132" name="L1132"></a>1132                                               com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../D/9178.html" title="Multiple defined in 19 places.">Type</a>.INT,
<a id="L1133" name="L1133"></a>1133                                               <strong class="reserved">null</strong>);
<a id="L1134" name="L1134"></a>1134         _currentIndex = <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>();
<a id="L1135" name="L1135"></a>1135 
<a id="L1136" name="L1136"></a>1136         mainIL.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>(methodGen.<a href="../D/20200.html" title="Multiple defined in 7 places.">getLocalIndex</a>(NODE_PNAME)));
<a id="L1137" name="L1137"></a>1137         <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>.<a href="../D/33997.html" title="Multiple defined in 5 places.">setStart</a>(mainIL.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4787.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ISTORE.java.">ISTORE</a>(_currentIndex)));
<a id="L1138" name="L1138"></a>1138 
<a id="L1139" name="L1139"></a>1139         <em class="comment">// Create the "body" instruction list that will eventually hold the</em>
<a id="L1140" name="L1140"></a>1140         <em class="comment">// code for the entire method (other ILs will be appended).</em>
<a id="L1141" name="L1141"></a>1141         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> body = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L1142" name="L1142"></a>1142         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/4691.html#L66" title="Defined at 66 in src/com/sun/org/apache/bcel/internal/generic/NOP.java.">NOP</a>);
<a id="L1143" name="L1143"></a>1143 
<a id="L1144" name="L1144"></a>1144         <em class="comment">// Create an instruction list that contains the default next-node</em>
<a id="L1145" name="L1145"></a>1145         <em class="comment">// iteration</em>
<a id="L1146" name="L1146"></a>1146         <strong class="reserved">final</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> ilLoop = <strong class="reserved">new</strong> <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a>();
<a id="L1147" name="L1147"></a>1147         ilLoop.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/7024.html" title="Multiple defined in 4 places.">RETURN</a>);
<a id="L1148" name="L1148"></a>1148         <strong class="reserved">final</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihLoop = ilLoop.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L1149" name="L1149"></a>1149 
<a id="L1150" name="L1150"></a>1150         <em class="comment">// Compile default handling of elements (traverse children)</em>
<a id="L1151" name="L1151"></a>1151         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> ilRecurse =
<a id="L1152" name="L1152"></a>1152             <a href="../S/6149.html#L626" title="Defined at 626 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileDefaultRecursion</a>(classGen, methodGen, ihLoop);
<a id="L1153" name="L1153"></a>1153         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihRecurse = ilRecurse.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L1154" name="L1154"></a>1154 
<a id="L1155" name="L1155"></a>1155         <em class="comment">// Compile default handling of text/attribute nodes (output text)</em>
<a id="L1156" name="L1156"></a>1156         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> ilText =
<a id="L1157" name="L1157"></a>1157             <a href="../S/6149.html#L654" title="Defined at 654 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileDefaultText</a>(classGen, methodGen, ihLoop);
<a id="L1158" name="L1158"></a>1158         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihText = ilText.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L1159" name="L1159"></a>1159 
<a id="L1160" name="L1160"></a>1160         <em class="comment">// Distinguish attribute/element/namespace tests for further processing</em>
<a id="L1161" name="L1161"></a>1161         <strong class="reserved">final</strong> <strong class="reserved">int</strong>[] types = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES + names.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()];
<a id="L1162" name="L1162"></a>1162         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L1163" name="L1163"></a>1163             types[i] = i;
<a id="L1164" name="L1164"></a>1164         <em class="brace">}</em>
<a id="L1165" name="L1165"></a>1165 
<a id="L1166" name="L1166"></a>1166         <strong class="reserved">final</strong> <strong class="reserved">boolean</strong>[] <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a> = <strong class="reserved">new</strong> <strong class="reserved">boolean</strong>[types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L1167" name="L1167"></a>1167         <strong class="reserved">final</strong> <strong class="reserved">boolean</strong>[] <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a> = <strong class="reserved">new</strong> <strong class="reserved">boolean</strong>[types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L1168" name="L1168"></a>1168         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; names.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>(); i++) <em class="brace">{</em>
<a id="L1169" name="L1169"></a>1169             <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>)names.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L1170" name="L1170"></a>1170             <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i+<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES] = <a href="../S/6149.html#L1512" title="Defined at 1512 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">isAttributeName</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L1171" name="L1171"></a>1171             <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>[i+<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES] = <a href="../S/6149.html#L1521" title="Defined at 1521 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">isNamespaceName</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>);
<a id="L1172" name="L1172"></a>1172         <em class="brace">}</em>
<a id="L1173" name="L1173"></a>1173 
<a id="L1174" name="L1174"></a>1174         <em class="comment">// Compile all templates - regardless of pattern type</em>
<a id="L1175" name="L1175"></a>1175         <a href="../S/6149.html#L1055" title="Defined at 1055 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileTemplateCalls</a>(classGen, methodGen, ihLoop, <a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>, <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>);
<a id="L1176" name="L1176"></a>1176 
<a id="L1177" name="L1177"></a>1177         <em class="comment">// Handle template with explicit "*" pattern</em>
<a id="L1178" name="L1178"></a>1178         <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> elemTest = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE];
<a id="L1179" name="L1179"></a>1179         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihElem = ihRecurse;
<a id="L1180" name="L1180"></a>1180         <strong class="reserved">if</strong> (elemTest != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1181" name="L1181"></a>1181             ihElem = elemTest.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihLoop);
<a id="L1182" name="L1182"></a>1182         <em class="brace">}</em>
<a id="L1183" name="L1183"></a>1183 
<a id="L1184" name="L1184"></a>1184         <em class="comment">// Handle template with explicit "@*" pattern</em>
<a id="L1185" name="L1185"></a>1185         <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> attrTest = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE];
<a id="L1186" name="L1186"></a>1186         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihAttr = ihLoop;
<a id="L1187" name="L1187"></a>1187         <strong class="reserved">if</strong> (attrTest != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1188" name="L1188"></a>1188             ihAttr = attrTest.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihAttr);
<a id="L1189" name="L1189"></a>1189         <em class="brace">}</em>
<a id="L1190" name="L1190"></a>1190 
<a id="L1191" name="L1191"></a>1191         <em class="comment">// Do tests for id() and key() patterns first</em>
<a id="L1192" name="L1192"></a>1192         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> ilKey = <strong class="reserved">null</strong>;
<a id="L1193" name="L1193"></a>1193         <strong class="reserved">if</strong> (_idxTestSeq != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1194" name="L1194"></a>1194             ilKey = _idxTestSeq.<a href="../D/19776.html" title="Multiple defined in 7 places.">getInstructionList</a>();
<a id="L1195" name="L1195"></a>1195         <em class="brace">}</em>
<a id="L1196" name="L1196"></a>1196 
<a id="L1197" name="L1197"></a>1197         <em class="comment">// If there is a match on node() we need to replace ihElem</em>
<a id="L1198" name="L1198"></a>1198         <em class="comment">// and ihText if the priority of node() is higher</em>
<a id="L1199" name="L1199"></a>1199         <strong class="reserved">if</strong> (_childNodeTestSeq != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1200" name="L1200"></a>1200             <em class="comment">// Compare priorities of node() and "*"</em>
<a id="L1201" name="L1201"></a>1201             <strong class="reserved">double</strong> nodePrio = _childNodeTestSeq.<a href="../D/21675.html" title="Multiple defined in 8 places.">getPriority</a>();
<a id="L1202" name="L1202"></a>1202             <strong class="reserved">int</strong>    nodePos  = _childNodeTestSeq.<a href="../D/21546.html" title="Multiple defined in 41 places.">getPosition</a>();
<a id="L1203" name="L1203"></a>1203             <strong class="reserved">double</strong> elemPrio = (0 - <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.MAX_VALUE);
<a id="L1204" name="L1204"></a>1204             <strong class="reserved">int</strong>    elemPos  = <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MIN_VALUE;
<a id="L1205" name="L1205"></a>1205 
<a id="L1206" name="L1206"></a>1206             <strong class="reserved">if</strong> (elemTest != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1207" name="L1207"></a>1207                 elemPrio = elemTest.<a href="../D/21675.html" title="Multiple defined in 8 places.">getPriority</a>();
<a id="L1208" name="L1208"></a>1208                 elemPos  = elemTest.<a href="../D/21546.html" title="Multiple defined in 41 places.">getPosition</a>();
<a id="L1209" name="L1209"></a>1209             <em class="brace">}</em>
<a id="L1210" name="L1210"></a>1210 
<a id="L1211" name="L1211"></a>1211             <strong class="reserved">if</strong> (elemPrio == <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NaN || elemPrio &lt; nodePrio ||
<a id="L1212" name="L1212"></a>1212                 (elemPrio == nodePrio &amp;&amp; elemPos &lt; nodePos))
<a id="L1213" name="L1213"></a>1213             <em class="brace">{</em>
<a id="L1214" name="L1214"></a>1214                 ihElem = _childNodeTestSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihLoop);
<a id="L1215" name="L1215"></a>1215             <em class="brace">}</em>
<a id="L1216" name="L1216"></a>1216 
<a id="L1217" name="L1217"></a>1217             <em class="comment">// Compare priorities of node() and text()</em>
<a id="L1218" name="L1218"></a>1218             <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> textTest = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE];
<a id="L1219" name="L1219"></a>1219             <strong class="reserved">double</strong> textPrio = (0 - <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.MAX_VALUE);
<a id="L1220" name="L1220"></a>1220             <strong class="reserved">int</strong>    textPos  = <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MIN_VALUE;
<a id="L1221" name="L1221"></a>1221 
<a id="L1222" name="L1222"></a>1222             <strong class="reserved">if</strong> (textTest != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1223" name="L1223"></a>1223                 textPrio = textTest.<a href="../D/21675.html" title="Multiple defined in 8 places.">getPriority</a>();
<a id="L1224" name="L1224"></a>1224                 textPos  = textTest.<a href="../D/21546.html" title="Multiple defined in 41 places.">getPosition</a>();
<a id="L1225" name="L1225"></a>1225             <em class="brace">}</em>
<a id="L1226" name="L1226"></a>1226 
<a id="L1227" name="L1227"></a>1227             <strong class="reserved">if</strong> (textPrio == <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NaN || textPrio &lt; nodePrio ||
<a id="L1228" name="L1228"></a>1228                 (textPrio == nodePrio &amp;&amp; textPos &lt; nodePos))
<a id="L1229" name="L1229"></a>1229             <em class="brace">{</em>
<a id="L1230" name="L1230"></a>1230                 ihText = _childNodeTestSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihLoop);
<a id="L1231" name="L1231"></a>1231                 _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE] = _childNodeTestSeq;
<a id="L1232" name="L1232"></a>1232             <em class="brace">}</em>
<a id="L1233" name="L1233"></a>1233         <em class="brace">}</em>
<a id="L1234" name="L1234"></a>1234 
<a id="L1235" name="L1235"></a>1235         <em class="comment">// Handle templates with "ns:*" pattern</em>
<a id="L1236" name="L1236"></a>1236         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> elemNamespaceHandle = ihElem;
<a id="L1237" name="L1237"></a>1237         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> nsElem = <a href="../S/6149.html#L671" title="Defined at 671 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileNamespaces</a>(classGen, methodGen,
<a id="L1238" name="L1238"></a>1238                                                    <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>, <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>,
<a id="L1239" name="L1239"></a>1239                                                    <strong class="reserved">false</strong>, ihElem);
<a id="L1240" name="L1240"></a>1240         <strong class="reserved">if</strong> (nsElem != <strong class="reserved">null</strong>) elemNamespaceHandle = nsElem.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L1241" name="L1241"></a>1241 
<a id="L1242" name="L1242"></a>1242         <em class="comment">// Handle templates with "ns:@*" pattern</em>
<a id="L1243" name="L1243"></a>1243         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> nsAttr = <a href="../S/6149.html#L671" title="Defined at 671 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">compileNamespaces</a>(classGen, methodGen,
<a id="L1244" name="L1244"></a>1244                                                    <a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>, <a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>,
<a id="L1245" name="L1245"></a>1245                                                    <strong class="reserved">true</strong>, ihAttr);
<a id="L1246" name="L1246"></a>1246         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> attrNamespaceHandle = ihAttr;
<a id="L1247" name="L1247"></a>1247         <strong class="reserved">if</strong> (nsAttr != <strong class="reserved">null</strong>) attrNamespaceHandle = nsAttr.<a href="../D/22714.html" title="Multiple defined in 6 places.">getStart</a>();
<a id="L1248" name="L1248"></a>1248 
<a id="L1249" name="L1249"></a>1249         <em class="comment">// Handle templates with "ns:elem" or "ns:@attr" pattern</em>
<a id="L1250" name="L1250"></a>1250         <strong class="reserved">final</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[] targets = <strong class="reserved">new</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[types.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L1251" name="L1251"></a>1251         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES; i &lt; targets.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L1252" name="L1252"></a>1252             <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> testSeq = _testSeq[i];
<a id="L1253" name="L1253"></a>1253             <em class="comment">// Jump straight to namespace tests ?</em>
<a id="L1254" name="L1254"></a>1254             <strong class="reserved">if</strong> (<a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>[i]) <em class="brace">{</em>
<a id="L1255" name="L1255"></a>1255                 <strong class="reserved">if</strong> (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i])
<a id="L1256" name="L1256"></a>1256                     targets[i] = attrNamespaceHandle;
<a id="L1257" name="L1257"></a>1257                 <strong class="reserved">else</strong>
<a id="L1258" name="L1258"></a>1258                     targets[i] = elemNamespaceHandle;
<a id="L1259" name="L1259"></a>1259             <em class="brace">}</em>
<a id="L1260" name="L1260"></a>1260             <em class="comment">// Test first, then jump to namespace tests</em>
<a id="L1261" name="L1261"></a>1261             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (testSeq != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1262" name="L1262"></a>1262                 <strong class="reserved">if</strong> (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i])
<a id="L1263" name="L1263"></a>1263                     targets[i] = testSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen,
<a id="L1264" name="L1264"></a>1264                                                  attrNamespaceHandle);
<a id="L1265" name="L1265"></a>1265                 <strong class="reserved">else</strong>
<a id="L1266" name="L1266"></a>1266                     targets[i] = testSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen,
<a id="L1267" name="L1267"></a>1267                                                  elemNamespaceHandle);
<a id="L1268" name="L1268"></a>1268             <em class="brace">}</em>
<a id="L1269" name="L1269"></a>1269             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1270" name="L1270"></a>1270                 targets[i] = ihLoop;
<a id="L1271" name="L1271"></a>1271             <em class="brace">}</em>
<a id="L1272" name="L1272"></a>1272         <em class="brace">}</em>
<a id="L1273" name="L1273"></a>1273 
<a id="L1274" name="L1274"></a>1274         <em class="comment">// Handle pattern with match on root node - default: traverse children</em>
<a id="L1275" name="L1275"></a>1275         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ROOT_NODE] = _rootPattern != <strong class="reserved">null</strong>
<a id="L1276" name="L1276"></a>1276             ? <a href="../S/6149.html#L1505" title="Defined at 1505 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">getTemplateInstructionHandle</a>(_rootPattern.<a href="../D/23029.html" title="Multiple defined in 5 places.">getTemplate</a>())
<a id="L1277" name="L1277"></a>1277             : ihRecurse;
<a id="L1278" name="L1278"></a>1278         <em class="comment">// Handle pattern with match on root node - default: traverse children</em>
<a id="L1279" name="L1279"></a>1279         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.DOCUMENT_NODE] = _rootPattern != <strong class="reserved">null</strong>
<a id="L1280" name="L1280"></a>1280             ? <a href="../S/6149.html#L1505" title="Defined at 1505 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">getTemplateInstructionHandle</a>(_rootPattern.<a href="../D/23029.html" title="Multiple defined in 5 places.">getTemplate</a>())
<a id="L1281" name="L1281"></a>1281             : ihRecurse;    <em class="comment">// %HZ%:  Was ihLoop in XSLTC_DTM branch</em>
<a id="L1282" name="L1282"></a>1282 
<a id="L1283" name="L1283"></a>1283         <em class="comment">// Handle any pattern with match on text nodes - default: loop</em>
<a id="L1284" name="L1284"></a>1284         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE] = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE] != <strong class="reserved">null</strong>
<a id="L1285" name="L1285"></a>1285             ? _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.TEXT_NODE].<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihText)
<a id="L1286" name="L1286"></a>1286             : ihText;
<a id="L1287" name="L1287"></a>1287 
<a id="L1288" name="L1288"></a>1288         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L1289" name="L1289"></a>1289         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NAMESPACE_NODE] = ihLoop;
<a id="L1290" name="L1290"></a>1290 
<a id="L1291" name="L1291"></a>1291         <em class="comment">// Match unknown element in DOM - default: check for namespace match</em>
<a id="L1292" name="L1292"></a>1292         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ELEMENT_NODE] = elemNamespaceHandle;
<a id="L1293" name="L1293"></a>1293 
<a id="L1294" name="L1294"></a>1294         <em class="comment">// Match unknown attribute in DOM - default: check for namespace match</em>
<a id="L1295" name="L1295"></a>1295         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ATTRIBUTE_NODE] = attrNamespaceHandle;
<a id="L1296" name="L1296"></a>1296 
<a id="L1297" name="L1297"></a>1297         <em class="comment">// Match on processing instruction - default: loop</em>
<a id="L1298" name="L1298"></a>1298         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihPI = ihLoop;
<a id="L1299" name="L1299"></a>1299         <strong class="reserved">if</strong> (_childNodeTestSeq != <strong class="reserved">null</strong>) ihPI = ihElem;
<a id="L1300" name="L1300"></a>1300         <strong class="reserved">if</strong> (_testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE] != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1301" name="L1301"></a>1301             targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE] =
<a id="L1302" name="L1302"></a>1302                 _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE].
<a id="L1303" name="L1303"></a>1303                 <a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihPI);
<a id="L1304" name="L1304"></a>1304         <em class="brace">}</em>
<a id="L1305" name="L1305"></a>1305         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1306" name="L1306"></a>1306             targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.PROCESSING_INSTRUCTION_NODE] = ihPI;
<a id="L1307" name="L1307"></a>1307         <em class="brace">}</em>
<a id="L1308" name="L1308"></a>1308 
<a id="L1309" name="L1309"></a>1309         <em class="comment">// Match on comments - default: process next node</em>
<a id="L1310" name="L1310"></a>1310         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ihComment = ihLoop;
<a id="L1311" name="L1311"></a>1311         <strong class="reserved">if</strong> (_childNodeTestSeq != <strong class="reserved">null</strong>) ihComment = ihElem;
<a id="L1312" name="L1312"></a>1312         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.COMMENT_NODE] = _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.COMMENT_NODE] != <strong class="reserved">null</strong>
<a id="L1313" name="L1313"></a>1313             ? _testSeq[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.COMMENT_NODE].<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen, ihComment)
<a id="L1314" name="L1314"></a>1314             : ihComment;
<a id="L1315" name="L1315"></a>1315 
<a id="L1316" name="L1316"></a>1316                 <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L1317" name="L1317"></a>1317         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.CDATA_SECTION_NODE] = ihLoop;
<a id="L1318" name="L1318"></a>1318 
<a id="L1319" name="L1319"></a>1319         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L1320" name="L1320"></a>1320         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.DOCUMENT_FRAGMENT_NODE] = ihLoop;
<a id="L1321" name="L1321"></a>1321 
<a id="L1322" name="L1322"></a>1322         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L1323" name="L1323"></a>1323         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.DOCUMENT_TYPE_NODE] = ihLoop;
<a id="L1324" name="L1324"></a>1324 
<a id="L1325" name="L1325"></a>1325         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L1326" name="L1326"></a>1326         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ENTITY_NODE] = ihLoop;
<a id="L1327" name="L1327"></a>1327 
<a id="L1328" name="L1328"></a>1328         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L1329" name="L1329"></a>1329         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.ENTITY_REFERENCE_NODE] = ihLoop;
<a id="L1330" name="L1330"></a>1330 
<a id="L1331" name="L1331"></a>1331         <em class="comment">// This DOM-type is not in use - default: process next node</em>
<a id="L1332" name="L1332"></a>1332         targets[<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NOTATION_NODE] = ihLoop;
<a id="L1333" name="L1333"></a>1333 
<a id="L1334" name="L1334"></a>1334 
<a id="L1335" name="L1335"></a>1335 
<a id="L1336" name="L1336"></a>1336         <em class="comment">// Now compile test sequences for various match patterns:</em>
<a id="L1337" name="L1337"></a>1337         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.NTYPES; i &lt; targets.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L1338" name="L1338"></a>1338             <strong class="reserved">final</strong> <a href="../S/6189.html#L51" title="Defined at 51 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/TestSeq.java.">TestSeq</a> testSeq = _testSeq[i];
<a id="L1339" name="L1339"></a>1339             <em class="comment">// Jump straight to namespace tests ?</em>
<a id="L1340" name="L1340"></a>1340             <strong class="reserved">if</strong> ((testSeq == <strong class="reserved">null</strong>) || (<a href="../S/3896.html#L94" title="Defined at 94 in src/javax/xml/stream/events/XMLEvent.java.">isNamespace</a>[i])) <em class="brace">{</em>
<a id="L1341" name="L1341"></a>1341                 <strong class="reserved">if</strong> (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i])
<a id="L1342" name="L1342"></a>1342                     targets[i] = attrNamespaceHandle;
<a id="L1343" name="L1343"></a>1343                 <strong class="reserved">else</strong>
<a id="L1344" name="L1344"></a>1344                     targets[i] = elemNamespaceHandle;
<a id="L1345" name="L1345"></a>1345             <em class="brace">}</em>
<a id="L1346" name="L1346"></a>1346             <em class="comment">// Match on node type</em>
<a id="L1347" name="L1347"></a>1347             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1348" name="L1348"></a>1348                 <strong class="reserved">if</strong> (<a href="../D/25219.html" title="Multiple defined in 7 places.">isAttribute</a>[i])
<a id="L1349" name="L1349"></a>1349                     targets[i] = testSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen,
<a id="L1350" name="L1350"></a>1350                                                  attrNamespaceHandle);
<a id="L1351" name="L1351"></a>1351                 <strong class="reserved">else</strong>
<a id="L1352" name="L1352"></a>1352                     targets[i] = testSeq.<a href="../D/13080.html" title="Multiple defined in 22 places.">compile</a>(classGen, methodGen,
<a id="L1353" name="L1353"></a>1353                                                  elemNamespaceHandle);
<a id="L1354" name="L1354"></a>1354             <em class="brace">}</em>
<a id="L1355" name="L1355"></a>1355         <em class="brace">}</em>
<a id="L1356" name="L1356"></a>1356 
<a id="L1357" name="L1357"></a>1357         <strong class="reserved">if</strong> (ilKey != <strong class="reserved">null</strong>) body.<a href="../D/24721.html" title="Multiple defined in 265 places.">insert</a>(ilKey);
<a id="L1358" name="L1358"></a>1358 
<a id="L1359" name="L1359"></a>1359         <em class="comment">// Append first code in applyTemplates() - get type of current node</em>
<a id="L1360" name="L1360"></a>1360         <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a> = cpg.<a href="../D/10875.html" title="Multiple defined in 2 places.">addInterfaceMethodref</a>(DOM_INTF,
<a id="L1361" name="L1361"></a>1361                                                       "getExpandedTypeID",
<a id="L1362" name="L1362"></a>1362                                                       "(I)I");
<a id="L1363" name="L1363"></a>1363         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(methodGen.<a href="../D/26912.html" title="Multiple defined in 4 places.">loadDOM</a>());
<a id="L1364" name="L1364"></a>1364         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>(_currentIndex));
<a id="L1365" name="L1365"></a>1365         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../S/4624.html#L73" title="Defined at 73 in src/com/sun/org/apache/bcel/internal/generic/INVOKEINTERFACE.java.">INVOKEINTERFACE</a>(<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>, 2));
<a id="L1366" name="L1366"></a>1366 
<a id="L1367" name="L1367"></a>1367         <em class="comment">// Append switch() statement - main dispatch loop in applyTemplates()</em>
<a id="L1368" name="L1368"></a>1368         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> disp = body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">new</strong> <a href="../D/7577.html" title="Multiple defined in 2 places.">SWITCH</a>(types,targets,ihLoop));
<a id="L1369" name="L1369"></a>1369 
<a id="L1370" name="L1370"></a>1370         <em class="comment">// Append all the "case:" statements</em>
<a id="L1371" name="L1371"></a>1371         <a href="../S/6149.html#L597" title="Defined at 597 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">appendTestSequences</a>(body);
<a id="L1372" name="L1372"></a>1372         <em class="comment">// Append the actual template code</em>
<a id="L1373" name="L1373"></a>1373         <a href="../S/6149.html#L586" title="Defined at 586 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Mode.java.">appendTemplateCode</a>(body);
<a id="L1374" name="L1374"></a>1374 
<a id="L1375" name="L1375"></a>1375         <em class="comment">// Append NS:* node tests (if any)</em>
<a id="L1376" name="L1376"></a>1376         <strong class="reserved">if</strong> (nsElem != <strong class="reserved">null</strong>) body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(nsElem);
<a id="L1377" name="L1377"></a>1377         <em class="comment">// Append NS:@* node tests (if any)</em>
<a id="L1378" name="L1378"></a>1378         <strong class="reserved">if</strong> (nsAttr != <strong class="reserved">null</strong>) body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(nsAttr);
<a id="L1379" name="L1379"></a>1379 
<a id="L1380" name="L1380"></a>1380         <em class="comment">// Append default action for element and root nodes</em>
<a id="L1381" name="L1381"></a>1381         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ilRecurse);
<a id="L1382" name="L1382"></a>1382         <em class="comment">// Append default action for text and attribute nodes</em>
<a id="L1383" name="L1383"></a>1383         body.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ilText);
<a id="L1384" name="L1384"></a>1384 
<a id="L1385" name="L1385"></a>1385         <em class="comment">// putting together constituent instruction lists</em>
<a id="L1386" name="L1386"></a>1386         mainIL.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(body);
<a id="L1387" name="L1387"></a>1387 
<a id="L1388" name="L1388"></a>1388         <em class="comment">// Mark the end of the live range for the "current" variable</em>
<a id="L1389" name="L1389"></a>1389         <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>.<a href="../D/32584.html" title="Multiple defined in 5 places.">setEnd</a>(body.<a href="../D/18764.html" title="Multiple defined in 5 places.">getEnd</a>());
<a id="L1390" name="L1390"></a>1390 
<a id="L1391" name="L1391"></a>1391         <em class="comment">// fall through to ilLoop</em>
<a id="L1392" name="L1392"></a>1392         mainIL.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ilLoop);
<a id="L1393" name="L1393"></a>1393 
<a id="L1394" name="L1394"></a>1394         <a href="../D/29312.html" title="Multiple defined in 2 places.">peepHoleOptimization</a>(methodGen);
<a id="L1395" name="L1395"></a>1395         classGen.<a href="../D/10936.html" title="Multiple defined in 3 places.">addMethod</a>(methodGen);
<a id="L1396" name="L1396"></a>1396 
<a id="L1397" name="L1397"></a>1397         <em class="comment">// Restore original (complete) set of templates for this transformation</em>
<a id="L1398" name="L1398"></a>1398         _templates = oldTemplates;
<a id="L1399" name="L1399"></a>1399     <em class="brace">}</em>
<a id="L1400" name="L1400"></a>1400 
<div class="comment">
       Peephole optimization.</div>
<a id="L1404" name="L1404"></a>1404     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/24710.html" title="Multiple referred from 2 places.">peepHoleOptimization</a>(<a href="../S/6132.html#L82" title="Defined at 82 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/util/MethodGenerator.java.">MethodGenerator</a> methodGen) <em class="brace">{</em>
<a id="L1405" name="L1405"></a>1405         <a href="../S/4621.html#L87" title="Defined at 87 in src/com/sun/org/apache/bcel/internal/generic/InstructionList.java.">InstructionList</a> il = methodGen.<a href="../D/19776.html" title="Multiple defined in 7 places.">getInstructionList</a>();
<a id="L1406" name="L1406"></a>1406         <a href="../S/4549.html#L92" title="Defined at 92 in src/com/sun/org/apache/bcel/internal/util/InstructionFinder.java.">InstructionFinder</a> <a href="../D/16082.html" title="Multiple defined in 26 places.">find</a> = <strong class="reserved">new</strong> <a href="../S/4549.html#L92" title="Defined at 92 in src/com/sun/org/apache/bcel/internal/util/InstructionFinder.java.">InstructionFinder</a>(il);
<a id="L1407" name="L1407"></a>1407         <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> ih;
<a id="L1408" name="L1408"></a>1408         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>;
<a id="L1409" name="L1409"></a>1409 
<a id="L1410" name="L1410"></a>1410         <em class="comment">// LoadInstruction, POP =&gt; (removed)</em>
<a id="L1411" name="L1411"></a>1411         <em class="comment">// pattern = "LoadInstruction POP";</em>
<a id="L1412" name="L1412"></a>1412         <em class="comment">// changed to lower case - changing to all lower case although only the instruction with capital I</em>
<a id="L1413" name="L1413"></a>1413         <em class="comment">// is creating a problem in the Turkish locale</em>
<a id="L1414" name="L1414"></a>1414         <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> = "loadinstruction pop";
<a id="L1415" name="L1415"></a>1415 
<a id="L1416" name="L1416"></a>1416         <strong class="reserved">for</strong> (<a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a> <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a> = <a href="../D/16082.html" title="Multiple defined in 26 places.">find</a>.<a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>); <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>();) <em class="brace">{</em>
<a id="L1417" name="L1417"></a>1417             <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[] <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a> = (<a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[]) <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L1418" name="L1418"></a>1418             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1419" name="L1419"></a>1419                 <strong class="reserved">if</strong> (!<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[0].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>() &amp;&amp; !<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>()) <em class="brace">{</em>
<a id="L1420" name="L1420"></a>1420                     il.<a href="../D/14793.html" title="Multiple defined in 25 places.">delete</a>(<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[0], <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1]);
<a id="L1421" name="L1421"></a>1421                 <em class="brace">}</em>
<a id="L1422" name="L1422"></a>1422             <em class="brace">}</em>
<a id="L1423" name="L1423"></a>1423             <strong class="reserved">catch</strong> (<a href="../S/4746.html#L91" title="Defined at 91 in src/com/sun/org/apache/bcel/internal/generic/TargetLostException.java.">TargetLostException</a> e) <em class="brace">{</em>
<a id="L1424" name="L1424"></a>1424                 <em class="comment">// TODO: move target down into the list</em>
<a id="L1425" name="L1425"></a>1425             <em class="brace">}</em>
<a id="L1426" name="L1426"></a>1426         <em class="brace">}</em>
<a id="L1427" name="L1427"></a>1427 
<a id="L1428" name="L1428"></a>1428         <em class="comment">// ILOAD_N, ILOAD_N, SWAP, ISTORE_N =&gt; ILOAD_N</em>
<a id="L1429" name="L1429"></a>1429         <em class="comment">// pattern = "ILOAD ILOAD SWAP ISTORE";</em>
<a id="L1430" name="L1430"></a>1430         <em class="comment">// changed to lower case - changing to all lower case although only the instruction with capital I</em>
<a id="L1431" name="L1431"></a>1431         <em class="comment">// is creating a problem in the Turkish locale</em>
<a id="L1432" name="L1432"></a>1432         <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> = "iload iload swap istore";
<a id="L1433" name="L1433"></a>1433         <strong class="reserved">for</strong> (<a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a> <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a> = <a href="../D/16082.html" title="Multiple defined in 26 places.">find</a>.<a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>); <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>();) <em class="brace">{</em>
<a id="L1434" name="L1434"></a>1434             <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[] <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a> = (<a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[]) <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L1435" name="L1435"></a>1435             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1436" name="L1436"></a>1436                 com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a> iload1 =
<a id="L1437" name="L1437"></a>1437                     (com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>) <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[0].<a href="../D/19773.html" title="Multiple defined in 4 places.">getInstruction</a>();
<a id="L1438" name="L1438"></a>1438                 com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a> iload2 =
<a id="L1439" name="L1439"></a>1439                     (com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4623.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ILOAD.java.">ILOAD</a>) <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1].<a href="../D/19773.html" title="Multiple defined in 4 places.">getInstruction</a>();
<a id="L1440" name="L1440"></a>1440                 com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4787.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ISTORE.java.">ISTORE</a> istore =
<a id="L1441" name="L1441"></a>1441                     (com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4787.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ISTORE.java.">ISTORE</a>) <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[3].<a href="../D/19773.html" title="Multiple defined in 4 places.">getInstruction</a>();
<a id="L1442" name="L1442"></a>1442 
<a id="L1443" name="L1443"></a>1443                 <strong class="reserved">if</strong> (!<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>() &amp;&amp;
<a id="L1444" name="L1444"></a>1444                     !<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[2].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>() &amp;&amp;
<a id="L1445" name="L1445"></a>1445                     !<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[3].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>() &amp;&amp;
<a id="L1446" name="L1446"></a>1446                     iload1.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>() == iload2.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>() &amp;&amp;
<a id="L1447" name="L1447"></a>1447                     iload2.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>() == istore.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>())
<a id="L1448" name="L1448"></a>1448                 <em class="brace">{</em>
<a id="L1449" name="L1449"></a>1449                     il.<a href="../D/14793.html" title="Multiple defined in 25 places.">delete</a>(<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1], <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[3]);
<a id="L1450" name="L1450"></a>1450                 <em class="brace">}</em>
<a id="L1451" name="L1451"></a>1451             <em class="brace">}</em>
<a id="L1452" name="L1452"></a>1452             <strong class="reserved">catch</strong> (<a href="../S/4746.html#L91" title="Defined at 91 in src/com/sun/org/apache/bcel/internal/generic/TargetLostException.java.">TargetLostException</a> e) <em class="brace">{</em>
<a id="L1453" name="L1453"></a>1453                 <em class="comment">// TODO: move target down into the list</em>
<a id="L1454" name="L1454"></a>1454             <em class="brace">}</em>
<a id="L1455" name="L1455"></a>1455         <em class="brace">}</em>
<a id="L1456" name="L1456"></a>1456 
<a id="L1457" name="L1457"></a>1457         <em class="comment">// LoadInstruction_N, LoadInstruction_M, SWAP =&gt; LoadInstruction_M, LoadInstruction_N</em>
<a id="L1458" name="L1458"></a>1458         <em class="comment">// pattern = "LoadInstruction LoadInstruction SWAP";</em>
<a id="L1459" name="L1459"></a>1459         <em class="comment">// changed to lower case - changing to all lower case although only the instruction with capital I</em>
<a id="L1460" name="L1460"></a>1460         <em class="comment">// is creating a problem in the Turkish locale</em>
<a id="L1461" name="L1461"></a>1461         <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> = "loadinstruction loadinstruction swap";
<a id="L1462" name="L1462"></a>1462         <strong class="reserved">for</strong> (<a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a> <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a> = <a href="../D/16082.html" title="Multiple defined in 26 places.">find</a>.<a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>); <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>();) <em class="brace">{</em>
<a id="L1463" name="L1463"></a>1463             <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[] <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a> = (<a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[])<a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L1464" name="L1464"></a>1464             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1465" name="L1465"></a>1465                 <strong class="reserved">if</strong> (!<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[0].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>() &amp;&amp;
<a id="L1466" name="L1466"></a>1466                     !<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>() &amp;&amp;
<a id="L1467" name="L1467"></a>1467                     !<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[2].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>())
<a id="L1468" name="L1468"></a>1468                 <em class="brace">{</em>
<a id="L1469" name="L1469"></a>1469                     <a href="../D/4259.html" title="Multiple defined in 2 places.">Instruction</a> load_m = <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1].<a href="../D/19773.html" title="Multiple defined in 4 places.">getInstruction</a>();
<a id="L1470" name="L1470"></a>1470                     il.<a href="../D/24721.html" title="Multiple defined in 265 places.">insert</a>(<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[0], load_m);
<a id="L1471" name="L1471"></a>1471                     il.<a href="../D/14793.html" title="Multiple defined in 25 places.">delete</a>(<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1], <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[2]);
<a id="L1472" name="L1472"></a>1472                 <em class="brace">}</em>
<a id="L1473" name="L1473"></a>1473             <em class="brace">}</em>
<a id="L1474" name="L1474"></a>1474             <strong class="reserved">catch</strong> (<a href="../S/4746.html#L91" title="Defined at 91 in src/com/sun/org/apache/bcel/internal/generic/TargetLostException.java.">TargetLostException</a> e) <em class="brace">{</em>
<a id="L1475" name="L1475"></a>1475                 <em class="comment">// TODO: move target down into the list</em>
<a id="L1476" name="L1476"></a>1476             <em class="brace">}</em>
<a id="L1477" name="L1477"></a>1477         <em class="brace">}</em>
<a id="L1478" name="L1478"></a>1478 
<a id="L1479" name="L1479"></a>1479         <em class="comment">// ALOAD_N ALOAD_N =&gt; ALOAD_N DUP</em>
<a id="L1480" name="L1480"></a>1480         <em class="comment">// pattern = "ALOAD ALOAD";</em>
<a id="L1481" name="L1481"></a>1481         <em class="comment">// changed to lower case - changing to all lower case although only the instruction with capital I</em>
<a id="L1482" name="L1482"></a>1482         <em class="comment">// is creating a problem in the Turkish locale</em>
<a id="L1483" name="L1483"></a>1483         <a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a> = "aload aload";
<a id="L1484" name="L1484"></a>1484         <strong class="reserved">for</strong> (<a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a> <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a> = <a href="../D/16082.html" title="Multiple defined in 26 places.">find</a>.<a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>(<a href="../D/29283.html" title="Multiple defined in 2 places.">pattern</a>); <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.<a href="../D/24134.html" title="Multiple defined in 81 places.">hasNext</a>();) <em class="brace">{</em>
<a id="L1485" name="L1485"></a>1485             <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[] <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a> = (<a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>[])<a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L1486" name="L1486"></a>1486             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1487" name="L1487"></a>1487                 <strong class="reserved">if</strong> (!<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1].<a href="../S/4625.html#L214" title="Defined at 214 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">hasTargeters</a>()) <em class="brace">{</em>
<a id="L1488" name="L1488"></a>1488                     com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4754.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ALOAD.java.">ALOAD</a> aload1 =
<a id="L1489" name="L1489"></a>1489                         (com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4754.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ALOAD.java.">ALOAD</a>) <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[0].<a href="../D/19773.html" title="Multiple defined in 4 places.">getInstruction</a>();
<a id="L1490" name="L1490"></a>1490                     com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4754.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ALOAD.java.">ALOAD</a> aload2 =
<a id="L1491" name="L1491"></a>1491                         (com.sun.org.apache.bcel.internal.<a href="../S/1616.html#L641" title="Defined at 641 in src/java/lang/invoke/MethodType.java.">generic</a>.<a href="../S/4754.html#L67" title="Defined at 67 in src/com/sun/org/apache/bcel/internal/generic/ALOAD.java.">ALOAD</a>) <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1].<a href="../D/19773.html" title="Multiple defined in 4 places.">getInstruction</a>();
<a id="L1492" name="L1492"></a>1492 
<a id="L1493" name="L1493"></a>1493                     <strong class="reserved">if</strong> (aload1.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>() == aload2.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>()) <em class="brace">{</em>
<a id="L1494" name="L1494"></a>1494                         il.<a href="../D/24721.html" title="Multiple defined in 265 places.">insert</a>(<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1], <strong class="reserved">new</strong> <a href="../D/2160.html" title="Multiple defined in 3 places.">DUP</a>());
<a id="L1495" name="L1495"></a>1495                         il.<a href="../D/14793.html" title="Multiple defined in 25 places.">delete</a>(<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>[1]);
<a id="L1496" name="L1496"></a>1496                     <em class="brace">}</em>
<a id="L1497" name="L1497"></a>1497                 <em class="brace">}</em>
<a id="L1498" name="L1498"></a>1498             <em class="brace">}</em>
<a id="L1499" name="L1499"></a>1499             <strong class="reserved">catch</strong> (<a href="../S/4746.html#L91" title="Defined at 91 in src/com/sun/org/apache/bcel/internal/generic/TargetLostException.java.">TargetLostException</a> e) <em class="brace">{</em>
<a id="L1500" name="L1500"></a>1500                 <em class="comment">// TODO: move target down into the list</em>
<a id="L1501" name="L1501"></a>1501             <em class="brace">}</em>
<a id="L1502" name="L1502"></a>1502         <em class="brace">}</em>
<a id="L1503" name="L1503"></a>1503     <em class="brace">}</em>
<a id="L1504" name="L1504"></a>1504 
<a id="L1505" name="L1505"></a>1505     <strong class="reserved">public</strong> <a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a> <a href="../R/19416.html" title="Multiple referred from 5 places.">getTemplateInstructionHandle</a>(<a href="../S/6217.html#L48" title="Defined at 48 in src/com/sun/org/apache/xalan/internal/xsltc/compiler/Template.java.">Template</a> template) <em class="brace">{</em>
<a id="L1506" name="L1506"></a>1506         <strong class="reserved">return</strong> (<a href="../S/4625.html#L83" title="Defined at 83 in src/com/sun/org/apache/bcel/internal/generic/InstructionHandle.java.">InstructionHandle</a>)_templateIHs.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(template);
<a id="L1507" name="L1507"></a>1507     <em class="brace">}</em>
<a id="L1508" name="L1508"></a>1508 
<div class="comment">
      Auxiliary method to determine if a qname is an attribute.</div>
<a id="L1512" name="L1512"></a>1512     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/21188.html" title="Multiple referred from 3 places.">isAttributeName</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> qname) <em class="brace">{</em>
<a id="L1513" name="L1513"></a>1513         <strong class="reserved">final</strong> <strong class="reserved">int</strong> col = qname.<a href="../D/26748.html" title="Multiple defined in 44 places.">lastIndexOf</a>(':') + 1;
<a id="L1514" name="L1514"></a>1514         <strong class="reserved">return</strong> (qname.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(col) == '@');
<a id="L1515" name="L1515"></a>1515     <em class="brace">}</em>
<a id="L1516" name="L1516"></a>1516 
<div class="comment">
      Auxiliary method to determine if a qname is a namespace
      qualified "*".</div>
<a id="L1521" name="L1521"></a>1521     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/21764.html" title="Multiple referred from 2 places.">isNamespaceName</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> qname) <em class="brace">{</em>
<a id="L1522" name="L1522"></a>1522         <strong class="reserved">final</strong> <strong class="reserved">int</strong> col = qname.<a href="../D/26748.html" title="Multiple defined in 44 places.">lastIndexOf</a>(':');
<a id="L1523" name="L1523"></a>1523         <strong class="reserved">return</strong> (col &gt; -1 &amp;&amp; qname.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(qname.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()-1) == '*');
<a id="L1524" name="L1524"></a>1524     <em class="brace">}</em>
<a id="L1525" name="L1525"></a>1525 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L192">[^]</a><a href="#L1521">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>