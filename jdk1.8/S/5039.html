<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L145">[^]</a><a href="#L706">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L145" title="Defined at 145.">read</a></li>
<li><a href="#L282" title="Defined at 282.">read</a></li>
<li><a href="#L588" title="Defined at 588.">skip</a></li>
<li><a href="#L617" title="Defined at 617.">ready</a></li>
<li><a href="#L624" title="Defined at 624.">markSupported</a></li>
<li><a href="#L641" title="Defined at 641.">mark</a></li>
<li><a href="#L658" title="Defined at 658.">reset</a></li>
<li><a href="#L670" title="Defined at 670.">close</a></li>
<li><a href="#L682" title="Defined at 682.">expectedByte</a></li>
<li><a href="#L694" title="Defined at 694.">invalidByte</a></li>
<li><a href="#L706" title="Defined at 706.">invalidSurrogate</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 2000-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
       http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<a id="L20" name="L20"></a>  20 
<a id="L21" name="L21"></a>  21 <strong class="reserved">package</strong> com.sun.org.apache.xerces.internal.<a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>.io;
<a id="L22" name="L22"></a>  22 
<a id="L23" name="L23"></a>  23 <strong class="reserved">import</strong> java.io.InputStream;
<a id="L24" name="L24"></a>  24 <strong class="reserved">import</strong> java.io.IOException;
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> java.io.Reader;
<a id="L26" name="L26"></a>  26 
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.util.Locale;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.util.MessageFormatter;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.impl.msg.XMLMessageFormatter;
<a id="L30" name="L30"></a>  30 
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.xml.internal.stream.util.BufferAllocator;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> com.sun.xml.internal.stream.util.ThreadLocalBufferAllocator;
<a id="L33" name="L33"></a>  33 
<div class="comment">
  <p>A UTF-8 reader.</p>
  @xerces.internal
  @author Andy Clark, IBM</div>
<a id="L42" name="L42"></a>  42 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/8426.html" title="Multiple referred from 6 places.">UTF8Reader</a>
<a id="L43" name="L43"></a>  43     <strong class="reserved">extends</strong> <a href="../S/1412.html#L51" title="Defined at 51 in src/java/io/Reader.java.">Reader</a> <em class="brace">{</em>
<a id="L44" name="L44"></a>  44 
<a id="L45" name="L45"></a>  45     <em class="comment">//</em>
<a id="L46" name="L46"></a>  46     <em class="comment">// Constants</em>
<a id="L47" name="L47"></a>  47     <em class="comment">//</em>
<a id="L48" name="L48"></a>  48 
<div class="comment">
     /** Default byte buffer size (2048). */</div>
<a id="L50" name="L50"></a>  50     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> DEFAULT_BUFFER_SIZE = 2048;
<a id="L51" name="L51"></a>  51 
<a id="L52" name="L52"></a>  52     <em class="comment">// debugging</em>
<a id="L53" name="L53"></a>  53 
<div class="comment">
     /** Debug read. */</div>
<a id="L55" name="L55"></a>  55     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> DEBUG_READ = <strong class="reserved">false</strong>;
<a id="L56" name="L56"></a>  56 
<a id="L57" name="L57"></a>  57     <em class="comment">//</em>
<a id="L58" name="L58"></a>  58     <em class="comment">// Data</em>
<a id="L59" name="L59"></a>  59     <em class="comment">//</em>
<a id="L60" name="L60"></a>  60 
<div class="comment">
     /** Input stream. */</div>
<a id="L62" name="L62"></a>  62     <strong class="reserved">protected</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> fInputStream;
<a id="L63" name="L63"></a>  63 
<div class="comment">
     /** Byte buffer. */</div>
<a id="L65" name="L65"></a>  65     <strong class="reserved">protected</strong> <strong class="reserved">byte</strong>[] fBuffer;
<a id="L66" name="L66"></a>  66 
<div class="comment">
     /** Offset into buffer. */</div>
<a id="L68" name="L68"></a>  68     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> fOffset;
<a id="L69" name="L69"></a>  69 
<div class="comment">
     /** Surrogate character. */</div>
<a id="L71" name="L71"></a>  71     <strong class="reserved">private</strong> <strong class="reserved">int</strong> fSurrogate = -1;
<a id="L72" name="L72"></a>  72 
<a id="L73" name="L73"></a>  73     <em class="comment">// message formatter; used to produce localized</em>
<a id="L74" name="L74"></a>  74     <em class="comment">// exception messages</em>
<a id="L75" name="L75"></a>  75     <strong class="reserved">private</strong> <a href="../S/5331.html#L36" title="Defined at 36 in src/com/sun/org/apache/xerces/internal/util/MessageFormatter.java.">MessageFormatter</a> fFormatter = <strong class="reserved">null</strong>;
<a id="L76" name="L76"></a>  76 
<a id="L77" name="L77"></a>  77     <em class="comment">//Locale to use for messages</em>
<a id="L78" name="L78"></a>  78     <strong class="reserved">private</strong> <a href="../S/1034.html#L484" title="Defined at 484 in src/java/util/Locale.java.">Locale</a> fLocale = <strong class="reserved">null</strong>;
<a id="L79" name="L79"></a>  79 
<a id="L80" name="L80"></a>  80     <em class="comment">//</em>
<a id="L81" name="L81"></a>  81     <em class="comment">// Constructors</em>
<a id="L82" name="L82"></a>  82     <em class="comment">//</em>
<a id="L83" name="L83"></a>  83 
<div class="comment">
      Constructs a UTF-8 reader from the specified input stream
      using the default buffer size.  Primarily for testing.
      @param inputStream The input stream.</div>
<a id="L90" name="L90"></a>  90     <strong class="reserved">public</strong> UTF8Reader(<a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> inputStream) <em class="brace">{</em>
<a id="L91" name="L91"></a>  91         <strong class="reserved">this</strong>(inputStream, DEFAULT_BUFFER_SIZE, <strong class="reserved">new</strong> <a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>(), <a href="../S/1034.html#L484" title="Defined at 484 in src/java/util/Locale.java.">Locale</a>.<a href="../D/18273.html" title="Multiple defined in 13 places.">getDefault</a>());
<a id="L92" name="L92"></a>  92     <em class="brace">}</em> <em class="comment">// &lt;init&gt;(InputStream, MessageFormatter)</em>
<a id="L93" name="L93"></a>  93 
<div class="comment">
      Constructs a UTF-8 reader from the specified input stream
      using the default buffer size and the given MessageFormatter.
      @param inputStream The input stream.
      @param messageFormatter  given MessageFormatter
      @param locale    Locale to use for messages</div>
<a id="L102" name="L102"></a> 102     <strong class="reserved">public</strong> UTF8Reader(<a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> inputStream, <a href="../S/5331.html#L36" title="Defined at 36 in src/com/sun/org/apache/xerces/internal/util/MessageFormatter.java.">MessageFormatter</a> messageFormatter,
<a id="L103" name="L103"></a> 103             <a href="../S/1034.html#L484" title="Defined at 484 in src/java/util/Locale.java.">Locale</a> <a href="../D/27010.html" title="Multiple defined in 2 places.">locale</a>) <em class="brace">{</em>
<a id="L104" name="L104"></a> 104         <strong class="reserved">this</strong>(inputStream, DEFAULT_BUFFER_SIZE, messageFormatter, <a href="../D/27010.html" title="Multiple defined in 2 places.">locale</a>);
<a id="L105" name="L105"></a> 105     <em class="brace">}</em> <em class="comment">// &lt;init&gt;(InputStream, MessageFormatter, Locale)</em>
<a id="L106" name="L106"></a> 106 
<div class="comment">
      Constructs a UTF-8 reader from the specified input stream,
      buffer size and MessageFormatter.
      @param inputStream The input stream.
      @param size        The initial buffer size.
      @param messageFormatter  the formatter for localizing/formatting errors.
      @param locale    the Locale to use for messages</div>
<a id="L116" name="L116"></a> 116     <strong class="reserved">public</strong> UTF8Reader(<a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> inputStream, <strong class="reserved">int</strong> <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>,
<a id="L117" name="L117"></a> 117             <a href="../S/5331.html#L36" title="Defined at 36 in src/com/sun/org/apache/xerces/internal/util/MessageFormatter.java.">MessageFormatter</a> messageFormatter, <a href="../S/1034.html#L484" title="Defined at 484 in src/java/util/Locale.java.">Locale</a> <a href="../D/27010.html" title="Multiple defined in 2 places.">locale</a>) <em class="brace">{</em>
<a id="L118" name="L118"></a> 118         fInputStream = inputStream;
<a id="L119" name="L119"></a> 119         BufferAllocator ba = ThreadLocalBufferAllocator.getBufferAllocator();
<a id="L120" name="L120"></a> 120         fBuffer = ba.<a href="../D/17401.html" title="Multiple defined in 12 places.">getByteBuffer</a>(<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>);
<a id="L121" name="L121"></a> 121         <strong class="reserved">if</strong> (fBuffer == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L122" name="L122"></a> 122             fBuffer = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>];
<a id="L123" name="L123"></a> 123         <em class="brace">}</em>
<a id="L124" name="L124"></a> 124         fFormatter = messageFormatter;
<a id="L125" name="L125"></a> 125         fLocale = <a href="../D/27010.html" title="Multiple defined in 2 places.">locale</a>;
<a id="L126" name="L126"></a> 126     <em class="brace">}</em> <em class="comment">// &lt;init&gt;(InputStream, int, MessageFormatter, Locale)</em>
<a id="L127" name="L127"></a> 127 
<a id="L128" name="L128"></a> 128     <em class="comment">//</em>
<a id="L129" name="L129"></a> 129     <em class="comment">// Reader methods</em>
<a id="L130" name="L130"></a> 130     <em class="comment">//</em>
<a id="L131" name="L131"></a> 131 
<div class="comment">
      Read a single character.  This method will block until a character is
      available, an I/O error occurs, or the end of the stream is reached.
      <p> Subclasses that intend to support efficient single-character input
      should override this method.
      @return     The character read, as an integer in the range 0 to 16383
                  (<tt>0x00-0xffff</tt>), or -1 if the end of the stream has
                  been reached
      @exception  IOException  If an I/O error occurs</p></div>
<a id="L145" name="L145"></a> 145     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/25407.html" title="Multiple referred from 1300 places.">read</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L146" name="L146"></a> 146 
<a id="L147" name="L147"></a> 147         <em class="comment">// decode character</em>
<a id="L148" name="L148"></a> 148         <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = fSurrogate;
<a id="L149" name="L149"></a> 149         <strong class="reserved">if</strong> (fSurrogate == -1) <em class="brace">{</em>
<a id="L150" name="L150"></a> 150             <em class="comment">// NOTE: We use the index into the buffer if there are remaining</em>
<a id="L151" name="L151"></a> 151             <em class="comment">//       bytes from the last block read. -Ac</em>
<a id="L152" name="L152"></a> 152             <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = 0;
<a id="L153" name="L153"></a> 153 
<a id="L154" name="L154"></a> 154             <em class="comment">// get first byte</em>
<a id="L155" name="L155"></a> 155             <strong class="reserved">int</strong> b0 = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == fOffset
<a id="L156" name="L156"></a> 156                    ? fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>() : fBuffer[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] &amp; 0x00FF;
<a id="L157" name="L157"></a> 157             <strong class="reserved">if</strong> (b0 == -1) <em class="brace">{</em>
<a id="L158" name="L158"></a> 158                 <strong class="reserved">return</strong> -1;
<a id="L159" name="L159"></a> 159             <em class="brace">}</em>
<a id="L160" name="L160"></a> 160 
<a id="L161" name="L161"></a> 161             <em class="comment">// UTF-8:   [0xxx xxxx]</em>
<a id="L162" name="L162"></a> 162             <em class="comment">// Unicode: [0000 0000] [0xxx xxxx]</em>
<a id="L163" name="L163"></a> 163             <strong class="reserved">if</strong> (b0 &lt; 0x80) <em class="brace">{</em>
<a id="L164" name="L164"></a> 164                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = (<strong class="reserved">char</strong>)b0;
<a id="L165" name="L165"></a> 165             <em class="brace">}</em>
<a id="L166" name="L166"></a> 166 
<a id="L167" name="L167"></a> 167             <em class="comment">// UTF-8:   [110y yyyy] [10xx xxxx]</em>
<a id="L168" name="L168"></a> 168             <em class="comment">// Unicode: [0000 0yyy] [yyxx xxxx]</em>
<a id="L169" name="L169"></a> 169             <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((b0 &amp; 0xE0) == 0xC0 &amp;&amp; (b0 &amp; 0x1E) != 0) <em class="brace">{</em>
<a id="L170" name="L170"></a> 170                 <strong class="reserved">int</strong> b1 = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == fOffset
<a id="L171" name="L171"></a> 171                        ? fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>() : fBuffer[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] &amp; 0x00FF;
<a id="L172" name="L172"></a> 172                 <strong class="reserved">if</strong> (b1 == -1) <em class="brace">{</em>
<a id="L173" name="L173"></a> 173                     <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(2, 2);
<a id="L174" name="L174"></a> 174                 <em class="brace">}</em>
<a id="L175" name="L175"></a> 175                 <strong class="reserved">if</strong> ((b1 &amp; 0xC0) != 0x80) <em class="brace">{</em>
<a id="L176" name="L176"></a> 176                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(2, 2, b1);
<a id="L177" name="L177"></a> 177                 <em class="brace">}</em>
<a id="L178" name="L178"></a> 178                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ((b0 &lt;&lt; 6) &amp; 0x07C0) | (b1 &amp; 0x003F);
<a id="L179" name="L179"></a> 179             <em class="brace">}</em>
<a id="L180" name="L180"></a> 180 
<a id="L181" name="L181"></a> 181             <em class="comment">// UTF-8:   [1110 zzzz] [10yy yyyy] [10xx xxxx]</em>
<a id="L182" name="L182"></a> 182             <em class="comment">// Unicode: [zzzz yyyy] [yyxx xxxx]</em>
<a id="L183" name="L183"></a> 183             <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((b0 &amp; 0xF0) == 0xE0) <em class="brace">{</em>
<a id="L184" name="L184"></a> 184                 <strong class="reserved">int</strong> b1 = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == fOffset
<a id="L185" name="L185"></a> 185                        ? fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>() : fBuffer[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] &amp; 0x00FF;
<a id="L186" name="L186"></a> 186                 <strong class="reserved">if</strong> (b1 == -1) <em class="brace">{</em>
<a id="L187" name="L187"></a> 187                     <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(2, 3);
<a id="L188" name="L188"></a> 188                 <em class="brace">}</em>
<a id="L189" name="L189"></a> 189                 <strong class="reserved">if</strong> ((b1 &amp; 0xC0) != 0x80
<a id="L190" name="L190"></a> 190                     || (b0 == 0xED &amp;&amp; b1 &gt;= 0xA0)
<a id="L191" name="L191"></a> 191                     || ((b0 &amp; 0x0F) == 0 &amp;&amp; (b1 &amp; 0x20) == 0)) <em class="brace">{</em>
<a id="L192" name="L192"></a> 192                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(2, 3, b1);
<a id="L193" name="L193"></a> 193                 <em class="brace">}</em>
<a id="L194" name="L194"></a> 194                 <strong class="reserved">int</strong> b2 = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == fOffset
<a id="L195" name="L195"></a> 195                        ? fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>() : fBuffer[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] &amp; 0x00FF;
<a id="L196" name="L196"></a> 196                 <strong class="reserved">if</strong> (b2 == -1) <em class="brace">{</em>
<a id="L197" name="L197"></a> 197                     <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(3, 3);
<a id="L198" name="L198"></a> 198                 <em class="brace">}</em>
<a id="L199" name="L199"></a> 199                 <strong class="reserved">if</strong> ((b2 &amp; 0xC0) != 0x80) <em class="brace">{</em>
<a id="L200" name="L200"></a> 200                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(3, 3, b2);
<a id="L201" name="L201"></a> 201                 <em class="brace">}</em>
<a id="L202" name="L202"></a> 202                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ((b0 &lt;&lt; 12) &amp; 0xF000) | ((b1 &lt;&lt; 6) &amp; 0x0FC0) |
<a id="L203" name="L203"></a> 203                     (b2 &amp; 0x003F);
<a id="L204" name="L204"></a> 204             <em class="brace">}</em>
<a id="L205" name="L205"></a> 205 
<a id="L206" name="L206"></a> 206             <em class="comment">// UTF-8:   [1111 0uuu] [10uu zzzz] [10yy yyyy] [10xx xxxx]*</em>
<a id="L207" name="L207"></a> 207             <em class="comment">// Unicode: [1101 10ww] [wwzz zzyy] (high surrogate)</em>
<a id="L208" name="L208"></a> 208             <em class="comment">//          [1101 11yy] [yyxx xxxx] (low surrogate)</em>
<a id="L209" name="L209"></a> 209             <em class="comment">//          * uuuuu = wwww + 1</em>
<a id="L210" name="L210"></a> 210             <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((b0 &amp; 0xF8) == 0xF0) <em class="brace">{</em>
<a id="L211" name="L211"></a> 211                 <strong class="reserved">int</strong> b1 = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == fOffset
<a id="L212" name="L212"></a> 212                        ? fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>() : fBuffer[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] &amp; 0x00FF;
<a id="L213" name="L213"></a> 213                 <strong class="reserved">if</strong> (b1 == -1) <em class="brace">{</em>
<a id="L214" name="L214"></a> 214                     <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(2, 4);
<a id="L215" name="L215"></a> 215                 <em class="brace">}</em>
<a id="L216" name="L216"></a> 216                 <strong class="reserved">if</strong> ((b1 &amp; 0xC0) != 0x80
<a id="L217" name="L217"></a> 217                     || ((b1 &amp; 0x30) == 0 &amp;&amp; (b0 &amp; 0x07) == 0)) <em class="brace">{</em>
<a id="L218" name="L218"></a> 218                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(2, 3, b1);
<a id="L219" name="L219"></a> 219                 <em class="brace">}</em>
<a id="L220" name="L220"></a> 220                 <strong class="reserved">int</strong> b2 = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == fOffset
<a id="L221" name="L221"></a> 221                        ? fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>() : fBuffer[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] &amp; 0x00FF;
<a id="L222" name="L222"></a> 222                 <strong class="reserved">if</strong> (b2 == -1) <em class="brace">{</em>
<a id="L223" name="L223"></a> 223                     <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(3, 4);
<a id="L224" name="L224"></a> 224                 <em class="brace">}</em>
<a id="L225" name="L225"></a> 225                 <strong class="reserved">if</strong> ((b2 &amp; 0xC0) != 0x80) <em class="brace">{</em>
<a id="L226" name="L226"></a> 226                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(3, 3, b2);
<a id="L227" name="L227"></a> 227                 <em class="brace">}</em>
<a id="L228" name="L228"></a> 228                 <strong class="reserved">int</strong> b3 = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == fOffset
<a id="L229" name="L229"></a> 229                        ? fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>() : fBuffer[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] &amp; 0x00FF;
<a id="L230" name="L230"></a> 230                 <strong class="reserved">if</strong> (b3 == -1) <em class="brace">{</em>
<a id="L231" name="L231"></a> 231                     <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(4, 4);
<a id="L232" name="L232"></a> 232                 <em class="brace">}</em>
<a id="L233" name="L233"></a> 233                 <strong class="reserved">if</strong> ((b3 &amp; 0xC0) != 0x80) <em class="brace">{</em>
<a id="L234" name="L234"></a> 234                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(4, 4, b3);
<a id="L235" name="L235"></a> 235                 <em class="brace">}</em>
<a id="L236" name="L236"></a> 236                 <strong class="reserved">int</strong> uuuuu = ((b0 &lt;&lt; 2) &amp; 0x001C) | ((b1 &gt;&gt; 4) &amp; 0x0003);
<a id="L237" name="L237"></a> 237                 <strong class="reserved">if</strong> (uuuuu &gt; 0x10) <em class="brace">{</em>
<a id="L238" name="L238"></a> 238                     <a href="../S/5039.html#L706" title="Defined at 706 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidSurrogate</a>(uuuuu);
<a id="L239" name="L239"></a> 239                 <em class="brace">}</em>
<a id="L240" name="L240"></a> 240                 <strong class="reserved">int</strong> wwww = uuuuu - 1;
<a id="L241" name="L241"></a> 241                 <strong class="reserved">int</strong> hs = 0xD800 |
<a id="L242" name="L242"></a> 242                          ((wwww &lt;&lt; 6) &amp; 0x03C0) | ((b1 &lt;&lt; 2) &amp; 0x003C) |
<a id="L243" name="L243"></a> 243                          ((b2 &gt;&gt; 4) &amp; 0x0003);
<a id="L244" name="L244"></a> 244                 <strong class="reserved">int</strong> ls = 0xDC00 | ((b2 &lt;&lt; 6) &amp; 0x03C0) | (b3 &amp; 0x003F);
<a id="L245" name="L245"></a> 245                 <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = hs;
<a id="L246" name="L246"></a> 246                 fSurrogate = ls;
<a id="L247" name="L247"></a> 247             <em class="brace">}</em>
<a id="L248" name="L248"></a> 248 
<a id="L249" name="L249"></a> 249             <em class="comment">// error</em>
<a id="L250" name="L250"></a> 250             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L251" name="L251"></a> 251                 <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(1, 1, b0);
<a id="L252" name="L252"></a> 252             <em class="brace">}</em>
<a id="L253" name="L253"></a> 253         <em class="brace">}</em>
<a id="L254" name="L254"></a> 254 
<a id="L255" name="L255"></a> 255         <em class="comment">// use surrogate</em>
<a id="L256" name="L256"></a> 256         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L257" name="L257"></a> 257             fSurrogate = -1;
<a id="L258" name="L258"></a> 258         <em class="brace">}</em>
<a id="L259" name="L259"></a> 259 
<a id="L260" name="L260"></a> 260         <em class="comment">// return character</em>
<a id="L261" name="L261"></a> 261         <strong class="reserved">if</strong> (DEBUG_READ) <em class="brace">{</em>
<a id="L262" name="L262"></a> 262             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("read(): 0x"+<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35410.html" title="Multiple defined in 5 places.">toHexString</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>));
<a id="L263" name="L263"></a> 263         <em class="brace">}</em>
<a id="L264" name="L264"></a> 264         <strong class="reserved">return</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L265" name="L265"></a> 265 
<a id="L266" name="L266"></a> 266     <em class="brace">}</em> <em class="comment">// read():int</em>
<a id="L267" name="L267"></a> 267 
<div class="comment">
      Read characters into a portion of an array.  This method will block
      until some input is available, an I/O error occurs, or the end of the
      stream is reached.
      @param      ch     Destination buffer
      @param      offset Offset at which to start storing characters
      @param      length Maximum number of characters to read
      @return     The number of characters read, or -1 if the end of the
                  stream has been reached
      @exception  IOException  If an I/O error occurs</div>
<a id="L282" name="L282"></a> 282     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/25407.html" title="Multiple referred from 1300 places.">read</a>(<strong class="reserved">char</strong> ch[], <strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L283" name="L283"></a> 283 
<a id="L284" name="L284"></a> 284         <em class="comment">// handle surrogate</em>
<a id="L285" name="L285"></a> 285         <strong class="reserved">int</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> = <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L286" name="L286"></a> 286         <strong class="reserved">if</strong> (fSurrogate != -1) <em class="brace">{</em>
<a id="L287" name="L287"></a> 287             ch[<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> + 1] = (<strong class="reserved">char</strong>)fSurrogate;
<a id="L288" name="L288"></a> 288             fSurrogate = -1;
<a id="L289" name="L289"></a> 289             <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>--;
<a id="L290" name="L290"></a> 290             <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>++;
<a id="L291" name="L291"></a> 291         <em class="brace">}</em>
<a id="L292" name="L292"></a> 292 
<a id="L293" name="L293"></a> 293         <em class="comment">// read bytes</em>
<a id="L294" name="L294"></a> 294         <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L295" name="L295"></a> 295         <strong class="reserved">if</strong> (fOffset == 0) <em class="brace">{</em>
<a id="L296" name="L296"></a> 296             <em class="comment">// adjust length to read</em>
<a id="L297" name="L297"></a> 297             <strong class="reserved">if</strong> (<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; fBuffer.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L298" name="L298"></a> 298                 <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> = fBuffer.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L299" name="L299"></a> 299             <em class="brace">}</em>
<a id="L300" name="L300"></a> 300 
<a id="L301" name="L301"></a> 301             <em class="comment">// perform read operation</em>
<a id="L302" name="L302"></a> 302             <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(fBuffer, 0, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L303" name="L303"></a> 303             <strong class="reserved">if</strong> (<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> == -1) <em class="brace">{</em>
<a id="L304" name="L304"></a> 304                 <strong class="reserved">return</strong> -1;
<a id="L305" name="L305"></a> 305             <em class="brace">}</em>
<a id="L306" name="L306"></a> 306             <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> += <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L307" name="L307"></a> 307         <em class="brace">}</em>
<a id="L308" name="L308"></a> 308 
<a id="L309" name="L309"></a> 309         <em class="comment">// skip read; last character was in error</em>
<a id="L310" name="L310"></a> 310         <em class="comment">// NOTE: Having an offset value other than zero means that there was</em>
<a id="L311" name="L311"></a> 311         <em class="comment">//       an error in the last character read. In this case, we have</em>
<a id="L312" name="L312"></a> 312         <em class="comment">//       skipped the read so we don't consume any bytes past the</em>
<a id="L313" name="L313"></a> 313         <em class="comment">//       error. By signalling the error on the next block read we</em>
<a id="L314" name="L314"></a> 314         <em class="comment">//       allow the method to return the most valid characters that</em>
<a id="L315" name="L315"></a> 315         <em class="comment">//       it can on the previous block read. -Ac</em>
<a id="L316" name="L316"></a> 316         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L317" name="L317"></a> 317             <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = fOffset;
<a id="L318" name="L318"></a> 318             fOffset = 0;
<a id="L319" name="L319"></a> 319         <em class="brace">}</em>
<a id="L320" name="L320"></a> 320 
<a id="L321" name="L321"></a> 321         <em class="comment">// convert bytes to characters</em>
<a id="L322" name="L322"></a> 322         <strong class="reserved">final</strong> <strong class="reserved">int</strong> total = <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;
<a id="L323" name="L323"></a> 323         <strong class="reserved">int</strong> <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>;
<a id="L324" name="L324"></a> 324         <strong class="reserved">byte</strong> byte1;
<a id="L325" name="L325"></a> 325         <strong class="reserved">final</strong> <strong class="reserved">byte</strong> byte0 = 0;
<a id="L326" name="L326"></a> 326         <strong class="reserved">for</strong> (<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> = 0; <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> &lt; total; <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>++) <em class="brace">{</em>
<a id="L327" name="L327"></a> 327             byte1 = fBuffer[<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>];
<a id="L328" name="L328"></a> 328             <strong class="reserved">if</strong> (byte1 &gt;= byte0) <em class="brace">{</em>
<a id="L329" name="L329"></a> 329                 ch[<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>++] = (<strong class="reserved">char</strong>)byte1;
<a id="L330" name="L330"></a> 330             <em class="brace">}</em>
<a id="L331" name="L331"></a> 331             <strong class="reserved">else</strong>   <em class="brace">{</em>
<a id="L332" name="L332"></a> 332                 <strong class="reserved">break</strong>;
<a id="L333" name="L333"></a> 333             <em class="brace">}</em>
<a id="L334" name="L334"></a> 334         <em class="brace">}</em>
<a id="L335" name="L335"></a> 335         <strong class="reserved">for</strong> ( ; <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> &lt; total; <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>++) <em class="brace">{</em>
<a id="L336" name="L336"></a> 336             byte1 = fBuffer[<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>];
<a id="L337" name="L337"></a> 337 
<a id="L338" name="L338"></a> 338             <em class="comment">// UTF-8:   [0xxx xxxx]</em>
<a id="L339" name="L339"></a> 339             <em class="comment">// Unicode: [0000 0000] [0xxx xxxx]</em>
<a id="L340" name="L340"></a> 340             <strong class="reserved">if</strong> (byte1 &gt;= byte0) <em class="brace">{</em>
<a id="L341" name="L341"></a> 341                 ch[<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>++] = (<strong class="reserved">char</strong>)byte1;
<a id="L342" name="L342"></a> 342                 <strong class="reserved">continue</strong>;
<a id="L343" name="L343"></a> 343             <em class="brace">}</em>
<a id="L344" name="L344"></a> 344 
<a id="L345" name="L345"></a> 345             <em class="comment">// UTF-8:   [110y yyyy] [10xx xxxx]</em>
<a id="L346" name="L346"></a> 346             <em class="comment">// Unicode: [0000 0yyy] [yyxx xxxx]</em>
<a id="L347" name="L347"></a> 347             <strong class="reserved">int</strong> b0 = byte1 &amp; 0x0FF;
<a id="L348" name="L348"></a> 348             <strong class="reserved">if</strong> ((b0 &amp; 0xE0) == 0xC0 &amp;&amp; (b0 &amp; 0x1E) != 0) <em class="brace">{</em>
<a id="L349" name="L349"></a> 349                 <strong class="reserved">int</strong> b1 = -1;
<a id="L350" name="L350"></a> 350                 <strong class="reserved">if</strong> (++<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> &lt; total) <em class="brace">{</em>
<a id="L351" name="L351"></a> 351                     b1 = fBuffer[<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>] &amp; 0x00FF;
<a id="L352" name="L352"></a> 352                 <em class="brace">}</em>
<a id="L353" name="L353"></a> 353                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L354" name="L354"></a> 354                     b1 = fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>();
<a id="L355" name="L355"></a> 355                     <strong class="reserved">if</strong> (b1 == -1) <em class="brace">{</em>
<a id="L356" name="L356"></a> 356                         <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L357" name="L357"></a> 357                             fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L358" name="L358"></a> 358                             fOffset = 1;
<a id="L359" name="L359"></a> 359                             <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L360" name="L360"></a> 360                         <em class="brace">}</em>
<a id="L361" name="L361"></a> 361                         <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(2, 2);
<a id="L362" name="L362"></a> 362                     <em class="brace">}</em>
<a id="L363" name="L363"></a> 363                     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++;
<a id="L364" name="L364"></a> 364                 <em class="brace">}</em>
<a id="L365" name="L365"></a> 365                 <strong class="reserved">if</strong> ((b1 &amp; 0xC0) != 0x80) <em class="brace">{</em>
<a id="L366" name="L366"></a> 366                     <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L367" name="L367"></a> 367                         fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L368" name="L368"></a> 368                         fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L369" name="L369"></a> 369                         fOffset = 2;
<a id="L370" name="L370"></a> 370                         <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L371" name="L371"></a> 371                     <em class="brace">}</em>
<a id="L372" name="L372"></a> 372                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(2, 2, b1);
<a id="L373" name="L373"></a> 373                 <em class="brace">}</em>
<a id="L374" name="L374"></a> 374                 <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ((b0 &lt;&lt; 6) &amp; 0x07C0) | (b1 &amp; 0x003F);
<a id="L375" name="L375"></a> 375                 ch[<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>++] = (<strong class="reserved">char</strong>)<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L376" name="L376"></a> 376                 <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> -= 1;
<a id="L377" name="L377"></a> 377                 <strong class="reserved">continue</strong>;
<a id="L378" name="L378"></a> 378             <em class="brace">}</em>
<a id="L379" name="L379"></a> 379 
<a id="L380" name="L380"></a> 380             <em class="comment">// UTF-8:   [1110 zzzz] [10yy yyyy] [10xx xxxx]</em>
<a id="L381" name="L381"></a> 381             <em class="comment">// Unicode: [zzzz yyyy] [yyxx xxxx]</em>
<a id="L382" name="L382"></a> 382             <strong class="reserved">if</strong> ((b0 &amp; 0xF0) == 0xE0) <em class="brace">{</em>
<a id="L383" name="L383"></a> 383                 <strong class="reserved">int</strong> b1 = -1;
<a id="L384" name="L384"></a> 384                 <strong class="reserved">if</strong> (++<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> &lt; total) <em class="brace">{</em>
<a id="L385" name="L385"></a> 385                     b1 = fBuffer[<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>] &amp; 0x00FF;
<a id="L386" name="L386"></a> 386                 <em class="brace">}</em>
<a id="L387" name="L387"></a> 387                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L388" name="L388"></a> 388                     b1 = fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>();
<a id="L389" name="L389"></a> 389                     <strong class="reserved">if</strong> (b1 == -1) <em class="brace">{</em>
<a id="L390" name="L390"></a> 390                         <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L391" name="L391"></a> 391                             fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L392" name="L392"></a> 392                             fOffset = 1;
<a id="L393" name="L393"></a> 393                             <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L394" name="L394"></a> 394                         <em class="brace">}</em>
<a id="L395" name="L395"></a> 395                         <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(2, 3);
<a id="L396" name="L396"></a> 396                     <em class="brace">}</em>
<a id="L397" name="L397"></a> 397                     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++;
<a id="L398" name="L398"></a> 398                 <em class="brace">}</em>
<a id="L399" name="L399"></a> 399                 <strong class="reserved">if</strong> ((b1 &amp; 0xC0) != 0x80
<a id="L400" name="L400"></a> 400                     || (b0 == 0xED &amp;&amp; b1 &gt;= 0xA0)
<a id="L401" name="L401"></a> 401                     || ((b0 &amp; 0x0F) == 0 &amp;&amp; (b1 &amp; 0x20) == 0)) <em class="brace">{</em>
<a id="L402" name="L402"></a> 402                     <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L403" name="L403"></a> 403                         fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L404" name="L404"></a> 404                         fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L405" name="L405"></a> 405                         fOffset = 2;
<a id="L406" name="L406"></a> 406                         <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L407" name="L407"></a> 407                     <em class="brace">}</em>
<a id="L408" name="L408"></a> 408                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(2, 3, b1);
<a id="L409" name="L409"></a> 409                 <em class="brace">}</em>
<a id="L410" name="L410"></a> 410                 <strong class="reserved">int</strong> b2 = -1;
<a id="L411" name="L411"></a> 411                 <strong class="reserved">if</strong> (++<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> &lt; total) <em class="brace">{</em>
<a id="L412" name="L412"></a> 412                     b2 = fBuffer[<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>] &amp; 0x00FF;
<a id="L413" name="L413"></a> 413                 <em class="brace">}</em>
<a id="L414" name="L414"></a> 414                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L415" name="L415"></a> 415                     b2 = fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>();
<a id="L416" name="L416"></a> 416                     <strong class="reserved">if</strong> (b2 == -1) <em class="brace">{</em>
<a id="L417" name="L417"></a> 417                         <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L418" name="L418"></a> 418                             fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L419" name="L419"></a> 419                             fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L420" name="L420"></a> 420                             fOffset = 2;
<a id="L421" name="L421"></a> 421                             <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L422" name="L422"></a> 422                         <em class="brace">}</em>
<a id="L423" name="L423"></a> 423                         <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(3, 3);
<a id="L424" name="L424"></a> 424                     <em class="brace">}</em>
<a id="L425" name="L425"></a> 425                     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++;
<a id="L426" name="L426"></a> 426                 <em class="brace">}</em>
<a id="L427" name="L427"></a> 427                 <strong class="reserved">if</strong> ((b2 &amp; 0xC0) != 0x80) <em class="brace">{</em>
<a id="L428" name="L428"></a> 428                     <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L429" name="L429"></a> 429                         fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L430" name="L430"></a> 430                         fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L431" name="L431"></a> 431                         fBuffer[2] = (<strong class="reserved">byte</strong>)b2;
<a id="L432" name="L432"></a> 432                         fOffset = 3;
<a id="L433" name="L433"></a> 433                         <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L434" name="L434"></a> 434                     <em class="brace">}</em>
<a id="L435" name="L435"></a> 435                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(3, 3, b2);
<a id="L436" name="L436"></a> 436                 <em class="brace">}</em>
<a id="L437" name="L437"></a> 437                 <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = ((b0 &lt;&lt; 12) &amp; 0xF000) | ((b1 &lt;&lt; 6) &amp; 0x0FC0) |
<a id="L438" name="L438"></a> 438                         (b2 &amp; 0x003F);
<a id="L439" name="L439"></a> 439                 ch[<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>++] = (<strong class="reserved">char</strong>)<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L440" name="L440"></a> 440                 <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> -= 2;
<a id="L441" name="L441"></a> 441                 <strong class="reserved">continue</strong>;
<a id="L442" name="L442"></a> 442             <em class="brace">}</em>
<a id="L443" name="L443"></a> 443 
<a id="L444" name="L444"></a> 444             <em class="comment">// UTF-8:   [1111 0uuu] [10uu zzzz] [10yy yyyy] [10xx xxxx]*</em>
<a id="L445" name="L445"></a> 445             <em class="comment">// Unicode: [1101 10ww] [wwzz zzyy] (high surrogate)</em>
<a id="L446" name="L446"></a> 446             <em class="comment">//          [1101 11yy] [yyxx xxxx] (low surrogate)</em>
<a id="L447" name="L447"></a> 447             <em class="comment">//          * uuuuu = wwww + 1</em>
<a id="L448" name="L448"></a> 448             <strong class="reserved">if</strong> ((b0 &amp; 0xF8) == 0xF0) <em class="brace">{</em>
<a id="L449" name="L449"></a> 449                 <strong class="reserved">int</strong> b1 = -1;
<a id="L450" name="L450"></a> 450                 <strong class="reserved">if</strong> (++<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> &lt; total) <em class="brace">{</em>
<a id="L451" name="L451"></a> 451                     b1 = fBuffer[<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>] &amp; 0x00FF;
<a id="L452" name="L452"></a> 452                 <em class="brace">}</em>
<a id="L453" name="L453"></a> 453                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L454" name="L454"></a> 454                     b1 = fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>();
<a id="L455" name="L455"></a> 455                     <strong class="reserved">if</strong> (b1 == -1) <em class="brace">{</em>
<a id="L456" name="L456"></a> 456                         <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L457" name="L457"></a> 457                             fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L458" name="L458"></a> 458                             fOffset = 1;
<a id="L459" name="L459"></a> 459                             <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L460" name="L460"></a> 460                         <em class="brace">}</em>
<a id="L461" name="L461"></a> 461                         <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(2, 4);
<a id="L462" name="L462"></a> 462                     <em class="brace">}</em>
<a id="L463" name="L463"></a> 463                     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++;
<a id="L464" name="L464"></a> 464                 <em class="brace">}</em>
<a id="L465" name="L465"></a> 465                 <strong class="reserved">if</strong> ((b1 &amp; 0xC0) != 0x80
<a id="L466" name="L466"></a> 466                     || ((b1 &amp; 0x30) == 0 &amp;&amp; (b0 &amp; 0x07) == 0)) <em class="brace">{</em>
<a id="L467" name="L467"></a> 467                     <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L468" name="L468"></a> 468                         fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L469" name="L469"></a> 469                         fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L470" name="L470"></a> 470                         fOffset = 2;
<a id="L471" name="L471"></a> 471                         <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L472" name="L472"></a> 472                     <em class="brace">}</em>
<a id="L473" name="L473"></a> 473                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(2, 4, b1);
<a id="L474" name="L474"></a> 474                 <em class="brace">}</em>
<a id="L475" name="L475"></a> 475                 <strong class="reserved">int</strong> b2 = -1;
<a id="L476" name="L476"></a> 476                 <strong class="reserved">if</strong> (++<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> &lt; total) <em class="brace">{</em>
<a id="L477" name="L477"></a> 477                     b2 = fBuffer[<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>] &amp; 0x00FF;
<a id="L478" name="L478"></a> 478                 <em class="brace">}</em>
<a id="L479" name="L479"></a> 479                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L480" name="L480"></a> 480                     b2 = fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>();
<a id="L481" name="L481"></a> 481                     <strong class="reserved">if</strong> (b2 == -1) <em class="brace">{</em>
<a id="L482" name="L482"></a> 482                         <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L483" name="L483"></a> 483                             fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L484" name="L484"></a> 484                             fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L485" name="L485"></a> 485                             fOffset = 2;
<a id="L486" name="L486"></a> 486                             <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L487" name="L487"></a> 487                         <em class="brace">}</em>
<a id="L488" name="L488"></a> 488                         <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(3, 4);
<a id="L489" name="L489"></a> 489                     <em class="brace">}</em>
<a id="L490" name="L490"></a> 490                     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++;
<a id="L491" name="L491"></a> 491                 <em class="brace">}</em>
<a id="L492" name="L492"></a> 492                 <strong class="reserved">if</strong> ((b2 &amp; 0xC0) != 0x80) <em class="brace">{</em>
<a id="L493" name="L493"></a> 493                     <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L494" name="L494"></a> 494                         fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L495" name="L495"></a> 495                         fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L496" name="L496"></a> 496                         fBuffer[2] = (<strong class="reserved">byte</strong>)b2;
<a id="L497" name="L497"></a> 497                         fOffset = 3;
<a id="L498" name="L498"></a> 498                         <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L499" name="L499"></a> 499                     <em class="brace">}</em>
<a id="L500" name="L500"></a> 500                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(3, 4, b2);
<a id="L501" name="L501"></a> 501                 <em class="brace">}</em>
<a id="L502" name="L502"></a> 502                 <strong class="reserved">int</strong> b3 = -1;
<a id="L503" name="L503"></a> 503                 <strong class="reserved">if</strong> (++<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a> &lt; total) <em class="brace">{</em>
<a id="L504" name="L504"></a> 504                     b3 = fBuffer[<a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>] &amp; 0x00FF;
<a id="L505" name="L505"></a> 505                 <em class="brace">}</em>
<a id="L506" name="L506"></a> 506                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L507" name="L507"></a> 507                     b3 = fInputStream.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>();
<a id="L508" name="L508"></a> 508                     <strong class="reserved">if</strong> (b3 == -1) <em class="brace">{</em>
<a id="L509" name="L509"></a> 509                         <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L510" name="L510"></a> 510                             fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L511" name="L511"></a> 511                             fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L512" name="L512"></a> 512                             fBuffer[2] = (<strong class="reserved">byte</strong>)b2;
<a id="L513" name="L513"></a> 513                             fOffset = 3;
<a id="L514" name="L514"></a> 514                             <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L515" name="L515"></a> 515                         <em class="brace">}</em>
<a id="L516" name="L516"></a> 516                         <a href="../S/5039.html#L682" title="Defined at 682 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">expectedByte</a>(4, 4);
<a id="L517" name="L517"></a> 517                     <em class="brace">}</em>
<a id="L518" name="L518"></a> 518                     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++;
<a id="L519" name="L519"></a> 519                 <em class="brace">}</em>
<a id="L520" name="L520"></a> 520                 <strong class="reserved">if</strong> ((b3 &amp; 0xC0) != 0x80) <em class="brace">{</em>
<a id="L521" name="L521"></a> 521                     <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L522" name="L522"></a> 522                         fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L523" name="L523"></a> 523                         fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L524" name="L524"></a> 524                         fBuffer[2] = (<strong class="reserved">byte</strong>)b2;
<a id="L525" name="L525"></a> 525                         fBuffer[3] = (<strong class="reserved">byte</strong>)b3;
<a id="L526" name="L526"></a> 526                         fOffset = 4;
<a id="L527" name="L527"></a> 527                         <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L528" name="L528"></a> 528                     <em class="brace">}</em>
<a id="L529" name="L529"></a> 529                     <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(4, 4, b2);
<a id="L530" name="L530"></a> 530                 <em class="brace">}</em>
<a id="L531" name="L531"></a> 531 
<a id="L532" name="L532"></a> 532                 <em class="comment">// check if output buffer is large enough to hold 2 surrogate chars</em>
<a id="L533" name="L533"></a> 533                 <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> + 1 &gt;= ch.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L534" name="L534"></a> 534                     fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L535" name="L535"></a> 535                     fBuffer[1] = (<strong class="reserved">byte</strong>)b1;
<a id="L536" name="L536"></a> 536                     fBuffer[2] = (<strong class="reserved">byte</strong>)b2;
<a id="L537" name="L537"></a> 537                     fBuffer[3] = (<strong class="reserved">byte</strong>)b3;
<a id="L538" name="L538"></a> 538                     fOffset = 4;
<a id="L539" name="L539"></a> 539                     <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L540" name="L540"></a> 540                 <em class="brace">}</em>
<a id="L541" name="L541"></a> 541 
<a id="L542" name="L542"></a> 542                 <em class="comment">// decode bytes into surrogate characters</em>
<a id="L543" name="L543"></a> 543                 <strong class="reserved">int</strong> uuuuu = ((b0 &lt;&lt; 2) &amp; 0x001C) | ((b1 &gt;&gt; 4) &amp; 0x0003);
<a id="L544" name="L544"></a> 544                 <strong class="reserved">if</strong> (uuuuu &gt; 0x10) <em class="brace">{</em>
<a id="L545" name="L545"></a> 545                     <a href="../S/5039.html#L706" title="Defined at 706 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidSurrogate</a>(uuuuu);
<a id="L546" name="L546"></a> 546                 <em class="brace">}</em>
<a id="L547" name="L547"></a> 547                 <strong class="reserved">int</strong> wwww = uuuuu - 1;
<a id="L548" name="L548"></a> 548                 <strong class="reserved">int</strong> zzzz = b1 &amp; 0x000F;
<a id="L549" name="L549"></a> 549                 <strong class="reserved">int</strong> yyyyyy = b2 &amp; 0x003F;
<a id="L550" name="L550"></a> 550                 <strong class="reserved">int</strong> xxxxxx = b3 &amp; 0x003F;
<a id="L551" name="L551"></a> 551                 <strong class="reserved">int</strong> hs = 0xD800 | ((wwww &lt;&lt; 6) &amp; 0x03C0) | (zzzz &lt;&lt; 2) | (yyyyyy &gt;&gt; 4);
<a id="L552" name="L552"></a> 552                 <strong class="reserved">int</strong> ls = 0xDC00 | ((yyyyyy &lt;&lt; 6) &amp; 0x03C0) | xxxxxx;
<a id="L553" name="L553"></a> 553 
<a id="L554" name="L554"></a> 554                 <em class="comment">// set characters</em>
<a id="L555" name="L555"></a> 555                 ch[<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>++] = (<strong class="reserved">char</strong>)hs;
<a id="L556" name="L556"></a> 556                 ch[<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>++] = (<strong class="reserved">char</strong>)ls;
<a id="L557" name="L557"></a> 557                 <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> -= 2;
<a id="L558" name="L558"></a> 558                 <strong class="reserved">continue</strong>;
<a id="L559" name="L559"></a> 559             <em class="brace">}</em>
<a id="L560" name="L560"></a> 560 
<a id="L561" name="L561"></a> 561             <em class="comment">// error</em>
<a id="L562" name="L562"></a> 562             <strong class="reserved">if</strong> (<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> &gt; <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L563" name="L563"></a> 563                 fBuffer[0] = (<strong class="reserved">byte</strong>)b0;
<a id="L564" name="L564"></a> 564                 fOffset = 1;
<a id="L565" name="L565"></a> 565                 <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> - <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L566" name="L566"></a> 566             <em class="brace">}</em>
<a id="L567" name="L567"></a> 567             <a href="../S/5039.html#L694" title="Defined at 694 in src/com/sun/org/apache/xerces/internal/impl/io/UTF8Reader.java.">invalidByte</a>(1, 1, b0);
<a id="L568" name="L568"></a> 568         <em class="brace">}</em>
<a id="L569" name="L569"></a> 569 
<a id="L570" name="L570"></a> 570         <em class="comment">// return number of characters converted</em>
<a id="L571" name="L571"></a> 571         <strong class="reserved">if</strong> (DEBUG_READ) <em class="brace">{</em>
<a id="L572" name="L572"></a> 572             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("read(char[],"+<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>+','+<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>+"): count="+<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>);
<a id="L573" name="L573"></a> 573         <em class="brace">}</em>
<a id="L574" name="L574"></a> 574         <strong class="reserved">return</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;
<a id="L575" name="L575"></a> 575 
<a id="L576" name="L576"></a> 576     <em class="brace">}</em> <em class="comment">// read(char[],int,int)</em>
<a id="L577" name="L577"></a> 577 
<div class="comment">
      Skip characters.  This method will block until some characters are
      available, an I/O error occurs, or the end of the stream is reached.
      @param  n  The number of characters to skip
      @return    The number of characters actually skipped
      @exception  IOException  If an I/O error occurs</div>
<a id="L588" name="L588"></a> 588     <strong class="reserved">public</strong> <strong class="reserved">long</strong> <a href="../R/28643.html" title="Multiple referred from 174 places.">skip</a>(<strong class="reserved">long</strong> n) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L589" name="L589"></a> 589 
<a id="L590" name="L590"></a> 590         <strong class="reserved">long</strong> <a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a> = n;
<a id="L591" name="L591"></a> 591         <strong class="reserved">final</strong> <strong class="reserved">char</strong>[] ch = <strong class="reserved">new</strong> <strong class="reserved">char</strong>[fBuffer.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L592" name="L592"></a> 592         <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L593" name="L593"></a> 593             <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> = ch.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &lt; <a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a> ? ch.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> : (<strong class="reserved">int</strong>)<a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a>;
<a id="L594" name="L594"></a> 594             <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = <a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>(ch, 0, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L595" name="L595"></a> 595             <strong class="reserved">if</strong> (<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> &gt; 0) <em class="brace">{</em>
<a id="L596" name="L596"></a> 596                 <a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a> -= <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;
<a id="L597" name="L597"></a> 597             <em class="brace">}</em>
<a id="L598" name="L598"></a> 598             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L599" name="L599"></a> 599                 <strong class="reserved">break</strong>;
<a id="L600" name="L600"></a> 600             <em class="brace">}</em>
<a id="L601" name="L601"></a> 601         <em class="brace">}</em> <strong class="reserved">while</strong> (<a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a> &gt; 0);
<a id="L602" name="L602"></a> 602 
<a id="L603" name="L603"></a> 603         <strong class="reserved">long</strong> <a href="../S/1947.html#L101" title="Defined at 101 in src/java/nio/file/FileTreeWalker.java.">skipped</a> = n - <a href="../S/1990.html#L390" title="Defined at 390 in src/java/nio/Buffer.java.">remaining</a>;
<a id="L604" name="L604"></a> 604         <strong class="reserved">return</strong> <a href="../S/1947.html#L101" title="Defined at 101 in src/java/nio/file/FileTreeWalker.java.">skipped</a>;
<a id="L605" name="L605"></a> 605 
<a id="L606" name="L606"></a> 606     <em class="brace">}</em> <em class="comment">// skip(long):long</em>
<a id="L607" name="L607"></a> 607 
<div class="comment">
      Tell whether this stream is ready to be read.
      @return True if the next read() is guaranteed not to block for input,
      false otherwise.  Note that returning false does not guarantee that the
      next read will block.
      @exception  IOException  If an I/O error occurs</div>
<a id="L617" name="L617"></a> 617     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/25626.html" title="Multiple referred from 11 places.">ready</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L618" name="L618"></a> 618         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L619" name="L619"></a> 619     <em class="brace">}</em> <em class="comment">// ready()</em>
<a id="L620" name="L620"></a> 620 
<div class="comment">
      Tell whether this stream supports the mark() operation.</div>
<a id="L624" name="L624"></a> 624     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/23104.html" title="Multiple referred from 12 places.">markSupported</a>() <em class="brace">{</em>
<a id="L625" name="L625"></a> 625         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L626" name="L626"></a> 626     <em class="brace">}</em> <em class="comment">// markSupported()</em>
<a id="L627" name="L627"></a> 627 
<div class="comment">
      Mark the present position in the stream.  Subsequent calls to reset()
      will attempt to reposition the stream to this point.  Not all
      character-input streams support the mark() operation.
      @param  readAheadLimit  Limit on the number of characters that may be
                              read while still preserving the mark.  After
                              reading this many characters, attempting to
                              reset the stream may fail.
      @exception  IOException  If the stream does not support mark(),
                               or if some other I/O error occurs</div>
<a id="L641" name="L641"></a> 641     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/23088.html" title="Multiple referred from 334 places.">mark</a>(<strong class="reserved">int</strong> readAheadLimit) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L642" name="L642"></a> 642         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>(fFormatter.<a href="../D/16540.html" title="Multiple defined in 20 places.">formatMessage</a>(fLocale, "OperationNotSupported", <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>"mark()", "UTF-8"<em class="brace">}</em>));
<a id="L643" name="L643"></a> 643     <em class="brace">}</em> <em class="comment">// mark(int)</em>
<a id="L644" name="L644"></a> 644 
<div class="comment">
      Reset the stream.  If the stream has been marked, then attempt to
      reposition it at the mark.  If the stream has not been marked, then
      attempt to reset it in some way appropriate to the particular stream,
      for example by repositioning it to its starting point.  Not all
      character-input streams support the reset() operation, and some support
      reset() without supporting mark().
      @exception  IOException  If the stream has not been marked,
                               or if the mark has been invalidated,
                               or if the stream does not support reset(),
                               or if some other I/O error occurs</div>
<a id="L658" name="L658"></a> 658     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26238.html" title="Multiple referred from 619 places.">reset</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L659" name="L659"></a> 659         fOffset = 0;
<a id="L660" name="L660"></a> 660         fSurrogate = -1;
<a id="L661" name="L661"></a> 661     <em class="brace">}</em> <em class="comment">// reset()</em>
<a id="L662" name="L662"></a> 662 
<div class="comment">
      Close the stream.  Once a stream has been closed, further read(),
      ready(), mark(), or reset() invocations will throw an IOException.
      Closing a previously-closed stream, however, has no effect.
      @exception  IOException  If an I/O error occurs</div>
<a id="L670" name="L670"></a> 670     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11587.html" title="Multiple referred from 410 places.">close</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L671" name="L671"></a> 671         BufferAllocator ba = ThreadLocalBufferAllocator.getBufferAllocator();
<a id="L672" name="L672"></a> 672         ba.returnByteBuffer(fBuffer);
<a id="L673" name="L673"></a> 673         fBuffer = <strong class="reserved">null</strong>;
<a id="L674" name="L674"></a> 674         fInputStream.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L675" name="L675"></a> 675     <em class="brace">}</em> <em class="comment">// close()</em>
<a id="L676" name="L676"></a> 676 
<a id="L677" name="L677"></a> 677     <em class="comment">//</em>
<a id="L678" name="L678"></a> 678     <em class="comment">// Private methods</em>
<a id="L679" name="L679"></a> 679     <em class="comment">//</em>
<a id="L680" name="L680"></a> 680 
<div class="comment">
     /** Throws an exception for expected byte. */</div>
<a id="L682" name="L682"></a> 682     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/14149.html" title="Multiple referred from 12 places.">expectedByte</a>(<strong class="reserved">int</strong> <a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>, <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>)
<a id="L683" name="L683"></a> 683         <strong class="reserved">throws</strong> <a href="../S/5037.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/impl/io/MalformedByteSequenceException.java.">MalformedByteSequenceException</a> <em class="brace">{</em>
<a id="L684" name="L684"></a> 684 
<a id="L685" name="L685"></a> 685         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5037.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/impl/io/MalformedByteSequenceException.java.">MalformedByteSequenceException</a>(fFormatter,
<a id="L686" name="L686"></a> 686             fLocale,
<a id="L687" name="L687"></a> 687             <a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XML_DOMAIN,
<a id="L688" name="L688"></a> 688             "ExpectedByte",
<a id="L689" name="L689"></a> 689             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <em class="brace">{</em><a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>), <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>)<em class="brace">}</em>);
<a id="L690" name="L690"></a> 690 
<a id="L691" name="L691"></a> 691     <em class="brace">}</em> <em class="comment">// expectedByte(int,int)</em>
<a id="L692" name="L692"></a> 692 
<div class="comment">
     /** Throws an exception for invalid byte. */</div>
<a id="L694" name="L694"></a> 694     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/20997.html" title="Multiple referred from 14 places.">invalidByte</a>(<strong class="reserved">int</strong> <a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>, <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>, <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)
<a id="L695" name="L695"></a> 695         <strong class="reserved">throws</strong> <a href="../S/5037.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/impl/io/MalformedByteSequenceException.java.">MalformedByteSequenceException</a> <em class="brace">{</em>
<a id="L696" name="L696"></a> 696 
<a id="L697" name="L697"></a> 697         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5037.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/impl/io/MalformedByteSequenceException.java.">MalformedByteSequenceException</a>(fFormatter,
<a id="L698" name="L698"></a> 698             fLocale,
<a id="L699" name="L699"></a> 699             <a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XML_DOMAIN,
<a id="L700" name="L700"></a> 700             "InvalidByte",
<a id="L701" name="L701"></a> 701             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> [] <em class="brace">{</em><a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>), <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>)<em class="brace">}</em>);
<a id="L702" name="L702"></a> 702 
<a id="L703" name="L703"></a> 703     <em class="brace">}</em> <em class="comment">// invalidByte(int,int,int)</em>
<a id="L704" name="L704"></a> 704 
<div class="comment">
     /** Throws an exception for invalid surrogate bits. */</div>
<a id="L706" name="L706"></a> 706     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/21024.html" title="Multiple referred from 2 places.">invalidSurrogate</a>(<strong class="reserved">int</strong> uuuuu) <strong class="reserved">throws</strong> <a href="../S/5037.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/impl/io/MalformedByteSequenceException.java.">MalformedByteSequenceException</a> <em class="brace">{</em>
<a id="L707" name="L707"></a> 707 
<a id="L708" name="L708"></a> 708         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5037.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/impl/io/MalformedByteSequenceException.java.">MalformedByteSequenceException</a>(fFormatter,
<a id="L709" name="L709"></a> 709             fLocale,
<a id="L710" name="L710"></a> 710             <a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XML_DOMAIN,
<a id="L711" name="L711"></a> 711             "InvalidHighSurrogate",
<a id="L712" name="L712"></a> 712             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <em class="brace">{</em><a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35410.html" title="Multiple defined in 5 places.">toHexString</a>(uuuuu)<em class="brace">}</em>);
<a id="L713" name="L713"></a> 713 
<a id="L714" name="L714"></a> 714     <em class="brace">}</em> <em class="comment">// invalidSurrogate(int)</em>
<a id="L715" name="L715"></a> 715 
<a id="L716" name="L716"></a> 716 <em class="brace">}</em> <em class="comment">// class UTF8Reader</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L145">[^]</a><a href="#L706">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>