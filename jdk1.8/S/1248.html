<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/security/AccessController.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L298">[^]</a><a href="#L848">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L298" title="Defined at 298.">doPrivileged</a></li>
<li><a href="#L326" title="Defined at 326.">doPrivilegedWithCombiner</a></li>
<li><a href="#L371" title="Defined at 371.">doPrivileged</a></li>
<li><a href="#L420" title="Defined at 420.">doPrivileged</a></li>
<li><a href="#L482" title="Defined at 482.">doPrivilegedWithCombiner</a></li>
<li><a href="#L527" title="Defined at 527.">doPrivileged</a></li>
<li><a href="#L560" title="Defined at 560.">doPrivilegedWithCombiner</a></li>
<li><a href="#L575" title="Defined at 575.">preserveCombiner</a></li>
<li><a href="#L585" title="Defined at 585.">createWrapper</a></li>
<li><a href="#L603" title="Defined at 603.">getCallerPD</a></li>
<li><a href="#L652" title="Defined at 652.">doPrivileged</a></li>
<li><a href="#L704" title="Defined at 704.">doPrivileged</a></li>
<li><a href="#L768" title="Defined at 768.">doPrivilegedWithCombiner</a></li>
<li><a href="#L796" title="Defined at 796.">getStackAccessControlContext</a></li>
<li><a href="#L805" title="Defined at 805.">getInheritedAccessControlContext</a></li>
<li><a href="#L818" title="Defined at 818.">getContext</a></li>
<li><a href="#L848" title="Defined at 848.">checkPermission</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> sun.security.util.Debug;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> sun.reflect.CallerSensitive;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> sun.reflect.Reflection;
<a id="L31" name="L31"></a>  31 
<div class="comment">
  <p> The AccessController class is used for access control operations
  and decisions.
  </p><p> More specifically, the AccessController class is used for
  three purposes:
  </p><ul><li> to decide whether an access to a critical system
  resource is to be allowed or denied, based on the security policy
  currently in effect,
  </li><li>to mark code as being "privileged", thus affecting subsequent
  access determinations, and
  </li><li>to obtain a "snapshot" of the current calling context so
  access-control decisions from a different context can be made with
  respect to the saved context. </li></ul>
  <p> The {@link #checkPermission(Permission) checkPermission} method
  determines whether the access request indicated by a specified
  permission should be granted or denied. A sample call appears
  below. In this example, <code>checkPermission</code> will determine
  whether or not to grant "read" access to the file named "testFile" in
  the "/temp" directory.
  </p><pre>  FilePermission perm = new FilePermission("/temp/testFile", "read");
  AccessController.checkPermission(perm);
  </pre>
  <p> If a requested access is allowed,
  <code>checkPermission</code> returns quietly. If denied, an
  AccessControlException is
  thrown. AccessControlException can also be thrown if the requested
  permission is of an incorrect type or contains an invalid value.
  Such information is given whenever possible.
  Suppose the current thread traversed m callers, in the order of caller 1
  to caller 2 to caller m. Then caller m invoked the
  <code>checkPermission</code> method.
  The <code>checkPermission</code> method determines whether access
  is granted or denied based on the following algorithm:
   </p><pre> {@code
  for (int i = m; i &gt; 0; i--) {
      if (caller i's domain does not have the permission)
          throw AccessControlException
      else if (caller i is marked as privileged) {
          if (a context was specified in the call to doPrivileged)
              context.checkPermission(permission)
          if (limited permissions were specified in the call to doPrivileged) {
              for (each limited permission) {
                  if (the limited permission implies the requested permission)
                      return;
              }
          } else
              return;
      }
  }
  // Next, check the context inherited when the thread was created.
  // Whenever a new thread is created, the AccessControlContext at
  // that time is stored and associated with the new thread, as the
  // "inherited" context.
  inheritedContext.checkPermission(permission);
  }</pre>
  <p> A caller can be marked as being "privileged"
  (see {@link #doPrivileged(PrivilegedAction) doPrivileged} and below).
  When making access control decisions, the <code>checkPermission</code>
  method stops checking if it reaches a caller that
  was marked as "privileged" via a <code>doPrivileged</code>
  call without a context argument (see below for information about a
  context argument). If that caller's domain has the
  specified permission and at least one limiting permission argument (if any)
  implies the requested permission, no further checking is done and
  <code>checkPermission</code>
  returns quietly, indicating that the requested access is allowed.
  If that domain does not have the specified permission, an exception
  is thrown, as usual. If the caller's domain had the specified permission
  but it was not implied by any limiting permission arguments given in the call
  to <code>doPrivileged</code> then the permission checking continues
  until there are no more callers or another <code>doPrivileged</code>
  call matches the requested permission and returns normally.
  </p><p> The normal use of the "privileged" feature is as follows. If you
  don't need to return a value from within the "privileged" block, do
  the following:
   </p><pre> {@code
  somemethod() {
      ...normal code here...
      AccessController.doPrivileged(new PrivilegedAction<void>() {
          public Void run() {
              // privileged code goes here, for example:
              System.loadLibrary("awt");
              return null; // nothing to return
          }
      });
      ...normal code here...
  }}</void></pre>
  <p>
  PrivilegedAction is an interface with a single method, named
  <code>run</code>.
  The above example shows creation of an implementation
  of that interface; a concrete implementation of the
  <code>run</code> method is supplied.
  When the call to <code>doPrivileged</code> is made, an
  instance of the PrivilegedAction implementation is passed
  to it. The <code>doPrivileged</code> method calls the
  <code>run</code> method from the PrivilegedAction
  implementation after enabling privileges, and returns the
  <code>run</code> method's return value as the
  <code>doPrivileged</code> return value (which is
  ignored in this example).
  </p><p> If you need to return a value, you can do something like the following:
   </p><pre> {@code
  somemethod() {
      ...normal code here...
      String user = AccessController.doPrivileged(
          new PrivilegedAction<string>() {
          public String run() {
              return System.getProperty("user.name");
              }
          });
      ...normal code here...
  }}</string></pre>
  <p>If the action performed in your <code>run</code> method could
  throw a "checked" exception (those listed in the <code>throws</code> clause
  of a method), then you need to use the
  <code>PrivilegedExceptionAction</code> interface instead of the
  <code>PrivilegedAction</code> interface:
   </p><pre> {@code
  somemethod() throws FileNotFoundException {
      ...normal code here...
      try {
          FileInputStream fis = AccessController.doPrivileged(
          new PrivilegedExceptionAction<fileinputstream>() {
              public FileInputStream run() throws FileNotFoundException {
                  return new FileInputStream("someFile");
              }
          });
      } catch (PrivilegedActionException e) {
          // e.getException() should be an instance of FileNotFoundException,
          // as only "checked" exceptions will be "wrapped" in a
          // PrivilegedActionException.
          throw (FileNotFoundException) e.getException();
      }
      ...normal code here...
   }}</fileinputstream></pre>
  <p> Be *very* careful in your use of the "privileged" construct, and
  always remember to make the privileged code section as small as possible.
  You can pass <code>Permission</code> arguments to further limit the
  scope of the "privilege" (see below).
  </p><p> Note that <code>checkPermission</code> always performs security checks
  within the context of the currently executing thread.
  Sometimes a security check that should be made within a given context
  will actually need to be done from within a
  <i>different</i> context (for example, from within a worker thread).
  The {@link #getContext() getContext} method and
  AccessControlContext class are provided
  for this situation. The <code>getContext</code> method takes a "snapshot"
  of the current calling context, and places
  it in an AccessControlContext object, which it returns. A sample call is
  the following:
  </p><pre>  AccessControlContext acc = AccessController.getContext()
  </pre>
  <p>
  AccessControlContext itself has a <code>checkPermission</code> method
  that makes access decisions based on the context <i>it</i> encapsulates,
  rather than that of the current execution thread.
  Code within a different context can thus call that method on the
  previously-saved AccessControlContext object. A sample call is the
  following:
  </p><pre>  acc.checkPermission(permission)
  </pre>
  <p> There are also times where you don't know a priori which permissions
  to check the context against. In these cases you can use the
  doPrivileged method that takes a context. You can also limit the scope
  of the privileged code by passing additional <code>Permission</code>
  parameters.
   </p><pre> {@code
  somemethod() {
      AccessController.doPrivileged(new PrivilegedAction<object>() {
          public Object run() {
              // Code goes here. Any permission checks within this
              // run method will require that the intersection of the
              // caller's protection domain and the snapshot's
              // context have the desired permission. If a requested
              // permission is not implied by the limiting FilePermission
              // argument then checking of the thread continues beyond the
              // caller of doPrivileged.
          }
 *     }, acc, new FilePermission("/temp", read));
      ...normal code here...
  }}
  <p> Passing a limiting <code>Permission</code> argument of an instance of
  <code>AllPermission</code> is equivalent to calling the equivalent
  <code>doPrivileged</code> method without limiting <code>Permission</code>
  arguments. Passing a zero length array of <code>Permission</code> disables
  the code privileges so that checking always continues beyond the caller of
  that <code>doPrivileged</code> method.
  @see AccessControlContext
  @author Li Gong
  @author Roland Schemers</p></object></pre></div>
<a id="L263" name="L263"></a> 263 
<a id="L264" name="L264"></a> 264 <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/140.html" title="Multiple referred from 924 places.">AccessController</a> <em class="brace">{</em>
<a id="L265" name="L265"></a> 265 
<div class="comment">
      Don't allow anyone to instantiate an AccessController</div>
<a id="L269" name="L269"></a> 269     <strong class="reserved">private</strong> AccessController() <em class="brace">{</em> <em class="brace">}</em>
<a id="L270" name="L270"></a> 270 
<div class="comment">
      Performs the specified <code>PrivilegedAction</code> with privileges
      enabled. The action is performed with <i>all</i> of the permissions
      possessed by the caller's protection domain.
      <p> If the action's <code>run</code> method throws an (unchecked)
      exception, it will propagate through this method.
      </p><p> Note that any DomainCombiner associated with the current
      AccessControlContext will be ignored while the action is performed.
      @param <t> the type of the value returned by the PrivilegedAction's
                       <code>run</code> method.
      @param action the action to be performed.
      @return the value returned by the action's <code>run</code> method.
      @exception NullPointerException if the action is <code>null</code>
      @see #doPrivileged(PrivilegedAction,AccessControlContext)
      @see #doPrivileged(PrivilegedExceptionAction)
      @see #doPrivilegedWithCombiner(PrivilegedAction)
      @see java.security.DomainCombiner</t></p></div>
<a id="L296" name="L296"></a> 296 
<a id="L297" name="L297"></a> 297     @CallerSensitive
<a id="L298" name="L298"></a> 298     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">native</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> <a href="../R/13421.html" title="Multiple referred from 615 places.">doPrivileged</a>(<a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>);
<a id="L299" name="L299"></a> 299 
<div class="comment">
      Performs the specified <code>PrivilegedAction</code> with privileges
      enabled. The action is performed with <i>all</i> of the permissions
      possessed by the caller's protection domain.
      <p> If the action's <code>run</code> method throws an (unchecked)
      exception, it will propagate through this method.
      </p><p> This method preserves the current AccessControlContext's
      DomainCombiner (which may be null) while the action is performed.
      @param <t> the type of the value returned by the PrivilegedAction's
                       <code>run</code> method.
      @param action the action to be performed.
      @return the value returned by the action's <code>run</code> method.
      @exception NullPointerException if the action is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see java.security.DomainCombiner
      @since 1.6</t></p></div>
<a id="L325" name="L325"></a> 325     @CallerSensitive
<a id="L326" name="L326"></a> 326     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> doPrivilegedWithCombiner(<a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>) <em class="brace">{</em>
<a id="L327" name="L327"></a> 327         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> acc = <a href="../S/1248.html#L796" title="Defined at 796 in src/java/security/AccessController.java.">getStackAccessControlContext</a>();
<a id="L328" name="L328"></a> 328         <strong class="reserved">if</strong> (acc == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L329" name="L329"></a> 329             <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>);
<a id="L330" name="L330"></a> 330         <em class="brace">}</em>
<a id="L331" name="L331"></a> 331         <a href="../S/1213.html#L81" title="Defined at 81 in src/java/security/DomainCombiner.java.">DomainCombiner</a> dc = acc.<a href="../S/1212.html#L324" title="Defined at 324 in src/java/security/AccessControlContext.java.">getAssignedCombiner</a>();
<a id="L332" name="L332"></a> 332         <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>,
<a id="L333" name="L333"></a> 333                                              <a href="../S/1248.html#L575" title="Defined at 575 in src/java/security/AccessController.java.">preserveCombiner</a>(dc, Reflection.getCallerClass()));
<a id="L334" name="L334"></a> 334     <em class="brace">}</em>
<a id="L335" name="L335"></a> 335 
<a id="L336" name="L336"></a> 336 
<div class="comment">
      Performs the specified <code>PrivilegedAction</code> with privileges
      enabled and restricted by the specified <code>AccessControlContext</code>.
      The action is performed with the intersection of the permissions
      possessed by the caller's protection domain, and those possessed
      by the domains represented by the specified <code>AccessControlContext</code>.
      <p>
      If the action's <code>run</code> method throws an (unchecked) exception,
      it will propagate through this method.
      </p><p>
      If a security manager is installed and the specified
      <code>AccessControlContext</code> was not created by system code and the
      caller's <code>ProtectionDomain</code> has not been granted the
      {@literal "createAccessControlContext"}
      {@link java.security.SecurityPermission}, then the action is performed
      with no permissions.
      @param <t> the type of the value returned by the PrivilegedAction's
                       <code>run</code> method.
      @param action the action to be performed.
      @param context an <i>access control context</i>
                     representing the restriction to be applied to the
                     caller's domain's privileges before performing
                     the specified action.  If the context is
                     <code>null</code>, then no additional restriction is applied.
      @return the value returned by the action's <code>run</code> method.
      @exception NullPointerException if the action is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see #doPrivileged(PrivilegedExceptionAction,AccessControlContext)</t></p></div>
<a id="L370" name="L370"></a> 370     @CallerSensitive
<a id="L371" name="L371"></a> 371     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">native</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> <a href="../R/13421.html" title="Multiple referred from 615 places.">doPrivileged</a>(<a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>,
<a id="L372" name="L372"></a> 372                                             <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>);
<a id="L373" name="L373"></a> 373 
<a id="L374" name="L374"></a> 374 
<div class="comment">
      Performs the specified <code>PrivilegedAction</code> with privileges
      enabled and restricted by the specified
      <code>AccessControlContext</code> and with a privilege scope limited
      by specified <code>Permission</code> arguments.
      The action is performed with the intersection of the permissions
      possessed by the caller's protection domain, and those possessed
      by the domains represented by the specified
      <code>AccessControlContext</code>.
      <p>
      If the action's <code>run</code> method throws an (unchecked) exception,
      it will propagate through this method.
      </p><p>
      If a security manager is installed and the specified
      <code>AccessControlContext</code> was not created by system code and the
      caller's <code>ProtectionDomain</code> has not been granted the
      {@literal "createAccessControlContext"}
      {@link java.security.SecurityPermission}, then the action is performed
      with no permissions.
      @param <t> the type of the value returned by the PrivilegedAction's
                       <code>run</code> method.
      @param action the action to be performed.
      @param context an <i>access control context</i>
                     representing the restriction to be applied to the
                     caller's domain's privileges before performing
                     the specified action.  If the context is
                     <code>null</code>,
                     then no additional restriction is applied.
      @param perms the <code>Permission</code> arguments which limit the
                   scope of the caller's privileges. The number of arguments
                   is variable.
      @return the value returned by the action's <code>run</code> method.
      @throws NullPointerException if action or perms or any element of
              perms is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see #doPrivileged(PrivilegedExceptionAction,AccessControlContext)
      @since 1.8</t></p></div>
<a id="L419" name="L419"></a> 419     @CallerSensitive
<a id="L420" name="L420"></a> 420     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> <a href="../R/13421.html" title="Multiple referred from 615 places.">doPrivileged</a>(<a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>,
<a id="L421" name="L421"></a> 421         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, <a href="../D/6689.html" title="Multiple defined in 2 places.">Permission</a>... perms) <em class="brace">{</em>
<a id="L422" name="L422"></a> 422 
<a id="L423" name="L423"></a> 423         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> = <a href="../D/17976.html" title="Multiple defined in 99 places.">getContext</a>();
<a id="L424" name="L424"></a> 424         <strong class="reserved">if</strong> (perms == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L425" name="L425"></a> 425             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("null permissions parameter");
<a id="L426" name="L426"></a> 426         <em class="brace">}</em>
<a id="L427" name="L427"></a> 427         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a> &lt;?&gt; caller = Reflection.getCallerClass();
<a id="L428" name="L428"></a> 428         <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>, <a href="../S/1248.html#L585" title="Defined at 585 in src/java/security/AccessController.java.">createWrapper</a>(<strong class="reserved">null</strong>,
<a id="L429" name="L429"></a> 429             caller, <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>, <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, perms));
<a id="L430" name="L430"></a> 430     <em class="brace">}</em>
<a id="L431" name="L431"></a> 431 
<a id="L432" name="L432"></a> 432 
<div class="comment">
      Performs the specified <code>PrivilegedAction</code> with privileges
      enabled and restricted by the specified
      <code>AccessControlContext</code> and with a privilege scope limited
      by specified <code>Permission</code> arguments.
      The action is performed with the intersection of the permissions
      possessed by the caller's protection domain, and those possessed
      by the domains represented by the specified
      <code>AccessControlContext</code>.
      <p>
      If the action's <code>run</code> method throws an (unchecked) exception,
      it will propagate through this method.
      </p><p> This method preserves the current AccessControlContext's
      DomainCombiner (which may be null) while the action is performed.
      </p><p>
      If a security manager is installed and the specified
      <code>AccessControlContext</code> was not created by system code and the
      caller's <code>ProtectionDomain</code> has not been granted the
      {@literal "createAccessControlContext"}
      {@link java.security.SecurityPermission}, then the action is performed
      with no permissions.
      @param <t> the type of the value returned by the PrivilegedAction's
                       <code>run</code> method.
      @param action the action to be performed.
      @param context an <i>access control context</i>
                     representing the restriction to be applied to the
                     caller's domain's privileges before performing
                     the specified action.  If the context is
                     <code>null</code>,
                     then no additional restriction is applied.
      @param perms the <code>Permission</code> arguments which limit the
                   scope of the caller's privileges. The number of arguments
                   is variable.
      @return the value returned by the action's <code>run</code> method.
      @throws NullPointerException if action or perms or any element of
              perms is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see #doPrivileged(PrivilegedExceptionAction,AccessControlContext)
      @see java.security.DomainCombiner
      @since 1.8</t></p></div>
<a id="L481" name="L481"></a> 481     @CallerSensitive
<a id="L482" name="L482"></a> 482     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> doPrivilegedWithCombiner(<a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>,
<a id="L483" name="L483"></a> 483         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, <a href="../D/6689.html" title="Multiple defined in 2 places.">Permission</a>... perms) <em class="brace">{</em>
<a id="L484" name="L484"></a> 484 
<a id="L485" name="L485"></a> 485         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> = <a href="../D/17976.html" title="Multiple defined in 99 places.">getContext</a>();
<a id="L486" name="L486"></a> 486         <a href="../S/1213.html#L81" title="Defined at 81 in src/java/security/DomainCombiner.java.">DomainCombiner</a> dc = <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>.<a href="../S/1212.html#L364" title="Defined at 364 in src/java/security/AccessControlContext.java.">getCombiner</a>();
<a id="L487" name="L487"></a> 487         <strong class="reserved">if</strong> (dc == <strong class="reserved">null</strong> &amp;&amp; <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L488" name="L488"></a> 488             dc = <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>.<a href="../S/1212.html#L364" title="Defined at 364 in src/java/security/AccessControlContext.java.">getCombiner</a>();
<a id="L489" name="L489"></a> 489         <em class="brace">}</em>
<a id="L490" name="L490"></a> 490         <strong class="reserved">if</strong> (perms == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L491" name="L491"></a> 491             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("null permissions parameter");
<a id="L492" name="L492"></a> 492         <em class="brace">}</em>
<a id="L493" name="L493"></a> 493         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a> &lt;?&gt; caller = Reflection.getCallerClass();
<a id="L494" name="L494"></a> 494         <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>, <a href="../S/1248.html#L585" title="Defined at 585 in src/java/security/AccessController.java.">createWrapper</a>(dc, caller,
<a id="L495" name="L495"></a> 495             <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>, <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, perms));
<a id="L496" name="L496"></a> 496     <em class="brace">}</em>
<a id="L497" name="L497"></a> 497 
<div class="comment">
      Performs the specified <code>PrivilegedExceptionAction</code> with
      privileges enabled.  The action is performed with <i>all</i> of the
      permissions possessed by the caller's protection domain.
      <p> If the action's <code>run</code> method throws an <i>unchecked</i>
      exception, it will propagate through this method.
      </p><p> Note that any DomainCombiner associated with the current
      AccessControlContext will be ignored while the action is performed.
      @param <t> the type of the value returned by the
                       PrivilegedExceptionAction's <code>run</code> method.
      @param action the action to be performed
      @return the value returned by the action's <code>run</code> method
      @exception PrivilegedActionException if the specified action's
              <code>run</code> method threw a <i>checked</i> exception
      @exception NullPointerException if the action is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see #doPrivileged(PrivilegedExceptionAction,AccessControlContext)
      @see #doPrivilegedWithCombiner(PrivilegedExceptionAction)
      @see java.security.DomainCombiner</t></p></div>
<a id="L525" name="L525"></a> 525     @CallerSensitive
<a id="L526" name="L526"></a> 526     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">native</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>
<a id="L527" name="L527"></a> 527         <a href="../R/13421.html" title="Multiple referred from 615 places.">doPrivileged</a>(<a href="../S/1263.html#L45" title="Defined at 45 in src/java/security/PrivilegedExceptionAction.java.">PrivilegedExceptionAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>)
<a id="L528" name="L528"></a> 528         <strong class="reserved">throws</strong> <a href="../S/1259.html#L50" title="Defined at 50 in src/java/security/PrivilegedActionException.java.">PrivilegedActionException</a>;
<a id="L529" name="L529"></a> 529 
<a id="L530" name="L530"></a> 530 
<div class="comment">
      Performs the specified <code>PrivilegedExceptionAction</code> with
      privileges enabled.  The action is performed with <i>all</i> of the
      permissions possessed by the caller's protection domain.
      <p> If the action's <code>run</code> method throws an <i>unchecked</i>
      exception, it will propagate through this method.
      </p><p> This method preserves the current AccessControlContext's
      DomainCombiner (which may be null) while the action is performed.
      @param <t> the type of the value returned by the
                       PrivilegedExceptionAction's <code>run</code> method.
      @param action the action to be performed.
      @return the value returned by the action's <code>run</code> method
      @exception PrivilegedActionException if the specified action's
              <code>run</code> method threw a <i>checked</i> exception
      @exception NullPointerException if the action is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see #doPrivileged(PrivilegedExceptionAction,AccessControlContext)
      @see java.security.DomainCombiner
      @since 1.6</t></p></div>
<a id="L559" name="L559"></a> 559     @CallerSensitive
<a id="L560" name="L560"></a> 560     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> doPrivilegedWithCombiner(<a href="../S/1263.html#L45" title="Defined at 45 in src/java/security/PrivilegedExceptionAction.java.">PrivilegedExceptionAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>)
<a id="L561" name="L561"></a> 561         <strong class="reserved">throws</strong> <a href="../S/1259.html#L50" title="Defined at 50 in src/java/security/PrivilegedActionException.java.">PrivilegedActionException</a>
<a id="L562" name="L562"></a> 562     <em class="brace">{</em>
<a id="L563" name="L563"></a> 563         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> acc = <a href="../S/1248.html#L796" title="Defined at 796 in src/java/security/AccessController.java.">getStackAccessControlContext</a>();
<a id="L564" name="L564"></a> 564         <strong class="reserved">if</strong> (acc == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L565" name="L565"></a> 565             <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>);
<a id="L566" name="L566"></a> 566         <em class="brace">}</em>
<a id="L567" name="L567"></a> 567         <a href="../S/1213.html#L81" title="Defined at 81 in src/java/security/DomainCombiner.java.">DomainCombiner</a> dc = acc.<a href="../S/1212.html#L324" title="Defined at 324 in src/java/security/AccessControlContext.java.">getAssignedCombiner</a>();
<a id="L568" name="L568"></a> 568         <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>,
<a id="L569" name="L569"></a> 569                                              <a href="../S/1248.html#L575" title="Defined at 575 in src/java/security/AccessController.java.">preserveCombiner</a>(dc, Reflection.getCallerClass()));
<a id="L570" name="L570"></a> 570     <em class="brace">}</em>
<a id="L571" name="L571"></a> 571 
<div class="comment">
      preserve the combiner across the doPrivileged call</div>
<a id="L575" name="L575"></a> 575     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../R/24955.html" title="Multiple referred from 2 places.">preserveCombiner</a>(<a href="../S/1213.html#L81" title="Defined at 81 in src/java/security/DomainCombiner.java.">DomainCombiner</a> <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>,
<a id="L576" name="L576"></a> 576                                                          <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; caller)
<a id="L577" name="L577"></a> 577     <em class="brace">{</em>
<a id="L578" name="L578"></a> 578         <strong class="reserved">return</strong> <a href="../S/1248.html#L585" title="Defined at 585 in src/java/security/AccessController.java.">createWrapper</a>(<a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>, caller, <strong class="reserved">null</strong>, <strong class="reserved">null</strong>, <strong class="reserved">null</strong>);
<a id="L579" name="L579"></a> 579     <em class="brace">}</em>
<a id="L580" name="L580"></a> 580 
<div class="comment">
      Create a wrapper to contain the limited privilege scope data.</div>
<a id="L584" name="L584"></a> 584     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a>
<a id="L585" name="L585"></a> 585         <a href="../R/12794.html" title="Multiple referred from 5 places.">createWrapper</a>(<a href="../S/1213.html#L81" title="Defined at 81 in src/java/security/DomainCombiner.java.">DomainCombiner</a> <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>, <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; caller,
<a id="L586" name="L586"></a> 586                       <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>, <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>,
<a id="L587" name="L587"></a> 587                       <a href="../D/6689.html" title="Multiple defined in 2 places.">Permission</a>[] perms)
<a id="L588" name="L588"></a> 588     <em class="brace">{</em>
<a id="L589" name="L589"></a> 589         <a href="../S/1249.html#L61" title="Defined at 61 in src/java/security/ProtectionDomain.java.">ProtectionDomain</a> callerPD = <a href="../S/1248.html#L603" title="Defined at 603 in src/java/security/AccessController.java.">getCallerPD</a>(caller);
<a id="L590" name="L590"></a> 590         <em class="comment">// check if caller is authorized to create context</em>
<a id="L591" name="L591"></a> 591         <strong class="reserved">if</strong> (<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a> != <strong class="reserved">null</strong> &amp;&amp; !<a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>.<a href="../D/25225.html" title="Multiple defined in 2 places.">isAuthorized</a>() &amp;&amp;
<a id="L592" name="L592"></a> 592             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>() != <strong class="reserved">null</strong> &amp;&amp;
<a id="L593" name="L593"></a> 593             !callerPD.<a href="../S/1249.html#L290" title="Defined at 290 in src/java/security/ProtectionDomain.java.">impliesCreateAccessControlContext</a>())
<a id="L594" name="L594"></a> 594         <em class="brace">{</em>
<a id="L595" name="L595"></a> 595             <a href="../S/1249.html#L61" title="Defined at 61 in src/java/security/ProtectionDomain.java.">ProtectionDomain</a> nullPD = <strong class="reserved">new</strong> <a href="../S/1249.html#L61" title="Defined at 61 in src/java/security/ProtectionDomain.java.">ProtectionDomain</a>(<strong class="reserved">null</strong>, <strong class="reserved">null</strong>);
<a id="L596" name="L596"></a> 596             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a>(<strong class="reserved">new</strong> <a href="../S/1249.html#L61" title="Defined at 61 in src/java/security/ProtectionDomain.java.">ProtectionDomain</a>[] <em class="brace">{</em> nullPD <em class="brace">}</em>);
<a id="L597" name="L597"></a> 597         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L598" name="L598"></a> 598             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a>(callerPD, <a href="../D/13009.html" title="Multiple defined in 2 places.">combiner</a>, <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>,
<a id="L599" name="L599"></a> 599                                             <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, perms);
<a id="L600" name="L600"></a> 600         <em class="brace">}</em>
<a id="L601" name="L601"></a> 601     <em class="brace">}</em>
<a id="L602" name="L602"></a> 602 
<a id="L603" name="L603"></a> 603     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1249.html#L61" title="Defined at 61 in src/java/security/ProtectionDomain.java.">ProtectionDomain</a> <a href="../S/1248.html#L589" title="Referred from 589 in src/java/security/AccessController.java.">getCallerPD</a>(<strong class="reserved">final</strong> <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a> &lt;?&gt; caller) <em class="brace">{</em>
<a id="L604" name="L604"></a> 604         <a href="../S/1249.html#L61" title="Defined at 61 in src/java/security/ProtectionDomain.java.">ProtectionDomain</a> callerPd = <a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>
<a id="L605" name="L605"></a> 605             (<strong class="reserved">new</strong> <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../S/1249.html#L61" title="Defined at 61 in src/java/security/ProtectionDomain.java.">ProtectionDomain</a>&gt;() <em class="brace">{</em>
<a id="L606" name="L606"></a> 606             <strong class="reserved">public</strong> <a href="../S/1249.html#L61" title="Defined at 61 in src/java/security/ProtectionDomain.java.">ProtectionDomain</a> <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>() <em class="brace">{</em>
<a id="L607" name="L607"></a> 607                 <strong class="reserved">return</strong> caller.<a href="../D/21746.html" title="Multiple defined in 2 places.">getProtectionDomain</a>();
<a id="L608" name="L608"></a> 608             <em class="brace">}</em>
<a id="L609" name="L609"></a> 609         <em class="brace">}</em>);
<a id="L610" name="L610"></a> 610 
<a id="L611" name="L611"></a> 611         <strong class="reserved">return</strong> callerPd;
<a id="L612" name="L612"></a> 612     <em class="brace">}</em>
<a id="L613" name="L613"></a> 613 
<div class="comment">
      Performs the specified <code>PrivilegedExceptionAction</code> with
      privileges enabled and restricted by the specified
      <code>AccessControlContext</code>.  The action is performed with the
      intersection of the permissions possessed by the caller's
      protection domain, and those possessed by the domains represented by the
      specified <code>AccessControlContext</code>.
      <p>
      If the action's <code>run</code> method throws an <i>unchecked</i>
      exception, it will propagate through this method.
      </p><p>
      If a security manager is installed and the specified
      <code>AccessControlContext</code> was not created by system code and the
      caller's <code>ProtectionDomain</code> has not been granted the
      {@literal "createAccessControlContext"}
      {@link java.security.SecurityPermission}, then the action is performed
      with no permissions.
      @param <t> the type of the value returned by the
                       PrivilegedExceptionAction's <code>run</code> method.
      @param action the action to be performed
      @param context an <i>access control context</i>
                     representing the restriction to be applied to the
                     caller's domain's privileges before performing
                     the specified action.  If the context is
                     <code>null</code>, then no additional restriction is applied.
      @return the value returned by the action's <code>run</code> method
      @exception PrivilegedActionException if the specified action's
              <code>run</code> method threw a <i>checked</i> exception
      @exception NullPointerException if the action is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see #doPrivileged(PrivilegedAction,AccessControlContext)</t></p></div>
<a id="L650" name="L650"></a> 650     @CallerSensitive
<a id="L651" name="L651"></a> 651     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">native</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>
<a id="L652" name="L652"></a> 652         <a href="../R/13421.html" title="Multiple referred from 615 places.">doPrivileged</a>(<a href="../S/1263.html#L45" title="Defined at 45 in src/java/security/PrivilegedExceptionAction.java.">PrivilegedExceptionAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>,
<a id="L653" name="L653"></a> 653                      <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>)
<a id="L654" name="L654"></a> 654         <strong class="reserved">throws</strong> <a href="../S/1259.html#L50" title="Defined at 50 in src/java/security/PrivilegedActionException.java.">PrivilegedActionException</a>;
<a id="L655" name="L655"></a> 655 
<a id="L656" name="L656"></a> 656 
<div class="comment">
      Performs the specified <code>PrivilegedExceptionAction</code> with
      privileges enabled and restricted by the specified
      <code>AccessControlContext</code> and with a privilege scope limited by
      specified <code>Permission</code> arguments.
      The action is performed with the intersection of the permissions
      possessed by the caller's protection domain, and those possessed
      by the domains represented by the specified
      <code>AccessControlContext</code>.
      <p>
      If the action's <code>run</code> method throws an (unchecked) exception,
      it will propagate through this method.
      </p><p>
      If a security manager is installed and the specified
      <code>AccessControlContext</code> was not created by system code and the
      caller's <code>ProtectionDomain</code> has not been granted the
      {@literal "createAccessControlContext"}
      {@link java.security.SecurityPermission}, then the action is performed
      with no permissions.
      @param <t> the type of the value returned by the
                       PrivilegedExceptionAction's <code>run</code> method.
      @param action the action to be performed.
      @param context an <i>access control context</i>
                     representing the restriction to be applied to the
                     caller's domain's privileges before performing
                     the specified action.  If the context is
                     <code>null</code>,
                     then no additional restriction is applied.
      @param perms the <code>Permission</code> arguments which limit the
                   scope of the caller's privileges. The number of arguments
                   is variable.
      @return the value returned by the action's <code>run</code> method.
      @throws PrivilegedActionException if the specified action's
              <code>run</code> method threw a <i>checked</i> exception
      @throws NullPointerException if action or perms or any element of
              perms is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see #doPrivileged(PrivilegedAction,AccessControlContext)
      @since 1.8</t></p></div>
<a id="L703" name="L703"></a> 703     @CallerSensitive
<a id="L704" name="L704"></a> 704     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> <a href="../R/13421.html" title="Multiple referred from 615 places.">doPrivileged</a>(<a href="../S/1263.html#L45" title="Defined at 45 in src/java/security/PrivilegedExceptionAction.java.">PrivilegedExceptionAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>,
<a id="L705" name="L705"></a> 705                                      <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, <a href="../D/6689.html" title="Multiple defined in 2 places.">Permission</a>... perms)
<a id="L706" name="L706"></a> 706         <strong class="reserved">throws</strong> <a href="../S/1259.html#L50" title="Defined at 50 in src/java/security/PrivilegedActionException.java.">PrivilegedActionException</a>
<a id="L707" name="L707"></a> 707     <em class="brace">{</em>
<a id="L708" name="L708"></a> 708         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> = <a href="../D/17976.html" title="Multiple defined in 99 places.">getContext</a>();
<a id="L709" name="L709"></a> 709         <strong class="reserved">if</strong> (perms == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L710" name="L710"></a> 710             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("null permissions parameter");
<a id="L711" name="L711"></a> 711         <em class="brace">}</em>
<a id="L712" name="L712"></a> 712         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a> &lt;?&gt; caller = Reflection.getCallerClass();
<a id="L713" name="L713"></a> 713         <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>, <a href="../S/1248.html#L585" title="Defined at 585 in src/java/security/AccessController.java.">createWrapper</a>(<strong class="reserved">null</strong>, caller, <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>, <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, perms));
<a id="L714" name="L714"></a> 714     <em class="brace">}</em>
<a id="L715" name="L715"></a> 715 
<a id="L716" name="L716"></a> 716 
<div class="comment">
      Performs the specified <code>PrivilegedExceptionAction</code> with
      privileges enabled and restricted by the specified
      <code>AccessControlContext</code> and with a privilege scope limited by
      specified <code>Permission</code> arguments.
      The action is performed with the intersection of the permissions
      possessed by the caller's protection domain, and those possessed
      by the domains represented by the specified
      <code>AccessControlContext</code>.
      <p>
      If the action's <code>run</code> method throws an (unchecked) exception,
      it will propagate through this method.
      </p><p> This method preserves the current AccessControlContext's
      DomainCombiner (which may be null) while the action is performed.
      </p><p>
      If a security manager is installed and the specified
      <code>AccessControlContext</code> was not created by system code and the
      caller's <code>ProtectionDomain</code> has not been granted the
      {@literal "createAccessControlContext"}
      {@link java.security.SecurityPermission}, then the action is performed
      with no permissions.
      @param <t> the type of the value returned by the
                       PrivilegedExceptionAction's <code>run</code> method.
      @param action the action to be performed.
      @param context an <i>access control context</i>
                     representing the restriction to be applied to the
                     caller's domain's privileges before performing
                     the specified action.  If the context is
                     <code>null</code>,
                     then no additional restriction is applied.
      @param perms the <code>Permission</code> arguments which limit the
                   scope of the caller's privileges. The number of arguments
                   is variable.
      @return the value returned by the action's <code>run</code> method.
      @throws PrivilegedActionException if the specified action's
              <code>run</code> method threw a <i>checked</i> exception
      @throws NullPointerException if action or perms or any element of
              perms is <code>null</code>
      @see #doPrivileged(PrivilegedAction)
      @see #doPrivileged(PrivilegedAction,AccessControlContext)
      @see java.security.DomainCombiner
      @since 1.8</t></p></div>
<a id="L767" name="L767"></a> 767     @CallerSensitive
<a id="L768" name="L768"></a> 768     <strong class="reserved">public</strong> <strong class="reserved">static</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a> doPrivilegedWithCombiner(<a href="../S/1263.html#L45" title="Defined at 45 in src/java/security/PrivilegedExceptionAction.java.">PrivilegedExceptionAction</a>&lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>,
<a id="L769" name="L769"></a> 769                                                  <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>,
<a id="L770" name="L770"></a> 770                                                  <a href="../D/6689.html" title="Multiple defined in 2 places.">Permission</a>... perms)
<a id="L771" name="L771"></a> 771         <strong class="reserved">throws</strong> <a href="../S/1259.html#L50" title="Defined at 50 in src/java/security/PrivilegedActionException.java.">PrivilegedActionException</a>
<a id="L772" name="L772"></a> 772     <em class="brace">{</em>
<a id="L773" name="L773"></a> 773         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a> = <a href="../D/17976.html" title="Multiple defined in 99 places.">getContext</a>();
<a id="L774" name="L774"></a> 774         <a href="../S/1213.html#L81" title="Defined at 81 in src/java/security/DomainCombiner.java.">DomainCombiner</a> dc = <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>.<a href="../S/1212.html#L364" title="Defined at 364 in src/java/security/AccessControlContext.java.">getCombiner</a>();
<a id="L775" name="L775"></a> 775         <strong class="reserved">if</strong> (dc == <strong class="reserved">null</strong> &amp;&amp; <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L776" name="L776"></a> 776             dc = <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>.<a href="../S/1212.html#L364" title="Defined at 364 in src/java/security/AccessControlContext.java.">getCombiner</a>();
<a id="L777" name="L777"></a> 777         <em class="brace">}</em>
<a id="L778" name="L778"></a> 778         <strong class="reserved">if</strong> (perms == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L779" name="L779"></a> 779             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("null permissions parameter");
<a id="L780" name="L780"></a> 780         <em class="brace">}</em>
<a id="L781" name="L781"></a> 781         <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a> &lt;?&gt; caller = Reflection.getCallerClass();
<a id="L782" name="L782"></a> 782         <strong class="reserved">return</strong> <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>, <a href="../S/1248.html#L585" title="Defined at 585 in src/java/security/AccessController.java.">createWrapper</a>(dc, caller,
<a id="L783" name="L783"></a> 783             <a href="../D/29067.html" title="Multiple defined in 4 places.">parent</a>, <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>, perms));
<a id="L784" name="L784"></a> 784     <em class="brace">}</em>
<a id="L785" name="L785"></a> 785 
<div class="comment">
      Returns the AccessControl context. i.e., it gets
      the protection domains of all the callers on the stack,
      starting at the first class with a non-null
      ProtectionDomain.
      @return the access control context based on the current stack or
              null if there was only privileged system code.</div>
<a id="L795" name="L795"></a> 795 
<a id="L796" name="L796"></a> 796     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">native</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../R/19140.html" title="Multiple referred from 4 places.">getStackAccessControlContext</a>();
<a id="L797" name="L797"></a> 797 
<a id="L798" name="L798"></a> 798 
<div class="comment">
      Returns the "inherited" AccessControl context. This is the context
      that existed when the thread was created. Package private so
      AccessControlContext can use it.</div>
<a id="L804" name="L804"></a> 804 
<a id="L805" name="L805"></a> 805     <strong class="reserved">static</strong> <strong class="reserved">native</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../R/17064.html" title="Multiple referred from 2 places.">getInheritedAccessControlContext</a>();
<a id="L806" name="L806"></a> 806 
<div class="comment">
      This method takes a "snapshot" of the current calling context, which
      includes the current Thread's inherited AccessControlContext and any
      limited privilege scope, and places it in an AccessControlContext object.
      This context may then be checked at a later point, possibly in another thread.
      @see AccessControlContext
      @return the AccessControlContext based on the current context.</div>
<a id="L817" name="L817"></a> 817 
<a id="L818" name="L818"></a> 818     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> <a href="../R/15801.html" title="Multiple referred from 401 places.">getContext</a>()
<a id="L819" name="L819"></a> 819     <em class="brace">{</em>
<a id="L820" name="L820"></a> 820         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> acc = <a href="../S/1248.html#L796" title="Defined at 796 in src/java/security/AccessController.java.">getStackAccessControlContext</a>();
<a id="L821" name="L821"></a> 821         <strong class="reserved">if</strong> (acc == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L822" name="L822"></a> 822             <em class="comment">// all we had was privileged system code. We don't want</em>
<a id="L823" name="L823"></a> 823             <em class="comment">// to return null though, so we construct a real ACC.</em>
<a id="L824" name="L824"></a> 824             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a>(<strong class="reserved">null</strong>, <strong class="reserved">true</strong>);
<a id="L825" name="L825"></a> 825         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L826" name="L826"></a> 826             <strong class="reserved">return</strong> acc.<a href="../D/28544.html" title="Multiple defined in 3 places.">optimize</a>();
<a id="L827" name="L827"></a> 827         <em class="brace">}</em>
<a id="L828" name="L828"></a> 828     <em class="brace">}</em>
<a id="L829" name="L829"></a> 829 
<div class="comment">
      Determines whether the access request indicated by the
      specified permission should be allowed or denied, based on
      the current AccessControlContext and security policy.
      This method quietly returns if the access request
      is permitted, or throws an AccessControlException otherwise. The
      getPermission method of the AccessControlException returns the
      <code>perm</code> Permission object instance.
      @param perm the requested permission.
      @exception AccessControlException if the specified permission
                 is not permitted, based on the current security policy.
      @exception NullPointerException if the specified permission
                 is <code>null</code> and is checked based on the
                 security policy currently in effect.</div>
<a id="L847" name="L847"></a> 847 
<a id="L848" name="L848"></a> 848     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/11295.html" title="Multiple referred from 248 places.">checkPermission</a>(<a href="../D/6689.html" title="Multiple defined in 2 places.">Permission</a> perm)
<a id="L849" name="L849"></a> 849         <strong class="reserved">throws</strong> <a href="../S/1326.html#L43" title="Defined at 43 in src/java/security/AccessControlException.java.">AccessControlException</a>
<a id="L850" name="L850"></a> 850     <em class="brace">{</em>
<a id="L851" name="L851"></a> 851         <em class="comment">//System.err.println("checkPermission "+perm);</em>
<a id="L852" name="L852"></a> 852         <em class="comment">//Thread.currentThread().dumpStack();</em>
<a id="L853" name="L853"></a> 853 
<a id="L854" name="L854"></a> 854         <strong class="reserved">if</strong> (perm == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L855" name="L855"></a> 855             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>("permission can't be null");
<a id="L856" name="L856"></a> 856         <em class="brace">}</em>
<a id="L857" name="L857"></a> 857 
<a id="L858" name="L858"></a> 858         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> stack = <a href="../S/1248.html#L796" title="Defined at 796 in src/java/security/AccessController.java.">getStackAccessControlContext</a>();
<a id="L859" name="L859"></a> 859         <em class="comment">// if context is null, we had privileged system code on the stack.</em>
<a id="L860" name="L860"></a> 860         <strong class="reserved">if</strong> (stack == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L861" name="L861"></a> 861             <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a> <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> = <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a>.<a href="../D/18231.html" title="Multiple defined in 4 places.">getDebug</a>();
<a id="L862" name="L862"></a> 862             <strong class="reserved">boolean</strong> dumpDebug = <strong class="reserved">false</strong>;
<a id="L863" name="L863"></a> 863             <strong class="reserved">if</strong> (<a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L864" name="L864"></a> 864                 dumpDebug = !<a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.isOn("codebase=");
<a id="L865" name="L865"></a> 865                 dumpDebug &amp;= !<a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.isOn("permission=") ||
<a id="L866" name="L866"></a> 866                     <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.isOn("permission=" + perm.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>().<a href="../D/17480.html" title="Multiple defined in 4 places.">getCanonicalName</a>());
<a id="L867" name="L867"></a> 867             <em class="brace">}</em>
<a id="L868" name="L868"></a> 868 
<a id="L869" name="L869"></a> 869             <strong class="reserved">if</strong> (dumpDebug &amp;&amp; <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.isOn("stack")) <em class="brace">{</em>
<a id="L870" name="L870"></a> 870                 <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L1328" title="Defined at 1328 in src/java/lang/Thread.java.">dumpStack</a>();
<a id="L871" name="L871"></a> 871             <em class="brace">}</em>
<a id="L872" name="L872"></a> 872 
<a id="L873" name="L873"></a> 873             <strong class="reserved">if</strong> (dumpDebug &amp;&amp; <a href="../D/2238.html" title="Multiple defined in 2 places.">Debug</a>.isOn("domain")) <em class="brace">{</em>
<a id="L874" name="L874"></a> 874                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("domain (context is null)");
<a id="L875" name="L875"></a> 875             <em class="brace">}</em>
<a id="L876" name="L876"></a> 876 
<a id="L877" name="L877"></a> 877             <strong class="reserved">if</strong> (dumpDebug) <em class="brace">{</em>
<a id="L878" name="L878"></a> 878                 <a href="../D/14486.html" title="Multiple defined in 5 places.">debug</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("access allowed "+perm);
<a id="L879" name="L879"></a> 879             <em class="brace">}</em>
<a id="L880" name="L880"></a> 880             <strong class="reserved">return</strong>;
<a id="L881" name="L881"></a> 881         <em class="brace">}</em>
<a id="L882" name="L882"></a> 882 
<a id="L883" name="L883"></a> 883         <a href="../S/1212.html#L77" title="Defined at 77 in src/java/security/AccessControlContext.java.">AccessControlContext</a> acc = stack.<a href="../D/28544.html" title="Multiple defined in 3 places.">optimize</a>();
<a id="L884" name="L884"></a> 884         acc.<a href="../D/12594.html" title="Multiple defined in 22 places.">checkPermission</a>(perm);
<a id="L885" name="L885"></a> 885     <em class="brace">}</em>
<a id="L886" name="L886"></a> 886 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L298">[^]</a><a href="#L848">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>