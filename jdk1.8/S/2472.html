<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/text/ChoiceFormat.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L176">[^]</a><a href="#L633">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L176" title="Defined at 176.">applyPattern</a></li>
<li><a href="#L261" title="Defined at 261.">toPattern</a></li>
<li><a href="#L343" title="Defined at 343.">setChoices</a></li>
<li><a href="#L356" title="Defined at 356.">getLimits</a></li>
<li><a href="#L365" title="Defined at 365.">getFormats</a></li>
<li><a href="#L379" title="Defined at 379.">format</a></li>
<li><a href="#L390" title="Defined at 390.">format</a></li>
<li><a href="#L418" title="Defined at 418.">parse</a></li>
<li><a href="#L452" title="Defined at 452.">nextDouble</a></li>
<li><a href="#L464" title="Defined at 464.">previousDouble</a></li>
<li><a href="#L471" title="Defined at 471.">clone</a></li>
<li><a href="#L483" title="Defined at 483.">hashCode</a></li>
<li><a href="#L495" title="Defined at 495.">equals</a></li>
<li><a href="#L511" title="Defined at 511.">readObject</a></li>
<li><a href="#L585" title="Defined at 585.">nextDouble</a></li>
<li><a href="#L626" title="Defined at 626.">doubleArraySize</a></li>
<li><a href="#L633" title="Defined at 633.">doubleArraySize</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1996, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<div class="comment">
  (C) Copyright Taligent, Inc. 1996, 1997 - All Rights Reserved
  (C) Copyright IBM Corp. 1996 - 1998 - All Rights Reserved
    The original version of this source code and documentation is copyrighted
  and owned by Taligent, Inc., a wholly-owned subsidiary of IBM. These
  materials are provided under terms of a License Agreement between Taligent
  and Sun. This technology is protected by multiple US and International
  patents. This notice and attribution to Taligent may not be removed.
    Taligent is a registered trademark of Taligent, Inc.</div>
<a id="L38" name="L38"></a>  38 
<a id="L39" name="L39"></a>  39 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>;
<a id="L40" name="L40"></a>  40 
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> java.io.InvalidObjectException;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> java.io.IOException;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> java.io.ObjectInputStream;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> java.util.Arrays;
<a id="L45" name="L45"></a>  45 
<div class="comment">
  A <code>ChoiceFormat</code> allows you to attach a format to a range of numbers.
  It is generally used in a <code>MessageFormat</code> for handling plurals.
  The choice is specified with an ascending list of doubles, where each item
  specifies a half-open interval up to the next item:
  <blockquote>
  <pre>  X matches j if and only if limit[j] ≤ X &lt; limit[j+1]
  </pre>
  </blockquote>
  If there is no match, then either the first or last index is used, depending
  on whether the number (X) is too low or too high.  If the limit array is not
  in ascending order, the results of formatting will be incorrect.  ChoiceFormat
  also accepts <code>\u221E</code> as equivalent to infinity(INF).
  <p>
  <strong>Note:</strong>
  <code>ChoiceFormat</code> differs from the other <code>Format</code>
  classes in that you create a <code>ChoiceFormat</code> object with a
  constructor (not with a <code>getInstance</code> style factory
  method). The factory methods aren't necessary because <code>ChoiceFormat</code>
  doesn't require any complex setup for a given locale. In fact,
  <code>ChoiceFormat</code> doesn't implement any locale specific behavior.
  </p><p>
  When creating a <code>ChoiceFormat</code>, you must specify an array of formats
  and an array of limits. The length of these arrays must be the same.
  For example,
  </p><ul><li>
      <em>limits</em> = {1,2,3,4,5,6,7}<br>
      <em>formats</em> = {"Sun","Mon","Tue","Wed","Thur","Fri","Sat"}
  </li><li>
      <em>limits</em> = {0, 1, ChoiceFormat.nextDouble(1)}<br>
      <em>formats</em> = {"no files", "one file", "many files"}<br>
      (<code>nextDouble</code> can be used to get the next higher double, to
      make the half-open interval.)
  </li></ul>
  <p>
  Here is a simple example that shows formatting and parsing:
  </p><blockquote>
  <pre>{@code
  double[] limits = {1,2,3,4,5,6,7};
  String[] dayOfWeekNames = {"Sun","Mon","Tue","Wed","Thur","Fri","Sat"};
  ChoiceFormat form = new ChoiceFormat(limits, dayOfWeekNames);
  ParsePosition status = new ParsePosition(0);
  for (double i = 0.0; i &lt;= 8.0; ++i) {
      status.setIndex(0);
      System.out.println(i + " -&gt; " + form.format(i) + " -&gt; "
                               + form.parse(form.format(i),status));
  }
  }</pre>
  </blockquote>
  Here is a more complex example, with a pattern format:
  <blockquote>
  <pre>{@code
  double[] filelimits = {0,1,2};
  String[] filepart = {"are no files","is one file","are {2} files"};
  ChoiceFormat fileform = new ChoiceFormat(filelimits, filepart);
  Format[] testFormats = {fileform, null, NumberFormat.getInstance()};
  MessageFormat pattform = new MessageFormat("There {0} on {1}");
  pattform.setFormats(testFormats);
  Object[] testArgs = {null, "ADisk", null};
  for (int i = 0; i &lt; 4; ++i) {
      testArgs[0] = new Integer(i);
      testArgs[2] = testArgs[0];
      System.out.println(pattform.format(testArgs));
  }
  }</pre>
  </blockquote>
  <p>
  Specifying a pattern for ChoiceFormat objects is fairly straightforward.
  For example:
  </p><blockquote>
  <pre>{@code
  ChoiceFormat fmt = new ChoiceFormat(
       "-1#is negative| 0#is zero or fraction | 1#is one |1.0<is 1+ |2#is two |2<is more than 2."); system.out.println("formatter pattern : " + fmt.topattern()); system.out.println("format with -inf fmt.format(double.negative_infinity)); -1.0 fmt.format(-1.0)); 0 fmt.format(0)); 0.9 fmt.format(0.9)); 1.0 fmt.format(1)); 1.5 fmt.format(1.5)); 2 fmt.format(2)); 2.1 fmt.format(2.1)); nan fmt.format(double.nan)); +inf fmt.format(double.positive_infinity)); }< pre>
  </is></pre></blockquote>
  And the output result would be like the following:
  <blockquote>
  <pre>{@code
  Format with -INF : is negative
  Format with -1.0 : is negative
  Format with 0 : is zero or fraction
  Format with 0.9 : is zero or fraction
  Format with 1.0 : is one
  Format with 1.5 : is 1+
  Format with 2 : is two
  Format with 2.1 : is more than 2.
  Format with NaN : is negative
  Format with +INF : is more than 2.
  }</pre>
  </blockquote>
  <h3><a name="synchronization">Synchronization</a></h3>
  <p>
  Choice formats are not synchronized.
  It is recommended to create separate format instances for each thread.
  If multiple threads access a format concurrently, it must be synchronized
  externally.
  @see          DecimalFormat
  @see          MessageFormat
  @author       Mark Davis</p></div>
<a id="L167" name="L167"></a> 167 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/1342.html" title="Multiple referred from 6 places.">ChoiceFormat</a> <strong class="reserved">extends</strong> <a href="../S/2488.html#L182" title="Defined at 182 in src/java/text/NumberFormat.java.">NumberFormat</a> <em class="brace">{</em>
<a id="L168" name="L168"></a> 168 
<a id="L169" name="L169"></a> 169     <em class="comment">// Proclaim serial compatibility with 1.1 FCS</em>
<a id="L170" name="L170"></a> 170     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = 1795184449645032964L;
<a id="L171" name="L171"></a> 171 
<div class="comment">
      Sets the pattern.
      @param newPattern See the class description.</div>
<a id="L176" name="L176"></a> 176     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/10279.html" title="Multiple referred from 9 places.">applyPattern</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> newPattern) <em class="brace">{</em>
<a id="L177" name="L177"></a> 177         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>[] segments = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>[2];
<a id="L178" name="L178"></a> 178         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; segments.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; ++i) <em class="brace">{</em>
<a id="L179" name="L179"></a> 179             segments[i] = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L180" name="L180"></a> 180         <em class="brace">}</em>
<a id="L181" name="L181"></a> 181         <strong class="reserved">double</strong>[] newChoiceLimits = <strong class="reserved">new</strong> <strong class="reserved">double</strong>[30];
<a id="L182" name="L182"></a> 182         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] newChoiceFormats = <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[30];
<a id="L183" name="L183"></a> 183         <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L184" name="L184"></a> 184         <strong class="reserved">int</strong> part = 0;
<a id="L185" name="L185"></a> 185         <strong class="reserved">double</strong> startValue = 0;
<a id="L186" name="L186"></a> 186         <strong class="reserved">double</strong> oldStartValue = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NaN;
<a id="L187" name="L187"></a> 187         <strong class="reserved">boolean</strong> inQuote = <strong class="reserved">false</strong>;
<a id="L188" name="L188"></a> 188         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; newPattern.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>(); ++i) <em class="brace">{</em>
<a id="L189" name="L189"></a> 189             <strong class="reserved">char</strong> ch = newPattern.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L190" name="L190"></a> 190             <strong class="reserved">if</strong> (ch=='\'') <em class="brace">{</em>
<a id="L191" name="L191"></a> 191                 <em class="comment">// Check for "''" indicating a literal quote</em>
<a id="L192" name="L192"></a> 192                 <strong class="reserved">if</strong> ((i+1)&lt;newPattern.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &amp;&amp; newPattern.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i+1)==ch) <em class="brace">{</em>
<a id="L193" name="L193"></a> 193                     segments[part].<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ch);
<a id="L194" name="L194"></a> 194                     ++i;
<a id="L195" name="L195"></a> 195                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L196" name="L196"></a> 196                     inQuote = !inQuote;
<a id="L197" name="L197"></a> 197                 <em class="brace">}</em>
<a id="L198" name="L198"></a> 198             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (inQuote) <em class="brace">{</em>
<a id="L199" name="L199"></a> 199                 segments[part].<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ch);
<a id="L200" name="L200"></a> 200             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (ch == '&lt;' || ch == '#' || ch == '\u2264') <em class="brace">{</em>
<a id="L201" name="L201"></a> 201                 <strong class="reserved">if</strong> (segments[0].<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 0) <em class="brace">{</em>
<a id="L202" name="L202"></a> 202                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L203" name="L203"></a> 203                 <em class="brace">}</em>
<a id="L204" name="L204"></a> 204                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L205" name="L205"></a> 205                     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> tempBuffer = segments[0].<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L206" name="L206"></a> 206                     <strong class="reserved">if</strong> (tempBuffer.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("\u221E")) <em class="brace">{</em>
<a id="L207" name="L207"></a> 207                         startValue = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.POSITIVE_INFINITY;
<a id="L208" name="L208"></a> 208                     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (tempBuffer.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("-\u221E")) <em class="brace">{</em>
<a id="L209" name="L209"></a> 209                         startValue = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NEGATIVE_INFINITY;
<a id="L210" name="L210"></a> 210                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L211" name="L211"></a> 211                         startValue = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(segments[0].<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>()).<a href="../D/15134.html" title="Multiple defined in 16 places.">doubleValue</a>();
<a id="L212" name="L212"></a> 212                     <em class="brace">}</em>
<a id="L213" name="L213"></a> 213                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L214" name="L214"></a> 214                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L215" name="L215"></a> 215                 <em class="brace">}</em>
<a id="L216" name="L216"></a> 216                 <strong class="reserved">if</strong> (ch == '&lt;' &amp;&amp; startValue != <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.POSITIVE_INFINITY &amp;&amp;
<a id="L217" name="L217"></a> 217                         startValue != <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NEGATIVE_INFINITY) <em class="brace">{</em>
<a id="L218" name="L218"></a> 218                     startValue = <a href="../D/28143.html" title="Multiple defined in 12 places.">nextDouble</a>(startValue);
<a id="L219" name="L219"></a> 219                 <em class="brace">}</em>
<a id="L220" name="L220"></a> 220                 <strong class="reserved">if</strong> (startValue &lt;= oldStartValue) <em class="brace">{</em>
<a id="L221" name="L221"></a> 221                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L222" name="L222"></a> 222                 <em class="brace">}</em>
<a id="L223" name="L223"></a> 223                 segments[0].<a href="../D/33077.html" title="Multiple defined in 10 places.">setLength</a>(0);
<a id="L224" name="L224"></a> 224                 part = 1;
<a id="L225" name="L225"></a> 225             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (ch == '|') <em class="brace">{</em>
<a id="L226" name="L226"></a> 226                 <strong class="reserved">if</strong> (<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> == newChoiceLimits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L227" name="L227"></a> 227                     newChoiceLimits = <a href="../D/15125.html" title="Multiple defined in 2 places.">doubleArraySize</a>(newChoiceLimits);
<a id="L228" name="L228"></a> 228                     newChoiceFormats = <a href="../D/15125.html" title="Multiple defined in 2 places.">doubleArraySize</a>(newChoiceFormats);
<a id="L229" name="L229"></a> 229                 <em class="brace">}</em>
<a id="L230" name="L230"></a> 230                 newChoiceLimits[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>] = startValue;
<a id="L231" name="L231"></a> 231                 newChoiceFormats[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>] = segments[1].<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L232" name="L232"></a> 232                 ++<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;
<a id="L233" name="L233"></a> 233                 oldStartValue = startValue;
<a id="L234" name="L234"></a> 234                 segments[1].<a href="../D/33077.html" title="Multiple defined in 10 places.">setLength</a>(0);
<a id="L235" name="L235"></a> 235                 part = 0;
<a id="L236" name="L236"></a> 236             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L237" name="L237"></a> 237                 segments[part].<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ch);
<a id="L238" name="L238"></a> 238             <em class="brace">}</em>
<a id="L239" name="L239"></a> 239         <em class="brace">}</em>
<a id="L240" name="L240"></a> 240         <em class="comment">// clean up last one</em>
<a id="L241" name="L241"></a> 241         <strong class="reserved">if</strong> (part == 1) <em class="brace">{</em>
<a id="L242" name="L242"></a> 242             <strong class="reserved">if</strong> (<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> == newChoiceLimits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L243" name="L243"></a> 243                 newChoiceLimits = <a href="../D/15125.html" title="Multiple defined in 2 places.">doubleArraySize</a>(newChoiceLimits);
<a id="L244" name="L244"></a> 244                 newChoiceFormats = <a href="../D/15125.html" title="Multiple defined in 2 places.">doubleArraySize</a>(newChoiceFormats);
<a id="L245" name="L245"></a> 245             <em class="brace">}</em>
<a id="L246" name="L246"></a> 246             newChoiceLimits[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>] = startValue;
<a id="L247" name="L247"></a> 247             newChoiceFormats[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>] = segments[1].<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L248" name="L248"></a> 248             ++<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;
<a id="L249" name="L249"></a> 249         <em class="brace">}</em>
<a id="L250" name="L250"></a> 250         choiceLimits = <strong class="reserved">new</strong> <strong class="reserved">double</strong>[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>];
<a id="L251" name="L251"></a> 251         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(newChoiceLimits, 0, choiceLimits, 0, <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>);
<a id="L252" name="L252"></a> 252         choiceFormats = <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>];
<a id="L253" name="L253"></a> 253         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(newChoiceFormats, 0, choiceFormats, 0, <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>);
<a id="L254" name="L254"></a> 254     <em class="brace">}</em>
<a id="L255" name="L255"></a> 255 
<div class="comment">
      Gets the pattern.
      @return the pattern string</div>
<a id="L261" name="L261"></a> 261     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29311.html" title="Multiple referred from 6 places.">toPattern</a>() <em class="brace">{</em>
<a id="L262" name="L262"></a> 262         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L263" name="L263"></a> 263         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; choiceLimits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; ++i) <em class="brace">{</em>
<a id="L264" name="L264"></a> 264             <strong class="reserved">if</strong> (i != 0) <em class="brace">{</em>
<a id="L265" name="L265"></a> 265                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('|');
<a id="L266" name="L266"></a> 266             <em class="brace">}</em>
<a id="L267" name="L267"></a> 267             <em class="comment">// choose based upon which has less precision</em>
<a id="L268" name="L268"></a> 268             <em class="comment">// approximate that by choosing the closest one to an integer.</em>
<a id="L269" name="L269"></a> 269             <em class="comment">// could do better, but it's not worth it.</em>
<a id="L270" name="L270"></a> 270             <strong class="reserved">double</strong> less = <a href="../S/2472.html#L464" title="Defined at 464 in src/java/text/ChoiceFormat.java.">previousDouble</a>(choiceLimits[i]);
<a id="L271" name="L271"></a> 271             <strong class="reserved">double</strong> tryLessOrEqual = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/10523.html" title="Multiple defined in 14 places.">abs</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/3865.html" title="Multiple defined in 2 places.">IEEEremainder</a>(choiceLimits[i], 1.0d));
<a id="L272" name="L272"></a> 272             <strong class="reserved">double</strong> tryLess = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/10523.html" title="Multiple defined in 14 places.">abs</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/3865.html" title="Multiple defined in 2 places.">IEEEremainder</a>(less, 1.0d));
<a id="L273" name="L273"></a> 273 
<a id="L274" name="L274"></a> 274             <strong class="reserved">if</strong> (tryLessOrEqual &lt; tryLess) <em class="brace">{</em>
<a id="L275" name="L275"></a> 275                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(""+choiceLimits[i]);
<a id="L276" name="L276"></a> 276                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('#');
<a id="L277" name="L277"></a> 277             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L278" name="L278"></a> 278                 <strong class="reserved">if</strong> (choiceLimits[i] == <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.POSITIVE_INFINITY) <em class="brace">{</em>
<a id="L279" name="L279"></a> 279                     <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("\u221E");
<a id="L280" name="L280"></a> 280                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (choiceLimits[i] == <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NEGATIVE_INFINITY) <em class="brace">{</em>
<a id="L281" name="L281"></a> 281                     <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("-\u221E");
<a id="L282" name="L282"></a> 282                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L283" name="L283"></a> 283                     <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(""+less);
<a id="L284" name="L284"></a> 284                 <em class="brace">}</em>
<a id="L285" name="L285"></a> 285                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('&lt;');
<a id="L286" name="L286"></a> 286             <em class="brace">}</em>
<a id="L287" name="L287"></a> 287             <em class="comment">// Append choiceFormats[i], using quotes if there are special characters.</em>
<a id="L288" name="L288"></a> 288             <em class="comment">// Single quotes themselves must be escaped in either case.</em>
<a id="L289" name="L289"></a> 289             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a> = choiceFormats[i];
<a id="L290" name="L290"></a> 290             <strong class="reserved">boolean</strong> needQuote = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('&lt;') &gt;= 0
<a id="L291" name="L291"></a> 291                 || <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('#') &gt;= 0
<a id="L292" name="L292"></a> 292                 || <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('\u2264') &gt;= 0
<a id="L293" name="L293"></a> 293                 || <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('|') &gt;= 0;
<a id="L294" name="L294"></a> 294             <strong class="reserved">if</strong> (needQuote) <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('\'');
<a id="L295" name="L295"></a> 295             <strong class="reserved">if</strong> (<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('\'') &lt; 0) <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>);
<a id="L296" name="L296"></a> 296             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L297" name="L297"></a> 297                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> j=0; j&lt;<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>(); ++j) <em class="brace">{</em>
<a id="L298" name="L298"></a> 298                     <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(j);
<a id="L299" name="L299"></a> 299                     <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L300" name="L300"></a> 300                     <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == '\'') <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L301" name="L301"></a> 301                 <em class="brace">}</em>
<a id="L302" name="L302"></a> 302             <em class="brace">}</em>
<a id="L303" name="L303"></a> 303             <strong class="reserved">if</strong> (needQuote) <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('\'');
<a id="L304" name="L304"></a> 304         <em class="brace">}</em>
<a id="L305" name="L305"></a> 305         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L306" name="L306"></a> 306     <em class="brace">}</em>
<a id="L307" name="L307"></a> 307 
<div class="comment">
      Constructs with limits and corresponding formats based on the pattern.
      @param newPattern the new pattern string
      @see #applyPattern</div>
<a id="L314" name="L314"></a> 314     <strong class="reserved">public</strong> ChoiceFormat(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> newPattern)  <em class="brace">{</em>
<a id="L315" name="L315"></a> 315         <a href="../D/11458.html" title="Multiple defined in 5 places.">applyPattern</a>(newPattern);
<a id="L316" name="L316"></a> 316     <em class="brace">}</em>
<a id="L317" name="L317"></a> 317 
<div class="comment">
      Constructs with the limits and the corresponding formats.
      @param limits limits in ascending order
      @param formats corresponding format strings
      @see #setChoices</div>
<a id="L325" name="L325"></a> 325     <strong class="reserved">public</strong> ChoiceFormat(<strong class="reserved">double</strong>[] limits, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] formats) <em class="brace">{</em>
<a id="L326" name="L326"></a> 326         <a href="../S/2472.html#L343" title="Defined at 343 in src/java/text/ChoiceFormat.java.">setChoices</a>(limits, formats);
<a id="L327" name="L327"></a> 327     <em class="brace">}</em>
<a id="L328" name="L328"></a> 328 
<div class="comment">
      Set the choices to be used in formatting.
      @param limits contains the top value that you want
      parsed with that format, and should be in ascending sorted order. When
      formatting X, the choice will be the i, where
      limit[i] ≤ X {@literal &lt;} limit[i+1].
      If the limit array is not in ascending order, the results of formatting
      will be incorrect.
      @param formats are the formats you want to use for each limit.
      They can be either Format objects or Strings.
      When formatting with object Y,
      if the object is a NumberFormat, then ((NumberFormat) Y).format(X)
      is called. Otherwise Y.toString() is called.</div>
<a id="L343" name="L343"></a> 343     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/2472.html#L326" title="Referred from 326 in src/java/text/ChoiceFormat.java.">setChoices</a>(<strong class="reserved">double</strong>[] limits, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> formats[]) <em class="brace">{</em>
<a id="L344" name="L344"></a> 344         <strong class="reserved">if</strong> (limits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != formats.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L345" name="L345"></a> 345             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L346" name="L346"></a> 346                 "Array and limit arrays must be of the same length.");
<a id="L347" name="L347"></a> 347         <em class="brace">}</em>
<a id="L348" name="L348"></a> 348         choiceLimits = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13512.html" title="Multiple defined in 12 places.">copyOf</a>(limits, limits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L349" name="L349"></a> 349         choiceFormats = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13512.html" title="Multiple defined in 12 places.">copyOf</a>(formats, formats.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L350" name="L350"></a> 350     <em class="brace">}</em>
<a id="L351" name="L351"></a> 351 
<div class="comment">
      Get the limits passed in the constructor.
      @return the limits.</div>
<a id="L356" name="L356"></a> 356     <strong class="reserved">public</strong> <strong class="reserved">double</strong>[] getLimits() <em class="brace">{</em>
<a id="L357" name="L357"></a> 357         <strong class="reserved">double</strong>[] newLimits = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13512.html" title="Multiple defined in 12 places.">copyOf</a>(choiceLimits, choiceLimits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L358" name="L358"></a> 358         <strong class="reserved">return</strong> newLimits;
<a id="L359" name="L359"></a> 359     <em class="brace">}</em>
<a id="L360" name="L360"></a> 360 
<div class="comment">
      Get the formats passed in the constructor.
      @return the formats.</div>
<a id="L365" name="L365"></a> 365     <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <a href="../R/16698.html" title="Multiple referred from 4 places.">getFormats</a>() <em class="brace">{</em>
<a id="L366" name="L366"></a> 366         <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] newFormats = <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/13512.html" title="Multiple defined in 12 places.">copyOf</a>(choiceFormats, choiceFormats.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L367" name="L367"></a> 367         <strong class="reserved">return</strong> newFormats;
<a id="L368" name="L368"></a> 368     <em class="brace">}</em>
<a id="L369" name="L369"></a> 369 
<a id="L370" name="L370"></a> 370     <em class="comment">// Overrides</em>
<a id="L371" name="L371"></a> 371 
<div class="comment">
      Specialization of format. This method really calls
      <code>format(double, StringBuffer, FieldPosition)</code>
      thus the range of longs that are supported is only equal to
      the range that can be stored by double. This will never be
      a practical limitation.</div>
<a id="L379" name="L379"></a> 379     <strong class="reserved">public</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../R/14747.html" title="Multiple referred from 768 places.">format</a>(<strong class="reserved">long</strong> <a href="../S/4997.html#L491" title="Defined at 491 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">number</a>, <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> toAppendTo,
<a id="L380" name="L380"></a> 380                                <a href="../S/2490.html#L73" title="Defined at 73 in src/java/text/FieldPosition.java.">FieldPosition</a> <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>) <em class="brace">{</em>
<a id="L381" name="L381"></a> 381         <strong class="reserved">return</strong> <a href="../D/16531.html" title="Multiple defined in 87 places.">format</a>((<strong class="reserved">double</strong>)<a href="../S/4997.html#L491" title="Defined at 491 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">number</a>, toAppendTo, <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>);
<a id="L382" name="L382"></a> 382     <em class="brace">}</em>
<a id="L383" name="L383"></a> 383 
<div class="comment">
      Returns pattern with formatted double.
      @param number number to be formatted and substituted.
      @param toAppendTo where text is appended.
      @param status ignore no useful status is returned.</div>
<a id="L390" name="L390"></a> 390    <strong class="reserved">public</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../R/14747.html" title="Multiple referred from 768 places.">format</a>(<strong class="reserved">double</strong> <a href="../S/4997.html#L491" title="Defined at 491 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">number</a>, <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> toAppendTo,
<a id="L391" name="L391"></a> 391                                <a href="../S/2490.html#L73" title="Defined at 73 in src/java/text/FieldPosition.java.">FieldPosition</a> <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>) <em class="brace">{</em>
<a id="L392" name="L392"></a> 392         <em class="comment">// find the number</em>
<a id="L393" name="L393"></a> 393         <strong class="reserved">int</strong> i;
<a id="L394" name="L394"></a> 394         <strong class="reserved">for</strong> (i = 0; i &lt; choiceLimits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; ++i) <em class="brace">{</em>
<a id="L395" name="L395"></a> 395             <strong class="reserved">if</strong> (!(<a href="../S/4997.html#L491" title="Defined at 491 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">number</a> &gt;= choiceLimits[i])) <em class="brace">{</em>
<a id="L396" name="L396"></a> 396                 <em class="comment">// same as number &lt; choiceLimits, except catchs NaN</em>
<a id="L397" name="L397"></a> 397                 <strong class="reserved">break</strong>;
<a id="L398" name="L398"></a> 398             <em class="brace">}</em>
<a id="L399" name="L399"></a> 399         <em class="brace">}</em>
<a id="L400" name="L400"></a> 400         --i;
<a id="L401" name="L401"></a> 401         <strong class="reserved">if</strong> (i &lt; 0) i = 0;
<a id="L402" name="L402"></a> 402         <em class="comment">// return either a formatted number, or a string</em>
<a id="L403" name="L403"></a> 403         <strong class="reserved">return</strong> toAppendTo.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(choiceFormats[i]);
<a id="L404" name="L404"></a> 404     <em class="brace">}</em>
<a id="L405" name="L405"></a> 405 
<div class="comment">
      Parses a Number from the input text.
      @param text the source text.
      @param status an input-output parameter.  On input, the
      status.index field indicates the first character of the
      source text that should be parsed.  On exit, if no error
      occurred, status.index is set to the first unparsed character
      in the source text.  On exit, if an error did occur,
      status.index is unchanged and status.errorIndex is set to the
      first index of the character that caused the parse to fail.
      @return A Number representing the value of the number parsed.</div>
<a id="L418" name="L418"></a> 418     <strong class="reserved">public</strong> <a href="../D/6185.html" title="Multiple defined in 4 places.">Number</a> <a href="../R/24493.html" title="Multiple referred from 256 places.">parse</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, <a href="../S/2483.html#L57" title="Defined at 57 in src/java/text/ParsePosition.java.">ParsePosition</a> <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>) <em class="brace">{</em>
<a id="L419" name="L419"></a> 419         <em class="comment">// find the best number (defined as the one with the longest parse)</em>
<a id="L420" name="L420"></a> 420         <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L421" name="L421"></a> 421         <strong class="reserved">int</strong> furthest = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L422" name="L422"></a> 422         <strong class="reserved">double</strong> bestNumber = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.NaN;
<a id="L423" name="L423"></a> 423         <strong class="reserved">double</strong> tempNumber = 0.0;
<a id="L424" name="L424"></a> 424         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; choiceFormats.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; ++i) <em class="brace">{</em>
<a id="L425" name="L425"></a> 425             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> tempString = choiceFormats[i];
<a id="L426" name="L426"></a> 426             <strong class="reserved">if</strong> (<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/30514.html" title="Multiple defined in 14 places.">regionMatches</a>(<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, tempString, 0, tempString.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>())) <em class="brace">{</em>
<a id="L427" name="L427"></a> 427                 <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> + tempString.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L428" name="L428"></a> 428                 tempNumber = choiceLimits[i];
<a id="L429" name="L429"></a> 429                 <strong class="reserved">if</strong> (<a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt; furthest) <em class="brace">{</em>
<a id="L430" name="L430"></a> 430                     furthest = <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L431" name="L431"></a> 431                     bestNumber = tempNumber;
<a id="L432" name="L432"></a> 432                     <strong class="reserved">if</strong> (furthest == <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <strong class="reserved">break</strong>;
<a id="L433" name="L433"></a> 433                 <em class="brace">}</em>
<a id="L434" name="L434"></a> 434             <em class="brace">}</em>
<a id="L435" name="L435"></a> 435         <em class="brace">}</em>
<a id="L436" name="L436"></a> 436         <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = furthest;
<a id="L437" name="L437"></a> 437         <strong class="reserved">if</strong> (<a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>) <em class="brace">{</em>
<a id="L438" name="L438"></a> 438             <a href="../S/2277.html#L669" title="Defined at 669 in src/java/awt/image/PixelGrabber.java.">status</a>.errorIndex = furthest;
<a id="L439" name="L439"></a> 439         <em class="brace">}</em>
<a id="L440" name="L440"></a> 440         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>(bestNumber);
<a id="L441" name="L441"></a> 441     <em class="brace">}</em>
<a id="L442" name="L442"></a> 442 
<div class="comment">
      Finds the least double greater than <code>d</code>.
      If <code>NaN</code>, returns same value.
      <p>Used to make half-open intervals.
      @param d the reference value
      @return the least double value greather than <code>d</code>
      @see #previousDouble</p></div>
<a id="L452" name="L452"></a> 452     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">double</strong> <a href="../R/23659.html" title="Multiple referred from 15 places.">nextDouble</a> (<strong class="reserved">double</strong> d) <em class="brace">{</em>
<a id="L453" name="L453"></a> 453         <strong class="reserved">return</strong> <a href="../D/28143.html" title="Multiple defined in 12 places.">nextDouble</a>(d,<strong class="reserved">true</strong>);
<a id="L454" name="L454"></a> 454     <em class="brace">}</em>
<a id="L455" name="L455"></a> 455 
<div class="comment">
      Finds the greatest double less than <code>d</code>.
      If <code>NaN</code>, returns same value.
      @param d the reference value
      @return the greatest double value less than <code>d</code>
      @see #nextDouble</div>
<a id="L464" name="L464"></a> 464     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">double</strong> <a href="../S/2472.html#L270" title="Referred from 270 in src/java/text/ChoiceFormat.java.">previousDouble</a> (<strong class="reserved">double</strong> d) <em class="brace">{</em>
<a id="L465" name="L465"></a> 465         <strong class="reserved">return</strong> <a href="../D/28143.html" title="Multiple defined in 12 places.">nextDouble</a>(d,<strong class="reserved">false</strong>);
<a id="L466" name="L466"></a> 466     <em class="brace">}</em>
<a id="L467" name="L467"></a> 467 
<div class="comment">
      Overrides Cloneable</div>
<a id="L471" name="L471"></a> 471     <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/11555.html" title="Multiple referred from 1378 places.">clone</a>()
<a id="L472" name="L472"></a> 472     <em class="brace">{</em>
<a id="L473" name="L473"></a> 473         <a href="../S/2472.html#L167" title="Defined at 167 in src/java/text/ChoiceFormat.java.">ChoiceFormat</a> other = (<a href="../S/2472.html#L167" title="Defined at 167 in src/java/text/ChoiceFormat.java.">ChoiceFormat</a>) <strong class="reserved">super</strong>.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L474" name="L474"></a> 474         <em class="comment">// for primitives or immutables, shallow clone is enough</em>
<a id="L475" name="L475"></a> 475         other.choiceLimits = choiceLimits.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L476" name="L476"></a> 476         other.choiceFormats = choiceFormats.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L477" name="L477"></a> 477         <strong class="reserved">return</strong> other;
<a id="L478" name="L478"></a> 478     <em class="brace">}</em>
<a id="L479" name="L479"></a> 479 
<div class="comment">
      Generates a hash code for the message format object.</div>
<a id="L483" name="L483"></a> 483     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/20298.html" title="Multiple referred from 715 places.">hashCode</a>() <em class="brace">{</em>
<a id="L484" name="L484"></a> 484         <strong class="reserved">int</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = choiceLimits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L485" name="L485"></a> 485         <strong class="reserved">if</strong> (choiceFormats.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; 0) <em class="brace">{</em>
<a id="L486" name="L486"></a> 486             <em class="comment">// enough for reasonable distribution</em>
<a id="L487" name="L487"></a> 487             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> ^= choiceFormats[choiceFormats.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>-1].<a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>();
<a id="L488" name="L488"></a> 488         <em class="brace">}</em>
<a id="L489" name="L489"></a> 489         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L490" name="L490"></a> 490     <em class="brace">}</em>
<a id="L491" name="L491"></a> 491 
<div class="comment">
      Equality comparision between two</div>
<a id="L495" name="L495"></a> 495     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13992.html" title="Multiple referred from 5400 places.">equals</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> obj) <em class="brace">{</em>
<a id="L496" name="L496"></a> 496         <strong class="reserved">if</strong> (obj == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L497" name="L497"></a> 497         <strong class="reserved">if</strong> (<strong class="reserved">this</strong> == obj)                      <em class="comment">// quick check</em>
<a id="L498" name="L498"></a> 498             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L499" name="L499"></a> 499         <strong class="reserved">if</strong> (<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>() != obj.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>())
<a id="L500" name="L500"></a> 500             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L501" name="L501"></a> 501         <a href="../S/2472.html#L167" title="Defined at 167 in src/java/text/ChoiceFormat.java.">ChoiceFormat</a> other = (<a href="../S/2472.html#L167" title="Defined at 167 in src/java/text/ChoiceFormat.java.">ChoiceFormat</a>) obj;
<a id="L502" name="L502"></a> 502         <strong class="reserved">return</strong> (<a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(choiceLimits, other.choiceLimits)
<a id="L503" name="L503"></a> 503              &amp;&amp; <a href="../S/1150.html#L71" title="Defined at 71 in src/java/util/Arrays.java.">Arrays</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(choiceFormats, other.choiceFormats));
<a id="L504" name="L504"></a> 504     <em class="brace">}</em>
<a id="L505" name="L505"></a> 505 
<div class="comment">
      After reading an object from the input stream, do a simple verification
      to maintain class invariants.
      @throws InvalidObjectException if the objects read from the stream is invalid.</div>
<a id="L511" name="L511"></a> 511     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25518.html" title="Multiple referred from 189 places.">readObject</a>(<a href="../S/1378.html#L206" title="Defined at 206 in src/java/io/ObjectInputStream.java.">ObjectInputStream</a> <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a> <em class="brace">{</em>
<a id="L512" name="L512"></a> 512         <a href="../D/24395.html" title="Multiple defined in 2 places.">in</a>.<a href="../D/14746.html" title="Multiple defined in 2 places.">defaultReadObject</a>();
<a id="L513" name="L513"></a> 513         <strong class="reserved">if</strong> (choiceLimits.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != choiceFormats.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L514" name="L514"></a> 514             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1428.html#L38" title="Defined at 38 in src/java/io/InvalidObjectException.java.">InvalidObjectException</a>(
<a id="L515" name="L515"></a> 515                     "limits and format arrays of different length.");
<a id="L516" name="L516"></a> 516         <em class="brace">}</em>
<a id="L517" name="L517"></a> 517     <em class="brace">}</em>
<a id="L518" name="L518"></a> 518 
<a id="L519" name="L519"></a> 519     <em class="comment">// ===============privates===========================</em>
<a id="L520" name="L520"></a> 520 
<div class="comment">
      A list of lower bounds for the choices.  The formatter will return
      <code>choiceFormats[i]</code> if the number being formatted is greater than or equal to
      <code>choiceLimits[i]</code> and less than <code>choiceLimits[i+1]</code>.
      @serial</div>
<a id="L527" name="L527"></a> 527     <strong class="reserved">private</strong> <strong class="reserved">double</strong>[] choiceLimits;
<a id="L528" name="L528"></a> 528 
<div class="comment">
      A list of choice strings.  The formatter will return
      <code>choiceFormats[i]</code> if the number being formatted is greater than or equal to
      <code>choiceLimits[i]</code> and less than <code>choiceLimits[i+1]</code>.
      @serial</div>
<a id="L535" name="L535"></a> 535     <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] choiceFormats;
<a id="L536" name="L536"></a> 536 
<div class="comment">
    static final long SIGN          = 0x8000000000000000L;
    static final long EXPONENT      = 0x7FF0000000000000L;
    static final long SIGNIFICAND   = 0x000FFFFFFFFFFFFFL;
    private static double nextDouble (double d, boolean positive) {
        if (Double.isNaN(d) || Double.isInfinite(d)) {
                return d;
            }
        long bits = Double.doubleToLongBits(d);
        long significand = bits &amp; SIGNIFICAND;
        if (bits &lt; 0) {
            significand |= (SIGN | EXPONENT);
        }
        long exponent = bits &amp; EXPONENT;
        if (positive) {
            significand += 1;
            // FIXME fix overflow &amp; underflow
        } else {
            significand -= 1;
            // FIXME fix overflow &amp; underflow
        }
        bits = exponent | (significand &amp; ~EXPONENT);
        return Double.longBitsToDouble(bits);
    }</div>
<a id="L563" name="L563"></a> 563 
<a id="L564" name="L564"></a> 564     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> SIGN                = 0x8000000000000000L;
<a id="L565" name="L565"></a> 565     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> EXPONENT            = 0x7FF0000000000000L;
<a id="L566" name="L566"></a> 566     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> POSITIVEINFINITY    = 0x7FF0000000000000L;
<a id="L567" name="L567"></a> 567 
<div class="comment">
      Finds the least double greater than <code>d</code> (if <code>positive</code> is
      <code>true</code>), or the greatest double less than <code>d</code> (if
      <code>positive</code> is <code>false</code>).
      If <code>NaN</code>, returns same value.
      Does not affect floating-point flags,
      provided these member functions do not:
               Double.longBitsToDouble(long)
               Double.doubleToLongBits(double)
               Double.isNaN(double)
      @param d        the reference value
      @param positive <code>true</code> if the least double is desired;
                      <code>false</code> otherwise
      @return the least or greater double value</div>
<a id="L585" name="L585"></a> 585     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">double</strong> <a href="../R/23659.html" title="Multiple referred from 15 places.">nextDouble</a> (<strong class="reserved">double</strong> d, <strong class="reserved">boolean</strong> positive) <em class="brace">{</em>
<a id="L586" name="L586"></a> 586 
<div class="comment">
         /* filter out NaN's */</div>
<a id="L588" name="L588"></a> 588         <strong class="reserved">if</strong> (<a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.<a href="../D/25912.html" title="Multiple defined in 4 places.">isNaN</a>(d)) <em class="brace">{</em>
<a id="L589" name="L589"></a> 589             <strong class="reserved">return</strong> d;
<a id="L590" name="L590"></a> 590         <em class="brace">}</em>
<a id="L591" name="L591"></a> 591 
<div class="comment">
         /* zero's are also a special case */</div>
<a id="L593" name="L593"></a> 593         <strong class="reserved">if</strong> (d == 0.0) <em class="brace">{</em>
<a id="L594" name="L594"></a> 594             <strong class="reserved">double</strong> smallestPositiveDouble = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.<a href="../S/1746.html#L945" title="Defined at 945 in src/java/lang/Double.java.">longBitsToDouble</a>(1L);
<a id="L595" name="L595"></a> 595             <strong class="reserved">if</strong> (positive) <em class="brace">{</em>
<a id="L596" name="L596"></a> 596                 <strong class="reserved">return</strong> smallestPositiveDouble;
<a id="L597" name="L597"></a> 597             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L598" name="L598"></a> 598                 <strong class="reserved">return</strong> -smallestPositiveDouble;
<a id="L599" name="L599"></a> 599             <em class="brace">}</em>
<a id="L600" name="L600"></a> 600         <em class="brace">}</em>
<a id="L601" name="L601"></a> 601 
<div class="comment">
         /* if entering here, d is a nonzero value */</div>
<a id="L603" name="L603"></a> 603 
<div class="comment">
         /* hold all bits in a long for later use */</div>
<a id="L605" name="L605"></a> 605         <strong class="reserved">long</strong> bits = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.<a href="../S/1746.html#L835" title="Defined at 835 in src/java/lang/Double.java.">doubleToLongBits</a>(d);
<a id="L606" name="L606"></a> 606 
<div class="comment">
         /* strip off the sign bit */</div>
<a id="L608" name="L608"></a> 608         <strong class="reserved">long</strong> magnitude = bits &amp; ~SIGN;
<a id="L609" name="L609"></a> 609 
<div class="comment">
         /* if next double away from zero, increase magnitude */</div>
<a id="L611" name="L611"></a> 611         <strong class="reserved">if</strong> ((bits &gt; 0) == positive) <em class="brace">{</em>
<a id="L612" name="L612"></a> 612             <strong class="reserved">if</strong> (magnitude != POSITIVEINFINITY) <em class="brace">{</em>
<a id="L613" name="L613"></a> 613                 magnitude += 1;
<a id="L614" name="L614"></a> 614             <em class="brace">}</em>
<a id="L615" name="L615"></a> 615         <em class="brace">}</em>
<div class="comment">
         /* else decrease magnitude */</div>
<a id="L617" name="L617"></a> 617         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L618" name="L618"></a> 618             magnitude -= 1;
<a id="L619" name="L619"></a> 619         <em class="brace">}</em>
<a id="L620" name="L620"></a> 620 
<div class="comment">
         /* restore sign bit and return */</div>
<a id="L622" name="L622"></a> 622         <strong class="reserved">long</strong> signbit = bits &amp; SIGN;
<a id="L623" name="L623"></a> 623         <strong class="reserved">return</strong> <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.<a href="../S/1746.html#L945" title="Defined at 945 in src/java/lang/Double.java.">longBitsToDouble</a> (magnitude | signbit);
<a id="L624" name="L624"></a> 624     <em class="brace">}</em>
<a id="L625" name="L625"></a> 625 
<a id="L626" name="L626"></a> 626     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">double</strong>[] <a href="../R/13482.html" title="Multiple referred from 4 places.">doubleArraySize</a>(<strong class="reserved">double</strong>[] <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>) <em class="brace">{</em>
<a id="L627" name="L627"></a> 627         <strong class="reserved">int</strong> oldSize = <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L628" name="L628"></a> 628         <strong class="reserved">double</strong>[] <a href="../D/27956.html" title="Multiple defined in 13 places.">newArray</a> = <strong class="reserved">new</strong> <strong class="reserved">double</strong>[oldSize * 2];
<a id="L629" name="L629"></a> 629         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, 0, <a href="../D/27956.html" title="Multiple defined in 13 places.">newArray</a>, 0, oldSize);
<a id="L630" name="L630"></a> 630         <strong class="reserved">return</strong> <a href="../D/27956.html" title="Multiple defined in 13 places.">newArray</a>;
<a id="L631" name="L631"></a> 631     <em class="brace">}</em>
<a id="L632" name="L632"></a> 632 
<a id="L633" name="L633"></a> 633     <strong class="reserved">private</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] <a href="../R/13482.html" title="Multiple referred from 4 places.">doubleArraySize</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>) <em class="brace">{</em>
<a id="L634" name="L634"></a> 634         <strong class="reserved">int</strong> oldSize = <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L635" name="L635"></a> 635         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] <a href="../D/27956.html" title="Multiple defined in 13 places.">newArray</a> = <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[oldSize * 2];
<a id="L636" name="L636"></a> 636         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, 0, <a href="../D/27956.html" title="Multiple defined in 13 places.">newArray</a>, 0, oldSize);
<a id="L637" name="L637"></a> 637         <strong class="reserved">return</strong> <a href="../D/27956.html" title="Multiple defined in 13 places.">newArray</a>;
<a id="L638" name="L638"></a> 638     <em class="brace">}</em>
<a id="L639" name="L639"></a> 639 
<a id="L640" name="L640"></a> 640 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L176">[^]</a><a href="#L633">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>