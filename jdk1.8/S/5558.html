<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xml/internal/serializer/WriterToUTF8Buffered.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L135">[^]</a><a href="#L499">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L135" title="Defined at 135.">write</a></li>
<li><a href="#L181" title="Defined at 181.">write</a></li>
<li><a href="#L319" title="Defined at 319.">write</a></li>
<li><a href="#L445" title="Defined at 445.">flushBuffer</a></li>
<li><a href="#L467" title="Defined at 467.">flush</a></li>
<li><a href="#L482" title="Defined at 482.">close</a></li>
<li><a href="#L494" title="Defined at 494.">getOutputStream</a></li>
<li><a href="#L499" title="Defined at 499.">getWriter</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2005 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: WriterToUTF8Buffered.java,v 1.2.4.1 2005/09/15 08:15:31 suresh_emailid Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xml.internal.serializer;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> java.io.IOException;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> java.io.OutputStream;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.io.UnsupportedEncodingException;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.Writer;
<a id="L29" name="L29"></a>  29 
<a id="L30" name="L30"></a>  30 
<div class="comment">
  This class writes unicode characters to a byte stream (java.io.OutputStream)
  as quickly as possible. It buffers the output in an internal
  buffer which must be flushed to the OutputStream when done. This flushing
  is done via the close() flush() or flushBuffer() method.
  This class is only used internally within Xalan.
  @xsl.usage internal</div>
<a id="L41" name="L41"></a>  41 <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/8893.html" title="Multiple referred from 6 places.">WriterToUTF8Buffered</a> <strong class="reserved">extends</strong> <a href="../S/1393.html#L50" title="Defined at 50 in src/java/io/Writer.java.">Writer</a> <strong class="reserved">implements</strong> <a href="../S/5553.html#L53" title="Defined at 53 in src/com/sun/org/apache/xml/internal/serializer/WriterChain.java.">WriterChain</a>
<a id="L42" name="L42"></a>  42 <em class="brace">{</em>
<a id="L43" name="L43"></a>  43 
<div class="comment">
 number of bytes that the byte buffer can hold.
    This is a fixed constant is used rather than m_outputBytes.lenght for performance.</div>
<a id="L47" name="L47"></a>  47   <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> BYTES_MAX=16*1024;
<div class="comment">
 number of characters that the character buffer can hold.
    This is 1/3 of the number of bytes because UTF-8 encoding
    can expand one unicode character by up to 3 bytes.</div>
<a id="L52" name="L52"></a>  52   <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> CHARS_MAX=(BYTES_MAX/3);
<a id="L53" name="L53"></a>  53 
<a id="L54" name="L54"></a>  54  <em class="comment">// private static final int</em>
<a id="L55" name="L55"></a>  55 
<div class="comment">
   /** The byte stream to write to. (sc &amp; sb remove final to compile in JDK 1.1.8) */</div>
<a id="L57" name="L57"></a>  57   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> m_os;
<a id="L58" name="L58"></a>  58 
<div class="comment">
    The internal buffer where data is stored.
    (sc &amp; sb remove final to compile in JDK 1.1.8)</div>
<a id="L63" name="L63"></a>  63   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">byte</strong> m_outputBytes[];
<a id="L64" name="L64"></a>  64 
<a id="L65" name="L65"></a>  65   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">char</strong> m_inputChars[];
<a id="L66" name="L66"></a>  66 
<div class="comment">
    The number of valid bytes in the buffer. This value is always
    in the range <tt>0</tt> through <tt>m_outputBytes.length</tt>; elements
    <tt>m_outputBytes[0]</tt> through <tt>m_outputBytes[count-1]</tt> contain valid
    byte data.</div>
<a id="L73" name="L73"></a>  73   <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;
<a id="L74" name="L74"></a>  74 
<div class="comment">
    Create an buffered UTF-8 writer.
    @param   out    the underlying output stream.
    @throws UnsupportedEncodingException</div>
<a id="L83" name="L83"></a>  83   <strong class="reserved">public</strong> WriterToUTF8Buffered(<a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>)
<a id="L84" name="L84"></a>  84           <strong class="reserved">throws</strong> <a href="../S/1372.html#L33" title="Defined at 33 in src/java/io/UnsupportedEncodingException.java.">UnsupportedEncodingException</a>
<a id="L85" name="L85"></a>  85   <em class="brace">{</em>
<a id="L86" name="L86"></a>  86       m_os = <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>;
<a id="L87" name="L87"></a>  87       <em class="comment">// get 3 extra bytes to make buffer overflow checking simpler and faster</em>
<a id="L88" name="L88"></a>  88       <em class="comment">// we won't have to keep checking for a few extra characters</em>
<a id="L89" name="L89"></a>  89       m_outputBytes = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[BYTES_MAX + 3];
<a id="L90" name="L90"></a>  90 
<a id="L91" name="L91"></a>  91       <em class="comment">// Big enough to hold the input chars that will be transformed</em>
<a id="L92" name="L92"></a>  92       <em class="comment">// into output bytes in m_ouputBytes.</em>
<a id="L93" name="L93"></a>  93       m_inputChars = <strong class="reserved">new</strong> <strong class="reserved">char</strong>[CHARS_MAX + 2];
<a id="L94" name="L94"></a>  94       <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L95" name="L95"></a>  95 
<a id="L96" name="L96"></a>  96 <em class="comment">//      the old body of this constructor, before the buffersize was changed to a constant</em>
<a id="L97" name="L97"></a>  97 <em class="comment">//      this(out, 8*1024);</em>
<a id="L98" name="L98"></a>  98   <em class="brace">}</em>
<a id="L99" name="L99"></a>  99 
<div class="comment">
    Create an buffered UTF-8 writer to write data to the
    specified underlying output stream with the specified buffer
    size.
    @param   out    the underlying output stream.
    @param   size   the buffer size.
    @exception IllegalArgumentException if size &lt;= 0.</div>
<a id="L109" name="L109"></a> 109 <em class="comment">//  public WriterToUTF8Buffered(final OutputStream out, final int size)</em>
<a id="L110" name="L110"></a> 110 <em class="comment">//  {</em>
<a id="L111" name="L111"></a> 111 <em class="comment">//</em>
<a id="L112" name="L112"></a> 112 <em class="comment">//    m_os = out;</em>
<a id="L113" name="L113"></a> 113 <em class="comment">//</em>
<a id="L114" name="L114"></a> 114 <em class="comment">//    if (size &lt;= 0)</em>
<a id="L115" name="L115"></a> 115 <em class="comment">//    {</em>
<a id="L116" name="L116"></a> 116 <em class="comment">//      throw new IllegalArgumentException(</em>
<a id="L117" name="L117"></a> 117 <em class="comment">//        SerializerMessages.createMessage(SerializerErrorResources.ER_BUFFER_SIZE_LESSTHAN_ZERO, null)); //"Buffer size &lt;= 0");</em>
<a id="L118" name="L118"></a> 118 <em class="comment">//    }</em>
<a id="L119" name="L119"></a> 119 <em class="comment">//</em>
<a id="L120" name="L120"></a> 120 <em class="comment">//    m_outputBytes = new byte[size];</em>
<a id="L121" name="L121"></a> 121 <em class="comment">//    count = 0;</em>
<a id="L122" name="L122"></a> 122 <em class="comment">//  }</em>
<a id="L123" name="L123"></a> 123 
<div class="comment">
    Write a single character.  The character to be written is contained in
    the 16 low-order bits of the given integer value; the 16 high-order bits
    are ignored.
    <p> Subclasses that intend to support efficient single-character output
    should override this method.
    @param c  int specifying a character to be written.
    @exception  IOException  If an I/O error occurs</p></div>
<a id="L135" name="L135"></a> 135   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/30544.html" title="Multiple referred from 1880 places.">write</a>(<strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L136" name="L136"></a> 136   <em class="brace">{</em>
<a id="L137" name="L137"></a> 137 
<div class="comment">
 If we are close to the end of the buffer then flush it.
      Remember the buffer can hold a few more bytes than BYTES_MAX</div>
<a id="L141" name="L141"></a> 141     <strong class="reserved">if</strong> (<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> &gt;= BYTES_MAX)
<a id="L142" name="L142"></a> 142         <a href="../D/16481.html" title="Multiple defined in 7 places.">flushBuffer</a>();
<a id="L143" name="L143"></a> 143 
<a id="L144" name="L144"></a> 144     <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 0x80)
<a id="L145" name="L145"></a> 145     <em class="brace">{</em>
<a id="L146" name="L146"></a> 146        m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L147" name="L147"></a> 147     <em class="brace">}</em>
<a id="L148" name="L148"></a> 148     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 0x800)
<a id="L149" name="L149"></a> 149     <em class="brace">{</em>
<a id="L150" name="L150"></a> 150       m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0xc0 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 6));
<a id="L151" name="L151"></a> 151       m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0x80 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; 0x3f));
<a id="L152" name="L152"></a> 152     <em class="brace">}</em>
<a id="L153" name="L153"></a> 153     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 0x10000)
<a id="L154" name="L154"></a> 154     <em class="brace">{</em>
<a id="L155" name="L155"></a> 155       m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0xe0 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 12));
<a id="L156" name="L156"></a> 156       m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0x80 + ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 6) &amp; 0x3f));
<a id="L157" name="L157"></a> 157       m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0x80 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; 0x3f));
<a id="L158" name="L158"></a> 158     <em class="brace">}</em>
<a id="L159" name="L159"></a> 159         <strong class="reserved">else</strong>
<a id="L160" name="L160"></a> 160         <em class="brace">{</em>
<a id="L161" name="L161"></a> 161           m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0xf0 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 18));
<a id="L162" name="L162"></a> 162           m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0x80 + ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 12) &amp; 0x3f));
<a id="L163" name="L163"></a> 163           m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0x80 + ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 6) &amp; 0x3f));
<a id="L164" name="L164"></a> 164           m_outputBytes[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = (<strong class="reserved">byte</strong>) (0x80 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; 0x3f));
<a id="L165" name="L165"></a> 165         <em class="brace">}</em>
<a id="L166" name="L166"></a> 166 
<a id="L167" name="L167"></a> 167   <em class="brace">}</em>
<a id="L168" name="L168"></a> 168 
<a id="L169" name="L169"></a> 169 
<div class="comment">
    Write a portion of an array of characters.
    @param  chars  Array of characters
    @param  start   Offset from which to start writing characters
    @param  length   Number of characters to write
    @exception  IOException  If an I/O error occurs
    @throws java.io.IOException</div>
<a id="L181" name="L181"></a> 181   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/30544.html" title="Multiple referred from 1880 places.">write</a>(<strong class="reserved">final</strong> <strong class="reserved">char</strong> <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[], <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>)
<a id="L182" name="L182"></a> 182           <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L183" name="L183"></a> 183   <em class="brace">{</em>
<a id="L184" name="L184"></a> 184 
<a id="L185" name="L185"></a> 185     <em class="comment">// We multiply the length by three since this is the maximum length</em>
<a id="L186" name="L186"></a> 186     <em class="comment">// of the characters that we can put into the buffer.  It is possible</em>
<a id="L187" name="L187"></a> 187     <em class="comment">// for each Unicode character to expand to three bytes.</em>
<a id="L188" name="L188"></a> 188 
<a id="L189" name="L189"></a> 189     <strong class="reserved">int</strong> lengthx3 = 3*<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L190" name="L190"></a> 190 
<a id="L191" name="L191"></a> 191     <strong class="reserved">if</strong> (lengthx3 &gt;= BYTES_MAX - <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>)
<a id="L192" name="L192"></a> 192     <em class="brace">{</em>
<a id="L193" name="L193"></a> 193       <em class="comment">// The requested length is greater than the unused part of the buffer</em>
<a id="L194" name="L194"></a> 194       <a href="../D/16481.html" title="Multiple defined in 7 places.">flushBuffer</a>();
<a id="L195" name="L195"></a> 195 
<a id="L196" name="L196"></a> 196       <strong class="reserved">if</strong> (lengthx3 &gt; BYTES_MAX)
<a id="L197" name="L197"></a> 197       <em class="brace">{</em>
<div class="comment">
          The requested length exceeds the size of the buffer.
          Cut the buffer up into chunks, each of which will
          not cause an overflow to the output buffer m_outputBytes,
          and make multiple recursive calls.
          Be careful about integer overflows in multiplication.</div>
<a id="L205" name="L205"></a> 205         <strong class="reserved">int</strong> <a href="../D/34718.html" title="Multiple defined in 12 places.">split</a> = <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>/CHARS_MAX;
<a id="L206" name="L206"></a> 206         <strong class="reserved">final</strong> <strong class="reserved">int</strong> chunks;
<a id="L207" name="L207"></a> 207         <strong class="reserved">if</strong> (<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> % CHARS_MAX &gt; 0)
<a id="L208" name="L208"></a> 208             chunks = <a href="../D/34718.html" title="Multiple defined in 12 places.">split</a> + 1;
<a id="L209" name="L209"></a> 209         <strong class="reserved">else</strong>
<a id="L210" name="L210"></a> 210             chunks = <a href="../D/34718.html" title="Multiple defined in 12 places.">split</a>;
<a id="L211" name="L211"></a> 211         <strong class="reserved">int</strong> end_chunk = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L212" name="L212"></a> 212         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> chunk = 1; chunk &lt;= chunks; chunk++)
<a id="L213" name="L213"></a> 213         <em class="brace">{</em>
<a id="L214" name="L214"></a> 214             <strong class="reserved">int</strong> start_chunk = end_chunk;
<a id="L215" name="L215"></a> 215             end_chunk = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> + (<strong class="reserved">int</strong>) ((((<strong class="reserved">long</strong>) <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) * chunk) / chunks);
<a id="L216" name="L216"></a> 216 
<a id="L217" name="L217"></a> 217             <em class="comment">// Adjust the end of the chunk if it ends on a high char</em>
<a id="L218" name="L218"></a> 218             <em class="comment">// of a Unicode surrogate pair and low char of the pair</em>
<a id="L219" name="L219"></a> 219             <em class="comment">// is not going to be in the same chunk</em>
<a id="L220" name="L220"></a> 220             <strong class="reserved">final</strong> <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[end_chunk - 1];
<a id="L221" name="L221"></a> 221             <strong class="reserved">int</strong> ic = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[end_chunk - 1];
<a id="L222" name="L222"></a> 222             <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 0xD800 &amp;&amp; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= 0xDBFF) <em class="brace">{</em>
<a id="L223" name="L223"></a> 223                 <em class="comment">// The last Java char that we were going</em>
<a id="L224" name="L224"></a> 224                 <em class="comment">// to process is the first of a</em>
<a id="L225" name="L225"></a> 225                 <em class="comment">// Java surrogate char pair that</em>
<a id="L226" name="L226"></a> 226                 <em class="comment">// represent a Unicode character.</em>
<a id="L227" name="L227"></a> 227 
<a id="L228" name="L228"></a> 228                 <strong class="reserved">if</strong> (end_chunk &lt; <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> + <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L229" name="L229"></a> 229                     <em class="comment">// Avoid spanning by including the low</em>
<a id="L230" name="L230"></a> 230                     <em class="comment">// char in the current chunk of chars.</em>
<a id="L231" name="L231"></a> 231                     end_chunk++;
<a id="L232" name="L232"></a> 232                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<div class="comment">
 This is the last char of the last chunk,
                      and it is the high char of a high/low pair with
                      no low char provided.
                      TODO: error message needed.
                      The char array incorrectly ends in a high char
                      of a high/low surrogate pair, but there is
                      no corresponding low as the high is the last char</div>
<a id="L241" name="L241"></a> 241                     end_chunk--;
<a id="L242" name="L242"></a> 242                 <em class="brace">}</em>
<a id="L243" name="L243"></a> 243             <em class="brace">}</em>
<a id="L244" name="L244"></a> 244 
<a id="L245" name="L245"></a> 245 
<a id="L246" name="L246"></a> 246             <strong class="reserved">int</strong> len_chunk = (end_chunk - start_chunk);
<a id="L247" name="L247"></a> 247             <strong class="reserved">this</strong>.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(<a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>,start_chunk, len_chunk);
<a id="L248" name="L248"></a> 248         <em class="brace">}</em>
<a id="L249" name="L249"></a> 249         <strong class="reserved">return</strong>;
<a id="L250" name="L250"></a> 250       <em class="brace">}</em>
<a id="L251" name="L251"></a> 251     <em class="brace">}</em>
<a id="L252" name="L252"></a> 252 
<a id="L253" name="L253"></a> 253 
<a id="L254" name="L254"></a> 254 
<a id="L255" name="L255"></a> 255     <strong class="reserved">final</strong> <strong class="reserved">int</strong> n = <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>+<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L256" name="L256"></a> 256     <strong class="reserved">final</strong> <strong class="reserved">byte</strong>[] buf_loc = m_outputBytes; <em class="comment">// local reference for faster access</em>
<a id="L257" name="L257"></a> 257     <strong class="reserved">int</strong> count_loc = <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;      <em class="comment">// local integer for faster access</em>
<a id="L258" name="L258"></a> 258     <strong class="reserved">int</strong> i = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L259" name="L259"></a> 259     <em class="brace">{</em>
<div class="comment">
 This block could be omitted and the code would produce
          the same result. But this block exists to give the JIT
          a better chance of optimizing a tight and common loop which
          occurs when writing out ASCII characters.</div>
<a id="L265" name="L265"></a> 265         <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L266" name="L266"></a> 266         <strong class="reserved">for</strong>(; i &lt; n &amp;&amp; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[i])&lt; 0x80 ; i++ )
<a id="L267" name="L267"></a> 267             buf_loc[count_loc++] = (<strong class="reserved">byte</strong>)<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L268" name="L268"></a> 268     <em class="brace">}</em>
<a id="L269" name="L269"></a> 269     <strong class="reserved">for</strong> (; i &lt; n; i++)
<a id="L270" name="L270"></a> 270     <em class="brace">{</em>
<a id="L271" name="L271"></a> 271 
<a id="L272" name="L272"></a> 272       <strong class="reserved">final</strong> <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[i];
<a id="L273" name="L273"></a> 273 
<a id="L274" name="L274"></a> 274       <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 0x80)
<a id="L275" name="L275"></a> 275         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L276" name="L276"></a> 276       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 0x800)
<a id="L277" name="L277"></a> 277       <em class="brace">{</em>
<a id="L278" name="L278"></a> 278         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0xc0 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 6));
<a id="L279" name="L279"></a> 279         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; 0x3f));
<a id="L280" name="L280"></a> 280       <em class="brace">}</em>
<div class="comment">
         The following else if condition is added to support XML 1.1 Characters for
         UTF-8:   [1111 0uuu] [10uu zzzz] [10yy yyyy] [10xx xxxx]*
         Unicode: [1101 10ww] [wwzz zzyy] (high surrogate)
                  [1101 11yy] [yyxx xxxx] (low surrogate)
                  * uuuuu = wwww + 1</div>
<a id="L288" name="L288"></a> 288       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 0xD800 &amp;&amp; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= 0xDBFF)
<a id="L289" name="L289"></a> 289       <em class="brace">{</em>
<a id="L290" name="L290"></a> 290           <strong class="reserved">char</strong> high, low;
<a id="L291" name="L291"></a> 291           high = <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L292" name="L292"></a> 292           i++;
<a id="L293" name="L293"></a> 293           low = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[i];
<a id="L294" name="L294"></a> 294 
<a id="L295" name="L295"></a> 295           buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0xF0 | (((high + 0x40) &gt;&gt; 8) &amp; 0xf0));
<a id="L296" name="L296"></a> 296           buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 | (((high + 0x40) &gt;&gt; 2) &amp; 0x3f));
<a id="L297" name="L297"></a> 297           buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 | ((low &gt;&gt; 6) &amp; 0x0f) + ((high &lt;&lt; 4) &amp; 0x30));
<a id="L298" name="L298"></a> 298           buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 | (low &amp; 0x3f));
<a id="L299" name="L299"></a> 299       <em class="brace">}</em>
<a id="L300" name="L300"></a> 300       <strong class="reserved">else</strong>
<a id="L301" name="L301"></a> 301       <em class="brace">{</em>
<a id="L302" name="L302"></a> 302         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0xe0 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 12));
<a id="L303" name="L303"></a> 303         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 + ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 6) &amp; 0x3f));
<a id="L304" name="L304"></a> 304         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; 0x3f));
<a id="L305" name="L305"></a> 305       <em class="brace">}</em>
<a id="L306" name="L306"></a> 306     <em class="brace">}</em>
<a id="L307" name="L307"></a> 307     <em class="comment">// Store the local integer back into the instance variable</em>
<a id="L308" name="L308"></a> 308     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = count_loc;
<a id="L309" name="L309"></a> 309 
<a id="L310" name="L310"></a> 310   <em class="brace">}</em>
<a id="L311" name="L311"></a> 311 
<div class="comment">
    Write a string.
    @param  s  String to be written
    @exception  IOException  If an I/O error occurs</div>
<a id="L319" name="L319"></a> 319   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/30544.html" title="Multiple referred from 1880 places.">write</a>(<strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L320" name="L320"></a> 320   <em class="brace">{</em>
<a id="L321" name="L321"></a> 321 
<a id="L322" name="L322"></a> 322     <em class="comment">// We multiply the length by three since this is the maximum length</em>
<a id="L323" name="L323"></a> 323     <em class="comment">// of the characters that we can put into the buffer.  It is possible</em>
<a id="L324" name="L324"></a> 324     <em class="comment">// for each Unicode character to expand to three bytes.</em>
<a id="L325" name="L325"></a> 325     <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L326" name="L326"></a> 326     <strong class="reserved">int</strong> lengthx3 = 3*<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L327" name="L327"></a> 327 
<a id="L328" name="L328"></a> 328     <strong class="reserved">if</strong> (lengthx3 &gt;= BYTES_MAX - <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>)
<a id="L329" name="L329"></a> 329     <em class="brace">{</em>
<a id="L330" name="L330"></a> 330       <em class="comment">// The requested length is greater than the unused part of the buffer</em>
<a id="L331" name="L331"></a> 331       <a href="../D/16481.html" title="Multiple defined in 7 places.">flushBuffer</a>();
<a id="L332" name="L332"></a> 332 
<a id="L333" name="L333"></a> 333       <strong class="reserved">if</strong> (lengthx3 &gt; BYTES_MAX)
<a id="L334" name="L334"></a> 334       <em class="brace">{</em>
<div class="comment">
          The requested length exceeds the size of the buffer,
          so break it up in chunks that don't exceed the buffer size.</div>
<a id="L339" name="L339"></a> 339          <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = 0;
<a id="L340" name="L340"></a> 340          <strong class="reserved">int</strong> <a href="../D/34718.html" title="Multiple defined in 12 places.">split</a> = <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>/CHARS_MAX;
<a id="L341" name="L341"></a> 341          <strong class="reserved">final</strong> <strong class="reserved">int</strong> chunks;
<a id="L342" name="L342"></a> 342          <strong class="reserved">if</strong> (<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> % CHARS_MAX &gt; 0)
<a id="L343" name="L343"></a> 343              chunks = <a href="../D/34718.html" title="Multiple defined in 12 places.">split</a> + 1;
<a id="L344" name="L344"></a> 344          <strong class="reserved">else</strong>
<a id="L345" name="L345"></a> 345              chunks = <a href="../D/34718.html" title="Multiple defined in 12 places.">split</a>;
<a id="L346" name="L346"></a> 346          <strong class="reserved">int</strong> end_chunk = 0;
<a id="L347" name="L347"></a> 347          <strong class="reserved">for</strong> (<strong class="reserved">int</strong> chunk = 1; chunk &lt;= chunks; chunk++)
<a id="L348" name="L348"></a> 348          <em class="brace">{</em>
<a id="L349" name="L349"></a> 349              <strong class="reserved">int</strong> start_chunk = end_chunk;
<a id="L350" name="L350"></a> 350              end_chunk = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> + (<strong class="reserved">int</strong>) ((((<strong class="reserved">long</strong>) <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) * chunk) / chunks);
<a id="L351" name="L351"></a> 351              s.<a href="../D/17616.html" title="Multiple defined in 22 places.">getChars</a>(start_chunk,end_chunk, m_inputChars,0);
<a id="L352" name="L352"></a> 352              <strong class="reserved">int</strong> len_chunk = (end_chunk - start_chunk);
<a id="L353" name="L353"></a> 353 
<a id="L354" name="L354"></a> 354              <em class="comment">// Adjust the end of the chunk if it ends on a high char</em>
<a id="L355" name="L355"></a> 355              <em class="comment">// of a Unicode surrogate pair and low char of the pair</em>
<a id="L356" name="L356"></a> 356              <em class="comment">// is not going to be in the same chunk</em>
<a id="L357" name="L357"></a> 357              <strong class="reserved">final</strong> <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = m_inputChars[len_chunk - 1];
<a id="L358" name="L358"></a> 358              <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 0xD800 &amp;&amp; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= 0xDBFF) <em class="brace">{</em>
<a id="L359" name="L359"></a> 359                  <em class="comment">// Exclude char in this chunk,</em>
<a id="L360" name="L360"></a> 360                  <em class="comment">// to avoid spanning a Unicode character</em>
<a id="L361" name="L361"></a> 361                  <em class="comment">// that is in two Java chars as a high/low surrogate</em>
<a id="L362" name="L362"></a> 362                  end_chunk--;
<a id="L363" name="L363"></a> 363                  len_chunk--;
<a id="L364" name="L364"></a> 364                  <strong class="reserved">if</strong> (chunk == chunks) <em class="brace">{</em>
<div class="comment">
 TODO: error message needed.
                       The String incorrectly ends in a high char
                       of a high/low surrogate pair, but there is
                       no corresponding low as the high is the last char
                       Recover by ignoring this last char.</div>
<a id="L371" name="L371"></a> 371                  <em class="brace">}</em>
<a id="L372" name="L372"></a> 372              <em class="brace">}</em>
<a id="L373" name="L373"></a> 373 
<a id="L374" name="L374"></a> 374              <strong class="reserved">this</strong>.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(m_inputChars,0, len_chunk);
<a id="L375" name="L375"></a> 375          <em class="brace">}</em>
<a id="L376" name="L376"></a> 376          <strong class="reserved">return</strong>;
<a id="L377" name="L377"></a> 377       <em class="brace">}</em>
<a id="L378" name="L378"></a> 378     <em class="brace">}</em>
<a id="L379" name="L379"></a> 379 
<a id="L380" name="L380"></a> 380 
<a id="L381" name="L381"></a> 381     s.<a href="../D/17616.html" title="Multiple defined in 22 places.">getChars</a>(0, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> , m_inputChars, 0);
<a id="L382" name="L382"></a> 382     <strong class="reserved">final</strong> <strong class="reserved">char</strong>[] <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a> = m_inputChars;
<a id="L383" name="L383"></a> 383     <strong class="reserved">final</strong> <strong class="reserved">int</strong> n = <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L384" name="L384"></a> 384     <strong class="reserved">final</strong> <strong class="reserved">byte</strong>[] buf_loc = m_outputBytes; <em class="comment">// local reference for faster access</em>
<a id="L385" name="L385"></a> 385     <strong class="reserved">int</strong> count_loc = <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;      <em class="comment">// local integer for faster access</em>
<a id="L386" name="L386"></a> 386     <strong class="reserved">int</strong> i = 0;
<a id="L387" name="L387"></a> 387     <em class="brace">{</em>
<div class="comment">
 This block could be omitted and the code would produce
          the same result. But this block exists to give the JIT
          a better chance of optimizing a tight and common loop which
          occurs when writing out ASCII characters.</div>
<a id="L393" name="L393"></a> 393         <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L394" name="L394"></a> 394         <strong class="reserved">for</strong>(; i &lt; n &amp;&amp; (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[i])&lt; 0x80 ; i++ )
<a id="L395" name="L395"></a> 395             buf_loc[count_loc++] = (<strong class="reserved">byte</strong>)<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L396" name="L396"></a> 396     <em class="brace">}</em>
<a id="L397" name="L397"></a> 397     <strong class="reserved">for</strong> (; i &lt; n; i++)
<a id="L398" name="L398"></a> 398     <em class="brace">{</em>
<a id="L399" name="L399"></a> 399 
<a id="L400" name="L400"></a> 400       <strong class="reserved">final</strong> <strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[i];
<a id="L401" name="L401"></a> 401 
<a id="L402" name="L402"></a> 402       <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 0x80)
<a id="L403" name="L403"></a> 403         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L404" name="L404"></a> 404       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt; 0x800)
<a id="L405" name="L405"></a> 405       <em class="brace">{</em>
<a id="L406" name="L406"></a> 406         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0xc0 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 6));
<a id="L407" name="L407"></a> 407         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; 0x3f));
<a id="L408" name="L408"></a> 408       <em class="brace">}</em>
<div class="comment">
       The following else if condition is added to support XML 1.1 Characters for
       UTF-8:   [1111 0uuu] [10uu zzzz] [10yy yyyy] [10xx xxxx]*
       Unicode: [1101 10ww] [wwzz zzyy] (high surrogate)
                [1101 11yy] [yyxx xxxx] (low surrogate)
                * uuuuu = wwww + 1</div>
<a id="L416" name="L416"></a> 416     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;= 0xD800 &amp;&amp; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &lt;= 0xDBFF)
<a id="L417" name="L417"></a> 417     <em class="brace">{</em>
<a id="L418" name="L418"></a> 418         <strong class="reserved">char</strong> high, low;
<a id="L419" name="L419"></a> 419         high = <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L420" name="L420"></a> 420         i++;
<a id="L421" name="L421"></a> 421         low = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[i];
<a id="L422" name="L422"></a> 422 
<a id="L423" name="L423"></a> 423         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0xF0 | (((high + 0x40) &gt;&gt; 8) &amp; 0xf0));
<a id="L424" name="L424"></a> 424         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 | (((high + 0x40) &gt;&gt; 2) &amp; 0x3f));
<a id="L425" name="L425"></a> 425         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 | ((low &gt;&gt; 6) &amp; 0x0f) + ((high &lt;&lt; 4) &amp; 0x30));
<a id="L426" name="L426"></a> 426         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 | (low &amp; 0x3f));
<a id="L427" name="L427"></a> 427     <em class="brace">}</em>
<a id="L428" name="L428"></a> 428       <strong class="reserved">else</strong>
<a id="L429" name="L429"></a> 429       <em class="brace">{</em>
<a id="L430" name="L430"></a> 430         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0xe0 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 12));
<a id="L431" name="L431"></a> 431         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 + ((<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt;&gt; 6) &amp; 0x3f));
<a id="L432" name="L432"></a> 432         buf_loc[count_loc++] = (<strong class="reserved">byte</strong>) (0x80 + (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &amp; 0x3f));
<a id="L433" name="L433"></a> 433       <em class="brace">}</em>
<a id="L434" name="L434"></a> 434     <em class="brace">}</em>
<a id="L435" name="L435"></a> 435     <em class="comment">// Store the local integer back into the instance variable</em>
<a id="L436" name="L436"></a> 436     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = count_loc;
<a id="L437" name="L437"></a> 437 
<a id="L438" name="L438"></a> 438   <em class="brace">}</em>
<a id="L439" name="L439"></a> 439 
<div class="comment">
    Flush the internal buffer
    @throws IOException</div>
<a id="L445" name="L445"></a> 445   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/14704.html" title="Multiple referred from 36 places.">flushBuffer</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L446" name="L446"></a> 446   <em class="brace">{</em>
<a id="L447" name="L447"></a> 447 
<a id="L448" name="L448"></a> 448     <strong class="reserved">if</strong> (<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> &gt; 0)
<a id="L449" name="L449"></a> 449     <em class="brace">{</em>
<a id="L450" name="L450"></a> 450       m_os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(m_outputBytes, 0, <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>);
<a id="L451" name="L451"></a> 451 
<a id="L452" name="L452"></a> 452       <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L453" name="L453"></a> 453     <em class="brace">}</em>
<a id="L454" name="L454"></a> 454   <em class="brace">}</em>
<a id="L455" name="L455"></a> 455 
<div class="comment">
    Flush the stream.  If the stream has saved any characters from the
    various write() methods in a buffer, write them immediately to their
    intended destination.  Then, if that destination is another character or
    byte stream, flush it.  Thus one flush() invocation will flush all the
    buffers in a chain of Writers and OutputStreams.
    @exception  IOException  If an I/O error occurs
    @throws java.io.IOException</div>
<a id="L467" name="L467"></a> 467   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/14697.html" title="Multiple referred from 199 places.">flush</a>() <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L468" name="L468"></a> 468   <em class="brace">{</em>
<a id="L469" name="L469"></a> 469     <a href="../D/16481.html" title="Multiple defined in 7 places.">flushBuffer</a>();
<a id="L470" name="L470"></a> 470     m_os.<a href="../D/16474.html" title="Multiple defined in 60 places.">flush</a>();
<a id="L471" name="L471"></a> 471   <em class="brace">}</em>
<a id="L472" name="L472"></a> 472 
<div class="comment">
    Close the stream, flushing it first.  Once a stream has been closed,
    further write() or flush() invocations will cause an IOException to be
    thrown.  Closing a previously-closed stream, however, has no effect.
    @exception  IOException  If an I/O error occurs
    @throws java.io.IOException</div>
<a id="L482" name="L482"></a> 482   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11587.html" title="Multiple referred from 410 places.">close</a>() <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L483" name="L483"></a> 483   <em class="brace">{</em>
<a id="L484" name="L484"></a> 484     <a href="../D/16481.html" title="Multiple defined in 7 places.">flushBuffer</a>();
<a id="L485" name="L485"></a> 485     m_os.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L486" name="L486"></a> 486   <em class="brace">}</em>
<a id="L487" name="L487"></a> 487 
<div class="comment">
    Get the output stream where the events will be serialized to.
    @return reference to the result stream, or null of only a writer was
    set.</div>
<a id="L494" name="L494"></a> 494   <strong class="reserved">public</strong> <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> <a href="../R/18192.html" title="Multiple referred from 21 places.">getOutputStream</a>()
<a id="L495" name="L495"></a> 495   <em class="brace">{</em>
<a id="L496" name="L496"></a> 496     <strong class="reserved">return</strong> m_os;
<a id="L497" name="L497"></a> 497   <em class="brace">}</em>
<a id="L498" name="L498"></a> 498 
<a id="L499" name="L499"></a> 499   <strong class="reserved">public</strong> <a href="../S/1393.html#L50" title="Defined at 50 in src/java/io/Writer.java.">Writer</a> <a href="../R/19899.html" title="Multiple referred from 13 places.">getWriter</a>()
<a id="L500" name="L500"></a> 500   <em class="brace">{</em>
<a id="L501" name="L501"></a> 501     <em class="comment">// Only one of getWriter() or getOutputStream() can return null</em>
<a id="L502" name="L502"></a> 502     <em class="comment">// This type of writer wraps an OutputStream, not a Writer.</em>
<a id="L503" name="L503"></a> 503     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L504" name="L504"></a> 504   <em class="brace">}</em>
<a id="L505" name="L505"></a> 505 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L135">[^]</a><a href="#L499">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>