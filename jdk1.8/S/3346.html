<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/javax/swing/text/ZoneView.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L98">[^]</a><a href="#L644">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L98" title="Defined at 98.">getMaximumZoneSize</a></li>
<li><a href="#L113" title="Defined at 113.">setMaximumZoneSize</a></li>
<li><a href="#L121" title="Defined at 121.">getMaxZonesLoaded</a></li>
<li><a href="#L135" title="Defined at 135.">setMaxZonesLoaded</a></li>
<li><a href="#L152" title="Defined at 152.">zoneWasLoaded</a></li>
<li><a href="#L158" title="Defined at 158.">unloadOldZones</a></li>
<li><a href="#L176" title="Defined at 176.">unloadZone</a></li>
<li><a href="#L188" title="Defined at 188.">isZoneLoaded</a></li>
<li><a href="#L207" title="Defined at 207.">createZone</a></li>
<li><a href="#L232" title="Defined at 232.">loadChildren</a></li>
<li><a href="#L249" title="Defined at 249.">getViewIndexAtPosition</a></li>
<li><a href="#L266" title="Defined at 266.">handleInsert</a></li>
<li><a href="#L276" title="Defined at 276.">handleRemove</a></li>
<li><a href="#L284" title="Defined at 284.">splitZone</a></li>
<li><a href="#L307" title="Defined at 307.">getDesiredZoneEnd</a></li>
<li><a href="#L330" title="Defined at 330.">updateChildren</a></li>
<li><a href="#L347" title="Defined at 347.">insertUpdate</a></li>
<li><a href="#L364" title="Defined at 364.">removeUpdate</a></li>
<li><a href="#L392" title="Defined at 392.">load</a></li>
<li><a href="#L413" title="Defined at 413.">unload</a></li>
<li><a href="#L422" title="Defined at 422.">isLoaded</a></li>
<li><a href="#L435" title="Defined at 435.">loadChildren</a></li>
<li><a href="#L471" title="Defined at 471.">flushRequirementChanges</a></li>
<li><a href="#L489" title="Defined at 489.">getViewIndex</a></li>
<li><a href="#L498" title="Defined at 498.">updateChildren</a></li>
<li><a href="#L528" title="Defined at 528.">getAttributes</a></li>
<li><a href="#L541" title="Defined at 541.">paint</a></li>
<li><a href="#L559" title="Defined at 559.">viewToModel</a></li>
<li><a href="#L578" title="Defined at 578.">modelToView</a></li>
<li><a href="#L588" title="Defined at 588.">getStartOffset</a></li>
<li><a href="#L595" title="Defined at 595.">getEndOffset</a></li>
<li><a href="#L610" title="Defined at 610.">insertUpdate</a></li>
<li><a href="#L627" title="Defined at 627.">removeUpdate</a></li>
<li><a href="#L644" title="Defined at 644.">changedUpdate</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1998, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 <strong class="reserved">package</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.swing.<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>;
<a id="L26" name="L26"></a>  26 
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.util.Vector;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.awt.*;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> javax.swing.event.*;
<a id="L30" name="L30"></a>  30 
<div class="comment">
  ZoneView is a View implementation that creates zones for which
  the child views are not created or stored until they are needed
  for display or model/view translations.  This enables a substantial
  reduction in memory consumption for situations where the model
  being represented is very large, by building view objects only for
  the region being actively viewed/edited.  The size of the children
  can be estimated in some way, or calculated asynchronously with
  only the result being saved.
  <p>
  ZoneView extends BoxView to provide a box that implements
  zones for its children.  The zones are special View implementations
  (the children of an instance of this class) that represent only a
  portion of the model that an instance of ZoneView is responsible
  for.  The zones don't create child views until an attempt is made
  to display them. A box shaped view is well suited to this because:
    </p><ul><li>
    Boxes are a heavily used view, and having a box that
    provides this behavior gives substantial opportunity
    to plug the behavior into a view hierarchy from the
    view factory.
    </li><li>
    Boxes are tiled in one direction, so it is easy to
    divide them into zones in a reliable way.
    </li><li>
    Boxes typically have a simple relationship to the model (i.e. they
    create child views that directly represent the child elements).
    </li><li>
    Boxes are easier to estimate the size of than some other shapes.
    </li></ul>
  <p>
  The default behavior is controlled by two properties, maxZoneSize
  and maxZonesLoaded.  Setting maxZoneSize to Integer.MAX_VALUE would
  have the effect of causing only one zone to be created.  This would
  effectively turn the view into an implementation of the decorator
  pattern.  Setting maxZonesLoaded to a value of Integer.MAX_VALUE would
  cause zones to never be unloaded.  For simplicity, zones are created on
  boundaries represented by the child elements of the element the view is
  responsible for.  The zones can be any View implementation, but the
  default implementation is based upon AsyncBoxView which supports fairly
  large zones efficiently.
  @author  Timothy Prinzing
  @see     View
  @since   1.3</p></div>
<a id="L78" name="L78"></a>  78 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/9354.html" title="Multiple referred from 2 places.">ZoneView</a> <strong class="reserved">extends</strong> <a href="../S/3355.html#L61" title="Defined at 61 in src/javax/swing/text/BoxView.java.">BoxView</a> <em class="brace">{</em>
<a id="L79" name="L79"></a>  79 
<a id="L80" name="L80"></a>  80     <strong class="reserved">int</strong> maxZoneSize = 8 * 1024;
<a id="L81" name="L81"></a>  81     <strong class="reserved">int</strong> maxZonesLoaded = 3;
<a id="L82" name="L82"></a>  82     <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;<a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>&gt; loadedZones;
<a id="L83" name="L83"></a>  83 
<div class="comment">
      Constructs a ZoneView.
      @param elem the element this view is responsible for
      @param axis either View.X_AXIS or View.Y_AXIS</div>
<a id="L90" name="L90"></a>  90     <strong class="reserved">public</strong> ZoneView(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem, <strong class="reserved">int</strong> axis) <em class="brace">{</em>
<a id="L91" name="L91"></a>  91         <strong class="reserved">super</strong>(elem, axis);
<a id="L92" name="L92"></a>  92         loadedZones = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;<a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>&gt;();
<a id="L93" name="L93"></a>  93     <em class="brace">}</em>
<a id="L94" name="L94"></a>  94 
<div class="comment">
      Get the current maximum zone size.</div>
<a id="L98" name="L98"></a>  98     <strong class="reserved">public</strong> <strong class="reserved">int</strong> getMaximumZoneSize() <em class="brace">{</em>
<a id="L99" name="L99"></a>  99         <strong class="reserved">return</strong> maxZoneSize;
<a id="L100" name="L100"></a> 100     <em class="brace">}</em>
<a id="L101" name="L101"></a> 101 
<div class="comment">
      Set the desired maximum zone size.  A
      zone may get larger than this size if
      a single child view is larger than this
      size since zones are formed on child view
      boundaries.
      @param size the number of characters the zone
      may represent before attempting to break
      the zone into a smaller size.</div>
<a id="L113" name="L113"></a> 113     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setMaximumZoneSize(<strong class="reserved">int</strong> <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>) <em class="brace">{</em>
<a id="L114" name="L114"></a> 114         maxZoneSize = <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>;
<a id="L115" name="L115"></a> 115     <em class="brace">}</em>
<a id="L116" name="L116"></a> 116 
<div class="comment">
      Get the current setting of the number of zones
      allowed to be loaded at the same time.</div>
<a id="L121" name="L121"></a> 121     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../S/3346.html#L159" title="Referred from 159 in src/javax/swing/text/ZoneView.java.">getMaxZonesLoaded</a>() <em class="brace">{</em>
<a id="L122" name="L122"></a> 122         <strong class="reserved">return</strong> maxZonesLoaded;
<a id="L123" name="L123"></a> 123     <em class="brace">}</em>
<a id="L124" name="L124"></a> 124 
<div class="comment">
      Sets the current setting of the number of zones
      allowed to be loaded at the same time. This will throw an
      <code>IllegalArgumentException</code> if <code>mzl</code> is less
      than 1.
      @param mzl the desired maximum number of zones
       to be actively loaded, must be greater than 0
      @exception IllegalArgumentException if <code>mzl</code> is &lt; 1</div>
<a id="L135" name="L135"></a> 135     <strong class="reserved">public</strong> <strong class="reserved">void</strong> setMaxZonesLoaded(<strong class="reserved">int</strong> mzl) <em class="brace">{</em>
<a id="L136" name="L136"></a> 136         <strong class="reserved">if</strong> (mzl &lt; 1) <em class="brace">{</em>
<a id="L137" name="L137"></a> 137             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("ZoneView.setMaxZonesLoaded must be greater than 0.");
<a id="L138" name="L138"></a> 138         <em class="brace">}</em>
<a id="L139" name="L139"></a> 139         maxZonesLoaded = mzl;
<a id="L140" name="L140"></a> 140         <a href="../S/3346.html#L158" title="Defined at 158 in src/javax/swing/text/ZoneView.java.">unloadOldZones</a>();
<a id="L141" name="L141"></a> 141     <em class="brace">}</em>
<a id="L142" name="L142"></a> 142 
<div class="comment">
      Called by a zone when it gets loaded.  This happens when
      an attempt is made to display or perform a model/view
      translation on a zone that was in an unloaded state.
      This is implemented to check if the maximum number of
      zones was reached and to unload the oldest zone if so.
      @param zone the child view that was just loaded.</div>
<a id="L152" name="L152"></a> 152     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/3346.html#L405" title="Referred from 405 in src/javax/swing/text/ZoneView.java.">zoneWasLoaded</a>(<a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> <a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>) <em class="brace">{</em>
<a id="L153" name="L153"></a> 153         <em class="comment">//System.out.println("loading: " + zone.getStartOffset() + "," + zone.getEndOffset());</em>
<a id="L154" name="L154"></a> 154         loadedZones.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>);
<a id="L155" name="L155"></a> 155         <a href="../S/3346.html#L158" title="Defined at 158 in src/javax/swing/text/ZoneView.java.">unloadOldZones</a>();
<a id="L156" name="L156"></a> 156     <em class="brace">}</em>
<a id="L157" name="L157"></a> 157 
<a id="L158" name="L158"></a> 158     <strong class="reserved">void</strong> <a href="../R/29711.html" title="Multiple referred from 2 places.">unloadOldZones</a>() <em class="brace">{</em>
<a id="L159" name="L159"></a> 159         <strong class="reserved">while</strong> (loadedZones.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() &gt; <a href="../S/3346.html#L121" title="Defined at 121 in src/javax/swing/text/ZoneView.java.">getMaxZonesLoaded</a>()) <em class="brace">{</em>
<a id="L160" name="L160"></a> 160             <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> <a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a> = loadedZones.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(0);
<a id="L161" name="L161"></a> 161             loadedZones.<a href="../D/30775.html" title="Multiple defined in 12 places.">removeElementAt</a>(0);
<a id="L162" name="L162"></a> 162             <a href="../S/3346.html#L176" title="Defined at 176 in src/javax/swing/text/ZoneView.java.">unloadZone</a>(<a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>);
<a id="L163" name="L163"></a> 163         <em class="brace">}</em>
<a id="L164" name="L164"></a> 164     <em class="brace">}</em>
<a id="L165" name="L165"></a> 165 
<div class="comment">
      Unload a zone (Convert the zone to its memory saving state).
      The zones are expected to represent a subset of the
      child elements of the element this view is responsible for.
      Therefore, the default implementation is to simple remove
      all the children.
      @param zone the child view desired to be set to an
       unloaded state.</div>
<a id="L176" name="L176"></a> 176     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/3346.html#L162" title="Referred from 162 in src/javax/swing/text/ZoneView.java.">unloadZone</a>(<a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> <a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>) <em class="brace">{</em>
<a id="L177" name="L177"></a> 177         <em class="comment">//System.out.println("unloading: " + zone.getStartOffset() + "," + zone.getEndOffset());</em>
<a id="L178" name="L178"></a> 178         <a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>.<a href="../D/30685.html" title="Multiple defined in 45 places.">removeAll</a>();
<a id="L179" name="L179"></a> 179     <em class="brace">}</em>
<a id="L180" name="L180"></a> 180 
<div class="comment">
      Determine if a zone is in the loaded state.
      The zones are expected to represent a subset of the
      child elements of the element this view is responsible for.
      Therefore, the default implementation is to return
      true if the view has children.</div>
<a id="L188" name="L188"></a> 188     <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> isZoneLoaded(<a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> <a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>) <em class="brace">{</em>
<a id="L189" name="L189"></a> 189         <strong class="reserved">return</strong> (<a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>.<a href="../D/23601.html" title="Multiple defined in 5 places.">getViewCount</a>() &gt; 0);
<a id="L190" name="L190"></a> 190     <em class="brace">}</em>
<a id="L191" name="L191"></a> 191 
<div class="comment">
      Create a view to represent a zone for the given
      range within the model (which should be within
      the range of this objects responsibility).  This
      is called by the zone management logic to create
      new zones.  Subclasses can provide a different
      implementation for a zone by changing this method.
      @param p0 the start of the desired zone.  This should
       be &gt;= getStartOffset() and &lt; getEndOffset().  This
       value should also be &lt; p1.
      @param p1 the end of the desired zone.  This should
       be &gt; getStartOffset() and &lt;= getEndOffset().  This
       value should also be &gt; p0.</div>
<a id="L207" name="L207"></a> 207     <strong class="reserved">protected</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> <a href="../R/12814.html" title="Multiple referred from 2 places.">createZone</a>(<strong class="reserved">int</strong> p0, <strong class="reserved">int</strong> p1) <em class="brace">{</em>
<a id="L208" name="L208"></a> 208         <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = <a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>();
<a id="L209" name="L209"></a> 209         <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> <a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>;
<a id="L210" name="L210"></a> 210         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L211" name="L211"></a> 211             <a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a> = <strong class="reserved">new</strong> <a href="../S/3346.html#L374" title="Defined at 374 in src/javax/swing/text/ZoneView.java.">Zone</a>(<a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>(),
<a id="L212" name="L212"></a> 212                             doc.<a href="../D/14122.html" title="Multiple defined in 5 places.">createPosition</a>(p0),
<a id="L213" name="L213"></a> 213                             doc.<a href="../D/14122.html" title="Multiple defined in 5 places.">createPosition</a>(p1));
<a id="L214" name="L214"></a> 214         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> ble) <em class="brace">{</em>
<a id="L215" name="L215"></a> 215             <em class="comment">// this should puke in some way.</em>
<a id="L216" name="L216"></a> 216             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3266.html#L34" title="Defined at 34 in src/javax/swing/text/StateInvariantError.java.">StateInvariantError</a>(ble.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L217" name="L217"></a> 217         <em class="brace">}</em>
<a id="L218" name="L218"></a> 218         <strong class="reserved">return</strong> <a href="../S/1481.html#L267" title="Defined at 267 in src/java/time/temporal/TemporalQueries.java.">zone</a>;
<a id="L219" name="L219"></a> 219     <em class="brace">}</em>
<a id="L220" name="L220"></a> 220 
<div class="comment">
      Loads all of the children to initialize the view.
      This is called by the <code>setParent</code> method.
      This is reimplemented to not load any children directly
      (as they are created by the zones).  This method creates
      the initial set of zones.  Zones don't actually get
      populated however until an attempt is made to display
      them or to do model/view coordinate translation.
      @param f the view factory</div>
<a id="L232" name="L232"></a> 232     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/22554.html" title="Multiple referred from 11 places.">loadChildren</a>(<a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L233" name="L233"></a> 233         <em class="comment">// build the first zone.</em>
<a id="L234" name="L234"></a> 234         <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = <a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>();
<a id="L235" name="L235"></a> 235         <strong class="reserved">int</strong> offs0 = <a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>();
<a id="L236" name="L236"></a> 236         <strong class="reserved">int</strong> offs1 = <a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>();
<a id="L237" name="L237"></a> 237         <a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/3346.html#L207" title="Defined at 207 in src/javax/swing/text/ZoneView.java.">createZone</a>(offs0, offs1));
<a id="L238" name="L238"></a> 238         <a href="../S/3346.html#L266" title="Defined at 266 in src/javax/swing/text/ZoneView.java.">handleInsert</a>(offs0, offs1 - offs0);
<a id="L239" name="L239"></a> 239     <em class="brace">}</em>
<a id="L240" name="L240"></a> 240 
<div class="comment">
      Returns the child view index representing the given position in
      the model.
      @param pos the position &gt;= 0
      @return  index of the view representing the given position, or
        -1 if no view represents that position</div>
<a id="L249" name="L249"></a> 249     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/19809.html" title="Multiple referred from 10 places.">getViewIndexAtPosition</a>(<strong class="reserved">int</strong> pos) <em class="brace">{</em>
<a id="L250" name="L250"></a> 250         <em class="comment">// PENDING(prinz) this could be done as a binary</em>
<a id="L251" name="L251"></a> 251         <em class="comment">// search, and probably should be.</em>
<a id="L252" name="L252"></a> 252         <strong class="reserved">int</strong> n = <a href="../D/23601.html" title="Multiple defined in 5 places.">getViewCount</a>();
<a id="L253" name="L253"></a> 253         <strong class="reserved">if</strong> (pos == <a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>()) <em class="brace">{</em>
<a id="L254" name="L254"></a> 254             <strong class="reserved">return</strong> n - 1;
<a id="L255" name="L255"></a> 255         <em class="brace">}</em>
<a id="L256" name="L256"></a> 256         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L257" name="L257"></a> 257             <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> v = <a href="../D/23597.html" title="Multiple defined in 13 places.">getView</a>(i);
<a id="L258" name="L258"></a> 258             <strong class="reserved">if</strong>(pos &gt;= v.<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>() &amp;&amp;
<a id="L259" name="L259"></a> 259                pos &lt; v.<a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>()) <em class="brace">{</em>
<a id="L260" name="L260"></a> 260                 <strong class="reserved">return</strong> i;
<a id="L261" name="L261"></a> 261             <em class="brace">}</em>
<a id="L262" name="L262"></a> 262         <em class="brace">}</em>
<a id="L263" name="L263"></a> 263         <strong class="reserved">return</strong> -1;
<a id="L264" name="L264"></a> 264     <em class="brace">}</em>
<a id="L265" name="L265"></a> 265 
<a id="L266" name="L266"></a> 266     <strong class="reserved">void</strong> <a href="../R/20105.html" title="Multiple referred from 2 places.">handleInsert</a>(<strong class="reserved">int</strong> pos, <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L267" name="L267"></a> 267         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../D/23603.html" title="Multiple defined in 6 places.">getViewIndex</a>(pos, <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a>.Forward);
<a id="L268" name="L268"></a> 268         <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> v = <a href="../D/23597.html" title="Multiple defined in 13 places.">getView</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>);
<a id="L269" name="L269"></a> 269         <strong class="reserved">int</strong> offs0 = v.<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>();
<a id="L270" name="L270"></a> 270         <strong class="reserved">int</strong> offs1 = v.<a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>();
<a id="L271" name="L271"></a> 271         <strong class="reserved">if</strong> ((offs1 - offs0) &gt; maxZoneSize) <em class="brace">{</em>
<a id="L272" name="L272"></a> 272             <a href="../S/3346.html#L284" title="Defined at 284 in src/javax/swing/text/ZoneView.java.">splitZone</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>, offs0, offs1);
<a id="L273" name="L273"></a> 273         <em class="brace">}</em>
<a id="L274" name="L274"></a> 274     <em class="brace">}</em>
<a id="L275" name="L275"></a> 275 
<a id="L276" name="L276"></a> 276     <strong class="reserved">void</strong> <a href="../R/20136.html" title="Multiple referred from 4 places.">handleRemove</a>(<strong class="reserved">int</strong> pos, <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L277" name="L277"></a> 277         <em class="comment">// IMPLEMENT</em>
<a id="L278" name="L278"></a> 278     <em class="brace">}</em>
<a id="L279" name="L279"></a> 279 
<div class="comment">
      Break up the zone at the given index into pieces
      of an acceptable size.</div>
<a id="L284" name="L284"></a> 284     <strong class="reserved">void</strong> <a href="../S/3346.html#L272" title="Referred from 272 in src/javax/swing/text/ZoneView.java.">splitZone</a>(<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>, <strong class="reserved">int</strong> offs0, <strong class="reserved">int</strong> offs1) <em class="brace">{</em>
<a id="L285" name="L285"></a> 285         <em class="comment">// divide the old zone into a new set of bins</em>
<a id="L286" name="L286"></a> 286         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L287" name="L287"></a> 287         <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = elem.<a href="../D/18553.html" title="Multiple defined in 33 places.">getDocument</a>();
<a id="L288" name="L288"></a> 288         <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;<a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>&gt; zones = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;<a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>&gt;();
<a id="L289" name="L289"></a> 289         <strong class="reserved">int</strong> offs = offs0;
<a id="L290" name="L290"></a> 290         <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L291" name="L291"></a> 291             offs0 = offs;
<a id="L292" name="L292"></a> 292             offs = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(<a href="../S/3346.html#L307" title="Defined at 307 in src/javax/swing/text/ZoneView.java.">getDesiredZoneEnd</a>(offs0), offs1);
<a id="L293" name="L293"></a> 293             zones.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<a href="../S/3346.html#L207" title="Defined at 207 in src/javax/swing/text/ZoneView.java.">createZone</a>(offs0, offs));
<a id="L294" name="L294"></a> 294         <em class="brace">}</em> <strong class="reserved">while</strong> (offs &lt; offs1);
<a id="L295" name="L295"></a> 295         <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> oldZone = <a href="../D/23597.html" title="Multiple defined in 13 places.">getView</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>);
<a id="L296" name="L296"></a> 296         <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[] newZones = <strong class="reserved">new</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[zones.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()];
<a id="L297" name="L297"></a> 297         zones.<a href="../D/13501.html" title="Multiple defined in 23 places.">copyInto</a>(newZones);
<a id="L298" name="L298"></a> 298         <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>, 1, newZones);
<a id="L299" name="L299"></a> 299     <em class="brace">}</em>
<a id="L300" name="L300"></a> 300 
<div class="comment">
      Returns the zone position to use for the
      end of a zone that starts at the given
      position.  By default this returns something
      close to half the max zone size.</div>
<a id="L307" name="L307"></a> 307     <strong class="reserved">int</strong> <a href="../S/3346.html#L292" title="Referred from 292 in src/javax/swing/text/ZoneView.java.">getDesiredZoneEnd</a>(<strong class="reserved">int</strong> pos) <em class="brace">{</em>
<a id="L308" name="L308"></a> 308         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L309" name="L309"></a> 309         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = elem.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(pos + (maxZoneSize / 2));
<a id="L310" name="L310"></a> 310         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> child = elem.<a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>);
<a id="L311" name="L311"></a> 311         <strong class="reserved">int</strong> offs0 = child.<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>();
<a id="L312" name="L312"></a> 312         <strong class="reserved">int</strong> offs1 = child.<a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>();
<a id="L313" name="L313"></a> 313         <strong class="reserved">if</strong> ((offs1 - pos) &gt; maxZoneSize) <em class="brace">{</em>
<a id="L314" name="L314"></a> 314             <strong class="reserved">if</strong> (offs0 &gt; pos) <em class="brace">{</em>
<a id="L315" name="L315"></a> 315                 <strong class="reserved">return</strong> offs0;
<a id="L316" name="L316"></a> 316             <em class="brace">}</em>
<a id="L317" name="L317"></a> 317         <em class="brace">}</em>
<a id="L318" name="L318"></a> 318         <strong class="reserved">return</strong> offs1;
<a id="L319" name="L319"></a> 319     <em class="brace">}</em>
<a id="L320" name="L320"></a> 320 
<a id="L321" name="L321"></a> 321     <em class="comment">// ---- View methods ----------------------------------------------------</em>
<a id="L322" name="L322"></a> 322 
<div class="comment">
      The superclass behavior will try to update the child views
      which is not desired in this case, since the children are
      zones and not directly effected by the changes to the
      associated element.  This is reimplemented to do nothing
      and return false.</div>
<a id="L330" name="L330"></a> 330     <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/29832.html" title="Multiple referred from 6 places.">updateChildren</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a>.<a href="../S/3381.html#L143" title="Defined at 143 in src/javax/swing/event/DocumentEvent.java.">ElementChange</a> ec,
<a id="L331" name="L331"></a> 331                                      <a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L332" name="L332"></a> 332         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L333" name="L333"></a> 333     <em class="brace">}</em>
<a id="L334" name="L334"></a> 334 
<div class="comment">
      Gives notification that something was inserted into the document
      in a location that this view is responsible for.  This is largely
      delegated to the superclass, but is reimplemented to update the
      relevant zone (i.e. determine if a zone needs to be split into a
      set of 2 or more zones).
      @param changes the change information from the associated document
      @param a the current allocation of the view
      @param f the factory to use to rebuild if the view has children
      @see View#insertUpdate</div>
<a id="L347" name="L347"></a> 347     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/20799.html" title="Multiple referred from 23 places.">insertUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> <a href="../D/12317.html" title="Multiple defined in 2 places.">changes</a>, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L348" name="L348"></a> 348         <a href="../S/3346.html#L266" title="Defined at 266 in src/javax/swing/text/ZoneView.java.">handleInsert</a>(<a href="../D/12317.html" title="Multiple defined in 2 places.">changes</a>.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>(), <a href="../D/12317.html" title="Multiple defined in 2 places.">changes</a>.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>());
<a id="L349" name="L349"></a> 349         <strong class="reserved">super</strong>.<a href="../D/24781.html" title="Multiple defined in 28 places.">insertUpdate</a>(<a href="../D/12317.html" title="Multiple defined in 2 places.">changes</a>, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, f);
<a id="L350" name="L350"></a> 350     <em class="brace">}</em>
<a id="L351" name="L351"></a> 351 
<div class="comment">
      Gives notification that something was removed from the document
      in a location that this view is responsible for.  This is largely
      delegated to the superclass, but is reimplemented to update the
      relevant zones (i.e. determine if zones need to be removed or
      joined with another zone).
      @param changes the change information from the associated document
      @param a the current allocation of the view
      @param f the factory to use to rebuild if the view has children
      @see View#removeUpdate</div>
<a id="L364" name="L364"></a> 364     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26095.html" title="Multiple referred from 20 places.">removeUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> <a href="../D/12317.html" title="Multiple defined in 2 places.">changes</a>, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L365" name="L365"></a> 365         <a href="../D/24024.html" title="Multiple defined in 2 places.">handleRemove</a>(<a href="../D/12317.html" title="Multiple defined in 2 places.">changes</a>.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>(), <a href="../D/12317.html" title="Multiple defined in 2 places.">changes</a>.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>());
<a id="L366" name="L366"></a> 366         <strong class="reserved">super</strong>.<a href="../D/30986.html" title="Multiple defined in 27 places.">removeUpdate</a>(<a href="../D/12317.html" title="Multiple defined in 2 places.">changes</a>, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, f);
<a id="L367" name="L367"></a> 367     <em class="brace">}</em>
<a id="L368" name="L368"></a> 368 
<div class="comment">
      Internally created view that has the purpose of holding
      the views that represent the children of the ZoneView
      that have been arranged in a zone.</div>
<a id="L374" name="L374"></a> 374     <strong class="reserved">class</strong> <a href="../S/3346.html#L211" title="Referred from 211 in src/javax/swing/text/ZoneView.java.">Zone</a> <strong class="reserved">extends</strong> <a href="../S/3344.html#L51" title="Defined at 51 in src/javax/swing/text/AsyncBoxView.java.">AsyncBoxView</a> <em class="brace">{</em>
<a id="L375" name="L375"></a> 375 
<a id="L376" name="L376"></a> 376         <strong class="reserved">private</strong> <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L377" name="L377"></a> 377         <strong class="reserved">private</strong> <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>;
<a id="L378" name="L378"></a> 378 
<a id="L379" name="L379"></a> 379         <strong class="reserved">public</strong> Zone(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem, <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L380" name="L380"></a> 380             <strong class="reserved">super</strong>(elem, <a href="../S/3346.html#L78" title="Defined at 78 in src/javax/swing/text/ZoneView.java.">ZoneView</a>.<strong class="reserved">this</strong>.<a href="../D/17162.html" title="Multiple defined in 25 places.">getAxis</a>());
<a id="L381" name="L381"></a> 381             <strong class="reserved">this</strong>.<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L382" name="L382"></a> 382             <strong class="reserved">this</strong>.<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>;
<a id="L383" name="L383"></a> 383         <em class="brace">}</em>
<a id="L384" name="L384"></a> 384 
<div class="comment">
          Creates the child views and populates the
          zone with them.  This is done by translating
          the positions to child element index locations
          and building views to those elements.  If the
          zone is already loaded, this does nothing.</div>
<a id="L392" name="L392"></a> 392         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/22543.html" title="Multiple referred from 196 places.">load</a>() <em class="brace">{</em>
<a id="L393" name="L393"></a> 393             <strong class="reserved">if</strong> (! <a href="../D/25817.html" title="Multiple defined in 2 places.">isLoaded</a>()) <em class="brace">{</em>
<a id="L394" name="L394"></a> 394                 <a href="../S/3344.html#L178" title="Defined at 178 in src/javax/swing/text/AsyncBoxView.java.">setEstimatedMajorSpan</a>(<strong class="reserved">true</strong>);
<a id="L395" name="L395"></a> 395                 <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> e = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L396" name="L396"></a> 396                 <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f = <a href="../D/23602.html" title="Multiple defined in 10 places.">getViewFactory</a>();
<a id="L397" name="L397"></a> 397                 <strong class="reserved">int</strong> index0 = e.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>());
<a id="L398" name="L398"></a> 398                 <strong class="reserved">int</strong> index1 = e.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(<a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>());
<a id="L399" name="L399"></a> 399                 <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[] added = <strong class="reserved">new</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[index1 - index0 + 1];
<a id="L400" name="L400"></a> 400                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = index0; i &lt;= index1; i++) <em class="brace">{</em>
<a id="L401" name="L401"></a> 401                     added[i - index0] = f.<a href="../D/13587.html" title="Multiple defined in 90 places.">create</a>(e.<a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>(i));
<a id="L402" name="L402"></a> 402                 <em class="brace">}</em>
<a id="L403" name="L403"></a> 403                 <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(0, 0, added);
<a id="L404" name="L404"></a> 404 
<a id="L405" name="L405"></a> 405                 <a href="../S/3346.html#L152" title="Defined at 152 in src/javax/swing/text/ZoneView.java.">zoneWasLoaded</a>(<strong class="reserved">this</strong>);
<a id="L406" name="L406"></a> 406             <em class="brace">}</em>
<a id="L407" name="L407"></a> 407         <em class="brace">}</em>
<a id="L408" name="L408"></a> 408 
<div class="comment">
          Removes the child views and returns to a
          state of unloaded.</div>
<a id="L413" name="L413"></a> 413         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../S/1745.html#L1748" title="Referred from 1748 in src/java/lang/ClassLoader.java.">unload</a>() <em class="brace">{</em>
<a id="L414" name="L414"></a> 414             <a href="../S/3344.html#L178" title="Defined at 178 in src/javax/swing/text/AsyncBoxView.java.">setEstimatedMajorSpan</a>(<strong class="reserved">true</strong>);
<a id="L415" name="L415"></a> 415             <a href="../D/30685.html" title="Multiple defined in 45 places.">removeAll</a>();
<a id="L416" name="L416"></a> 416         <em class="brace">}</em>
<a id="L417" name="L417"></a> 417 
<div class="comment">
          Determines if the zone is in the loaded state
          or not.</div>
<a id="L422" name="L422"></a> 422         <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21680.html" title="Multiple referred from 5 places.">isLoaded</a>() <em class="brace">{</em>
<a id="L423" name="L423"></a> 423             <strong class="reserved">return</strong> (<a href="../D/23601.html" title="Multiple defined in 5 places.">getViewCount</a>() != 0);
<a id="L424" name="L424"></a> 424         <em class="brace">}</em>
<a id="L425" name="L425"></a> 425 
<div class="comment">
          This method is reimplemented to not build the children
          since the children are created when the zone is loaded
          rather then when it is placed in the view hierarchy.
          The major span is estimated at this point by building
          the first child (but not storing it), and calling
          setEstimatedMajorSpan(true) followed by setSpan for
          the major axis with the estimated span.</div>
<a id="L435" name="L435"></a> 435         <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/22554.html" title="Multiple referred from 11 places.">loadChildren</a>(<a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L436" name="L436"></a> 436             <em class="comment">// mark the major span as estimated</em>
<a id="L437" name="L437"></a> 437             <a href="../S/3344.html#L178" title="Defined at 178 in src/javax/swing/text/AsyncBoxView.java.">setEstimatedMajorSpan</a>(<strong class="reserved">true</strong>);
<a id="L438" name="L438"></a> 438 
<a id="L439" name="L439"></a> 439             <em class="comment">// estimate the span</em>
<a id="L440" name="L440"></a> 440             <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L441" name="L441"></a> 441             <strong class="reserved">int</strong> index0 = elem.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>());
<a id="L442" name="L442"></a> 442             <strong class="reserved">int</strong> index1 = elem.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(<a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>());
<a id="L443" name="L443"></a> 443             <strong class="reserved">int</strong> nChildren = index1 - index0;
<a id="L444" name="L444"></a> 444 
<a id="L445" name="L445"></a> 445             <em class="comment">// replace this with something real</em>
<a id="L446" name="L446"></a> 446             <em class="comment">//setSpan(getMajorAxis(), nChildren * 10);</em>
<a id="L447" name="L447"></a> 447 
<a id="L448" name="L448"></a> 448             <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a> <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a> = f.<a href="../D/13587.html" title="Multiple defined in 90 places.">create</a>(elem.<a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>(index0));
<a id="L449" name="L449"></a> 449             <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>.<a href="../D/33509.html" title="Multiple defined in 44 places.">setParent</a>(<strong class="reserved">this</strong>);
<a id="L450" name="L450"></a> 450             <strong class="reserved">float</strong> w = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>.<a href="../D/21585.html" title="Multiple defined in 27 places.">getPreferredSpan</a>(X_AXIS);
<a id="L451" name="L451"></a> 451             <strong class="reserved">float</strong> h = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>.<a href="../D/21585.html" title="Multiple defined in 27 places.">getPreferredSpan</a>(Y_AXIS);
<a id="L452" name="L452"></a> 452             <strong class="reserved">if</strong> (<a href="../S/3344.html#L75" title="Defined at 75 in src/javax/swing/text/AsyncBoxView.java.">getMajorAxis</a>() == X_AXIS) <em class="brace">{</em>
<a id="L453" name="L453"></a> 453                 w *= nChildren;
<a id="L454" name="L454"></a> 454             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L455" name="L455"></a> 455                 h += nChildren;
<a id="L456" name="L456"></a> 456             <em class="brace">}</em>
<a id="L457" name="L457"></a> 457 
<a id="L458" name="L458"></a> 458             <a href="../D/33924.html" title="Multiple defined in 54 places.">setSize</a>(w, h);
<a id="L459" name="L459"></a> 459         <em class="brace">}</em>
<a id="L460" name="L460"></a> 460 
<div class="comment">
          Publish the changes in preferences upward to the parent
          view.
          <p>
          This is reimplemented to stop the superclass behavior
          if the zone has not yet been loaded.  If the zone is
          unloaded for example, the last seen major span is the
          best estimate and a calculated span for no children
          is undesirable.</p></div>
<a id="L471" name="L471"></a> 471         <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/14708.html" title="Multiple referred from 2 places.">flushRequirementChanges</a>() <em class="brace">{</em>
<a id="L472" name="L472"></a> 472             <strong class="reserved">if</strong> (<a href="../D/25817.html" title="Multiple defined in 2 places.">isLoaded</a>()) <em class="brace">{</em>
<a id="L473" name="L473"></a> 473                 <strong class="reserved">super</strong>.<a href="../D/16487.html" title="Multiple defined in 2 places.">flushRequirementChanges</a>();
<a id="L474" name="L474"></a> 474             <em class="brace">}</em>
<a id="L475" name="L475"></a> 475         <em class="brace">}</em>
<a id="L476" name="L476"></a> 476 
<div class="comment">
          Returns the child view index representing the given position in
          the model.  Since the zone contains a cluster of the overall
          set of child elements, we can determine the index fairly
          quickly from the model by subtracting the index of the
          start offset from the index of the position given.
          @param pos the position &gt;= 0
          @return  index of the view representing the given position, or
            -1 if no view represents that position
          @since 1.3</div>
<a id="L489" name="L489"></a> 489         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/19807.html" title="Multiple referred from 22 places.">getViewIndex</a>(<strong class="reserved">int</strong> pos, <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a> b) <em class="brace">{</em>
<a id="L490" name="L490"></a> 490             <strong class="reserved">boolean</strong> isBackward = (b == <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a>.Backward);
<a id="L491" name="L491"></a> 491             pos = (isBackward) ? <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(0, pos - 1) : pos;
<a id="L492" name="L492"></a> 492             <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L493" name="L493"></a> 493             <strong class="reserved">int</strong> index1 = elem.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(pos);
<a id="L494" name="L494"></a> 494             <strong class="reserved">int</strong> index0 = elem.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>());
<a id="L495" name="L495"></a> 495             <strong class="reserved">return</strong> index1 - index0;
<a id="L496" name="L496"></a> 496         <em class="brace">}</em>
<a id="L497" name="L497"></a> 497 
<a id="L498" name="L498"></a> 498         <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/29832.html" title="Multiple referred from 6 places.">updateChildren</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a>.<a href="../S/3381.html#L143" title="Defined at 143 in src/javax/swing/event/DocumentEvent.java.">ElementChange</a> ec,
<a id="L499" name="L499"></a> 499                                          <a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L500" name="L500"></a> 500             <em class="comment">// the structure of this element changed.</em>
<a id="L501" name="L501"></a> 501             <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a>[] removedElems = ec.<a href="../D/17657.html" title="Multiple defined in 2 places.">getChildrenRemoved</a>();
<a id="L502" name="L502"></a> 502             <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a>[] addedElems = ec.<a href="../D/17656.html" title="Multiple defined in 2 places.">getChildrenAdded</a>();
<a id="L503" name="L503"></a> 503             <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> elem = <a href="../D/18665.html" title="Multiple defined in 28 places.">getElement</a>();
<a id="L504" name="L504"></a> 504             <strong class="reserved">int</strong> index0 = elem.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(<a href="../D/22718.html" title="Multiple defined in 18 places.">getStartOffset</a>());
<a id="L505" name="L505"></a> 505             <strong class="reserved">int</strong> index1 = elem.<a href="../D/18685.html" title="Multiple defined in 4 places.">getElementIndex</a>(<a href="../D/18771.html" title="Multiple defined in 18 places.">getEndOffset</a>()-1);
<a id="L506" name="L506"></a> 506             <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = ec.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>();
<a id="L507" name="L507"></a> 507             <strong class="reserved">if</strong> ((<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt;= index0) &amp;&amp; (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt;= index1)) <em class="brace">{</em>
<a id="L508" name="L508"></a> 508                 <em class="comment">// The change is in this zone</em>
<a id="L509" name="L509"></a> 509                 <strong class="reserved">int</strong> replaceIndex = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> - index0;
<a id="L510" name="L510"></a> 510                 <strong class="reserved">int</strong> nadd = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(index1 - index0 + 1, addedElems.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L511" name="L511"></a> 511                 <strong class="reserved">int</strong> nremove = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>(index1 - index0 + 1, removedElems.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L512" name="L512"></a> 512                 <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[] added = <strong class="reserved">new</strong> <a href="../S/3338.html#L191" title="Defined at 191 in src/javax/swing/text/View.java.">View</a>[nadd];
<a id="L513" name="L513"></a> 513                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; nadd; i++) <em class="brace">{</em>
<a id="L514" name="L514"></a> 514                     added[i] = f.<a href="../D/13587.html" title="Multiple defined in 90 places.">create</a>(addedElems[i]);
<a id="L515" name="L515"></a> 515                 <em class="brace">}</em>
<a id="L516" name="L516"></a> 516                 <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(replaceIndex, nremove, added);
<a id="L517" name="L517"></a> 517             <em class="brace">}</em>
<a id="L518" name="L518"></a> 518             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L519" name="L519"></a> 519         <em class="brace">}</em>
<a id="L520" name="L520"></a> 520 
<a id="L521" name="L521"></a> 521         <em class="comment">// --- View methods ----------------------------------</em>
<a id="L522" name="L522"></a> 522 
<div class="comment">
          Fetches the attributes to use when rendering.  This view
          isn't directly responsible for an element so it returns
          the outer classes attributes.</div>
<a id="L528" name="L528"></a> 528         <strong class="reserved">public</strong> <a href="../D/585.html" title="Multiple defined in 3 places.">AttributeSet</a> <a href="../R/15169.html" title="Multiple referred from 431 places.">getAttributes</a>() <em class="brace">{</em>
<a id="L529" name="L529"></a> 529             <strong class="reserved">return</strong> <a href="../S/3346.html#L78" title="Defined at 78 in src/javax/swing/text/ZoneView.java.">ZoneView</a>.<strong class="reserved">this</strong>.<a href="../D/17112.html" title="Multiple defined in 109 places.">getAttributes</a>();
<a id="L530" name="L530"></a> 530         <em class="brace">}</em>
<a id="L531" name="L531"></a> 531 
<div class="comment">
          Renders using the given rendering surface and area on that
          surface.  This is implemented to load the zone if its not
          already loaded, and then perform the superclass behavior.
          @param g the rendering surface to use
          @param a the allocated region to render into
          @see View#paint</div>
<a id="L541" name="L541"></a> 541         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/24094.html" title="Multiple referred from 414 places.">paint</a>(<a href="../S/2313.html#L104" title="Defined at 104 in src/java/awt/Graphics.java.">Graphics</a> g, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) <em class="brace">{</em>
<a id="L542" name="L542"></a> 542             <a href="../D/26888.html" title="Multiple defined in 27 places.">load</a>();
<a id="L543" name="L543"></a> 543             <strong class="reserved">super</strong>.<a href="../D/28657.html" title="Multiple defined in 228 places.">paint</a>(g, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L544" name="L544"></a> 544         <em class="brace">}</em>
<a id="L545" name="L545"></a> 545 
<div class="comment">
          Provides a mapping from the view coordinate space to the logical
          coordinate space of the model.  This is implemented to first
          make sure the zone is loaded before providing the superclass
          behavior.
          @param x   x coordinate of the view location to convert &gt;= 0
          @param y   y coordinate of the view location to convert &gt;= 0
          @param a the allocated region to render into
          @return the location within the model that best represents the
           given point in the view &gt;= 0
          @see View#viewToModel</div>
<a id="L559" name="L559"></a> 559         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/30138.html" title="Multiple referred from 99 places.">viewToModel</a>(<strong class="reserved">float</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">float</strong> y, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a>[] bias) <em class="brace">{</em>
<a id="L560" name="L560"></a> 560             <a href="../D/26888.html" title="Multiple defined in 27 places.">load</a>();
<a id="L561" name="L561"></a> 561             <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/36416.html" title="Multiple defined in 28 places.">viewToModel</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, bias);
<a id="L562" name="L562"></a> 562         <em class="brace">}</em>
<a id="L563" name="L563"></a> 563 
<div class="comment">
          Provides a mapping from the document model coordinate space
          to the coordinate space of the view mapped to it.  This is
          implemented to provide the superclass behavior after first
          making sure the zone is loaded (The zone must be loaded to
          make this calculation).
          @param pos the position to convert
          @param a the allocated region to render into
          @return the bounding box of the given position
          @exception BadLocationException  if the given position does not represent a
            valid location in the associated document
          @see View#modelToView</div>
<a id="L578" name="L578"></a> 578         <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../R/23332.html" title="Multiple referred from 109 places.">modelToView</a>(<strong class="reserved">int</strong> pos, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a>.<a href="../S/3329.html#L66" title="Defined at 66 in src/javax/swing/text/Position.java.">Bias</a> b) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L579" name="L579"></a> 579             <a href="../D/26888.html" title="Multiple defined in 27 places.">load</a>();
<a id="L580" name="L580"></a> 580             <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/27746.html" title="Multiple defined in 34 places.">modelToView</a>(pos, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, b);
<a id="L581" name="L581"></a> 581         <em class="brace">}</em>
<a id="L582" name="L582"></a> 582 
<div class="comment">
          Start of the zones range.
          @see View#getStartOffset</div>
<a id="L588" name="L588"></a> 588         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/19172.html" title="Multiple referred from 263 places.">getStartOffset</a>() <em class="brace">{</em>
<a id="L589" name="L589"></a> 589             <strong class="reserved">return</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>();
<a id="L590" name="L590"></a> 590         <em class="brace">}</em>
<a id="L591" name="L591"></a> 591 
<div class="comment">
          End of the zones range.</div>
<a id="L595" name="L595"></a> 595         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/16369.html" title="Multiple referred from 229 places.">getEndOffset</a>() <em class="brace">{</em>
<a id="L596" name="L596"></a> 596             <strong class="reserved">return</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>();
<a id="L597" name="L597"></a> 597         <em class="brace">}</em>
<a id="L598" name="L598"></a> 598 
<div class="comment">
          Gives notification that something was inserted into
          the document in a location that this view is responsible for.
          If the zone has been loaded, the superclass behavior is
          invoked, otherwise this does nothing.
          @param e the change information from the associated document
          @param a the current allocation of the view
          @param f the factory to use to rebuild if the view has children
          @see View#insertUpdate</div>
<a id="L610" name="L610"></a> 610         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/20799.html" title="Multiple referred from 23 places.">insertUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L611" name="L611"></a> 611             <strong class="reserved">if</strong> (<a href="../D/25817.html" title="Multiple defined in 2 places.">isLoaded</a>()) <em class="brace">{</em>
<a id="L612" name="L612"></a> 612                 <strong class="reserved">super</strong>.<a href="../D/24781.html" title="Multiple defined in 28 places.">insertUpdate</a>(e, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, f);
<a id="L613" name="L613"></a> 613             <em class="brace">}</em>
<a id="L614" name="L614"></a> 614         <em class="brace">}</em>
<a id="L615" name="L615"></a> 615 
<div class="comment">
          Gives notification that something was removed from the document
          in a location that this view is responsible for.
          If the zone has been loaded, the superclass behavior is
          invoked, otherwise this does nothing.
          @param e the change information from the associated document
          @param a the current allocation of the view
          @param f the factory to use to rebuild if the view has children
          @see View#removeUpdate</div>
<a id="L627" name="L627"></a> 627         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26095.html" title="Multiple referred from 20 places.">removeUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L628" name="L628"></a> 628             <strong class="reserved">if</strong> (<a href="../D/25817.html" title="Multiple defined in 2 places.">isLoaded</a>()) <em class="brace">{</em>
<a id="L629" name="L629"></a> 629                 <strong class="reserved">super</strong>.<a href="../D/30986.html" title="Multiple defined in 27 places.">removeUpdate</a>(e, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, f);
<a id="L630" name="L630"></a> 630             <em class="brace">}</em>
<a id="L631" name="L631"></a> 631         <em class="brace">}</em>
<a id="L632" name="L632"></a> 632 
<div class="comment">
          Gives notification from the document that attributes were changed
          in a location that this view is responsible for.
          If the zone has been loaded, the superclass behavior is
          invoked, otherwise this does nothing.
          @param e the change information from the associated document
          @param a the current allocation of the view
          @param f the factory to use to rebuild if the view has children
          @see View#removeUpdate</div>
<a id="L644" name="L644"></a> 644         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11034.html" title="Multiple referred from 17 places.">changedUpdate</a>(<a href="../D/2552.html" title="Multiple defined in 2 places.">DocumentEvent</a> e, <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, <a href="../S/3243.html#L36" title="Defined at 36 in src/javax/swing/text/ViewFactory.java.">ViewFactory</a> f) <em class="brace">{</em>
<a id="L645" name="L645"></a> 645             <strong class="reserved">if</strong> (<a href="../D/25817.html" title="Multiple defined in 2 places.">isLoaded</a>()) <em class="brace">{</em>
<a id="L646" name="L646"></a> 646                 <strong class="reserved">super</strong>.<a href="../D/12316.html" title="Multiple defined in 27 places.">changedUpdate</a>(e, <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, f);
<a id="L647" name="L647"></a> 647             <em class="brace">}</em>
<a id="L648" name="L648"></a> 648         <em class="brace">}</em>
<a id="L649" name="L649"></a> 649 
<a id="L650" name="L650"></a> 650     <em class="brace">}</em>
<a id="L651" name="L651"></a> 651 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L98">[^]</a><a href="#L644">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>