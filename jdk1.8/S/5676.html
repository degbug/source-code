<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xml/internal/security/utils/Base64.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L112">[^]</a><a href="#L782">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L112" title="Defined at 112.">getBytes</a></li>
<li><a href="#L152" title="Defined at 152.">encode</a></li>
<li><a href="#L167" title="Defined at 167.">encode</a></li>
<li><a href="#L208" title="Defined at 208.">decodeBigIntegerFromElement</a></li>
<li><a href="#L220" title="Defined at 220.">decodeBigIntegerFromText</a></li>
<li><a href="#L232" title="Defined at 232.">fillElementWithBigInteger</a></li>
<li><a href="#L257" title="Defined at 257.">decode</a></li>
<li><a href="#L283" title="Defined at 283.">encodeToElement</a></li>
<li><a href="#L300" title="Defined at 300.">decode</a></li>
<li><a href="#L311" title="Defined at 311.">encode</a></li>
<li><a href="#L327" title="Defined at 327.">decode</a></li>
<li><a href="#L348" title="Defined at 348.">isWhiteSpace</a></li>
<li><a href="#L352" title="Defined at 352.">isPad</a></li>
<li><a href="#L370" title="Defined at 370.">encode</a></li>
<li><a href="#L479" title="Defined at 479.">decode</a></li>
<li><a href="#L488" title="Defined at 488.">getBytesInternal</a></li>
<li><a href="#L501" title="Defined at 501.">decodeInternal</a></li>
<li><a href="#L599" title="Defined at 599.">decode</a></li>
<li><a href="#L614" title="Defined at 614.">decode</a></li>
<li><a href="#L619" title="Defined at 619.">decode</a></li>
<li><a href="#L705" title="Defined at 705.">decode</a></li>
<li><a href="#L782" title="Defined at 782.">removeWhiteSpace</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements. See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership. The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License. You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied. See the License for the
  specific language governing permissions and limitations
  under the License.</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xml.internal.security.utils;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> java.io.BufferedReader;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> java.io.IOException;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.io.InputStream;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.OutputStream;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.math.BigInteger;
<a id="L30" name="L30"></a>  30 
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.security.exceptions.Base64DecodingException;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> org.w3c.dom.Document;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> org.w3c.dom.Element;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> org.w3c.dom.Node;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> org.w3c.dom.Text;
<a id="L36" name="L36"></a>  36 
<div class="comment">
  Implementation of MIME's Base64 encoding and decoding conversions.
  Optimized code. (raw version taken from oreilly.jonathan.util,
  and currently org.apache.xerces.ds.util.Base64)
  @author Raul Benito(Of the xerces copy, and little adaptations).
  @author Anli Shundi
  @author Christian Geuer-Pollmann
  @see <a href="ftp://ftp.isi.edu/in-notes/rfc2045.txt">RFC 2045</a>
  @see com.sun.org.apache.xml.internal.security.transforms.implementations.TransformBase64Decode</div>
<a id="L48" name="L48"></a>  48 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/650.html" title="Multiple referred from 49 places.">Base64</a> <em class="brace">{</em>
<a id="L49" name="L49"></a>  49 
<div class="comment">
     /** Field BASE64DEFAULTLENGTH */</div>
<a id="L51" name="L51"></a>  51     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> BASE64DEFAULTLENGTH = 76;
<a id="L52" name="L52"></a>  52 
<a id="L53" name="L53"></a>  53     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> BASELENGTH = 255;
<a id="L54" name="L54"></a>  54     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> LOOKUPLENGTH = 64;
<a id="L55" name="L55"></a>  55     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> TWENTYFOURBITGROUP = 24;
<a id="L56" name="L56"></a>  56     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> EIGHTBIT = 8;
<a id="L57" name="L57"></a>  57     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> SIXTEENBIT = 16;
<a id="L58" name="L58"></a>  58     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> FOURBYTE = 4;
<a id="L59" name="L59"></a>  59     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> SIGN = -128;
<a id="L60" name="L60"></a>  60     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">char</strong> PAD = '=';
<a id="L61" name="L61"></a>  61     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">byte</strong> [] base64Alphabet = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[BASELENGTH];
<a id="L62" name="L62"></a>  62     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">char</strong> [] lookUpBase64Alphabet = <strong class="reserved">new</strong> <strong class="reserved">char</strong>[LOOKUPLENGTH];
<a id="L63" name="L63"></a>  63 
<a id="L64" name="L64"></a>  64     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L65" name="L65"></a>  65         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; BASELENGTH; i++) <em class="brace">{</em>
<a id="L66" name="L66"></a>  66             base64Alphabet[i] = -1;
<a id="L67" name="L67"></a>  67         <em class="brace">}</em>
<a id="L68" name="L68"></a>  68         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 'Z'; i &gt;= 'A'; i--) <em class="brace">{</em>
<a id="L69" name="L69"></a>  69             base64Alphabet[i] = (<strong class="reserved">byte</strong>) (i - 'A');
<a id="L70" name="L70"></a>  70         <em class="brace">}</em>
<a id="L71" name="L71"></a>  71         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 'z'; i&gt;= 'a'; i--) <em class="brace">{</em>
<a id="L72" name="L72"></a>  72             base64Alphabet[i] = (<strong class="reserved">byte</strong>) (i - 'a' + 26);
<a id="L73" name="L73"></a>  73         <em class="brace">}</em>
<a id="L74" name="L74"></a>  74 
<a id="L75" name="L75"></a>  75         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = '9'; i &gt;= '0'; i--) <em class="brace">{</em>
<a id="L76" name="L76"></a>  76             base64Alphabet[i] = (<strong class="reserved">byte</strong>) (i - '0' + 52);
<a id="L77" name="L77"></a>  77         <em class="brace">}</em>
<a id="L78" name="L78"></a>  78 
<a id="L79" name="L79"></a>  79         base64Alphabet['+'] = 62;
<a id="L80" name="L80"></a>  80         base64Alphabet['/'] = 63;
<a id="L81" name="L81"></a>  81 
<a id="L82" name="L82"></a>  82         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt;= 25; i++) <em class="brace">{</em>
<a id="L83" name="L83"></a>  83             lookUpBase64Alphabet[i] = (<strong class="reserved">char</strong>)('A' + i);
<a id="L84" name="L84"></a>  84         <em class="brace">}</em>
<a id="L85" name="L85"></a>  85 
<a id="L86" name="L86"></a>  86         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 26,  j = 0; i &lt;= 51; i++, j++) <em class="brace">{</em>
<a id="L87" name="L87"></a>  87             lookUpBase64Alphabet[i] = (<strong class="reserved">char</strong>)('a' + j);
<a id="L88" name="L88"></a>  88         <em class="brace">}</em>
<a id="L89" name="L89"></a>  89 
<a id="L90" name="L90"></a>  90         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 52,  j = 0; i &lt;= 61; i++, j++) <em class="brace">{</em>
<a id="L91" name="L91"></a>  91             lookUpBase64Alphabet[i] = (<strong class="reserved">char</strong>)('0' + j);
<a id="L92" name="L92"></a>  92         <em class="brace">}</em>
<a id="L93" name="L93"></a>  93         lookUpBase64Alphabet[62] = '+';
<a id="L94" name="L94"></a>  94         lookUpBase64Alphabet[63] = '/';
<a id="L95" name="L95"></a>  95     <em class="brace">}</em>
<a id="L96" name="L96"></a>  96 
<a id="L97" name="L97"></a>  97     <strong class="reserved">private</strong> Base64() <em class="brace">{</em>
<a id="L98" name="L98"></a>  98         <em class="comment">// we don't allow instantiation</em>
<a id="L99" name="L99"></a>  99     <em class="brace">}</em>
<a id="L100" name="L100"></a> 100 
<div class="comment">
      Returns a byte-array representation of a <code><a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a><code>.
      No sign-bit is output.
      <b>N.B.:</b> <code><a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a><code>'s toByteArray
      returns eventually longer arrays because of the leading sign-bit.
      @param big <code>BigInteger<code> to be converted
      @param bitlen <code>int<code> the desired length in bits of the representation
      @return a byte array with <code>bitlen</code> bits of <code>big</code></code></code></code></code></code></code></code></code></div>
<a id="L112" name="L112"></a> 112     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">byte</strong>[] <a href="../R/15387.html" title="Multiple referred from 178 places.">getBytes</a>(<a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> big, <strong class="reserved">int</strong> bitlen) <em class="brace">{</em>
<a id="L113" name="L113"></a> 113 
<a id="L114" name="L114"></a> 114         <em class="comment">//round bitlen</em>
<a id="L115" name="L115"></a> 115         bitlen = ((bitlen + 7) &gt;&gt; 3) &lt;&lt; 3;
<a id="L116" name="L116"></a> 116 
<a id="L117" name="L117"></a> 117         <strong class="reserved">if</strong> (bitlen &lt; big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>()) <em class="brace">{</em>
<a id="L118" name="L118"></a> 118             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(<a href="../S/5691.html#L34" title="Defined at 34 in src/com/sun/org/apache/xml/internal/security/utils/I18n.java.">I18n</a>.<a href="../D/35598.html" title="Multiple defined in 116 places.">translate</a>("utils.Base64.IllegalBitlength"));
<a id="L119" name="L119"></a> 119         <em class="brace">}</em>
<a id="L120" name="L120"></a> 120 
<a id="L121" name="L121"></a> 121         <strong class="reserved">byte</strong>[] bigBytes = big.<a href="../D/35362.html" title="Multiple defined in 10 places.">toByteArray</a>();
<a id="L122" name="L122"></a> 122 
<a id="L123" name="L123"></a> 123         <strong class="reserved">if</strong> (((big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>() % 8) != 0)
<a id="L124" name="L124"></a> 124             &amp;&amp; (((big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>() / 8) + 1) == (bitlen / 8))) <em class="brace">{</em>
<a id="L125" name="L125"></a> 125             <strong class="reserved">return</strong> bigBytes;
<a id="L126" name="L126"></a> 126         <em class="brace">}</em>
<a id="L127" name="L127"></a> 127 
<a id="L128" name="L128"></a> 128         <em class="comment">// some copying needed</em>
<a id="L129" name="L129"></a> 129         <strong class="reserved">int</strong> startSrc = 0;    <em class="comment">// no need to skip anything</em>
<a id="L130" name="L130"></a> 130         <strong class="reserved">int</strong> bigLen = bigBytes.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;    <em class="comment">//valid length of the string</em>
<a id="L131" name="L131"></a> 131 
<a id="L132" name="L132"></a> 132         <strong class="reserved">if</strong> ((big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>() % 8) == 0) <em class="brace">{</em>    <em class="comment">// correct values</em>
<a id="L133" name="L133"></a> 133             startSrc = 1;    <em class="comment">// skip sign bit</em>
<a id="L134" name="L134"></a> 134 
<a id="L135" name="L135"></a> 135             bigLen--;    <em class="comment">// valid length of the string</em>
<a id="L136" name="L136"></a> 136         <em class="brace">}</em>
<a id="L137" name="L137"></a> 137 
<a id="L138" name="L138"></a> 138         <strong class="reserved">int</strong> startDst = bitlen / 8 - bigLen;    <em class="comment">//pad with leading nulls</em>
<a id="L139" name="L139"></a> 139         <strong class="reserved">byte</strong>[] resizedBytes = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[bitlen / 8];
<a id="L140" name="L140"></a> 140 
<a id="L141" name="L141"></a> 141         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(bigBytes, startSrc, resizedBytes, startDst, bigLen);
<a id="L142" name="L142"></a> 142 
<a id="L143" name="L143"></a> 143         <strong class="reserved">return</strong> resizedBytes;
<a id="L144" name="L144"></a> 144     <em class="brace">}</em>
<a id="L145" name="L145"></a> 145 
<div class="comment">
      Encode in Base64 the given <code><a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a><code>.
      @param big
      @return String with Base64 encoding</code></code></div>
<a id="L152" name="L152"></a> 152     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/13718.html" title="Multiple referred from 69 places.">encode</a>(<a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> big) <em class="brace">{</em>
<a id="L153" name="L153"></a> 153         <strong class="reserved">return</strong> <a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(<a href="../D/17415.html" title="Multiple defined in 35 places.">getBytes</a>(big, big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>()));
<a id="L154" name="L154"></a> 154     <em class="brace">}</em>
<a id="L155" name="L155"></a> 155 
<div class="comment">
      Returns a byte-array representation of a <code><a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a><code>.
      No sign-bit is output.
      <b>N.B.:</b> <code><a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a><code>'s toByteArray
      returns eventually longer arrays because of the leading sign-bit.
      @param big <code>BigInteger<code> to be converted
      @param bitlen <code>int<code> the desired length in bits of the representation
      @return a byte array with <code>bitlen</code> bits of <code>big</code></code></code></code></code></code></code></code></code></div>
<a id="L167" name="L167"></a> 167     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong>  <strong class="reserved">byte</strong>[] <a href="../R/13718.html" title="Multiple referred from 69 places.">encode</a>(<a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> big, <strong class="reserved">int</strong> bitlen) <em class="brace">{</em>
<a id="L168" name="L168"></a> 168 
<a id="L169" name="L169"></a> 169         <em class="comment">//round bitlen</em>
<a id="L170" name="L170"></a> 170         bitlen = ((bitlen + 7) &gt;&gt; 3) &lt;&lt; 3;
<a id="L171" name="L171"></a> 171 
<a id="L172" name="L172"></a> 172         <strong class="reserved">if</strong> (bitlen &lt; big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>()) <em class="brace">{</em>
<a id="L173" name="L173"></a> 173             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(<a href="../S/5691.html#L34" title="Defined at 34 in src/com/sun/org/apache/xml/internal/security/utils/I18n.java.">I18n</a>.<a href="../D/35598.html" title="Multiple defined in 116 places.">translate</a>("utils.Base64.IllegalBitlength"));
<a id="L174" name="L174"></a> 174         <em class="brace">}</em>
<a id="L175" name="L175"></a> 175 
<a id="L176" name="L176"></a> 176         <strong class="reserved">byte</strong>[] bigBytes = big.<a href="../D/35362.html" title="Multiple defined in 10 places.">toByteArray</a>();
<a id="L177" name="L177"></a> 177 
<a id="L178" name="L178"></a> 178         <strong class="reserved">if</strong> (((big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>() % 8) != 0)
<a id="L179" name="L179"></a> 179             &amp;&amp; (((big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>() / 8) + 1) == (bitlen / 8))) <em class="brace">{</em>
<a id="L180" name="L180"></a> 180             <strong class="reserved">return</strong> bigBytes;
<a id="L181" name="L181"></a> 181         <em class="brace">}</em>
<a id="L182" name="L182"></a> 182 
<a id="L183" name="L183"></a> 183         <em class="comment">// some copying needed</em>
<a id="L184" name="L184"></a> 184         <strong class="reserved">int</strong> startSrc = 0;    <em class="comment">// no need to skip anything</em>
<a id="L185" name="L185"></a> 185         <strong class="reserved">int</strong> bigLen = bigBytes.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;    <em class="comment">//valid length of the string</em>
<a id="L186" name="L186"></a> 186 
<a id="L187" name="L187"></a> 187         <strong class="reserved">if</strong> ((big.<a href="../D/11871.html" title="Multiple defined in 3 places.">bitLength</a>() % 8) == 0) <em class="brace">{</em>    <em class="comment">// correct values</em>
<a id="L188" name="L188"></a> 188             startSrc = 1;    <em class="comment">// skip sign bit</em>
<a id="L189" name="L189"></a> 189 
<a id="L190" name="L190"></a> 190             bigLen--;    <em class="comment">// valid length of the string</em>
<a id="L191" name="L191"></a> 191         <em class="brace">}</em>
<a id="L192" name="L192"></a> 192 
<a id="L193" name="L193"></a> 193         <strong class="reserved">int</strong> startDst = bitlen / 8 - bigLen;    <em class="comment">//pad with leading nulls</em>
<a id="L194" name="L194"></a> 194         <strong class="reserved">byte</strong>[] resizedBytes = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[bitlen / 8];
<a id="L195" name="L195"></a> 195 
<a id="L196" name="L196"></a> 196         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(bigBytes, startSrc, resizedBytes, startDst, bigLen);
<a id="L197" name="L197"></a> 197 
<a id="L198" name="L198"></a> 198         <strong class="reserved">return</strong> resizedBytes;
<a id="L199" name="L199"></a> 199     <em class="brace">}</em>
<a id="L200" name="L200"></a> 200 
<div class="comment">
      Method decodeBigIntegerFromElement
      @param element
      @return the biginteger obtained from the node
      @throws Base64DecodingException</div>
<a id="L208" name="L208"></a> 208     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> decodeBigIntegerFromElement(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>)
<a id="L209" name="L209"></a> 209         <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a> <em class="brace">{</em>
<a id="L210" name="L210"></a> 210         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a>(1, <a href="../D/720.html" title="Multiple defined in 4 places.">Base64</a>.<a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(<a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>));
<a id="L211" name="L211"></a> 211     <em class="brace">}</em>
<a id="L212" name="L212"></a> 212 
<div class="comment">
      Method decodeBigIntegerFromText
      @param text
      @return the biginter obtained from the text node
      @throws Base64DecodingException</div>
<a id="L220" name="L220"></a> 220     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> <a href="../S/5696.html#L343" title="Referred from 343 in src/com/sun/org/apache/xml/internal/security/utils/ElementProxy.java.">decodeBigIntegerFromText</a>(<a href="../D/8891.html" title="Multiple defined in 3 places.">Text</a> <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>)
<a id="L221" name="L221"></a> 221         <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a> <em class="brace">{</em>
<a id="L222" name="L222"></a> 222         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a>(1, <a href="../D/720.html" title="Multiple defined in 4 places.">Base64</a>.<a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/18190.html" title="Multiple defined in 47 places.">getData</a>()));
<a id="L223" name="L223"></a> 223     <em class="brace">}</em>
<a id="L224" name="L224"></a> 224 
<div class="comment">
      This method takes an (empty) Element and a BigInteger and adds the
      base64 encoded BigInteger to the Element.
      @param element
      @param biginteger</div>
<a id="L232" name="L232"></a> 232     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../S/5696.html#L267" title="Referred from 267 in src/com/sun/org/apache/xml/internal/security/utils/ElementProxy.java.">fillElementWithBigInteger</a>(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>, <a href="../S/1462.html#L123" title="Defined at 123 in src/java/math/BigInteger.java.">BigInteger</a> biginteger) <em class="brace">{</em>
<a id="L233" name="L233"></a> 233 
<a id="L234" name="L234"></a> 234         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> encodedInt = <a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(biginteger);
<a id="L235" name="L235"></a> 235 
<a id="L236" name="L236"></a> 236         <strong class="reserved">if</strong> (!<a href="../S/5680.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/security/utils/XMLUtils.java.">XMLUtils</a>.<a href="../S/5680.html#L902" title="Defined at 902 in src/com/sun/org/apache/xml/internal/security/utils/XMLUtils.java.">ignoreLineBreaks</a>() &amp;&amp; encodedInt.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt; BASE64DEFAULTLENGTH) <em class="brace">{</em>
<a id="L237" name="L237"></a> 237             encodedInt = "\n" + encodedInt + "\n";
<a id="L238" name="L238"></a> 238         <em class="brace">}</em>
<a id="L239" name="L239"></a> 239 
<a id="L240" name="L240"></a> 240         <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>.<a href="../D/21292.html" title="Multiple defined in 20 places.">getOwnerDocument</a>();
<a id="L241" name="L241"></a> 241         <a href="../D/8891.html" title="Multiple defined in 3 places.">Text</a> <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a> = doc.<a href="../D/14246.html" title="Multiple defined in 5 places.">createTextNode</a>(encodedInt);
<a id="L242" name="L242"></a> 242 
<a id="L243" name="L243"></a> 243         <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>.<a href="../D/11365.html" title="Multiple defined in 17 places.">appendChild</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>);
<a id="L244" name="L244"></a> 244     <em class="brace">}</em>
<a id="L245" name="L245"></a> 245 
<div class="comment">
      Method decode
      Takes the <code>Text</code> children of the Element and interprets
      them as input for the <code>Base64.decode()</code> function.
      @param element
      @return the byte obtained of the decoding the element
      $todo$ not tested yet
      @throws Base64DecodingException</div>
<a id="L257" name="L257"></a> 257     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">byte</strong>[] <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>) <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a> <em class="brace">{</em>
<a id="L258" name="L258"></a> 258 
<a id="L259" name="L259"></a> 259         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> sibling = <a href="../D/15287.html" title="Multiple defined in 20 places.">element</a>.<a href="../D/19088.html" title="Multiple defined in 18 places.">getFirstChild</a>();
<a id="L260" name="L260"></a> 260         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> sb = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L261" name="L261"></a> 261 
<a id="L262" name="L262"></a> 262         <strong class="reserved">while</strong> (sibling != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L263" name="L263"></a> 263             <strong class="reserved">if</strong> (sibling.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>() == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.TEXT_NODE) <em class="brace">{</em>
<a id="L264" name="L264"></a> 264                 <a href="../D/8891.html" title="Multiple defined in 3 places.">Text</a> t = (<a href="../D/8891.html" title="Multiple defined in 3 places.">Text</a>) sibling;
<a id="L265" name="L265"></a> 265 
<a id="L266" name="L266"></a> 266                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(t.<a href="../D/18190.html" title="Multiple defined in 47 places.">getData</a>());
<a id="L267" name="L267"></a> 267             <em class="brace">}</em>
<a id="L268" name="L268"></a> 268             sibling = sibling.<a href="../D/20935.html" title="Multiple defined in 22 places.">getNextSibling</a>();
<a id="L269" name="L269"></a> 269         <em class="brace">}</em>
<a id="L270" name="L270"></a> 270 
<a id="L271" name="L271"></a> 271         <strong class="reserved">return</strong> <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L272" name="L272"></a> 272     <em class="brace">}</em>
<a id="L273" name="L273"></a> 273 
<div class="comment">
      Method encodeToElement
      @param doc
      @param localName
      @param bytes
      @return an Element with the base64 encoded in the text.</div>
<a id="L283" name="L283"></a> 283     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> <a href="../S/5696.html#L281" title="Referred from 281 in src/com/sun/org/apache/xml/internal/security/utils/ElementProxy.java.">encodeToElement</a>(<a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a>, <strong class="reserved">byte</strong>[] bytes) <em class="brace">{</em>
<a id="L284" name="L284"></a> 284         <a href="../D/2794.html" title="Multiple defined in 8 places.">Element</a> el = <a href="../S/5680.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/security/utils/XMLUtils.java.">XMLUtils</a>.<a href="../S/5680.html#L296" title="Defined at 296 in src/com/sun/org/apache/xml/internal/security/utils/XMLUtils.java.">createElementInSignatureSpace</a>(doc, <a href="../D/27005.html" title="Multiple defined in 2 places.">localName</a>);
<a id="L285" name="L285"></a> 285         <a href="../D/8891.html" title="Multiple defined in 3 places.">Text</a> <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a> = doc.<a href="../D/14246.html" title="Multiple defined in 5 places.">createTextNode</a>(<a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(bytes));
<a id="L286" name="L286"></a> 286 
<a id="L287" name="L287"></a> 287         el.<a href="../D/11365.html" title="Multiple defined in 17 places.">appendChild</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>);
<a id="L288" name="L288"></a> 288 
<a id="L289" name="L289"></a> 289         <strong class="reserved">return</strong> el;
<a id="L290" name="L290"></a> 290     <em class="brace">}</em>
<a id="L291" name="L291"></a> 291 
<div class="comment">
      Method decode
      @param base64
      @return the UTF bytes of the base64
      @throws Base64DecodingException</div>
<a id="L300" name="L300"></a> 300     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">byte</strong>[] <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<strong class="reserved">byte</strong>[] base64) <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>  <em class="brace">{</em>
<a id="L301" name="L301"></a> 301         <strong class="reserved">return</strong> <a href="../S/5676.html#L501" title="Defined at 501 in src/com/sun/org/apache/xml/internal/security/utils/Base64.java.">decodeInternal</a>(base64, -1);
<a id="L302" name="L302"></a> 302     <em class="brace">}</em>
<a id="L303" name="L303"></a> 303 
<div class="comment">
      Encode a byte array and fold lines at the standard 76th character unless
      ignore line breaks property is set.
      @param binaryData <code>byte[]<code> to be base64 encoded
      @return the <code>String<code> with encoded data</code></code></code></code></div>
<a id="L311" name="L311"></a> 311     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/13718.html" title="Multiple referred from 69 places.">encode</a>(<strong class="reserved">byte</strong>[] binaryData) <em class="brace">{</em>
<a id="L312" name="L312"></a> 312         <strong class="reserved">return</strong> <a href="../S/5680.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/security/utils/XMLUtils.java.">XMLUtils</a>.<a href="../S/5680.html#L902" title="Defined at 902 in src/com/sun/org/apache/xml/internal/security/utils/XMLUtils.java.">ignoreLineBreaks</a>()
<a id="L313" name="L313"></a> 313             ? <a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(binaryData, <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MAX_VALUE)
<a id="L314" name="L314"></a> 314             : <a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(binaryData, BASE64DEFAULTLENGTH);
<a id="L315" name="L315"></a> 315     <em class="brace">}</em>
<a id="L316" name="L316"></a> 316 
<div class="comment">
      Base64 decode the lines from the reader and return an InputStream
      with the bytes.
      @param reader
      @return InputStream with the decoded bytes
      @exception IOException passes what the reader throws
      @throws IOException
      @throws Base64DecodingException</div>
<a id="L327" name="L327"></a> 327     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">byte</strong>[] <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<a href="../S/1395.html#L70" title="Defined at 70 in src/java/io/BufferedReader.java.">BufferedReader</a> <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>)
<a id="L328" name="L328"></a> 328         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a> <em class="brace">{</em>
<a id="L329" name="L329"></a> 329 
<a id="L330" name="L330"></a> 330         <strong class="reserved">byte</strong>[] retBytes = <strong class="reserved">null</strong>;
<a id="L331" name="L331"></a> 331         <a href="../S/5698.html#L32" title="Defined at 32 in src/com/sun/org/apache/xml/internal/security/utils/UnsyncByteArrayOutputStream.java.">UnsyncByteArrayOutputStream</a> baos = <strong class="reserved">null</strong>;
<a id="L332" name="L332"></a> 332         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L333" name="L333"></a> 333             baos = <strong class="reserved">new</strong> <a href="../S/5698.html#L32" title="Defined at 32 in src/com/sun/org/apache/xml/internal/security/utils/UnsyncByteArrayOutputStream.java.">UnsyncByteArrayOutputStream</a>();
<a id="L334" name="L334"></a> 334             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>;
<a id="L335" name="L335"></a> 335 
<a id="L336" name="L336"></a> 336             <strong class="reserved">while</strong> (<strong class="reserved">null</strong> != (<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> = <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/30213.html" title="Multiple defined in 17 places.">readLine</a>())) <em class="brace">{</em>
<a id="L337" name="L337"></a> 337                 <strong class="reserved">byte</strong>[] bytes = <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(<a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>);
<a id="L338" name="L338"></a> 338                 baos.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(bytes);
<a id="L339" name="L339"></a> 339             <em class="brace">}</em>
<a id="L340" name="L340"></a> 340             retBytes = baos.<a href="../D/35362.html" title="Multiple defined in 10 places.">toByteArray</a>();
<a id="L341" name="L341"></a> 341         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L342" name="L342"></a> 342             baos.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L343" name="L343"></a> 343         <em class="brace">}</em>
<a id="L344" name="L344"></a> 344 
<a id="L345" name="L345"></a> 345         <strong class="reserved">return</strong> retBytes;
<a id="L346" name="L346"></a> 346     <em class="brace">}</em>
<a id="L347" name="L347"></a> 347 
<a id="L348" name="L348"></a> 348     <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../R/22236.html" title="Multiple referred from 40 places.">isWhiteSpace</a>(<strong class="reserved">byte</strong> octect) <em class="brace">{</em>
<a id="L349" name="L349"></a> 349         <strong class="reserved">return</strong> (octect == 0x20 || octect == 0xd || octect == 0xa || octect == 0x9);
<a id="L350" name="L350"></a> 350     <em class="brace">}</em>
<a id="L351" name="L351"></a> 351 
<a id="L352" name="L352"></a> 352     <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../R/21851.html" title="Multiple referred from 10 places.">isPad</a>(<strong class="reserved">byte</strong> octect) <em class="brace">{</em>
<a id="L353" name="L353"></a> 353         <strong class="reserved">return</strong> (octect == PAD);
<a id="L354" name="L354"></a> 354     <em class="brace">}</em>
<a id="L355" name="L355"></a> 355 
<div class="comment">
      Encodes hex octets into Base64
      @param binaryData Array containing binaryData
      @return Encoded Base64 array</div>
<div class="comment">
      Encode a byte array in Base64 format and return an optionally
      wrapped line.
      @param binaryData <code>byte[]</code> data to be encoded
      @param length <code>int<code> length of wrapped lines; No wrapping if less than 4.
      @return a <code>String</code> with encoded data</code></code></div>
<a id="L370" name="L370"></a> 370     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>  <a href="../R/13718.html" title="Multiple referred from 69 places.">encode</a>(<strong class="reserved">byte</strong>[] binaryData,<strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L371" name="L371"></a> 371         <strong class="reserved">if</strong> (<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &lt; 4) <em class="brace">{</em>
<a id="L372" name="L372"></a> 372             <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> = <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MAX_VALUE;
<a id="L373" name="L373"></a> 373         <em class="brace">}</em>
<a id="L374" name="L374"></a> 374 
<a id="L375" name="L375"></a> 375         <strong class="reserved">if</strong> (binaryData == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L376" name="L376"></a> 376             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L377" name="L377"></a> 377         <em class="brace">}</em>
<a id="L378" name="L378"></a> 378 
<a id="L379" name="L379"></a> 379         <strong class="reserved">int</strong> lengthDataBits = binaryData.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> * EIGHTBIT;
<a id="L380" name="L380"></a> 380         <strong class="reserved">if</strong> (lengthDataBits == 0) <em class="brace">{</em>
<a id="L381" name="L381"></a> 381             <strong class="reserved">return</strong> "";
<a id="L382" name="L382"></a> 382         <em class="brace">}</em>
<a id="L383" name="L383"></a> 383 
<a id="L384" name="L384"></a> 384         <strong class="reserved">int</strong> fewerThan24bits = lengthDataBits % TWENTYFOURBITGROUP;
<a id="L385" name="L385"></a> 385         <strong class="reserved">int</strong> numberTriplets = lengthDataBits / TWENTYFOURBITGROUP;
<a id="L386" name="L386"></a> 386         <strong class="reserved">int</strong> numberQuartet = fewerThan24bits != 0 ? numberTriplets + 1 : numberTriplets;
<a id="L387" name="L387"></a> 387         <strong class="reserved">int</strong> quartesPerLine = <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> / 4;
<a id="L388" name="L388"></a> 388         <strong class="reserved">int</strong> numberLines = (numberQuartet - 1) / quartesPerLine;
<a id="L389" name="L389"></a> 389         <strong class="reserved">char</strong> encodedData[] = <strong class="reserved">null</strong>;
<a id="L390" name="L390"></a> 390 
<a id="L391" name="L391"></a> 391         encodedData = <strong class="reserved">new</strong> <strong class="reserved">char</strong>[numberQuartet * 4 + numberLines];
<a id="L392" name="L392"></a> 392 
<a id="L393" name="L393"></a> 393         <strong class="reserved">byte</strong> k = 0, l = 0, b1 = 0, b2 = 0, b3 = 0;
<a id="L394" name="L394"></a> 394         <strong class="reserved">int</strong> encodedIndex = 0;
<a id="L395" name="L395"></a> 395         <strong class="reserved">int</strong> dataIndex = 0;
<a id="L396" name="L396"></a> 396         <strong class="reserved">int</strong> i = 0;
<a id="L397" name="L397"></a> 397 
<a id="L398" name="L398"></a> 398         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> = 0; <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a> &lt; numberLines; <a href="../S/7696.html#L44" title="Defined at 44 in src/com/sun/javadoc/SourcePosition.java.">line</a>++) <em class="brace">{</em>
<a id="L399" name="L399"></a> 399             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> quartet = 0; quartet &lt; 19; quartet++) <em class="brace">{</em>
<a id="L400" name="L400"></a> 400                 b1 = binaryData[dataIndex++];
<a id="L401" name="L401"></a> 401                 b2 = binaryData[dataIndex++];
<a id="L402" name="L402"></a> 402                 b3 = binaryData[dataIndex++];
<a id="L403" name="L403"></a> 403 
<a id="L404" name="L404"></a> 404                 l  = (<strong class="reserved">byte</strong>)(b2 &amp; 0x0f);
<a id="L405" name="L405"></a> 405                 k  = (<strong class="reserved">byte</strong>)(b1 &amp; 0x03);
<a id="L406" name="L406"></a> 406 
<a id="L407" name="L407"></a> 407                 <strong class="reserved">byte</strong> val1 = ((b1 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b1 &gt;&gt; 2): (<strong class="reserved">byte</strong>)((b1) &gt;&gt; 2 ^ 0xc0);
<a id="L408" name="L408"></a> 408 
<a id="L409" name="L409"></a> 409                 <strong class="reserved">byte</strong> val2 = ((b2 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b2 &gt;&gt; 4) : (<strong class="reserved">byte</strong>)((b2) &gt;&gt; 4 ^ 0xf0);
<a id="L410" name="L410"></a> 410                 <strong class="reserved">byte</strong> val3 = ((b3 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b3 &gt;&gt; 6) : (<strong class="reserved">byte</strong>)((b3) &gt;&gt; 6 ^ 0xfc);
<a id="L411" name="L411"></a> 411 
<a id="L412" name="L412"></a> 412 
<a id="L413" name="L413"></a> 413                 encodedData[encodedIndex++] = lookUpBase64Alphabet[val1];
<a id="L414" name="L414"></a> 414                 encodedData[encodedIndex++] = lookUpBase64Alphabet[val2 | (k &lt;&lt; 4)];
<a id="L415" name="L415"></a> 415                 encodedData[encodedIndex++] = lookUpBase64Alphabet[(l &lt;&lt; 2) | val3];
<a id="L416" name="L416"></a> 416                 encodedData[encodedIndex++] = lookUpBase64Alphabet[b3 &amp; 0x3f];
<a id="L417" name="L417"></a> 417 
<a id="L418" name="L418"></a> 418                 i++;
<a id="L419" name="L419"></a> 419             <em class="brace">}</em>
<a id="L420" name="L420"></a> 420             encodedData[encodedIndex++] = 0xa;
<a id="L421" name="L421"></a> 421         <em class="brace">}</em>
<a id="L422" name="L422"></a> 422 
<a id="L423" name="L423"></a> 423         <strong class="reserved">for</strong> (; i &lt; numberTriplets; i++) <em class="brace">{</em>
<a id="L424" name="L424"></a> 424             b1 = binaryData[dataIndex++];
<a id="L425" name="L425"></a> 425             b2 = binaryData[dataIndex++];
<a id="L426" name="L426"></a> 426             b3 = binaryData[dataIndex++];
<a id="L427" name="L427"></a> 427 
<a id="L428" name="L428"></a> 428             l  = (<strong class="reserved">byte</strong>)(b2 &amp; 0x0f);
<a id="L429" name="L429"></a> 429             k  = (<strong class="reserved">byte</strong>)(b1 &amp; 0x03);
<a id="L430" name="L430"></a> 430 
<a id="L431" name="L431"></a> 431             <strong class="reserved">byte</strong> val1 = ((b1 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b1 &gt;&gt; 2) : (<strong class="reserved">byte</strong>)((b1) &gt;&gt; 2 ^ 0xc0);
<a id="L432" name="L432"></a> 432 
<a id="L433" name="L433"></a> 433             <strong class="reserved">byte</strong> val2 = ((b2 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b2 &gt;&gt; 4) : (<strong class="reserved">byte</strong>)((b2) &gt;&gt; 4 ^ 0xf0);
<a id="L434" name="L434"></a> 434             <strong class="reserved">byte</strong> val3 = ((b3 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b3 &gt;&gt; 6) : (<strong class="reserved">byte</strong>)((b3) &gt;&gt; 6 ^ 0xfc);
<a id="L435" name="L435"></a> 435 
<a id="L436" name="L436"></a> 436 
<a id="L437" name="L437"></a> 437             encodedData[encodedIndex++] = lookUpBase64Alphabet[val1];
<a id="L438" name="L438"></a> 438             encodedData[encodedIndex++] = lookUpBase64Alphabet[val2 | (k &lt;&lt; 4)];
<a id="L439" name="L439"></a> 439             encodedData[encodedIndex++] = lookUpBase64Alphabet[(l &lt;&lt; 2) | val3];
<a id="L440" name="L440"></a> 440             encodedData[encodedIndex++] = lookUpBase64Alphabet[b3 &amp; 0x3f];
<a id="L441" name="L441"></a> 441         <em class="brace">}</em>
<a id="L442" name="L442"></a> 442 
<a id="L443" name="L443"></a> 443         <em class="comment">// form integral number of 6-bit groups</em>
<a id="L444" name="L444"></a> 444         <strong class="reserved">if</strong> (fewerThan24bits == EIGHTBIT) <em class="brace">{</em>
<a id="L445" name="L445"></a> 445             b1 = binaryData[dataIndex];
<a id="L446" name="L446"></a> 446             k = (<strong class="reserved">byte</strong>) (b1 &amp;0x03);
<a id="L447" name="L447"></a> 447             <strong class="reserved">byte</strong> val1 = ((b1 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b1 &gt;&gt; 2):(<strong class="reserved">byte</strong>)((b1) &gt;&gt; 2 ^ 0xc0);
<a id="L448" name="L448"></a> 448             encodedData[encodedIndex++] = lookUpBase64Alphabet[val1];
<a id="L449" name="L449"></a> 449             encodedData[encodedIndex++] = lookUpBase64Alphabet[k &lt;&lt; 4];
<a id="L450" name="L450"></a> 450             encodedData[encodedIndex++] = PAD;
<a id="L451" name="L451"></a> 451             encodedData[encodedIndex++] = PAD;
<a id="L452" name="L452"></a> 452         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (fewerThan24bits == SIXTEENBIT) <em class="brace">{</em>
<a id="L453" name="L453"></a> 453             b1 = binaryData[dataIndex];
<a id="L454" name="L454"></a> 454             b2 = binaryData[dataIndex +1 ];
<a id="L455" name="L455"></a> 455             l = ( <strong class="reserved">byte</strong> ) (b2 &amp; 0x0f);
<a id="L456" name="L456"></a> 456             k = ( <strong class="reserved">byte</strong> ) (b1 &amp; 0x03);
<a id="L457" name="L457"></a> 457 
<a id="L458" name="L458"></a> 458             <strong class="reserved">byte</strong> val1 = ((b1 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b1 &gt;&gt; 2) : (<strong class="reserved">byte</strong>)((b1) &gt;&gt; 2 ^ 0xc0);
<a id="L459" name="L459"></a> 459             <strong class="reserved">byte</strong> val2 = ((b2 &amp; SIGN) == 0) ? (<strong class="reserved">byte</strong>)(b2 &gt;&gt; 4) : (<strong class="reserved">byte</strong>)((b2) &gt;&gt; 4 ^ 0xf0);
<a id="L460" name="L460"></a> 460 
<a id="L461" name="L461"></a> 461             encodedData[encodedIndex++] = lookUpBase64Alphabet[val1];
<a id="L462" name="L462"></a> 462             encodedData[encodedIndex++] = lookUpBase64Alphabet[val2 | (k &lt;&lt; 4)];
<a id="L463" name="L463"></a> 463             encodedData[encodedIndex++] = lookUpBase64Alphabet[l &lt;&lt; 2];
<a id="L464" name="L464"></a> 464             encodedData[encodedIndex++] = PAD;
<a id="L465" name="L465"></a> 465         <em class="brace">}</em>
<a id="L466" name="L466"></a> 466 
<a id="L467" name="L467"></a> 467         <em class="comment">//encodedData[encodedIndex] = 0xa;</em>
<a id="L468" name="L468"></a> 468 
<a id="L469" name="L469"></a> 469         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>(encodedData);
<a id="L470" name="L470"></a> 470     <em class="brace">}</em>
<a id="L471" name="L471"></a> 471 
<div class="comment">
      Decodes Base64 data into octets
      @param encoded String containing base64 encoded data
      @return byte array containing the decoded data
      @throws Base64DecodingException if there is a problem decoding the data</div>
<a id="L479" name="L479"></a> 479     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">byte</strong>[] <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> encoded) <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a> <em class="brace">{</em>
<a id="L480" name="L480"></a> 480         <strong class="reserved">if</strong> (encoded == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L481" name="L481"></a> 481             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L482" name="L482"></a> 482         <em class="brace">}</em>
<a id="L483" name="L483"></a> 483         <strong class="reserved">byte</strong>[] bytes = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[encoded.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()];
<a id="L484" name="L484"></a> 484         <strong class="reserved">int</strong> len = <a href="../S/5676.html#L488" title="Defined at 488 in src/com/sun/org/apache/xml/internal/security/utils/Base64.java.">getBytesInternal</a>(encoded, bytes);
<a id="L485" name="L485"></a> 485         <strong class="reserved">return</strong> <a href="../S/5676.html#L501" title="Defined at 501 in src/com/sun/org/apache/xml/internal/security/utils/Base64.java.">decodeInternal</a>(bytes, len);
<a id="L486" name="L486"></a> 486     <em class="brace">}</em>
<a id="L487" name="L487"></a> 487 
<a id="L488" name="L488"></a> 488     <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/15391.html" title="Multiple referred from 2 places.">getBytesInternal</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <strong class="reserved">byte</strong>[] <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>) <em class="brace">{</em>
<a id="L489" name="L489"></a> 489         <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> = s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L490" name="L490"></a> 490 
<a id="L491" name="L491"></a> 491         <strong class="reserved">int</strong> newSize = 0;
<a id="L492" name="L492"></a> 492         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L493" name="L493"></a> 493             <strong class="reserved">byte</strong> dataS = (<strong class="reserved">byte</strong>)s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L494" name="L494"></a> 494             <strong class="reserved">if</strong> (!<a href="../D/26505.html" title="Multiple defined in 15 places.">isWhiteSpace</a>(dataS)) <em class="brace">{</em>
<a id="L495" name="L495"></a> 495                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>[newSize++] = dataS;
<a id="L496" name="L496"></a> 496             <em class="brace">}</em>
<a id="L497" name="L497"></a> 497         <em class="brace">}</em>
<a id="L498" name="L498"></a> 498         <strong class="reserved">return</strong> newSize;
<a id="L499" name="L499"></a> 499     <em class="brace">}</em>
<a id="L500" name="L500"></a> 500 
<a id="L501" name="L501"></a> 501     <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">byte</strong>[] <a href="../R/12998.html" title="Multiple referred from 2 places.">decodeInternal</a>(<strong class="reserved">byte</strong>[] base64Data, <strong class="reserved">int</strong> len)
<a id="L502" name="L502"></a> 502         <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a> <em class="brace">{</em>
<a id="L503" name="L503"></a> 503         <em class="comment">// remove white spaces</em>
<a id="L504" name="L504"></a> 504         <strong class="reserved">if</strong> (len == -1) <em class="brace">{</em>
<a id="L505" name="L505"></a> 505             len = <a href="../D/30994.html" title="Multiple defined in 3 places.">removeWhiteSpace</a>(base64Data);
<a id="L506" name="L506"></a> 506         <em class="brace">}</em>
<a id="L507" name="L507"></a> 507 
<a id="L508" name="L508"></a> 508         <strong class="reserved">if</strong> (len % FOURBYTE != 0) <em class="brace">{</em>
<a id="L509" name="L509"></a> 509             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.divisible.four");
<a id="L510" name="L510"></a> 510             <em class="comment">//should be divisible by four</em>
<a id="L511" name="L511"></a> 511         <em class="brace">}</em>
<a id="L512" name="L512"></a> 512 
<a id="L513" name="L513"></a> 513         <strong class="reserved">int</strong> numberQuadruple = (len / FOURBYTE);
<a id="L514" name="L514"></a> 514 
<a id="L515" name="L515"></a> 515         <strong class="reserved">if</strong> (numberQuadruple == 0) <em class="brace">{</em>
<a id="L516" name="L516"></a> 516             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[0];
<a id="L517" name="L517"></a> 517         <em class="brace">}</em>
<a id="L518" name="L518"></a> 518 
<a id="L519" name="L519"></a> 519         <strong class="reserved">byte</strong> decodedData[] = <strong class="reserved">null</strong>;
<a id="L520" name="L520"></a> 520         <strong class="reserved">byte</strong> b1 = 0, b2 = 0, b3 = 0, b4 = 0;
<a id="L521" name="L521"></a> 521 
<a id="L522" name="L522"></a> 522         <strong class="reserved">int</strong> i = 0;
<a id="L523" name="L523"></a> 523         <strong class="reserved">int</strong> encodedIndex = 0;
<a id="L524" name="L524"></a> 524         <strong class="reserved">int</strong> dataIndex = 0;
<a id="L525" name="L525"></a> 525 
<a id="L526" name="L526"></a> 526         <em class="comment">//decodedData = new byte[ (numberQuadruple)*3];</em>
<a id="L527" name="L527"></a> 527         dataIndex = (numberQuadruple - 1) * 4;
<a id="L528" name="L528"></a> 528         encodedIndex = (numberQuadruple - 1) * 3;
<a id="L529" name="L529"></a> 529         <em class="comment">//first last bits.</em>
<a id="L530" name="L530"></a> 530         b1 = base64Alphabet[base64Data[dataIndex++]];
<a id="L531" name="L531"></a> 531         b2 = base64Alphabet[base64Data[dataIndex++]];
<a id="L532" name="L532"></a> 532         <strong class="reserved">if</strong> ((b1==-1) || (b2==-1)) <em class="brace">{</em>
<a id="L533" name="L533"></a> 533              <em class="comment">//if found "no data" just return null</em>
<a id="L534" name="L534"></a> 534             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L535" name="L535"></a> 535         <em class="brace">}</em>
<a id="L536" name="L536"></a> 536 
<a id="L537" name="L537"></a> 537 
<a id="L538" name="L538"></a> 538         <strong class="reserved">byte</strong> d3, d4;
<a id="L539" name="L539"></a> 539         b3 = base64Alphabet[d3 = base64Data[dataIndex++]];
<a id="L540" name="L540"></a> 540         b4 = base64Alphabet[d4 = base64Data[dataIndex++]];
<a id="L541" name="L541"></a> 541         <strong class="reserved">if</strong> ((b3 == -1) || (b4 == -1) ) <em class="brace">{</em>
<a id="L542" name="L542"></a> 542             <em class="comment">//Check if they are PAD characters</em>
<a id="L543" name="L543"></a> 543             <strong class="reserved">if</strong> (<a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d3) &amp;&amp; <a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d4)) <em class="brace">{</em>               <em class="comment">//Two PAD e.g. 3c[Pad][Pad]</em>
<a id="L544" name="L544"></a> 544                 <strong class="reserved">if</strong> ((b2 &amp; 0xf) != 0) <em class="brace">{</em> <em class="comment">//last 4 bits should be zero</em>
<a id="L545" name="L545"></a> 545                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L546" name="L546"></a> 546                 <em class="brace">}</em>
<a id="L547" name="L547"></a> 547                 decodedData = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[encodedIndex + 1];
<a id="L548" name="L548"></a> 548                 decodedData[encodedIndex]   = (<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4) ;
<a id="L549" name="L549"></a> 549             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!<a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d3) &amp;&amp; <a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d4)) <em class="brace">{</em>               <em class="comment">//One PAD  e.g. 3cQ[Pad]</em>
<a id="L550" name="L550"></a> 550                 <strong class="reserved">if</strong> ((b3 &amp; 0x3) != 0) <em class="brace">{</em> <em class="comment">//last 2 bits should be zero</em>
<a id="L551" name="L551"></a> 551                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L552" name="L552"></a> 552                 <em class="brace">}</em>
<a id="L553" name="L553"></a> 553                 decodedData = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[encodedIndex + 2];
<a id="L554" name="L554"></a> 554                 decodedData[encodedIndex++] = (<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4);
<a id="L555" name="L555"></a> 555                 decodedData[encodedIndex] = (<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4) |((b3 &gt;&gt; 2) &amp; 0xf));
<a id="L556" name="L556"></a> 556             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L557" name="L557"></a> 557                 <em class="comment">//an error  like "3c[Pad]r", "3cdX", "3cXd", "3cXX" where X is non data</em>
<a id="L558" name="L558"></a> 558                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L559" name="L559"></a> 559             <em class="brace">}</em>
<a id="L560" name="L560"></a> 560         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L561" name="L561"></a> 561             <em class="comment">//No PAD e.g 3cQl</em>
<a id="L562" name="L562"></a> 562             decodedData = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[encodedIndex+3];
<a id="L563" name="L563"></a> 563             decodedData[encodedIndex++] = (<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4) ;
<a id="L564" name="L564"></a> 564             decodedData[encodedIndex++] = (<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4) | ((b3 &gt;&gt; 2) &amp; 0xf));
<a id="L565" name="L565"></a> 565             decodedData[encodedIndex++] = (<strong class="reserved">byte</strong>)(b3 &lt;&lt; 6 | b4);
<a id="L566" name="L566"></a> 566         <em class="brace">}</em>
<a id="L567" name="L567"></a> 567         encodedIndex = 0;
<a id="L568" name="L568"></a> 568         dataIndex = 0;
<a id="L569" name="L569"></a> 569         <em class="comment">//the begin</em>
<a id="L570" name="L570"></a> 570         <strong class="reserved">for</strong> (i = numberQuadruple - 1; i &gt; 0; i--) <em class="brace">{</em>
<a id="L571" name="L571"></a> 571             b1 = base64Alphabet[base64Data[dataIndex++]];
<a id="L572" name="L572"></a> 572             b2 = base64Alphabet[base64Data[dataIndex++]];
<a id="L573" name="L573"></a> 573             b3 = base64Alphabet[base64Data[dataIndex++]];
<a id="L574" name="L574"></a> 574             b4 = base64Alphabet[base64Data[dataIndex++]];
<a id="L575" name="L575"></a> 575 
<a id="L576" name="L576"></a> 576             <strong class="reserved">if</strong> ((b1 == -1) ||
<a id="L577" name="L577"></a> 577                 (b2 == -1) ||
<a id="L578" name="L578"></a> 578                 (b3 == -1) ||
<a id="L579" name="L579"></a> 579                 (b4 == -1)) <em class="brace">{</em>
<a id="L580" name="L580"></a> 580                 <em class="comment">//if found "no data" just return null</em>
<a id="L581" name="L581"></a> 581                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L582" name="L582"></a> 582             <em class="brace">}</em>
<a id="L583" name="L583"></a> 583 
<a id="L584" name="L584"></a> 584             decodedData[encodedIndex++] = (<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4) ;
<a id="L585" name="L585"></a> 585             decodedData[encodedIndex++] = (<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4) |((b3 &gt;&gt; 2) &amp; 0xf));
<a id="L586" name="L586"></a> 586             decodedData[encodedIndex++] = (<strong class="reserved">byte</strong>)(b3 &lt;&lt; 6 | b4 );
<a id="L587" name="L587"></a> 587         <em class="brace">}</em>
<a id="L588" name="L588"></a> 588         <strong class="reserved">return</strong> decodedData;
<a id="L589" name="L589"></a> 589     <em class="brace">}</em>
<a id="L590" name="L590"></a> 590 
<div class="comment">
      Decodes Base64 data into outputstream
      @param base64Data String containing Base64 data
      @param os the outputstream
      @throws IOException
      @throws Base64DecodingException</div>
<a id="L599" name="L599"></a> 599     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> base64Data, <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> os)
<a id="L600" name="L600"></a> 600         <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>, <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L601" name="L601"></a> 601         <strong class="reserved">byte</strong>[] bytes = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[base64Data.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()];
<a id="L602" name="L602"></a> 602         <strong class="reserved">int</strong> len = <a href="../S/5676.html#L488" title="Defined at 488 in src/com/sun/org/apache/xml/internal/security/utils/Base64.java.">getBytesInternal</a>(base64Data, bytes);
<a id="L603" name="L603"></a> 603         <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(bytes,os,len);
<a id="L604" name="L604"></a> 604     <em class="brace">}</em>
<a id="L605" name="L605"></a> 605 
<div class="comment">
      Decodes Base64 data into outputstream
      @param base64Data Byte array containing Base64 data
      @param os the outputstream
      @throws IOException
      @throws Base64DecodingException</div>
<a id="L614" name="L614"></a> 614     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<strong class="reserved">byte</strong>[] base64Data, <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> os)
<a id="L615" name="L615"></a> 615         <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>, <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L616" name="L616"></a> 616         <a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(base64Data,os,-1);
<a id="L617" name="L617"></a> 617     <em class="brace">}</em>
<a id="L618" name="L618"></a> 618 
<a id="L619" name="L619"></a> 619     <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<strong class="reserved">byte</strong>[] base64Data, <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> os, <strong class="reserved">int</strong> len)
<a id="L620" name="L620"></a> 620         <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>, <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L621" name="L621"></a> 621         <em class="comment">// remove white spaces</em>
<a id="L622" name="L622"></a> 622         <strong class="reserved">if</strong> (len == -1) <em class="brace">{</em>
<a id="L623" name="L623"></a> 623             len = <a href="../D/30994.html" title="Multiple defined in 3 places.">removeWhiteSpace</a>(base64Data);
<a id="L624" name="L624"></a> 624         <em class="brace">}</em>
<a id="L625" name="L625"></a> 625 
<a id="L626" name="L626"></a> 626         <strong class="reserved">if</strong> (len % FOURBYTE != 0) <em class="brace">{</em>
<a id="L627" name="L627"></a> 627             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.divisible.four");
<a id="L628" name="L628"></a> 628             <em class="comment">//should be divisible by four</em>
<a id="L629" name="L629"></a> 629         <em class="brace">}</em>
<a id="L630" name="L630"></a> 630 
<a id="L631" name="L631"></a> 631         <strong class="reserved">int</strong> numberQuadruple = (len / FOURBYTE);
<a id="L632" name="L632"></a> 632 
<a id="L633" name="L633"></a> 633         <strong class="reserved">if</strong> (numberQuadruple == 0) <em class="brace">{</em>
<a id="L634" name="L634"></a> 634             <strong class="reserved">return</strong>;
<a id="L635" name="L635"></a> 635         <em class="brace">}</em>
<a id="L636" name="L636"></a> 636 
<a id="L637" name="L637"></a> 637         <em class="comment">//byte decodedData[] = null;</em>
<a id="L638" name="L638"></a> 638         <strong class="reserved">byte</strong> b1 = 0, b2 = 0, b3 = 0, b4 = 0;
<a id="L639" name="L639"></a> 639 
<a id="L640" name="L640"></a> 640         <strong class="reserved">int</strong> i = 0;
<a id="L641" name="L641"></a> 641         <strong class="reserved">int</strong> dataIndex = 0;
<a id="L642" name="L642"></a> 642 
<a id="L643" name="L643"></a> 643         <em class="comment">//the begin</em>
<a id="L644" name="L644"></a> 644         <strong class="reserved">for</strong> (i=numberQuadruple - 1; i &gt; 0; i--) <em class="brace">{</em>
<a id="L645" name="L645"></a> 645             b1 = base64Alphabet[base64Data[dataIndex++]];
<a id="L646" name="L646"></a> 646             b2 = base64Alphabet[base64Data[dataIndex++]];
<a id="L647" name="L647"></a> 647             b3 = base64Alphabet[base64Data[dataIndex++]];
<a id="L648" name="L648"></a> 648             b4 = base64Alphabet[base64Data[dataIndex++]];
<a id="L649" name="L649"></a> 649             <strong class="reserved">if</strong> ((b1 == -1) ||
<a id="L650" name="L650"></a> 650                 (b2 == -1) ||
<a id="L651" name="L651"></a> 651                 (b3 == -1) ||
<a id="L652" name="L652"></a> 652                 (b4 == -1) ) <em class="brace">{</em>
<a id="L653" name="L653"></a> 653                 <em class="comment">//if found "no data" just return null</em>
<a id="L654" name="L654"></a> 654                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L655" name="L655"></a> 655             <em class="brace">}</em>
<a id="L656" name="L656"></a> 656 
<a id="L657" name="L657"></a> 657             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4));
<a id="L658" name="L658"></a> 658             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4 ) | ((b3 &gt;&gt; 2) &amp; 0xf)));
<a id="L659" name="L659"></a> 659             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>( (<strong class="reserved">byte</strong>)(b3 &lt;&lt; 6 | b4));
<a id="L660" name="L660"></a> 660         <em class="brace">}</em>
<a id="L661" name="L661"></a> 661         b1 = base64Alphabet[base64Data[dataIndex++]];
<a id="L662" name="L662"></a> 662         b2 = base64Alphabet[base64Data[dataIndex++]];
<a id="L663" name="L663"></a> 663 
<a id="L664" name="L664"></a> 664         <em class="comment">//  first last bits.</em>
<a id="L665" name="L665"></a> 665         <strong class="reserved">if</strong> ((b1 == -1) || (b2 == -1) ) <em class="brace">{</em>
<a id="L666" name="L666"></a> 666             <em class="comment">//if found "no data" just return null</em>
<a id="L667" name="L667"></a> 667             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L668" name="L668"></a> 668         <em class="brace">}</em>
<a id="L669" name="L669"></a> 669 
<a id="L670" name="L670"></a> 670         <strong class="reserved">byte</strong> d3, d4;
<a id="L671" name="L671"></a> 671         b3 = base64Alphabet[d3 = base64Data[dataIndex++]];
<a id="L672" name="L672"></a> 672         b4 = base64Alphabet[d4 = base64Data[dataIndex++]];
<a id="L673" name="L673"></a> 673         <strong class="reserved">if</strong> ((b3 == -1 ) || (b4 == -1) ) <em class="brace">{</em> <em class="comment">//Check if they are PAD characters</em>
<a id="L674" name="L674"></a> 674             <strong class="reserved">if</strong> (<a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d3) &amp;&amp; <a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d4)) <em class="brace">{</em>               <em class="comment">//Two PAD e.g. 3c[Pad][Pad]</em>
<a id="L675" name="L675"></a> 675                 <strong class="reserved">if</strong> ((b2 &amp; 0xf) != 0) <em class="brace">{</em> <em class="comment">//last 4 bits should be zero</em>
<a id="L676" name="L676"></a> 676                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L677" name="L677"></a> 677                 <em class="brace">}</em>
<a id="L678" name="L678"></a> 678                 os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4));
<a id="L679" name="L679"></a> 679             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!<a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d3) &amp;&amp; <a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d4)) <em class="brace">{</em>               <em class="comment">//One PAD  e.g. 3cQ[Pad]</em>
<a id="L680" name="L680"></a> 680                 <strong class="reserved">if</strong> ((b3 &amp; 0x3 ) != 0) <em class="brace">{</em> <em class="comment">//last 2 bits should be zero</em>
<a id="L681" name="L681"></a> 681                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L682" name="L682"></a> 682                 <em class="brace">}</em>
<a id="L683" name="L683"></a> 683                 os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4));
<a id="L684" name="L684"></a> 684                 os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4) | ((b3 &gt;&gt; 2) &amp; 0xf)));
<a id="L685" name="L685"></a> 685             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L686" name="L686"></a> 686                 <em class="comment">//an error  like "3c[Pad]r", "3cdX", "3cXd", "3cXX" where X is non data</em>
<a id="L687" name="L687"></a> 687                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L688" name="L688"></a> 688             <em class="brace">}</em>
<a id="L689" name="L689"></a> 689         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L690" name="L690"></a> 690             <em class="comment">//No PAD e.g 3cQl</em>
<a id="L691" name="L691"></a> 691             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4));
<a id="L692" name="L692"></a> 692             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>( (<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4) | ((b3 &gt;&gt; 2) &amp; 0xf)));
<a id="L693" name="L693"></a> 693             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b3 &lt;&lt; 6 | b4));
<a id="L694" name="L694"></a> 694         <em class="brace">}</em>
<a id="L695" name="L695"></a> 695     <em class="brace">}</em>
<a id="L696" name="L696"></a> 696 
<div class="comment">
      Decodes Base64 data into  outputstream
      @param is containing Base64 data
      @param os the outputstream
      @throws IOException
      @throws Base64DecodingException</div>
<a id="L705" name="L705"></a> 705     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/12941.html" title="Multiple referred from 73 places.">decode</a>(<a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/25134.html" title="Multiple defined in 5 places.">is</a>, <a href="../D/6445.html" title="Multiple defined in 3 places.">OutputStream</a> os)
<a id="L706" name="L706"></a> 706         <strong class="reserved">throws</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>, <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L707" name="L707"></a> 707         <em class="comment">//byte decodedData[] = null;</em>
<a id="L708" name="L708"></a> 708         <strong class="reserved">byte</strong> b1 = 0, b2 = 0, b3 = 0, b4 = 0;
<a id="L709" name="L709"></a> 709 
<a id="L710" name="L710"></a> 710         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>=0;
<a id="L711" name="L711"></a> 711         <strong class="reserved">byte</strong>[] <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a> = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[4];
<a id="L712" name="L712"></a> 712         <strong class="reserved">int</strong> <a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>;
<a id="L713" name="L713"></a> 713         <em class="comment">//the begin</em>
<a id="L714" name="L714"></a> 714         <strong class="reserved">while</strong> ((<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a> = <a href="../D/25134.html" title="Multiple defined in 5 places.">is</a>.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>()) &gt; 0) <em class="brace">{</em>
<a id="L715" name="L715"></a> 715             <strong class="reserved">byte</strong> readed = (<strong class="reserved">byte</strong>)<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>;
<a id="L716" name="L716"></a> 716             <strong class="reserved">if</strong> (<a href="../D/26505.html" title="Multiple defined in 15 places.">isWhiteSpace</a>(readed)) <em class="brace">{</em>
<a id="L717" name="L717"></a> 717                 <strong class="reserved">continue</strong>;
<a id="L718" name="L718"></a> 718             <em class="brace">}</em>
<a id="L719" name="L719"></a> 719             <strong class="reserved">if</strong> (<a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(readed)) <em class="brace">{</em>
<a id="L720" name="L720"></a> 720                 <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] = readed;
<a id="L721" name="L721"></a> 721                 <strong class="reserved">if</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == 3) <em class="brace">{</em>
<a id="L722" name="L722"></a> 722                     <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] = (<strong class="reserved">byte</strong>)<a href="../D/25134.html" title="Multiple defined in 5 places.">is</a>.<a href="../D/30105.html" title="Multiple defined in 434 places.">read</a>();
<a id="L723" name="L723"></a> 723                 <em class="brace">}</em>
<a id="L724" name="L724"></a> 724                 <strong class="reserved">break</strong>;
<a id="L725" name="L725"></a> 725             <em class="brace">}</em>
<a id="L726" name="L726"></a> 726 
<a id="L727" name="L727"></a> 727             <strong class="reserved">if</strong> ((<a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] = readed) == -1) <em class="brace">{</em>
<a id="L728" name="L728"></a> 728                 <em class="comment">//if found "no data" just return null</em>
<a id="L729" name="L729"></a> 729                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L730" name="L730"></a> 730             <em class="brace">}</em>
<a id="L731" name="L731"></a> 731 
<a id="L732" name="L732"></a> 732             <strong class="reserved">if</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> != 4) <em class="brace">{</em>
<a id="L733" name="L733"></a> 733                 <strong class="reserved">continue</strong>;
<a id="L734" name="L734"></a> 734             <em class="brace">}</em>
<a id="L735" name="L735"></a> 735             <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = 0;
<a id="L736" name="L736"></a> 736             b1 = base64Alphabet[<a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[0]];
<a id="L737" name="L737"></a> 737             b2 = base64Alphabet[<a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[1]];
<a id="L738" name="L738"></a> 738             b3 = base64Alphabet[<a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[2]];
<a id="L739" name="L739"></a> 739             b4 = base64Alphabet[<a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[3]];
<a id="L740" name="L740"></a> 740 
<a id="L741" name="L741"></a> 741             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4));
<a id="L742" name="L742"></a> 742             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4) | ((b3 &gt;&gt; 2) &amp; 0xf)));
<a id="L743" name="L743"></a> 743             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b3 &lt;&lt; 6 | b4));
<a id="L744" name="L744"></a> 744         <em class="brace">}</em>
<a id="L745" name="L745"></a> 745 
<a id="L746" name="L746"></a> 746         <strong class="reserved">byte</strong> d1 = <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[0], d2 = <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[1], d3 = <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[2], d4 = <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[3];
<a id="L747" name="L747"></a> 747         b1 = base64Alphabet[d1];
<a id="L748" name="L748"></a> 748         b2 = base64Alphabet[d2];
<a id="L749" name="L749"></a> 749         b3 = base64Alphabet[d3];
<a id="L750" name="L750"></a> 750         b4 = base64Alphabet[d4];
<a id="L751" name="L751"></a> 751         <strong class="reserved">if</strong> ((b3 == -1) || (b4 == -1)) <em class="brace">{</em> <em class="comment">//Check if they are PAD characters</em>
<a id="L752" name="L752"></a> 752             <strong class="reserved">if</strong> (<a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d3) &amp;&amp; <a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d4)) <em class="brace">{</em>               <em class="comment">//Two PAD e.g. 3c[Pad][Pad]</em>
<a id="L753" name="L753"></a> 753                 <strong class="reserved">if</strong> ((b2 &amp; 0xf) != 0) <em class="brace">{</em> <em class="comment">//last 4 bits should be zero</em>
<a id="L754" name="L754"></a> 754                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L755" name="L755"></a> 755                 <em class="brace">}</em>
<a id="L756" name="L756"></a> 756                 os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4));
<a id="L757" name="L757"></a> 757             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!<a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d3) &amp;&amp; <a href="../D/26028.html" title="Multiple defined in 2 places.">isPad</a>(d4)) <em class="brace">{</em>               <em class="comment">//One PAD  e.g. 3cQ[Pad]</em>
<a id="L758" name="L758"></a> 758                 b3 = base64Alphabet[d3];
<a id="L759" name="L759"></a> 759                 <strong class="reserved">if</strong> ((b3 &amp; 0x3) != 0) <em class="brace">{</em> <em class="comment">//last 2 bits should be zero</em>
<a id="L760" name="L760"></a> 760                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L761" name="L761"></a> 761                 <em class="brace">}</em>
<a id="L762" name="L762"></a> 762                 os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4));
<a id="L763" name="L763"></a> 763                 os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4) | ((b3 &gt;&gt; 2) &amp; 0xf)));
<a id="L764" name="L764"></a> 764             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L765" name="L765"></a> 765                 <em class="comment">//an error  like "3c[Pad]r", "3cdX", "3cXd", "3cXX" where X is non data</em>
<a id="L766" name="L766"></a> 766                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5714.html#L30" title="Defined at 30 in src/com/sun/org/apache/xml/internal/security/exceptions/Base64DecodingException.java.">Base64DecodingException</a>("decoding.general");
<a id="L767" name="L767"></a> 767             <em class="brace">}</em>
<a id="L768" name="L768"></a> 768         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L769" name="L769"></a> 769             <em class="comment">//No PAD e.g 3cQl</em>
<a id="L770" name="L770"></a> 770             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b1 &lt;&lt; 2 | b2 &gt;&gt; 4));
<a id="L771" name="L771"></a> 771             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(((b2 &amp; 0xf) &lt;&lt; 4) | ((b3 &gt;&gt; 2) &amp; 0xf)));
<a id="L772" name="L772"></a> 772             os.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>((<strong class="reserved">byte</strong>)(b3 &lt;&lt; 6 | b4));
<a id="L773" name="L773"></a> 773         <em class="brace">}</em>
<a id="L774" name="L774"></a> 774     <em class="brace">}</em>
<a id="L775" name="L775"></a> 775 
<div class="comment">
      remove WhiteSpace from MIME containing encoded Base64 data.
      @param data  the byte array of base64 data (with WS)
      @return      the new length</div>
<a id="L782" name="L782"></a> 782     <strong class="reserved">protected</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/26102.html" title="Multiple referred from 3 places.">removeWhiteSpace</a>(<strong class="reserved">byte</strong>[] <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>) <em class="brace">{</em>
<a id="L783" name="L783"></a> 783         <strong class="reserved">if</strong> (<a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L784" name="L784"></a> 784             <strong class="reserved">return</strong> 0;
<a id="L785" name="L785"></a> 785         <em class="brace">}</em>
<a id="L786" name="L786"></a> 786 
<a id="L787" name="L787"></a> 787         <em class="comment">// count characters that's not whitespace</em>
<a id="L788" name="L788"></a> 788         <strong class="reserved">int</strong> newSize = 0;
<a id="L789" name="L789"></a> 789         <strong class="reserved">int</strong> len = <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L790" name="L790"></a> 790         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; len; i++) <em class="brace">{</em>
<a id="L791" name="L791"></a> 791             <strong class="reserved">byte</strong> dataS = <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[i];
<a id="L792" name="L792"></a> 792             <strong class="reserved">if</strong> (!<a href="../D/26505.html" title="Multiple defined in 15 places.">isWhiteSpace</a>(dataS)) <em class="brace">{</em>
<a id="L793" name="L793"></a> 793                 <a href="../S/6040.html#L177" title="Defined at 177 in src/com/sun/org/apache/xalan/internal/xsltc/dom/BitArray.java.">data</a>[newSize++] = dataS;
<a id="L794" name="L794"></a> 794             <em class="brace">}</em>
<a id="L795" name="L795"></a> 795         <em class="brace">}</em>
<a id="L796" name="L796"></a> 796         <strong class="reserved">return</strong> newSize;
<a id="L797" name="L797"></a> 797     <em class="brace">}</em>
<a id="L798" name="L798"></a> 798 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L112">[^]</a><a href="#L782">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>