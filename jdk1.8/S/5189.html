<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xerces/internal/impl/dv/xs/MonthDV.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L48">[^]</a><a href="#L162">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L48" title="Defined at 48.">getActualValue</a></li>
<li><a href="#L64" title="Defined at 64.">parse</a></li>
<li><a href="#L153" title="Defined at 153.">dateToString</a></li>
<li><a href="#L162" title="Defined at 162.">getXMLGregorianCalendar</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2002,2004,2005 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
       http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<a id="L20" name="L20"></a>  20 
<a id="L21" name="L21"></a>  21 <strong class="reserved">package</strong> com.sun.org.apache.xerces.internal.<a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>.dv.xs;
<a id="L22" name="L22"></a>  22 
<a id="L23" name="L23"></a>  23 <strong class="reserved">import</strong> javax.xml.datatype.DatatypeConstants;
<a id="L24" name="L24"></a>  24 <strong class="reserved">import</strong> javax.xml.datatype.XMLGregorianCalendar;
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.impl.dv.InvalidDatatypeValueException;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.impl.dv.ValidationContext;
<a id="L28" name="L28"></a>  28 
<div class="comment">
  Validator for &lt;gMonth&gt; datatype (W3C Schema Datatypes)
  @xerces.internal
  @author Elena Litani
  @author Gopal Sharma, SUN Microsystem Inc.
  @version $Id: MonthDV.java,v 1.8 2010-11-01 04:39:47 joehw Exp $</div>
<a id="L39" name="L39"></a>  39 
<a id="L40" name="L40"></a>  40 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../S/5206.html#L114" title="Referred from 114 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/XSSimpleTypeDecl.java.">MonthDV</a> <strong class="reserved">extends</strong> <a href="../S/5190.html#L52" title="Defined at 52 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">AbstractDateTimeDV</a> <em class="brace">{</em>
<a id="L41" name="L41"></a>  41 
<div class="comment">
      Convert a string to a compiled form
      @param  content The lexical representation of gMonth
      @return a valid and normalized gMonth object</div>
<a id="L48" name="L48"></a>  48     <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/14973.html" title="Multiple referred from 10 places.">getActualValue</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/13364.html" title="Multiple defined in 2 places.">content</a>, <a href="../S/5230.html#L34" title="Defined at 34 in src/com/sun/org/apache/xerces/internal/impl/dv/ValidationContext.java.">ValidationContext</a> <a href="../S/1916.html#L117" title="Defined at 117 in src/java/nio/file/WatchEvent.java.">context</a>) <strong class="reserved">throws</strong> <a href="../S/5225.html#L72" title="Defined at 72 in src/com/sun/org/apache/xerces/internal/impl/dv/InvalidDatatypeValueException.java.">InvalidDatatypeValueException</a><em class="brace">{</em>
<a id="L49" name="L49"></a>  49         <strong class="reserved">try</strong><em class="brace">{</em>
<a id="L50" name="L50"></a>  50             <strong class="reserved">return</strong> <a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(<a href="../D/13364.html" title="Multiple defined in 2 places.">content</a>);
<a id="L51" name="L51"></a>  51         <em class="brace">}</em> <strong class="reserved">catch</strong>(<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>)<em class="brace">{</em>
<a id="L52" name="L52"></a>  52             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5225.html#L72" title="Defined at 72 in src/com/sun/org/apache/xerces/internal/impl/dv/InvalidDatatypeValueException.java.">InvalidDatatypeValueException</a>("cvc-datatype-valid.1.2.1", <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em><a href="../D/13364.html" title="Multiple defined in 2 places.">content</a>, "gMonth"<em class="brace">}</em>);
<a id="L53" name="L53"></a>  53         <em class="brace">}</em>
<a id="L54" name="L54"></a>  54     <em class="brace">}</em>
<a id="L55" name="L55"></a>  55 
<div class="comment">
      Parses, validates and computes normalized version of gMonth object
      @param str    The lexical representation of gMonth object --MM
                    with possible time zone Z or (-),(+)hh:mm
      @return normalized date representation
      @exception SchemaDateTimeException Invalid lexical representation</div>
<a id="L64" name="L64"></a>  64     <strong class="reserved">protected</strong> <a href="../S/5190.html#L932" title="Defined at 932 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">DateTimeData</a> <a href="../R/24493.html" title="Multiple referred from 256 places.">parse</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>) <strong class="reserved">throws</strong> <a href="../S/5209.html#L27" title="Defined at 27 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/SchemaDateTimeException.java.">SchemaDateTimeException</a><em class="brace">{</em>
<a id="L65" name="L65"></a>  65         <a href="../S/5190.html#L932" title="Defined at 932 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">DateTimeData</a> <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a> = <strong class="reserved">new</strong> <a href="../S/5190.html#L932" title="Defined at 932 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">DateTimeData</a>(<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>, <strong class="reserved">this</strong>);
<a id="L66" name="L66"></a>  66         <strong class="reserved">int</strong> len = <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L67" name="L67"></a>  67 
<a id="L68" name="L68"></a>  68         <em class="comment">//set constants</em>
<a id="L69" name="L69"></a>  69         <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.<a href="../D/37306.html" title="Multiple defined in 2 places.">year</a>=<a href="../S/1483.html#L545" title="Defined at 545 in src/java/time/temporal/ChronoField.java.">YEAR</a>;
<a id="L70" name="L70"></a>  70         <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.day=DAY;
<a id="L71" name="L71"></a>  71         <strong class="reserved">if</strong> (<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0)!='-' || <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(1)!='-') <em class="brace">{</em>
<a id="L72" name="L72"></a>  72             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5209.html#L27" title="Defined at 27 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/SchemaDateTimeException.java.">SchemaDateTimeException</a>("Invalid format for gMonth: "+<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>);
<a id="L73" name="L73"></a>  73         <em class="brace">}</em>
<a id="L74" name="L74"></a>  74         <strong class="reserved">int</strong> <a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a> = 4;
<a id="L75" name="L75"></a>  75         <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.month=<a href="../D/29148.html" title="Multiple defined in 9 places.">parseInt</a>(<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>,2,<a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>);
<a id="L76" name="L76"></a>  76 
<a id="L77" name="L77"></a>  77         <em class="comment">// REVISIT: allow both --MM and --MM-- now.</em>
<a id="L78" name="L78"></a>  78         <em class="comment">// need to remove the following 4 lines to disallow --MM--</em>
<a id="L79" name="L79"></a>  79         <em class="comment">// when the errata is offically in the rec.</em>
<a id="L80" name="L80"></a>  80         <strong class="reserved">if</strong> (<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt;= <a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>+2 &amp;&amp;
<a id="L81" name="L81"></a>  81             <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(<a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>) == '-' &amp;&amp; <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(<a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>+1) == '-') <em class="brace">{</em>
<a id="L82" name="L82"></a>  82             <a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a> += 2;
<a id="L83" name="L83"></a>  83         <em class="brace">}</em>
<a id="L84" name="L84"></a>  84         <strong class="reserved">if</strong> (<a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a> &lt; len) <em class="brace">{</em>
<a id="L85" name="L85"></a>  85             <strong class="reserved">if</strong> (!<a href="../S/5190.html#L520" title="Defined at 520 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">isNextCharUTCSign</a>(<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>, <a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>, len)) <em class="brace">{</em>
<a id="L86" name="L86"></a>  86                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/5209.html#L27" title="Defined at 27 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/SchemaDateTimeException.java.">SchemaDateTimeException</a> ("Error in month parsing: "+<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>);
<a id="L87" name="L87"></a>  87             <em class="brace">}</em>
<a id="L88" name="L88"></a>  88             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L89" name="L89"></a>  89                 <a href="../D/23152.html" title="Multiple defined in 10 places.">getTimeZone</a>(<a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>, <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>, <a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>, len);
<a id="L90" name="L90"></a>  90             <em class="brace">}</em>
<a id="L91" name="L91"></a>  91         <em class="brace">}</em>
<a id="L92" name="L92"></a>  92         <em class="comment">//validate and normalize</em>
<a id="L93" name="L93"></a>  93         <a href="../S/5190.html#L430" title="Defined at 430 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">validateDateTime</a>(<a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>);
<a id="L94" name="L94"></a>  94 
<a id="L95" name="L95"></a>  95         <em class="comment">//save unnormalized values</em>
<a id="L96" name="L96"></a>  96         <a href="../S/5190.html#L669" title="Defined at 669 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">saveUnnormalized</a>(<a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>);
<a id="L97" name="L97"></a>  97 
<a id="L98" name="L98"></a>  98         <strong class="reserved">if</strong> ( <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.utc!=0 &amp;&amp; <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.utc!='Z' ) <em class="brace">{</em>
<a id="L99" name="L99"></a>  99             <a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(<a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>);
<a id="L100" name="L100"></a> 100         <em class="brace">}</em>
<a id="L101" name="L101"></a> 101         <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a> = 1;
<a id="L102" name="L102"></a> 102         <strong class="reserved">return</strong> <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>;
<a id="L103" name="L103"></a> 103     <em class="brace">}</em>
<a id="L104" name="L104"></a> 104 
<div class="comment">
      Overwrite compare algorithm to optimize month comparison
      REVISIT: this one is lack of the third parameter: boolean strict, so it
               doesn't override the method in the base. But maybe this method
               is not correctly implemented, and I did encounter errors when
               trying to add the extra parameter. I'm leaving it as is. -SG
      @param date1
      @param date2
      @return less, greater, equal, indeterminate</div>
<div class="comment">
protected  short compareDates(DateTimeData date1, DateTimeData date2) {
        if ( date1.utc==date2.utc ) {
            return (short)((date1.month&gt;=date2.month)?(date1.month&gt;date2.month)?1:0:-1);
        }
        if ( date1.utc=='Z' || date2.utc=='Z' ) {
            if ( date1.month==date2.month ) {
                //--05--Z and --05--
                return INDETERMINATE;
            }
            if ( (date1.month+1 == date2.month || date1.month-1 == date2.month) ) {
                //--05--Z and (--04-- or --05--)
                //REVISIT: should this case be less than or equal?
                //         maxExclusive should fail but what about maxInclusive
                //
                return INDETERMINATE;
            }
        }
        if ( date1.month</div>
<a id="L146" name="L146"></a> 146 
<div class="comment">
      Converts month object representation to String
      @param date   month object
      @return lexical representation of month: --MM with an optional time zone sign</div>
<a id="L153" name="L153"></a> 153     <strong class="reserved">protected</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/12902.html" title="Multiple referred from 6 places.">dateToString</a>(<a href="../S/5190.html#L932" title="Defined at 932 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">DateTimeData</a> <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>) <em class="brace">{</em>
<a id="L154" name="L154"></a> 154         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>(5);
<a id="L155" name="L155"></a> 155         <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('-');
<a id="L156" name="L156"></a> 156         <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('-');
<a id="L157" name="L157"></a> 157         <a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>, <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.month, 2);
<a id="L158" name="L158"></a> 158         <a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>, (<strong class="reserved">char</strong>)<a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.utc, 0);
<a id="L159" name="L159"></a> 159         <strong class="reserved">return</strong> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L160" name="L160"></a> 160     <em class="brace">}</em>
<a id="L161" name="L161"></a> 161 
<a id="L162" name="L162"></a> 162     <strong class="reserved">protected</strong> <a href="../S/3901.html#L183" title="Defined at 183 in src/javax/xml/datatype/XMLGregorianCalendar.java.">XMLGregorianCalendar</a> <a href="../S/5190.html#L1143" title="Referred from 1143 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">getXMLGregorianCalendar</a>(<a href="../S/5190.html#L932" title="Defined at 932 in src/com/sun/org/apache/xerces/internal/impl/dv/xs/AbstractDateTimeDV.java.">DateTimeData</a> <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>) <em class="brace">{</em>
<a id="L163" name="L163"></a> 163         <strong class="reserved">return</strong> datatypeFactory.<a href="../D/28119.html" title="Multiple defined in 9 places.">newXMLGregorianCalendar</a>(<a href="../S/3906.html#L38" title="Defined at 38 in src/javax/xml/datatype/DatatypeConstants.java.">DatatypeConstants</a>.FIELD_UNDEFINED, <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.unNormMonth,
<a id="L164" name="L164"></a> 164                 <a href="../S/3906.html#L38" title="Defined at 38 in src/javax/xml/datatype/DatatypeConstants.java.">DatatypeConstants</a>.FIELD_UNDEFINED, <a href="../S/3906.html#L38" title="Defined at 38 in src/javax/xml/datatype/DatatypeConstants.java.">DatatypeConstants</a>.FIELD_UNDEFINED, <a href="../S/3906.html#L38" title="Defined at 38 in src/javax/xml/datatype/DatatypeConstants.java.">DatatypeConstants</a>.FIELD_UNDEFINED,
<a id="L165" name="L165"></a> 165                 <a href="../S/3906.html#L38" title="Defined at 38 in src/javax/xml/datatype/DatatypeConstants.java.">DatatypeConstants</a>.FIELD_UNDEFINED, <a href="../S/3906.html#L38" title="Defined at 38 in src/javax/xml/datatype/DatatypeConstants.java.">DatatypeConstants</a>.FIELD_UNDEFINED,
<a id="L166" name="L166"></a> 166                 <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.<a href="../D/24198.html" title="Multiple defined in 2 places.">hasTimeZone</a>() ? <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.timezoneHr * 60 + <a href="../D/14462.html" title="Multiple defined in 21 places.">date</a>.timezoneMin : <a href="../S/3906.html#L38" title="Defined at 38 in src/javax/xml/datatype/DatatypeConstants.java.">DatatypeConstants</a>.FIELD_UNDEFINED);
<a id="L167" name="L167"></a> 167     <em class="brace">}</em>
<a id="L168" name="L168"></a> 168 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L48">[^]</a><a href="#L162">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>