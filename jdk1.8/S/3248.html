<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/javax/swing/text/GapContent.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L93">[^]</a><a href="#L932">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L93" title="Defined at 93.">allocateArray</a></li>
<li><a href="#L100" title="Defined at 100.">getArrayLength</a></li>
<li><a href="#L113" title="Defined at 113.">length</a></li>
<li><a href="#L127" title="Defined at 127.">insertString</a></li>
<li><a href="#L145" title="Defined at 145.">remove</a></li>
<li><a href="#L165" title="Defined at 165.">getString</a></li>
<li><a href="#L183" title="Defined at 183.">getChars</a></li>
<li><a href="#L229" title="Defined at 229.">createPosition</a></li>
<li><a href="#L282" title="Defined at 282.">getOffset</a></li>
<li><a href="#L289" title="Defined at 289.">getPosition</a></li>
<li><a href="#L300" title="Defined at 300.">setMark</a></li>
<li><a href="#L304" title="Defined at 304.">getOffset</a></li>
<li><a href="#L308" title="Defined at 308.">toString</a></li>
<li><a href="#L342" title="Defined at 342.">shiftEnd</a></li>
<li><a href="#L361" title="Defined at 361.">getNewArraySize</a></li>
<li><a href="#L375" title="Defined at 375.">shiftGap</a></li>
<li><a href="#L416" title="Defined at 416.">resetMarksAtZero</a></li>
<li><a href="#L440" title="Defined at 440.">shiftGapStartDown</a></li>
<li><a href="#L469" title="Defined at 469.">shiftGapEndUp</a></li>
<li><a href="#L493" title="Defined at 493.">compare</a></li>
<li><a href="#L507" title="Defined at 507.">findMarkAdjustIndex</a></li>
<li><a href="#L529" title="Defined at 529.">findSortIndex</a></li>
<li><a href="#L567" title="Defined at 567.">removeUnusedMarks</a></li>
<li><a href="#L595" title="Defined at 595.">allocateArray</a></li>
<li><a href="#L602" title="Defined at 602.">getArrayLength</a></li>
<li><a href="#L610" title="Defined at 610.">size</a></li>
<li><a href="#L618" title="Defined at 618.">insertElementAt</a></li>
<li><a href="#L626" title="Defined at 626.">addElement</a></li>
<li><a href="#L633" title="Defined at 633.">elementAt</a></li>
<li><a href="#L653" title="Defined at 653.">replaceRange</a></li>
<li><a href="#L689" title="Defined at 689.">readObject</a></li>
<li><a href="#L712" title="Defined at 712.">getPositionsInRange</a></li>
<li><a href="#L758" title="Defined at 758.">updateUndoPositions</a></li>
<li><a href="#L839" title="Defined at 839.">resetLocation</a></li>
<li><a href="#L865" title="Defined at 865.">undo</a></li>
<li><a href="#L877" title="Defined at 877.">redo</a></li>
<li><a href="#L917" title="Defined at 917.">undo</a></li>
<li><a href="#L932" title="Defined at 932.">redo</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1998, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 <strong class="reserved">package</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.swing.<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>;
<a id="L26" name="L26"></a>  26 
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.util.Vector;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.IOException;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.io.ObjectInputStream;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.io.Serializable;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> javax.swing.undo.AbstractUndoableEdit;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> javax.swing.undo.CannotRedoException;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> javax.swing.undo.CannotUndoException;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> javax.swing.undo.UndoableEdit;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> javax.swing.SwingUtilities;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> java.lang.ref.WeakReference;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> java.lang.ref.ReferenceQueue;
<a id="L38" name="L38"></a>  38 
<div class="comment">
  An implementation of the AbstractDocument.Content interface
  implemented using a gapped buffer similar to that used by emacs.
  The underlying storage is a array of unicode characters with
  a gap somewhere.  The gap is moved to the location of changes
  to take advantage of common behavior where most changes are
  in the same location.  Changes that occur at a gap boundary are
  generally cheap and moving the gap is generally cheaper than
  moving the array contents directly to accommodate the change.
  <p>
  The positions tracking change are also generally cheap to
  maintain.  The Position implementations (marks) store the array
  index and can easily calculate the sequential position from
  the current gap location.  Changes only require update to the
  the marks between the old and new gap boundaries when the gap
  is moved, so generally updating the marks is pretty cheap.
  The marks are stored sorted so they can be located quickly
  with a binary search.  This increases the cost of adding a
  mark, and decreases the cost of keeping the mark updated.
  @author  Timothy Prinzing</p></div>
<a id="L61" name="L61"></a>  61 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/3239.html" title="Multiple referred from 5 places.">GapContent</a> <strong class="reserved">extends</strong> <a href="../S/3335.html#L44" title="Defined at 44 in src/javax/swing/text/GapVector.java.">GapVector</a> <strong class="reserved">implements</strong> <a href="../S/3268.html#L99" title="Defined at 99 in src/javax/swing/text/AbstractDocument.java.">AbstractDocument</a>.<a href="../S/3268.html#L1586" title="Defined at 1586 in src/javax/swing/text/AbstractDocument.java.">Content</a>, <a href="../S/1407.html#L169" title="Defined at 169 in src/java/io/Serializable.java.">Serializable</a> <em class="brace">{</em>
<a id="L62" name="L62"></a>  62 
<div class="comment">
      Creates a new GapContent object.  Initial size defaults to 10.</div>
<a id="L66" name="L66"></a>  66     <strong class="reserved">public</strong> GapContent() <em class="brace">{</em>
<a id="L67" name="L67"></a>  67         <strong class="reserved">this</strong>(10);
<a id="L68" name="L68"></a>  68     <em class="brace">}</em>
<a id="L69" name="L69"></a>  69 
<div class="comment">
      Creates a new GapContent object, with the initial
      size specified.  The initial size will not be allowed
      to go below 2, to give room for the implied break and
      the gap.
      @param initialLength the initial size</div>
<a id="L78" name="L78"></a>  78     <strong class="reserved">public</strong> GapContent(<strong class="reserved">int</strong> initialLength) <em class="brace">{</em>
<a id="L79" name="L79"></a>  79         <strong class="reserved">super</strong>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(initialLength,2));
<a id="L80" name="L80"></a>  80         <strong class="reserved">char</strong>[] implied = <strong class="reserved">new</strong> <strong class="reserved">char</strong>[1];
<a id="L81" name="L81"></a>  81         implied[0] = '\n';
<a id="L82" name="L82"></a>  82         <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(0, 0, implied, implied.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L83" name="L83"></a>  83 
<a id="L84" name="L84"></a>  84         marks = <strong class="reserved">new</strong> <a href="../S/3248.html#L581" title="Defined at 581 in src/javax/swing/text/GapContent.java.">MarkVector</a>();
<a id="L85" name="L85"></a>  85         <a href="../D/31650.html" title="Multiple defined in 35 places.">search</a> = <strong class="reserved">new</strong> <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>(0);
<a id="L86" name="L86"></a>  86         queue = <strong class="reserved">new</strong> <a href="../S/1565.html#L36" title="Defined at 36 in src/java/lang/ref/ReferenceQueue.java.">ReferenceQueue</a>&lt;<a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a>&gt;();
<a id="L87" name="L87"></a>  87     <em class="brace">}</em>
<a id="L88" name="L88"></a>  88 
<div class="comment">
      Allocate an array to store items of the type
      appropriate (which is determined by the subclass).</div>
<a id="L93" name="L93"></a>  93     <strong class="reserved">protected</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/10139.html" title="Multiple referred from 2 places.">allocateArray</a>(<strong class="reserved">int</strong> len) <em class="brace">{</em>
<a id="L94" name="L94"></a>  94         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <strong class="reserved">char</strong>[len];
<a id="L95" name="L95"></a>  95     <em class="brace">}</em>
<a id="L96" name="L96"></a>  96 
<div class="comment">
      Get the length of the allocated array.</div>
<a id="L100" name="L100"></a> 100     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/15119.html" title="Multiple referred from 5 places.">getArrayLength</a>() <em class="brace">{</em>
<a id="L101" name="L101"></a> 101         <strong class="reserved">char</strong>[] carray = (<strong class="reserved">char</strong>[]) <a href="../D/17028.html" title="Multiple defined in 16 places.">getArray</a>();
<a id="L102" name="L102"></a> 102         <strong class="reserved">return</strong> carray.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L103" name="L103"></a> 103     <em class="brace">}</em>
<a id="L104" name="L104"></a> 104 
<a id="L105" name="L105"></a> 105     <em class="comment">// --- AbstractDocument.Content methods -------------------------</em>
<a id="L106" name="L106"></a> 106 
<div class="comment">
      Returns the length of the content.
      @return the length &gt;= 1
      @see AbstractDocument.Content#length</div>
<a id="L113" name="L113"></a> 113     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/22477.html" title="Multiple referred from 12963 places.">length</a>() <em class="brace">{</em>
<a id="L114" name="L114"></a> 114         <strong class="reserved">int</strong> len = <a href="../D/17030.html" title="Multiple defined in 3 places.">getArrayLength</a>() - (<a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>() - <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>());
<a id="L115" name="L115"></a> 115         <strong class="reserved">return</strong> len;
<a id="L116" name="L116"></a> 116     <em class="brace">}</em>
<a id="L117" name="L117"></a> 117 
<div class="comment">
      Inserts a string into the content.
      @param where the starting position &gt;= 0, &lt; length()
      @param str the non-null string to insert
      @return an UndoableEdit object for undoing
      @exception BadLocationException if the specified position is invalid
      @see AbstractDocument.Content#insertString</div>
<a id="L127" name="L127"></a> 127     <strong class="reserved">public</strong> <a href="../S/3139.html#L68" title="Defined at 68 in src/javax/swing/undo/UndoableEdit.java.">UndoableEdit</a> <a href="../R/20792.html" title="Multiple referred from 41 places.">insertString</a>(<strong class="reserved">int</strong> where, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L128" name="L128"></a> 128         <strong class="reserved">if</strong> (where &gt; <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() || where &lt; 0) <em class="brace">{</em>
<a id="L129" name="L129"></a> 129             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a>("Invalid insert", <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L130" name="L130"></a> 130         <em class="brace">}</em>
<a id="L131" name="L131"></a> 131         <strong class="reserved">char</strong>[] <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a> = <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/35368.html" title="Multiple defined in 3 places.">toCharArray</a>();
<a id="L132" name="L132"></a> 132         <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(where, 0, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L133" name="L133"></a> 133         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/4247.html" title="Multiple defined in 2 places.">InsertUndo</a>(where, <a href="../D/34924.html" title="Multiple defined in 10 places.">str</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L134" name="L134"></a> 134     <em class="brace">}</em>
<a id="L135" name="L135"></a> 135 
<div class="comment">
      Removes part of the content.
      @param where the starting position &gt;= 0, where + nitems &lt; length()
      @param nitems the number of characters to remove &gt;= 0
      @return an UndoableEdit object for undoing
      @exception BadLocationException if the specified position is invalid
      @see AbstractDocument.Content#remove</div>
<a id="L145" name="L145"></a> 145     <strong class="reserved">public</strong> <a href="../S/3139.html#L68" title="Defined at 68 in src/javax/swing/undo/UndoableEdit.java.">UndoableEdit</a> <a href="../R/25882.html" title="Multiple referred from 1115 places.">remove</a>(<strong class="reserved">int</strong> where, <strong class="reserved">int</strong> nitems) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L146" name="L146"></a> 146         <strong class="reserved">if</strong> (where + nitems &gt;= <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <em class="brace">{</em>
<a id="L147" name="L147"></a> 147             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a>("Invalid remove", <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() + 1);
<a id="L148" name="L148"></a> 148         <em class="brace">}</em>
<a id="L149" name="L149"></a> 149         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> removedString = <a href="../D/22769.html" title="Multiple defined in 35 places.">getString</a>(where, nitems);
<a id="L150" name="L150"></a> 150         <a href="../S/3139.html#L68" title="Defined at 68 in src/javax/swing/undo/UndoableEdit.java.">UndoableEdit</a> <a href="../D/15277.html" title="Multiple defined in 2 places.">edit</a> = <strong class="reserved">new</strong> <a href="../D/7250.html" title="Multiple defined in 2 places.">RemoveUndo</a>(where, removedString);
<a id="L151" name="L151"></a> 151         <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(where, nitems, <a href="../D/15347.html" title="Multiple defined in 24 places.">empty</a>, 0);
<a id="L152" name="L152"></a> 152         <strong class="reserved">return</strong> <a href="../D/15277.html" title="Multiple defined in 2 places.">edit</a>;
<a id="L153" name="L153"></a> 153 
<a id="L154" name="L154"></a> 154     <em class="brace">}</em>
<a id="L155" name="L155"></a> 155 
<div class="comment">
      Retrieves a portion of the content.
      @param where the starting position &gt;= 0
      @param len the length to retrieve &gt;= 0
      @return a string representing the content
      @exception BadLocationException if the specified position is invalid
      @see AbstractDocument.Content#getString</div>
<a id="L165" name="L165"></a> 165     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/19208.html" title="Multiple referred from 527 places.">getString</a>(<strong class="reserved">int</strong> where, <strong class="reserved">int</strong> len) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L166" name="L166"></a> 166         <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> s = <strong class="reserved">new</strong> <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a>();
<a id="L167" name="L167"></a> 167         <a href="../D/17616.html" title="Multiple defined in 22 places.">getChars</a>(where, len, s);
<a id="L168" name="L168"></a> 168         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>(s.<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, s.<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, s.<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>);
<a id="L169" name="L169"></a> 169     <em class="brace">}</em>
<a id="L170" name="L170"></a> 170 
<div class="comment">
      Retrieves a portion of the content.  If the desired content spans
      the gap, we copy the content.  If the desired content does not
      span the gap, the actual store is returned to avoid the copy since
      it is contiguous.
      @param where the starting position &gt;= 0, where + len &lt;= length()
      @param len the number of characters to retrieve &gt;= 0
      @param chars the Segment object to return the characters in
      @exception BadLocationException if the specified position is invalid
      @see AbstractDocument.Content#getChars</div>
<a id="L183" name="L183"></a> 183     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/15533.html" title="Multiple referred from 94 places.">getChars</a>(<strong class="reserved">int</strong> where, <strong class="reserved">int</strong> len, <a href="../D/7688.html" title="Multiple defined in 2 places.">Segment</a> <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L184" name="L184"></a> 184         <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> = where + len;
<a id="L185" name="L185"></a> 185         <strong class="reserved">if</strong> (where &lt; 0 || <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> &lt; 0) <em class="brace">{</em>
<a id="L186" name="L186"></a> 186             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a>("Invalid location", -1);
<a id="L187" name="L187"></a> 187         <em class="brace">}</em>
<a id="L188" name="L188"></a> 188         <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> &gt; <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() || where &gt; <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <em class="brace">{</em>
<a id="L189" name="L189"></a> 189             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a>("Invalid location", <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() + 1);
<a id="L190" name="L190"></a> 190         <em class="brace">}</em>
<a id="L191" name="L191"></a> 191         <strong class="reserved">int</strong> g0 = <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>();
<a id="L192" name="L192"></a> 192         <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L193" name="L193"></a> 193         <strong class="reserved">char</strong>[] <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a> = (<strong class="reserved">char</strong>[]) <a href="../D/17028.html" title="Multiple defined in 16 places.">getArray</a>();
<a id="L194" name="L194"></a> 194         <strong class="reserved">if</strong> ((where + len) &lt;= g0) <em class="brace">{</em>
<a id="L195" name="L195"></a> 195             <em class="comment">// below gap</em>
<a id="L196" name="L196"></a> 196             <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a> = <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>;
<a id="L197" name="L197"></a> 197             <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> = where;
<a id="L198" name="L198"></a> 198         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (where &gt;= g0) <em class="brace">{</em>
<a id="L199" name="L199"></a> 199             <em class="comment">// above gap</em>
<a id="L200" name="L200"></a> 200             <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a> = <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>;
<a id="L201" name="L201"></a> 201             <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> = g1 + where - g0;
<a id="L202" name="L202"></a> 202         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L203" name="L203"></a> 203             <em class="comment">// spans the gap</em>
<a id="L204" name="L204"></a> 204             <strong class="reserved">int</strong> <a href="../D/11800.html" title="Multiple defined in 3 places.">before</a> = g0 - where;
<a id="L205" name="L205"></a> 205             <strong class="reserved">if</strong> (<a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../S/3269.html#L108" title="Defined at 108 in src/javax/swing/text/Segment.java.">isPartialReturn</a>()) <em class="brace">{</em>
<a id="L206" name="L206"></a> 206                 <em class="comment">// partial return allowed, return amount before the gap</em>
<a id="L207" name="L207"></a> 207                 <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a> = <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>;
<a id="L208" name="L208"></a> 208                 <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> = where;
<a id="L209" name="L209"></a> 209                 <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = <a href="../D/11800.html" title="Multiple defined in 3 places.">before</a>;
<a id="L210" name="L210"></a> 210                 <strong class="reserved">return</strong>;
<a id="L211" name="L211"></a> 211             <em class="brace">}</em>
<a id="L212" name="L212"></a> 212             <em class="comment">// partial return not allowed, must copy</em>
<a id="L213" name="L213"></a> 213             <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a> = <strong class="reserved">new</strong> <strong class="reserved">char</strong>[len];
<a id="L214" name="L214"></a> 214             <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> = 0;
<a id="L215" name="L215"></a> 215             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, where, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, 0, <a href="../D/11800.html" title="Multiple defined in 3 places.">before</a>);
<a id="L216" name="L216"></a> 216             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, g1, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>, <a href="../D/11800.html" title="Multiple defined in 3 places.">before</a>, len - <a href="../D/11800.html" title="Multiple defined in 3 places.">before</a>);
<a id="L217" name="L217"></a> 217         <em class="brace">}</em>
<a id="L218" name="L218"></a> 218         <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = len;
<a id="L219" name="L219"></a> 219     <em class="brace">}</em>
<a id="L220" name="L220"></a> 220 
<div class="comment">
      Creates a position within the content that will
      track change as the content is mutated.
      @param offset the offset to track &gt;= 0
      @return the position
      @exception BadLocationException if the specified position is invalid</div>
<a id="L229" name="L229"></a> 229     <strong class="reserved">public</strong> <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a> <a href="../R/12631.html" title="Multiple referred from 26 places.">createPosition</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <strong class="reserved">throws</strong> <a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> <em class="brace">{</em>
<a id="L230" name="L230"></a> 230         <strong class="reserved">while</strong> ( queue.<a href="../D/29402.html" title="Multiple defined in 36 places.">poll</a>() != <strong class="reserved">null</strong> ) <em class="brace">{</em>
<a id="L231" name="L231"></a> 231             unusedMarks++;
<a id="L232" name="L232"></a> 232         <em class="brace">}</em>
<a id="L233" name="L233"></a> 233         <strong class="reserved">if</strong> (unusedMarks &gt; <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(5, (marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() / 10))) <em class="brace">{</em>
<a id="L234" name="L234"></a> 234             <a href="../S/3248.html#L567" title="Defined at 567 in src/javax/swing/text/GapContent.java.">removeUnusedMarks</a>();
<a id="L235" name="L235"></a> 235         <em class="brace">}</em>
<a id="L236" name="L236"></a> 236         <strong class="reserved">int</strong> g0 = <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>();
<a id="L237" name="L237"></a> 237         <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L238" name="L238"></a> 238         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &lt; g0) ? <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> : <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> + (g1 - g0);
<a id="L239" name="L239"></a> 239         <a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L240" name="L240"></a> 240         <strong class="reserved">int</strong> sortIndex = <a href="../S/3248.html#L529" title="Defined at 529 in src/javax/swing/text/GapContent.java.">findSortIndex</a>(<a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>);
<a id="L241" name="L241"></a> 241         <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> m;
<a id="L242" name="L242"></a> 242         <a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a> <a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>;
<a id="L243" name="L243"></a> 243         <strong class="reserved">if</strong> (sortIndex &lt; marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()
<a id="L244" name="L244"></a> 244             &amp;&amp; (m = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(sortIndex)).<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>
<a id="L245" name="L245"></a> 245             &amp;&amp; (<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a> = m.<a href="../D/21546.html" title="Multiple defined in 41 places.">getPosition</a>()) != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L246" name="L246"></a> 246             <em class="comment">//position references the correct StickyPostition</em>
<a id="L247" name="L247"></a> 247         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L248" name="L248"></a> 248             <a href="../D/29463.html" title="Multiple defined in 19 places.">position</a> = <strong class="reserved">new</strong> <a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a>();
<a id="L249" name="L249"></a> 249             m = <strong class="reserved">new</strong> <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>,<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>,queue);
<a id="L250" name="L250"></a> 250             <a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>.<a href="../D/33184.html" title="Multiple defined in 33 places.">setMark</a>(m);
<a id="L251" name="L251"></a> 251             marks.<a href="../D/24745.html" title="Multiple defined in 12 places.">insertElementAt</a>(m, sortIndex);
<a id="L252" name="L252"></a> 252         <em class="brace">}</em>
<a id="L253" name="L253"></a> 253 
<a id="L254" name="L254"></a> 254         <strong class="reserved">return</strong> <a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>;
<a id="L255" name="L255"></a> 255     <em class="brace">}</em>
<a id="L256" name="L256"></a> 256 
<div class="comment">
      Holds the data for a mark... separately from
      the real mark so that the real mark (Position
      that the caller of createPosition holds) can be
      collected if there are no more references to
      it.  The update table holds only a reference
      to this data.</div>
<a id="L265" name="L265"></a> 265     <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/4936.html" title="Multiple referred from 32 places.">MarkData</a> <strong class="reserved">extends</strong> <a href="../S/1569.html#L48" title="Defined at 48 in src/java/lang/ref/WeakReference.java.">WeakReference</a>&lt;<a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a>&gt; <em class="brace">{</em>
<a id="L266" name="L266"></a> 266 
<a id="L267" name="L267"></a> 267         MarkData(<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) <em class="brace">{</em>
<a id="L268" name="L268"></a> 268             <strong class="reserved">super</strong>(<strong class="reserved">null</strong>);
<a id="L269" name="L269"></a> 269             <strong class="reserved">this</strong>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L270" name="L270"></a> 270         <em class="brace">}</em>
<a id="L271" name="L271"></a> 271         MarkData(<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>, <a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a> <a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>, <a href="../S/1565.html#L36" title="Defined at 36 in src/java/lang/ref/ReferenceQueue.java.">ReferenceQueue</a>&lt;? <strong class="reserved">super</strong> <a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a>&gt; queue) <em class="brace">{</em>
<a id="L272" name="L272"></a> 272             <strong class="reserved">super</strong>(<a href="../D/29463.html" title="Multiple defined in 19 places.">position</a>, queue);
<a id="L273" name="L273"></a> 273             <strong class="reserved">this</strong>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L274" name="L274"></a> 274         <em class="brace">}</em>
<a id="L275" name="L275"></a> 275 
<div class="comment">
          Fetch the location in the contiguous sequence
          being modeled.  The index in the gap array
          is held by the mark, so it is adjusted according
          to it's relationship to the gap.</div>
<a id="L282" name="L282"></a> 282         <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/18115.html" title="Multiple referred from 163 places.">getOffset</a>() <em class="brace">{</em>
<a id="L283" name="L283"></a> 283             <strong class="reserved">int</strong> g0 = <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>();
<a id="L284" name="L284"></a> 284             <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L285" name="L285"></a> 285             <strong class="reserved">int</strong> offs = (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; g0) ? <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> : <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> - (g1 - g0);
<a id="L286" name="L286"></a> 286             <strong class="reserved">return</strong> <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(offs, 0);
<a id="L287" name="L287"></a> 287         <em class="brace">}</em>
<a id="L288" name="L288"></a> 288 
<a id="L289" name="L289"></a> 289         <a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a> <a href="../R/18378.html" title="Multiple referred from 92 places.">getPosition</a>() <em class="brace">{</em>
<a id="L290" name="L290"></a> 290             <strong class="reserved">return</strong> <a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>();
<a id="L291" name="L291"></a> 291         <em class="brace">}</em>
<a id="L292" name="L292"></a> 292         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L293" name="L293"></a> 293     <em class="brace">}</em>
<a id="L294" name="L294"></a> 294 
<a id="L295" name="L295"></a> 295     <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/7610.html" title="Multiple referred from 9 places.">StickyPosition</a> <strong class="reserved">implements</strong> <a href="../S/3329.html#L49" title="Defined at 49 in src/javax/swing/text/Position.java.">Position</a> <em class="brace">{</em>
<a id="L296" name="L296"></a> 296 
<a id="L297" name="L297"></a> 297         StickyPosition() <em class="brace">{</em>
<a id="L298" name="L298"></a> 298         <em class="brace">}</em>
<a id="L299" name="L299"></a> 299 
<a id="L300" name="L300"></a> 300         <strong class="reserved">void</strong> <a href="../R/27715.html" title="Multiple referred from 22 places.">setMark</a>(<a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>) <em class="brace">{</em>
<a id="L301" name="L301"></a> 301             <strong class="reserved">this</strong>.<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>;
<a id="L302" name="L302"></a> 302         <em class="brace">}</em>
<a id="L303" name="L303"></a> 303 
<a id="L304" name="L304"></a> 304         <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/18115.html" title="Multiple referred from 163 places.">getOffset</a>() <em class="brace">{</em>
<a id="L305" name="L305"></a> 305             <strong class="reserved">return</strong> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>();
<a id="L306" name="L306"></a> 306         <em class="brace">}</em>
<a id="L307" name="L307"></a> 307 
<a id="L308" name="L308"></a> 308         <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L309" name="L309"></a> 309             <strong class="reserved">return</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>());
<a id="L310" name="L310"></a> 310         <em class="brace">}</em>
<a id="L311" name="L311"></a> 311 
<a id="L312" name="L312"></a> 312         <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>;
<a id="L313" name="L313"></a> 313     <em class="brace">}</em>
<a id="L314" name="L314"></a> 314 
<a id="L315" name="L315"></a> 315     <em class="comment">// --- variables --------------------------------------</em>
<a id="L316" name="L316"></a> 316 
<a id="L317" name="L317"></a> 317     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">char</strong>[] <a href="../D/15347.html" title="Multiple defined in 24 places.">empty</a> = <strong class="reserved">new</strong> <strong class="reserved">char</strong>[0];
<a id="L318" name="L318"></a> 318     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/3248.html#L581" title="Defined at 581 in src/javax/swing/text/GapContent.java.">MarkVector</a> marks;
<a id="L319" name="L319"></a> 319 
<div class="comment">
      Record used for searching for the place to
      start updating mark indexs when the gap
      boundaries are moved.</div>
<a id="L325" name="L325"></a> 325     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>;
<a id="L326" name="L326"></a> 326 
<div class="comment">
      The number of unused mark entries</div>
<a id="L330" name="L330"></a> 330     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <strong class="reserved">int</strong> unusedMarks = 0;
<a id="L331" name="L331"></a> 331 
<a id="L332" name="L332"></a> 332     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/1565.html#L36" title="Defined at 36 in src/java/lang/ref/ReferenceQueue.java.">ReferenceQueue</a>&lt;<a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a>&gt; queue;
<a id="L333" name="L333"></a> 333 
<a id="L334" name="L334"></a> 334     <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> GROWTH_SIZE = 1024 * 512;
<a id="L335" name="L335"></a> 335 
<a id="L336" name="L336"></a> 336     <em class="comment">// --- gap management -------------------------------</em>
<a id="L337" name="L337"></a> 337 
<div class="comment">
      Make the gap bigger, moving any necessary data and updating
      the appropriate marks</div>
<a id="L342" name="L342"></a> 342     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/28503.html" title="Multiple referred from 2 places.">shiftEnd</a>(<strong class="reserved">int</strong> newSize) <em class="brace">{</em>
<a id="L343" name="L343"></a> 343         <strong class="reserved">int</strong> oldGapEnd = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L344" name="L344"></a> 344 
<a id="L345" name="L345"></a> 345         <strong class="reserved">super</strong>.<a href="../D/34445.html" title="Multiple defined in 2 places.">shiftEnd</a>(newSize);
<a id="L346" name="L346"></a> 346 
<a id="L347" name="L347"></a> 347         <em class="comment">// Adjust marks.</em>
<a id="L348" name="L348"></a> 348         <strong class="reserved">int</strong> dg = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>() - oldGapEnd;
<a id="L349" name="L349"></a> 349         <strong class="reserved">int</strong> <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a> = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(oldGapEnd);
<a id="L350" name="L350"></a> 350         <strong class="reserved">int</strong> n = marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L351" name="L351"></a> 351         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a>; i &lt; n; i++) <em class="brace">{</em>
<a id="L352" name="L352"></a> 352             <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L353" name="L353"></a> 353             <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> += dg;
<a id="L354" name="L354"></a> 354         <em class="brace">}</em>
<a id="L355" name="L355"></a> 355     <em class="brace">}</em>
<a id="L356" name="L356"></a> 356 
<div class="comment">
      Overridden to make growth policy less agressive for large
      text amount.</div>
<a id="L361" name="L361"></a> 361     <strong class="reserved">int</strong> <a href="../R/17893.html" title="Multiple referred from 2 places.">getNewArraySize</a>(<strong class="reserved">int</strong> reqSize) <em class="brace">{</em>
<a id="L362" name="L362"></a> 362         <strong class="reserved">if</strong> (reqSize &lt; GROWTH_SIZE) <em class="brace">{</em>
<a id="L363" name="L363"></a> 363             <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/20871.html" title="Multiple defined in 2 places.">getNewArraySize</a>(reqSize);
<a id="L364" name="L364"></a> 364         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L365" name="L365"></a> 365             <strong class="reserved">return</strong> reqSize + GROWTH_SIZE;
<a id="L366" name="L366"></a> 366         <em class="brace">}</em>
<a id="L367" name="L367"></a> 367     <em class="brace">}</em>
<a id="L368" name="L368"></a> 368 
<div class="comment">
      Move the start of the gap to a new location,
      without changing the size of the gap.  This
      moves the data in the array and updates the
      marks accordingly.</div>
<a id="L375" name="L375"></a> 375     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/28504.html" title="Multiple referred from 4 places.">shiftGap</a>(<strong class="reserved">int</strong> newGapStart) <em class="brace">{</em>
<a id="L376" name="L376"></a> 376         <strong class="reserved">int</strong> oldGapStart = <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>();
<a id="L377" name="L377"></a> 377         <strong class="reserved">int</strong> dg = newGapStart - oldGapStart;
<a id="L378" name="L378"></a> 378         <strong class="reserved">int</strong> oldGapEnd = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L379" name="L379"></a> 379         <strong class="reserved">int</strong> newGapEnd = oldGapEnd + dg;
<a id="L380" name="L380"></a> 380         <strong class="reserved">int</strong> gapSize = oldGapEnd - oldGapStart;
<a id="L381" name="L381"></a> 381 
<a id="L382" name="L382"></a> 382         <em class="comment">// shift gap in the character array</em>
<a id="L383" name="L383"></a> 383         <strong class="reserved">super</strong>.<a href="../D/34446.html" title="Multiple defined in 2 places.">shiftGap</a>(newGapStart);
<a id="L384" name="L384"></a> 384 
<a id="L385" name="L385"></a> 385         <em class="comment">// update the marks</em>
<a id="L386" name="L386"></a> 386         <strong class="reserved">if</strong> (dg &gt; 0) <em class="brace">{</em>
<a id="L387" name="L387"></a> 387             <em class="comment">// Move gap up, move data and marks down.</em>
<a id="L388" name="L388"></a> 388             <strong class="reserved">int</strong> <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a> = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(oldGapStart);
<a id="L389" name="L389"></a> 389             <strong class="reserved">int</strong> n = marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L390" name="L390"></a> 390             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a>; i &lt; n; i++) <em class="brace">{</em>
<a id="L391" name="L391"></a> 391                 <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L392" name="L392"></a> 392                 <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt;= newGapEnd) <em class="brace">{</em>
<a id="L393" name="L393"></a> 393                     <strong class="reserved">break</strong>;
<a id="L394" name="L394"></a> 394                 <em class="brace">}</em>
<a id="L395" name="L395"></a> 395                 <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> -= gapSize;
<a id="L396" name="L396"></a> 396             <em class="brace">}</em>
<a id="L397" name="L397"></a> 397         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (dg &lt; 0) <em class="brace">{</em>
<a id="L398" name="L398"></a> 398             <em class="comment">// Move gap down, move data and marks up.</em>
<a id="L399" name="L399"></a> 399             <strong class="reserved">int</strong> <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a> = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(newGapStart);
<a id="L400" name="L400"></a> 400             <strong class="reserved">int</strong> n = marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L401" name="L401"></a> 401             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a>; i &lt; n; i++) <em class="brace">{</em>
<a id="L402" name="L402"></a> 402                 <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L403" name="L403"></a> 403                 <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt;= oldGapEnd) <em class="brace">{</em>
<a id="L404" name="L404"></a> 404                     <strong class="reserved">break</strong>;
<a id="L405" name="L405"></a> 405                 <em class="brace">}</em>
<a id="L406" name="L406"></a> 406                 <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> += gapSize;
<a id="L407" name="L407"></a> 407             <em class="brace">}</em>
<a id="L408" name="L408"></a> 408         <em class="brace">}</em>
<a id="L409" name="L409"></a> 409         <a href="../S/3248.html#L416" title="Defined at 416 in src/javax/swing/text/GapContent.java.">resetMarksAtZero</a>();
<a id="L410" name="L410"></a> 410     <em class="brace">}</em>
<a id="L411" name="L411"></a> 411 
<div class="comment">
      Resets all the marks that have an offset of 0 to have an index of
      zero as well.</div>
<a id="L416" name="L416"></a> 416     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/26270.html" title="Multiple referred from 3 places.">resetMarksAtZero</a>() <em class="brace">{</em>
<a id="L417" name="L417"></a> 417         <strong class="reserved">if</strong> (marks != <strong class="reserved">null</strong> &amp;&amp; <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>() == 0) <em class="brace">{</em>
<a id="L418" name="L418"></a> 418             <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L419" name="L419"></a> 419             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> counter = 0, maxCounter = marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L420" name="L420"></a> 420                  counter &lt; maxCounter; counter++) <em class="brace">{</em>
<a id="L421" name="L421"></a> 421                 <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(counter);
<a id="L422" name="L422"></a> 422                 <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt;= g1) <em class="brace">{</em>
<a id="L423" name="L423"></a> 423                     <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = 0;
<a id="L424" name="L424"></a> 424                 <em class="brace">}</em>
<a id="L425" name="L425"></a> 425                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L426" name="L426"></a> 426                     <strong class="reserved">break</strong>;
<a id="L427" name="L427"></a> 427                 <em class="brace">}</em>
<a id="L428" name="L428"></a> 428             <em class="brace">}</em>
<a id="L429" name="L429"></a> 429         <em class="brace">}</em>
<a id="L430" name="L430"></a> 430     <em class="brace">}</em>
<a id="L431" name="L431"></a> 431 
<div class="comment">
      Adjust the gap end downward.  This doesn't move
      any data, but it does update any marks affected
      by the boundary change.  All marks from the old
      gap start down to the new gap start are squeezed
      to the end of the gap (their location has been
      removed).</div>
<a id="L440" name="L440"></a> 440     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/28506.html" title="Multiple referred from 3 places.">shiftGapStartDown</a>(<strong class="reserved">int</strong> newGapStart) <em class="brace">{</em>
<a id="L441" name="L441"></a> 441         <em class="comment">// Push aside all marks from oldGapStart down to newGapStart.</em>
<a id="L442" name="L442"></a> 442         <strong class="reserved">int</strong> <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a> = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(newGapStart);
<a id="L443" name="L443"></a> 443         <strong class="reserved">int</strong> n = marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L444" name="L444"></a> 444         <strong class="reserved">int</strong> g0 = <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>();
<a id="L445" name="L445"></a> 445         <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L446" name="L446"></a> 446         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a>; i &lt; n; i++) <em class="brace">{</em>
<a id="L447" name="L447"></a> 447             <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L448" name="L448"></a> 448             <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt; g0) <em class="brace">{</em>
<a id="L449" name="L449"></a> 449                 <em class="comment">// no more marks to adjust</em>
<a id="L450" name="L450"></a> 450                 <strong class="reserved">break</strong>;
<a id="L451" name="L451"></a> 451             <em class="brace">}</em>
<a id="L452" name="L452"></a> 452             <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = g1;
<a id="L453" name="L453"></a> 453         <em class="brace">}</em>
<a id="L454" name="L454"></a> 454 
<a id="L455" name="L455"></a> 455         <em class="comment">// shift the gap in the character array</em>
<a id="L456" name="L456"></a> 456         <strong class="reserved">super</strong>.<a href="../D/34448.html" title="Multiple defined in 2 places.">shiftGapStartDown</a>(newGapStart);
<a id="L457" name="L457"></a> 457 
<a id="L458" name="L458"></a> 458         <a href="../S/3248.html#L416" title="Defined at 416 in src/javax/swing/text/GapContent.java.">resetMarksAtZero</a>();
<a id="L459" name="L459"></a> 459     <em class="brace">}</em>
<a id="L460" name="L460"></a> 460 
<div class="comment">
      Adjust the gap end upward.  This doesn't move
      any data, but it does update any marks affected
      by the boundary change. All marks from the old
      gap end up to the new gap end are squeezed
      to the end of the gap (their location has been
      removed).</div>
<a id="L469" name="L469"></a> 469     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/28505.html" title="Multiple referred from 3 places.">shiftGapEndUp</a>(<strong class="reserved">int</strong> newGapEnd) <em class="brace">{</em>
<a id="L470" name="L470"></a> 470         <strong class="reserved">int</strong> <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a> = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(<a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>());
<a id="L471" name="L471"></a> 471         <strong class="reserved">int</strong> n = marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L472" name="L472"></a> 472         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../S/2892.html#L2827" title="Defined at 2827 in src/javax/swing/plaf/basic/BasicListUI.java.">adjustIndex</a>; i &lt; n; i++) <em class="brace">{</em>
<a id="L473" name="L473"></a> 473             <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L474" name="L474"></a> 474             <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt;= newGapEnd) <em class="brace">{</em>
<a id="L475" name="L475"></a> 475                 <strong class="reserved">break</strong>;
<a id="L476" name="L476"></a> 476             <em class="brace">}</em>
<a id="L477" name="L477"></a> 477             <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = newGapEnd;
<a id="L478" name="L478"></a> 478         <em class="brace">}</em>
<a id="L479" name="L479"></a> 479 
<a id="L480" name="L480"></a> 480         <em class="comment">// shift the gap in the character array</em>
<a id="L481" name="L481"></a> 481         <strong class="reserved">super</strong>.<a href="../D/34447.html" title="Multiple defined in 2 places.">shiftGapEndUp</a>(newGapEnd);
<a id="L482" name="L482"></a> 482 
<a id="L483" name="L483"></a> 483         <a href="../S/3248.html#L416" title="Defined at 416 in src/javax/swing/text/GapContent.java.">resetMarksAtZero</a>();
<a id="L484" name="L484"></a> 484     <em class="brace">}</em>
<a id="L485" name="L485"></a> 485 
<div class="comment">
      Compares two marks.
      @param o1 the first object
      @param o2 the second object
      @return &lt; 0 if o1 &lt; o2, 0 if the same, &gt; 0 if o1 &gt; o2</div>
<a id="L493" name="L493"></a> 493     <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/11691.html" title="Multiple referred from 208 places.">compare</a>(<a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> o1, <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> o2) <em class="brace">{</em>
<a id="L494" name="L494"></a> 494         <strong class="reserved">if</strong> (o1.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; o2.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) <em class="brace">{</em>
<a id="L495" name="L495"></a> 495             <strong class="reserved">return</strong> -1;
<a id="L496" name="L496"></a> 496         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (o1.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt; o2.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) <em class="brace">{</em>
<a id="L497" name="L497"></a> 497             <strong class="reserved">return</strong> 1;
<a id="L498" name="L498"></a> 498         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L499" name="L499"></a> 499             <strong class="reserved">return</strong> 0;
<a id="L500" name="L500"></a> 500         <em class="brace">}</em>
<a id="L501" name="L501"></a> 501     <em class="brace">}</em>
<a id="L502" name="L502"></a> 502 
<div class="comment">
      Finds the index to start mark adjustments given
      some search index.</div>
<a id="L507" name="L507"></a> 507     <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/14418.html" title="Multiple referred from 12 places.">findMarkAdjustIndex</a>(<strong class="reserved">int</strong> searchIndex) <em class="brace">{</em>
<a id="L508" name="L508"></a> 508         <a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(searchIndex, 1);
<a id="L509" name="L509"></a> 509         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../S/3248.html#L529" title="Defined at 529 in src/javax/swing/text/GapContent.java.">findSortIndex</a>(<a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>);
<a id="L510" name="L510"></a> 510 
<a id="L511" name="L511"></a> 511         <em class="comment">// return the first in the series</em>
<a id="L512" name="L512"></a> 512         <em class="comment">// (ie. there may be duplicates).</em>
<a id="L513" name="L513"></a> 513         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> - 1; i &gt;= 0; i--) <em class="brace">{</em>
<a id="L514" name="L514"></a> 514             <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> d = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L515" name="L515"></a> 515             <strong class="reserved">if</strong> (d.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> != <a href="../D/31650.html" title="Multiple defined in 35 places.">search</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) <em class="brace">{</em>
<a id="L516" name="L516"></a> 516                 <strong class="reserved">break</strong>;
<a id="L517" name="L517"></a> 517             <em class="brace">}</em>
<a id="L518" name="L518"></a> 518             <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> -= 1;
<a id="L519" name="L519"></a> 519         <em class="brace">}</em>
<a id="L520" name="L520"></a> 520         <strong class="reserved">return</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>;
<a id="L521" name="L521"></a> 521     <em class="brace">}</em>
<a id="L522" name="L522"></a> 522 
<div class="comment">
      Finds the index of where to insert a new mark.
      @param o the mark to insert
      @return the index</div>
<a id="L529" name="L529"></a> 529     <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../R/14483.html" title="Multiple referred from 2 places.">findSortIndex</a>(<a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>) <em class="brace">{</em>
<a id="L530" name="L530"></a> 530         <strong class="reserved">int</strong> <a href="../D/27175.html" title="Multiple defined in 10 places.">lower</a> = 0;
<a id="L531" name="L531"></a> 531         <strong class="reserved">int</strong> upper = marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() - 1;
<a id="L532" name="L532"></a> 532         <strong class="reserved">int</strong> mid = 0;
<a id="L533" name="L533"></a> 533 
<a id="L534" name="L534"></a> 534         <strong class="reserved">if</strong> (upper == -1) <em class="brace">{</em>
<a id="L535" name="L535"></a> 535             <strong class="reserved">return</strong> 0;
<a id="L536" name="L536"></a> 536         <em class="brace">}</em>
<a id="L537" name="L537"></a> 537 
<a id="L538" name="L538"></a> 538         <strong class="reserved">int</strong> cmp;
<a id="L539" name="L539"></a> 539         <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(upper);
<a id="L540" name="L540"></a> 540         cmp = <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>);
<a id="L541" name="L541"></a> 541         <strong class="reserved">if</strong> (cmp &gt; 0)
<a id="L542" name="L542"></a> 542             <strong class="reserved">return</strong> upper + 1;
<a id="L543" name="L543"></a> 543 
<a id="L544" name="L544"></a> 544         <strong class="reserved">while</strong> (<a href="../D/27175.html" title="Multiple defined in 10 places.">lower</a> &lt;= upper) <em class="brace">{</em>
<a id="L545" name="L545"></a> 545             mid = <a href="../D/27175.html" title="Multiple defined in 10 places.">lower</a> + ((upper - <a href="../D/27175.html" title="Multiple defined in 10 places.">lower</a>) / 2);
<a id="L546" name="L546"></a> 546             <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> entry = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(mid);
<a id="L547" name="L547"></a> 547             cmp = <a href="../D/13032.html" title="Multiple defined in 71 places.">compare</a>(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>, entry);
<a id="L548" name="L548"></a> 548 
<a id="L549" name="L549"></a> 549             <strong class="reserved">if</strong> (cmp == 0) <em class="brace">{</em>
<a id="L550" name="L550"></a> 550                 <em class="comment">// found a match</em>
<a id="L551" name="L551"></a> 551                 <strong class="reserved">return</strong> mid;
<a id="L552" name="L552"></a> 552             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (cmp &lt; 0) <em class="brace">{</em>
<a id="L553" name="L553"></a> 553                 upper = mid - 1;
<a id="L554" name="L554"></a> 554             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L555" name="L555"></a> 555                 <a href="../D/27175.html" title="Multiple defined in 10 places.">lower</a> = mid + 1;
<a id="L556" name="L556"></a> 556             <em class="brace">}</em>
<a id="L557" name="L557"></a> 557         <em class="brace">}</em>
<a id="L558" name="L558"></a> 558 
<a id="L559" name="L559"></a> 559         <em class="comment">// didn't find it, but we indicate the index of where it would belong.</em>
<a id="L560" name="L560"></a> 560         <strong class="reserved">return</strong> (cmp &lt; 0) ? mid : mid + 1;
<a id="L561" name="L561"></a> 561     <em class="brace">}</em>
<a id="L562" name="L562"></a> 562 
<div class="comment">
      Remove all unused marks out of the sorted collection
      of marks.</div>
<a id="L567" name="L567"></a> 567     <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../S/3248.html#L234" title="Referred from 234 in src/javax/swing/text/GapContent.java.">removeUnusedMarks</a>() <em class="brace">{</em>
<a id="L568" name="L568"></a> 568         <strong class="reserved">int</strong> n = marks.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>();
<a id="L569" name="L569"></a> 569         <a href="../S/3248.html#L581" title="Defined at 581 in src/javax/swing/text/GapContent.java.">MarkVector</a> cleaned = <strong class="reserved">new</strong> <a href="../S/3248.html#L581" title="Defined at 581 in src/javax/swing/text/GapContent.java.">MarkVector</a>(n);
<a id="L570" name="L570"></a> 570         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++) <em class="brace">{</em>
<a id="L571" name="L571"></a> 571             <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i);
<a id="L572" name="L572"></a> 572             <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>() != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L573" name="L573"></a> 573                 cleaned.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>);
<a id="L574" name="L574"></a> 574             <em class="brace">}</em>
<a id="L575" name="L575"></a> 575         <em class="brace">}</em>
<a id="L576" name="L576"></a> 576         marks = cleaned;
<a id="L577" name="L577"></a> 577         unusedMarks = 0;
<a id="L578" name="L578"></a> 578     <em class="brace">}</em>
<a id="L579" name="L579"></a> 579 
<a id="L580" name="L580"></a> 580 
<a id="L581" name="L581"></a> 581     <strong class="reserved">static</strong> <strong class="reserved">class</strong> <a href="../R/4937.html" title="Multiple referred from 4 places.">MarkVector</a> <strong class="reserved">extends</strong> <a href="../S/3335.html#L44" title="Defined at 44 in src/javax/swing/text/GapVector.java.">GapVector</a> <em class="brace">{</em>
<a id="L582" name="L582"></a> 582 
<a id="L583" name="L583"></a> 583         MarkVector() <em class="brace">{</em>
<a id="L584" name="L584"></a> 584             <strong class="reserved">super</strong>();
<a id="L585" name="L585"></a> 585         <em class="brace">}</em>
<a id="L586" name="L586"></a> 586 
<a id="L587" name="L587"></a> 587         MarkVector(<strong class="reserved">int</strong> <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>) <em class="brace">{</em>
<a id="L588" name="L588"></a> 588             <strong class="reserved">super</strong>(<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>);
<a id="L589" name="L589"></a> 589         <em class="brace">}</em>
<a id="L590" name="L590"></a> 590 
<div class="comment">
          Allocate an array to store items of the type
          appropriate (which is determined by the subclass).</div>
<a id="L595" name="L595"></a> 595         <strong class="reserved">protected</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/10139.html" title="Multiple referred from 2 places.">allocateArray</a>(<strong class="reserved">int</strong> len) <em class="brace">{</em>
<a id="L596" name="L596"></a> 596             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>[len];
<a id="L597" name="L597"></a> 597         <em class="brace">}</em>
<a id="L598" name="L598"></a> 598 
<div class="comment">
          Get the length of the allocated array</div>
<a id="L602" name="L602"></a> 602         <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/15119.html" title="Multiple referred from 5 places.">getArrayLength</a>() <em class="brace">{</em>
<a id="L603" name="L603"></a> 603             <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>[] marks = (<a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>[]) <a href="../D/17028.html" title="Multiple defined in 16 places.">getArray</a>();
<a id="L604" name="L604"></a> 604             <strong class="reserved">return</strong> marks.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L605" name="L605"></a> 605         <em class="brace">}</em>
<a id="L606" name="L606"></a> 606 
<div class="comment">
          Returns the number of marks currently held</div>
<a id="L610" name="L610"></a> 610         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/28639.html" title="Multiple referred from 5617 places.">size</a>() <em class="brace">{</em>
<a id="L611" name="L611"></a> 611             <strong class="reserved">int</strong> len = <a href="../D/17030.html" title="Multiple defined in 3 places.">getArrayLength</a>() - (<a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>() - <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>());
<a id="L612" name="L612"></a> 612             <strong class="reserved">return</strong> len;
<a id="L613" name="L613"></a> 613         <em class="brace">}</em>
<a id="L614" name="L614"></a> 614 
<div class="comment">
          Inserts a mark into the vector</div>
<a id="L618" name="L618"></a> 618         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/20769.html" title="Multiple referred from 72 places.">insertElementAt</a>(<a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> m, <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) <em class="brace">{</em>
<a id="L619" name="L619"></a> 619             oneMark[0] = m;
<a id="L620" name="L620"></a> 620             <a href="../D/31035.html" title="Multiple defined in 65 places.">replace</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>, 0, oneMark, 1);
<a id="L621" name="L621"></a> 621         <em class="brace">}</em>
<a id="L622" name="L622"></a> 622 
<div class="comment">
          Add a mark to the end</div>
<a id="L626" name="L626"></a> 626         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/9708.html" title="Multiple referred from 886 places.">addElement</a>(<a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> m) <em class="brace">{</em>
<a id="L627" name="L627"></a> 627             <a href="../D/24745.html" title="Multiple defined in 12 places.">insertElementAt</a>(m, <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>());
<a id="L628" name="L628"></a> 628         <em class="brace">}</em>
<a id="L629" name="L629"></a> 629 
<div class="comment">
          Fetches the mark at the given index</div>
<a id="L633" name="L633"></a> 633         <strong class="reserved">public</strong> <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../R/13630.html" title="Multiple referred from 1941 places.">elementAt</a>(<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) <em class="brace">{</em>
<a id="L634" name="L634"></a> 634             <strong class="reserved">int</strong> g0 = <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>();
<a id="L635" name="L635"></a> 635             <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L636" name="L636"></a> 636             <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>[] <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a> = (<a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>[]) <a href="../D/17028.html" title="Multiple defined in 16 places.">getArray</a>();
<a id="L637" name="L637"></a> 637             <strong class="reserved">if</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; g0) <em class="brace">{</em>
<a id="L638" name="L638"></a> 638                 <em class="comment">// below gap</em>
<a id="L639" name="L639"></a> 639                 <strong class="reserved">return</strong> <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>];
<a id="L640" name="L640"></a> 640             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L641" name="L641"></a> 641                 <em class="comment">// above gap</em>
<a id="L642" name="L642"></a> 642                 <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> += g1 - g0;
<a id="L643" name="L643"></a> 643                 <strong class="reserved">return</strong> <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>];
<a id="L644" name="L644"></a> 644             <em class="brace">}</em>
<a id="L645" name="L645"></a> 645         <em class="brace">}</em>
<a id="L646" name="L646"></a> 646 
<div class="comment">
          Replaces the elements in the specified range with the passed
          in objects. This will NOT adjust the gap. The passed in indices
          do not account for the gap, they are the same as would be used
          int <code>elementAt</code>.</div>
<a id="L653" name="L653"></a> 653         <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/26163.html" title="Multiple referred from 2 places.">replaceRange</a>(<strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] marks) <em class="brace">{</em>
<a id="L654" name="L654"></a> 654             <strong class="reserved">int</strong> g0 = <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>();
<a id="L655" name="L655"></a> 655             <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L656" name="L656"></a> 656             <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L657" name="L657"></a> 657             <strong class="reserved">int</strong> <a href="../S/1626.html#L1437" title="Defined at 1437 in src/java/lang/invoke/LambdaForm.java.">newIndex</a> = 0;
<a id="L658" name="L658"></a> 658             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a> = (<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]) <a href="../D/17028.html" title="Multiple defined in 16 places.">getArray</a>();
<a id="L659" name="L659"></a> 659             <strong class="reserved">if</strong> (<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> &gt;= g0) <em class="brace">{</em>
<a id="L660" name="L660"></a> 660                 <em class="comment">// Completely passed gap</em>
<a id="L661" name="L661"></a> 661                 <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> += (g1 - g0);
<a id="L662" name="L662"></a> 662                 <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> += (g1 - g0);
<a id="L663" name="L663"></a> 663             <em class="brace">}</em>
<a id="L664" name="L664"></a> 664             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> &gt;= g0) <em class="brace">{</em>
<a id="L665" name="L665"></a> 665                 <em class="comment">// straddles gap</em>
<a id="L666" name="L666"></a> 666                 <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a> += (g1 - g0);
<a id="L667" name="L667"></a> 667                 <strong class="reserved">while</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; g0) <em class="brace">{</em>
<a id="L668" name="L668"></a> 668                     <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] = marks[<a href="../S/1626.html#L1437" title="Defined at 1437 in src/java/lang/invoke/LambdaForm.java.">newIndex</a>++];
<a id="L669" name="L669"></a> 669                 <em class="brace">}</em>
<a id="L670" name="L670"></a> 670                 <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = g1;
<a id="L671" name="L671"></a> 671             <em class="brace">}</em>
<a id="L672" name="L672"></a> 672             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L673" name="L673"></a> 673                 <em class="comment">// below gap</em>
<a id="L674" name="L674"></a> 674                 <strong class="reserved">while</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L675" name="L675"></a> 675                     <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] = marks[<a href="../S/1626.html#L1437" title="Defined at 1437 in src/java/lang/invoke/LambdaForm.java.">newIndex</a>++];
<a id="L676" name="L676"></a> 676                 <em class="brace">}</em>
<a id="L677" name="L677"></a> 677             <em class="brace">}</em>
<a id="L678" name="L678"></a> 678             <strong class="reserved">while</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; <a href="../D/15431.html" title="Multiple defined in 52 places.">end</a>) <em class="brace">{</em>
<a id="L679" name="L679"></a> 679                 <a href="../D/11496.html" title="Multiple defined in 19 places.">array</a>[<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>++] = marks[<a href="../S/1626.html#L1437" title="Defined at 1437 in src/java/lang/invoke/LambdaForm.java.">newIndex</a>++];
<a id="L680" name="L680"></a> 680             <em class="brace">}</em>
<a id="L681" name="L681"></a> 681         <em class="brace">}</em>
<a id="L682" name="L682"></a> 682 
<a id="L683" name="L683"></a> 683         <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>[] oneMark = <strong class="reserved">new</strong> <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>[1];
<a id="L684" name="L684"></a> 684 
<a id="L685" name="L685"></a> 685     <em class="brace">}</em>
<a id="L686" name="L686"></a> 686 
<a id="L687" name="L687"></a> 687     <em class="comment">// --- serialization -------------------------------------</em>
<a id="L688" name="L688"></a> 688 
<a id="L689" name="L689"></a> 689     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25518.html" title="Multiple referred from 189 places.">readObject</a>(<a href="../S/1378.html#L206" title="Defined at 206 in src/java/io/ObjectInputStream.java.">ObjectInputStream</a> s)
<a id="L690" name="L690"></a> 690       <strong class="reserved">throws</strong> <a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a>, <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L691" name="L691"></a> 691         s.<a href="../D/14746.html" title="Multiple defined in 2 places.">defaultReadObject</a>();
<a id="L692" name="L692"></a> 692         marks = <strong class="reserved">new</strong> <a href="../S/3248.html#L581" title="Defined at 581 in src/javax/swing/text/GapContent.java.">MarkVector</a>();
<a id="L693" name="L693"></a> 693         <a href="../D/31650.html" title="Multiple defined in 35 places.">search</a> = <strong class="reserved">new</strong> <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a>(0);
<a id="L694" name="L694"></a> 694         queue = <strong class="reserved">new</strong> <a href="../S/1565.html#L36" title="Defined at 36 in src/java/lang/ref/ReferenceQueue.java.">ReferenceQueue</a>&lt;<a href="../D/8386.html" title="Multiple defined in 2 places.">StickyPosition</a>&gt;();
<a id="L695" name="L695"></a> 695     <em class="brace">}</em>
<a id="L696" name="L696"></a> 696 
<a id="L697" name="L697"></a> 697 
<a id="L698" name="L698"></a> 698     <em class="comment">// --- undo support --------------------------------------</em>
<a id="L699" name="L699"></a> 699 
<div class="comment">
      Returns a Vector containing instances of UndoPosRef for the
      Positions in the range
      <code>offset</code> to <code>offset</code> + <code>length</code>.
      If <code>v</code> is not null the matching Positions are placed in
      there. The vector with the resulting Positions are returned.
      @param v the Vector to use, with a new one created on null
      @param offset the starting offset &gt;= 0
      @param length the length &gt;= 0
      @return the set of instances</div>
<a id="L712" name="L712"></a> 712     <strong class="reserved">protected</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> <a href="../R/18384.html" title="Multiple referred from 6 places.">getPositionsInRange</a>(<a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> v, <strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L713" name="L713"></a> 713         <strong class="reserved">int</strong> endOffset = <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> + <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L714" name="L714"></a> 714         <strong class="reserved">int</strong> startIndex;
<a id="L715" name="L715"></a> 715         <strong class="reserved">int</strong> endIndex;
<a id="L716" name="L716"></a> 716         <strong class="reserved">int</strong> g0 = <a href="../S/3335.html#L88" title="Defined at 88 in src/javax/swing/text/GapVector.java.">getGapStart</a>();
<a id="L717" name="L717"></a> 717         <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L718" name="L718"></a> 718 
<a id="L719" name="L719"></a> 719         <em class="comment">// Find the index of the marks.</em>
<a id="L720" name="L720"></a> 720         <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &lt; g0) <em class="brace">{</em>
<a id="L721" name="L721"></a> 721             <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> == 0) <em class="brace">{</em>
<a id="L722" name="L722"></a> 722                 <em class="comment">// findMarkAdjustIndex start at 1!</em>
<a id="L723" name="L723"></a> 723                 startIndex = 0;
<a id="L724" name="L724"></a> 724             <em class="brace">}</em>
<a id="L725" name="L725"></a> 725             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L726" name="L726"></a> 726                 startIndex = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>);
<a id="L727" name="L727"></a> 727             <em class="brace">}</em>
<a id="L728" name="L728"></a> 728             <strong class="reserved">if</strong> (endOffset &gt;= g0) <em class="brace">{</em>
<a id="L729" name="L729"></a> 729                 endIndex = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(endOffset + (g1 - g0) + 1);
<a id="L730" name="L730"></a> 730             <em class="brace">}</em>
<a id="L731" name="L731"></a> 731             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L732" name="L732"></a> 732                 endIndex = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(endOffset + 1);
<a id="L733" name="L733"></a> 733             <em class="brace">}</em>
<a id="L734" name="L734"></a> 734         <em class="brace">}</em>
<a id="L735" name="L735"></a> 735         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L736" name="L736"></a> 736             startIndex = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> + (g1 - g0));
<a id="L737" name="L737"></a> 737             endIndex = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(endOffset + (g1 - g0) + 1);
<a id="L738" name="L738"></a> 738         <em class="brace">}</em>
<a id="L739" name="L739"></a> 739 
<a id="L740" name="L740"></a> 740         <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> placeIn = (v == <strong class="reserved">null</strong>) ? <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>(<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>(1, endIndex -
<a id="L741" name="L741"></a> 741                                                            startIndex)) : v;
<a id="L742" name="L742"></a> 742 
<a id="L743" name="L743"></a> 743         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> counter = startIndex; counter &lt; endIndex; counter++) <em class="brace">{</em>
<a id="L744" name="L744"></a> 744             placeIn.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(<strong class="reserved">new</strong> <a href="../D/9292.html" title="Multiple defined in 2 places.">UndoPosRef</a>(marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(counter)));
<a id="L745" name="L745"></a> 745         <em class="brace">}</em>
<a id="L746" name="L746"></a> 746         <strong class="reserved">return</strong> placeIn;
<a id="L747" name="L747"></a> 747     <em class="brace">}</em>
<a id="L748" name="L748"></a> 748 
<div class="comment">
      Resets the location for all the UndoPosRef instances
      in <code>positions</code>.
      <p>
      This is meant for internal usage, and is generally not of interest
      to subclasses.
      @param positions the UndoPosRef instances to reset</p></div>
<a id="L758" name="L758"></a> 758     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/29981.html" title="Multiple referred from 4 places.">updateUndoPositions</a>(<a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> positions, <strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>,
<a id="L759" name="L759"></a> 759                                        <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L760" name="L760"></a> 760         <em class="comment">// Find the indexs of the end points.</em>
<a id="L761" name="L761"></a> 761         <strong class="reserved">int</strong> endOffset = <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> + <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L762" name="L762"></a> 762         <strong class="reserved">int</strong> g1 = <a href="../S/3335.html#L95" title="Defined at 95 in src/javax/swing/text/GapVector.java.">getGapEnd</a>();
<a id="L763" name="L763"></a> 763         <strong class="reserved">int</strong> startIndex;
<a id="L764" name="L764"></a> 764         <strong class="reserved">int</strong> endIndex = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(g1 + 1);
<a id="L765" name="L765"></a> 765 
<a id="L766" name="L766"></a> 766         <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> != 0) <em class="brace">{</em>
<a id="L767" name="L767"></a> 767             startIndex = <a href="../S/3248.html#L507" title="Defined at 507 in src/javax/swing/text/GapContent.java.">findMarkAdjustIndex</a>(g1);
<a id="L768" name="L768"></a> 768         <em class="brace">}</em>
<a id="L769" name="L769"></a> 769         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L770" name="L770"></a> 770             startIndex = 0;
<a id="L771" name="L771"></a> 771         <em class="brace">}</em>
<a id="L772" name="L772"></a> 772 
<a id="L773" name="L773"></a> 773         <em class="comment">// Reset the location of the refenences.</em>
<a id="L774" name="L774"></a> 774         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> counter = positions.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() - 1; counter &gt;= 0; counter--) <em class="brace">{</em>
<a id="L775" name="L775"></a> 775             <a href="../D/9292.html" title="Multiple defined in 2 places.">UndoPosRef</a> <a href="../S/986.html#L2252" title="Defined at 2252 in src/java/util/regex/Pattern.java.">ref</a> = (<a href="../D/9292.html" title="Multiple defined in 2 places.">UndoPosRef</a>)positions.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(counter);
<a id="L776" name="L776"></a> 776             <a href="../S/986.html#L2252" title="Defined at 2252 in src/java/util/regex/Pattern.java.">ref</a>.<a href="../D/31182.html" title="Multiple defined in 2 places.">resetLocation</a>(endOffset, g1);
<a id="L777" name="L777"></a> 777         <em class="brace">}</em>
<a id="L778" name="L778"></a> 778         <em class="comment">// We have to resort the marks in the range startIndex to endIndex.</em>
<a id="L779" name="L779"></a> 779         <em class="comment">// We can take advantage of the fact that it will be in</em>
<a id="L780" name="L780"></a> 780         <em class="comment">// increasing order, accept there will be a bunch of MarkData's with</em>
<a id="L781" name="L781"></a> 781         <em class="comment">// the index g1 (or 0 if offset == 0) interspersed throughout.</em>
<a id="L782" name="L782"></a> 782         <strong class="reserved">if</strong> (startIndex &lt; endIndex) <em class="brace">{</em>
<a id="L783" name="L783"></a> 783             <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <a href="../D/34694.html" title="Multiple defined in 10 places.">sorted</a> = <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[endIndex - startIndex];
<a id="L784" name="L784"></a> 784             <strong class="reserved">int</strong> <a href="../S/773.html#L359" title="Defined at 359 in src/java/net/InMemoryCookieStore.java.">addIndex</a> = 0;
<a id="L785" name="L785"></a> 785             <strong class="reserved">int</strong> counter;
<a id="L786" name="L786"></a> 786             <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> == 0) <em class="brace">{</em>
<a id="L787" name="L787"></a> 787                 <em class="comment">// If the offset is 0, the positions won't have incremented,</em>
<a id="L788" name="L788"></a> 788                 <em class="comment">// have to do the reverse thing.</em>
<a id="L789" name="L789"></a> 789                 <em class="comment">// Find the elements in startIndex whose index is 0</em>
<a id="L790" name="L790"></a> 790                 <strong class="reserved">for</strong> (counter = startIndex; counter &lt; endIndex; counter++) <em class="brace">{</em>
<a id="L791" name="L791"></a> 791                     <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(counter);
<a id="L792" name="L792"></a> 792                     <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == 0) <em class="brace">{</em>
<a id="L793" name="L793"></a> 793                         <a href="../D/34694.html" title="Multiple defined in 10 places.">sorted</a>[<a href="../S/773.html#L359" title="Defined at 359 in src/java/net/InMemoryCookieStore.java.">addIndex</a>++] = <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>;
<a id="L794" name="L794"></a> 794                     <em class="brace">}</em>
<a id="L795" name="L795"></a> 795                 <em class="brace">}</em>
<a id="L796" name="L796"></a> 796                 <strong class="reserved">for</strong> (counter = startIndex; counter &lt; endIndex; counter++) <em class="brace">{</em>
<a id="L797" name="L797"></a> 797                     <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(counter);
<a id="L798" name="L798"></a> 798                     <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> != 0) <em class="brace">{</em>
<a id="L799" name="L799"></a> 799                         <a href="../D/34694.html" title="Multiple defined in 10 places.">sorted</a>[<a href="../S/773.html#L359" title="Defined at 359 in src/java/net/InMemoryCookieStore.java.">addIndex</a>++] = <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>;
<a id="L800" name="L800"></a> 800                     <em class="brace">}</em>
<a id="L801" name="L801"></a> 801                 <em class="brace">}</em>
<a id="L802" name="L802"></a> 802             <em class="brace">}</em>
<a id="L803" name="L803"></a> 803             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L804" name="L804"></a> 804                 <strong class="reserved">for</strong> (counter = startIndex; counter &lt; endIndex; counter++) <em class="brace">{</em>
<a id="L805" name="L805"></a> 805                     <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(counter);
<a id="L806" name="L806"></a> 806                     <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> != g1) <em class="brace">{</em>
<a id="L807" name="L807"></a> 807                         <a href="../D/34694.html" title="Multiple defined in 10 places.">sorted</a>[<a href="../S/773.html#L359" title="Defined at 359 in src/java/net/InMemoryCookieStore.java.">addIndex</a>++] = <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>;
<a id="L808" name="L808"></a> 808                     <em class="brace">}</em>
<a id="L809" name="L809"></a> 809                 <em class="brace">}</em>
<a id="L810" name="L810"></a> 810                 <strong class="reserved">for</strong> (counter = startIndex; counter &lt; endIndex; counter++) <em class="brace">{</em>
<a id="L811" name="L811"></a> 811                     <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a> = marks.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(counter);
<a id="L812" name="L812"></a> 812                     <strong class="reserved">if</strong> (<a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == g1) <em class="brace">{</em>
<a id="L813" name="L813"></a> 813                         <a href="../D/34694.html" title="Multiple defined in 10 places.">sorted</a>[<a href="../S/773.html#L359" title="Defined at 359 in src/java/net/InMemoryCookieStore.java.">addIndex</a>++] = <a href="../D/27489.html" title="Multiple defined in 38 places.">mark</a>;
<a id="L814" name="L814"></a> 814                     <em class="brace">}</em>
<a id="L815" name="L815"></a> 815                 <em class="brace">}</em>
<a id="L816" name="L816"></a> 816             <em class="brace">}</em>
<a id="L817" name="L817"></a> 817             <em class="comment">// And replace</em>
<a id="L818" name="L818"></a> 818             marks.<a href="../D/31063.html" title="Multiple defined in 4 places.">replaceRange</a>(startIndex, endIndex, <a href="../D/34694.html" title="Multiple defined in 10 places.">sorted</a>);
<a id="L819" name="L819"></a> 819         <em class="brace">}</em>
<a id="L820" name="L820"></a> 820     <em class="brace">}</em>
<a id="L821" name="L821"></a> 821 
<div class="comment">
      Used to hold a reference to a Mark that is being reset as the
      result of removing from the content.</div>
<a id="L826" name="L826"></a> 826     <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/8441.html" title="Multiple referred from 4 places.">UndoPosRef</a> <em class="brace">{</em>
<a id="L827" name="L827"></a> 827         UndoPosRef(<a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> rec) <em class="brace">{</em>
<a id="L828" name="L828"></a> 828             <strong class="reserved">this</strong>.rec = rec;
<a id="L829" name="L829"></a> 829             <strong class="reserved">this</strong>.undoLocation = rec.<a href="../D/21176.html" title="Multiple defined in 43 places.">getOffset</a>();
<a id="L830" name="L830"></a> 830         <em class="brace">}</em>
<a id="L831" name="L831"></a> 831 
<div class="comment">
          Resets the location of the Position to the offset when the
          receiver was instantiated.
          @param endOffset end location of inserted string.
          @param g1 resulting end of gap.</div>
<a id="L839" name="L839"></a> 839         <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/26267.html" title="Multiple referred from 2 places.">resetLocation</a>(<strong class="reserved">int</strong> endOffset, <strong class="reserved">int</strong> g1) <em class="brace">{</em>
<a id="L840" name="L840"></a> 840             <strong class="reserved">if</strong> (undoLocation != endOffset) <em class="brace">{</em>
<a id="L841" name="L841"></a> 841                 <strong class="reserved">this</strong>.rec.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = undoLocation;
<a id="L842" name="L842"></a> 842             <em class="brace">}</em>
<a id="L843" name="L843"></a> 843             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L844" name="L844"></a> 844                 <strong class="reserved">this</strong>.rec.<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = g1;
<a id="L845" name="L845"></a> 845             <em class="brace">}</em>
<a id="L846" name="L846"></a> 846         <em class="brace">}</em>
<a id="L847" name="L847"></a> 847 
<div class="comment">
         /** Previous Offset of rec. */</div>
<a id="L849" name="L849"></a> 849         <strong class="reserved">protected</strong> <strong class="reserved">int</strong> undoLocation;
<div class="comment">
         /** Mark to reset offset. */</div>
<a id="L851" name="L851"></a> 851         <strong class="reserved">protected</strong> <a href="../S/3248.html#L265" title="Defined at 265 in src/javax/swing/text/GapContent.java.">MarkData</a> rec;
<a id="L852" name="L852"></a> 852     <em class="brace">}</em> <em class="comment">// End of GapContent.UndoPosRef</em>
<a id="L853" name="L853"></a> 853 
<a id="L854" name="L854"></a> 854 
<div class="comment">
      UnoableEdit created for inserts.</div>
<a id="L858" name="L858"></a> 858     <strong class="reserved">class</strong> <a href="../R/3863.html" title="Multiple referred from 2 places.">InsertUndo</a> <strong class="reserved">extends</strong> <a href="../S/3141.html#L38" title="Defined at 38 in src/javax/swing/undo/AbstractUndoableEdit.java.">AbstractUndoableEdit</a> <em class="brace">{</em>
<a id="L859" name="L859"></a> 859         <strong class="reserved">protected</strong> InsertUndo(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L860" name="L860"></a> 860             <strong class="reserved">super</strong>();
<a id="L861" name="L861"></a> 861             <strong class="reserved">this</strong>.<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> = <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L862" name="L862"></a> 862             <strong class="reserved">this</strong>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> = <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L863" name="L863"></a> 863         <em class="brace">}</em>
<a id="L864" name="L864"></a> 864 
<a id="L865" name="L865"></a> 865         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/29628.html" title="Multiple referred from 38 places.">undo</a>() <strong class="reserved">throws</strong> <a href="../S/3140.html#L42" title="Defined at 42 in src/javax/swing/undo/CannotUndoException.java.">CannotUndoException</a> <em class="brace">{</em>
<a id="L866" name="L866"></a> 866             <strong class="reserved">super</strong>.<a href="../D/35822.html" title="Multiple defined in 13 places.">undo</a>();
<a id="L867" name="L867"></a> 867             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L868" name="L868"></a> 868                 <em class="comment">// Get the Positions in the range being removed.</em>
<a id="L869" name="L869"></a> 869                 posRefs = <a href="../D/21552.html" title="Multiple defined in 2 places.">getPositionsInRange</a>(<strong class="reserved">null</strong>, <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L870" name="L870"></a> 870                 <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> = <a href="../D/22769.html" title="Multiple defined in 35 places.">getString</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L871" name="L871"></a> 871                 <a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L872" name="L872"></a> 872             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> bl) <em class="brace">{</em>
<a id="L873" name="L873"></a> 873               <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3140.html#L42" title="Defined at 42 in src/javax/swing/undo/CannotUndoException.java.">CannotUndoException</a>();
<a id="L874" name="L874"></a> 874             <em class="brace">}</em>
<a id="L875" name="L875"></a> 875         <em class="brace">}</em>
<a id="L876" name="L876"></a> 876 
<a id="L877" name="L877"></a> 877         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25693.html" title="Multiple referred from 14 places.">redo</a>() <strong class="reserved">throws</strong> <a href="../S/3138.html#L41" title="Defined at 41 in src/javax/swing/undo/CannotRedoException.java.">CannotRedoException</a> <em class="brace">{</em>
<a id="L878" name="L878"></a> 878             <strong class="reserved">super</strong>.<a href="../D/30435.html" title="Multiple defined in 13 places.">redo</a>();
<a id="L879" name="L879"></a> 879             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L880" name="L880"></a> 880                 <a href="../D/24774.html" title="Multiple defined in 12 places.">insertString</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>);
<a id="L881" name="L881"></a> 881                 <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> = <strong class="reserved">null</strong>;
<a id="L882" name="L882"></a> 882                 <em class="comment">// Update the Positions that were in the range removed.</em>
<a id="L883" name="L883"></a> 883                 <strong class="reserved">if</strong>(posRefs != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L884" name="L884"></a> 884                     <a href="../D/36238.html" title="Multiple defined in 2 places.">updateUndoPositions</a>(posRefs, <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L885" name="L885"></a> 885                     posRefs = <strong class="reserved">null</strong>;
<a id="L886" name="L886"></a> 886                 <em class="brace">}</em>
<a id="L887" name="L887"></a> 887             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> bl) <em class="brace">{</em>
<a id="L888" name="L888"></a> 888                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3138.html#L41" title="Defined at 41 in src/javax/swing/undo/CannotRedoException.java.">CannotRedoException</a>();
<a id="L889" name="L889"></a> 889             <em class="brace">}</em>
<a id="L890" name="L890"></a> 890         <em class="brace">}</em>
<a id="L891" name="L891"></a> 891 
<div class="comment">
         /** Where string was inserted. */</div>
<a id="L893" name="L893"></a> 893         <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<div class="comment">
         /** Length of string inserted. */</div>
<a id="L895" name="L895"></a> 895         <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<div class="comment">
 The string that was inserted. This will only be valid after an
         * undo. </div>
<a id="L898" name="L898"></a> 898         <strong class="reserved">protected</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>;
<div class="comment">
 An array of instances of UndoPosRef for the Positions in the
         * range that was removed, valid after undo. </div>
<a id="L901" name="L901"></a> 901         <strong class="reserved">protected</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> posRefs;
<a id="L902" name="L902"></a> 902     <em class="brace">}</em> <em class="comment">// GapContent.InsertUndo</em>
<a id="L903" name="L903"></a> 903 
<a id="L904" name="L904"></a> 904 
<div class="comment">
      UndoableEdit created for removes.</div>
<a id="L908" name="L908"></a> 908     <strong class="reserved">class</strong> <a href="../R/6610.html" title="Multiple referred from 2 places.">RemoveUndo</a> <strong class="reserved">extends</strong> <a href="../S/3141.html#L38" title="Defined at 38 in src/javax/swing/undo/AbstractUndoableEdit.java.">AbstractUndoableEdit</a> <em class="brace">{</em>
<a id="L909" name="L909"></a> 909         <strong class="reserved">protected</strong> RemoveUndo(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>) <em class="brace">{</em>
<a id="L910" name="L910"></a> 910             <strong class="reserved">super</strong>();
<a id="L911" name="L911"></a> 911             <strong class="reserved">this</strong>.<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> = <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L912" name="L912"></a> 912             <strong class="reserved">this</strong>.<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> = <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>;
<a id="L913" name="L913"></a> 913             <strong class="reserved">this</strong>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> = <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L914" name="L914"></a> 914             posRefs = <a href="../D/21552.html" title="Multiple defined in 2 places.">getPositionsInRange</a>(<strong class="reserved">null</strong>, <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L915" name="L915"></a> 915         <em class="brace">}</em>
<a id="L916" name="L916"></a> 916 
<a id="L917" name="L917"></a> 917         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/29628.html" title="Multiple referred from 38 places.">undo</a>() <strong class="reserved">throws</strong> <a href="../S/3140.html#L42" title="Defined at 42 in src/javax/swing/undo/CannotUndoException.java.">CannotUndoException</a> <em class="brace">{</em>
<a id="L918" name="L918"></a> 918             <strong class="reserved">super</strong>.<a href="../D/35822.html" title="Multiple defined in 13 places.">undo</a>();
<a id="L919" name="L919"></a> 919             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L920" name="L920"></a> 920                 <a href="../D/24774.html" title="Multiple defined in 12 places.">insertString</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>);
<a id="L921" name="L921"></a> 921                 <em class="comment">// Update the Positions that were in the range removed.</em>
<a id="L922" name="L922"></a> 922                 <strong class="reserved">if</strong>(posRefs != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L923" name="L923"></a> 923                     <a href="../D/36238.html" title="Multiple defined in 2 places.">updateUndoPositions</a>(posRefs, <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L924" name="L924"></a> 924                     posRefs = <strong class="reserved">null</strong>;
<a id="L925" name="L925"></a> 925                 <em class="brace">}</em>
<a id="L926" name="L926"></a> 926                 <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> = <strong class="reserved">null</strong>;
<a id="L927" name="L927"></a> 927             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> bl) <em class="brace">{</em>
<a id="L928" name="L928"></a> 928               <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3140.html#L42" title="Defined at 42 in src/javax/swing/undo/CannotUndoException.java.">CannotUndoException</a>();
<a id="L929" name="L929"></a> 929             <em class="brace">}</em>
<a id="L930" name="L930"></a> 930         <em class="brace">}</em>
<a id="L931" name="L931"></a> 931 
<a id="L932" name="L932"></a> 932         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25693.html" title="Multiple referred from 14 places.">redo</a>() <strong class="reserved">throws</strong> <a href="../S/3138.html#L41" title="Defined at 41 in src/javax/swing/undo/CannotRedoException.java.">CannotRedoException</a> <em class="brace">{</em>
<a id="L933" name="L933"></a> 933             <strong class="reserved">super</strong>.<a href="../D/30435.html" title="Multiple defined in 13 places.">redo</a>();
<a id="L934" name="L934"></a> 934             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L935" name="L935"></a> 935                 <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> = <a href="../D/22769.html" title="Multiple defined in 35 places.">getString</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L936" name="L936"></a> 936                 <em class="comment">// Get the Positions in the range being removed.</em>
<a id="L937" name="L937"></a> 937                 posRefs = <a href="../D/21552.html" title="Multiple defined in 2 places.">getPositionsInRange</a>(<strong class="reserved">null</strong>, <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L938" name="L938"></a> 938                 <a href="../D/30677.html" title="Multiple defined in 356 places.">remove</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L939" name="L939"></a> 939             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3359.html#L43" title="Defined at 43 in src/javax/swing/text/BadLocationException.java.">BadLocationException</a> bl) <em class="brace">{</em>
<a id="L940" name="L940"></a> 940               <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/3138.html#L41" title="Defined at 41 in src/javax/swing/undo/CannotRedoException.java.">CannotRedoException</a>();
<a id="L941" name="L941"></a> 941             <em class="brace">}</em>
<a id="L942" name="L942"></a> 942         <em class="brace">}</em>
<a id="L943" name="L943"></a> 943 
<div class="comment">
         /** Where the string was removed from. */</div>
<a id="L945" name="L945"></a> 945         <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<div class="comment">
         /** Length of string removed. */</div>
<a id="L947" name="L947"></a> 947         <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<div class="comment">
         /** The string that was removed. This is valid when redo is valid. */</div>
<a id="L949" name="L949"></a> 949         <strong class="reserved">protected</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>;
<div class="comment">
 An array of instances of UndoPosRef for the Positions in the
         * range that was removed, valid before undo. </div>
<a id="L952" name="L952"></a> 952         <strong class="reserved">protected</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a> posRefs;
<a id="L953" name="L953"></a> 953     <em class="brace">}</em> <em class="comment">// GapContent.RemoveUndo</em>
<a id="L954" name="L954"></a> 954 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L93">[^]</a><a href="#L932">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>