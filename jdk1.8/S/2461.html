<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/text/RuleBasedCollator.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L317">[^]</a><a href="#L745">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L317" title="Defined at 317.">getRules</a></li>
<li><a href="#L329" title="Defined at 329.">getCollationElementIterator</a></li>
<li><a href="#L341" title="Defined at 341.">getCollationElementIterator</a></li>
<li><a href="#L354" title="Defined at 354.">compare</a></li>
<li><a href="#L571" title="Defined at 571.">getCollationKey</a></li>
<li><a href="#L703" title="Defined at 703.">clone</a></li>
<li><a href="#L727" title="Defined at 727.">equals</a></li>
<li><a href="#L738" title="Defined at 738.">hashCode</a></li>
<li><a href="#L745" title="Defined at 745.">getTables</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<div class="comment">
  (C) Copyright Taligent, Inc. 1996, 1997 - All Rights Reserved
  (C) Copyright IBM Corp. 1996-1998 - All Rights Reserved
    The original version of this source code and documentation is copyrighted
  and owned by Taligent, Inc., a wholly-owned subsidiary of IBM. These
  materials are provided under terms of a License Agreement between Taligent
  and Sun. This technology is protected by multiple US and International
  patents. This notice and attribution to Taligent may not be removed.
    Taligent is a registered trademark of Taligent, Inc.</div>
<a id="L38" name="L38"></a>  38 
<a id="L39" name="L39"></a>  39 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>;
<a id="L40" name="L40"></a>  40 
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> java.text.Normalizer;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> java.util.Vector;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> java.util.Locale;
<a id="L44" name="L44"></a>  44 
<div class="comment">
  The <code>RuleBasedCollator</code> class is a concrete subclass of
  <code>Collator</code> that provides a simple, data-driven, table
  collator.  With this class you can create a customized table-based
  <code>Collator</code>.  <code>RuleBasedCollator</code> maps
  characters to sort keys.
  <p>
  <code>RuleBasedCollator</code> has the following restrictions
  for efficiency (other subclasses may be used for more complex languages) :
  </p><ol>
  <li>If a special collation rule controlled by a &lt;modifier&gt; is
      specified it applies to the whole collator object.
  </li><li>All non-mentioned characters are at the end of the
      collation order.
  </li></ol>
  <p>
  The collation table is composed of a list of collation rules, where each
  rule is of one of three forms:
  </p><pre>     &lt;modifier&gt;
     &lt;relation&gt; &lt;text-argument&gt;
     &lt;reset&gt; &lt;text-argument&gt;
  </pre>
  The definitions of the rule elements is as follows:
  <ul>
     <li><strong>Text-Argument</strong>: A text-argument is any sequence of
         characters, excluding special characters (that is, common
         whitespace characters [0009-000D, 0020] and rule syntax characters
         [0021-002F, 003A-0040, 005B-0060, 007B-007E]). If those
         characters are desired, you can put them in single quotes
         (e.g. ampersand =&gt; '&amp;'). Note that unquoted white space characters
         are ignored; e.g. <code>b c</code> is treated as <code>bc</code>.
     </li><li><strong>Modifier</strong>: There are currently two modifiers that
         turn on special collation rules.
         <ul>
             <li>'@' : Turns on backwards sorting of accents (secondary
                       differences), as in French.
             </li><li>'!' : Turns on Thai/Lao vowel-consonant swapping.  If this
                       rule is in force when a Thai vowel of the range
                       \U0E40-\U0E44 precedes a Thai consonant of the range
                       \U0E01-\U0E2E OR a Lao vowel of the range \U0EC0-\U0EC4
                       precedes a Lao consonant of the range \U0E81-\U0EAE then
                       the vowel is placed after the consonant for collation
                       purposes.
         </li></ul>
         <p>'@' : Indicates that accents are sorted backwards, as in French.
     </p></li><li><strong>Relation</strong>: The relations are the following:
         <ul>
             <li>'&lt;' : Greater, as a letter difference (primary)
             </li><li>';' : Greater, as an accent difference (secondary)
             </li><li>',' : Greater, as a case difference (tertiary)
             </li><li>'=' : Equal
         </li></ul>
     </li><li><strong>Reset</strong>: There is a single reset
         which is used primarily for contractions and expansions, but which
         can also be used to add a modification at the end of a set of rules.
         <p>'&amp;' : Indicates that the next rule follows the position to where
             the reset text-argument would be sorted.
  </p></li></ul>
  <p>
  This sounds more complicated than it is in practice. For example, the
  following are equivalent ways of expressing the same thing:
  </p><blockquote>
  <pre>  a &lt; b &lt; c
  a &lt; b &amp; b &lt; c
  a &lt; c &amp; a &lt; b
  </pre>
  </blockquote>
  Notice that the order is important, as the subsequent item goes immediately
  after the text-argument. The following are not equivalent:
  <blockquote>
  <pre>  a &lt; b &amp; a &lt; c
  a &lt; c &amp; a &lt; b
  </pre>
  </blockquote>
  Either the text-argument must already be present in the sequence, or some
  initial substring of the text-argument must be present. (e.g. "a &lt; b &amp; ae &lt;
  e" is valid since "a" is present in the sequence before "ae" is reset). In
  this latter case, "ae" is not entered and treated as a single character;
  instead, "e" is sorted as if it were expanded to two characters: "a"
  followed by an "e". This difference appears in natural languages: in
  traditional Spanish "ch" is treated as though it contracts to a single
  character (expressed as "c &lt; ch &lt; d"), while in traditional German
  a-umlaut is treated as though it expanded to two characters
  (expressed as "a,A &lt; b,B ... &amp;ae;\u00e3&amp;AE;\u00c3").
  [\u00e3 and \u00c3 are, of course, the escape sequences for a-umlaut.]
  <p>
  <strong>Ignorable Characters</strong>
  </p><p>
  For ignorable characters, the first rule must start with a relation (the
  examples we have used above are really fragments; "a &lt; b" really should be
  "&lt; a &lt; b"). If, however, the first relation is not "&lt;", then all the all
  text-arguments up to the first "&lt;" are ignorable. For example, ", - &lt; a &lt; b"
  makes "-" an ignorable character, as we saw earlier in the word
  "black-birds". In the samples for different languages, you see that most
  accents are ignorable.
  </p><p><strong>Normalization and Accents</strong>
  </p><p>
  <code>RuleBasedCollator</code> automatically processes its rule table to
  include both pre-composed and combining-character versions of
  accented characters.  Even if the provided rule string contains only
  base characters and separate combining accent characters, the pre-composed
  accented characters matching all canonical combinations of characters from
  the rule string will be entered in the table.
  </p><p>
  This allows you to use a RuleBasedCollator to compare accented strings
  even when the collator is set to NO_DECOMPOSITION.  There are two caveats,
  however.  First, if the strings to be collated contain combining
  sequences that may not be in canonical order, you should set the collator to
  CANONICAL_DECOMPOSITION or FULL_DECOMPOSITION to enable sorting of
  combining sequences.  Second, if the strings contain characters with
  compatibility decompositions (such as full-width and half-width forms),
  you must use FULL_DECOMPOSITION, since the rule tables only include
  canonical mappings.
  </p><p><strong>Errors</strong>
  </p><p>
  The following are errors:
  </p><ul>
      <li>A text-argument contains unquoted punctuation symbols
         (e.g. "a &lt; b-c &lt; d").
      </li><li>A relation or reset character not followed by a text-argument
         (e.g. "a &lt; ,b").
      </li><li>A reset where the text-argument (or an initial substring of the
          text-argument) is not already in the sequence.
          (e.g. "a &lt; b &amp; e &lt; f")
  </li></ul>
  If you produce one of these errors, a <code>RuleBasedCollator</code> throws
  a <code>ParseException</code>.
  <p><strong>Examples</strong>
  </p><p>Simple:     "&lt; a &lt; b &lt; c &lt; d"
  </p><p>Norwegian:  "&lt; a, A &lt; b, B &lt; c, C &lt; d, D &lt; e, E &lt; f, F
                  &lt; g, G &lt; h, H &lt; i, I &lt; j, J &lt; k, K &lt; l, L
                  &lt; m, M &lt; n, N &lt; o, O &lt; p, P &lt; q, Q &lt; r, R
                  &lt; s, S &lt; t, T &lt; u, U &lt; v, V &lt; w, W &lt; x, X
                  &lt; y, Y &lt; z, Z
                  &lt; \u00E6, \u00C6
                  &lt; \u00F8, \u00D8
                  &lt; \u00E5 = a\u030A, \u00C5 = A\u030A;
                       aa, AA"
  </p><p>
  To create a <code>RuleBasedCollator</code> object with specialized
  rules tailored to your needs, you construct the <code>RuleBasedCollator</code>
  with the rules contained in a <code>String</code> object. For example:
  </p><blockquote>
  <pre>  String simple = "&lt; a&lt; b&lt; c&lt; d";
  RuleBasedCollator mySimple = new RuleBasedCollator(simple);
  </pre>
  </blockquote>
  Or:
  <blockquote>
  <pre>  String Norwegian = "&lt; a, A &lt; b, B &lt; c, C &lt; d, D &lt; e, E &lt; f, F &lt; g, G &lt; h, H &lt; i, I" +
                     "&lt; j, J &lt; k, K &lt; l, L &lt; m, M &lt; n, N &lt; o, O &lt; p, P &lt; q, Q &lt; r, R" +
                     "&lt; s, S &lt; t, T &lt; u, U &lt; v, V &lt; w, W &lt; x, X &lt; y, Y &lt; z, Z" +
                     "&lt; \u00E6, \u00C6" +     // Latin letter ae &amp; AE
                     "&lt; \u00F8, \u00D8" +     // Latin letter o &amp; O with stroke
                     "&lt; \u00E5 = a\u030A," +  // Latin letter a with ring above
                     "  \u00C5 = A\u030A;" +  // Latin letter A with ring above
                     "  aa, AA";
  RuleBasedCollator myNorwegian = new RuleBasedCollator(Norwegian);
  </pre>
  </blockquote>
  <p>
  A new collation rules string can be created by concatenating rules
  strings. For example, the rules returned by {@link #getRules()} could
  be concatenated to combine multiple <code>RuleBasedCollator</code>s.
  </p><p>
  The following example demonstrates how to change the order of
  non-spacing accents,
  </p><blockquote>
  <pre>  // old rule
  String oldRules = "=\u0301;\u0300;\u0302;\u0308"    // main accents
                  + ";\u0327;\u0303;\u0304;\u0305"    // main accents
                  + ";\u0306;\u0307;\u0309;\u030A"    // main accents
                  + ";\u030B;\u030C;\u030D;\u030E"    // main accents
                  + ";\u030F;\u0310;\u0311;\u0312"    // main accents
                  + "&lt; a , A ; ae, AE ; \u00e6 , \u00c6"
                  + "&lt; b , B &lt; c, C &lt; e, E &amp; C &lt; d, D";
  // change the order of accent characters
  String addOn = "&amp; \u0300 ; \u0308 ; \u0302";
  RuleBasedCollator myCollator = new RuleBasedCollator(oldRules + addOn);
  </pre>
  </blockquote>
  @see        Collator
  @see        CollationElementIterator
  @author     Helena Shih, Laura Werner, Richard Gillam</div>
<a id="L246" name="L246"></a> 246 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/6770.html" title="Multiple referred from 20 places.">RuleBasedCollator</a> <strong class="reserved">extends</strong> <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a><em class="brace">{</em>
<a id="L247" name="L247"></a> 247     <em class="comment">// IMPLEMENTATION NOTES:  The implementation of the collation algorithm is</em>
<a id="L248" name="L248"></a> 248     <em class="comment">// divided across three classes: RuleBasedCollator, RBCollationTables, and</em>
<a id="L249" name="L249"></a> 249     <em class="comment">// CollationElementIterator.  RuleBasedCollator contains the collator's</em>
<a id="L250" name="L250"></a> 250     <em class="comment">// transient state and includes the code that uses the other classes to</em>
<a id="L251" name="L251"></a> 251     <em class="comment">// implement comparison and sort-key building.  RuleBasedCollator also</em>
<a id="L252" name="L252"></a> 252     <em class="comment">// contains the logic to handle French secondary accent sorting.</em>
<a id="L253" name="L253"></a> 253     <em class="comment">// A RuleBasedCollator has two CollationElementIterators.  State doesn't</em>
<a id="L254" name="L254"></a> 254     <em class="comment">// need to be preserved in these objects between calls to compare() or</em>
<a id="L255" name="L255"></a> 255     <em class="comment">// getCollationKey(), but the objects persist anyway to avoid wasting extra</em>
<a id="L256" name="L256"></a> 256     <em class="comment">// creation time.  compare() and getCollationKey() are synchronized to ensure</em>
<a id="L257" name="L257"></a> 257     <em class="comment">// thread safety with this scheme.  The CollationElementIterator is responsible</em>
<a id="L258" name="L258"></a> 258     <em class="comment">// for generating collation elements from strings and returning one element at</em>
<a id="L259" name="L259"></a> 259     <em class="comment">// a time (sometimes there's a one-to-many or many-to-one mapping between</em>
<a id="L260" name="L260"></a> 260     <em class="comment">// characters and collation elements-- this class handles that).</em>
<a id="L261" name="L261"></a> 261     <em class="comment">// CollationElementIterator depends on RBCollationTables, which contains the</em>
<a id="L262" name="L262"></a> 262     <em class="comment">// collator's static state.  RBCollationTables contains the actual data</em>
<a id="L263" name="L263"></a> 263     <em class="comment">// tables specifying the collation order of characters for a particular locale</em>
<a id="L264" name="L264"></a> 264     <em class="comment">// or use.  It also contains the base logic that CollationElementIterator</em>
<a id="L265" name="L265"></a> 265     <em class="comment">// uses to map from characters to collation elements.  A single RBCollationTables</em>
<a id="L266" name="L266"></a> 266     <em class="comment">// object is shared among all RuleBasedCollators for the same locale, and</em>
<a id="L267" name="L267"></a> 267     <em class="comment">// thus by all the CollationElementIterators they create.</em>
<a id="L268" name="L268"></a> 268 
<div class="comment">
      RuleBasedCollator constructor.  This takes the table rules and builds
      a collation table out of them.  Please see RuleBasedCollator class
      description for more details on the collation rule syntax.
      @see java.util.Locale
      @param rules the collation rules to build the collation table from.
      @exception ParseException A format exception
      will be thrown if the build process of the rules fails. For
      example, build rule "a &lt; ? &lt; d" will cause the constructor to
      throw the ParseException because the '?' is not quoted.</div>
<a id="L280" name="L280"></a> 280     <strong class="reserved">public</strong> RuleBasedCollator(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> rules) <strong class="reserved">throws</strong> <a href="../D/6624.html" title="Multiple defined in 3 places.">ParseException</a> <em class="brace">{</em>
<a id="L281" name="L281"></a> 281         <strong class="reserved">this</strong>(rules, <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.CANONICAL_DECOMPOSITION);
<a id="L282" name="L282"></a> 282     <em class="brace">}</em>
<a id="L283" name="L283"></a> 283 
<div class="comment">
      RuleBasedCollator constructor.  This takes the table rules and builds
      a collation table out of them.  Please see RuleBasedCollator class
      description for more details on the collation rule syntax.
      @see java.util.Locale
      @param rules the collation rules to build the collation table from.
      @param decomp the decomposition strength used to build the
      collation table and to perform comparisons.
      @exception ParseException A format exception
      will be thrown if the build process of the rules fails. For
      example, build rule "a &lt; ? &lt; d" will cause the constructor to
      throw the ParseException because the '?' is not quoted.</div>
<a id="L297" name="L297"></a> 297     RuleBasedCollator(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> rules, <strong class="reserved">int</strong> decomp) <strong class="reserved">throws</strong> <a href="../D/6624.html" title="Multiple defined in 3 places.">ParseException</a> <em class="brace">{</em>
<a id="L298" name="L298"></a> 298         <a href="../S/2466.html#L363" title="Defined at 363 in src/java/text/Collator.java.">setStrength</a>(<a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.TERTIARY);
<a id="L299" name="L299"></a> 299         <a href="../S/2466.html#L407" title="Defined at 407 in src/java/text/Collator.java.">setDecomposition</a>(decomp);
<a id="L300" name="L300"></a> 300         tables = <strong class="reserved">new</strong> <a href="../S/2453.html#L51" title="Defined at 51 in src/java/text/RBCollationTables.java.">RBCollationTables</a>(rules, decomp);
<a id="L301" name="L301"></a> 301     <em class="brace">}</em>
<a id="L302" name="L302"></a> 302 
<div class="comment">
      "Copy constructor."  Used in clone() for performance.</div>
<a id="L306" name="L306"></a> 306     <strong class="reserved">private</strong> <a href="../S/2461.html#L246" title="Defined at 246 in src/java/text/RuleBasedCollator.java.">RuleBasedCollator</a>(RuleBasedCollator that) <em class="brace">{</em>
<a id="L307" name="L307"></a> 307         <a href="../S/2466.html#L363" title="Defined at 363 in src/java/text/Collator.java.">setStrength</a>(that.<a href="../D/22764.html" title="Multiple defined in 3 places.">getStrength</a>());
<a id="L308" name="L308"></a> 308         <a href="../S/2466.html#L407" title="Defined at 407 in src/java/text/Collator.java.">setDecomposition</a>(that.<a href="../S/2466.html#L392" title="Defined at 392 in src/java/text/Collator.java.">getDecomposition</a>());
<a id="L309" name="L309"></a> 309         tables = that.tables;
<a id="L310" name="L310"></a> 310     <em class="brace">}</em>
<a id="L311" name="L311"></a> 311 
<div class="comment">
      Gets the table-based rules for the collation object.
      @return returns the collation rules that the table collation object
      was created from.</div>
<a id="L317" name="L317"></a> 317     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/18809.html" title="Multiple referred from 32 places.">getRules</a>()
<a id="L318" name="L318"></a> 318     <em class="brace">{</em>
<a id="L319" name="L319"></a> 319         <strong class="reserved">return</strong> tables.<a href="../D/22187.html" title="Multiple defined in 8 places.">getRules</a>();
<a id="L320" name="L320"></a> 320     <em class="brace">}</em>
<a id="L321" name="L321"></a> 321 
<div class="comment">
      Returns a CollationElementIterator for the given String.
      @param source the string to be collated
      @return a <code>CollationElementIterator</code> object
      @see java.text.CollationElementIterator</div>
<a id="L329" name="L329"></a> 329     <strong class="reserved">public</strong> <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a> <a href="../R/15649.html" title="Multiple referred from 5 places.">getCollationElementIterator</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>) <em class="brace">{</em>
<a id="L330" name="L330"></a> 330         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>( <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <strong class="reserved">this</strong> );
<a id="L331" name="L331"></a> 331     <em class="brace">}</em>
<a id="L332" name="L332"></a> 332 
<div class="comment">
      Returns a CollationElementIterator for the given CharacterIterator.
      @param source the character iterator to be collated
      @return a <code>CollationElementIterator</code> object
      @see java.text.CollationElementIterator
      @since 1.2</div>
<a id="L341" name="L341"></a> 341     <strong class="reserved">public</strong> <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a> <a href="../R/15649.html" title="Multiple referred from 5 places.">getCollationElementIterator</a>(
<a id="L342" name="L342"></a> 342                                                 <a href="../D/1412.html" title="Multiple defined in 2 places.">CharacterIterator</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>) <em class="brace">{</em>
<a id="L343" name="L343"></a> 343         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>( <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <strong class="reserved">this</strong> );
<a id="L344" name="L344"></a> 344     <em class="brace">}</em>
<a id="L345" name="L345"></a> 345 
<div class="comment">
      Compares the character data stored in two different strings based on the
      collation rules.  Returns information about whether a string is less
      than, greater than or equal to another string in a language.
      This can be overriden in a subclass.
      @exception NullPointerException if <code>source</code> or <code>target</code> is null.</div>
<a id="L354" name="L354"></a> 354     <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">int</strong> <a href="../R/11691.html" title="Multiple referred from 208 places.">compare</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>)
<a id="L355" name="L355"></a> 355     <em class="brace">{</em>
<a id="L356" name="L356"></a> 356         <strong class="reserved">if</strong> (<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> == <strong class="reserved">null</strong> || <a href="../D/35216.html" title="Multiple defined in 4 places.">target</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L357" name="L357"></a> 357             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L358" name="L358"></a> 358         <em class="brace">}</em>
<a id="L359" name="L359"></a> 359 
<a id="L360" name="L360"></a> 360         <em class="comment">// The basic algorithm here is that we use CollationElementIterators</em>
<a id="L361" name="L361"></a> 361         <em class="comment">// to step through both the source and target strings.  We compare each</em>
<a id="L362" name="L362"></a> 362         <em class="comment">// collation element in the source string against the corresponding one</em>
<a id="L363" name="L363"></a> 363         <em class="comment">// in the target, checking for differences.</em>
<a id="L364" name="L364"></a> 364         <em class="comment">//</em>
<a id="L365" name="L365"></a> 365         <em class="comment">// If a difference is found, we set &lt;result&gt; to LESS or GREATER to</em>
<a id="L366" name="L366"></a> 366         <em class="comment">// indicate whether the source string is less or greater than the target.</em>
<a id="L367" name="L367"></a> 367         <em class="comment">//</em>
<a id="L368" name="L368"></a> 368         <em class="comment">// However, it's not that simple.  If we find a tertiary difference</em>
<a id="L369" name="L369"></a> 369         <em class="comment">// (e.g. 'A' vs. 'a') near the beginning of a string, it can be</em>
<a id="L370" name="L370"></a> 370         <em class="comment">// overridden by a primary difference (e.g. "A" vs. "B") later in</em>
<a id="L371" name="L371"></a> 371         <em class="comment">// the string.  For example, "AA" &lt; "aB", even though 'A' &gt; 'a'.</em>
<a id="L372" name="L372"></a> 372         <em class="comment">//</em>
<a id="L373" name="L373"></a> 373         <em class="comment">// To keep track of this, we use strengthResult to keep track of the</em>
<a id="L374" name="L374"></a> 374         <em class="comment">// strength of the most significant difference that has been found</em>
<a id="L375" name="L375"></a> 375         <em class="comment">// so far.  When we find a difference whose strength is greater than</em>
<a id="L376" name="L376"></a> 376         <em class="comment">// strengthResult, it overrides the last difference (if any) that</em>
<a id="L377" name="L377"></a> 377         <em class="comment">// was found.</em>
<a id="L378" name="L378"></a> 378 
<a id="L379" name="L379"></a> 379         <strong class="reserved">int</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.EQUAL;
<a id="L380" name="L380"></a> 380 
<a id="L381" name="L381"></a> 381         <strong class="reserved">if</strong> (sourceCursor == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L382" name="L382"></a> 382             sourceCursor = <a href="../D/17769.html" title="Multiple defined in 2 places.">getCollationElementIterator</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L383" name="L383"></a> 383         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L384" name="L384"></a> 384             sourceCursor.<a href="../D/34097.html" title="Multiple defined in 21 places.">setText</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L385" name="L385"></a> 385         <em class="brace">}</em>
<a id="L386" name="L386"></a> 386         <strong class="reserved">if</strong> (targetCursor == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L387" name="L387"></a> 387             targetCursor = <a href="../D/17769.html" title="Multiple defined in 2 places.">getCollationElementIterator</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>);
<a id="L388" name="L388"></a> 388         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L389" name="L389"></a> 389             targetCursor.<a href="../D/34097.html" title="Multiple defined in 21 places.">setText</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>);
<a id="L390" name="L390"></a> 390         <em class="brace">}</em>
<a id="L391" name="L391"></a> 391 
<a id="L392" name="L392"></a> 392         <strong class="reserved">int</strong> sOrder = 0, tOrder = 0;
<a id="L393" name="L393"></a> 393 
<a id="L394" name="L394"></a> 394         <strong class="reserved">boolean</strong> initialCheckSecTer = <a href="../D/22764.html" title="Multiple defined in 3 places.">getStrength</a>() &gt;= <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.SECONDARY;
<a id="L395" name="L395"></a> 395         <strong class="reserved">boolean</strong> checkSecTer = initialCheckSecTer;
<a id="L396" name="L396"></a> 396         <strong class="reserved">boolean</strong> checkTertiary = <a href="../D/22764.html" title="Multiple defined in 3 places.">getStrength</a>() &gt;= <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.TERTIARY;
<a id="L397" name="L397"></a> 397 
<a id="L398" name="L398"></a> 398         <strong class="reserved">boolean</strong> gets = <strong class="reserved">true</strong>, gett = <strong class="reserved">true</strong>;
<a id="L399" name="L399"></a> 399 
<a id="L400" name="L400"></a> 400         <strong class="reserved">while</strong>(<strong class="reserved">true</strong>) <em class="brace">{</em>
<a id="L401" name="L401"></a> 401             <em class="comment">// Get the next collation element in each of the strings, unless</em>
<a id="L402" name="L402"></a> 402             <em class="comment">// we've been requested to skip it.</em>
<a id="L403" name="L403"></a> 403             <strong class="reserved">if</strong> (gets) sOrder = sourceCursor.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>(); <strong class="reserved">else</strong> gets = <strong class="reserved">true</strong>;
<a id="L404" name="L404"></a> 404             <strong class="reserved">if</strong> (gett) tOrder = targetCursor.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>(); <strong class="reserved">else</strong> gett = <strong class="reserved">true</strong>;
<a id="L405" name="L405"></a> 405 
<a id="L406" name="L406"></a> 406             <em class="comment">// If we've hit the end of one of the strings, jump out of the loop</em>
<a id="L407" name="L407"></a> 407             <strong class="reserved">if</strong> ((sOrder == <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER)||
<a id="L408" name="L408"></a> 408                 (tOrder == <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER))
<a id="L409" name="L409"></a> 409                 <strong class="reserved">break</strong>;
<a id="L410" name="L410"></a> 410 
<a id="L411" name="L411"></a> 411             <strong class="reserved">int</strong> pSOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L361" title="Defined at 361 in src/java/text/CollationElementIterator.java.">primaryOrder</a>(sOrder);
<a id="L412" name="L412"></a> 412             <strong class="reserved">int</strong> pTOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L361" title="Defined at 361 in src/java/text/CollationElementIterator.java.">primaryOrder</a>(tOrder);
<a id="L413" name="L413"></a> 413 
<a id="L414" name="L414"></a> 414             <em class="comment">// If there's no difference at this position, we can skip it</em>
<a id="L415" name="L415"></a> 415             <strong class="reserved">if</strong> (sOrder == tOrder) <em class="brace">{</em>
<a id="L416" name="L416"></a> 416                 <strong class="reserved">if</strong> (tables.<a href="../S/2453.html#L141" title="Defined at 141 in src/java/text/RBCollationTables.java.">isFrenchSec</a>() &amp;&amp; pSOrder != 0) <em class="brace">{</em>
<a id="L417" name="L417"></a> 417                     <strong class="reserved">if</strong> (!checkSecTer) <em class="brace">{</em>
<a id="L418" name="L418"></a> 418                         <em class="comment">// in french, a secondary difference more to the right is stronger,</em>
<a id="L419" name="L419"></a> 419                         <em class="comment">// so accents have to be checked with each base element</em>
<a id="L420" name="L420"></a> 420                         checkSecTer = initialCheckSecTer;
<a id="L421" name="L421"></a> 421                         <em class="comment">// but tertiary differences are less important than the first</em>
<a id="L422" name="L422"></a> 422                         <em class="comment">// secondary difference, so checking tertiary remains disabled</em>
<a id="L423" name="L423"></a> 423                         checkTertiary = <strong class="reserved">false</strong>;
<a id="L424" name="L424"></a> 424                     <em class="brace">}</em>
<a id="L425" name="L425"></a> 425                 <em class="brace">}</em>
<a id="L426" name="L426"></a> 426                 <strong class="reserved">continue</strong>;
<a id="L427" name="L427"></a> 427             <em class="brace">}</em>
<a id="L428" name="L428"></a> 428 
<a id="L429" name="L429"></a> 429             <em class="comment">// Compare primary differences first.</em>
<a id="L430" name="L430"></a> 430             <strong class="reserved">if</strong> ( pSOrder != pTOrder )
<a id="L431" name="L431"></a> 431             <em class="brace">{</em>
<a id="L432" name="L432"></a> 432                 <strong class="reserved">if</strong> (sOrder == 0) <em class="brace">{</em>
<a id="L433" name="L433"></a> 433                     <em class="comment">// The entire source element is ignorable.</em>
<a id="L434" name="L434"></a> 434                     <em class="comment">// Skip to the next source element, but don't fetch another target element.</em>
<a id="L435" name="L435"></a> 435                     gett = <strong class="reserved">false</strong>;
<a id="L436" name="L436"></a> 436                     <strong class="reserved">continue</strong>;
<a id="L437" name="L437"></a> 437                 <em class="brace">}</em>
<a id="L438" name="L438"></a> 438                 <strong class="reserved">if</strong> (tOrder == 0) <em class="brace">{</em>
<a id="L439" name="L439"></a> 439                     gets = <strong class="reserved">false</strong>;
<a id="L440" name="L440"></a> 440                     <strong class="reserved">continue</strong>;
<a id="L441" name="L441"></a> 441                 <em class="brace">}</em>
<a id="L442" name="L442"></a> 442 
<a id="L443" name="L443"></a> 443                 <em class="comment">// The source and target elements aren't ignorable, but it's still possible</em>
<a id="L444" name="L444"></a> 444                 <em class="comment">// for the primary component of one of the elements to be ignorable....</em>
<a id="L445" name="L445"></a> 445 
<a id="L446" name="L446"></a> 446                 <strong class="reserved">if</strong> (pSOrder == 0)  <em class="comment">// primary order in source is ignorable</em>
<a id="L447" name="L447"></a> 447                 <em class="brace">{</em>
<a id="L448" name="L448"></a> 448                     <em class="comment">// The source's primary is ignorable, but the target's isn't.  We treat ignorables</em>
<a id="L449" name="L449"></a> 449                     <em class="comment">// as a secondary difference, so remember that we found one.</em>
<a id="L450" name="L450"></a> 450                     <strong class="reserved">if</strong> (checkSecTer) <em class="brace">{</em>
<a id="L451" name="L451"></a> 451                         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.GREATER;  <em class="comment">// (strength is SECONDARY)</em>
<a id="L452" name="L452"></a> 452                         checkSecTer = <strong class="reserved">false</strong>;
<a id="L453" name="L453"></a> 453                     <em class="brace">}</em>
<a id="L454" name="L454"></a> 454                     <em class="comment">// Skip to the next source element, but don't fetch another target element.</em>
<a id="L455" name="L455"></a> 455                     gett = <strong class="reserved">false</strong>;
<a id="L456" name="L456"></a> 456                 <em class="brace">}</em>
<a id="L457" name="L457"></a> 457                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (pTOrder == 0)
<a id="L458" name="L458"></a> 458                 <em class="brace">{</em>
<a id="L459" name="L459"></a> 459                     <em class="comment">// record differences - see the comment above.</em>
<a id="L460" name="L460"></a> 460                     <strong class="reserved">if</strong> (checkSecTer) <em class="brace">{</em>
<a id="L461" name="L461"></a> 461                         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.LESS;  <em class="comment">// (strength is SECONDARY)</em>
<a id="L462" name="L462"></a> 462                         checkSecTer = <strong class="reserved">false</strong>;
<a id="L463" name="L463"></a> 463                     <em class="brace">}</em>
<a id="L464" name="L464"></a> 464                     <em class="comment">// Skip to the next source element, but don't fetch another target element.</em>
<a id="L465" name="L465"></a> 465                     gets = <strong class="reserved">false</strong>;
<a id="L466" name="L466"></a> 466                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L467" name="L467"></a> 467                     <em class="comment">// Neither of the orders is ignorable, and we already know that the primary</em>
<a id="L468" name="L468"></a> 468                     <em class="comment">// orders are different because of the (pSOrder != pTOrder) test above.</em>
<a id="L469" name="L469"></a> 469                     <em class="comment">// Record the difference and stop the comparison.</em>
<a id="L470" name="L470"></a> 470                     <strong class="reserved">if</strong> (pSOrder &lt; pTOrder) <em class="brace">{</em>
<a id="L471" name="L471"></a> 471                         <strong class="reserved">return</strong> <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.LESS;  <em class="comment">// (strength is PRIMARY)</em>
<a id="L472" name="L472"></a> 472                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L473" name="L473"></a> 473                         <strong class="reserved">return</strong> <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.GREATER;  <em class="comment">// (strength is PRIMARY)</em>
<a id="L474" name="L474"></a> 474                     <em class="brace">}</em>
<a id="L475" name="L475"></a> 475                 <em class="brace">}</em>
<a id="L476" name="L476"></a> 476             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em> <em class="comment">// else of if ( pSOrder != pTOrder )</em>
<a id="L477" name="L477"></a> 477                 <em class="comment">// primary order is the same, but complete order is different. So there</em>
<a id="L478" name="L478"></a> 478                 <em class="comment">// are no base elements at this point, only ignorables (Since the strings are</em>
<a id="L479" name="L479"></a> 479                 <em class="comment">// normalized)</em>
<a id="L480" name="L480"></a> 480 
<a id="L481" name="L481"></a> 481                 <strong class="reserved">if</strong> (checkSecTer) <em class="brace">{</em>
<a id="L482" name="L482"></a> 482                     <em class="comment">// a secondary or tertiary difference may still matter</em>
<a id="L483" name="L483"></a> 483                     <strong class="reserved">short</strong> secSOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L371" title="Defined at 371 in src/java/text/CollationElementIterator.java.">secondaryOrder</a>(sOrder);
<a id="L484" name="L484"></a> 484                     <strong class="reserved">short</strong> secTOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L371" title="Defined at 371 in src/java/text/CollationElementIterator.java.">secondaryOrder</a>(tOrder);
<a id="L485" name="L485"></a> 485                     <strong class="reserved">if</strong> (secSOrder != secTOrder) <em class="brace">{</em>
<a id="L486" name="L486"></a> 486                         <em class="comment">// there is a secondary difference</em>
<a id="L487" name="L487"></a> 487                         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (secSOrder &lt; secTOrder) ? <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.LESS : <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.GREATER;
<a id="L488" name="L488"></a> 488                                                 <em class="comment">// (strength is SECONDARY)</em>
<a id="L489" name="L489"></a> 489                         checkSecTer = <strong class="reserved">false</strong>;
<a id="L490" name="L490"></a> 490                         <em class="comment">// (even in french, only the first secondary difference within</em>
<a id="L491" name="L491"></a> 491                         <em class="comment">//  a base character matters)</em>
<a id="L492" name="L492"></a> 492                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L493" name="L493"></a> 493                         <strong class="reserved">if</strong> (checkTertiary) <em class="brace">{</em>
<a id="L494" name="L494"></a> 494                             <em class="comment">// a tertiary difference may still matter</em>
<a id="L495" name="L495"></a> 495                             <strong class="reserved">short</strong> terSOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L381" title="Defined at 381 in src/java/text/CollationElementIterator.java.">tertiaryOrder</a>(sOrder);
<a id="L496" name="L496"></a> 496                             <strong class="reserved">short</strong> terTOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L381" title="Defined at 381 in src/java/text/CollationElementIterator.java.">tertiaryOrder</a>(tOrder);
<a id="L497" name="L497"></a> 497                             <strong class="reserved">if</strong> (terSOrder != terTOrder) <em class="brace">{</em>
<a id="L498" name="L498"></a> 498                                 <em class="comment">// there is a tertiary difference</em>
<a id="L499" name="L499"></a> 499                                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (terSOrder &lt; terTOrder) ? <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.LESS : <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.GREATER;
<a id="L500" name="L500"></a> 500                                                 <em class="comment">// (strength is TERTIARY)</em>
<a id="L501" name="L501"></a> 501                                 checkTertiary = <strong class="reserved">false</strong>;
<a id="L502" name="L502"></a> 502                             <em class="brace">}</em>
<a id="L503" name="L503"></a> 503                         <em class="brace">}</em>
<a id="L504" name="L504"></a> 504                     <em class="brace">}</em>
<a id="L505" name="L505"></a> 505                 <em class="brace">}</em> <em class="comment">// if (checkSecTer)</em>
<a id="L506" name="L506"></a> 506 
<a id="L507" name="L507"></a> 507             <em class="brace">}</em>  <em class="comment">// if ( pSOrder != pTOrder )</em>
<a id="L508" name="L508"></a> 508         <em class="brace">}</em> <em class="comment">// while()</em>
<a id="L509" name="L509"></a> 509 
<a id="L510" name="L510"></a> 510         <strong class="reserved">if</strong> (sOrder != <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER) <em class="brace">{</em>
<a id="L511" name="L511"></a> 511             <em class="comment">// (tOrder must be CollationElementIterator::NULLORDER,</em>
<a id="L512" name="L512"></a> 512             <em class="comment">//  since this point is only reached when sOrder or tOrder is NULLORDER.)</em>
<a id="L513" name="L513"></a> 513             <em class="comment">// The source string has more elements, but the target string hasn't.</em>
<a id="L514" name="L514"></a> 514             <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L515" name="L515"></a> 515                 <strong class="reserved">if</strong> (<a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L361" title="Defined at 361 in src/java/text/CollationElementIterator.java.">primaryOrder</a>(sOrder) != 0) <em class="brace">{</em>
<a id="L516" name="L516"></a> 516                     <em class="comment">// We found an additional non-ignorable base character in the source string.</em>
<a id="L517" name="L517"></a> 517                     <em class="comment">// This is a primary difference, so the source is greater</em>
<a id="L518" name="L518"></a> 518                     <strong class="reserved">return</strong> <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.GREATER; <em class="comment">// (strength is PRIMARY)</em>
<a id="L519" name="L519"></a> 519                 <em class="brace">}</em>
<a id="L520" name="L520"></a> 520                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L371" title="Defined at 371 in src/java/text/CollationElementIterator.java.">secondaryOrder</a>(sOrder) != 0) <em class="brace">{</em>
<a id="L521" name="L521"></a> 521                     <em class="comment">// Additional secondary elements mean the source string is greater</em>
<a id="L522" name="L522"></a> 522                     <strong class="reserved">if</strong> (checkSecTer) <em class="brace">{</em>
<a id="L523" name="L523"></a> 523                         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.GREATER;  <em class="comment">// (strength is SECONDARY)</em>
<a id="L524" name="L524"></a> 524                         checkSecTer = <strong class="reserved">false</strong>;
<a id="L525" name="L525"></a> 525                     <em class="brace">}</em>
<a id="L526" name="L526"></a> 526                 <em class="brace">}</em>
<a id="L527" name="L527"></a> 527             <em class="brace">}</em> <strong class="reserved">while</strong> ((sOrder = sourceCursor.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>()) != <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER);
<a id="L528" name="L528"></a> 528         <em class="brace">}</em>
<a id="L529" name="L529"></a> 529         <strong class="reserved">else</strong> <strong class="reserved">if</strong> (tOrder != <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER) <em class="brace">{</em>
<a id="L530" name="L530"></a> 530             <em class="comment">// The target string has more elements, but the source string hasn't.</em>
<a id="L531" name="L531"></a> 531             <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L532" name="L532"></a> 532                 <strong class="reserved">if</strong> (<a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L361" title="Defined at 361 in src/java/text/CollationElementIterator.java.">primaryOrder</a>(tOrder) != 0)
<a id="L533" name="L533"></a> 533                     <em class="comment">// We found an additional non-ignorable base character in the target string.</em>
<a id="L534" name="L534"></a> 534                     <em class="comment">// This is a primary difference, so the source is less</em>
<a id="L535" name="L535"></a> 535                     <strong class="reserved">return</strong> <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.LESS; <em class="comment">// (strength is PRIMARY)</em>
<a id="L536" name="L536"></a> 536                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L371" title="Defined at 371 in src/java/text/CollationElementIterator.java.">secondaryOrder</a>(tOrder) != 0) <em class="brace">{</em>
<a id="L537" name="L537"></a> 537                     <em class="comment">// Additional secondary elements in the target mean the source string is less</em>
<a id="L538" name="L538"></a> 538                     <strong class="reserved">if</strong> (checkSecTer) <em class="brace">{</em>
<a id="L539" name="L539"></a> 539                         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.LESS;  <em class="comment">// (strength is SECONDARY)</em>
<a id="L540" name="L540"></a> 540                         checkSecTer = <strong class="reserved">false</strong>;
<a id="L541" name="L541"></a> 541                     <em class="brace">}</em>
<a id="L542" name="L542"></a> 542                 <em class="brace">}</em>
<a id="L543" name="L543"></a> 543             <em class="brace">}</em> <strong class="reserved">while</strong> ((tOrder = targetCursor.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>()) != <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER);
<a id="L544" name="L544"></a> 544         <em class="brace">}</em>
<a id="L545" name="L545"></a> 545 
<a id="L546" name="L546"></a> 546         <em class="comment">// For IDENTICAL comparisons, we use a bitwise character comparison</em>
<a id="L547" name="L547"></a> 547         <em class="comment">// as a tiebreaker if all else is equal</em>
<a id="L548" name="L548"></a> 548         <strong class="reserved">if</strong> (<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> == 0 &amp;&amp; <a href="../D/22764.html" title="Multiple defined in 3 places.">getStrength</a>() == IDENTICAL) <em class="brace">{</em>
<a id="L549" name="L549"></a> 549             <strong class="reserved">int</strong> mode = <a href="../S/2466.html#L392" title="Defined at 392 in src/java/text/Collator.java.">getDecomposition</a>();
<a id="L550" name="L550"></a> 550             <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../S/2470.html#L122" title="Defined at 122 in src/java/text/Normalizer.java.">Form</a> <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>;
<a id="L551" name="L551"></a> 551             <strong class="reserved">if</strong> (mode == CANONICAL_DECOMPOSITION) <em class="brace">{</em>
<a id="L552" name="L552"></a> 552                 <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../S/2470.html#L122" title="Defined at 122 in src/java/text/Normalizer.java.">Form</a>.NFD;
<a id="L553" name="L553"></a> 553             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (mode == FULL_DECOMPOSITION) <em class="brace">{</em>
<a id="L554" name="L554"></a> 554                 <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a> = <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../S/2470.html#L122" title="Defined at 122 in src/java/text/Normalizer.java.">Form</a>.NFKD;
<a id="L555" name="L555"></a> 555             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L556" name="L556"></a> 556                 <strong class="reserved">return</strong> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>.<a href="../D/13068.html" title="Multiple defined in 86 places.">compareTo</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>);
<a id="L557" name="L557"></a> 557             <em class="brace">}</em>
<a id="L558" name="L558"></a> 558 
<a id="L559" name="L559"></a> 559             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> sourceDecomposition = <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>);
<a id="L560" name="L560"></a> 560             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> targetDecomposition = <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(<a href="../D/35216.html" title="Multiple defined in 4 places.">target</a>, <a href="../S/1616.html#L125" title="Defined at 125 in src/java/lang/invoke/MethodType.java.">form</a>);
<a id="L561" name="L561"></a> 561             <strong class="reserved">return</strong> sourceDecomposition.<a href="../D/13068.html" title="Multiple defined in 86 places.">compareTo</a>(targetDecomposition);
<a id="L562" name="L562"></a> 562         <em class="brace">}</em>
<a id="L563" name="L563"></a> 563         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L564" name="L564"></a> 564     <em class="brace">}</em>
<a id="L565" name="L565"></a> 565 
<div class="comment">
      Transforms the string into a series of characters that can be compared
      with CollationKey.compareTo. This overrides java.text.Collator.getCollationKey.
      It can be overriden in a subclass.</div>
<a id="L571" name="L571"></a> 571     <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <a href="../S/2457.html#L100" title="Defined at 100 in src/java/text/CollationKey.java.">CollationKey</a> <a href="../S/5834.html#L60" title="Referred from 60 in src/com/sun/org/apache/xml/internal/utils/StringComparable.java.">getCollationKey</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>)
<a id="L572" name="L572"></a> 572     <em class="brace">{</em>
<a id="L573" name="L573"></a> 573         <em class="comment">//</em>
<a id="L574" name="L574"></a> 574         <em class="comment">// The basic algorithm here is to find all of the collation elements for each</em>
<a id="L575" name="L575"></a> 575         <em class="comment">// character in the source string, convert them to a char representation,</em>
<a id="L576" name="L576"></a> 576         <em class="comment">// and put them into the collation key.  But it's trickier than that.</em>
<a id="L577" name="L577"></a> 577         <em class="comment">// Each collation element in a string has three components: primary (A vs B),</em>
<a id="L578" name="L578"></a> 578         <em class="comment">// secondary (A vs A-acute), and tertiary (A' vs a); and a primary difference</em>
<a id="L579" name="L579"></a> 579         <em class="comment">// at the end of a string takes precedence over a secondary or tertiary</em>
<a id="L580" name="L580"></a> 580         <em class="comment">// difference earlier in the string.</em>
<a id="L581" name="L581"></a> 581         <em class="comment">//</em>
<a id="L582" name="L582"></a> 582         <em class="comment">// To account for this, we put all of the primary orders at the beginning of the</em>
<a id="L583" name="L583"></a> 583         <em class="comment">// string, followed by the secondary and tertiary orders, separated by nulls.</em>
<a id="L584" name="L584"></a> 584         <em class="comment">//</em>
<a id="L585" name="L585"></a> 585         <em class="comment">// Here's a hypothetical example, with the collation element represented as</em>
<a id="L586" name="L586"></a> 586         <em class="comment">// a three-digit number, one digit for primary, one for secondary, etc.</em>
<a id="L587" name="L587"></a> 587         <em class="comment">//</em>
<a id="L588" name="L588"></a> 588         <em class="comment">// String:              A     a     B   \u00e9 &lt;--(e-acute)</em>
<a id="L589" name="L589"></a> 589         <em class="comment">// Collation Elements: 101   100   201  510</em>
<a id="L590" name="L590"></a> 590         <em class="comment">//</em>
<a id="L591" name="L591"></a> 591         <em class="comment">// Collation Key:      1125&lt;null&gt;0001&lt;null&gt;1010</em>
<a id="L592" name="L592"></a> 592         <em class="comment">//</em>
<a id="L593" name="L593"></a> 593         <em class="comment">// To make things even trickier, secondary differences (accent marks) are compared</em>
<a id="L594" name="L594"></a> 594         <em class="comment">// starting at the *end* of the string in languages with French secondary ordering.</em>
<a id="L595" name="L595"></a> 595         <em class="comment">// But when comparing the accent marks on a single base character, they are compared</em>
<a id="L596" name="L596"></a> 596         <em class="comment">// from the beginning.  To handle this, we reverse all of the accents that belong</em>
<a id="L597" name="L597"></a> 597         <em class="comment">// to each base character, then we reverse the entire string of secondary orderings</em>
<a id="L598" name="L598"></a> 598         <em class="comment">// at the end.  Taking the same example above, a French collator might return</em>
<a id="L599" name="L599"></a> 599         <em class="comment">// this instead:</em>
<a id="L600" name="L600"></a> 600         <em class="comment">//</em>
<a id="L601" name="L601"></a> 601         <em class="comment">// Collation Key:      1125&lt;null&gt;1000&lt;null&gt;1010</em>
<a id="L602" name="L602"></a> 602         <em class="comment">//</em>
<a id="L603" name="L603"></a> 603         <strong class="reserved">if</strong> (<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> == <strong class="reserved">null</strong>)
<a id="L604" name="L604"></a> 604             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L605" name="L605"></a> 605 
<a id="L606" name="L606"></a> 606         <strong class="reserved">if</strong> (primResult == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L607" name="L607"></a> 607             primResult = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L608" name="L608"></a> 608             secResult = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L609" name="L609"></a> 609             terResult = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L610" name="L610"></a> 610         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L611" name="L611"></a> 611             primResult.<a href="../D/33077.html" title="Multiple defined in 10 places.">setLength</a>(0);
<a id="L612" name="L612"></a> 612             secResult.<a href="../D/33077.html" title="Multiple defined in 10 places.">setLength</a>(0);
<a id="L613" name="L613"></a> 613             terResult.<a href="../D/33077.html" title="Multiple defined in 10 places.">setLength</a>(0);
<a id="L614" name="L614"></a> 614         <em class="brace">}</em>
<a id="L615" name="L615"></a> 615         <strong class="reserved">int</strong> <a href="../D/28576.html" title="Multiple defined in 69 places.">order</a> = 0;
<a id="L616" name="L616"></a> 616         <strong class="reserved">boolean</strong> compareSec = (<a href="../D/22764.html" title="Multiple defined in 3 places.">getStrength</a>() &gt;= <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.SECONDARY);
<a id="L617" name="L617"></a> 617         <strong class="reserved">boolean</strong> compareTer = (<a href="../D/22764.html" title="Multiple defined in 3 places.">getStrength</a>() &gt;= <a href="../S/2466.html#L128" title="Defined at 128 in src/java/text/Collator.java.">Collator</a>.TERTIARY);
<a id="L618" name="L618"></a> 618         <strong class="reserved">int</strong> secOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER;
<a id="L619" name="L619"></a> 619         <strong class="reserved">int</strong> terOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER;
<a id="L620" name="L620"></a> 620         <strong class="reserved">int</strong> preSecIgnore = 0;
<a id="L621" name="L621"></a> 621 
<a id="L622" name="L622"></a> 622         <strong class="reserved">if</strong> (sourceCursor == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L623" name="L623"></a> 623             sourceCursor = <a href="../D/17769.html" title="Multiple defined in 2 places.">getCollationElementIterator</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L624" name="L624"></a> 624         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L625" name="L625"></a> 625             sourceCursor.<a href="../D/34097.html" title="Multiple defined in 21 places.">setText</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L626" name="L626"></a> 626         <em class="brace">}</em>
<a id="L627" name="L627"></a> 627 
<a id="L628" name="L628"></a> 628         <em class="comment">// walk through each character</em>
<a id="L629" name="L629"></a> 629         <strong class="reserved">while</strong> ((<a href="../D/28576.html" title="Multiple defined in 69 places.">order</a> = sourceCursor.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>()) !=
<a id="L630" name="L630"></a> 630                <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.NULLORDER)
<a id="L631" name="L631"></a> 631         <em class="brace">{</em>
<a id="L632" name="L632"></a> 632             secOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L371" title="Defined at 371 in src/java/text/CollationElementIterator.java.">secondaryOrder</a>(<a href="../D/28576.html" title="Multiple defined in 69 places.">order</a>);
<a id="L633" name="L633"></a> 633             terOrder = <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L381" title="Defined at 381 in src/java/text/CollationElementIterator.java.">tertiaryOrder</a>(<a href="../D/28576.html" title="Multiple defined in 69 places.">order</a>);
<a id="L634" name="L634"></a> 634             <strong class="reserved">if</strong> (!<a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L637" title="Defined at 637 in src/java/text/CollationElementIterator.java.">isIgnorable</a>(<a href="../D/28576.html" title="Multiple defined in 69 places.">order</a>))
<a id="L635" name="L635"></a> 635             <em class="brace">{</em>
<a id="L636" name="L636"></a> 636                 primResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>) (<a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a>.<a href="../S/2489.html#L361" title="Defined at 361 in src/java/text/CollationElementIterator.java.">primaryOrder</a>(<a href="../D/28576.html" title="Multiple defined in 69 places.">order</a>)
<a id="L637" name="L637"></a> 637                                     + COLLATIONKEYOFFSET));
<a id="L638" name="L638"></a> 638 
<a id="L639" name="L639"></a> 639                 <strong class="reserved">if</strong> (compareSec) <em class="brace">{</em>
<a id="L640" name="L640"></a> 640                     <em class="comment">//</em>
<a id="L641" name="L641"></a> 641                     <em class="comment">// accumulate all of the ignorable/secondary characters attached</em>
<a id="L642" name="L642"></a> 642                     <em class="comment">// to a given base character</em>
<a id="L643" name="L643"></a> 643                     <em class="comment">//</em>
<a id="L644" name="L644"></a> 644                     <strong class="reserved">if</strong> (tables.<a href="../S/2453.html#L141" title="Defined at 141 in src/java/text/RBCollationTables.java.">isFrenchSec</a>() &amp;&amp; preSecIgnore &lt; secResult.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <em class="brace">{</em>
<a id="L645" name="L645"></a> 645                         <em class="comment">//</em>
<a id="L646" name="L646"></a> 646                         <em class="comment">// We're doing reversed secondary ordering and we've hit a base</em>
<a id="L647" name="L647"></a> 647                         <em class="comment">// (non-ignorable) character.  Reverse any secondary orderings</em>
<a id="L648" name="L648"></a> 648                         <em class="comment">// that applied to the last base character.  (see block comment above.)</em>
<a id="L649" name="L649"></a> 649                         <em class="comment">//</em>
<a id="L650" name="L650"></a> 650                         <a href="../S/2453.html#L51" title="Defined at 51 in src/java/text/RBCollationTables.java.">RBCollationTables</a>.<a href="../D/31410.html" title="Multiple defined in 8 places.">reverse</a>(secResult, preSecIgnore, secResult.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L651" name="L651"></a> 651                     <em class="brace">}</em>
<a id="L652" name="L652"></a> 652                     <em class="comment">// Remember where we are in the secondary orderings - this is how far</em>
<a id="L653" name="L653"></a> 653                     <em class="comment">// back to go if we need to reverse them later.</em>
<a id="L654" name="L654"></a> 654                     secResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)(secOrder+ COLLATIONKEYOFFSET));
<a id="L655" name="L655"></a> 655                     preSecIgnore = secResult.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L656" name="L656"></a> 656                 <em class="brace">}</em>
<a id="L657" name="L657"></a> 657                 <strong class="reserved">if</strong> (compareTer) <em class="brace">{</em>
<a id="L658" name="L658"></a> 658                     terResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)(terOrder+ COLLATIONKEYOFFSET));
<a id="L659" name="L659"></a> 659                 <em class="brace">}</em>
<a id="L660" name="L660"></a> 660             <em class="brace">}</em>
<a id="L661" name="L661"></a> 661             <strong class="reserved">else</strong>
<a id="L662" name="L662"></a> 662             <em class="brace">{</em>
<a id="L663" name="L663"></a> 663                 <strong class="reserved">if</strong> (compareSec &amp;&amp; secOrder != 0)
<a id="L664" name="L664"></a> 664                     secResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)
<a id="L665" name="L665"></a> 665                         (secOrder + tables.<a href="../S/2453.html#L233" title="Defined at 233 in src/java/text/RBCollationTables.java.">getMaxSecOrder</a>() + COLLATIONKEYOFFSET));
<a id="L666" name="L666"></a> 666                 <strong class="reserved">if</strong> (compareTer &amp;&amp; terOrder != 0)
<a id="L667" name="L667"></a> 667                     terResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)
<a id="L668" name="L668"></a> 668                         (terOrder + tables.<a href="../S/2453.html#L237" title="Defined at 237 in src/java/text/RBCollationTables.java.">getMaxTerOrder</a>() + COLLATIONKEYOFFSET));
<a id="L669" name="L669"></a> 669             <em class="brace">}</em>
<a id="L670" name="L670"></a> 670         <em class="brace">}</em>
<a id="L671" name="L671"></a> 671         <strong class="reserved">if</strong> (tables.<a href="../S/2453.html#L141" title="Defined at 141 in src/java/text/RBCollationTables.java.">isFrenchSec</a>())
<a id="L672" name="L672"></a> 672         <em class="brace">{</em>
<a id="L673" name="L673"></a> 673             <strong class="reserved">if</strong> (preSecIgnore &lt; secResult.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <em class="brace">{</em>
<a id="L674" name="L674"></a> 674                 <em class="comment">// If we've accumulated any secondary characters after the last base character,</em>
<a id="L675" name="L675"></a> 675                 <em class="comment">// reverse them.</em>
<a id="L676" name="L676"></a> 676                 <a href="../S/2453.html#L51" title="Defined at 51 in src/java/text/RBCollationTables.java.">RBCollationTables</a>.<a href="../D/31410.html" title="Multiple defined in 8 places.">reverse</a>(secResult, preSecIgnore, secResult.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L677" name="L677"></a> 677             <em class="brace">}</em>
<a id="L678" name="L678"></a> 678             <em class="comment">// And now reverse the entire secResult to get French secondary ordering.</em>
<a id="L679" name="L679"></a> 679             <a href="../S/2453.html#L51" title="Defined at 51 in src/java/text/RBCollationTables.java.">RBCollationTables</a>.<a href="../D/31410.html" title="Multiple defined in 8 places.">reverse</a>(secResult, 0, secResult.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L680" name="L680"></a> 680         <em class="brace">}</em>
<a id="L681" name="L681"></a> 681         primResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)0);
<a id="L682" name="L682"></a> 682         secResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)0);
<a id="L683" name="L683"></a> 683         secResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(terResult.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L684" name="L684"></a> 684         primResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(secResult.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L685" name="L685"></a> 685 
<a id="L686" name="L686"></a> 686         <strong class="reserved">if</strong> (<a href="../D/22764.html" title="Multiple defined in 3 places.">getStrength</a>() == IDENTICAL) <em class="brace">{</em>
<a id="L687" name="L687"></a> 687             primResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>((<strong class="reserved">char</strong>)0);
<a id="L688" name="L688"></a> 688             <strong class="reserved">int</strong> mode = <a href="../S/2466.html#L392" title="Defined at 392 in src/java/text/Collator.java.">getDecomposition</a>();
<a id="L689" name="L689"></a> 689             <strong class="reserved">if</strong> (mode == CANONICAL_DECOMPOSITION) <em class="brace">{</em>
<a id="L690" name="L690"></a> 690                 primResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../S/2470.html#L122" title="Defined at 122 in src/java/text/Normalizer.java.">Form</a>.NFD));
<a id="L691" name="L691"></a> 691             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (mode == FULL_DECOMPOSITION) <em class="brace">{</em>
<a id="L692" name="L692"></a> 692                 primResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../D/28279.html" title="Multiple defined in 40 places.">normalize</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <a href="../S/2470.html#L109" title="Defined at 109 in src/java/text/Normalizer.java.">Normalizer</a>.<a href="../S/2470.html#L122" title="Defined at 122 in src/java/text/Normalizer.java.">Form</a>.NFKD));
<a id="L693" name="L693"></a> 693             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L694" name="L694"></a> 694                 primResult.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L695" name="L695"></a> 695             <em class="brace">}</em>
<a id="L696" name="L696"></a> 696         <em class="brace">}</em>
<a id="L697" name="L697"></a> 697         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/2473.html#L46" title="Defined at 46 in src/java/text/RuleBasedCollationKey.java.">RuleBasedCollationKey</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, primResult.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L698" name="L698"></a> 698     <em class="brace">}</em>
<a id="L699" name="L699"></a> 699 
<div class="comment">
      Standard override; no change in semantics.</div>
<a id="L703" name="L703"></a> 703     <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/11555.html" title="Multiple referred from 1378 places.">clone</a>() <em class="brace">{</em>
<a id="L704" name="L704"></a> 704         <em class="comment">// if we know we're not actually a subclass of RuleBasedCollator</em>
<a id="L705" name="L705"></a> 705         <em class="comment">// (this class really should have been made final), bypass</em>
<a id="L706" name="L706"></a> 706         <em class="comment">// Object.clone() and use our "copy constructor".  This is faster.</em>
<a id="L707" name="L707"></a> 707         <strong class="reserved">if</strong> (<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>() == <a href="../S/2461.html#L246" title="Defined at 246 in src/java/text/RuleBasedCollator.java.">RuleBasedCollator</a>.<strong class="reserved">class</strong>) <em class="brace">{</em>
<a id="L708" name="L708"></a> 708             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/2461.html#L246" title="Defined at 246 in src/java/text/RuleBasedCollator.java.">RuleBasedCollator</a>(<strong class="reserved">this</strong>);
<a id="L709" name="L709"></a> 709         <em class="brace">}</em>
<a id="L710" name="L710"></a> 710         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L711" name="L711"></a> 711             <a href="../S/2461.html#L246" title="Defined at 246 in src/java/text/RuleBasedCollator.java.">RuleBasedCollator</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (<a href="../S/2461.html#L246" title="Defined at 246 in src/java/text/RuleBasedCollator.java.">RuleBasedCollator</a>) <strong class="reserved">super</strong>.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L712" name="L712"></a> 712             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.primResult = <strong class="reserved">null</strong>;
<a id="L713" name="L713"></a> 713             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.secResult = <strong class="reserved">null</strong>;
<a id="L714" name="L714"></a> 714             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.terResult = <strong class="reserved">null</strong>;
<a id="L715" name="L715"></a> 715             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.sourceCursor = <strong class="reserved">null</strong>;
<a id="L716" name="L716"></a> 716             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.targetCursor = <strong class="reserved">null</strong>;
<a id="L717" name="L717"></a> 717             <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L718" name="L718"></a> 718         <em class="brace">}</em>
<a id="L719" name="L719"></a> 719     <em class="brace">}</em>
<a id="L720" name="L720"></a> 720 
<div class="comment">
      Compares the equality of two collation objects.
      @param obj the table-based collation object to be compared with this.
      @return true if the current table-based collation object is the same
      as the table-based collation object obj; false otherwise.</div>
<a id="L727" name="L727"></a> 727     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13992.html" title="Multiple referred from 5400 places.">equals</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> obj) <em class="brace">{</em>
<a id="L728" name="L728"></a> 728         <strong class="reserved">if</strong> (obj == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L729" name="L729"></a> 729         <strong class="reserved">if</strong> (!<strong class="reserved">super</strong>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(obj)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;  <em class="comment">// super does class check</em>
<a id="L730" name="L730"></a> 730         <a href="../S/2461.html#L246" title="Defined at 246 in src/java/text/RuleBasedCollator.java.">RuleBasedCollator</a> other = (<a href="../S/2461.html#L246" title="Defined at 246 in src/java/text/RuleBasedCollator.java.">RuleBasedCollator</a>) obj;
<a id="L731" name="L731"></a> 731         <em class="comment">// all other non-transient information is also contained in rules.</em>
<a id="L732" name="L732"></a> 732         <strong class="reserved">return</strong> (<a href="../D/22187.html" title="Multiple defined in 8 places.">getRules</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(other.<a href="../D/22187.html" title="Multiple defined in 8 places.">getRules</a>()));
<a id="L733" name="L733"></a> 733     <em class="brace">}</em>
<a id="L734" name="L734"></a> 734 
<div class="comment">
      Generates the hash code for the table-based collation object</div>
<a id="L738" name="L738"></a> 738     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/20298.html" title="Multiple referred from 715 places.">hashCode</a>() <em class="brace">{</em>
<a id="L739" name="L739"></a> 739         <strong class="reserved">return</strong> <a href="../D/22187.html" title="Multiple defined in 8 places.">getRules</a>().<a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>();
<a id="L740" name="L740"></a> 740     <em class="brace">}</em>
<a id="L741" name="L741"></a> 741 
<div class="comment">
      Allows CollationElementIterator access to the tables object</div>
<a id="L745" name="L745"></a> 745     <a href="../S/2453.html#L51" title="Defined at 51 in src/java/text/RBCollationTables.java.">RBCollationTables</a> <a href="../R/19376.html" title="Multiple referred from 2 places.">getTables</a>() <em class="brace">{</em>
<a id="L746" name="L746"></a> 746         <strong class="reserved">return</strong> tables;
<a id="L747" name="L747"></a> 747     <em class="brace">}</em>
<a id="L748" name="L748"></a> 748 
<a id="L749" name="L749"></a> 749     <em class="comment">// ==============================================================</em>
<a id="L750" name="L750"></a> 750     <em class="comment">// private</em>
<a id="L751" name="L751"></a> 751     <em class="comment">// ==============================================================</em>
<a id="L752" name="L752"></a> 752 
<a id="L753" name="L753"></a> 753     <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> CHARINDEX = 0x70000000;  <em class="comment">// need look up in .commit()</em>
<a id="L754" name="L754"></a> 754     <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> EXPANDCHARINDEX = 0x7E000000; <em class="comment">// Expand index follows</em>
<a id="L755" name="L755"></a> 755     <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> CONTRACTCHARINDEX = 0x7F000000;  <em class="comment">// contract indexes follow</em>
<a id="L756" name="L756"></a> 756     <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> UNMAPPED = 0xFFFFFFFF;
<a id="L757" name="L757"></a> 757 
<a id="L758" name="L758"></a> 758     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> COLLATIONKEYOFFSET = 1;
<a id="L759" name="L759"></a> 759 
<a id="L760" name="L760"></a> 760     <strong class="reserved">private</strong> <a href="../S/2453.html#L51" title="Defined at 51 in src/java/text/RBCollationTables.java.">RBCollationTables</a> tables = <strong class="reserved">null</strong>;
<a id="L761" name="L761"></a> 761 
<a id="L762" name="L762"></a> 762     <em class="comment">// Internal objects that are cached across calls so that they don't have to</em>
<a id="L763" name="L763"></a> 763     <em class="comment">// be created/destroyed on every call to compare() and getCollationKey()</em>
<a id="L764" name="L764"></a> 764     <strong class="reserved">private</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> primResult = <strong class="reserved">null</strong>;
<a id="L765" name="L765"></a> 765     <strong class="reserved">private</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> secResult = <strong class="reserved">null</strong>;
<a id="L766" name="L766"></a> 766     <strong class="reserved">private</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> terResult = <strong class="reserved">null</strong>;
<a id="L767" name="L767"></a> 767     <strong class="reserved">private</strong> <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a> sourceCursor = <strong class="reserved">null</strong>;
<a id="L768" name="L768"></a> 768     <strong class="reserved">private</strong> <a href="../S/2489.html#L108" title="Defined at 108 in src/java/text/CollationElementIterator.java.">CollationElementIterator</a> targetCursor = <strong class="reserved">null</strong>;
<a id="L769" name="L769"></a> 769 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L317">[^]</a><a href="#L745">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>