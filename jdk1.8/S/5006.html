<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xerces/internal/impl/XMLNSDocumentScannerImpl.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L88">[^]</a><a href="#L620">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L88" title="Defined at 88.">reset</a></li>
<li><a href="#L95" title="Defined at 95.">reset</a></li>
<li><a href="#L108" title="Defined at 108.">next</a></li>
<li><a href="#L129" title="Defined at 129.">setDTDValidator</a></li>
<li><a href="#L156" title="Defined at 156.">scanStartElement</a></li>
<li><a href="#L408" title="Defined at 408.">scanAttribute</a></li>
<li><a href="#L579" title="Defined at 579.">createContentDriver</a></li>
<li><a href="#L601" title="Defined at 601.">scanRootElementHook</a></li>
<li><a href="#L620" title="Defined at 620.">reconfigurePipeline</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2003, 2013, Oracle and/or its affiliates. All rights reserved.</div>
<a id="L4" name="L4"></a>   4 
<div class="comment">
  Copyright 2005 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
       http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<a id="L20" name="L20"></a>  20 
<a id="L21" name="L21"></a>  21 <strong class="reserved">package</strong> com.sun.org.apache.xerces.internal.<a href="../S/7010.html#L693" title="Defined at 693 in src/com/sun/corba/se/impl/encoding/CodeSetConversion.java.">impl</a>;
<a id="L22" name="L22"></a>  22 
<a id="L23" name="L23"></a>  23 <strong class="reserved">import</strong> java.io.IOException;
<a id="L24" name="L24"></a>  24 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.XMLString;
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidatorFilter;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.impl.msg.XMLMessageFormatter;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.util.XMLAttributesImpl;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.util.XMLAttributesIteratorImpl;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.util.XMLStringBuffer;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.util.XMLSymbols;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.NamespaceContext;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.QName;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.XNIException;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.parser.XMLComponentManager;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.parser.XMLConfigurationException;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.XMLDocumentHandler;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.XMLAttributes;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.xni.parser.XMLDocumentSource;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> com.sun.org.apache.xerces.internal.util.XMLAttributesImpl;
<a id="L40" name="L40"></a>  40 
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> javax.xml.stream.XMLInputFactory;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> javax.xml.stream.XMLStreamConstants;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> javax.xml.stream.events.XMLEvent;
<a id="L44" name="L44"></a>  44 
<div class="comment">
  This class adds the functionality of namespace processing.
  This class has been modified as per the new design which is more suited to
  efficiently build pull parser. Lot of improvements have been done and
  the code has been added to support stax functionality/features.
  This class scans an XML document, checks if document has a DTD, and if
  DTD is not found the scanner will remove the DTD Validator from the pipeline and perform
  namespace binding.
  @author Neeraj Bajaj, Sun Microsystems
  @author Venugopal Rao K, Sun Microsystems
  @author Elena Litani, IBM
  @version $Id: XMLNSDocumentScannerImpl.java,v 1.11 2010-11-01 04:39:41 joehw Exp $</div>
<a id="L63" name="L63"></a>  63 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/9032.html" title="Multiple referred from 19 places.">XMLNSDocumentScannerImpl</a>
<a id="L64" name="L64"></a>  64         <strong class="reserved">extends</strong> <a href="../S/5032.html#L70" title="Defined at 70 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentScannerImpl.java.">XMLDocumentScannerImpl</a> <em class="brace">{</em>
<a id="L65" name="L65"></a>  65 
<div class="comment">
      If is true, the dtd validator is no longer in the pipeline
      and the scanner should bind namespaces</div>
<a id="L70" name="L70"></a>  70     <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> fBindNamespaces;
<a id="L71" name="L71"></a>  71 
<div class="comment">
 If validating parser, make sure we report an error in the
     *   scanner if DTD grammar is missing.</div>
<a id="L74" name="L74"></a>  74     <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> fPerformValidation;
<a id="L75" name="L75"></a>  75 
<a id="L76" name="L76"></a>  76 
<div class="comment">
     /** Default value of this feature is false, when in Stax mode this should be true */</div>
<a id="L78" name="L78"></a>  78     <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> fNotAddNSDeclAsAttribute = <strong class="reserved">false</strong>;
<a id="L79" name="L79"></a>  79 
<div class="comment">
     /** DTD validator */</div>
<a id="L81" name="L81"></a>  81      <strong class="reserved">private</strong> <a href="../S/5162.html#L75" title="Defined at 75 in src/com/sun/org/apache/xerces/internal/impl/dtd/XMLDTDValidatorFilter.java.">XMLDTDValidatorFilter</a> fDTDValidator;
<a id="L82" name="L82"></a>  82 
<div class="comment">
      /** xmlns, default Namespace, declared */</div>
<a id="L84" name="L84"></a>  84      <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> fXmlnsDeclared = <strong class="reserved">false</strong>;
<a id="L85" name="L85"></a>  85 
<div class="comment">
 Resets the fields of this scanner.</div>
<a id="L88" name="L88"></a>  88     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26238.html" title="Multiple referred from 619 places.">reset</a>(<a href="../S/5234.html#L46" title="Defined at 46 in src/com/sun/org/apache/xerces/internal/impl/PropertyManager.java.">PropertyManager</a> propertyManager) <em class="brace">{</em>
<a id="L89" name="L89"></a>  89         <a href="../D/33626.html" title="Multiple defined in 2 places.">setPropertyManager</a>(propertyManager);
<a id="L90" name="L90"></a>  90         <strong class="reserved">super</strong>.<a href="../D/31151.html" title="Multiple defined in 296 places.">reset</a>(propertyManager);
<a id="L91" name="L91"></a>  91         fBindNamespaces = <strong class="reserved">false</strong>;
<a id="L92" name="L92"></a>  92         fNotAddNSDeclAsAttribute = !((<a href="../S/1770.html#L43" title="Defined at 43 in src/java/lang/Boolean.java.">Boolean</a>)propertyManager.<a href="../D/21720.html" title="Multiple defined in 77 places.">getProperty</a>(<a href="../D/1829.html" title="Multiple defined in 9 places.">Constants</a>.ADD_NAMESPACE_DECL_AS_ATTRIBUTE)).<a href="../D/11892.html" title="Multiple defined in 3 places.">booleanValue</a>();
<a id="L93" name="L93"></a>  93     <em class="brace">}</em>
<a id="L94" name="L94"></a>  94 
<a id="L95" name="L95"></a>  95     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26238.html" title="Multiple referred from 619 places.">reset</a>(<a href="../S/5495.html#L41" title="Defined at 41 in src/com/sun/org/apache/xerces/internal/xni/parser/XMLComponentManager.java.">XMLComponentManager</a> componentManager)
<a id="L96" name="L96"></a>  96     <strong class="reserved">throws</strong> <a href="../S/5503.html#L35" title="Defined at 35 in src/com/sun/org/apache/xerces/internal/xni/parser/XMLConfigurationException.java.">XMLConfigurationException</a> <em class="brace">{</em>
<a id="L97" name="L97"></a>  97         <strong class="reserved">super</strong>.<a href="../D/31151.html" title="Multiple defined in 296 places.">reset</a>(componentManager);
<a id="L98" name="L98"></a>  98         fNotAddNSDeclAsAttribute = <strong class="reserved">false</strong> ;
<a id="L99" name="L99"></a>  99         fPerformValidation = <strong class="reserved">false</strong>;
<a id="L100" name="L100"></a> 100         fBindNamespaces = <strong class="reserved">false</strong>;
<a id="L101" name="L101"></a> 101     <em class="brace">}</em>
<a id="L102" name="L102"></a> 102 
<div class="comment">
 return the next state on the input
      @return int</div>
<a id="L107" name="L107"></a> 107 
<a id="L108" name="L108"></a> 108     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/23650.html" title="Multiple referred from 3301 places.">next</a>() <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/5491.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/xni/XNIException.java.">XNIException</a> <em class="brace">{</em>
<a id="L109" name="L109"></a> 109         <em class="comment">//since namespace context should still be valid when the parser is at the end element state therefore</em>
<a id="L110" name="L110"></a> 110         <em class="comment">//we pop the context only when next() has been called after the end element state was encountered. - nb.</em>
<a id="L111" name="L111"></a> 111 
<a id="L112" name="L112"></a> 112         <strong class="reserved">if</strong>((fScannerLastState == <a href="../S/3896.html#L53" title="Defined at 53 in src/javax/xml/stream/events/XMLEvent.java.">XMLEvent</a>.END_ELEMENT) &amp;&amp; fBindNamespaces)<em class="brace">{</em>
<a id="L113" name="L113"></a> 113             fScannerLastState = -1;
<a id="L114" name="L114"></a> 114             fNamespaceContext.<a href="../D/29421.html" title="Multiple defined in 9 places.">popContext</a>();
<a id="L115" name="L115"></a> 115         <em class="brace">}</em>
<a id="L116" name="L116"></a> 116 
<a id="L117" name="L117"></a> 117         <strong class="reserved">return</strong> fScannerLastState = <strong class="reserved">super</strong>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>();
<a id="L118" name="L118"></a> 118     <em class="brace">}</em>
<a id="L119" name="L119"></a> 119 
<div class="comment">
      The scanner is responsible for removing DTD validator
      from the pipeline if it is not needed.
      @param previous The filter component before DTDValidator
      @param dtdValidator
                      The DTDValidator
      @param next     The documentHandler after the DTDValidator</div>
<a id="L129" name="L129"></a> 129     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27159.html" title="Multiple referred from 9 places.">setDTDValidator</a>(<a href="../S/5162.html#L75" title="Defined at 75 in src/com/sun/org/apache/xerces/internal/impl/dtd/XMLDTDValidatorFilter.java.">XMLDTDValidatorFilter</a> dtd)<em class="brace">{</em>
<a id="L130" name="L130"></a> 130         fDTDValidator = dtd;
<a id="L131" name="L131"></a> 131     <em class="brace">}</em>
<a id="L132" name="L132"></a> 132 
<a id="L133" name="L133"></a> 133 
<a id="L134" name="L134"></a> 134 
<div class="comment">
      Scans a start element. This method will handle the binding of
      namespace information and notifying the handler of the start
      of the element.
      <p>
      </p><pre>      [44] EmptyElemTag ::= '&lt;' Name (S Attribute)* S? '/&gt;'
      [40] STag ::= '&lt;' Name (S Attribute)* S? '&gt;'
      </pre>
      <p>
      <strong>Note:</strong> This method assumes that the leading
      '&lt;' character has been consumed.
      </p><p>
      <strong>Note:</strong> This method uses the fElementQName and
      fAttributes variables. The contents of these variables will be
      destroyed. The caller should copy important information out of
      these variables before calling this method.
      @return True if element is empty. (i.e. It matches
               production [44].</p></div>
<a id="L156" name="L156"></a> 156     <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/26657.html" title="Multiple referred from 5 places.">scanStartElement</a>()
<a id="L157" name="L157"></a> 157     <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/5491.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/xni/XNIException.java.">XNIException</a> <em class="brace">{</em>
<a id="L158" name="L158"></a> 158 
<a id="L159" name="L159"></a> 159         <strong class="reserved">if</strong> (DEBUG_START_END_ELEMENT) <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>(<strong class="reserved">this</strong>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>().<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() +"&gt;&gt;&gt; scanStartElement()");
<a id="L160" name="L160"></a> 160         <em class="comment">//when skipping is true and no more elements should be added</em>
<a id="L161" name="L161"></a> 161         <strong class="reserved">if</strong>(fSkip &amp;&amp; !fAdd)<em class="brace">{</em>
<a id="L162" name="L162"></a> 162             <em class="comment">//get the stored element -- if everything goes right this should match the</em>
<a id="L163" name="L163"></a> 163             <em class="comment">//token in the buffer</em>
<a id="L164" name="L164"></a> 164 
<a id="L165" name="L165"></a> 165             <a href="../D/6976.html" title="Multiple defined in 5 places.">QName</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = fElementStack.<a href="../D/20885.html" title="Multiple defined in 8 places.">getNext</a>();
<a id="L166" name="L166"></a> 166 
<a id="L167" name="L167"></a> 167             <strong class="reserved">if</strong>(DEBUG_SKIP_ALGORITHM)<em class="brace">{</em>
<a id="L168" name="L168"></a> 168                 <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Trying to skip String = " + <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.rawname);
<a id="L169" name="L169"></a> 169             <em class="brace">}</em>
<a id="L170" name="L170"></a> 170 
<a id="L171" name="L171"></a> 171             <em class="comment">//Be conservative -- if skipping fails -- stop.</em>
<a id="L172" name="L172"></a> 172             fSkip = fEntityScanner.<a href="../D/34623.html" title="Multiple defined in 3 places.">skipString</a>(<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.rawname); <em class="comment">// skipQElement(name);</em>
<a id="L173" name="L173"></a> 173 
<a id="L174" name="L174"></a> 174             <strong class="reserved">if</strong>(fSkip)<em class="brace">{</em>
<a id="L175" name="L175"></a> 175                 <strong class="reserved">if</strong>(DEBUG_SKIP_ALGORITHM)<em class="brace">{</em>
<a id="L176" name="L176"></a> 176                     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Element SUCESSFULLY skipped = " + <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.rawname);
<a id="L177" name="L177"></a> 177                 <em class="brace">}</em>
<a id="L178" name="L178"></a> 178                 fElementStack.<a href="../D/29933.html" title="Multiple defined in 37 places.">push</a>();
<a id="L179" name="L179"></a> 179                 fElementQName = <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>;
<a id="L180" name="L180"></a> 180             <em class="brace">}</em><strong class="reserved">else</strong><em class="brace">{</em>
<a id="L181" name="L181"></a> 181                 <em class="comment">//if skipping fails reposition the stack or fallback to normal way of processing</em>
<a id="L182" name="L182"></a> 182                 fElementStack.<a href="../S/5233.html#L2503" title="Defined at 2503 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentFragmentScannerImpl.java.">reposition</a>();
<a id="L183" name="L183"></a> 183                 <strong class="reserved">if</strong>(DEBUG_SKIP_ALGORITHM)<em class="brace">{</em>
<a id="L184" name="L184"></a> 184                     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Element was NOT skipped, REPOSITIONING stack" );
<a id="L185" name="L185"></a> 185                 <em class="brace">}</em>
<a id="L186" name="L186"></a> 186             <em class="brace">}</em>
<a id="L187" name="L187"></a> 187         <em class="brace">}</em>
<a id="L188" name="L188"></a> 188 
<a id="L189" name="L189"></a> 189         <em class="comment">//we are still at the stage of adding elements</em>
<a id="L190" name="L190"></a> 190         <em class="comment">//the elements were not matched or</em>
<a id="L191" name="L191"></a> 191         <em class="comment">//fSkip is not set to true</em>
<a id="L192" name="L192"></a> 192         <strong class="reserved">if</strong>(!fSkip || fAdd)<em class="brace">{</em>
<a id="L193" name="L193"></a> 193             <em class="comment">//get the next element from the stack</em>
<a id="L194" name="L194"></a> 194             fElementQName = fElementStack.<a href="../D/28145.html" title="Multiple defined in 35 places.">nextElement</a>();
<a id="L195" name="L195"></a> 195             <em class="comment">// There are two variables,fNamespaces and fBindNamespaces</em>
<a id="L196" name="L196"></a> 196             <em class="comment">//StAX uses XMLNSDocumentScannerImpl so this distinction needs to be maintained</em>
<a id="L197" name="L197"></a> 197             <strong class="reserved">if</strong> (fNamespaces) <em class="brace">{</em>
<a id="L198" name="L198"></a> 198                 fEntityScanner.<a href="../D/31607.html" title="Multiple defined in 2 places.">scanQName</a>(fElementQName);
<a id="L199" name="L199"></a> 199             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L200" name="L200"></a> 200                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = fEntityScanner.<a href="../D/31598.html" title="Multiple defined in 2 places.">scanName</a>();
<a id="L201" name="L201"></a> 201                 fElementQName.<a href="../D/34272.html" title="Multiple defined in 29 places.">setValues</a>(<strong class="reserved">null</strong>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>, <strong class="reserved">null</strong>);
<a id="L202" name="L202"></a> 202             <em class="brace">}</em>
<a id="L203" name="L203"></a> 203 
<a id="L204" name="L204"></a> 204             <strong class="reserved">if</strong>(DEBUG)<a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Element scanned in start element is " + fElementQName.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>());
<a id="L205" name="L205"></a> 205             <strong class="reserved">if</strong>(DEBUG_SKIP_ALGORITHM)<em class="brace">{</em>
<a id="L206" name="L206"></a> 206                 <strong class="reserved">if</strong>(fAdd)<em class="brace">{</em>
<a id="L207" name="L207"></a> 207                     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Elements are being ADDED -- elemet added is = " + fElementQName.rawname + " at count = " + fElementStack.fCount);
<a id="L208" name="L208"></a> 208                 <em class="brace">}</em>
<a id="L209" name="L209"></a> 209             <em class="brace">}</em>
<a id="L210" name="L210"></a> 210 
<a id="L211" name="L211"></a> 211         <em class="brace">}</em>
<a id="L212" name="L212"></a> 212 
<a id="L213" name="L213"></a> 213         <em class="comment">//when the elements are being added , we need to check if we are set for skipping the elements</em>
<a id="L214" name="L214"></a> 214         <strong class="reserved">if</strong>(fAdd)<em class="brace">{</em>
<a id="L215" name="L215"></a> 215             <em class="comment">//this sets the value of fAdd variable</em>
<a id="L216" name="L216"></a> 216             fElementStack.<a href="../D/27532.html" title="Multiple defined in 2 places.">matchElement</a>(fElementQName);
<a id="L217" name="L217"></a> 217         <em class="brace">}</em>
<a id="L218" name="L218"></a> 218 
<a id="L219" name="L219"></a> 219         <em class="comment">//xxx: We dont need another pointer, fCurrentElement, we can use fElementQName</em>
<a id="L220" name="L220"></a> 220         fCurrentElement = fElementQName;
<a id="L221" name="L221"></a> 221 
<a id="L222" name="L222"></a> 222         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> rawname = fElementQName.rawname;
<a id="L223" name="L223"></a> 223         <a href="../S/5233.html#L1920" title="Defined at 1920 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentFragmentScannerImpl.java.">checkDepth</a>(rawname);
<a id="L224" name="L224"></a> 224         <strong class="reserved">if</strong> (fBindNamespaces) <em class="brace">{</em>
<a id="L225" name="L225"></a> 225             fNamespaceContext.<a href="../D/29939.html" title="Multiple defined in 10 places.">pushContext</a>();
<a id="L226" name="L226"></a> 226             <strong class="reserved">if</strong> (fScannerState == SCANNER_STATE_ROOT_ELEMENT) <em class="brace">{</em>
<a id="L227" name="L227"></a> 227                 <strong class="reserved">if</strong> (fPerformValidation) <em class="brace">{</em>
<a id="L228" name="L228"></a> 228                     fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XML_DOMAIN,
<a id="L229" name="L229"></a> 229                             "MSG_GRAMMAR_NOT_FOUND",
<a id="L230" name="L230"></a> 230                             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> rawname<em class="brace">}</em>,
<a id="L231" name="L231"></a> 231                             <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_ERROR);
<a id="L232" name="L232"></a> 232 
<a id="L233" name="L233"></a> 233                             <strong class="reserved">if</strong> (fDoctypeName == <strong class="reserved">null</strong> || !fDoctypeName.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(rawname)) <em class="brace">{</em>
<a id="L234" name="L234"></a> 234                                 fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>( <a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XML_DOMAIN,
<a id="L235" name="L235"></a> 235                                         "RootElementTypeMustMatchDoctypedecl",
<a id="L236" name="L236"></a> 236                                         <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fDoctypeName, rawname<em class="brace">}</em>,
<a id="L237" name="L237"></a> 237                                         <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_ERROR);
<a id="L238" name="L238"></a> 238                             <em class="brace">}</em>
<a id="L239" name="L239"></a> 239                 <em class="brace">}</em>
<a id="L240" name="L240"></a> 240             <em class="brace">}</em>
<a id="L241" name="L241"></a> 241         <em class="brace">}</em>
<a id="L242" name="L242"></a> 242 
<a id="L243" name="L243"></a> 243 
<a id="L244" name="L244"></a> 244         fEmptyElement = <strong class="reserved">false</strong>;
<a id="L245" name="L245"></a> 245         fAttributes.<a href="../D/30687.html" title="Multiple defined in 4 places.">removeAllAttributes</a>();
<a id="L246" name="L246"></a> 246 
<a id="L247" name="L247"></a> 247         <strong class="reserved">if</strong>(!<a href="../S/5233.html#L1377" title="Defined at 1377 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentFragmentScannerImpl.java.">seekCloseOfStartTag</a>())<em class="brace">{</em>
<a id="L248" name="L248"></a> 248             fReadingAttributes = <strong class="reserved">true</strong>;
<a id="L249" name="L249"></a> 249             fAttributeCacheUsedCount =0;
<a id="L250" name="L250"></a> 250             fStringBufferIndex =0;
<a id="L251" name="L251"></a> 251             fAddDefaultAttr = <strong class="reserved">true</strong>;
<a id="L252" name="L252"></a> 252             fXmlnsDeclared = <strong class="reserved">false</strong>;
<a id="L253" name="L253"></a> 253 
<a id="L254" name="L254"></a> 254             <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L255" name="L255"></a> 255                 <a href="../D/31562.html" title="Multiple defined in 3 places.">scanAttribute</a>(fAttributes);
<a id="L256" name="L256"></a> 256                 <strong class="reserved">if</strong> (fSecurityManager != <strong class="reserved">null</strong> &amp;&amp; (!fSecurityManager.<a href="../S/5335.html#L379" title="Defined at 379 in src/com/sun/org/apache/xerces/internal/utils/XMLSecurityManager.java.">isNoLimit</a>(fElementAttributeLimit)) &amp;&amp;
<a id="L257" name="L257"></a> 257                         fAttributes.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>() &gt; fElementAttributeLimit)<em class="brace">{</em>
<a id="L258" name="L258"></a> 258                     fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XML_DOMAIN,
<a id="L259" name="L259"></a> 259                                                  "ElementAttributeLimit",
<a id="L260" name="L260"></a> 260                                                  <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>rawname, fElementAttributeLimit <em class="brace">}</em>,
<a id="L261" name="L261"></a> 261                                                  <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR );
<a id="L262" name="L262"></a> 262                 <em class="brace">}</em>
<a id="L263" name="L263"></a> 263 
<a id="L264" name="L264"></a> 264             <em class="brace">}</em> <strong class="reserved">while</strong> (!<a href="../S/5233.html#L1377" title="Defined at 1377 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentFragmentScannerImpl.java.">seekCloseOfStartTag</a>());
<a id="L265" name="L265"></a> 265             fReadingAttributes=<strong class="reserved">false</strong>;
<a id="L266" name="L266"></a> 266         <em class="brace">}</em>
<a id="L267" name="L267"></a> 267 
<a id="L268" name="L268"></a> 268         <strong class="reserved">if</strong> (fBindNamespaces) <em class="brace">{</em>
<a id="L269" name="L269"></a> 269             <em class="comment">// REVISIT: is it required? forbit xmlns prefix for element</em>
<a id="L270" name="L270"></a> 270             <strong class="reserved">if</strong> (fElementQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS) <em class="brace">{</em>
<a id="L271" name="L271"></a> 271                 fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L272" name="L272"></a> 272                         "ElementXMLNSPrefix",
<a id="L273" name="L273"></a> 273                         <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fElementQName.rawname<em class="brace">}</em>,
<a id="L274" name="L274"></a> 274                         <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L275" name="L275"></a> 275             <em class="brace">}</em>
<a id="L276" name="L276"></a> 276 
<a id="L277" name="L277"></a> 277             <em class="comment">// bind the element</em>
<a id="L278" name="L278"></a> 278             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> = fElementQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> != <strong class="reserved">null</strong>
<a id="L279" name="L279"></a> 279                     ? fElementQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> : <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING;
<a id="L280" name="L280"></a> 280             <em class="comment">// assign uri to the element</em>
<a id="L281" name="L281"></a> 281             fElementQName.uri = fNamespaceContext.<a href="../D/23369.html" title="Multiple defined in 43 places.">getURI</a>(<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a>);
<a id="L282" name="L282"></a> 282             <em class="comment">// make sure that object in the element stack is updated as well</em>
<a id="L283" name="L283"></a> 283             fCurrentElement.uri = fElementQName.uri;
<a id="L284" name="L284"></a> 284 
<a id="L285" name="L285"></a> 285             <strong class="reserved">if</strong> (fElementQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> == <strong class="reserved">null</strong> &amp;&amp; fElementQName.uri != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L286" name="L286"></a> 286                 fElementQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> = <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING;
<a id="L287" name="L287"></a> 287             <em class="brace">}</em>
<a id="L288" name="L288"></a> 288             <strong class="reserved">if</strong> (fElementQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> != <strong class="reserved">null</strong> &amp;&amp; fElementQName.uri == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L289" name="L289"></a> 289                 fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L290" name="L290"></a> 290                         "ElementPrefixUnbound",
<a id="L291" name="L291"></a> 291                         <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fElementQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a>, fElementQName.rawname<em class="brace">}</em>,
<a id="L292" name="L292"></a> 292                         <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L293" name="L293"></a> 293             <em class="brace">}</em>
<a id="L294" name="L294"></a> 294 
<a id="L295" name="L295"></a> 295             <em class="comment">// bind attributes (xmlns are already bound bellow)</em>
<a id="L296" name="L296"></a> 296             <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> = fAttributes.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>();
<a id="L297" name="L297"></a> 297             <em class="comment">// fLength = 0; //initialize structure</em>
<a id="L298" name="L298"></a> 298             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L299" name="L299"></a> 299                 fAttributes.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(i, fAttributeQName);
<a id="L300" name="L300"></a> 300 
<a id="L301" name="L301"></a> 301                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> aprefix = fAttributeQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> != <strong class="reserved">null</strong>
<a id="L302" name="L302"></a> 302                         ? fAttributeQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> : <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING;
<a id="L303" name="L303"></a> 303                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> uri = fNamespaceContext.<a href="../D/23369.html" title="Multiple defined in 43 places.">getURI</a>(aprefix);
<a id="L304" name="L304"></a> 304                 <em class="comment">// REVISIT: try removing the first "if" and see if it is faster.</em>
<a id="L305" name="L305"></a> 305                 <em class="comment">//</em>
<a id="L306" name="L306"></a> 306                 <strong class="reserved">if</strong> (fAttributeQName.uri != <strong class="reserved">null</strong> &amp;&amp; fAttributeQName.uri == uri) <em class="brace">{</em>
<a id="L307" name="L307"></a> 307                     <em class="comment">// checkDuplicates(fAttributeQName, fAttributes);</em>
<a id="L308" name="L308"></a> 308                     <strong class="reserved">continue</strong>;
<a id="L309" name="L309"></a> 309                 <em class="brace">}</em>
<a id="L310" name="L310"></a> 310                 <strong class="reserved">if</strong> (aprefix != <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING) <em class="brace">{</em>
<a id="L311" name="L311"></a> 311                     fAttributeQName.uri = uri;
<a id="L312" name="L312"></a> 312                     <strong class="reserved">if</strong> (uri == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L313" name="L313"></a> 313                         fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L314" name="L314"></a> 314                                 "AttributePrefixUnbound",
<a id="L315" name="L315"></a> 315                                 <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fElementQName.rawname,fAttributeQName.rawname,aprefix<em class="brace">}</em>,
<a id="L316" name="L316"></a> 316                                 <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L317" name="L317"></a> 317                     <em class="brace">}</em>
<a id="L318" name="L318"></a> 318                     fAttributes.<a href="../D/34206.html" title="Multiple defined in 6 places.">setURI</a>(i, uri);
<a id="L319" name="L319"></a> 319                     <em class="comment">// checkDuplicates(fAttributeQName, fAttributes);</em>
<a id="L320" name="L320"></a> 320                 <em class="brace">}</em>
<a id="L321" name="L321"></a> 321             <em class="brace">}</em>
<a id="L322" name="L322"></a> 322 
<a id="L323" name="L323"></a> 323             <strong class="reserved">if</strong> (<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; 1) <em class="brace">{</em>
<a id="L324" name="L324"></a> 324                 <a href="../D/6976.html" title="Multiple defined in 5 places.">QName</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> = fAttributes.<a href="../S/5286.html#L808" title="Defined at 808 in src/com/sun/org/apache/xerces/internal/util/XMLAttributesImpl.java.">checkDuplicatesNS</a>();
<a id="L325" name="L325"></a> 325                 <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L326" name="L326"></a> 326                     <strong class="reserved">if</strong> (<a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.uri != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L327" name="L327"></a> 327                         fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L328" name="L328"></a> 328                                 "AttributeNSNotUnique",
<a id="L329" name="L329"></a> 329                                 <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fElementQName.rawname, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.localpart, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.uri<em class="brace">}</em>,
<a id="L330" name="L330"></a> 330                                 <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L331" name="L331"></a> 331                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L332" name="L332"></a> 332                         fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L333" name="L333"></a> 333                                 "AttributeNotUnique",
<a id="L334" name="L334"></a> 334                                 <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fElementQName.rawname, <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>.rawname<em class="brace">}</em>,
<a id="L335" name="L335"></a> 335                                 <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L336" name="L336"></a> 336                     <em class="brace">}</em>
<a id="L337" name="L337"></a> 337                 <em class="brace">}</em>
<a id="L338" name="L338"></a> 338             <em class="brace">}</em>
<a id="L339" name="L339"></a> 339         <em class="brace">}</em>
<a id="L340" name="L340"></a> 340 
<a id="L341" name="L341"></a> 341 
<a id="L342" name="L342"></a> 342         <strong class="reserved">if</strong> (fEmptyElement) <em class="brace">{</em>
<a id="L343" name="L343"></a> 343             <em class="comment">//decrease the markup depth..</em>
<a id="L344" name="L344"></a> 344             fMarkupDepth--;
<a id="L345" name="L345"></a> 345 
<a id="L346" name="L346"></a> 346             <em class="comment">// check that this element was opened in the same entity</em>
<a id="L347" name="L347"></a> 347             <strong class="reserved">if</strong> (fMarkupDepth &lt; fEntityStack[fEntityDepth - 1]) <em class="brace">{</em>
<a id="L348" name="L348"></a> 348                 <a href="../D/31090.html" title="Multiple defined in 5 places.">reportFatalError</a>("ElementEntityMismatch",
<a id="L349" name="L349"></a> 349                         <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fCurrentElement.rawname<em class="brace">}</em>);
<a id="L350" name="L350"></a> 350             <em class="brace">}</em>
<a id="L351" name="L351"></a> 351             <em class="comment">// call handler</em>
<a id="L352" name="L352"></a> 352             <strong class="reserved">if</strong> (fDocumentHandler != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L353" name="L353"></a> 353                 <strong class="reserved">if</strong>(DEBUG)
<a id="L354" name="L354"></a> 354                     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("emptyElement = " + fElementQName);
<a id="L355" name="L355"></a> 355 
<a id="L356" name="L356"></a> 356                 fDocumentHandler.<a href="../D/15350.html" title="Multiple defined in 24 places.">emptyElement</a>(fElementQName, fAttributes, <strong class="reserved">null</strong>);
<a id="L357" name="L357"></a> 357             <em class="brace">}</em>
<a id="L358" name="L358"></a> 358 
<a id="L359" name="L359"></a> 359             <em class="comment">//We should not be popping out the context here in endELement becaause the namespace context is still</em>
<a id="L360" name="L360"></a> 360             <em class="comment">//valid when parser is at the endElement state.</em>
<a id="L361" name="L361"></a> 361             fScanEndElement = <strong class="reserved">true</strong>;
<a id="L362" name="L362"></a> 362             <em class="comment">//if (fBindNamespaces) {</em>
<a id="L363" name="L363"></a> 363             <em class="comment">//  fNamespaceContext.popContext();</em>
<a id="L364" name="L364"></a> 364             <em class="comment">//}</em>
<a id="L365" name="L365"></a> 365 
<a id="L366" name="L366"></a> 366             <em class="comment">//pop the element off the stack..</em>
<a id="L367" name="L367"></a> 367             fElementStack.<a href="../D/29427.html" title="Multiple defined in 2 places.">popElement</a>();
<a id="L368" name="L368"></a> 368 
<a id="L369" name="L369"></a> 369         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L370" name="L370"></a> 370 
<a id="L371" name="L371"></a> 371             <strong class="reserved">if</strong>(dtdGrammarUtil != <strong class="reserved">null</strong>)
<a id="L372" name="L372"></a> 372                 dtdGrammarUtil.<a href="../D/34781.html" title="Multiple defined in 105 places.">startElement</a>(fElementQName,fAttributes);
<a id="L373" name="L373"></a> 373             <strong class="reserved">if</strong>(fDocumentHandler != <strong class="reserved">null</strong>)<em class="brace">{</em>
<a id="L374" name="L374"></a> 374                 <em class="comment">//complete element and attributes are traversed in this function so we can send a callback</em>
<a id="L375" name="L375"></a> 375                 <em class="comment">//here.</em>
<a id="L376" name="L376"></a> 376                 <em class="comment">//&lt;strong&gt;we shouldn't be sending callback in scanDocument()&lt;/strong&gt;</em>
<a id="L377" name="L377"></a> 377                 <strong class="reserved">if</strong>(DEBUG)
<a id="L378" name="L378"></a> 378                     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("startElement = " + fElementQName);
<a id="L379" name="L379"></a> 379                 fDocumentHandler.<a href="../D/34781.html" title="Multiple defined in 105 places.">startElement</a>(fElementQName, fAttributes, <strong class="reserved">null</strong>);
<a id="L380" name="L380"></a> 380             <em class="brace">}</em>
<a id="L381" name="L381"></a> 381         <em class="brace">}</em>
<a id="L382" name="L382"></a> 382 
<a id="L383" name="L383"></a> 383 
<a id="L384" name="L384"></a> 384         <strong class="reserved">if</strong> (DEBUG_START_END_ELEMENT) <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>(<strong class="reserved">this</strong>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>().<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() +"&lt;&lt;&lt; scanStartElement(): "+fEmptyElement);
<a id="L385" name="L385"></a> 385         <strong class="reserved">return</strong> fEmptyElement;
<a id="L386" name="L386"></a> 386 
<a id="L387" name="L387"></a> 387     <em class="brace">}</em> <em class="comment">// scanStartElement():boolean</em>
<a id="L388" name="L388"></a> 388 
<a id="L389" name="L389"></a> 389 
<a id="L390" name="L390"></a> 390 
<div class="comment">
      Scans an attribute.
      <p>
      </p><pre>      [41] Attribute ::= Name Eq AttValue
      </pre>
      <p>
      <strong>Note:</strong> This method assumes that the next
      character on the stream is the first character of the attribute
      name.
      </p><p>
      <strong>Note:</strong> This method uses the fAttributeQName and
      fQName variables. The contents of these variables will be
      destroyed.
      @param attributes The attributes list for the scanned attribute.</p></div>
<a id="L408" name="L408"></a> 408     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/26612.html" title="Multiple referred from 4 places.">scanAttribute</a>(<a href="../S/5286.html#L88" title="Defined at 88 in src/com/sun/org/apache/xerces/internal/util/XMLAttributesImpl.java.">XMLAttributesImpl</a> <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>)
<a id="L409" name="L409"></a> 409     <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/5491.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/xni/XNIException.java.">XNIException</a> <em class="brace">{</em>
<a id="L410" name="L410"></a> 410         <strong class="reserved">if</strong> (DEBUG_START_END_ELEMENT) <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>(<strong class="reserved">this</strong>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>().<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() +"&gt;&gt;&gt; scanAttribute()");
<a id="L411" name="L411"></a> 411 
<a id="L412" name="L412"></a> 412         <em class="comment">// name</em>
<a id="L413" name="L413"></a> 413         fEntityScanner.<a href="../D/31607.html" title="Multiple defined in 2 places.">scanQName</a>(fAttributeQName);
<a id="L414" name="L414"></a> 414 
<a id="L415" name="L415"></a> 415         <em class="comment">// equals</em>
<a id="L416" name="L416"></a> 416         fEntityScanner.<a href="../D/34622.html" title="Multiple defined in 2 places.">skipSpaces</a>();
<a id="L417" name="L417"></a> 417         <strong class="reserved">if</strong> (!fEntityScanner.<a href="../D/34601.html" title="Multiple defined in 2 places.">skipChar</a>('=')) <em class="brace">{</em>
<a id="L418" name="L418"></a> 418             <a href="../D/31090.html" title="Multiple defined in 5 places.">reportFatalError</a>("EqRequiredInAttribute",
<a id="L419" name="L419"></a> 419                     <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fCurrentElement.rawname,fAttributeQName.rawname<em class="brace">}</em>);
<a id="L420" name="L420"></a> 420         <em class="brace">}</em>
<a id="L421" name="L421"></a> 421         fEntityScanner.<a href="../D/34622.html" title="Multiple defined in 2 places.">skipSpaces</a>();
<a id="L422" name="L422"></a> 422 
<a id="L423" name="L423"></a> 423         <em class="comment">// content</em>
<a id="L424" name="L424"></a> 424         <strong class="reserved">int</strong> attrIndex = 0 ;
<a id="L425" name="L425"></a> 425 
<a id="L426" name="L426"></a> 426 
<a id="L427" name="L427"></a> 427         <em class="comment">//REVISIT: one more case needs to be included: external PE and standalone is no</em>
<a id="L428" name="L428"></a> 428         <strong class="reserved">boolean</strong> isVC =  fHasExternalDTD &amp;&amp; !fStandalone;
<a id="L429" name="L429"></a> 429 
<a id="L430" name="L430"></a> 430         <em class="comment">// REVISIT: it seems that this function should not take attributes, and length</em>
<a id="L431" name="L431"></a> 431         <em class="comment">//fTempString would store attribute value</em>
<a id="L432" name="L432"></a> 432         <em class="comment">///fTempString2 would store attribute non-normalized value</em>
<a id="L433" name="L433"></a> 433 
<a id="L434" name="L434"></a> 434         <em class="comment">//this function doesn't use 'attIndex'. We are adding the attribute later</em>
<a id="L435" name="L435"></a> 435         <em class="comment">//after we have figured out that current attribute is not namespace declaration</em>
<a id="L436" name="L436"></a> 436         <em class="comment">//since scanAttributeValue doesn't use attIndex parameter therefore we</em>
<a id="L437" name="L437"></a> 437         <em class="comment">//can safely add the attribute later..</em>
<a id="L438" name="L438"></a> 438         <a href="../D/10017.html" title="Multiple defined in 2 places.">XMLString</a> tmpStr = <a href="../D/22769.html" title="Multiple defined in 35 places.">getString</a>();
<a id="L439" name="L439"></a> 439         <a href="../D/31563.html" title="Multiple defined in 2 places.">scanAttributeValue</a>(tmpStr, fTempString2,
<a id="L440" name="L440"></a> 440                 fAttributeQName.rawname, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>,
<a id="L441" name="L441"></a> 441                 attrIndex, isVC, fCurrentElement.rawname);
<a id="L442" name="L442"></a> 442 
<a id="L443" name="L443"></a> 443         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = <strong class="reserved">null</strong>;
<a id="L444" name="L444"></a> 444         <em class="comment">//fTempString.toString();</em>
<a id="L445" name="L445"></a> 445 
<a id="L446" name="L446"></a> 446         <em class="comment">// record namespace declarations if any.</em>
<a id="L447" name="L447"></a> 447         <strong class="reserved">if</strong> (fBindNamespaces) <em class="brace">{</em>
<a id="L448" name="L448"></a> 448 
<a id="L449" name="L449"></a> 449             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> localpart = fAttributeQName.localpart;
<a id="L450" name="L450"></a> 450             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> = fAttributeQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> != <strong class="reserved">null</strong>
<a id="L451" name="L451"></a> 451                     ? fAttributeQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> : <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING;
<a id="L452" name="L452"></a> 452             <em class="comment">// when it's of form xmlns="..." or xmlns:prefix="...",</em>
<a id="L453" name="L453"></a> 453             <em class="comment">// it's a namespace declaration. but prefix:xmlns="..." isn't.</em>
<a id="L454" name="L454"></a> 454             <strong class="reserved">if</strong> (<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS ||
<a id="L455" name="L455"></a> 455                     <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING &amp;&amp; localpart == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS) <em class="brace">{</em>
<a id="L456" name="L456"></a> 456 
<a id="L457" name="L457"></a> 457                 <em class="comment">// get the internalized value of this attribute</em>
<a id="L458" name="L458"></a> 458                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> uri = fSymbolTable.<a href="../D/11099.html" title="Multiple defined in 6 places.">addSymbol</a>(tmpStr.ch,tmpStr.<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>,tmpStr.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L459" name="L459"></a> 459                 <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a> = uri;
<a id="L460" name="L460"></a> 460                 <em class="comment">// 1. "xmlns" can't be bound to any namespace</em>
<a id="L461" name="L461"></a> 461                 <strong class="reserved">if</strong> (<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS &amp;&amp; localpart == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS) <em class="brace">{</em>
<a id="L462" name="L462"></a> 462                     fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L463" name="L463"></a> 463                             "CantBindXMLNS",
<a id="L464" name="L464"></a> 464                             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fAttributeQName<em class="brace">}</em>,
<a id="L465" name="L465"></a> 465                             <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L466" name="L466"></a> 466                 <em class="brace">}</em>
<a id="L467" name="L467"></a> 467 
<a id="L468" name="L468"></a> 468                 <em class="comment">// 2. the namespace for "xmlns" can't be bound to any prefix</em>
<a id="L469" name="L469"></a> 469                 <strong class="reserved">if</strong> (uri == <a href="../D/5973.html" title="Multiple defined in 2 places.">NamespaceContext</a>.XMLNS_URI) <em class="brace">{</em>
<a id="L470" name="L470"></a> 470                     fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L471" name="L471"></a> 471                             "CantBindXMLNS",
<a id="L472" name="L472"></a> 472                             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fAttributeQName<em class="brace">}</em>,
<a id="L473" name="L473"></a> 473                             <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L474" name="L474"></a> 474                 <em class="brace">}</em>
<a id="L475" name="L475"></a> 475 
<a id="L476" name="L476"></a> 476                 <em class="comment">// 3. "xml" can't be bound to any other namespace than it's own</em>
<a id="L477" name="L477"></a> 477                 <strong class="reserved">if</strong> (localpart == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XML) <em class="brace">{</em>
<a id="L478" name="L478"></a> 478                     <strong class="reserved">if</strong> (uri != <a href="../D/5973.html" title="Multiple defined in 2 places.">NamespaceContext</a>.XML_URI) <em class="brace">{</em>
<a id="L479" name="L479"></a> 479                         fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L480" name="L480"></a> 480                                 "CantBindXML",
<a id="L481" name="L481"></a> 481                                 <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fAttributeQName<em class="brace">}</em>,
<a id="L482" name="L482"></a> 482                                 <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L483" name="L483"></a> 483                     <em class="brace">}</em>
<a id="L484" name="L484"></a> 484                 <em class="brace">}</em>
<a id="L485" name="L485"></a> 485                 <em class="comment">// 4. the namespace for "xml" can't be bound to any other prefix</em>
<a id="L486" name="L486"></a> 486                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L487" name="L487"></a> 487                     <strong class="reserved">if</strong> (uri ==<a href="../D/5973.html" title="Multiple defined in 2 places.">NamespaceContext</a>.XML_URI) <em class="brace">{</em>
<a id="L488" name="L488"></a> 488                         fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L489" name="L489"></a> 489                                 "CantBindXML",
<a id="L490" name="L490"></a> 490                                 <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fAttributeQName<em class="brace">}</em>,
<a id="L491" name="L491"></a> 491                                 <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L492" name="L492"></a> 492                     <em class="brace">}</em>
<a id="L493" name="L493"></a> 493                 <em class="brace">}</em>
<a id="L494" name="L494"></a> 494                 <a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> = localpart != <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS ? localpart : <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING;
<a id="L495" name="L495"></a> 495                 <em class="comment">//set it equal to XMLSymbols.PREFIX_XMLNS when namespace declaration</em>
<a id="L496" name="L496"></a> 496                 <em class="comment">// is of type xmlns = "..", in this case prefix = "" and localname = XMLSymbols.PREFIX_XMLNS</em>
<a id="L497" name="L497"></a> 497                 <em class="comment">//this special behavior is because of dependency on this behavior in DOM components</em>
<a id="L498" name="L498"></a> 498                 <strong class="reserved">if</strong>(<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING &amp;&amp; localpart == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS)<em class="brace">{</em>
<a id="L499" name="L499"></a> 499                     fAttributeQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> = <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS;
<a id="L500" name="L500"></a> 500                 <em class="brace">}</em>
<a id="L501" name="L501"></a> 501                 <em class="comment">// http://www.w3.org/TR/1999/REC-xml-names-19990114/#dt-prefix</em>
<a id="L502" name="L502"></a> 502                 <em class="comment">// We should only report an error if there is a prefix,</em>
<a id="L503" name="L503"></a> 503                 <em class="comment">// that is, the local part is not "xmlns". -SG</em>
<a id="L504" name="L504"></a> 504                 <strong class="reserved">if</strong> (uri == <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.EMPTY_STRING &amp;&amp; localpart != <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.PREFIX_XMLNS) <em class="brace">{</em>
<a id="L505" name="L505"></a> 505                     fErrorReporter.<a href="../D/31088.html" title="Multiple defined in 17 places.">reportError</a>(<a href="../S/5027.html#L39" title="Defined at 39 in src/com/sun/org/apache/xerces/internal/impl/msg/XMLMessageFormatter.java.">XMLMessageFormatter</a>.XMLNS_DOMAIN,
<a id="L506" name="L506"></a> 506                             "EmptyPrefixedAttName",
<a id="L507" name="L507"></a> 507                             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fAttributeQName<em class="brace">}</em>,
<a id="L508" name="L508"></a> 508                             <a href="../S/5041.html#L116" title="Defined at 116 in src/com/sun/org/apache/xerces/internal/impl/XMLErrorReporter.java.">XMLErrorReporter</a>.SEVERITY_FATAL_ERROR);
<a id="L509" name="L509"></a> 509                 <em class="brace">}</em>
<a id="L510" name="L510"></a> 510 
<a id="L511" name="L511"></a> 511                 <em class="comment">// check for duplicate prefix bindings</em>
<a id="L512" name="L512"></a> 512                 <strong class="reserved">if</strong> (((com.sun.org.apache.xerces.internal.util.<a href="../D/5978.html" title="Multiple defined in 2 places.">NamespaceSupport</a>) fNamespaceContext).<a href="../S/5299.html#L382" title="Defined at 382 in src/com/sun/org/apache/xerces/internal/util/NamespaceSupport.java.">containsPrefixInCurrentContext</a>(<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a>)) <em class="brace">{</em>
<a id="L513" name="L513"></a> 513                     <a href="../D/31090.html" title="Multiple defined in 5 places.">reportFatalError</a>("AttributeNotUnique",
<a id="L514" name="L514"></a> 514                             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fCurrentElement.rawname,
<a id="L515" name="L515"></a> 515                             fAttributeQName.rawname<em class="brace">}</em>);
<a id="L516" name="L516"></a> 516                 <em class="brace">}</em>
<a id="L517" name="L517"></a> 517 
<a id="L518" name="L518"></a> 518                 <em class="comment">// declare prefix in context</em>
<a id="L519" name="L519"></a> 519                 <strong class="reserved">boolean</strong> declared = fNamespaceContext.<a href="../D/14512.html" title="Multiple defined in 8 places.">declarePrefix</a>(<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a>, uri.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() != 0 ? uri : <strong class="reserved">null</strong>);
<a id="L520" name="L520"></a> 520 
<a id="L521" name="L521"></a> 521                 <em class="comment">// check for duplicate xmlns declarations</em>
<a id="L522" name="L522"></a> 522                 <strong class="reserved">if</strong> (!declared) <em class="brace">{</em> <em class="comment">// by convention, prefix == "xmlns" | "xml"</em>
<a id="L523" name="L523"></a> 523                     <em class="comment">// error if duplicate declaration</em>
<a id="L524" name="L524"></a> 524                     <strong class="reserved">if</strong> (fXmlnsDeclared) <em class="brace">{</em>
<a id="L525" name="L525"></a> 525                         <a href="../D/31090.html" title="Multiple defined in 5 places.">reportFatalError</a>("AttributeNotUnique",
<a id="L526" name="L526"></a> 526                                 <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fCurrentElement.rawname,
<a id="L527" name="L527"></a> 527                                 fAttributeQName.rawname<em class="brace">}</em>);
<a id="L528" name="L528"></a> 528                     <em class="brace">}</em>
<a id="L529" name="L529"></a> 529 
<a id="L530" name="L530"></a> 530                     <em class="comment">// xmlns declared</em>
<a id="L531" name="L531"></a> 531                     fXmlnsDeclared = <strong class="reserved">true</strong>;
<a id="L532" name="L532"></a> 532                 <em class="brace">}</em>
<a id="L533" name="L533"></a> 533 
<a id="L534" name="L534"></a> 534                 <em class="comment">//xerces internals (XSAttributeChecker) has dependency on namespace declaration returned</em>
<a id="L535" name="L535"></a> 535                 <em class="comment">//as part of XMLAttributes.</em>
<a id="L536" name="L536"></a> 536                 <em class="comment">//addition of namespace declaration to the attribute list is controlled by fNotAddNSDeclAsAttribute</em>
<a id="L537" name="L537"></a> 537                 <em class="comment">//feature. This is required in Stax where namespace declarations are not considered as attribute</em>
<a id="L538" name="L538"></a> 538 
<a id="L539" name="L539"></a> 539                 <strong class="reserved">if</strong>(fNotAddNSDeclAsAttribute)<em class="brace">{</em>
<a id="L540" name="L540"></a> 540                     <strong class="reserved">return</strong> ;
<a id="L541" name="L541"></a> 541                 <em class="brace">}</em>
<a id="L542" name="L542"></a> 542             <em class="brace">}</em>
<a id="L543" name="L543"></a> 543         <em class="brace">}</em>
<a id="L544" name="L544"></a> 544 
<a id="L545" name="L545"></a> 545         <em class="comment">//add the attributes to the list of attributes</em>
<a id="L546" name="L546"></a> 546         <strong class="reserved">if</strong> (fBindNamespaces) <em class="brace">{</em>
<a id="L547" name="L547"></a> 547             attrIndex = <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>();
<a id="L548" name="L548"></a> 548             <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../S/5286.html#L767" title="Defined at 767 in src/com/sun/org/apache/xerces/internal/util/XMLAttributesImpl.java.">addAttributeNS</a>(fAttributeQName, <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.fCDATASymbol, <strong class="reserved">null</strong>);
<a id="L549" name="L549"></a> 549         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L550" name="L550"></a> 550             <strong class="reserved">int</strong> oldLen = <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>();
<a id="L551" name="L551"></a> 551             attrIndex = <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/10660.html" title="Multiple defined in 56 places.">addAttribute</a>(fAttributeQName, <a href="../S/5315.html#L28" title="Defined at 28 in src/com/sun/org/apache/xerces/internal/util/XMLSymbols.java.">XMLSymbols</a>.fCDATASymbol, <strong class="reserved">null</strong>);
<a id="L552" name="L552"></a> 552 
<a id="L553" name="L553"></a> 553             <em class="comment">// WFC: Unique Att Spec</em>
<a id="L554" name="L554"></a> 554             <strong class="reserved">if</strong> (oldLen == <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/20075.html" title="Multiple defined in 116 places.">getLength</a>()) <em class="brace">{</em>
<a id="L555" name="L555"></a> 555                 <a href="../D/31090.html" title="Multiple defined in 5 places.">reportFatalError</a>("AttributeNotUnique",
<a id="L556" name="L556"></a> 556                         <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em>fCurrentElement.rawname,
<a id="L557" name="L557"></a> 557                                 fAttributeQName.rawname<em class="brace">}</em>);
<a id="L558" name="L558"></a> 558             <em class="brace">}</em>
<a id="L559" name="L559"></a> 559         <em class="brace">}</em>
<a id="L560" name="L560"></a> 560 
<a id="L561" name="L561"></a> 561         <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/34263.html" title="Multiple defined in 100 places.">setValue</a>(attrIndex, <a href="../D/36360.html" title="Multiple defined in 73 places.">value</a>,tmpStr);
<a id="L562" name="L562"></a> 562         <em class="comment">//attributes.setNonNormalizedValue(attrIndex, fTempString2.toString());</em>
<a id="L563" name="L563"></a> 563         <em class="comment">//removing  as we are not using non-normalized values . -Venu</em>
<a id="L564" name="L564"></a> 564         <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/33986.html" title="Multiple defined in 5 places.">setSpecified</a>(attrIndex, <strong class="reserved">true</strong>);
<a id="L565" name="L565"></a> 565 
<a id="L566" name="L566"></a> 566         <em class="comment">// attempt to bind attribute</em>
<a id="L567" name="L567"></a> 567         <strong class="reserved">if</strong> (fAttributeQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L568" name="L568"></a> 568             <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/34206.html" title="Multiple defined in 6 places.">setURI</a>(attrIndex, fNamespaceContext.<a href="../D/23369.html" title="Multiple defined in 43 places.">getURI</a>(fAttributeQName.<a href="../S/3963.html#L53" title="Defined at 53 in src/javax/xml/bind/annotation/XmlNs.java.">prefix</a>));
<a id="L569" name="L569"></a> 569         <em class="brace">}</em>
<a id="L570" name="L570"></a> 570 
<a id="L571" name="L571"></a> 571         <strong class="reserved">if</strong> (DEBUG_START_END_ELEMENT) <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>(<strong class="reserved">this</strong>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>().<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() +"&lt;&lt;&lt; scanAttribute()");
<a id="L572" name="L572"></a> 572     <em class="brace">}</em> <em class="comment">// scanAttribute(XMLAttributes)</em>
<a id="L573" name="L573"></a> 573 
<a id="L574" name="L574"></a> 574 
<a id="L575" name="L575"></a> 575 
<a id="L576" name="L576"></a> 576 
<a id="L577" name="L577"></a> 577 
<div class="comment">
     /** Creates a content driver. */</div>
<a id="L579" name="L579"></a> 579     <strong class="reserved">protected</strong> <a href="../D/2636.html" title="Multiple defined in 2 places.">Driver</a> <a href="../S/5233.html#L337" title="Referred from 337 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentFragmentScannerImpl.java.">createContentDriver</a>() <em class="brace">{</em>
<a id="L580" name="L580"></a> 580         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/5006.html#L586" title="Defined at 586 in src/com/sun/org/apache/xerces/internal/impl/XMLNSDocumentScannerImpl.java.">NSContentDriver</a>();
<a id="L581" name="L581"></a> 581     <em class="brace">}</em> <em class="comment">// createContentDriver():Driver</em>
<a id="L582" name="L582"></a> 582 
<div class="comment">
      Driver to handle content scanning.</div>
<a id="L586" name="L586"></a> 586     <strong class="reserved">protected</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../S/5006.html#L580" title="Referred from 580 in src/com/sun/org/apache/xerces/internal/impl/XMLNSDocumentScannerImpl.java.">NSContentDriver</a>
<a id="L587" name="L587"></a> 587             <strong class="reserved">extends</strong> <a href="../S/5032.html#L1223" title="Defined at 1223 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentScannerImpl.java.">ContentDriver</a> <em class="brace">{</em>
<div class="comment">
          Scan for root element hook. This method is a hook for
          subclasses to add code that handles scanning for the root
          element. This method will also attempt to remove DTD validator
          from the pipeline, if there is no DTD grammar. If DTD validator
          is no longer in the pipeline bind namespaces in the scanner.
          @return True if the caller should stop and return true which
                   allows the scanner to switch to a new scanning
                   driver. A return value of false indicates that
                   the content driver should continue as normal.</div>
<a id="L601" name="L601"></a> 601         <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../S/5233.html#L3138" title="Referred from 3138 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentFragmentScannerImpl.java.">scanRootElementHook</a>()
<a id="L602" name="L602"></a> 602         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/5491.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/xni/XNIException.java.">XNIException</a> <em class="brace">{</em>
<a id="L603" name="L603"></a> 603 
<a id="L604" name="L604"></a> 604             <a href="../D/30391.html" title="Multiple defined in 2 places.">reconfigurePipeline</a>();
<a id="L605" name="L605"></a> 605             <strong class="reserved">if</strong> (<a href="../D/31609.html" title="Multiple defined in 3 places.">scanStartElement</a>()) <em class="brace">{</em>
<a id="L606" name="L606"></a> 606                 <a href="../D/33806.html" title="Multiple defined in 2 places.">setScannerState</a>(SCANNER_STATE_TRAILING_MISC);
<a id="L607" name="L607"></a> 607                 <a href="../S/5233.html#L1986" title="Defined at 1986 in src/com/sun/org/apache/xerces/internal/impl/XMLDocumentFragmentScannerImpl.java.">setDriver</a>(fTrailingMiscDriver);
<a id="L608" name="L608"></a> 608                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L609" name="L609"></a> 609             <em class="brace">}</em>
<a id="L610" name="L610"></a> 610             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L611" name="L611"></a> 611 
<a id="L612" name="L612"></a> 612         <em class="brace">}</em> <em class="comment">// scanRootElementHook():boolean</em>
<a id="L613" name="L613"></a> 613 
<div class="comment">
          Re-configures pipeline by removing the DTD validator
          if no DTD grammar exists. If no validator exists in the
          pipeline or there is no DTD grammar, namespace binding
          is performed by the scanner in the enclosing class.</div>
<a id="L620" name="L620"></a> 620         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25657.html" title="Multiple referred from 3 places.">reconfigurePipeline</a>() <em class="brace">{</em>
<a id="L621" name="L621"></a> 621             <em class="comment">//fDTDValidator will be null in Stax mode</em>
<a id="L622" name="L622"></a> 622             <strong class="reserved">if</strong> (fNamespaces &amp;&amp; fDTDValidator == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L623" name="L623"></a> 623                 fBindNamespaces = <strong class="reserved">true</strong>;
<a id="L624" name="L624"></a> 624             <em class="brace">}</em>
<a id="L625" name="L625"></a> 625             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (fNamespaces &amp;&amp; !fDTDValidator.<a href="../D/24101.html" title="Multiple defined in 2 places.">hasGrammar</a>() ) <em class="brace">{</em>
<a id="L626" name="L626"></a> 626                 fBindNamespaces = <strong class="reserved">true</strong>;
<a id="L627" name="L627"></a> 627                 fPerformValidation = fDTDValidator.<a href="../D/36318.html" title="Multiple defined in 59 places.">validate</a>();
<a id="L628" name="L628"></a> 628                 <em class="comment">// re-configure pipeline by removing DTDValidator</em>
<a id="L629" name="L629"></a> 629                 <a href="../S/5502.html#L37" title="Defined at 37 in src/com/sun/org/apache/xerces/internal/xni/parser/XMLDocumentSource.java.">XMLDocumentSource</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> = fDTDValidator.<a href="../D/18567.html" title="Multiple defined in 16 places.">getDocumentSource</a>();
<a id="L630" name="L630"></a> 630                 <a href="../S/5518.html#L34" title="Defined at 34 in src/com/sun/org/apache/xerces/internal/xni/XMLDocumentHandler.java.">XMLDocumentHandler</a> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a> = fDTDValidator.<a href="../D/18561.html" title="Multiple defined in 17 places.">getDocumentHandler</a>();
<a id="L631" name="L631"></a> 631                 <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>.<a href="../D/32498.html" title="Multiple defined in 21 places.">setDocumentHandler</a>(<a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>);
<a id="L632" name="L632"></a> 632                 <strong class="reserved">if</strong> (<a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a> != <strong class="reserved">null</strong>)
<a id="L633" name="L633"></a> 633                     <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>.<a href="../D/32502.html" title="Multiple defined in 16 places.">setDocumentSource</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L634" name="L634"></a> 634                 fDTDValidator.<a href="../D/32502.html" title="Multiple defined in 16 places.">setDocumentSource</a>(<strong class="reserved">null</strong>);
<a id="L635" name="L635"></a> 635                 fDTDValidator.<a href="../D/32498.html" title="Multiple defined in 21 places.">setDocumentHandler</a>(<strong class="reserved">null</strong>);
<a id="L636" name="L636"></a> 636             <em class="brace">}</em>
<a id="L637" name="L637"></a> 637         <em class="brace">}</em> <em class="comment">// reconfigurePipeline()</em>
<a id="L638" name="L638"></a> 638     <em class="brace">}</em>
<a id="L639" name="L639"></a> 639 
<a id="L640" name="L640"></a> 640 <em class="brace">}</em> <em class="comment">// class XMLNSDocumentScannerImpl</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L88">[^]</a><a href="#L620">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>