<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/net/IDN.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L111">[^]</a><a href="#L492">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L111" title="Defined at 111.">toASCII</a></li>
<li><a href="#L150" title="Defined at 150.">toASCII</a></li>
<li><a href="#L173" title="Defined at 173.">toUnicode</a></li>
<li><a href="#L209" title="Defined at 209.">toUnicode</a></li>
<li><a href="#L260" title="Defined at 260.">toASCIIInternal</a></li>
<li><a href="#L349" title="Defined at 349.">toUnicodeInternal</a></li>
<li><a href="#L414" title="Defined at 414.">isNonLDHAsciiCodePoint</a></li>
<li><a href="#L428" title="Defined at 428.">searchDots</a></li>
<li><a href="#L442" title="Defined at 442.">isRootLabel</a></li>
<li><a href="#L449" title="Defined at 449.">isLabelSeparator</a></li>
<li><a href="#L456" title="Defined at 456.">isAllASCII</a></li>
<li><a href="#L471" title="Defined at 471.">startsWithACEPrefix</a></li>
<li><a href="#L485" title="Defined at 485.">toASCIILower</a></li>
<li><a href="#L492" title="Defined at 492.">toASCIILower</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2005, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.net;
<a id="L26" name="L26"></a>  26 
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> java.io.InputStream;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> java.io.IOException;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.security.AccessController;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.security.PrivilegedAction;
<a id="L31" name="L31"></a>  31 
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> sun.net.idn.StringPrep;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> sun.net.idn.Punycode;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> sun.text.normalizer.UCharacterIterator;
<a id="L35" name="L35"></a>  35 
<div class="comment">
  Provides methods to convert internationalized domain names (IDNs) between
  a normal Unicode representation and an ASCII Compatible Encoding (ACE) representation.
  Internationalized domain names can use characters from the entire range of
  Unicode, while traditional domain names are restricted to ASCII characters.
  ACE is an encoding of Unicode strings that uses only ASCII characters and
  can be used with software (such as the Domain Name System) that only
  understands traditional domain names.
  <p>Internationalized domain names are defined in <a href="http://www.ietf.org/rfc/rfc3490.txt">RFC 3490</a>.
  RFC 3490 defines two operations: ToASCII and ToUnicode. These 2 operations employ
  <a href="http://www.ietf.org/rfc/rfc3491.txt">Nameprep</a> algorithm, which is a
  profile of <a href="http://www.ietf.org/rfc/rfc3454.txt">Stringprep</a>, and
  <a href="http://www.ietf.org/rfc/rfc3492.txt">Punycode</a> algorithm to convert
  domain name string back and forth.
  </p><p>The behavior of aforementioned conversion process can be adjusted by various flags:
    </p><ul><li>If the ALLOW_UNASSIGNED flag is used, the domain name string to be converted
          can contain code points that are unassigned in Unicode 3.2, which is the
          Unicode version on which IDN conversion is based. If the flag is not used,
          the presence of such unassigned code points is treated as an error.
      </li><li>If the USE_STD3_ASCII_RULES flag is used, ASCII strings are checked against <a href="http://www.ietf.org/rfc/rfc1122.txt">RFC 1122</a> and <a href="http://www.ietf.org/rfc/rfc1123.txt">RFC 1123</a>.
          It is an error if they don't meet the requirements.
    </li></ul>
  These flags can be logically OR'ed together.
  <p>The security consideration is important with respect to internationalization
  domain name support. For example, English domain names may be <i>homographed</i>
  - maliciously misspelled by substitution of non-Latin letters.
  <a href="http://www.unicode.org/reports/tr36/">Unicode Technical Report #36</a>
  discusses security issues of IDN support as well as possible solutions.
  Applications are responsible for taking adequate security measures when using
  international domain names.
  @author Edward Wang
  @since 1.6</p></div>
<a id="L75" name="L75"></a>  75 <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> IDN <em class="brace">{</em>
<div class="comment">
      Flag to allow processing of unassigned code points</div>
<a id="L79" name="L79"></a>  79     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> ALLOW_UNASSIGNED = 0x01;
<a id="L80" name="L80"></a>  80 
<div class="comment">
      Flag to turn on the check against STD-3 ASCII rules</div>
<a id="L84" name="L84"></a>  84     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> USE_STD3_ASCII_RULES = 0x02;
<a id="L85" name="L85"></a>  85 
<a id="L86" name="L86"></a>  86 
<div class="comment">
      Translates a string from Unicode to ASCII Compatible Encoding (ACE),
      as defined by the ToASCII operation of <a href="http://www.ietf.org/rfc/rfc3490.txt">RFC 3490</a>.
      <p>ToASCII operation can fail. ToASCII fails if any step of it fails.
      If ToASCII operation fails, an IllegalArgumentException will be thrown.
      In this case, the input string should not be used in an internationalized domain name.
      </p><p> A label is an individual part of a domain name. The original ToASCII operation,
      as defined in RFC 3490, only operates on a single label. This method can handle
      both label and entire domain name, by assuming that labels in a domain name are
      always separated by dots. The following characters are recognized as dots:
      \u002E (full stop), \u3002 (ideographic full stop), \uFF0E (fullwidth full stop),
      and \uFF61 (halfwidth ideographic full stop). if dots are
      used as label separators, this method also changes all of them to \u002E (full stop)
      in output translated string.
      @param input     the string to be processed
      @param flag      process flag; can be 0 or any logical OR of possible flags
      @return          the translated <code>String</code>
      @throws IllegalArgumentException   if the input string doesn't conform to RFC 3490 specification</p></div>
<a id="L111" name="L111"></a> 111     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29208.html" title="Multiple referred from 2 places.">toASCII</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>, <strong class="reserved">int</strong> flag)
<a id="L112" name="L112"></a> 112     <em class="brace">{</em>
<a id="L113" name="L113"></a> 113         <strong class="reserved">int</strong> p = 0, q = 0;
<a id="L114" name="L114"></a> 114         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L115" name="L115"></a> 115 
<a id="L116" name="L116"></a> 116         <strong class="reserved">if</strong> (<a href="../S/769.html#L442" title="Defined at 442 in src/java/net/IDN.java.">isRootLabel</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>)) <em class="brace">{</em>
<a id="L117" name="L117"></a> 117             <strong class="reserved">return</strong> ".";
<a id="L118" name="L118"></a> 118         <em class="brace">}</em>
<a id="L119" name="L119"></a> 119 
<a id="L120" name="L120"></a> 120         <strong class="reserved">while</strong> (p &lt; <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <em class="brace">{</em>
<a id="L121" name="L121"></a> 121             q = <a href="../S/769.html#L428" title="Defined at 428 in src/java/net/IDN.java.">searchDots</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>, p);
<a id="L122" name="L122"></a> 122             <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/769.html#L260" title="Defined at 260 in src/java/net/IDN.java.">toASCIIInternal</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, q),  flag));
<a id="L123" name="L123"></a> 123             <strong class="reserved">if</strong> (q != (<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>())) <em class="brace">{</em>
<a id="L124" name="L124"></a> 124                <em class="comment">// has more labels, or keep the trailing dot as at present</em>
<a id="L125" name="L125"></a> 125                <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('.');
<a id="L126" name="L126"></a> 126             <em class="brace">}</em>
<a id="L127" name="L127"></a> 127             p = q + 1;
<a id="L128" name="L128"></a> 128         <em class="brace">}</em>
<a id="L129" name="L129"></a> 129 
<a id="L130" name="L130"></a> 130         <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L131" name="L131"></a> 131     <em class="brace">}</em>
<a id="L132" name="L132"></a> 132 
<a id="L133" name="L133"></a> 133 
<div class="comment">
      Translates a string from Unicode to ASCII Compatible Encoding (ACE),
      as defined by the ToASCII operation of <a href="http://www.ietf.org/rfc/rfc3490.txt">RFC 3490</a>.
      <p> This convenience method works as if by invoking the
      two-argument counterpart as follows:
      </p><blockquote>
      {@link #toASCII(String, int) toASCII}(input,&nbsp;0);
      </blockquote>
      @param input     the string to be processed
      @return          the translated <code>String</code>
      @throws IllegalArgumentException   if the input string doesn't conform to RFC 3490 specification</div>
<a id="L150" name="L150"></a> 150     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29208.html" title="Multiple referred from 2 places.">toASCII</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>) <em class="brace">{</em>
<a id="L151" name="L151"></a> 151         <strong class="reserved">return</strong> <a href="../D/35343.html" title="Multiple defined in 2 places.">toASCII</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>, 0);
<a id="L152" name="L152"></a> 152     <em class="brace">}</em>
<a id="L153" name="L153"></a> 153 
<a id="L154" name="L154"></a> 154 
<div class="comment">
      Translates a string from ASCII Compatible Encoding (ACE) to Unicode,
      as defined by the ToUnicode operation of <a href="http://www.ietf.org/rfc/rfc3490.txt">RFC 3490</a>.
      <p>ToUnicode never fails. In case of any error, the input string is returned unmodified.
      </p><p> A label is an individual part of a domain name. The original ToUnicode operation,
      as defined in RFC 3490, only operates on a single label. This method can handle
      both label and entire domain name, by assuming that labels in a domain name are
      always separated by dots. The following characters are recognized as dots:
      \u002E (full stop), \u3002 (ideographic full stop), \uFF0E (fullwidth full stop),
      and \uFF61 (halfwidth ideographic full stop).
      @param input     the string to be processed
      @param flag      process flag; can be 0 or any logical OR of possible flags
      @return          the translated <code>String</code></p></div>
<a id="L173" name="L173"></a> 173     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/769.html#L210" title="Referred from 210 in src/java/net/IDN.java.">toUnicode</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>, <strong class="reserved">int</strong> flag) <em class="brace">{</em>
<a id="L174" name="L174"></a> 174         <strong class="reserved">int</strong> p = 0, q = 0;
<a id="L175" name="L175"></a> 175         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a> = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L176" name="L176"></a> 176 
<a id="L177" name="L177"></a> 177         <strong class="reserved">if</strong> (<a href="../S/769.html#L442" title="Defined at 442 in src/java/net/IDN.java.">isRootLabel</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>)) <em class="brace">{</em>
<a id="L178" name="L178"></a> 178             <strong class="reserved">return</strong> ".";
<a id="L179" name="L179"></a> 179         <em class="brace">}</em>
<a id="L180" name="L180"></a> 180 
<a id="L181" name="L181"></a> 181         <strong class="reserved">while</strong> (p &lt; <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()) <em class="brace">{</em>
<a id="L182" name="L182"></a> 182             q = <a href="../S/769.html#L428" title="Defined at 428 in src/java/net/IDN.java.">searchDots</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>, p);
<a id="L183" name="L183"></a> 183             <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/769.html#L349" title="Defined at 349 in src/java/net/IDN.java.">toUnicodeInternal</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(p, q),  flag));
<a id="L184" name="L184"></a> 184             <strong class="reserved">if</strong> (q != (<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>())) <em class="brace">{</em>
<a id="L185" name="L185"></a> 185                <em class="comment">// has more labels, or keep the trailing dot as at present</em>
<a id="L186" name="L186"></a> 186                <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>('.');
<a id="L187" name="L187"></a> 187             <em class="brace">}</em>
<a id="L188" name="L188"></a> 188             p = q + 1;
<a id="L189" name="L189"></a> 189         <em class="brace">}</em>
<a id="L190" name="L190"></a> 190 
<a id="L191" name="L191"></a> 191         <strong class="reserved">return</strong> <a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L192" name="L192"></a> 192     <em class="brace">}</em>
<a id="L193" name="L193"></a> 193 
<a id="L194" name="L194"></a> 194 
<div class="comment">
      Translates a string from ASCII Compatible Encoding (ACE) to Unicode,
      as defined by the ToUnicode operation of <a href="http://www.ietf.org/rfc/rfc3490.txt">RFC 3490</a>.
      <p> This convenience method works as if by invoking the
      two-argument counterpart as follows:
      </p><blockquote>
      {@link #toUnicode(String, int) toUnicode}(input,&nbsp;0);
      </blockquote>
      @param input     the string to be processed
      @return          the translated <code>String</code></div>
<a id="L209" name="L209"></a> 209     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/769.html#L210" title="Referred from 210 in src/java/net/IDN.java.">toUnicode</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>) <em class="brace">{</em>
<a id="L210" name="L210"></a> 210         <strong class="reserved">return</strong> <a href="../D/35504.html" title="Multiple defined in 2 places.">toUnicode</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>, 0);
<a id="L211" name="L211"></a> 211     <em class="brace">}</em>
<a id="L212" name="L212"></a> 212 
<a id="L213" name="L213"></a> 213 
<div class="comment">
     /* ---------------- Private members -------------- */</div>
<a id="L215" name="L215"></a> 215 
<a id="L216" name="L216"></a> 216     <em class="comment">// ACE Prefix is "xn--"</em>
<a id="L217" name="L217"></a> 217     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> ACE_PREFIX = "xn--";
<a id="L218" name="L218"></a> 218     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> ACE_PREFIX_LENGTH = ACE_PREFIX.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();
<a id="L219" name="L219"></a> 219 
<a id="L220" name="L220"></a> 220     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> MAX_LABEL_LENGTH   = 63;
<a id="L221" name="L221"></a> 221 
<a id="L222" name="L222"></a> 222     <em class="comment">// single instance of nameprep</em>
<a id="L223" name="L223"></a> 223     <strong class="reserved">private</strong> <strong class="reserved">static</strong> StringPrep namePrep = <strong class="reserved">null</strong>;
<a id="L224" name="L224"></a> 224 
<a id="L225" name="L225"></a> 225     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L226" name="L226"></a> 226         <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a> = <strong class="reserved">null</strong>;
<a id="L227" name="L227"></a> 227 
<a id="L228" name="L228"></a> 228         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L229" name="L229"></a> 229             <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> IDN_PROFILE = "uidna.spp";
<a id="L230" name="L230"></a> 230             <strong class="reserved">if</strong> (<a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L333" title="Defined at 333 in src/java/lang/System.java.">getSecurityManager</a>() != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L231" name="L231"></a> 231                 <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a> = <a href="../S/1248.html#L264" title="Defined at 264 in src/java/security/AccessController.java.">AccessController</a>.<a href="../D/15060.html" title="Multiple defined in 7 places.">doPrivileged</a>(<strong class="reserved">new</strong> <a href="../S/1321.html#L42" title="Defined at 42 in src/java/security/PrivilegedAction.java.">PrivilegedAction</a>&lt;<a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a>&gt;() <em class="brace">{</em>
<a id="L232" name="L232"></a> 232                     <strong class="reserved">public</strong> <a href="../D/4231.html" title="Multiple defined in 3 places.">InputStream</a> <a href="../D/31480.html" title="Multiple defined in 101 places.">run</a>() <em class="brace">{</em>
<a id="L233" name="L233"></a> 233                         <strong class="reserved">return</strong> StringPrep.<strong class="reserved">class</strong>.<a href="../D/22045.html" title="Multiple defined in 30 places.">getResourceAsStream</a>(IDN_PROFILE);
<a id="L234" name="L234"></a> 234                     <em class="brace">}</em>
<a id="L235" name="L235"></a> 235                 <em class="brace">}</em>);
<a id="L236" name="L236"></a> 236             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L237" name="L237"></a> 237                 <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a> = StringPrep.<strong class="reserved">class</strong>.<a href="../D/22045.html" title="Multiple defined in 30 places.">getResourceAsStream</a>(IDN_PROFILE);
<a id="L238" name="L238"></a> 238             <em class="brace">}</em>
<a id="L239" name="L239"></a> 239 
<a id="L240" name="L240"></a> 240             namePrep = <strong class="reserved">new</strong> StringPrep(<a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>);
<a id="L241" name="L241"></a> 241             <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L242" name="L242"></a> 242         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> e) <em class="brace">{</em>
<a id="L243" name="L243"></a> 243             <em class="comment">// should never reach here</em>
<a id="L244" name="L244"></a> 244             <a href="../S/1616.html#L490" title="Defined at 490 in src/java/lang/invoke/MethodType.java.">assert</a> <strong class="reserved">false</strong>;
<a id="L245" name="L245"></a> 245         <em class="brace">}</em>
<a id="L246" name="L246"></a> 246     <em class="brace">}</em>
<a id="L247" name="L247"></a> 247 
<a id="L248" name="L248"></a> 248 
<div class="comment">
     /* ---------------- Private operations -------------- */</div>
<a id="L250" name="L250"></a> 250 
<a id="L251" name="L251"></a> 251 
<a id="L252" name="L252"></a> 252     <em class="comment">//</em>
<a id="L253" name="L253"></a> 253     <em class="comment">// to suppress the default zero-argument constructor</em>
<a id="L254" name="L254"></a> 254     <em class="comment">//</em>
<a id="L255" name="L255"></a> 255     <strong class="reserved">private</strong> IDN() <em class="brace">{</em><em class="brace">}</em>
<a id="L256" name="L256"></a> 256 
<a id="L257" name="L257"></a> 257     <em class="comment">//</em>
<a id="L258" name="L258"></a> 258     <em class="comment">// toASCII operation; should only apply to a single label</em>
<a id="L259" name="L259"></a> 259     <em class="comment">//</em>
<a id="L260" name="L260"></a> 260     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/769.html#L122" title="Referred from 122 in src/java/net/IDN.java.">toASCIIInternal</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>, <strong class="reserved">int</strong> flag)
<a id="L261" name="L261"></a> 261     <em class="brace">{</em>
<a id="L262" name="L262"></a> 262         <em class="comment">// step 1</em>
<a id="L263" name="L263"></a> 263         <em class="comment">// Check if the string contains code points outside the ASCII range 0..0x7c.</em>
<a id="L264" name="L264"></a> 264         <strong class="reserved">boolean</strong> isASCII  = <a href="../S/769.html#L456" title="Defined at 456 in src/java/net/IDN.java.">isAllASCII</a>(<a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>);
<a id="L265" name="L265"></a> 265         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> dest;
<a id="L266" name="L266"></a> 266 
<a id="L267" name="L267"></a> 267         <em class="comment">// step 2</em>
<a id="L268" name="L268"></a> 268         <em class="comment">// perform the nameprep operation; flag ALLOW_UNASSIGNED is used here</em>
<a id="L269" name="L269"></a> 269         <strong class="reserved">if</strong> (!isASCII) <em class="brace">{</em>
<a id="L270" name="L270"></a> 270             UCharacterIterator <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a> = UCharacterIterator.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>(<a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>);
<a id="L271" name="L271"></a> 271             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L272" name="L272"></a> 272                 dest = namePrep.<a href="../D/29556.html" title="Multiple defined in 6 places.">prepare</a>(<a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>, flag);
<a id="L273" name="L273"></a> 273             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/6624.html" title="Multiple defined in 3 places.">ParseException</a> e) <em class="brace">{</em>
<a id="L274" name="L274"></a> 274                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(e);
<a id="L275" name="L275"></a> 275             <em class="brace">}</em>
<a id="L276" name="L276"></a> 276         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L277" name="L277"></a> 277             dest = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>(<a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>);
<a id="L278" name="L278"></a> 278         <em class="brace">}</em>
<a id="L279" name="L279"></a> 279 
<a id="L280" name="L280"></a> 280         <em class="comment">// step 8, move forward to check the smallest number of the code points</em>
<a id="L281" name="L281"></a> 281         <em class="comment">// the length must be inside 1..63</em>
<a id="L282" name="L282"></a> 282         <strong class="reserved">if</strong> (dest.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 0) <em class="brace">{</em>
<a id="L283" name="L283"></a> 283             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L284" name="L284"></a> 284                         "Empty label is not a legal name");
<a id="L285" name="L285"></a> 285         <em class="brace">}</em>
<a id="L286" name="L286"></a> 286 
<a id="L287" name="L287"></a> 287         <em class="comment">// step 3</em>
<a id="L288" name="L288"></a> 288         <em class="comment">// Verify the absence of non-LDH ASCII code points</em>
<a id="L289" name="L289"></a> 289         <em class="comment">//   0..0x2c, 0x2e..0x2f, 0x3a..0x40, 0x5b..0x60, 0x7b..0x7f</em>
<a id="L290" name="L290"></a> 290         <em class="comment">// Verify the absence of leading and trailing hyphen</em>
<a id="L291" name="L291"></a> 291         <strong class="reserved">boolean</strong> useSTD3ASCIIRules = ((flag &amp; USE_STD3_ASCII_RULES) != 0);
<a id="L292" name="L292"></a> 292         <strong class="reserved">if</strong> (useSTD3ASCIIRules) <em class="brace">{</em>
<a id="L293" name="L293"></a> 293             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; dest.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>(); i++) <em class="brace">{</em>
<a id="L294" name="L294"></a> 294                 <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = dest.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L295" name="L295"></a> 295                 <strong class="reserved">if</strong> (<a href="../S/769.html#L414" title="Defined at 414 in src/java/net/IDN.java.">isNonLDHAsciiCodePoint</a>(<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)) <em class="brace">{</em>
<a id="L296" name="L296"></a> 296                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L297" name="L297"></a> 297                         "Contains non-LDH ASCII characters");
<a id="L298" name="L298"></a> 298                 <em class="brace">}</em>
<a id="L299" name="L299"></a> 299             <em class="brace">}</em>
<a id="L300" name="L300"></a> 300 
<a id="L301" name="L301"></a> 301             <strong class="reserved">if</strong> (dest.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0) == '-' ||
<a id="L302" name="L302"></a> 302                 dest.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(dest.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() - 1) == '-') <em class="brace">{</em>
<a id="L303" name="L303"></a> 303 
<a id="L304" name="L304"></a> 304                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(
<a id="L305" name="L305"></a> 305                         "Has leading or trailing hyphen");
<a id="L306" name="L306"></a> 306             <em class="brace">}</em>
<a id="L307" name="L307"></a> 307         <em class="brace">}</em>
<a id="L308" name="L308"></a> 308 
<a id="L309" name="L309"></a> 309         <strong class="reserved">if</strong> (!isASCII) <em class="brace">{</em>
<a id="L310" name="L310"></a> 310             <em class="comment">// step 4</em>
<a id="L311" name="L311"></a> 311             <em class="comment">// If all code points are inside 0..0x7f, skip to step 8</em>
<a id="L312" name="L312"></a> 312             <strong class="reserved">if</strong> (!<a href="../S/769.html#L456" title="Defined at 456 in src/java/net/IDN.java.">isAllASCII</a>(dest.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>())) <em class="brace">{</em>
<a id="L313" name="L313"></a> 313                 <em class="comment">// step 5</em>
<a id="L314" name="L314"></a> 314                 <em class="comment">// verify the sequence does not begin with ACE prefix</em>
<a id="L315" name="L315"></a> 315                 <strong class="reserved">if</strong>(!<a href="../S/769.html#L471" title="Defined at 471 in src/java/net/IDN.java.">startsWithACEPrefix</a>(dest))<em class="brace">{</em>
<a id="L316" name="L316"></a> 316 
<a id="L317" name="L317"></a> 317                     <em class="comment">// step 6</em>
<a id="L318" name="L318"></a> 318                     <em class="comment">// encode the sequence with punycode</em>
<a id="L319" name="L319"></a> 319                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L320" name="L320"></a> 320                         dest = Punycode.<a href="../D/15393.html" title="Multiple defined in 39 places.">encode</a>(dest, <strong class="reserved">null</strong>);
<a id="L321" name="L321"></a> 321                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/6624.html" title="Multiple defined in 3 places.">ParseException</a> e) <em class="brace">{</em>
<a id="L322" name="L322"></a> 322                         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(e);
<a id="L323" name="L323"></a> 323                     <em class="brace">}</em>
<a id="L324" name="L324"></a> 324 
<a id="L325" name="L325"></a> 325                     dest = <a href="../D/35345.html" title="Multiple defined in 2 places.">toASCIILower</a>(dest);
<a id="L326" name="L326"></a> 326 
<a id="L327" name="L327"></a> 327                     <em class="comment">// step 7</em>
<a id="L328" name="L328"></a> 328                     <em class="comment">// prepend the ACE prefix</em>
<a id="L329" name="L329"></a> 329                     dest.<a href="../D/24721.html" title="Multiple defined in 265 places.">insert</a>(0, ACE_PREFIX);
<a id="L330" name="L330"></a> 330                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L331" name="L331"></a> 331                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("The input starts with the ACE Prefix");
<a id="L332" name="L332"></a> 332                 <em class="brace">}</em>
<a id="L333" name="L333"></a> 333 
<a id="L334" name="L334"></a> 334             <em class="brace">}</em>
<a id="L335" name="L335"></a> 335         <em class="brace">}</em>
<a id="L336" name="L336"></a> 336 
<a id="L337" name="L337"></a> 337         <em class="comment">// step 8</em>
<a id="L338" name="L338"></a> 338         <em class="comment">// the length must be inside 1..63</em>
<a id="L339" name="L339"></a> 339         <strong class="reserved">if</strong> (dest.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt; MAX_LABEL_LENGTH) <em class="brace">{</em>
<a id="L340" name="L340"></a> 340             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("The label in the input is too long");
<a id="L341" name="L341"></a> 341         <em class="brace">}</em>
<a id="L342" name="L342"></a> 342 
<a id="L343" name="L343"></a> 343         <strong class="reserved">return</strong> dest.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L344" name="L344"></a> 344     <em class="brace">}</em>
<a id="L345" name="L345"></a> 345 
<a id="L346" name="L346"></a> 346     <em class="comment">//</em>
<a id="L347" name="L347"></a> 347     <em class="comment">// toUnicode operation; should only apply to a single label</em>
<a id="L348" name="L348"></a> 348     <em class="comment">//</em>
<a id="L349" name="L349"></a> 349     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/769.html#L183" title="Referred from 183 in src/java/net/IDN.java.">toUnicodeInternal</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>, <strong class="reserved">int</strong> flag) <em class="brace">{</em>
<a id="L350" name="L350"></a> 350         <strong class="reserved">boolean</strong>[] caseFlags = <strong class="reserved">null</strong>;
<a id="L351" name="L351"></a> 351         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> dest;
<a id="L352" name="L352"></a> 352 
<a id="L353" name="L353"></a> 353         <em class="comment">// step 1</em>
<a id="L354" name="L354"></a> 354         <em class="comment">// find out if all the codepoints in input are ASCII</em>
<a id="L355" name="L355"></a> 355         <strong class="reserved">boolean</strong> isASCII = <a href="../S/769.html#L456" title="Defined at 456 in src/java/net/IDN.java.">isAllASCII</a>(<a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>);
<a id="L356" name="L356"></a> 356 
<a id="L357" name="L357"></a> 357         <strong class="reserved">if</strong>(!isASCII)<em class="brace">{</em>
<a id="L358" name="L358"></a> 358             <em class="comment">// step 2</em>
<a id="L359" name="L359"></a> 359             <em class="comment">// perform the nameprep operation; flag ALLOW_UNASSIGNED is used here</em>
<a id="L360" name="L360"></a> 360             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L361" name="L361"></a> 361                 UCharacterIterator <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a> = UCharacterIterator.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>(<a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>);
<a id="L362" name="L362"></a> 362                 dest = namePrep.<a href="../D/29556.html" title="Multiple defined in 6 places.">prepare</a>(<a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>, flag);
<a id="L363" name="L363"></a> 363             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L364" name="L364"></a> 364                 <em class="comment">// toUnicode never fails; if any step fails, return the input string</em>
<a id="L365" name="L365"></a> 365                 <strong class="reserved">return</strong> <a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>;
<a id="L366" name="L366"></a> 366             <em class="brace">}</em>
<a id="L367" name="L367"></a> 367         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L368" name="L368"></a> 368             dest = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>(<a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>);
<a id="L369" name="L369"></a> 369         <em class="brace">}</em>
<a id="L370" name="L370"></a> 370 
<a id="L371" name="L371"></a> 371         <em class="comment">// step 3</em>
<a id="L372" name="L372"></a> 372         <em class="comment">// verify ACE Prefix</em>
<a id="L373" name="L373"></a> 373         <strong class="reserved">if</strong>(<a href="../S/769.html#L471" title="Defined at 471 in src/java/net/IDN.java.">startsWithACEPrefix</a>(dest)) <em class="brace">{</em>
<a id="L374" name="L374"></a> 374 
<a id="L375" name="L375"></a> 375             <em class="comment">// step 4</em>
<a id="L376" name="L376"></a> 376             <em class="comment">// Remove the ACE Prefix</em>
<a id="L377" name="L377"></a> 377             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> temp = dest.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(ACE_PREFIX_LENGTH, dest.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>());
<a id="L378" name="L378"></a> 378 
<a id="L379" name="L379"></a> 379             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L380" name="L380"></a> 380                 <em class="comment">// step 5</em>
<a id="L381" name="L381"></a> 381                 <em class="comment">// Decode using punycode</em>
<a id="L382" name="L382"></a> 382                 <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> decodeOut = Punycode.<a href="../D/14516.html" title="Multiple defined in 39 places.">decode</a>(<strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>(temp), <strong class="reserved">null</strong>);
<a id="L383" name="L383"></a> 383 
<a id="L384" name="L384"></a> 384                 <em class="comment">// step 6</em>
<a id="L385" name="L385"></a> 385                 <em class="comment">// Apply toASCII</em>
<a id="L386" name="L386"></a> 386                 <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> toASCIIOut = <a href="../D/35343.html" title="Multiple defined in 2 places.">toASCII</a>(decodeOut.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>(), flag);
<a id="L387" name="L387"></a> 387 
<a id="L388" name="L388"></a> 388                 <em class="comment">// step 7</em>
<a id="L389" name="L389"></a> 389                 <em class="comment">// verify</em>
<a id="L390" name="L390"></a> 390                 <strong class="reserved">if</strong> (toASCIIOut.<a href="../D/15687.html" title="Multiple defined in 6 places.">equalsIgnoreCase</a>(dest.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>())) <em class="brace">{</em>
<a id="L391" name="L391"></a> 391                     <em class="comment">// step 8</em>
<a id="L392" name="L392"></a> 392                     <em class="comment">// return output of step 5</em>
<a id="L393" name="L393"></a> 393                     <strong class="reserved">return</strong> decodeOut.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L394" name="L394"></a> 394                 <em class="brace">}</em>
<a id="L395" name="L395"></a> 395             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> ignored) <em class="brace">{</em>
<a id="L396" name="L396"></a> 396                 <em class="comment">// no-op</em>
<a id="L397" name="L397"></a> 397             <em class="brace">}</em>
<a id="L398" name="L398"></a> 398         <em class="brace">}</em>
<a id="L399" name="L399"></a> 399 
<a id="L400" name="L400"></a> 400         <em class="comment">// just return the input</em>
<a id="L401" name="L401"></a> 401         <strong class="reserved">return</strong> <a href="../S/7710.html#L56" title="Defined at 56 in src/com/sun/javadoc/SeeTag.java.">label</a>;
<a id="L402" name="L402"></a> 402     <em class="brace">}</em>
<a id="L403" name="L403"></a> 403 
<a id="L404" name="L404"></a> 404 
<a id="L405" name="L405"></a> 405     <em class="comment">//</em>
<a id="L406" name="L406"></a> 406     <em class="comment">// LDH stands for "letter/digit/hyphen", with characters restricted to the</em>
<a id="L407" name="L407"></a> 407     <em class="comment">// 26-letter Latin alphabet &lt;A-Z a-z&gt;, the digits &lt;0-9&gt;, and the hyphen</em>
<a id="L408" name="L408"></a> 408     <em class="comment">// &lt;-&gt;.</em>
<a id="L409" name="L409"></a> 409     <em class="comment">// Non LDH refers to characters in the ASCII range, but which are not</em>
<a id="L410" name="L410"></a> 410     <em class="comment">// letters, digits or the hypen.</em>
<a id="L411" name="L411"></a> 411     <em class="comment">//</em>
<a id="L412" name="L412"></a> 412     <em class="comment">// non-LDH = 0..0x2C, 0x2E..0x2F, 0x3A..0x40, 0x5B..0x60, 0x7B..0x7F</em>
<a id="L413" name="L413"></a> 413     <em class="comment">//</em>
<a id="L414" name="L414"></a> 414     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../S/769.html#L295" title="Referred from 295 in src/java/net/IDN.java.">isNonLDHAsciiCodePoint</a>(<strong class="reserved">int</strong> ch)<em class="brace">{</em>
<a id="L415" name="L415"></a> 415         <strong class="reserved">return</strong> (0x0000 &lt;= ch &amp;&amp; ch &lt;= 0x002C) ||
<a id="L416" name="L416"></a> 416                (0x002E &lt;= ch &amp;&amp; ch &lt;= 0x002F) ||
<a id="L417" name="L417"></a> 417                (0x003A &lt;= ch &amp;&amp; ch &lt;= 0x0040) ||
<a id="L418" name="L418"></a> 418                (0x005B &lt;= ch &amp;&amp; ch &lt;= 0x0060) ||
<a id="L419" name="L419"></a> 419                (0x007B &lt;= ch &amp;&amp; ch &lt;= 0x007F);
<a id="L420" name="L420"></a> 420     <em class="brace">}</em>
<a id="L421" name="L421"></a> 421 
<a id="L422" name="L422"></a> 422     <em class="comment">//</em>
<a id="L423" name="L423"></a> 423     <em class="comment">// search dots in a string and return the index of that character;</em>
<a id="L424" name="L424"></a> 424     <em class="comment">// or if there is no dots, return the length of input string</em>
<a id="L425" name="L425"></a> 425     <em class="comment">// dots might be: \u002E (full stop), \u3002 (ideographic full stop), \uFF0E (fullwidth full stop),</em>
<a id="L426" name="L426"></a> 426     <em class="comment">// and \uFF61 (halfwidth ideographic full stop).</em>
<a id="L427" name="L427"></a> 427     <em class="comment">//</em>
<a id="L428" name="L428"></a> 428     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/26697.html" title="Multiple referred from 2 places.">searchDots</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>) <em class="brace">{</em>
<a id="L429" name="L429"></a> 429         <strong class="reserved">int</strong> i;
<a id="L430" name="L430"></a> 430         <strong class="reserved">for</strong> (i = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>; i &lt; s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>(); i++) <em class="brace">{</em>
<a id="L431" name="L431"></a> 431             <strong class="reserved">if</strong> (<a href="../S/769.html#L449" title="Defined at 449 in src/java/net/IDN.java.">isLabelSeparator</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i))) <em class="brace">{</em>
<a id="L432" name="L432"></a> 432                 <strong class="reserved">break</strong>;
<a id="L433" name="L433"></a> 433             <em class="brace">}</em>
<a id="L434" name="L434"></a> 434         <em class="brace">}</em>
<a id="L435" name="L435"></a> 435 
<a id="L436" name="L436"></a> 436         <strong class="reserved">return</strong> i;
<a id="L437" name="L437"></a> 437     <em class="brace">}</em>
<a id="L438" name="L438"></a> 438 
<a id="L439" name="L439"></a> 439     <em class="comment">//</em>
<a id="L440" name="L440"></a> 440     <em class="comment">// to check if a string is a root label, ".".</em>
<a id="L441" name="L441"></a> 441     <em class="comment">//</em>
<a id="L442" name="L442"></a> 442     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/21979.html" title="Multiple referred from 2 places.">isRootLabel</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s) <em class="brace">{</em>
<a id="L443" name="L443"></a> 443         <strong class="reserved">return</strong> (s.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 1 &amp;&amp; <a href="../S/769.html#L449" title="Defined at 449 in src/java/net/IDN.java.">isLabelSeparator</a>(s.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0)));
<a id="L444" name="L444"></a> 444     <em class="brace">}</em>
<a id="L445" name="L445"></a> 445 
<a id="L446" name="L446"></a> 446     <em class="comment">//</em>
<a id="L447" name="L447"></a> 447     <em class="comment">// to check if a character is a label separator, i.e. a dot character.</em>
<a id="L448" name="L448"></a> 448     <em class="comment">//</em>
<a id="L449" name="L449"></a> 449     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/21634.html" title="Multiple referred from 2 places.">isLabelSeparator</a>(<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L450" name="L450"></a> 450         <strong class="reserved">return</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == '.' || <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == '\u3002' || <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == '\uFF0E' || <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == '\uFF61');
<a id="L451" name="L451"></a> 451     <em class="brace">}</em>
<a id="L452" name="L452"></a> 452 
<a id="L453" name="L453"></a> 453     <em class="comment">//</em>
<a id="L454" name="L454"></a> 454     <em class="comment">// to check if a string only contains US-ASCII code point</em>
<a id="L455" name="L455"></a> 455     <em class="comment">//</em>
<a id="L456" name="L456"></a> 456     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/21150.html" title="Multiple referred from 3 places.">isAllASCII</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>) <em class="brace">{</em>
<a id="L457" name="L457"></a> 457         <strong class="reserved">boolean</strong> isASCII = <strong class="reserved">true</strong>;
<a id="L458" name="L458"></a> 458         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>(); i++) <em class="brace">{</em>
<a id="L459" name="L459"></a> 459             <strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i);
<a id="L460" name="L460"></a> 460             <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> &gt; 0x7F) <em class="brace">{</em>
<a id="L461" name="L461"></a> 461                 isASCII = <strong class="reserved">false</strong>;
<a id="L462" name="L462"></a> 462                 <strong class="reserved">break</strong>;
<a id="L463" name="L463"></a> 463             <em class="brace">}</em>
<a id="L464" name="L464"></a> 464         <em class="brace">}</em>
<a id="L465" name="L465"></a> 465         <strong class="reserved">return</strong> isASCII;
<a id="L466" name="L466"></a> 466     <em class="brace">}</em>
<a id="L467" name="L467"></a> 467 
<a id="L468" name="L468"></a> 468     <em class="comment">//</em>
<a id="L469" name="L469"></a> 469     <em class="comment">// to check if a string starts with ACE-prefix</em>
<a id="L470" name="L470"></a> 470     <em class="comment">//</em>
<a id="L471" name="L471"></a> 471     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">boolean</strong> <a href="../R/28869.html" title="Multiple referred from 2 places.">startsWithACEPrefix</a>(<a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>)<em class="brace">{</em>
<a id="L472" name="L472"></a> 472         <strong class="reserved">boolean</strong> startsWithPrefix = <strong class="reserved">true</strong>;
<a id="L473" name="L473"></a> 473 
<a id="L474" name="L474"></a> 474         <strong class="reserved">if</strong>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &lt; ACE_PREFIX_LENGTH)<em class="brace">{</em>
<a id="L475" name="L475"></a> 475             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L476" name="L476"></a> 476         <em class="brace">}</em>
<a id="L477" name="L477"></a> 477         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i = 0; i &lt; ACE_PREFIX_LENGTH; i++)<em class="brace">{</em>
<a id="L478" name="L478"></a> 478             <strong class="reserved">if</strong>(<a href="../D/35345.html" title="Multiple defined in 2 places.">toASCIILower</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)) != ACE_PREFIX.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i))<em class="brace">{</em>
<a id="L479" name="L479"></a> 479                 startsWithPrefix = <strong class="reserved">false</strong>;
<a id="L480" name="L480"></a> 480             <em class="brace">}</em>
<a id="L481" name="L481"></a> 481         <em class="brace">}</em>
<a id="L482" name="L482"></a> 482         <strong class="reserved">return</strong> startsWithPrefix;
<a id="L483" name="L483"></a> 483     <em class="brace">}</em>
<a id="L484" name="L484"></a> 484 
<a id="L485" name="L485"></a> 485     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">char</strong> <a href="../R/29210.html" title="Multiple referred from 3 places.">toASCIILower</a>(<strong class="reserved">char</strong> ch)<em class="brace">{</em>
<a id="L486" name="L486"></a> 486         <strong class="reserved">if</strong>('A' &lt;= ch &amp;&amp; ch &lt;= 'Z')<em class="brace">{</em>
<a id="L487" name="L487"></a> 487             <strong class="reserved">return</strong> (<strong class="reserved">char</strong>)(ch + 'a' - 'A');
<a id="L488" name="L488"></a> 488         <em class="brace">}</em>
<a id="L489" name="L489"></a> 489         <strong class="reserved">return</strong> ch;
<a id="L490" name="L490"></a> 490     <em class="brace">}</em>
<a id="L491" name="L491"></a> 491 
<a id="L492" name="L492"></a> 492     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../R/29210.html" title="Multiple referred from 3 places.">toASCIILower</a>(<a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>)<em class="brace">{</em>
<a id="L493" name="L493"></a> 493         <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a> dest = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>();
<a id="L494" name="L494"></a> 494         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i = 0; i &lt; <a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>();i++)<em class="brace">{</em>
<a id="L495" name="L495"></a> 495             dest.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../D/35345.html" title="Multiple defined in 2 places.">toASCIILower</a>(<a href="../S/4116.html#L132" title="Defined at 132 in src/javax/xml/ws/Action.java.">input</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(i)));
<a id="L496" name="L496"></a> 496         <em class="brace">}</em>
<a id="L497" name="L497"></a> 497         <strong class="reserved">return</strong> dest;
<a id="L498" name="L498"></a> 498     <em class="brace">}</em>
<a id="L499" name="L499"></a> 499 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L111">[^]</a><a href="#L492">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>