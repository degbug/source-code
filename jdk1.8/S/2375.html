<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/awt/font/TextLayout.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L336">[^]</a><a href="#L2734">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L336" title="Defined at 336.">getStrongCaret</a></li>
<li><a href="#L452" title="Defined at 452.">singleFont</a></li>
<li><a href="#L568" title="Defined at 568.">paragraphInit</a></li>
<li><a href="#L590" title="Defined at 590.">fastInit</a></li>
<li><a href="#L620" title="Defined at 620.">standardInit</a></li>
<li><a href="#L662" title="Defined at 662.">ensureCache</a></li>
<li><a href="#L668" title="Defined at 668.">buildCache</a></li>
<li><a href="#L735" title="Defined at 735.">getNaturalBounds</a></li>
<li><a href="#L748" title="Defined at 748.">clone</a></li>
<li><a href="#L773" title="Defined at 773.">checkTextHit</a></li>
<li><a href="#L799" title="Defined at 799.">getJustifiedLayout</a></li>
<li><a href="#L846" title="Defined at 846.">handleJustify</a></li>
<li><a href="#L861" title="Defined at 861.">getBaseline</a></li>
<li><a href="#L880" title="Defined at 880.">getBaselineOffsets</a></li>
<li><a href="#L893" title="Defined at 893.">getAdvance</a></li>
<li><a href="#L905" title="Defined at 905.">getVisibleAdvance</a></li>
<li><a href="#L921" title="Defined at 921.">getAscent</a></li>
<li><a href="#L936" title="Defined at 936.">getDescent</a></li>
<li><a href="#L962" title="Defined at 962.">getLeading</a></li>
<li><a href="#L977" title="Defined at 977.">getBounds</a></li>
<li><a href="#L1013" title="Defined at 1013.">getPixelBounds</a></li>
<li><a href="#L1033" title="Defined at 1033.">isLeftToRight</a></li>
<li><a href="#L1042" title="Defined at 1042.">isVertical</a></li>
<li><a href="#L1051" title="Defined at 1051.">getCharacterCount</a></li>
<li><a href="#L1125" title="Defined at 1125.">getCaretInfo</a></li>
<li><a href="#L1218" title="Defined at 1218.">getCaretInfo</a></li>
<li><a href="#L1232" title="Defined at 1232.">getCaretInfoTestInternal</a></li>
<li><a href="#L1320" title="Defined at 1320.">getCaretInfo</a></li>
<li><a href="#L1333" title="Defined at 1333.">hitToCaret</a></li>
<li><a href="#L1360" title="Defined at 1360.">caretToHit</a></li>
<li><a href="#L1381" title="Defined at 1381.">caretIsValid</a></li>
<li><a href="#L1411" title="Defined at 1411.">getNextRightHit</a></li>
<li><a href="#L1442" title="Defined at 1442.">getNextRightHit</a></li>
<li><a href="#L1479" title="Defined at 1479.">getNextRightHit</a></li>
<li><a href="#L1493" title="Defined at 1493.">getNextLeftHit</a></li>
<li><a href="#L1524" title="Defined at 1524.">getNextLeftHit</a></li>
<li><a href="#L1561" title="Defined at 1561.">getNextLeftHit</a></li>
<li><a href="#L1572" title="Defined at 1572.">getVisualOtherHit</a></li>
<li><a href="#L1632" title="Defined at 1632.">getCaretPath</a></li>
<li><a href="#L1646" title="Defined at 1646.">getCaretPath</a></li>
<li><a href="#L1760" title="Defined at 1760.">pathToShape</a></li>
<li><a href="#L1786" title="Defined at 1786.">getCaretShape</a></li>
<li><a href="#L1804" title="Defined at 1804.">getCaretShape</a></li>
<li><a href="#L1814" title="Defined at 1814.">getStrongHit</a></li>
<li><a href="#L1846" title="Defined at 1846.">getCharacterLevel</a></li>
<li><a href="#L1872" title="Defined at 1872.">getCaretShapes</a></li>
<li><a href="#L1932" title="Defined at 1932.">getCaretShapes</a></li>
<li><a href="#L1947" title="Defined at 1947.">getCaretShapes</a></li>
<li><a href="#L1955" title="Defined at 1955.">boundingShape</a></li>
<li><a href="#L2003" title="Defined at 2003.">caretBoundingShape</a></li>
<li><a href="#L2022" title="Defined at 2022.">leftShape</a></li>
<li><a href="#L2044" title="Defined at 2044.">rightShape</a></li>
<li><a href="#L2076" title="Defined at 2076.">getLogicalRangesForVisualSelection</a></li>
<li><a href="#L2178" title="Defined at 2178.">getVisualHighlightShape</a></li>
<li><a href="#L2230" title="Defined at 2230.">getVisualHighlightShape</a></li>
<li><a href="#L2274" title="Defined at 2274.">getLogicalHighlightShape</a></li>
<li><a href="#L2370" title="Defined at 2370.">getLogicalHighlightShape</a></li>
<li><a href="#L2386" title="Defined at 2386.">getBlackBoxBounds</a></li>
<li><a href="#L2438" title="Defined at 2438.">caretToPointDistance</a></li>
<li><a href="#L2465" title="Defined at 2465.">hitTestChar</a></li>
<li><a href="#L2566" title="Defined at 2566.">hitTestChar</a></li>
<li><a href="#L2575" title="Defined at 2575.">hashCode</a></li>
<li><a href="#L2592" title="Defined at 2592.">equals</a></li>
<li><a href="#L2605" title="Defined at 2605.">equals</a></li>
<li><a href="#L2623" title="Defined at 2623.">toString</a></li>
<li><a href="#L2641" title="Defined at 2641.">draw</a></li>
<li><a href="#L2653" title="Defined at 2653.">getTextLineForTesting</a></li>
<li><a href="#L2664" title="Defined at 2664.">sameBaselineUpTo</a></li>
<li><a href="#L2677" title="Defined at 2677.">getBaselineFromGraphic</a></li>
<li><a href="#L2699" title="Defined at 2699.">getOutline</a></li>
<li><a href="#L2715" title="Defined at 2715.">getLayoutPath</a></li>
<li><a href="#L2734" title="Defined at 2734.">hitToPoint</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<div class="comment">
  (C) Copyright Taligent, Inc. 1996 - 1997, All Rights Reserved
  (C) Copyright IBM Corp. 1996-2003, All Rights Reserved
  The original version of this source code and documentation is
  copyrighted and owned by Taligent, Inc., a wholly-owned subsidiary
  of IBM. These materials are provided under terms of a License
  Agreement between Taligent and Sun. This technology is protected
  by multiple US and International patents.
  This notice and attribution to Taligent may not be removed.
  Taligent is a registered trademark of Taligent, Inc.</div>
<a id="L40" name="L40"></a>  40 
<a id="L41" name="L41"></a>  41 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.awt.font;
<a id="L42" name="L42"></a>  42 
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> java.awt.Color;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> java.awt.Font;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> java.awt.Graphics2D;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> java.awt.Rectangle;
<a id="L47" name="L47"></a>  47 <strong class="reserved">import</strong> java.awt.Shape;
<a id="L48" name="L48"></a>  48 <strong class="reserved">import</strong> java.awt.font.NumericShaper;
<a id="L49" name="L49"></a>  49 <strong class="reserved">import</strong> java.awt.font.TextLine.TextLineMetrics;
<a id="L50" name="L50"></a>  50 <strong class="reserved">import</strong> java.awt.geom.AffineTransform;
<a id="L51" name="L51"></a>  51 <strong class="reserved">import</strong> java.awt.geom.GeneralPath;
<a id="L52" name="L52"></a>  52 <strong class="reserved">import</strong> java.awt.geom.NoninvertibleTransformException;
<a id="L53" name="L53"></a>  53 <strong class="reserved">import</strong> java.awt.geom.Point2D;
<a id="L54" name="L54"></a>  54 <strong class="reserved">import</strong> java.awt.geom.Rectangle2D;
<a id="L55" name="L55"></a>  55 <strong class="reserved">import</strong> java.text.AttributedString;
<a id="L56" name="L56"></a>  56 <strong class="reserved">import</strong> java.text.AttributedCharacterIterator;
<a id="L57" name="L57"></a>  57 <strong class="reserved">import</strong> java.text.AttributedCharacterIterator.Attribute;
<a id="L58" name="L58"></a>  58 <strong class="reserved">import</strong> java.text.CharacterIterator;
<a id="L59" name="L59"></a>  59 <strong class="reserved">import</strong> java.util.Map;
<a id="L60" name="L60"></a>  60 <strong class="reserved">import</strong> java.util.HashMap;
<a id="L61" name="L61"></a>  61 <strong class="reserved">import</strong> java.util.Hashtable;
<a id="L62" name="L62"></a>  62 <strong class="reserved">import</strong> sun.font.AttributeValues;
<a id="L63" name="L63"></a>  63 <strong class="reserved">import</strong> sun.font.CoreMetrics;
<a id="L64" name="L64"></a>  64 <strong class="reserved">import</strong> sun.font.Decoration;
<a id="L65" name="L65"></a>  65 <strong class="reserved">import</strong> sun.font.FontLineMetrics;
<a id="L66" name="L66"></a>  66 <strong class="reserved">import</strong> sun.font.FontResolver;
<a id="L67" name="L67"></a>  67 <strong class="reserved">import</strong> sun.font.GraphicComponent;
<a id="L68" name="L68"></a>  68 <strong class="reserved">import</strong> sun.font.LayoutPathImpl;
<a id="L69" name="L69"></a>  69 <strong class="reserved">import</strong> sun.text.CodePointIterator;
<a id="L70" name="L70"></a>  70 
<div class="comment">
  <code>TextLayout</code> is an immutable graphical representation of styled
  character data.
  <p>
  It provides the following capabilities:
  </p><ul><li>implicit bidirectional analysis and reordering,
  </li><li>cursor positioning and movement, including split cursors for
  mixed directional text,
  </li><li>highlighting, including both logical and visual highlighting
  for mixed directional text,
  </li><li>multiple baselines (roman, hanging, and centered),
  </li><li>hit testing,
  </li><li>justification,
  </li><li>default font substitution,
  </li><li>metric information such as ascent, descent, and advance, and
  </li><li>rendering
  </li></ul>
  <p>
  A <code>TextLayout</code> object can be rendered using
  its <code>draw</code> method.
  </p><p>
  <code>TextLayout</code> can be constructed either directly or through
  the use of a {@link LineBreakMeasurer}.  When constructed directly, the
  source text represents a single paragraph.  <code>LineBreakMeasurer</code>
  allows styled text to be broken into lines that fit within a particular
  width.  See the <code>LineBreakMeasurer</code> documentation for more
  information.
  </p><p>
  <code>TextLayout</code> construction logically proceeds as follows:
  </p><ul><li>paragraph attributes are extracted and examined,
  </li><li>text is analyzed for bidirectional reordering, and reordering
  information is computed if needed,
  </li><li>text is segmented into style runs
  </li><li>fonts are chosen for style runs, first by using a font if the
  attribute {@link TextAttribute#FONT} is present, otherwise by computing
  a default font using the attributes that have been defined
  </li><li>if text is on multiple baselines, the runs or subruns are further
  broken into subruns sharing a common baseline,
  </li><li>glyphvectors are generated for each run using the chosen font,
  </li><li>final bidirectional reordering is performed on the glyphvectors
  </li></ul>
  <p>
  All graphical information returned from a <code>TextLayout</code>
  object's methods is relative to the origin of the
  <code>TextLayout</code>, which is the intersection of the
  <code>TextLayout</code> object's baseline with its left edge.  Also,
  coordinates passed into a <code>TextLayout</code> object's methods
  are assumed to be relative to the <code>TextLayout</code> object's
  origin.  Clients usually need to translate between a
  <code>TextLayout</code> object's coordinate system and the coordinate
  system in another object (such as a
  {@link java.awt.Graphics Graphics} object).
  </p><p>
  <code>TextLayout</code> objects are constructed from styled text,
  but they do not retain a reference to their source text.  Thus,
  changes in the text previously used to generate a <code>TextLayout</code>
  do not affect the <code>TextLayout</code>.
  </p><p>
  Three methods on a <code>TextLayout</code> object
  (<code>getNextRightHit</code>, <code>getNextLeftHit</code>, and
  <code>hitTestChar</code>) return instances of <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.
  The offsets contained in these <code>TextHitInfo</code> objects
  are relative to the start of the <code>TextLayout</code>, <b>not</b>
  to the text used to create the <code>TextLayout</code>.  Similarly,
  <code>TextLayout</code> methods that accept <code>TextHitInfo</code>
  instances as parameters expect the <code>TextHitInfo</code> object's
  offsets to be relative to the <code>TextLayout</code>, not to any
  underlying text storage model.
  </p><p>
  <strong>Examples</strong>:</p><p>
  Constructing and drawing a <code>TextLayout</code> and its bounding
  rectangle:
  </p><blockquote><pre>    Graphics2D g = ...;
    Point2D loc = ...;
    Font font = Font.getFont("Helvetica-bold-italic");
    FontRenderContext frc = g.getFontRenderContext();
    TextLayout layout = new TextLayout("This is a string", font, frc);
    layout.draw(g, (float)loc.getX(), (float)loc.getY());
    Rectangle2D bounds = layout.getBounds();
    bounds.setRect(bounds.getX()+loc.getX(),
                   bounds.getY()+loc.getY(),
                   bounds.getWidth(),
                   bounds.getHeight());
    g.draw(bounds);
  </pre>
  </blockquote>
  <p>
  Hit-testing a <code>TextLayout</code> (determining which character is at
  a particular graphical location):
  </p><blockquote><pre>    Point2D click = ...;
    TextHitInfo hit = layout.hitTestChar(
                          (float) (click.getX() - loc.getX()),
                          (float) (click.getY() - loc.getY()));
  </pre>
  </blockquote>
  <p>
  Responding to a right-arrow key press:
  </p><blockquote><pre>    int insertionIndex = ...;
    TextHitInfo next = layout.getNextRightHit(insertionIndex);
    if (next != null) {
        // translate graphics to origin of layout on screen
        g.translate(loc.getX(), loc.getY());
        Shape[] carets = layout.getCaretShapes(next.getInsertionIndex());
        g.draw(carets[0]);
        if (carets[1] != null) {
            g.draw(carets[1]);
        }
    }
  </pre></blockquote>
  <p>
  Drawing a selection range corresponding to a substring in the source text.
  The selected area may not be visually contiguous:
  </p><blockquote><pre>    // selStart, selLimit should be relative to the layout,
    // not to the source text
    int selStart = ..., selLimit = ...;
    Color selectionColor = ...;
    Shape selection = layout.getLogicalHighlightShape(selStart, selLimit);
    // selection may consist of disjoint areas
    // graphics is assumed to be tranlated to origin of layout
    g.setColor(selectionColor);
    g.fill(selection);
  </pre></blockquote>
  <p>
  Drawing a visually contiguous selection range.  The selection range may
  correspond to more than one substring in the source text.  The ranges of
  the corresponding source text substrings can be obtained with
  <code>getLogicalRangesForVisualSelection()</code>:
  </p><blockquote><pre>    TextHitInfo selStart = ..., selLimit = ...;
    Shape selection = layout.getVisualHighlightShape(selStart, selLimit);
    g.setColor(selectionColor);
    g.fill(selection);
    int[] ranges = getLogicalRangesForVisualSelection(selStart, selLimit);
    // ranges[0], ranges[1] is the first selection range,
    // ranges[2], ranges[3] is the second selection range, etc.
  </pre></blockquote>
  <p>
  Note: Font rotations can cause text baselines to be rotated, and
  multiple runs with different rotations can cause the baseline to
  bend or zig-zag.  In order to account for this (rare) possibility,
  some APIs are specified to return metrics and take parameters 'in
  baseline-relative coordinates' (e.g. ascent, advance), and others
  are in 'in standard coordinates' (e.g. getBounds).  Values in
  baseline-relative coordinates map the 'x' coordinate to the
  distance along the baseline, (positive x is forward along the
  baseline), and the 'y' coordinate to a distance along the
  perpendicular to the baseline at 'x' (positive y is 90 degrees
  clockwise from the baseline vector).  Values in standard
  coordinates are measured along the x and y axes, with 0,0 at the
  origin of the TextLayout.  Documentation for each relevant API
  indicates what values are in what coordinate system.  In general,
  measurement-related APIs are in baseline-relative coordinates,
  while display-related APIs are in standard coordinates.
  @see LineBreakMeasurer
  @see TextAttribute
  @see TextHitInfo
  @see LayoutPath</p></div>
<a id="L239" name="L239"></a> 239 <strong class="reserved">public</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/8105.html" title="Multiple referred from 18 places.">TextLayout</a> <strong class="reserved">implements</strong> <a href="../S/1744.html#L53" title="Defined at 53 in src/java/lang/Cloneable.java.">Cloneable</a> <em class="brace">{</em>
<a id="L240" name="L240"></a> 240 
<a id="L241" name="L241"></a> 241     <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>;
<a id="L242" name="L242"></a> 242     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> isVerticalLine = <strong class="reserved">false</strong>;
<a id="L243" name="L243"></a> 243     <strong class="reserved">private</strong> <strong class="reserved">byte</strong> baseline;
<a id="L244" name="L244"></a> 244     <strong class="reserved">private</strong> <strong class="reserved">float</strong>[] baselineOffsets;  <em class="comment">// why have these ?</em>
<a id="L245" name="L245"></a> 245     <strong class="reserved">private</strong> <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a> textLine;
<a id="L246" name="L246"></a> 246 
<a id="L247" name="L247"></a> 247     <em class="comment">// cached values computed from GlyphSets and set info:</em>
<a id="L248" name="L248"></a> 248     <em class="comment">// all are recomputed from scratch in buildCache()</em>
<a id="L249" name="L249"></a> 249     <strong class="reserved">private</strong> <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a>.<a href="../S/2362.html#L69" title="Defined at 69 in src/java/awt/font/TextLine.java.">TextLineMetrics</a> lineMetrics = <strong class="reserved">null</strong>;
<a id="L250" name="L250"></a> 250     <strong class="reserved">private</strong> <strong class="reserved">float</strong> visibleAdvance;
<a id="L251" name="L251"></a> 251     <strong class="reserved">private</strong> <strong class="reserved">int</strong> hashCodeCache;
<a id="L252" name="L252"></a> 252 
<div class="comment">
      TextLayouts are supposedly immutable.  If you mutate a TextLayout under
      the covers (like the justification code does) you'll need to set this
      back to false.  Could be replaced with textLine != null &lt;--&gt; cacheIsValid.</div>
<a id="L258" name="L258"></a> 258     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> cacheIsValid = <strong class="reserved">false</strong>;
<a id="L259" name="L259"></a> 259 
<a id="L260" name="L260"></a> 260 
<a id="L261" name="L261"></a> 261     <em class="comment">// This value is obtained from an attribute, and constrained to the</em>
<a id="L262" name="L262"></a> 262     <em class="comment">// interval [0,1].  If 0, the layout cannot be justified.</em>
<a id="L263" name="L263"></a> 263     <strong class="reserved">private</strong> <strong class="reserved">float</strong> justifyRatio;
<a id="L264" name="L264"></a> 264 
<a id="L265" name="L265"></a> 265     <em class="comment">// If a layout is produced by justification, then that layout</em>
<a id="L266" name="L266"></a> 266     <em class="comment">// cannot be justified.  To enforce this constraint the</em>
<a id="L267" name="L267"></a> 267     <em class="comment">// justifyRatio of the justified layout is set to this value.</em>
<a id="L268" name="L268"></a> 268     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">float</strong> ALREADY_JUSTIFIED = -53.9f;
<a id="L269" name="L269"></a> 269 
<a id="L270" name="L270"></a> 270     <em class="comment">// dx and dy specify the distance between the TextLayout's origin</em>
<a id="L271" name="L271"></a> 271     <em class="comment">// and the origin of the leftmost GlyphSet (TextLayoutComponent,</em>
<a id="L272" name="L272"></a> 272     <em class="comment">// actually).  They were used for hanging punctuation support,</em>
<a id="L273" name="L273"></a> 273     <em class="comment">// which is no longer implemented.  Currently they are both always 0,</em>
<a id="L274" name="L274"></a> 274     <em class="comment">// and TextLayout is not guaranteed to work with non-zero dx, dy</em>
<a id="L275" name="L275"></a> 275     <em class="comment">// values right now.  They were left in as an aide and reminder to</em>
<a id="L276" name="L276"></a> 276     <em class="comment">// anyone who implements hanging punctuation or other similar stuff.</em>
<a id="L277" name="L277"></a> 277     <em class="comment">// They are static now so they don't take up space in TextLayout</em>
<a id="L278" name="L278"></a> 278     <em class="comment">// instances.</em>
<a id="L279" name="L279"></a> 279     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">float</strong> dx;
<a id="L280" name="L280"></a> 280     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">float</strong> dy;
<a id="L281" name="L281"></a> 281 
<div class="comment">
      Natural bounds is used internally.  It is built on demand in
      getNaturalBounds.</div>
<a id="L286" name="L286"></a> 286     <strong class="reserved">private</strong> <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> naturalBounds = <strong class="reserved">null</strong>;
<a id="L287" name="L287"></a> 287 
<div class="comment">
      boundsRect encloses all of the bits this TextLayout can draw.  It
      is build on demand in getBounds.</div>
<a id="L292" name="L292"></a> 292     <strong class="reserved">private</strong> <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> boundsRect = <strong class="reserved">null</strong>;
<a id="L293" name="L293"></a> 293 
<div class="comment">
      flag to supress/allow carets inside of ligatures when hit testing or
      arrow-keying</div>
<a id="L298" name="L298"></a> 298     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> caretsInLigaturesAreAllowed = <strong class="reserved">false</strong>;
<a id="L299" name="L299"></a> 299 
<div class="comment">
      Defines a policy for determining the strong caret location.
      This class contains one method, <code>getStrongCaret</code>, which
      is used to specify the policy that determines the strong caret in
      dual-caret text.  The strong caret is used to move the caret to the
      left or right. Instances of this class can be passed to
      <code>getCaretShapes</code>, <code>getNextLeftHit</code> and
      <code>getNextRightHit</code> to customize strong caret
      selection.
      <p>
      To specify alternate caret policies, subclass <code>CaretPolicy</code>
      and override <code>getStrongCaret</code>.  <code>getStrongCaret</code>
      should inspect the two <code>TextHitInfo</code> arguments and choose
      one of them as the strong caret.
      </p><p>
      Most clients do not need to use this class.</p></div>
<a id="L317" name="L317"></a> 317     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">class</strong> <a href="../R/1187.html" title="Multiple referred from 4 places.">CaretPolicy</a> <em class="brace">{</em>
<a id="L318" name="L318"></a> 318 
<div class="comment">
          Constructs a <code>CaretPolicy</code>.</div>
<a id="L322" name="L322"></a> 322          <strong class="reserved">public</strong> CaretPolicy() <em class="brace">{</em>
<a id="L323" name="L323"></a> 323          <em class="brace">}</em>
<a id="L324" name="L324"></a> 324 
<div class="comment">
          Chooses one of the specified <code>TextHitInfo</code> instances as
          a strong caret in the specified <code>TextLayout</code>.
          @param hit1 a valid hit in <code>layout</code>
          @param hit2 a valid hit in <code>layout</code>
          @param layout the <code>TextLayout</code> in which
                 <code>hit1</code> and <code>hit2</code> are used
          @return <code>hit1</code> or <code>hit2</code>
                 (or an equivalent <code>TextHitInfo</code>), indicating the
                 strong caret.</div>
<a id="L336" name="L336"></a> 336         <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/19234.html" title="Multiple referred from 5 places.">getStrongCaret</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> hit1,
<a id="L337" name="L337"></a> 337                                           <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> hit2,
<a id="L338" name="L338"></a> 338                                           <a href="../S/2375.html#L239" title="Defined at 239 in src/java/awt/font/TextLayout.java.">TextLayout</a> <a href="../D/26763.html" title="Multiple defined in 14 places.">layout</a>) <em class="brace">{</em>
<a id="L339" name="L339"></a> 339 
<a id="L340" name="L340"></a> 340             <em class="comment">// default implementation just calls private method on layout</em>
<a id="L341" name="L341"></a> 341             <strong class="reserved">return</strong> <a href="../D/26763.html" title="Multiple defined in 14 places.">layout</a>.<a href="../S/2375.html#L1814" title="Defined at 1814 in src/java/awt/font/TextLayout.java.">getStrongHit</a>(hit1, hit2);
<a id="L342" name="L342"></a> 342         <em class="brace">}</em>
<a id="L343" name="L343"></a> 343     <em class="brace">}</em>
<a id="L344" name="L344"></a> 344 
<div class="comment">
      This <code>CaretPolicy</code> is used when a policy is not specified
      by the client.  With this policy, a hit on a character whose direction
      is the same as the line direction is stronger than a hit on a
      counterdirectional character.  If the characters' directions are
      the same, a hit on the leading edge of a character is stronger
      than a hit on the trailing edge of a character.</div>
<a id="L353" name="L353"></a> 353     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../S/2375.html#L317" title="Defined at 317 in src/java/awt/font/TextLayout.java.">CaretPolicy</a> DEFAULT_CARET_POLICY = <strong class="reserved">new</strong> <a href="../S/2375.html#L317" title="Defined at 317 in src/java/awt/font/TextLayout.java.">CaretPolicy</a>();
<a id="L354" name="L354"></a> 354 
<div class="comment">
      Constructs a <code>TextLayout</code> from a <code>String</code>
      and a <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a>.  All the text is styled using the specified
      <code>Font</code>.
      <p>
      The <code>String</code> must specify a single paragraph of text,
      because an entire paragraph is required for the bidirectional
      algorithm.
      @param string the text to display
      @param font a <code>Font</code> used to style the text
      @param frc contains information about a graphics device which is needed
            to measure the text correctly.
            Text measurements can vary slightly depending on the
            device resolution, and attributes such as antialiasing.  This
            parameter does not specify a translation between the
            <code>TextLayout</code> and user space.</p></div>
<a id="L372" name="L372"></a> 372     <strong class="reserved">public</strong> TextLayout(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>, <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> font, <a href="../S/2376.html#L66" title="Defined at 66 in src/java/awt/font/FontRenderContext.java.">FontRenderContext</a> frc) <em class="brace">{</em>
<a id="L373" name="L373"></a> 373 
<a id="L374" name="L374"></a> 374         <strong class="reserved">if</strong> (font == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L375" name="L375"></a> 375             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null font passed to TextLayout constructor.");
<a id="L376" name="L376"></a> 376         <em class="brace">}</em>
<a id="L377" name="L377"></a> 377 
<a id="L378" name="L378"></a> 378         <strong class="reserved">if</strong> (<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L379" name="L379"></a> 379             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null string passed to TextLayout constructor.");
<a id="L380" name="L380"></a> 380         <em class="brace">}</em>
<a id="L381" name="L381"></a> 381 
<a id="L382" name="L382"></a> 382         <strong class="reserved">if</strong> (<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 0) <em class="brace">{</em>
<a id="L383" name="L383"></a> 383             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Zero length string passed to TextLayout constructor.");
<a id="L384" name="L384"></a> 384         <em class="brace">}</em>
<a id="L385" name="L385"></a> 385 
<a id="L386" name="L386"></a> 386         <a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/567.html" title="Multiple defined in 12 places.">Attribute</a>, ?&gt; <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a> = <strong class="reserved">null</strong>;
<a id="L387" name="L387"></a> 387         <strong class="reserved">if</strong> (font.<a href="../S/2176.html#L1392" title="Defined at 1392 in src/java/awt/Font.java.">hasLayoutAttributes</a>()) <em class="brace">{</em>
<a id="L388" name="L388"></a> 388             <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a> = font.<a href="../D/17112.html" title="Multiple defined in 109 places.">getAttributes</a>();
<a id="L389" name="L389"></a> 389         <em class="brace">}</em>
<a id="L390" name="L390"></a> 390 
<a id="L391" name="L391"></a> 391         <strong class="reserved">char</strong>[] <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a> = <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>.<a href="../D/35368.html" title="Multiple defined in 3 places.">toCharArray</a>();
<a id="L392" name="L392"></a> 392         <strong class="reserved">if</strong> (<a href="../S/2375.html#L2664" title="Defined at 2664 in src/java/awt/font/TextLayout.java.">sameBaselineUpTo</a>(font, <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, 0, <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) == <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L393" name="L393"></a> 393             <a href="../S/2375.html#L590" title="Defined at 590 in src/java/awt/font/TextLayout.java.">fastInit</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, font, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>, frc);
<a id="L394" name="L394"></a> 394         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L395" name="L395"></a> 395             <a href="../S/2484.html#L50" title="Defined at 50 in src/java/text/AttributedString.java.">AttributedString</a> as = <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a> == <strong class="reserved">null</strong>
<a id="L396" name="L396"></a> 396                 ? <strong class="reserved">new</strong> <a href="../S/2484.html#L50" title="Defined at 50 in src/java/text/AttributedString.java.">AttributedString</a>(<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>)
<a id="L397" name="L397"></a> 397                 : <strong class="reserved">new</strong> <a href="../S/2484.html#L50" title="Defined at 50 in src/java/text/AttributedString.java.">AttributedString</a>(<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>);
<a id="L398" name="L398"></a> 398             as.<a href="../D/10660.html" title="Multiple defined in 56 places.">addAttribute</a>(<a href="../S/2367.html#L255" title="Defined at 255 in src/java/awt/font/TextAttribute.java.">TextAttribute</a>.FONT, font);
<a id="L399" name="L399"></a> 399             <a href="../S/2375.html#L620" title="Defined at 620 in src/java/awt/font/TextLayout.java.">standardInit</a>(as.<a href="../D/19862.html" title="Multiple defined in 18 places.">getIterator</a>(), <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, frc);
<a id="L400" name="L400"></a> 400         <em class="brace">}</em>
<a id="L401" name="L401"></a> 401     <em class="brace">}</em>
<a id="L402" name="L402"></a> 402 
<div class="comment">
      Constructs a <code>TextLayout</code> from a <code>String</code>
      and an attribute set.
      <p>
      All the text is styled using the provided attributes.
      </p><p>
      <code>string</code> must specify a single paragraph of text because an
      entire paragraph is required for the bidirectional algorithm.
      @param string the text to display
      @param attributes the attributes used to style the text
      @param frc contains information about a graphics device which is needed
            to measure the text correctly.
            Text measurements can vary slightly depending on the
            device resolution, and attributes such as antialiasing.  This
            parameter does not specify a translation between the
            <code>TextLayout</code> and user space.</p></div>
<a id="L420" name="L420"></a> 420     <strong class="reserved">public</strong> TextLayout(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>, <a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/567.html" title="Multiple defined in 12 places.">Attribute</a>,?&gt; <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>,
<a id="L421" name="L421"></a> 421                       <a href="../S/2376.html#L66" title="Defined at 66 in src/java/awt/font/FontRenderContext.java.">FontRenderContext</a> frc)
<a id="L422" name="L422"></a> 422     <em class="brace">{</em>
<a id="L423" name="L423"></a> 423         <strong class="reserved">if</strong> (<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L424" name="L424"></a> 424             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null string passed to TextLayout constructor.");
<a id="L425" name="L425"></a> 425         <em class="brace">}</em>
<a id="L426" name="L426"></a> 426 
<a id="L427" name="L427"></a> 427         <strong class="reserved">if</strong> (<a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L428" name="L428"></a> 428             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null map passed to TextLayout constructor.");
<a id="L429" name="L429"></a> 429         <em class="brace">}</em>
<a id="L430" name="L430"></a> 430 
<a id="L431" name="L431"></a> 431         <strong class="reserved">if</strong> (<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 0) <em class="brace">{</em>
<a id="L432" name="L432"></a> 432             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Zero length string passed to TextLayout constructor.");
<a id="L433" name="L433"></a> 433         <em class="brace">}</em>
<a id="L434" name="L434"></a> 434 
<a id="L435" name="L435"></a> 435         <strong class="reserved">char</strong>[] <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a> = <a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>.<a href="../D/35368.html" title="Multiple defined in 3 places.">toCharArray</a>();
<a id="L436" name="L436"></a> 436         <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> font = <a href="../S/2375.html#L452" title="Defined at 452 in src/java/awt/font/TextLayout.java.">singleFont</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, 0, <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>);
<a id="L437" name="L437"></a> 437         <strong class="reserved">if</strong> (font != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L438" name="L438"></a> 438             <a href="../S/2375.html#L590" title="Defined at 590 in src/java/awt/font/TextLayout.java.">fastInit</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, font, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>, frc);
<a id="L439" name="L439"></a> 439         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L440" name="L440"></a> 440             <a href="../S/2484.html#L50" title="Defined at 50 in src/java/text/AttributedString.java.">AttributedString</a> as = <strong class="reserved">new</strong> <a href="../S/2484.html#L50" title="Defined at 50 in src/java/text/AttributedString.java.">AttributedString</a>(<a href="../S/4997.html#L463" title="Defined at 463 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">string</a>, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>);
<a id="L441" name="L441"></a> 441             <a href="../S/2375.html#L620" title="Defined at 620 in src/java/awt/font/TextLayout.java.">standardInit</a>(as.<a href="../D/19862.html" title="Multiple defined in 18 places.">getIterator</a>(), <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, frc);
<a id="L442" name="L442"></a> 442         <em class="brace">}</em>
<a id="L443" name="L443"></a> 443     <em class="brace">}</em>
<a id="L444" name="L444"></a> 444 
<div class="comment">
      Determines a font for the attributes, and if a single font can render
      all the text on one baseline, return it, otherwise null.  If the
      attributes specify a font, assume it can display all the text without
      checking.
      If the AttributeSet contains an embedded graphic, return null.</div>
<a id="L452" name="L452"></a> 452     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> <a href="../R/28629.html" title="Multiple referred from 2 places.">singleFont</a>(<strong class="reserved">char</strong>[] <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>,
<a id="L453" name="L453"></a> 453                                    <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>,
<a id="L454" name="L454"></a> 454                                    <strong class="reserved">int</strong> <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>,
<a id="L455" name="L455"></a> 455                                    <a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/567.html" title="Multiple defined in 12 places.">Attribute</a>, ?&gt; <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>) <em class="brace">{</em>
<a id="L456" name="L456"></a> 456 
<a id="L457" name="L457"></a> 457         <strong class="reserved">if</strong> (<a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../S/2367.html#L255" title="Defined at 255 in src/java/awt/font/TextAttribute.java.">TextAttribute</a>.CHAR_REPLACEMENT) != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L458" name="L458"></a> 458             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L459" name="L459"></a> 459         <em class="brace">}</em>
<a id="L460" name="L460"></a> 460 
<a id="L461" name="L461"></a> 461         <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> font = <strong class="reserved">null</strong>;
<a id="L462" name="L462"></a> 462         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L463" name="L463"></a> 463             font = (<a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a>)<a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../S/2367.html#L255" title="Defined at 255 in src/java/awt/font/TextAttribute.java.">TextAttribute</a>.FONT);
<a id="L464" name="L464"></a> 464         <em class="brace">}</em>
<a id="L465" name="L465"></a> 465         <strong class="reserved">catch</strong> (<a href="../S/1727.html#L41" title="Defined at 41 in src/java/lang/ClassCastException.java.">ClassCastException</a> e) <em class="brace">{</em>
<a id="L466" name="L466"></a> 466         <em class="brace">}</em>
<a id="L467" name="L467"></a> 467         <strong class="reserved">if</strong> (font == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L468" name="L468"></a> 468             <strong class="reserved">if</strong> (<a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../S/2367.html#L255" title="Defined at 255 in src/java/awt/font/TextAttribute.java.">TextAttribute</a>.FAMILY) != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L469" name="L469"></a> 469                 font = <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a>.<a href="../D/19178.html" title="Multiple defined in 44 places.">getFont</a>(<a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>);
<a id="L470" name="L470"></a> 470                 <strong class="reserved">if</strong> (font.<a href="../D/12138.html" title="Multiple defined in 3 places.">canDisplayUpTo</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) != -1) <em class="brace">{</em>
<a id="L471" name="L471"></a> 471                     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L472" name="L472"></a> 472                 <em class="brace">}</em>
<a id="L473" name="L473"></a> 473             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L474" name="L474"></a> 474                 FontResolver resolver = FontResolver.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>();
<a id="L475" name="L475"></a> 475                 <a href="../S/1675.html#L178" title="Defined at 178 in src/java/lang/CharSequence.java.">CodePointIterator</a> <a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a> = <a href="../S/1675.html#L178" title="Defined at 178 in src/java/lang/CharSequence.java.">CodePointIterator</a>.<a href="../D/13587.html" title="Multiple defined in 90 places.">create</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>);
<a id="L476" name="L476"></a> 476                 <strong class="reserved">int</strong> fontIndex = resolver.nextFontRunIndex(<a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>);
<a id="L477" name="L477"></a> 477                 <strong class="reserved">if</strong> (<a href="../D/26587.html" title="Multiple defined in 2 places.">iter</a>.charIndex() == <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) <em class="brace">{</em>
<a id="L478" name="L478"></a> 478                     font = resolver.<a href="../D/19178.html" title="Multiple defined in 44 places.">getFont</a>(fontIndex, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>);
<a id="L479" name="L479"></a> 479                 <em class="brace">}</em>
<a id="L480" name="L480"></a> 480             <em class="brace">}</em>
<a id="L481" name="L481"></a> 481         <em class="brace">}</em>
<a id="L482" name="L482"></a> 482 
<a id="L483" name="L483"></a> 483         <strong class="reserved">if</strong> (<a href="../S/2375.html#L2664" title="Defined at 2664 in src/java/awt/font/TextLayout.java.">sameBaselineUpTo</a>(font, <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) != <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) <em class="brace">{</em>
<a id="L484" name="L484"></a> 484             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L485" name="L485"></a> 485         <em class="brace">}</em>
<a id="L486" name="L486"></a> 486 
<a id="L487" name="L487"></a> 487         <strong class="reserved">return</strong> font;
<a id="L488" name="L488"></a> 488     <em class="brace">}</em>
<a id="L489" name="L489"></a> 489 
<div class="comment">
      Constructs a <code>TextLayout</code> from an iterator over styled text.
      <p>
      The iterator must specify a single paragraph of text because an
      entire paragraph is required for the bidirectional
      algorithm.
      @param text the styled text to display
      @param frc contains information about a graphics device which is needed
            to measure the text correctly.
            Text measurements can vary slightly depending on the
            device resolution, and attributes such as antialiasing.  This
            parameter does not specify a translation between the
            <code>TextLayout</code> and user space.</p></div>
<a id="L504" name="L504"></a> 504     <strong class="reserved">public</strong> TextLayout(<a href="../S/2454.html#L79" title="Defined at 79 in src/java/text/AttributedCharacterIterator.java.">AttributedCharacterIterator</a> <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, <a href="../S/2376.html#L66" title="Defined at 66 in src/java/awt/font/FontRenderContext.java.">FontRenderContext</a> frc) <em class="brace">{</em>
<a id="L505" name="L505"></a> 505 
<a id="L506" name="L506"></a> 506         <strong class="reserved">if</strong> (<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L507" name="L507"></a> 507             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null iterator passed to TextLayout constructor.");
<a id="L508" name="L508"></a> 508         <em class="brace">}</em>
<a id="L509" name="L509"></a> 509 
<a id="L510" name="L510"></a> 510         <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/17233.html" title="Multiple defined in 6 places.">getBeginIndex</a>();
<a id="L511" name="L511"></a> 511         <strong class="reserved">int</strong> <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a> = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/18768.html" title="Multiple defined in 8 places.">getEndIndex</a>();
<a id="L512" name="L512"></a> 512         <strong class="reserved">if</strong> (<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> == <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) <em class="brace">{</em>
<a id="L513" name="L513"></a> 513             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Zero length iterator passed to TextLayout constructor.");
<a id="L514" name="L514"></a> 514         <em class="brace">}</em>
<a id="L515" name="L515"></a> 515 
<a id="L516" name="L516"></a> 516         <strong class="reserved">int</strong> len = <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a> - <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L517" name="L517"></a> 517         <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L518" name="L518"></a> 518         <strong class="reserved">char</strong>[] <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a> = <strong class="reserved">new</strong> <strong class="reserved">char</strong>[len];
<a id="L519" name="L519"></a> 519         <strong class="reserved">int</strong> n = 0;
<a id="L520" name="L520"></a> 520         <strong class="reserved">for</strong> (<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L521" name="L521"></a> 521              <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> != <a href="../D/1412.html" title="Multiple defined in 2 places.">CharacterIterator</a>.DONE;
<a id="L522" name="L522"></a> 522              <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>())
<a id="L523" name="L523"></a> 523         <em class="brace">{</em>
<a id="L524" name="L524"></a> 524             <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>[n++] = <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>;
<a id="L525" name="L525"></a> 525         <em class="brace">}</em>
<a id="L526" name="L526"></a> 526 
<a id="L527" name="L527"></a> 527         <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L528" name="L528"></a> 528         <strong class="reserved">if</strong> (<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/22192.html" title="Multiple defined in 11 places.">getRunLimit</a>() == <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) <em class="brace">{</em>
<a id="L529" name="L529"></a> 529 
<a id="L530" name="L530"></a> 530             <a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/567.html" title="Multiple defined in 12 places.">Attribute</a>, ?&gt; <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a> = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/17112.html" title="Multiple defined in 109 places.">getAttributes</a>();
<a id="L531" name="L531"></a> 531             <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> font = <a href="../S/2375.html#L452" title="Defined at 452 in src/java/awt/font/TextLayout.java.">singleFont</a>(<a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, 0, len, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>);
<a id="L532" name="L532"></a> 532             <strong class="reserved">if</strong> (font != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L533" name="L533"></a> 533                 <a href="../S/2375.html#L590" title="Defined at 590 in src/java/awt/font/TextLayout.java.">fastInit</a>(<a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, font, <a href="../S/1947.html#L156" title="Defined at 156 in src/java/nio/file/FileTreeWalker.java.">attributes</a>, frc);
<a id="L534" name="L534"></a> 534                 <strong class="reserved">return</strong>;
<a id="L535" name="L535"></a> 535             <em class="brace">}</em>
<a id="L536" name="L536"></a> 536         <em class="brace">}</em>
<a id="L537" name="L537"></a> 537 
<a id="L538" name="L538"></a> 538         <a href="../S/2375.html#L620" title="Defined at 620 in src/java/awt/font/TextLayout.java.">standardInit</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, frc);
<a id="L539" name="L539"></a> 539     <em class="brace">}</em>
<a id="L540" name="L540"></a> 540 
<div class="comment">
      Creates a <code>TextLayout</code> from a <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a> and
      some paragraph data.  This method is used by {@link TextMeasurer}.
      @param textLine the line measurement attributes to apply to the
            the resulting <code>TextLayout</code>
      @param baseline the baseline of the text
      @param baselineOffsets the baseline offsets for this
      <code>TextLayout</code>.  This should already be normalized to
      <code>baseline</code>
      @param justifyRatio <code>0</code> if the <code>TextLayout</code>
          cannot be justified; <code>1</code> otherwise.</div>
<a id="L553" name="L553"></a> 553     TextLayout(<a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a> textLine,
<a id="L554" name="L554"></a> 554                <strong class="reserved">byte</strong> baseline,
<a id="L555" name="L555"></a> 555                <strong class="reserved">float</strong>[] baselineOffsets,
<a id="L556" name="L556"></a> 556                <strong class="reserved">float</strong> justifyRatio) <em class="brace">{</em>
<a id="L557" name="L557"></a> 557 
<a id="L558" name="L558"></a> 558         <strong class="reserved">this</strong>.<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a> = textLine.<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>();
<a id="L559" name="L559"></a> 559         <strong class="reserved">this</strong>.baseline = baseline;
<a id="L560" name="L560"></a> 560         <strong class="reserved">this</strong>.baselineOffsets = baselineOffsets;
<a id="L561" name="L561"></a> 561         <strong class="reserved">this</strong>.textLine = textLine;
<a id="L562" name="L562"></a> 562         <strong class="reserved">this</strong>.justifyRatio = justifyRatio;
<a id="L563" name="L563"></a> 563     <em class="brace">}</em>
<a id="L564" name="L564"></a> 564 
<div class="comment">
      Initialize the paragraph-specific data.</div>
<a id="L568" name="L568"></a> 568     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/24465.html" title="Multiple referred from 3 places.">paragraphInit</a>(<strong class="reserved">byte</strong> aBaseline, CoreMetrics lm,
<a id="L569" name="L569"></a> 569                                <a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/567.html" title="Multiple defined in 12 places.">Attribute</a>, ?&gt; paragraphAttrs,
<a id="L570" name="L570"></a> 570                                <strong class="reserved">char</strong>[] <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>) <em class="brace">{</em>
<a id="L571" name="L571"></a> 571 
<a id="L572" name="L572"></a> 572         baseline = aBaseline;
<a id="L573" name="L573"></a> 573 
<a id="L574" name="L574"></a> 574         <em class="comment">// normalize to current baseline</em>
<a id="L575" name="L575"></a> 575         baselineOffsets = <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a>.<a href="../S/2362.html#L1268" title="Defined at 1268 in src/java/awt/font/TextLine.java.">getNormalizedOffsets</a>(lm.baselineOffsets, baseline);
<a id="L576" name="L576"></a> 576 
<a id="L577" name="L577"></a> 577         justifyRatio = AttributeValues.<a href="../S/2704.html#L668" title="Defined at 668 in src/javax/swing/border/TitledBorder.java.">getJustification</a>(paragraphAttrs);
<a id="L578" name="L578"></a> 578         <a href="../S/2370.html#L136" title="Defined at 136 in src/java/awt/font/NumericShaper.java.">NumericShaper</a> shaper = AttributeValues.getNumericShaping(paragraphAttrs);
<a id="L579" name="L579"></a> 579         <strong class="reserved">if</strong> (shaper != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L580" name="L580"></a> 580             shaper.<a href="../D/34433.html" title="Multiple defined in 3 places.">shape</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, 0, <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L581" name="L581"></a> 581         <em class="brace">}</em>
<a id="L582" name="L582"></a> 582     <em class="brace">}</em>
<a id="L583" name="L583"></a> 583 
<div class="comment">
      the fast init generates a single glyph set.  This requires:
      all one style
      all renderable by one font (ie no embedded graphics)
      all on one baseline</div>
<a id="L590" name="L590"></a> 590     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/14252.html" title="Multiple referred from 3 places.">fastInit</a>(<strong class="reserved">char</strong>[] <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> font,
<a id="L591" name="L591"></a> 591                           <a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/567.html" title="Multiple defined in 12 places.">Attribute</a>, ?&gt; attrs,
<a id="L592" name="L592"></a> 592                           <a href="../S/2376.html#L66" title="Defined at 66 in src/java/awt/font/FontRenderContext.java.">FontRenderContext</a> frc) <em class="brace">{</em>
<a id="L593" name="L593"></a> 593 
<a id="L594" name="L594"></a> 594         <em class="comment">// Object vf = attrs.get(TextAttribute.ORIENTATION);</em>
<a id="L595" name="L595"></a> 595         <em class="comment">// isVerticalLine = TextAttribute.ORIENTATION_VERTICAL.equals(vf);</em>
<a id="L596" name="L596"></a> 596         isVerticalLine = <strong class="reserved">false</strong>;
<a id="L597" name="L597"></a> 597 
<a id="L598" name="L598"></a> 598         <a href="../S/2373.html#L44" title="Defined at 44 in src/java/awt/font/LineMetrics.java.">LineMetrics</a> lm = font.<a href="../D/20121.html" title="Multiple defined in 8 places.">getLineMetrics</a>(<a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, 0, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>, frc);
<a id="L599" name="L599"></a> 599         CoreMetrics cm = CoreMetrics.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(lm);
<a id="L600" name="L600"></a> 600         <strong class="reserved">byte</strong> glyphBaseline = (<strong class="reserved">byte</strong>) cm.baselineIndex;
<a id="L601" name="L601"></a> 601 
<a id="L602" name="L602"></a> 602         <strong class="reserved">if</strong> (attrs == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L603" name="L603"></a> 603             baseline = glyphBaseline;
<a id="L604" name="L604"></a> 604             baselineOffsets = cm.baselineOffsets;
<a id="L605" name="L605"></a> 605             justifyRatio = 1.0f;
<a id="L606" name="L606"></a> 606         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L607" name="L607"></a> 607             <a href="../S/2375.html#L568" title="Defined at 568 in src/java/awt/font/TextLayout.java.">paragraphInit</a>(glyphBaseline, cm, attrs, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>);
<a id="L608" name="L608"></a> 608         <em class="brace">}</em>
<a id="L609" name="L609"></a> 609 
<a id="L610" name="L610"></a> 610         <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L611" name="L611"></a> 611 
<a id="L612" name="L612"></a> 612         textLine = <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a>.<a href="../S/2362.html#L904" title="Defined at 904 in src/java/awt/font/TextLine.java.">fastCreateTextLine</a>(frc, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, font, cm, attrs);
<a id="L613" name="L613"></a> 613     <em class="brace">}</em>
<a id="L614" name="L614"></a> 614 
<div class="comment">
      the standard init generates multiple glyph sets based on style,
      renderable, and baseline runs.
      @param chars the text in the iterator, extracted into a char array</div>
<a id="L620" name="L620"></a> 620     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/28776.html" title="Multiple referred from 3 places.">standardInit</a>(<a href="../S/2454.html#L79" title="Defined at 79 in src/java/text/AttributedCharacterIterator.java.">AttributedCharacterIterator</a> <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, <strong class="reserved">char</strong>[] <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, <a href="../S/2376.html#L66" title="Defined at 66 in src/java/awt/font/FontRenderContext.java.">FontRenderContext</a> frc) <em class="brace">{</em>
<a id="L621" name="L621"></a> 621 
<a id="L622" name="L622"></a> 622         <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a> = <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L623" name="L623"></a> 623 
<a id="L624" name="L624"></a> 624         <em class="comment">// set paragraph attributes</em>
<a id="L625" name="L625"></a> 625         <em class="brace">{</em>
<a id="L626" name="L626"></a> 626             <em class="comment">// If there's an embedded graphic at the start of the</em>
<a id="L627" name="L627"></a> 627             <em class="comment">// paragraph, look for the first non-graphic character</em>
<a id="L628" name="L628"></a> 628             <em class="comment">// and use it and its font to initialize the paragraph.</em>
<a id="L629" name="L629"></a> 629             <em class="comment">// If not, use the first graphic to initialize.</em>
<a id="L630" name="L630"></a> 630 
<a id="L631" name="L631"></a> 631             <a href="../D/5398.html" title="Multiple defined in 3 places.">Map</a>&lt;? <strong class="reserved">extends</strong> <a href="../D/567.html" title="Multiple defined in 12 places.">Attribute</a>, ?&gt; paragraphAttrs = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/17112.html" title="Multiple defined in 109 places.">getAttributes</a>();
<a id="L632" name="L632"></a> 632 
<a id="L633" name="L633"></a> 633             <strong class="reserved">boolean</strong> haveFont = <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a>.<a href="../S/2362.html#L1253" title="Defined at 1253 in src/java/awt/font/TextLine.java.">advanceToFirstFont</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>);
<a id="L634" name="L634"></a> 634 
<a id="L635" name="L635"></a> 635             <strong class="reserved">if</strong> (haveFont) <em class="brace">{</em>
<a id="L636" name="L636"></a> 636                 <a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> defaultFont = <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a>.<a href="../S/2362.html#L1280" title="Defined at 1280 in src/java/awt/font/TextLine.java.">getFontAtCurrentPos</a>(<a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>);
<a id="L637" name="L637"></a> 637                 <strong class="reserved">int</strong> charsStart = <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/19664.html" title="Multiple defined in 76 places.">getIndex</a>() - <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>.<a href="../D/17233.html" title="Multiple defined in 6 places.">getBeginIndex</a>();
<a id="L638" name="L638"></a> 638                 <a href="../S/2373.html#L44" title="Defined at 44 in src/java/awt/font/LineMetrics.java.">LineMetrics</a> lm = defaultFont.<a href="../D/20121.html" title="Multiple defined in 8 places.">getLineMetrics</a>(<a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, charsStart, charsStart+1, frc);
<a id="L639" name="L639"></a> 639                 CoreMetrics cm = CoreMetrics.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(lm);
<a id="L640" name="L640"></a> 640                 <a href="../S/2375.html#L568" title="Defined at 568 in src/java/awt/font/TextLayout.java.">paragraphInit</a>((<strong class="reserved">byte</strong>)cm.baselineIndex, cm, paragraphAttrs, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>);
<a id="L641" name="L641"></a> 641             <em class="brace">}</em>
<a id="L642" name="L642"></a> 642             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L643" name="L643"></a> 643                 <em class="comment">// hmmm what to do here?  Just try to supply reasonable</em>
<a id="L644" name="L644"></a> 644                 <em class="comment">// values I guess.</em>
<a id="L645" name="L645"></a> 645 
<a id="L646" name="L646"></a> 646                 <a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a> graphic = (<a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a>)
<a id="L647" name="L647"></a> 647                                 paragraphAttrs.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(<a href="../S/2367.html#L255" title="Defined at 255 in src/java/awt/font/TextAttribute.java.">TextAttribute</a>.CHAR_REPLACEMENT);
<a id="L648" name="L648"></a> 648                 <strong class="reserved">byte</strong> defaultBaseline = <a href="../S/2375.html#L2677" title="Defined at 2677 in src/java/awt/font/TextLayout.java.">getBaselineFromGraphic</a>(graphic);
<a id="L649" name="L649"></a> 649                 CoreMetrics cm = GraphicComponent.createCoreMetrics(graphic);
<a id="L650" name="L650"></a> 650                 <a href="../S/2375.html#L568" title="Defined at 568 in src/java/awt/font/TextLayout.java.">paragraphInit</a>(defaultBaseline, cm, paragraphAttrs, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>);
<a id="L651" name="L651"></a> 651             <em class="brace">}</em>
<a id="L652" name="L652"></a> 652         <em class="brace">}</em>
<a id="L653" name="L653"></a> 653 
<a id="L654" name="L654"></a> 654         textLine = <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a>.<a href="../S/2362.html#L1193" title="Defined at 1193 in src/java/awt/font/TextLine.java.">standardCreateTextLine</a>(frc, <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>, <a href="../D/12342.html" title="Multiple defined in 2 places.">chars</a>, baselineOffsets);
<a id="L655" name="L655"></a> 655     <em class="brace">}</em>
<a id="L656" name="L656"></a> 656 
<div class="comment">
      A utility to rebuild the ascent/descent/leading/advance cache.
      You'll need to call this if you clone and mutate (like justification,
      editing methods do)</div>
<a id="L662" name="L662"></a> 662     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/13906.html" title="Multiple referred from 25 places.">ensureCache</a>() <em class="brace">{</em>
<a id="L663" name="L663"></a> 663         <strong class="reserved">if</strong> (!cacheIsValid) <em class="brace">{</em>
<a id="L664" name="L664"></a> 664             <a href="../S/2375.html#L668" title="Defined at 668 in src/java/awt/font/TextLayout.java.">buildCache</a>();
<a id="L665" name="L665"></a> 665         <em class="brace">}</em>
<a id="L666" name="L666"></a> 666     <em class="brace">}</em>
<a id="L667" name="L667"></a> 667 
<a id="L668" name="L668"></a> 668     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/2375.html#L664" title="Referred from 664 in src/java/awt/font/TextLayout.java.">buildCache</a>() <em class="brace">{</em>
<a id="L669" name="L669"></a> 669         lineMetrics = textLine.<a href="../S/2362.html#L547" title="Defined at 547 in src/java/awt/font/TextLine.java.">getMetrics</a>();
<a id="L670" name="L670"></a> 670 
<a id="L671" name="L671"></a> 671         <em class="comment">// compute visibleAdvance</em>
<a id="L672" name="L672"></a> 672         <strong class="reserved">if</strong> (textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>()) <em class="brace">{</em>
<a id="L673" name="L673"></a> 673 
<a id="L674" name="L674"></a> 674             <strong class="reserved">int</strong> lastNonSpace = <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>-1;
<a id="L675" name="L675"></a> 675             <strong class="reserved">while</strong> (lastNonSpace != -1) <em class="brace">{</em>
<a id="L676" name="L676"></a> 676                 <strong class="reserved">int</strong> logIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(lastNonSpace);
<a id="L677" name="L677"></a> 677                 <strong class="reserved">if</strong> (!textLine.<a href="../S/2362.html#L585" title="Defined at 585 in src/java/awt/font/TextLine.java.">isCharSpace</a>(logIndex)) <em class="brace">{</em>
<a id="L678" name="L678"></a> 678                     <strong class="reserved">break</strong>;
<a id="L679" name="L679"></a> 679                 <em class="brace">}</em>
<a id="L680" name="L680"></a> 680                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L681" name="L681"></a> 681                     --lastNonSpace;
<a id="L682" name="L682"></a> 682                 <em class="brace">}</em>
<a id="L683" name="L683"></a> 683             <em class="brace">}</em>
<a id="L684" name="L684"></a> 684             <strong class="reserved">if</strong> (lastNonSpace == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>-1) <em class="brace">{</em>
<a id="L685" name="L685"></a> 685                 visibleAdvance = lineMetrics.<a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>;
<a id="L686" name="L686"></a> 686             <em class="brace">}</em>
<a id="L687" name="L687"></a> 687             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (lastNonSpace == -1) <em class="brace">{</em>
<a id="L688" name="L688"></a> 688                 visibleAdvance = 0;
<a id="L689" name="L689"></a> 689             <em class="brace">}</em>
<a id="L690" name="L690"></a> 690             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L691" name="L691"></a> 691                 <strong class="reserved">int</strong> logIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(lastNonSpace);
<a id="L692" name="L692"></a> 692                 visibleAdvance = textLine.<a href="../D/17591.html" title="Multiple defined in 2 places.">getCharLinePosition</a>(logIndex)
<a id="L693" name="L693"></a> 693                                         + textLine.<a href="../S/2362.html#L663" title="Defined at 663 in src/java/awt/font/TextLine.java.">getCharAdvance</a>(logIndex);
<a id="L694" name="L694"></a> 694             <em class="brace">}</em>
<a id="L695" name="L695"></a> 695         <em class="brace">}</em>
<a id="L696" name="L696"></a> 696         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L697" name="L697"></a> 697 
<a id="L698" name="L698"></a> 698             <strong class="reserved">int</strong> leftmostNonSpace = 0;
<a id="L699" name="L699"></a> 699             <strong class="reserved">while</strong> (leftmostNonSpace != <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L700" name="L700"></a> 700                 <strong class="reserved">int</strong> logIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(leftmostNonSpace);
<a id="L701" name="L701"></a> 701                 <strong class="reserved">if</strong> (!textLine.<a href="../S/2362.html#L585" title="Defined at 585 in src/java/awt/font/TextLine.java.">isCharSpace</a>(logIndex)) <em class="brace">{</em>
<a id="L702" name="L702"></a> 702                     <strong class="reserved">break</strong>;
<a id="L703" name="L703"></a> 703                 <em class="brace">}</em>
<a id="L704" name="L704"></a> 704                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L705" name="L705"></a> 705                     ++leftmostNonSpace;
<a id="L706" name="L706"></a> 706                 <em class="brace">}</em>
<a id="L707" name="L707"></a> 707             <em class="brace">}</em>
<a id="L708" name="L708"></a> 708             <strong class="reserved">if</strong> (leftmostNonSpace == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L709" name="L709"></a> 709                 visibleAdvance = 0;
<a id="L710" name="L710"></a> 710             <em class="brace">}</em>
<a id="L711" name="L711"></a> 711             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (leftmostNonSpace == 0) <em class="brace">{</em>
<a id="L712" name="L712"></a> 712                 visibleAdvance = lineMetrics.<a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>;
<a id="L713" name="L713"></a> 713             <em class="brace">}</em>
<a id="L714" name="L714"></a> 714             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L715" name="L715"></a> 715                 <strong class="reserved">int</strong> logIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(leftmostNonSpace);
<a id="L716" name="L716"></a> 716                 <strong class="reserved">float</strong> pos = textLine.<a href="../D/17591.html" title="Multiple defined in 2 places.">getCharLinePosition</a>(logIndex);
<a id="L717" name="L717"></a> 717                 visibleAdvance = lineMetrics.<a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a> - pos;
<a id="L718" name="L718"></a> 718             <em class="brace">}</em>
<a id="L719" name="L719"></a> 719         <em class="brace">}</em>
<a id="L720" name="L720"></a> 720 
<a id="L721" name="L721"></a> 721         <em class="comment">// naturalBounds, boundsRect will be generated on demand</em>
<a id="L722" name="L722"></a> 722         naturalBounds = <strong class="reserved">null</strong>;
<a id="L723" name="L723"></a> 723         boundsRect = <strong class="reserved">null</strong>;
<a id="L724" name="L724"></a> 724 
<a id="L725" name="L725"></a> 725         <em class="comment">// hashCode will be regenerated on demand</em>
<a id="L726" name="L726"></a> 726         hashCodeCache = 0;
<a id="L727" name="L727"></a> 727 
<a id="L728" name="L728"></a> 728         cacheIsValid = <strong class="reserved">true</strong>;
<a id="L729" name="L729"></a> 729     <em class="brace">}</em>
<a id="L730" name="L730"></a> 730 
<div class="comment">
      The 'natural bounds' encloses all the carets the layout can draw.</div>
<a id="L735" name="L735"></a> 735     <strong class="reserved">private</strong> <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../R/17878.html" title="Multiple referred from 6 places.">getNaturalBounds</a>() <em class="brace">{</em>
<a id="L736" name="L736"></a> 736         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L737" name="L737"></a> 737 
<a id="L738" name="L738"></a> 738         <strong class="reserved">if</strong> (naturalBounds == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L739" name="L739"></a> 739             naturalBounds = textLine.<a href="../S/2362.html#L845" title="Defined at 845 in src/java/awt/font/TextLine.java.">getItalicBounds</a>();
<a id="L740" name="L740"></a> 740         <em class="brace">}</em>
<a id="L741" name="L741"></a> 741 
<a id="L742" name="L742"></a> 742         <strong class="reserved">return</strong> naturalBounds;
<a id="L743" name="L743"></a> 743     <em class="brace">}</em>
<a id="L744" name="L744"></a> 744 
<div class="comment">
      Creates a copy of this <code>TextLayout</code>.</div>
<a id="L748" name="L748"></a> 748     <strong class="reserved">protected</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../R/11555.html" title="Multiple referred from 1378 places.">clone</a>() <em class="brace">{</em>
<div class="comment">
          !!! I think this is safe.  Once created, nothing mutates the
          glyphvectors or arrays.  But we need to make sure.
          {jbr} actually, that's not quite true.  The justification code
          mutates after cloning.  It doesn't actually change the glyphvectors
          (that's impossible) but it replaces them with justified sets.  This
          is a problem for GlyphIterator creation, since new GlyphIterators
          are created by cloning a prototype.  If the prototype has outdated
          glyphvectors, so will the new ones.  A partial solution is to set the
          prototypical GlyphIterator to null when the glyphvectors change.  If
          you forget this one time, you're hosed.</div>
<a id="L761" name="L761"></a> 761         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L762" name="L762"></a> 762             <strong class="reserved">return</strong> <strong class="reserved">super</strong>.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L763" name="L763"></a> 763         <em class="brace">}</em>
<a id="L764" name="L764"></a> 764         <strong class="reserved">catch</strong> (<a href="../S/1725.html#L45" title="Defined at 45 in src/java/lang/CloneNotSupportedException.java.">CloneNotSupportedException</a> e) <em class="brace">{</em>
<a id="L765" name="L765"></a> 765             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4325.html" title="Multiple defined in 2 places.">InternalError</a>(e);
<a id="L766" name="L766"></a> 766         <em class="brace">}</em>
<a id="L767" name="L767"></a> 767     <em class="brace">}</em>
<a id="L768" name="L768"></a> 768 
<div class="comment">
      Utility to throw an expection if an invalid TextHitInfo is passed
      as a parameter.  Avoids code duplication.</div>
<a id="L773" name="L773"></a> 773     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/11385.html" title="Multiple referred from 11 places.">checkTextHit</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>) <em class="brace">{</em>
<a id="L774" name="L774"></a> 774         <strong class="reserved">if</strong> (<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L775" name="L775"></a> 775             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("TextHitInfo is null.");
<a id="L776" name="L776"></a> 776         <em class="brace">}</em>
<a id="L777" name="L777"></a> 777 
<a id="L778" name="L778"></a> 778         <strong class="reserved">if</strong> (<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L127" title="Defined at 127 in src/java/awt/font/TextHitInfo.java.">getInsertionIndex</a>() &lt; 0 ||
<a id="L779" name="L779"></a> 779             <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L127" title="Defined at 127 in src/java/awt/font/TextHitInfo.java.">getInsertionIndex</a>() &gt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L780" name="L780"></a> 780             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("TextHitInfo is out of range");
<a id="L781" name="L781"></a> 781         <em class="brace">}</em>
<a id="L782" name="L782"></a> 782     <em class="brace">}</em>
<a id="L783" name="L783"></a> 783 
<div class="comment">
      Creates a copy of this <code>TextLayout</code> justified to the
      specified width.
      <p>
      If this <code>TextLayout</code> has already been justified, an
      exception is thrown.  If this <code>TextLayout</code> object's
      justification ratio is zero, a <code>TextLayout</code> identical
      to this <code>TextLayout</code> is returned.
      @param justificationWidth the width to use when justifying the line.
      For best results, it should not be too different from the current
      advance of the line.
      @return a <code>TextLayout</code> justified to the specified width.
      @exception Error if this layout has already been justified, an Error is
      thrown.</p></div>
<a id="L799" name="L799"></a> 799     <strong class="reserved">public</strong> <a href="../S/2375.html#L239" title="Defined at 239 in src/java/awt/font/TextLayout.java.">TextLayout</a> getJustifiedLayout(<strong class="reserved">float</strong> justificationWidth) <em class="brace">{</em>
<a id="L800" name="L800"></a> 800 
<a id="L801" name="L801"></a> 801         <strong class="reserved">if</strong> (justificationWidth &lt;= 0) <em class="brace">{</em>
<a id="L802" name="L802"></a> 802             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("justificationWidth &lt;= 0 passed to TextLayout.getJustifiedLayout()");
<a id="L803" name="L803"></a> 803         <em class="brace">}</em>
<a id="L804" name="L804"></a> 804 
<a id="L805" name="L805"></a> 805         <strong class="reserved">if</strong> (justifyRatio == ALREADY_JUSTIFIED) <em class="brace">{</em>
<a id="L806" name="L806"></a> 806             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>("Can't justify again.");
<a id="L807" name="L807"></a> 807         <em class="brace">}</em>
<a id="L808" name="L808"></a> 808 
<a id="L809" name="L809"></a> 809         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>(); <em class="comment">// make sure textLine is not null</em>
<a id="L810" name="L810"></a> 810 
<a id="L811" name="L811"></a> 811         <em class="comment">// default justification range to exclude trailing logical whitespace</em>
<a id="L812" name="L812"></a> 812         <strong class="reserved">int</strong> <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a> = <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>;
<a id="L813" name="L813"></a> 813         <strong class="reserved">while</strong> (<a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a> &gt; 0 &amp;&amp; textLine.<a href="../S/2362.html#L590" title="Defined at 590 in src/java/awt/font/TextLine.java.">isCharWhitespace</a>(<a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>-1)) <em class="brace">{</em>
<a id="L814" name="L814"></a> 814             --<a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>;
<a id="L815" name="L815"></a> 815         <em class="brace">}</em>
<a id="L816" name="L816"></a> 816 
<a id="L817" name="L817"></a> 817         <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a> <a href="../D/28033.html" title="Multiple defined in 3 places.">newLine</a> = textLine.<a href="../S/2362.html#L1316" title="Defined at 1316 in src/java/awt/font/TextLine.java.">getJustifiedLine</a>(justificationWidth, justifyRatio, 0, <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>);
<a id="L818" name="L818"></a> 818         <strong class="reserved">if</strong> (<a href="../D/28033.html" title="Multiple defined in 3 places.">newLine</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L819" name="L819"></a> 819             <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/2375.html#L239" title="Defined at 239 in src/java/awt/font/TextLayout.java.">TextLayout</a>(<a href="../D/28033.html" title="Multiple defined in 3 places.">newLine</a>, baseline, baselineOffsets, ALREADY_JUSTIFIED);
<a id="L820" name="L820"></a> 820         <em class="brace">}</em>
<a id="L821" name="L821"></a> 821 
<a id="L822" name="L822"></a> 822         <strong class="reserved">return</strong> <strong class="reserved">this</strong>;
<a id="L823" name="L823"></a> 823     <em class="brace">}</em>
<a id="L824" name="L824"></a> 824 
<div class="comment">
      Justify this layout.  Overridden by subclassers to control justification
      (if there were subclassers, that is...)
      The layout will only justify if the paragraph attributes (from the
      source text, possibly defaulted by the layout attributes) indicate a
      non-zero justification ratio.  The text will be justified to the
      indicated width.  The current implementation also adjusts hanging
      punctuation and trailing whitespace to overhang the justification width.
      Once justified, the layout may not be rejustified.
      <p>
      Some code may rely on immutablity of layouts.  Subclassers should not
      call this directly, but instead should call getJustifiedLayout, which
      will call this method on a clone of this layout, preserving
      the original.
      @param justificationWidth the width to use when justifying the line.
      For best results, it should not be too different from the current
      advance of the line.
      @see #getJustifiedLayout(float)</p></div>
<a id="L846" name="L846"></a> 846     <strong class="reserved">protected</strong> <strong class="reserved">void</strong> handleJustify(<strong class="reserved">float</strong> justificationWidth) <em class="brace">{</em>
<a id="L847" name="L847"></a> 847       <em class="comment">// never called</em>
<a id="L848" name="L848"></a> 848     <em class="brace">}</em>
<a id="L849" name="L849"></a> 849 
<a id="L850" name="L850"></a> 850 
<div class="comment">
      Returns the baseline for this <code>TextLayout</code>.
      The baseline is one of the values defined in <code>Font</code>,
      which are roman, centered and hanging.  Ascent and descent are
      relative to this baseline.  The <code>baselineOffsets</code>
      are also relative to this baseline.
      @return the baseline of this <code>TextLayout</code>.
      @see #getBaselineOffsets()
      @see Font</div>
<a id="L861" name="L861"></a> 861     <strong class="reserved">public</strong> <strong class="reserved">byte</strong> <a href="../R/15235.html" title="Multiple referred from 69 places.">getBaseline</a>() <em class="brace">{</em>
<a id="L862" name="L862"></a> 862         <strong class="reserved">return</strong> baseline;
<a id="L863" name="L863"></a> 863     <em class="brace">}</em>
<a id="L864" name="L864"></a> 864 
<div class="comment">
      Returns the offsets array for the baselines used for this
      <code>TextLayout</code>.
      <p>
      The array is indexed by one of the values defined in
      <code>Font</code>, which are roman, centered and hanging.  The
      values are relative to this <code>TextLayout</code> object's
      baseline, so that <code>getBaselineOffsets[getBaseline()] == 0</code>.
      Offsets are added to the position of the <code>TextLayout</code>
      object's baseline to get the position for the new baseline.
      @return the offsets array containing the baselines used for this
         <code>TextLayout</code>.
      @see #getBaseline()
      @see Font</p></div>
<a id="L880" name="L880"></a> 880     <strong class="reserved">public</strong> <strong class="reserved">float</strong>[] <a href="../R/15241.html" title="Multiple referred from 2 places.">getBaselineOffsets</a>() <em class="brace">{</em>
<a id="L881" name="L881"></a> 881         <strong class="reserved">float</strong>[] offsets = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[baselineOffsets.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>];
<a id="L882" name="L882"></a> 882         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(baselineOffsets, 0, offsets, 0, offsets.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L883" name="L883"></a> 883         <strong class="reserved">return</strong> offsets;
<a id="L884" name="L884"></a> 884     <em class="brace">}</em>
<a id="L885" name="L885"></a> 885 
<div class="comment">
      Returns the advance of this <code>TextLayout</code>.
      The advance is the distance from the origin to the advance of the
      rightmost (bottommost) character.  This is in baseline-relative
      coordinates.
      @return the advance of this <code>TextLayout</code>.</div>
<a id="L893" name="L893"></a> 893     <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/14995.html" title="Multiple referred from 6 places.">getAdvance</a>() <em class="brace">{</em>
<a id="L894" name="L894"></a> 894         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L895" name="L895"></a> 895         <strong class="reserved">return</strong> lineMetrics.<a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>;
<a id="L896" name="L896"></a> 896     <em class="brace">}</em>
<a id="L897" name="L897"></a> 897 
<div class="comment">
      Returns the advance of this <code>TextLayout</code>, minus trailing
      whitespace.  This is in baseline-relative coordinates.
      @return the advance of this <code>TextLayout</code> without the
           trailing whitespace.
      @see #getAdvance()</div>
<a id="L905" name="L905"></a> 905     <strong class="reserved">public</strong> <strong class="reserved">float</strong> getVisibleAdvance() <em class="brace">{</em>
<a id="L906" name="L906"></a> 906         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L907" name="L907"></a> 907         <strong class="reserved">return</strong> visibleAdvance;
<a id="L908" name="L908"></a> 908     <em class="brace">}</em>
<a id="L909" name="L909"></a> 909 
<div class="comment">
      Returns the ascent of this <code>TextLayout</code>.
      The ascent is the distance from the top (right) of the
      <code>TextLayout</code> to the baseline.  It is always either
      positive or zero.  The ascent is sufficient to
      accommodate superscripted text and is the maximum of the sum of the
      ascent, offset, and baseline of each glyph.  The ascent is
      the maximum ascent from the baseline of all the text in the
      TextLayout.  It is in baseline-relative coordinates.
      @return the ascent of this <code>TextLayout</code>.</div>
<a id="L921" name="L921"></a> 921     <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/15126.html" title="Multiple referred from 80 places.">getAscent</a>() <em class="brace">{</em>
<a id="L922" name="L922"></a> 922         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L923" name="L923"></a> 923         <strong class="reserved">return</strong> lineMetrics.ascent;
<a id="L924" name="L924"></a> 924     <em class="brace">}</em>
<a id="L925" name="L925"></a> 925 
<div class="comment">
      Returns the descent of this <code>TextLayout</code>.
      The descent is the distance from the baseline to the bottom (left) of
      the <code>TextLayout</code>.  It is always either positive or zero.
      The descent is sufficient to accommodate subscripted text and is the
      maximum of the sum of the descent, offset, and baseline of each glyph.
      This is the maximum descent from the baseline of all the text in
      the TextLayout.  It is in baseline-relative coordinates.
      @return the descent of this <code>TextLayout</code>.</div>
<a id="L936" name="L936"></a> 936     <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/16120.html" title="Multiple referred from 35 places.">getDescent</a>() <em class="brace">{</em>
<a id="L937" name="L937"></a> 937         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L938" name="L938"></a> 938         <strong class="reserved">return</strong> lineMetrics.descent;
<a id="L939" name="L939"></a> 939     <em class="brace">}</em>
<a id="L940" name="L940"></a> 940 
<div class="comment">
      Returns the leading of the <code>TextLayout</code>.
      The leading is the suggested interline spacing for this
      <code>TextLayout</code>.  This is in baseline-relative
      coordinates.
      <p>
      The leading is computed from the leading, descent, and baseline
      of all glyphvectors in the <code>TextLayout</code>.  The algorithm
      is roughly as follows:
      </p><blockquote><pre>      maxD = 0;
      maxDL = 0;
      for (GlyphVector g in all glyphvectors) {
         maxD = max(maxD, g.getDescent() + offsets[g.getBaseline()]);
         maxDL = max(maxDL, g.getDescent() + g.getLeading() +
                            offsets[g.getBaseline()]);
      }
      return maxDL - maxD;
      </pre></blockquote>
      @return the leading of this <code>TextLayout</code>.</div>
<a id="L962" name="L962"></a> 962     <strong class="reserved">public</strong> <strong class="reserved">float</strong> <a href="../R/17317.html" title="Multiple referred from 11 places.">getLeading</a>() <em class="brace">{</em>
<a id="L963" name="L963"></a> 963         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L964" name="L964"></a> 964         <strong class="reserved">return</strong> lineMetrics.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>;
<a id="L965" name="L965"></a> 965     <em class="brace">}</em>
<a id="L966" name="L966"></a> 966 
<div class="comment">
      Returns the bounds of this <code>TextLayout</code>.
      The bounds are in standard coordinates.
      <p>Due to rasterization effects, this bounds might not enclose all of the
      pixels rendered by the TextLayout.</p>
      It might not coincide exactly with the ascent, descent,
      origin or advance of the <code>TextLayout</code>.
      @return a <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> that is the bounds of this
             <code>TextLayout</code>.</div>
<a id="L977" name="L977"></a> 977     <strong class="reserved">public</strong> <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../R/15322.html" title="Multiple referred from 273 places.">getBounds</a>() <em class="brace">{</em>
<a id="L978" name="L978"></a> 978         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L979" name="L979"></a> 979 
<a id="L980" name="L980"></a> 980         <strong class="reserved">if</strong> (boundsRect == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L981" name="L981"></a> 981             <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> vb = textLine.<a href="../D/23631.html" title="Multiple defined in 2 places.">getVisualBounds</a>();
<a id="L982" name="L982"></a> 982             <strong class="reserved">if</strong> (dx != 0 || dy != 0) <em class="brace">{</em>
<a id="L983" name="L983"></a> 983                 vb.<a href="../D/33672.html" title="Multiple defined in 10 places.">setRect</a>(vb.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>() - dx,
<a id="L984" name="L984"></a> 984                            vb.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>() - dy,
<a id="L985" name="L985"></a> 985                            vb.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>(),
<a id="L986" name="L986"></a> 986                            vb.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>());
<a id="L987" name="L987"></a> 987             <em class="brace">}</em>
<a id="L988" name="L988"></a> 988             boundsRect = vb;
<a id="L989" name="L989"></a> 989         <em class="brace">}</em>
<a id="L990" name="L990"></a> 990 
<a id="L991" name="L991"></a> 991         <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a> = <strong class="reserved">new</strong> <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a>.<a href="../D/3293.html" title="Multiple defined in 10 places.">Float</a>();
<a id="L992" name="L992"></a> 992         <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/33672.html" title="Multiple defined in 10 places.">setRect</a>(boundsRect);
<a id="L993" name="L993"></a> 993 
<a id="L994" name="L994"></a> 994         <strong class="reserved">return</strong> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>;
<a id="L995" name="L995"></a> 995     <em class="brace">}</em>
<a id="L996" name="L996"></a> 996 
<div class="comment">
      Returns the pixel bounds of this <code>TextLayout</code> when
      rendered in a graphics with the given
      <code>FontRenderContext</code> at the given location.  The
      graphics render context need not be the same as the
      <code>FontRenderContext</code> used to create this
      <code>TextLayout</code>, and can be null.  If it is null, the
      <code>FontRenderContext</code> of this <code>TextLayout</code>
      is used.
      @param frc the <code>FontRenderContext</code> of the <code>Graphics</code>.
      @param x the x-coordinate at which to render this <code>TextLayout</code>.
      @param y the y-coordinate at which to render this <code>TextLayout</code>.
      @return a <code>Rectangle</code> bounding the pixels that would be affected.
      @see GlyphVector#getPixelBounds
      @since 1.6</div>
<a id="L1013" name="L1013"></a>1013     <strong class="reserved">public</strong> <a href="../S/2314.html#L119" title="Defined at 119 in src/java/awt/Rectangle.java.">Rectangle</a> <a href="../R/18345.html" title="Multiple referred from 2 places.">getPixelBounds</a>(<a href="../S/2376.html#L66" title="Defined at 66 in src/java/awt/font/FontRenderContext.java.">FontRenderContext</a> frc, <strong class="reserved">float</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">float</strong> y) <em class="brace">{</em>
<a id="L1014" name="L1014"></a>1014         <strong class="reserved">return</strong> textLine.<a href="../D/21493.html" title="Multiple defined in 3 places.">getPixelBounds</a>(frc, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y);
<a id="L1015" name="L1015"></a>1015     <em class="brace">}</em>
<a id="L1016" name="L1016"></a>1016 
<div class="comment">
      Returns <code>true</code> if this <code>TextLayout</code> has
      a left-to-right base direction or <code>false</code> if it has
      a right-to-left base direction.  The <code>TextLayout</code>
      has a base direction of either left-to-right (LTR) or
      right-to-left (RTL).  The base direction is independent of the
      actual direction of text on the line, which may be either LTR,
      RTL, or mixed. Left-to-right layouts by default should position
      flush left.  If the layout is on a tabbed line, the
      tabs run left to right, so that logically successive layouts position
      left to right.  The opposite is true for RTL layouts. By default they
      should position flush left, and tabs run right-to-left.
      @return <code>true</code> if the base direction of this
              <code>TextLayout</code> is left-to-right; <code>false</code>
              otherwise.</div>
<a id="L1033" name="L1033"></a>1033     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21649.html" title="Multiple referred from 325 places.">isLeftToRight</a>() <em class="brace">{</em>
<a id="L1034" name="L1034"></a>1034         <strong class="reserved">return</strong> textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>();
<a id="L1035" name="L1035"></a>1035     <em class="brace">}</em>
<a id="L1036" name="L1036"></a>1036 
<div class="comment">
      Returns <code>true</code> if this <code>TextLayout</code> is vertical.
      @return <code>true</code> if this <code>TextLayout</code> is vertical;
           <code>false</code> otherwise.</div>
<a id="L1042" name="L1042"></a>1042     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/22213.html" title="Multiple referred from 9 places.">isVertical</a>() <em class="brace">{</em>
<a id="L1043" name="L1043"></a>1043         <strong class="reserved">return</strong> isVerticalLine;
<a id="L1044" name="L1044"></a>1044     <em class="brace">}</em>
<a id="L1045" name="L1045"></a>1045 
<div class="comment">
      Returns the number of characters represented by this
      <code>TextLayout</code>.
      @return the number of characters in this <code>TextLayout</code>.</div>
<a id="L1051" name="L1051"></a>1051     <strong class="reserved">public</strong> <strong class="reserved">int</strong> getCharacterCount() <em class="brace">{</em>
<a id="L1052" name="L1052"></a>1052         <strong class="reserved">return</strong> <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>;
<a id="L1053" name="L1053"></a>1053     <em class="brace">}</em>
<a id="L1054" name="L1054"></a>1054 
<div class="comment">
      carets and hit testing
      Positions on a text line are represented by instances of TextHitInfo.
      Any TextHitInfo with characterOffset between 0 and characterCount-1,
      inclusive, represents a valid position on the line.  Additionally,
      [-1, trailing] and [characterCount, leading] are valid positions, and
      represent positions at the logical start and end of the line,
      respectively.
      The characterOffsets in TextHitInfo's used and returned by TextLayout
      are relative to the beginning of the text layout, not necessarily to
      the beginning of the text storage the client is using.
      Every valid TextHitInfo has either one or two carets associated with it.
      A caret is a visual location in the TextLayout indicating where text at
      the TextHitInfo will be displayed on screen.  If a TextHitInfo
      represents a location on a directional boundary, then there are two
      possible visible positions for newly inserted text.  Consider the
      following example, in which capital letters indicate right-to-left text,
      and the overall line direction is left-to-right:
      Text Storage: [ a, b, C, D, E, f ]
      Display:        a b E D C f
      The text hit info (1, t) represents the trailing side of 'b'.  If 'q',
      a left-to-right character is inserted into the text storage at this
      location, it will be displayed between the 'b' and the 'E':
      Text Storage: [ a, b, q, C, D, E, f ]
      Display:        a b q E D C f
      However, if a 'W', which is right-to-left, is inserted into the storage
      after 'b', the storage and display will be:
      Text Storage: [ a, b, W, C, D, E, f ]
      Display:        a b E D C W f
      So, for the original text storage, two carets should be displayed for
      location (1, t): one visually between 'b' and 'E' and one visually
      between 'C' and 'f'.
      When two carets are displayed for a TextHitInfo, one caret is the
      'strong' caret and the other is the 'weak' caret.  The strong caret
      indicates where an inserted character will be displayed when that
      character's direction is the same as the direction of the TextLayout.
      The weak caret shows where an character inserted character will be
      displayed when the character's direction is opposite that of the
      TextLayout.
      Clients should not be overly concerned with the details of correct
      caret display. TextLayout.getCaretShapes(TextHitInfo) will return an
      array of two paths representing where carets should be displayed.
      The first path in the array is the strong caret; the second element,
      if non-null, is the weak caret.  If the second element is null,
      then there is no weak caret for the given TextHitInfo.
      Since text can be visually reordered, logically consecutive
      TextHitInfo's may not be visually consecutive.  One implication of this
      is that a client cannot tell from inspecting a TextHitInfo whether the
      hit represents the first (or last) caret in the layout.  Clients
      can call getVisualOtherHit();  if the visual companion is
      (-1, TRAILING) or (characterCount, LEADING), then the hit is at the
      first (last) caret position in the layout.</div>
<a id="L1124" name="L1124"></a>1124 
<a id="L1125" name="L1125"></a>1125     <strong class="reserved">private</strong> <strong class="reserved">float</strong>[] <a href="../R/15448.html" title="Multiple referred from 7 places.">getCaretInfo</a>(<strong class="reserved">int</strong> caret,
<a id="L1126" name="L1126"></a>1126                                  <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>,
<a id="L1127" name="L1127"></a>1127                                  <strong class="reserved">float</strong>[] <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>) <em class="brace">{</em>
<a id="L1128" name="L1128"></a>1128 
<a id="L1129" name="L1129"></a>1129         <strong class="reserved">float</strong> top1X, top2X;
<a id="L1130" name="L1130"></a>1130         <strong class="reserved">float</strong> bottom1X, bottom2X;
<a id="L1131" name="L1131"></a>1131 
<a id="L1132" name="L1132"></a>1132         <strong class="reserved">if</strong> (caret == 0 || caret == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1133" name="L1133"></a>1133 
<a id="L1134" name="L1134"></a>1134             <strong class="reserved">float</strong> pos;
<a id="L1135" name="L1135"></a>1135             <strong class="reserved">int</strong> logIndex;
<a id="L1136" name="L1136"></a>1136             <strong class="reserved">if</strong> (caret == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1137" name="L1137"></a>1137                 logIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>-1);
<a id="L1138" name="L1138"></a>1138                 pos = textLine.<a href="../D/17591.html" title="Multiple defined in 2 places.">getCharLinePosition</a>(logIndex)
<a id="L1139" name="L1139"></a>1139                                         + textLine.<a href="../S/2362.html#L663" title="Defined at 663 in src/java/awt/font/TextLine.java.">getCharAdvance</a>(logIndex);
<a id="L1140" name="L1140"></a>1140             <em class="brace">}</em>
<a id="L1141" name="L1141"></a>1141             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1142" name="L1142"></a>1142                 logIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(caret);
<a id="L1143" name="L1143"></a>1143                 pos = textLine.<a href="../D/17591.html" title="Multiple defined in 2 places.">getCharLinePosition</a>(logIndex);
<a id="L1144" name="L1144"></a>1144             <em class="brace">}</em>
<a id="L1145" name="L1145"></a>1145             <strong class="reserved">float</strong> angle = textLine.<a href="../S/2362.html#L595" title="Defined at 595 in src/java/awt/font/TextLine.java.">getCharAngle</a>(logIndex);
<a id="L1146" name="L1146"></a>1146             <strong class="reserved">float</strong> <a href="../S/4397.html#L337" title="Defined at 337 in src/javax/sound/sampled/FloatControl.java.">shift</a> = textLine.<a href="../S/2362.html#L636" title="Defined at 636 in src/java/awt/font/TextLine.java.">getCharShift</a>(logIndex);
<a id="L1147" name="L1147"></a>1147             pos += angle * <a href="../S/4397.html#L337" title="Defined at 337 in src/javax/sound/sampled/FloatControl.java.">shift</a>;
<a id="L1148" name="L1148"></a>1148             top1X = top2X = pos + angle*textLine.<a href="../S/2362.html#L626" title="Defined at 626 in src/java/awt/font/TextLine.java.">getCharAscent</a>(logIndex);
<a id="L1149" name="L1149"></a>1149             bottom1X = bottom2X = pos - angle*textLine.<a href="../S/2362.html#L631" title="Defined at 631 in src/java/awt/font/TextLine.java.">getCharDescent</a>(logIndex);
<a id="L1150" name="L1150"></a>1150         <em class="brace">}</em>
<a id="L1151" name="L1151"></a>1151         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1152" name="L1152"></a>1152 
<a id="L1153" name="L1153"></a>1153             <em class="brace">{</em>
<a id="L1154" name="L1154"></a>1154                 <strong class="reserved">int</strong> logIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(caret-1);
<a id="L1155" name="L1155"></a>1155                 <strong class="reserved">float</strong> angle1 = textLine.<a href="../S/2362.html#L595" title="Defined at 595 in src/java/awt/font/TextLine.java.">getCharAngle</a>(logIndex);
<a id="L1156" name="L1156"></a>1156                 <strong class="reserved">float</strong> pos1 = textLine.<a href="../D/17591.html" title="Multiple defined in 2 places.">getCharLinePosition</a>(logIndex)
<a id="L1157" name="L1157"></a>1157                                     + textLine.<a href="../S/2362.html#L663" title="Defined at 663 in src/java/awt/font/TextLine.java.">getCharAdvance</a>(logIndex);
<a id="L1158" name="L1158"></a>1158                 <strong class="reserved">if</strong> (angle1 != 0) <em class="brace">{</em>
<a id="L1159" name="L1159"></a>1159                     pos1 += angle1 * textLine.<a href="../S/2362.html#L636" title="Defined at 636 in src/java/awt/font/TextLine.java.">getCharShift</a>(logIndex);
<a id="L1160" name="L1160"></a>1160                     top1X = pos1 + angle1*textLine.<a href="../S/2362.html#L626" title="Defined at 626 in src/java/awt/font/TextLine.java.">getCharAscent</a>(logIndex);
<a id="L1161" name="L1161"></a>1161                     bottom1X = pos1 - angle1*textLine.<a href="../S/2362.html#L631" title="Defined at 631 in src/java/awt/font/TextLine.java.">getCharDescent</a>(logIndex);
<a id="L1162" name="L1162"></a>1162                 <em class="brace">}</em>
<a id="L1163" name="L1163"></a>1163                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1164" name="L1164"></a>1164                     top1X = bottom1X = pos1;
<a id="L1165" name="L1165"></a>1165                 <em class="brace">}</em>
<a id="L1166" name="L1166"></a>1166             <em class="brace">}</em>
<a id="L1167" name="L1167"></a>1167             <em class="brace">{</em>
<a id="L1168" name="L1168"></a>1168                 <strong class="reserved">int</strong> logIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(caret);
<a id="L1169" name="L1169"></a>1169                 <strong class="reserved">float</strong> angle2 = textLine.<a href="../S/2362.html#L595" title="Defined at 595 in src/java/awt/font/TextLine.java.">getCharAngle</a>(logIndex);
<a id="L1170" name="L1170"></a>1170                 <strong class="reserved">float</strong> pos2 = textLine.<a href="../D/17591.html" title="Multiple defined in 2 places.">getCharLinePosition</a>(logIndex);
<a id="L1171" name="L1171"></a>1171                 <strong class="reserved">if</strong> (angle2 != 0) <em class="brace">{</em>
<a id="L1172" name="L1172"></a>1172                     pos2 += angle2*textLine.<a href="../S/2362.html#L636" title="Defined at 636 in src/java/awt/font/TextLine.java.">getCharShift</a>(logIndex);
<a id="L1173" name="L1173"></a>1173                     top2X = pos2 + angle2*textLine.<a href="../S/2362.html#L626" title="Defined at 626 in src/java/awt/font/TextLine.java.">getCharAscent</a>(logIndex);
<a id="L1174" name="L1174"></a>1174                     bottom2X = pos2 - angle2*textLine.<a href="../S/2362.html#L631" title="Defined at 631 in src/java/awt/font/TextLine.java.">getCharDescent</a>(logIndex);
<a id="L1175" name="L1175"></a>1175                 <em class="brace">}</em>
<a id="L1176" name="L1176"></a>1176                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1177" name="L1177"></a>1177                     top2X = bottom2X = pos2;
<a id="L1178" name="L1178"></a>1178                 <em class="brace">}</em>
<a id="L1179" name="L1179"></a>1179             <em class="brace">}</em>
<a id="L1180" name="L1180"></a>1180         <em class="brace">}</em>
<a id="L1181" name="L1181"></a>1181 
<a id="L1182" name="L1182"></a>1182         <strong class="reserved">float</strong> topX = (top1X + top2X) / 2;
<a id="L1183" name="L1183"></a>1183         <strong class="reserved">float</strong> bottomX = (bottom1X + bottom2X) / 2;
<a id="L1184" name="L1184"></a>1184 
<a id="L1185" name="L1185"></a>1185         <strong class="reserved">if</strong> (<a href="../D/24493.html" title="Multiple defined in 8 places.">info</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1186" name="L1186"></a>1186             <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a> = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[2];
<a id="L1187" name="L1187"></a>1187         <em class="brace">}</em>
<a id="L1188" name="L1188"></a>1188 
<a id="L1189" name="L1189"></a>1189         <strong class="reserved">if</strong> (isVerticalLine) <em class="brace">{</em>
<a id="L1190" name="L1190"></a>1190             <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[1] = (<strong class="reserved">float</strong>) ((topX - bottomX) / <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>());
<a id="L1191" name="L1191"></a>1191             <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[0] = (<strong class="reserved">float</strong>) (topX + (<a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[1]*<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>()));
<a id="L1192" name="L1192"></a>1192         <em class="brace">}</em>
<a id="L1193" name="L1193"></a>1193         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1194" name="L1194"></a>1194             <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[1] = (<strong class="reserved">float</strong>) ((topX - bottomX) / <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>());
<a id="L1195" name="L1195"></a>1195             <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[0] = (<strong class="reserved">float</strong>) (bottomX + (<a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[1]*<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../S/2330.html#L137" title="Defined at 137 in src/java/awt/geom/RectangularShape.java.">getMaxY</a>()));
<a id="L1196" name="L1196"></a>1196         <em class="brace">}</em>
<a id="L1197" name="L1197"></a>1197 
<a id="L1198" name="L1198"></a>1198         <strong class="reserved">return</strong> <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>;
<a id="L1199" name="L1199"></a>1199     <em class="brace">}</em>
<a id="L1200" name="L1200"></a>1200 
<div class="comment">
      Returns information about the caret corresponding to <code>hit</code>.
      The first element of the array is the intersection of the caret with
      the baseline, as a distance along the baseline. The second element
      of the array is the inverse slope (run/rise) of the caret, measured
      with respect to the baseline at that point.
      <p>
      This method is meant for informational use.  To display carets, it
      is better to use <code>getCaretShapes</code>.
      @param hit a hit on a character in this <code>TextLayout</code>
      @param bounds the bounds to which the caret info is constructed.
          The bounds is in baseline-relative coordinates.
      @return a two-element array containing the position and slope of
      the caret.  The returned caret info is in baseline-relative coordinates.
      @see #getCaretShapes(int, Rectangle2D, TextLayout.CaretPolicy)
      @see Font#getItalicAngle</p></div>
<a id="L1218" name="L1218"></a>1218     <strong class="reserved">public</strong> <strong class="reserved">float</strong>[] <a href="../R/15448.html" title="Multiple referred from 7 places.">getCaretInfo</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L1219" name="L1219"></a>1219         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L1220" name="L1220"></a>1220         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1221" name="L1221"></a>1221 
<a id="L1222" name="L1222"></a>1222         <strong class="reserved">return</strong> <a href="../S/2375.html#L1232" title="Defined at 1232 in src/java/awt/font/TextLayout.java.">getCaretInfoTestInternal</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>);
<a id="L1223" name="L1223"></a>1223     <em class="brace">}</em>
<a id="L1224" name="L1224"></a>1224 
<a id="L1225" name="L1225"></a>1225     <em class="comment">// this version provides extra info in the float array</em>
<a id="L1226" name="L1226"></a>1226     <em class="comment">// the first two values are as above</em>
<a id="L1227" name="L1227"></a>1227     <em class="comment">// the next four values are the endpoints of the caret, as computed</em>
<a id="L1228" name="L1228"></a>1228     <em class="comment">// using the hit character's offset (baseline + ssoffset) and</em>
<a id="L1229" name="L1229"></a>1229     <em class="comment">// natural ascent and descent.</em>
<a id="L1230" name="L1230"></a>1230     <em class="comment">// these  values are trimmed to the bounds where required to fit,</em>
<a id="L1231" name="L1231"></a>1231     <em class="comment">// but otherwise independent of it.</em>
<a id="L1232" name="L1232"></a>1232     <strong class="reserved">private</strong> <strong class="reserved">float</strong>[] <a href="../S/2375.html#L1222" title="Referred from 1222 in src/java/awt/font/TextLayout.java.">getCaretInfoTestInternal</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L1233" name="L1233"></a>1233         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L1234" name="L1234"></a>1234         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1235" name="L1235"></a>1235 
<a id="L1236" name="L1236"></a>1236         <strong class="reserved">float</strong>[] <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a> = <strong class="reserved">new</strong> <strong class="reserved">float</strong>[6];
<a id="L1237" name="L1237"></a>1237 
<a id="L1238" name="L1238"></a>1238         <em class="comment">// get old data first</em>
<a id="L1239" name="L1239"></a>1239         <a href="../D/17497.html" title="Multiple defined in 3 places.">getCaretInfo</a>(<a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>), <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>, <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>);
<a id="L1240" name="L1240"></a>1240 
<a id="L1241" name="L1241"></a>1241         <em class="comment">// then add our new data</em>
<a id="L1242" name="L1242"></a>1242         <strong class="reserved">double</strong> iangle, ixbase, p1x, p1y, p2x, p2y;
<a id="L1243" name="L1243"></a>1243 
<a id="L1244" name="L1244"></a>1244         <strong class="reserved">int</strong> charix = <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L107" title="Defined at 107 in src/java/awt/font/TextHitInfo.java.">getCharIndex</a>();
<a id="L1245" name="L1245"></a>1245         <strong class="reserved">boolean</strong> lead = <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L117" title="Defined at 117 in src/java/awt/font/TextHitInfo.java.">isLeadingEdge</a>();
<a id="L1246" name="L1246"></a>1246         <strong class="reserved">boolean</strong> ltr = textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>();
<a id="L1247" name="L1247"></a>1247         <strong class="reserved">boolean</strong> horiz = !<a href="../S/2375.html#L1042" title="Defined at 1042 in src/java/awt/font/TextLayout.java.">isVertical</a>();
<a id="L1248" name="L1248"></a>1248 
<a id="L1249" name="L1249"></a>1249         <strong class="reserved">if</strong> (charix == -1 || charix == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1250" name="L1250"></a>1250             <em class="comment">// !!! note: want non-shifted, baseline ascent and descent here!</em>
<a id="L1251" name="L1251"></a>1251             <em class="comment">// TextLine should return appropriate line metrics object for these values</em>
<a id="L1252" name="L1252"></a>1252             <a href="../S/2362.html#L69" title="Defined at 69 in src/java/awt/font/TextLine.java.">TextLineMetrics</a> m = textLine.<a href="../S/2362.html#L547" title="Defined at 547 in src/java/awt/font/TextLine.java.">getMetrics</a>();
<a id="L1253" name="L1253"></a>1253             <strong class="reserved">boolean</strong> low = ltr == (charix == -1);
<a id="L1254" name="L1254"></a>1254             iangle = 0;
<a id="L1255" name="L1255"></a>1255             <strong class="reserved">if</strong> (horiz) <em class="brace">{</em>
<a id="L1256" name="L1256"></a>1256                 p1x = p2x = low ? 0 : m.<a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>;
<a id="L1257" name="L1257"></a>1257                 p1y = -m.ascent;
<a id="L1258" name="L1258"></a>1258                 p2y = m.descent;
<a id="L1259" name="L1259"></a>1259             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1260" name="L1260"></a>1260                 p1y = p2y = low ? 0 : m.<a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>;
<a id="L1261" name="L1261"></a>1261                 p1x = m.descent;
<a id="L1262" name="L1262"></a>1262                 p2x = m.ascent;
<a id="L1263" name="L1263"></a>1263             <em class="brace">}</em>
<a id="L1264" name="L1264"></a>1264         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1265" name="L1265"></a>1265             CoreMetrics thiscm = textLine.<a href="../S/2362.html#L600" title="Defined at 600 in src/java/awt/font/TextLine.java.">getCoreMetricsAt</a>(charix);
<a id="L1266" name="L1266"></a>1266             iangle = thiscm.italicAngle;
<a id="L1267" name="L1267"></a>1267             ixbase = textLine.<a href="../D/17591.html" title="Multiple defined in 2 places.">getCharLinePosition</a>(charix, lead);
<a id="L1268" name="L1268"></a>1268             <strong class="reserved">if</strong> (thiscm.baselineIndex &lt; 0) <em class="brace">{</em>
<a id="L1269" name="L1269"></a>1269                 <em class="comment">// this is a graphic, no italics, use entire line height for caret</em>
<a id="L1270" name="L1270"></a>1270                 <a href="../S/2362.html#L69" title="Defined at 69 in src/java/awt/font/TextLine.java.">TextLineMetrics</a> m = textLine.<a href="../S/2362.html#L547" title="Defined at 547 in src/java/awt/font/TextLine.java.">getMetrics</a>();
<a id="L1271" name="L1271"></a>1271                 <strong class="reserved">if</strong> (horiz) <em class="brace">{</em>
<a id="L1272" name="L1272"></a>1272                     p1x = p2x = ixbase;
<a id="L1273" name="L1273"></a>1273                     <strong class="reserved">if</strong> (thiscm.baselineIndex == <a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a>.TOP_ALIGNMENT) <em class="brace">{</em>
<a id="L1274" name="L1274"></a>1274                         p1y = -m.ascent;
<a id="L1275" name="L1275"></a>1275                         p2y = p1y + thiscm.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a>;
<a id="L1276" name="L1276"></a>1276                     <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1277" name="L1277"></a>1277                         p2y = m.descent;
<a id="L1278" name="L1278"></a>1278                         p1y = p2y - thiscm.<a href="../S/3196.html#L677" title="Defined at 677 in src/javax/swing/Spring.java.">height</a>;
<a id="L1279" name="L1279"></a>1279                     <em class="brace">}</em>
<a id="L1280" name="L1280"></a>1280                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1281" name="L1281"></a>1281                     p1y = p2y = ixbase;
<a id="L1282" name="L1282"></a>1282                     p1x = m.descent;
<a id="L1283" name="L1283"></a>1283                     p2x = m.ascent;
<a id="L1284" name="L1284"></a>1284                     <em class="comment">// !!! top/bottom adjustment not implemented for vertical</em>
<a id="L1285" name="L1285"></a>1285                 <em class="brace">}</em>
<a id="L1286" name="L1286"></a>1286             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1287" name="L1287"></a>1287                 <strong class="reserved">float</strong> bo = baselineOffsets[thiscm.baselineIndex];
<a id="L1288" name="L1288"></a>1288                 <strong class="reserved">if</strong> (horiz) <em class="brace">{</em>
<a id="L1289" name="L1289"></a>1289                     ixbase += iangle * thiscm.ssOffset;
<a id="L1290" name="L1290"></a>1290                     p1x = ixbase + iangle * thiscm.ascent;
<a id="L1291" name="L1291"></a>1291                     p2x = ixbase - iangle * thiscm.descent;
<a id="L1292" name="L1292"></a>1292                     p1y = bo - thiscm.ascent;
<a id="L1293" name="L1293"></a>1293                     p2y = bo + thiscm.descent;
<a id="L1294" name="L1294"></a>1294                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1295" name="L1295"></a>1295                     ixbase -= iangle * thiscm.ssOffset;
<a id="L1296" name="L1296"></a>1296                     p1y = ixbase + iangle * thiscm.ascent;
<a id="L1297" name="L1297"></a>1297                     p2y = ixbase - iangle * thiscm.descent;
<a id="L1298" name="L1298"></a>1298                     p1x = bo + thiscm.ascent;
<a id="L1299" name="L1299"></a>1299                     p2x = bo + thiscm.descent;
<a id="L1300" name="L1300"></a>1300                 <em class="brace">}</em>
<a id="L1301" name="L1301"></a>1301             <em class="brace">}</em>
<a id="L1302" name="L1302"></a>1302         <em class="brace">}</em>
<a id="L1303" name="L1303"></a>1303 
<a id="L1304" name="L1304"></a>1304         <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[2] = (<strong class="reserved">float</strong>)p1x;
<a id="L1305" name="L1305"></a>1305         <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[3] = (<strong class="reserved">float</strong>)p1y;
<a id="L1306" name="L1306"></a>1306         <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[4] = (<strong class="reserved">float</strong>)p2x;
<a id="L1307" name="L1307"></a>1307         <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[5] = (<strong class="reserved">float</strong>)p2y;
<a id="L1308" name="L1308"></a>1308 
<a id="L1309" name="L1309"></a>1309         <strong class="reserved">return</strong> <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>;
<a id="L1310" name="L1310"></a>1310     <em class="brace">}</em>
<a id="L1311" name="L1311"></a>1311 
<div class="comment">
      Returns information about the caret corresponding to <code>hit</code>.
      This method is a convenience overload of <code>getCaretInfo</code> and
      uses the natural bounds of this <code>TextLayout</code>.
      @param hit a hit on a character in this <code>TextLayout</code>
      @return the information about a caret corresponding to a hit.  The
          returned caret info is in baseline-relative coordinates.</div>
<a id="L1320" name="L1320"></a>1320     <strong class="reserved">public</strong> <strong class="reserved">float</strong>[] <a href="../R/15448.html" title="Multiple referred from 7 places.">getCaretInfo</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>) <em class="brace">{</em>
<a id="L1321" name="L1321"></a>1321 
<a id="L1322" name="L1322"></a>1322         <strong class="reserved">return</strong> <a href="../D/17497.html" title="Multiple defined in 3 places.">getCaretInfo</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../S/2375.html#L735" title="Defined at 735 in src/java/awt/font/TextLayout.java.">getNaturalBounds</a>());
<a id="L1323" name="L1323"></a>1323     <em class="brace">}</em>
<a id="L1324" name="L1324"></a>1324 
<div class="comment">
      Returns a caret index corresponding to <code>hit</code>.
      Carets are numbered from left to right (top to bottom) starting from
      zero. This always places carets next to the character hit, on the
      indicated side of the character.
      @param hit a hit on a character in this <code>TextLayout</code>
      @return a caret index corresponding to the specified hit.</div>
<a id="L1333" name="L1333"></a>1333     <strong class="reserved">private</strong> <strong class="reserved">int</strong> <a href="../R/20342.html" title="Multiple referred from 12 places.">hitToCaret</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>) <em class="brace">{</em>
<a id="L1334" name="L1334"></a>1334 
<a id="L1335" name="L1335"></a>1335         <strong class="reserved">int</strong> hitIndex = <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L107" title="Defined at 107 in src/java/awt/font/TextHitInfo.java.">getCharIndex</a>();
<a id="L1336" name="L1336"></a>1336 
<a id="L1337" name="L1337"></a>1337         <strong class="reserved">if</strong> (hitIndex &lt; 0) <em class="brace">{</em>
<a id="L1338" name="L1338"></a>1338             <strong class="reserved">return</strong> textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>() ? 0 : <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>;
<a id="L1339" name="L1339"></a>1339         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (hitIndex &gt;= <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1340" name="L1340"></a>1340             <strong class="reserved">return</strong> textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>() ? <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a> : 0;
<a id="L1341" name="L1341"></a>1341         <em class="brace">}</em>
<a id="L1342" name="L1342"></a>1342 
<a id="L1343" name="L1343"></a>1343         <strong class="reserved">int</strong> visIndex = textLine.<a href="../S/2362.html#L564" title="Defined at 564 in src/java/awt/font/TextLine.java.">logicalToVisual</a>(hitIndex);
<a id="L1344" name="L1344"></a>1344 
<a id="L1345" name="L1345"></a>1345         <strong class="reserved">if</strong> (<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L117" title="Defined at 117 in src/java/awt/font/TextHitInfo.java.">isLeadingEdge</a>() != textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(hitIndex)) <em class="brace">{</em>
<a id="L1346" name="L1346"></a>1346             ++visIndex;
<a id="L1347" name="L1347"></a>1347         <em class="brace">}</em>
<a id="L1348" name="L1348"></a>1348 
<a id="L1349" name="L1349"></a>1349         <strong class="reserved">return</strong> visIndex;
<a id="L1350" name="L1350"></a>1350     <em class="brace">}</em>
<a id="L1351" name="L1351"></a>1351 
<div class="comment">
      Given a caret index, return a hit whose caret is at the index.
      The hit is NOT guaranteed to be strong!!!
      @param caret a caret index.
      @return a hit on this layout whose strong caret is at the requested
      index.</div>
<a id="L1360" name="L1360"></a>1360     <strong class="reserved">private</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/10975.html" title="Multiple referred from 2 places.">caretToHit</a>(<strong class="reserved">int</strong> caret) <em class="brace">{</em>
<a id="L1361" name="L1361"></a>1361 
<a id="L1362" name="L1362"></a>1362         <strong class="reserved">if</strong> (caret == 0 || caret == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1363" name="L1363"></a>1363 
<a id="L1364" name="L1364"></a>1364             <strong class="reserved">if</strong> ((caret == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) == textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>()) <em class="brace">{</em>
<a id="L1365" name="L1365"></a>1365                 <strong class="reserved">return</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>);
<a id="L1366" name="L1366"></a>1366             <em class="brace">}</em>
<a id="L1367" name="L1367"></a>1367             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1368" name="L1368"></a>1368                 <strong class="reserved">return</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/35566.html" title="Multiple defined in 2 places.">trailing</a>(-1);
<a id="L1369" name="L1369"></a>1369             <em class="brace">}</em>
<a id="L1370" name="L1370"></a>1370         <em class="brace">}</em>
<a id="L1371" name="L1371"></a>1371         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1372" name="L1372"></a>1372 
<a id="L1373" name="L1373"></a>1373             <strong class="reserved">int</strong> charIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(caret);
<a id="L1374" name="L1374"></a>1374             <strong class="reserved">boolean</strong> <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a> = textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(charIndex);
<a id="L1375" name="L1375"></a>1375 
<a id="L1376" name="L1376"></a>1376             <strong class="reserved">return</strong> <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>? <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(charIndex)
<a id="L1377" name="L1377"></a>1377                             : <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/35566.html" title="Multiple defined in 2 places.">trailing</a>(charIndex);
<a id="L1378" name="L1378"></a>1378         <em class="brace">}</em>
<a id="L1379" name="L1379"></a>1379     <em class="brace">}</em>
<a id="L1380" name="L1380"></a>1380 
<a id="L1381" name="L1381"></a>1381     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/10973.html" title="Multiple referred from 2 places.">caretIsValid</a>(<strong class="reserved">int</strong> caret) <em class="brace">{</em>
<a id="L1382" name="L1382"></a>1382 
<a id="L1383" name="L1383"></a>1383         <strong class="reserved">if</strong> (caret == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a> || caret == 0) <em class="brace">{</em>
<a id="L1384" name="L1384"></a>1384             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1385" name="L1385"></a>1385         <em class="brace">}</em>
<a id="L1386" name="L1386"></a>1386 
<a id="L1387" name="L1387"></a>1387         <strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(caret);
<a id="L1388" name="L1388"></a>1388 
<a id="L1389" name="L1389"></a>1389         <strong class="reserved">if</strong> (!textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>)) <em class="brace">{</em>
<a id="L1390" name="L1390"></a>1390             <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(caret-1);
<a id="L1391" name="L1391"></a>1391             <strong class="reserved">if</strong> (textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>)) <em class="brace">{</em>
<a id="L1392" name="L1392"></a>1392                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1393" name="L1393"></a>1393             <em class="brace">}</em>
<a id="L1394" name="L1394"></a>1394         <em class="brace">}</em>
<a id="L1395" name="L1395"></a>1395 
<a id="L1396" name="L1396"></a>1396         <em class="comment">// At this point, the leading edge of the character</em>
<a id="L1397" name="L1397"></a>1397         <em class="comment">// at offset is at the given caret.</em>
<a id="L1398" name="L1398"></a>1398 
<a id="L1399" name="L1399"></a>1399         <strong class="reserved">return</strong> textLine.<a href="../S/2362.html#L688" title="Defined at 688 in src/java/awt/font/TextLine.java.">caretAtOffsetIsValid</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>);
<a id="L1400" name="L1400"></a>1400     <em class="brace">}</em>
<a id="L1401" name="L1401"></a>1401 
<div class="comment">
      Returns the hit for the next caret to the right (bottom); if there
      is no such hit, returns <code>null</code>.
      If the hit character index is out of bounds, an
      <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> is thrown.
      @param hit a hit on a character in this layout
      @return a hit whose caret appears at the next position to the
      right (bottom) of the caret of the provided hit or <code>null</code>.</div>
<a id="L1411" name="L1411"></a>1411     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/17944.html" title="Multiple referred from 3 places.">getNextRightHit</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>) <em class="brace">{</em>
<a id="L1412" name="L1412"></a>1412         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L1413" name="L1413"></a>1413         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1414" name="L1414"></a>1414 
<a id="L1415" name="L1415"></a>1415         <strong class="reserved">int</strong> caret = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1416" name="L1416"></a>1416 
<a id="L1417" name="L1417"></a>1417         <strong class="reserved">if</strong> (caret == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1418" name="L1418"></a>1418             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1419" name="L1419"></a>1419         <em class="brace">}</em>
<a id="L1420" name="L1420"></a>1420 
<a id="L1421" name="L1421"></a>1421         <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L1422" name="L1422"></a>1422             ++caret;
<a id="L1423" name="L1423"></a>1423         <em class="brace">}</em> <strong class="reserved">while</strong> (!<a href="../S/2375.html#L1381" title="Defined at 1381 in src/java/awt/font/TextLayout.java.">caretIsValid</a>(caret));
<a id="L1424" name="L1424"></a>1424 
<a id="L1425" name="L1425"></a>1425         <strong class="reserved">return</strong> <a href="../S/2375.html#L1360" title="Defined at 1360 in src/java/awt/font/TextLayout.java.">caretToHit</a>(caret);
<a id="L1426" name="L1426"></a>1426     <em class="brace">}</em>
<a id="L1427" name="L1427"></a>1427 
<div class="comment">
      Returns the hit for the next caret to the right (bottom); if no
      such hit, returns <code>null</code>.  The hit is to the right of
      the strong caret at the specified offset, as determined by the
      specified policy.
      The returned hit is the stronger of the two possible
      hits, as determined by the specified policy.
      @param offset an insertion offset in this <code>TextLayout</code>.
      Cannot be less than 0 or greater than this <code>TextLayout</code>
      object's character count.
      @param policy the policy used to select the strong caret
      @return a hit whose caret appears at the next position to the
      right (bottom) of the caret of the provided hit, or <code>null</code>.</div>
<a id="L1442" name="L1442"></a>1442     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/17944.html" title="Multiple referred from 3 places.">getNextRightHit</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../S/2375.html#L317" title="Defined at 317 in src/java/awt/font/TextLayout.java.">CaretPolicy</a> policy) <em class="brace">{</em>
<a id="L1443" name="L1443"></a>1443 
<a id="L1444" name="L1444"></a>1444         <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &lt; 0 || <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &gt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1445" name="L1445"></a>1445             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Offset out of bounds in TextLayout.getNextRightHit()");
<a id="L1446" name="L1446"></a>1446         <em class="brace">}</em>
<a id="L1447" name="L1447"></a>1447 
<a id="L1448" name="L1448"></a>1448         <strong class="reserved">if</strong> (policy == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1449" name="L1449"></a>1449             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null CaretPolicy passed to TextLayout.getNextRightHit()");
<a id="L1450" name="L1450"></a>1450         <em class="brace">}</em>
<a id="L1451" name="L1451"></a>1451 
<a id="L1452" name="L1452"></a>1452         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> hit1 = <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../S/2364.html#L216" title="Defined at 216 in src/java/awt/font/TextHitInfo.java.">afterOffset</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>);
<a id="L1453" name="L1453"></a>1453         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> hit2 = hit1.<a href="../S/2364.html#L226" title="Defined at 226 in src/java/awt/font/TextHitInfo.java.">getOtherHit</a>();
<a id="L1454" name="L1454"></a>1454 
<a id="L1455" name="L1455"></a>1455         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> nextHit = <a href="../D/20933.html" title="Multiple defined in 3 places.">getNextRightHit</a>(policy.<a href="../S/2375.html#L336" title="Defined at 336 in src/java/awt/font/TextLayout.java.">getStrongCaret</a>(hit1, hit2, <strong class="reserved">this</strong>));
<a id="L1456" name="L1456"></a>1456 
<a id="L1457" name="L1457"></a>1457         <strong class="reserved">if</strong> (nextHit != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1458" name="L1458"></a>1458             <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> otherHit = <a href="../S/2375.html#L1572" title="Defined at 1572 in src/java/awt/font/TextLayout.java.">getVisualOtherHit</a>(nextHit);
<a id="L1459" name="L1459"></a>1459             <strong class="reserved">return</strong> policy.<a href="../S/2375.html#L336" title="Defined at 336 in src/java/awt/font/TextLayout.java.">getStrongCaret</a>(otherHit, nextHit, <strong class="reserved">this</strong>);
<a id="L1460" name="L1460"></a>1460         <em class="brace">}</em>
<a id="L1461" name="L1461"></a>1461         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1462" name="L1462"></a>1462             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1463" name="L1463"></a>1463         <em class="brace">}</em>
<a id="L1464" name="L1464"></a>1464     <em class="brace">}</em>
<a id="L1465" name="L1465"></a>1465 
<div class="comment">
      Returns the hit for the next caret to the right (bottom); if no
      such hit, returns <code>null</code>.  The hit is to the right of
      the strong caret at the specified offset, as determined by the
      default policy.
      The returned hit is the stronger of the two possible
      hits, as determined by the default policy.
      @param offset an insertion offset in this <code>TextLayout</code>.
      Cannot be less than 0 or greater than the <code>TextLayout</code>
      object's character count.
      @return a hit whose caret appears at the next position to the
      right (bottom) of the caret of the provided hit, or <code>null</code>.</div>
<a id="L1479" name="L1479"></a>1479     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/17944.html" title="Multiple referred from 3 places.">getNextRightHit</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L1480" name="L1480"></a>1480 
<a id="L1481" name="L1481"></a>1481         <strong class="reserved">return</strong> <a href="../D/20933.html" title="Multiple defined in 3 places.">getNextRightHit</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, DEFAULT_CARET_POLICY);
<a id="L1482" name="L1482"></a>1482     <em class="brace">}</em>
<a id="L1483" name="L1483"></a>1483 
<div class="comment">
      Returns the hit for the next caret to the left (top); if no such
      hit, returns <code>null</code>.
      If the hit character index is out of bounds, an
      <code>IllegalArgumentException</code> is thrown.
      @param hit a hit on a character in this <code>TextLayout</code>.
      @return a hit whose caret appears at the next position to the
      left (top) of the caret of the provided hit, or <code>null</code>.</div>
<a id="L1493" name="L1493"></a>1493     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/17928.html" title="Multiple referred from 3 places.">getNextLeftHit</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>) <em class="brace">{</em>
<a id="L1494" name="L1494"></a>1494         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L1495" name="L1495"></a>1495         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1496" name="L1496"></a>1496 
<a id="L1497" name="L1497"></a>1497         <strong class="reserved">int</strong> caret = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1498" name="L1498"></a>1498 
<a id="L1499" name="L1499"></a>1499         <strong class="reserved">if</strong> (caret == 0) <em class="brace">{</em>
<a id="L1500" name="L1500"></a>1500             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1501" name="L1501"></a>1501         <em class="brace">}</em>
<a id="L1502" name="L1502"></a>1502 
<a id="L1503" name="L1503"></a>1503         <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L1504" name="L1504"></a>1504             --caret;
<a id="L1505" name="L1505"></a>1505         <em class="brace">}</em> <strong class="reserved">while</strong>(!<a href="../S/2375.html#L1381" title="Defined at 1381 in src/java/awt/font/TextLayout.java.">caretIsValid</a>(caret));
<a id="L1506" name="L1506"></a>1506 
<a id="L1507" name="L1507"></a>1507         <strong class="reserved">return</strong> <a href="../S/2375.html#L1360" title="Defined at 1360 in src/java/awt/font/TextLayout.java.">caretToHit</a>(caret);
<a id="L1508" name="L1508"></a>1508     <em class="brace">}</em>
<a id="L1509" name="L1509"></a>1509 
<div class="comment">
      Returns the hit for the next caret to the left (top); if no
      such hit, returns <code>null</code>.  The hit is to the left of
      the strong caret at the specified offset, as determined by the
      specified policy.
      The returned hit is the stronger of the two possible
      hits, as determined by the specified policy.
      @param offset an insertion offset in this <code>TextLayout</code>.
      Cannot be less than 0 or greater than this <code>TextLayout</code>
      object's character count.
      @param policy the policy used to select the strong caret
      @return a hit whose caret appears at the next position to the
      left (top) of the caret of the provided hit, or <code>null</code>.</div>
<a id="L1524" name="L1524"></a>1524     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/17928.html" title="Multiple referred from 3 places.">getNextLeftHit</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../S/2375.html#L317" title="Defined at 317 in src/java/awt/font/TextLayout.java.">CaretPolicy</a> policy) <em class="brace">{</em>
<a id="L1525" name="L1525"></a>1525 
<a id="L1526" name="L1526"></a>1526         <strong class="reserved">if</strong> (policy == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1527" name="L1527"></a>1527             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null CaretPolicy passed to TextLayout.getNextLeftHit()");
<a id="L1528" name="L1528"></a>1528         <em class="brace">}</em>
<a id="L1529" name="L1529"></a>1529 
<a id="L1530" name="L1530"></a>1530         <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &lt; 0 || <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &gt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1531" name="L1531"></a>1531             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Offset out of bounds in TextLayout.getNextLeftHit()");
<a id="L1532" name="L1532"></a>1532         <em class="brace">}</em>
<a id="L1533" name="L1533"></a>1533 
<a id="L1534" name="L1534"></a>1534         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> hit1 = <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../S/2364.html#L216" title="Defined at 216 in src/java/awt/font/TextHitInfo.java.">afterOffset</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>);
<a id="L1535" name="L1535"></a>1535         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> hit2 = hit1.<a href="../S/2364.html#L226" title="Defined at 226 in src/java/awt/font/TextHitInfo.java.">getOtherHit</a>();
<a id="L1536" name="L1536"></a>1536 
<a id="L1537" name="L1537"></a>1537         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> nextHit = <a href="../D/20916.html" title="Multiple defined in 3 places.">getNextLeftHit</a>(policy.<a href="../S/2375.html#L336" title="Defined at 336 in src/java/awt/font/TextLayout.java.">getStrongCaret</a>(hit1, hit2, <strong class="reserved">this</strong>));
<a id="L1538" name="L1538"></a>1538 
<a id="L1539" name="L1539"></a>1539         <strong class="reserved">if</strong> (nextHit != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1540" name="L1540"></a>1540             <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> otherHit = <a href="../S/2375.html#L1572" title="Defined at 1572 in src/java/awt/font/TextLayout.java.">getVisualOtherHit</a>(nextHit);
<a id="L1541" name="L1541"></a>1541             <strong class="reserved">return</strong> policy.<a href="../S/2375.html#L336" title="Defined at 336 in src/java/awt/font/TextLayout.java.">getStrongCaret</a>(otherHit, nextHit, <strong class="reserved">this</strong>);
<a id="L1542" name="L1542"></a>1542         <em class="brace">}</em>
<a id="L1543" name="L1543"></a>1543         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1544" name="L1544"></a>1544             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1545" name="L1545"></a>1545         <em class="brace">}</em>
<a id="L1546" name="L1546"></a>1546     <em class="brace">}</em>
<a id="L1547" name="L1547"></a>1547 
<div class="comment">
      Returns the hit for the next caret to the left (top); if no
      such hit, returns <code>null</code>.  The hit is to the left of
      the strong caret at the specified offset, as determined by the
      default policy.
      The returned hit is the stronger of the two possible
      hits, as determined by the default policy.
      @param offset an insertion offset in this <code>TextLayout</code>.
      Cannot be less than 0 or greater than this <code>TextLayout</code>
      object's character count.
      @return a hit whose caret appears at the next position to the
      left (top) of the caret of the provided hit, or <code>null</code>.</div>
<a id="L1561" name="L1561"></a>1561     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/17928.html" title="Multiple referred from 3 places.">getNextLeftHit</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L1562" name="L1562"></a>1562 
<a id="L1563" name="L1563"></a>1563         <strong class="reserved">return</strong> <a href="../D/20916.html" title="Multiple defined in 3 places.">getNextLeftHit</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, DEFAULT_CARET_POLICY);
<a id="L1564" name="L1564"></a>1564     <em class="brace">}</em>
<a id="L1565" name="L1565"></a>1565 
<div class="comment">
      Returns the hit on the opposite side of the specified hit's caret.
      @param hit the specified hit
      @return a hit that is on the opposite side of the specified hit's
         caret.</div>
<a id="L1572" name="L1572"></a>1572     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/19831.html" title="Multiple referred from 4 places.">getVisualOtherHit</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>) <em class="brace">{</em>
<a id="L1573" name="L1573"></a>1573 
<a id="L1574" name="L1574"></a>1574         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L1575" name="L1575"></a>1575         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1576" name="L1576"></a>1576 
<a id="L1577" name="L1577"></a>1577         <strong class="reserved">int</strong> hitCharIndex = <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L107" title="Defined at 107 in src/java/awt/font/TextHitInfo.java.">getCharIndex</a>();
<a id="L1578" name="L1578"></a>1578 
<a id="L1579" name="L1579"></a>1579         <strong class="reserved">int</strong> charIndex;
<a id="L1580" name="L1580"></a>1580         <strong class="reserved">boolean</strong> <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>;
<a id="L1581" name="L1581"></a>1581 
<a id="L1582" name="L1582"></a>1582         <strong class="reserved">if</strong> (hitCharIndex == -1 || hitCharIndex == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1583" name="L1583"></a>1583 
<a id="L1584" name="L1584"></a>1584             <strong class="reserved">int</strong> visIndex;
<a id="L1585" name="L1585"></a>1585             <strong class="reserved">if</strong> (textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>() == (hitCharIndex == -1)) <em class="brace">{</em>
<a id="L1586" name="L1586"></a>1586                 visIndex = 0;
<a id="L1587" name="L1587"></a>1587             <em class="brace">}</em>
<a id="L1588" name="L1588"></a>1588             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1589" name="L1589"></a>1589                 visIndex = <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>-1;
<a id="L1590" name="L1590"></a>1590             <em class="brace">}</em>
<a id="L1591" name="L1591"></a>1591 
<a id="L1592" name="L1592"></a>1592             charIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(visIndex);
<a id="L1593" name="L1593"></a>1593 
<a id="L1594" name="L1594"></a>1594             <strong class="reserved">if</strong> (textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>() == (hitCharIndex == -1)) <em class="brace">{</em>
<a id="L1595" name="L1595"></a>1595                 <em class="comment">// at left end</em>
<a id="L1596" name="L1596"></a>1596                 <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a> = textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(charIndex);
<a id="L1597" name="L1597"></a>1597             <em class="brace">}</em>
<a id="L1598" name="L1598"></a>1598             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1599" name="L1599"></a>1599                 <em class="comment">// at right end</em>
<a id="L1600" name="L1600"></a>1600                 <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a> = !textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(charIndex);
<a id="L1601" name="L1601"></a>1601             <em class="brace">}</em>
<a id="L1602" name="L1602"></a>1602         <em class="brace">}</em>
<a id="L1603" name="L1603"></a>1603         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1604" name="L1604"></a>1604 
<a id="L1605" name="L1605"></a>1605             <strong class="reserved">int</strong> visIndex = textLine.<a href="../S/2362.html#L564" title="Defined at 564 in src/java/awt/font/TextLine.java.">logicalToVisual</a>(hitCharIndex);
<a id="L1606" name="L1606"></a>1606 
<a id="L1607" name="L1607"></a>1607             <strong class="reserved">boolean</strong> movedToRight;
<a id="L1608" name="L1608"></a>1608             <strong class="reserved">if</strong> (textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(hitCharIndex) == <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L117" title="Defined at 117 in src/java/awt/font/TextHitInfo.java.">isLeadingEdge</a>()) <em class="brace">{</em>
<a id="L1609" name="L1609"></a>1609                 --visIndex;
<a id="L1610" name="L1610"></a>1610                 movedToRight = <strong class="reserved">false</strong>;
<a id="L1611" name="L1611"></a>1611             <em class="brace">}</em>
<a id="L1612" name="L1612"></a>1612             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1613" name="L1613"></a>1613                 ++visIndex;
<a id="L1614" name="L1614"></a>1614                 movedToRight = <strong class="reserved">true</strong>;
<a id="L1615" name="L1615"></a>1615             <em class="brace">}</em>
<a id="L1616" name="L1616"></a>1616 
<a id="L1617" name="L1617"></a>1617             <strong class="reserved">if</strong> (visIndex &gt; -1 &amp;&amp; visIndex &lt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1618" name="L1618"></a>1618                 charIndex = textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(visIndex);
<a id="L1619" name="L1619"></a>1619                 <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a> = movedToRight == textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(charIndex);
<a id="L1620" name="L1620"></a>1620             <em class="brace">}</em>
<a id="L1621" name="L1621"></a>1621             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1622" name="L1622"></a>1622                 charIndex =
<a id="L1623" name="L1623"></a>1623                     (movedToRight == textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>())? <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a> : -1;
<a id="L1624" name="L1624"></a>1624                 <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a> = charIndex == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>;
<a id="L1625" name="L1625"></a>1625             <em class="brace">}</em>
<a id="L1626" name="L1626"></a>1626         <em class="brace">}</em>
<a id="L1627" name="L1627"></a>1627 
<a id="L1628" name="L1628"></a>1628         <strong class="reserved">return</strong> <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>? <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(charIndex) :
<a id="L1629" name="L1629"></a>1629                                 <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/35566.html" title="Multiple defined in 2 places.">trailing</a>(charIndex);
<a id="L1630" name="L1630"></a>1630     <em class="brace">}</em>
<a id="L1631" name="L1631"></a>1631 
<a id="L1632" name="L1632"></a>1632     <strong class="reserved">private</strong> <strong class="reserved">double</strong>[] <a href="../R/15450.html" title="Multiple referred from 7 places.">getCaretPath</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L1633" name="L1633"></a>1633         <strong class="reserved">float</strong>[] <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a> = <a href="../D/17497.html" title="Multiple defined in 3 places.">getCaretInfo</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>);
<a id="L1634" name="L1634"></a>1634         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <strong class="reserved">double</strong>[] <em class="brace">{</em> <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[2], <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[3], <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[4], <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[5] <em class="brace">}</em>;
<a id="L1635" name="L1635"></a>1635     <em class="brace">}</em>
<a id="L1636" name="L1636"></a>1636 
<div class="comment">
      Return an array of four floats corresponding the endpoints of the caret
      x0, y0, x1, y1.
      This creates a line along the slope of the caret intersecting the
      baseline at the caret
      position, and extending from ascent above the baseline to descent below
      it.</div>
<a id="L1646" name="L1646"></a>1646     <strong class="reserved">private</strong> <strong class="reserved">double</strong>[] <a href="../R/15450.html" title="Multiple referred from 7 places.">getCaretPath</a>(<strong class="reserved">int</strong> caret, <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>,
<a id="L1647" name="L1647"></a>1647                                   <strong class="reserved">boolean</strong> clipToBounds) <em class="brace">{</em>
<a id="L1648" name="L1648"></a>1648 
<a id="L1649" name="L1649"></a>1649         <strong class="reserved">float</strong>[] <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a> = <a href="../D/17497.html" title="Multiple defined in 3 places.">getCaretInfo</a>(caret, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>, <strong class="reserved">null</strong>);
<a id="L1650" name="L1650"></a>1650 
<a id="L1651" name="L1651"></a>1651         <strong class="reserved">double</strong> pos = <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[0];
<a id="L1652" name="L1652"></a>1652         <strong class="reserved">double</strong> slope = <a href="../D/24493.html" title="Multiple defined in 8 places.">info</a>[1];
<a id="L1653" name="L1653"></a>1653 
<a id="L1654" name="L1654"></a>1654         <strong class="reserved">double</strong> x0, y0, x1, y1;
<a id="L1655" name="L1655"></a>1655         <strong class="reserved">double</strong> x2 = -3141.59, y2 = -2.7; <em class="comment">// values are there to make compiler happy</em>
<a id="L1656" name="L1656"></a>1656 
<a id="L1657" name="L1657"></a>1657         <strong class="reserved">double</strong> left = <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>();
<a id="L1658" name="L1658"></a>1658         <strong class="reserved">double</strong> right = left + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>();
<a id="L1659" name="L1659"></a>1659         <strong class="reserved">double</strong> <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a> = <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>();
<a id="L1660" name="L1660"></a>1660         <strong class="reserved">double</strong> bottom = <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a> + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>();
<a id="L1661" name="L1661"></a>1661 
<a id="L1662" name="L1662"></a>1662         <strong class="reserved">boolean</strong> threePoints = <strong class="reserved">false</strong>;
<a id="L1663" name="L1663"></a>1663 
<a id="L1664" name="L1664"></a>1664         <strong class="reserved">if</strong> (isVerticalLine) <em class="brace">{</em>
<a id="L1665" name="L1665"></a>1665 
<a id="L1666" name="L1666"></a>1666             <strong class="reserved">if</strong> (slope &gt;= 0) <em class="brace">{</em>
<a id="L1667" name="L1667"></a>1667                 x0 = left;
<a id="L1668" name="L1668"></a>1668                 x1 = right;
<a id="L1669" name="L1669"></a>1669             <em class="brace">}</em>
<a id="L1670" name="L1670"></a>1670             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1671" name="L1671"></a>1671                 x1 = left;
<a id="L1672" name="L1672"></a>1672                 x0 = right;
<a id="L1673" name="L1673"></a>1673             <em class="brace">}</em>
<a id="L1674" name="L1674"></a>1674 
<a id="L1675" name="L1675"></a>1675             y0 = pos + x0 * slope;
<a id="L1676" name="L1676"></a>1676             y1 = pos + x1 * slope;
<a id="L1677" name="L1677"></a>1677 
<a id="L1678" name="L1678"></a>1678             <em class="comment">// y0 &lt;= y1, always</em>
<a id="L1679" name="L1679"></a>1679 
<a id="L1680" name="L1680"></a>1680             <strong class="reserved">if</strong> (clipToBounds) <em class="brace">{</em>
<a id="L1681" name="L1681"></a>1681                 <strong class="reserved">if</strong> (y0 &lt; <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a>) <em class="brace">{</em>
<a id="L1682" name="L1682"></a>1682                     <strong class="reserved">if</strong> (slope &lt;= 0 || y1 &lt;= <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a>) <em class="brace">{</em>
<a id="L1683" name="L1683"></a>1683                         y0 = y1 = <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a>;
<a id="L1684" name="L1684"></a>1684                     <em class="brace">}</em>
<a id="L1685" name="L1685"></a>1685                     <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1686" name="L1686"></a>1686                         threePoints = <strong class="reserved">true</strong>;
<a id="L1687" name="L1687"></a>1687                         y0 = <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a>;
<a id="L1688" name="L1688"></a>1688                         y2 = <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a>;
<a id="L1689" name="L1689"></a>1689                         x2 = x1 + (<a href="../D/35554.html" title="Multiple defined in 2 places.">top</a>-y1)/slope;
<a id="L1690" name="L1690"></a>1690                         <strong class="reserved">if</strong> (y1 &gt; bottom) <em class="brace">{</em>
<a id="L1691" name="L1691"></a>1691                             y1 = bottom;
<a id="L1692" name="L1692"></a>1692                         <em class="brace">}</em>
<a id="L1693" name="L1693"></a>1693                     <em class="brace">}</em>
<a id="L1694" name="L1694"></a>1694                 <em class="brace">}</em>
<a id="L1695" name="L1695"></a>1695                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (y1 &gt; bottom) <em class="brace">{</em>
<a id="L1696" name="L1696"></a>1696                     <strong class="reserved">if</strong> (slope &gt;= 0 || y0 &gt;= bottom) <em class="brace">{</em>
<a id="L1697" name="L1697"></a>1697                         y0 = y1 = bottom;
<a id="L1698" name="L1698"></a>1698                     <em class="brace">}</em>
<a id="L1699" name="L1699"></a>1699                     <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1700" name="L1700"></a>1700                         threePoints = <strong class="reserved">true</strong>;
<a id="L1701" name="L1701"></a>1701                         y1 = bottom;
<a id="L1702" name="L1702"></a>1702                         y2 = bottom;
<a id="L1703" name="L1703"></a>1703                         x2 = x0 + (bottom-x1)/slope;
<a id="L1704" name="L1704"></a>1704                     <em class="brace">}</em>
<a id="L1705" name="L1705"></a>1705                 <em class="brace">}</em>
<a id="L1706" name="L1706"></a>1706             <em class="brace">}</em>
<a id="L1707" name="L1707"></a>1707 
<a id="L1708" name="L1708"></a>1708         <em class="brace">}</em>
<a id="L1709" name="L1709"></a>1709         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1710" name="L1710"></a>1710 
<a id="L1711" name="L1711"></a>1711             <strong class="reserved">if</strong> (slope &gt;= 0) <em class="brace">{</em>
<a id="L1712" name="L1712"></a>1712                 y0 = bottom;
<a id="L1713" name="L1713"></a>1713                 y1 = <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a>;
<a id="L1714" name="L1714"></a>1714             <em class="brace">}</em>
<a id="L1715" name="L1715"></a>1715             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1716" name="L1716"></a>1716                 y1 = bottom;
<a id="L1717" name="L1717"></a>1717                 y0 = <a href="../D/35554.html" title="Multiple defined in 2 places.">top</a>;
<a id="L1718" name="L1718"></a>1718             <em class="brace">}</em>
<a id="L1719" name="L1719"></a>1719 
<a id="L1720" name="L1720"></a>1720             x0 = pos - y0 * slope;
<a id="L1721" name="L1721"></a>1721             x1 = pos - y1 * slope;
<a id="L1722" name="L1722"></a>1722 
<a id="L1723" name="L1723"></a>1723             <em class="comment">// x0 &lt;= x1, always</em>
<a id="L1724" name="L1724"></a>1724 
<a id="L1725" name="L1725"></a>1725             <strong class="reserved">if</strong> (clipToBounds) <em class="brace">{</em>
<a id="L1726" name="L1726"></a>1726                 <strong class="reserved">if</strong> (x0 &lt; left) <em class="brace">{</em>
<a id="L1727" name="L1727"></a>1727                     <strong class="reserved">if</strong> (slope &lt;= 0 || x1 &lt;= left) <em class="brace">{</em>
<a id="L1728" name="L1728"></a>1728                         x0 = x1 = left;
<a id="L1729" name="L1729"></a>1729                     <em class="brace">}</em>
<a id="L1730" name="L1730"></a>1730                     <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1731" name="L1731"></a>1731                         threePoints = <strong class="reserved">true</strong>;
<a id="L1732" name="L1732"></a>1732                         x0 = left;
<a id="L1733" name="L1733"></a>1733                         x2 = left;
<a id="L1734" name="L1734"></a>1734                         y2 = y1 - (left-x1)/slope;
<a id="L1735" name="L1735"></a>1735                         <strong class="reserved">if</strong> (x1 &gt; right) <em class="brace">{</em>
<a id="L1736" name="L1736"></a>1736                             x1 = right;
<a id="L1737" name="L1737"></a>1737                         <em class="brace">}</em>
<a id="L1738" name="L1738"></a>1738                     <em class="brace">}</em>
<a id="L1739" name="L1739"></a>1739                 <em class="brace">}</em>
<a id="L1740" name="L1740"></a>1740                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (x1 &gt; right) <em class="brace">{</em>
<a id="L1741" name="L1741"></a>1741                     <strong class="reserved">if</strong> (slope &gt;= 0 || x0 &gt;= right) <em class="brace">{</em>
<a id="L1742" name="L1742"></a>1742                         x0 = x1 = right;
<a id="L1743" name="L1743"></a>1743                     <em class="brace">}</em>
<a id="L1744" name="L1744"></a>1744                     <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1745" name="L1745"></a>1745                         threePoints = <strong class="reserved">true</strong>;
<a id="L1746" name="L1746"></a>1746                         x1 = right;
<a id="L1747" name="L1747"></a>1747                         x2 = right;
<a id="L1748" name="L1748"></a>1748                         y2 = y0 - (right-x0)/slope;
<a id="L1749" name="L1749"></a>1749                     <em class="brace">}</em>
<a id="L1750" name="L1750"></a>1750                 <em class="brace">}</em>
<a id="L1751" name="L1751"></a>1751             <em class="brace">}</em>
<a id="L1752" name="L1752"></a>1752         <em class="brace">}</em>
<a id="L1753" name="L1753"></a>1753 
<a id="L1754" name="L1754"></a>1754         <strong class="reserved">return</strong> threePoints?
<a id="L1755" name="L1755"></a>1755                     <strong class="reserved">new</strong> <strong class="reserved">double</strong>[] <em class="brace">{</em> x0, y0, x2, y2, x1, y1 <em class="brace">}</em> :
<a id="L1756" name="L1756"></a>1756                     <strong class="reserved">new</strong> <strong class="reserved">double</strong>[] <em class="brace">{</em> x0, y0, x1, y1 <em class="brace">}</em>;
<a id="L1757" name="L1757"></a>1757     <em class="brace">}</em>
<a id="L1758" name="L1758"></a>1758 
<a id="L1759" name="L1759"></a>1759 
<a id="L1760" name="L1760"></a>1760     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../R/24685.html" title="Multiple referred from 4 places.">pathToShape</a>(<strong class="reserved">double</strong>[] path, <strong class="reserved">boolean</strong> <a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>, LayoutPathImpl lp) <em class="brace">{</em>
<a id="L1761" name="L1761"></a>1761         <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>(<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>.WIND_EVEN_ODD, path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L1762" name="L1762"></a>1762         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/27818.html" title="Multiple defined in 4 places.">moveTo</a>((<strong class="reserved">float</strong>)path[0], (<strong class="reserved">float</strong>)path[1]);
<a id="L1763" name="L1763"></a>1763         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 2; i &lt; path.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i += 2) <em class="brace">{</em>
<a id="L1764" name="L1764"></a>1764             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/26845.html" title="Multiple defined in 4 places.">lineTo</a>((<strong class="reserved">float</strong>)path[i], (<strong class="reserved">float</strong>)path[i+1]);
<a id="L1765" name="L1765"></a>1765         <em class="brace">}</em>
<a id="L1766" name="L1766"></a>1766         <strong class="reserved">if</strong> (<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>) <em class="brace">{</em>
<a id="L1767" name="L1767"></a>1767             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../S/2317.html#L1874" title="Defined at 1874 in src/java/awt/geom/Path2D.java.">closePath</a>();
<a id="L1768" name="L1768"></a>1768         <em class="brace">}</em>
<a id="L1769" name="L1769"></a>1769 
<a id="L1770" name="L1770"></a>1770         <strong class="reserved">if</strong> (lp != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1771" name="L1771"></a>1771             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>)lp.mapShape(<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>);
<a id="L1772" name="L1772"></a>1772         <em class="brace">}</em>
<a id="L1773" name="L1773"></a>1773         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L1774" name="L1774"></a>1774     <em class="brace">}</em>
<a id="L1775" name="L1775"></a>1775 
<div class="comment">
      Returns a <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> representing the caret at the specified
      hit inside the specified bounds.
      @param hit the hit at which to generate the caret
      @param bounds the bounds of the <code>TextLayout</code> to use
         in generating the caret.  The bounds is in baseline-relative
         coordinates.
      @return a <code>Shape</code> representing the caret.  The returned
         shape is in standard coordinates.</div>
<a id="L1786" name="L1786"></a>1786     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../S/2375.html#L1806" title="Referred from 1806 in src/java/awt/font/TextLayout.java.">getCaretShape</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L1787" name="L1787"></a>1787         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L1788" name="L1788"></a>1788         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1789" name="L1789"></a>1789 
<a id="L1790" name="L1790"></a>1790         <strong class="reserved">if</strong> (<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1791" name="L1791"></a>1791             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null Rectangle2D passed to TextLayout.getCaret()");
<a id="L1792" name="L1792"></a>1792         <em class="brace">}</em>
<a id="L1793" name="L1793"></a>1793 
<a id="L1794" name="L1794"></a>1794         <strong class="reserved">return</strong> <a href="../S/2375.html#L1760" title="Defined at 1760 in src/java/awt/font/TextLayout.java.">pathToShape</a>(<a href="../D/17500.html" title="Multiple defined in 2 places.">getCaretPath</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>), <strong class="reserved">false</strong>, textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>());
<a id="L1795" name="L1795"></a>1795     <em class="brace">}</em>
<a id="L1796" name="L1796"></a>1796 
<div class="comment">
      Returns a <code>Shape</code> representing the caret at the specified
      hit inside the natural bounds of this <code>TextLayout</code>.
      @param hit the hit at which to generate the caret
      @return a <code>Shape</code> representing the caret.  The returned
          shape is in standard coordinates.</div>
<a id="L1804" name="L1804"></a>1804     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../S/2375.html#L1806" title="Referred from 1806 in src/java/awt/font/TextLayout.java.">getCaretShape</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>) <em class="brace">{</em>
<a id="L1805" name="L1805"></a>1805 
<a id="L1806" name="L1806"></a>1806         <strong class="reserved">return</strong> <a href="../D/17502.html" title="Multiple defined in 2 places.">getCaretShape</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../S/2375.html#L735" title="Defined at 735 in src/java/awt/font/TextLayout.java.">getNaturalBounds</a>());
<a id="L1807" name="L1807"></a>1807     <em class="brace">}</em>
<a id="L1808" name="L1808"></a>1808 
<div class="comment">
      Return the "stronger" of the TextHitInfos.  The TextHitInfos
      should be logical or visual counterparts.  They are not
      checked for validity.</div>
<a id="L1814" name="L1814"></a>1814     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2375.html#L341" title="Referred from 341 in src/java/awt/font/TextLayout.java.">getStrongHit</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> hit1, <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> hit2) <em class="brace">{</em>
<a id="L1815" name="L1815"></a>1815 
<a id="L1816" name="L1816"></a>1816         <em class="comment">// right now we're using the following rule for strong hits:</em>
<a id="L1817" name="L1817"></a>1817         <em class="comment">// A hit on a character with a lower level</em>
<a id="L1818" name="L1818"></a>1818         <em class="comment">// is stronger than one on a character with a higher level.</em>
<a id="L1819" name="L1819"></a>1819         <em class="comment">// If this rule ties, the hit on the leading edge of a character wins.</em>
<a id="L1820" name="L1820"></a>1820         <em class="comment">// If THIS rule ties, hit1 wins.  Both rules shouldn't tie, unless the</em>
<a id="L1821" name="L1821"></a>1821         <em class="comment">// infos aren't counterparts of some sort.</em>
<a id="L1822" name="L1822"></a>1822 
<a id="L1823" name="L1823"></a>1823         <strong class="reserved">byte</strong> hit1Level = <a href="../S/2375.html#L1846" title="Defined at 1846 in src/java/awt/font/TextLayout.java.">getCharacterLevel</a>(hit1.<a href="../S/2364.html#L107" title="Defined at 107 in src/java/awt/font/TextHitInfo.java.">getCharIndex</a>());
<a id="L1824" name="L1824"></a>1824         <strong class="reserved">byte</strong> hit2Level = <a href="../S/2375.html#L1846" title="Defined at 1846 in src/java/awt/font/TextLayout.java.">getCharacterLevel</a>(hit2.<a href="../S/2364.html#L107" title="Defined at 107 in src/java/awt/font/TextHitInfo.java.">getCharIndex</a>());
<a id="L1825" name="L1825"></a>1825 
<a id="L1826" name="L1826"></a>1826         <strong class="reserved">if</strong> (hit1Level == hit2Level) <em class="brace">{</em>
<a id="L1827" name="L1827"></a>1827             <strong class="reserved">if</strong> (hit2.<a href="../S/2364.html#L117" title="Defined at 117 in src/java/awt/font/TextHitInfo.java.">isLeadingEdge</a>() &amp;&amp; !hit1.<a href="../S/2364.html#L117" title="Defined at 117 in src/java/awt/font/TextHitInfo.java.">isLeadingEdge</a>()) <em class="brace">{</em>
<a id="L1828" name="L1828"></a>1828                 <strong class="reserved">return</strong> hit2;
<a id="L1829" name="L1829"></a>1829             <em class="brace">}</em>
<a id="L1830" name="L1830"></a>1830             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1831" name="L1831"></a>1831                 <strong class="reserved">return</strong> hit1;
<a id="L1832" name="L1832"></a>1832             <em class="brace">}</em>
<a id="L1833" name="L1833"></a>1833         <em class="brace">}</em>
<a id="L1834" name="L1834"></a>1834         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1835" name="L1835"></a>1835             <strong class="reserved">return</strong> (hit1Level &lt; hit2Level)? hit1 : hit2;
<a id="L1836" name="L1836"></a>1836         <em class="brace">}</em>
<a id="L1837" name="L1837"></a>1837     <em class="brace">}</em>
<a id="L1838" name="L1838"></a>1838 
<div class="comment">
      Returns the level of the character at <code>index</code>.
      Indices -1 and <code>characterCount</code> are assigned the base
      level of this <code>TextLayout</code>.
      @param index the index of the character from which to get the level
      @return the level of the character at the specified index.</div>
<a id="L1846" name="L1846"></a>1846     <strong class="reserved">public</strong> <strong class="reserved">byte</strong> <a href="../R/15528.html" title="Multiple referred from 2 places.">getCharacterLevel</a>(<strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) <em class="brace">{</em>
<a id="L1847" name="L1847"></a>1847 
<a id="L1848" name="L1848"></a>1848         <em class="comment">// hmm, allow indices at endpoints?  For now, yes.</em>
<a id="L1849" name="L1849"></a>1849         <strong class="reserved">if</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &lt; -1 || <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> &gt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1850" name="L1850"></a>1850             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Index is out of range in getCharacterLevel.");
<a id="L1851" name="L1851"></a>1851         <em class="brace">}</em>
<a id="L1852" name="L1852"></a>1852 
<a id="L1853" name="L1853"></a>1853         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L1854" name="L1854"></a>1854         <strong class="reserved">if</strong> (<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == -1 || <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1855" name="L1855"></a>1855              <strong class="reserved">return</strong> (<strong class="reserved">byte</strong>) (textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>()? 0 : 1);
<a id="L1856" name="L1856"></a>1856         <em class="brace">}</em>
<a id="L1857" name="L1857"></a>1857 
<a id="L1858" name="L1858"></a>1858         <strong class="reserved">return</strong> textLine.<a href="../S/2362.html#L570" title="Defined at 570 in src/java/awt/font/TextLine.java.">getCharLevel</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>);
<a id="L1859" name="L1859"></a>1859     <em class="brace">}</em>
<a id="L1860" name="L1860"></a>1860 
<div class="comment">
      Returns two paths corresponding to the strong and weak caret.
      @param offset an offset in this <code>TextLayout</code>
      @param bounds the bounds to which to extend the carets.  The
      bounds is in baseline-relative coordinates.
      @param policy the specified <code>CaretPolicy</code>
      @return an array of two paths.  Element zero is the strong
      caret.  If there are two carets, element one is the weak caret,
      otherwise it is <code>null</code>. The returned shapes
      are in standard coordinates.</div>
<a id="L1872" name="L1872"></a>1872     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a>[] <a href="../R/15453.html" title="Multiple referred from 2 places.">getCaretShapes</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>, <a href="../S/2375.html#L317" title="Defined at 317 in src/java/awt/font/TextLayout.java.">CaretPolicy</a> policy) <em class="brace">{</em>
<a id="L1873" name="L1873"></a>1873 
<a id="L1874" name="L1874"></a>1874         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L1875" name="L1875"></a>1875 
<a id="L1876" name="L1876"></a>1876         <strong class="reserved">if</strong> (<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &lt; 0 || <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a> &gt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L1877" name="L1877"></a>1877             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Offset out of bounds in TextLayout.getCaretShapes()");
<a id="L1878" name="L1878"></a>1878         <em class="brace">}</em>
<a id="L1879" name="L1879"></a>1879 
<a id="L1880" name="L1880"></a>1880         <strong class="reserved">if</strong> (<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1881" name="L1881"></a>1881             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null Rectangle2D passed to TextLayout.getCaretShapes()");
<a id="L1882" name="L1882"></a>1882         <em class="brace">}</em>
<a id="L1883" name="L1883"></a>1883 
<a id="L1884" name="L1884"></a>1884         <strong class="reserved">if</strong> (policy == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1885" name="L1885"></a>1885             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null CaretPolicy passed to TextLayout.getCaretShapes()");
<a id="L1886" name="L1886"></a>1886         <em class="brace">}</em>
<a id="L1887" name="L1887"></a>1887 
<a id="L1888" name="L1888"></a>1888         <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a>[] <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a>[2];
<a id="L1889" name="L1889"></a>1889 
<a id="L1890" name="L1890"></a>1890         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a> = <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../S/2364.html#L216" title="Defined at 216 in src/java/awt/font/TextHitInfo.java.">afterOffset</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>);
<a id="L1891" name="L1891"></a>1891 
<a id="L1892" name="L1892"></a>1892         <strong class="reserved">int</strong> hitCaret = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1893" name="L1893"></a>1893 
<a id="L1894" name="L1894"></a>1894         LayoutPathImpl lp = textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>();
<a id="L1895" name="L1895"></a>1895         <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> hitShape = <a href="../S/2375.html#L1760" title="Defined at 1760 in src/java/awt/font/TextLayout.java.">pathToShape</a>(<a href="../D/17500.html" title="Multiple defined in 2 places.">getCaretPath</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>), <strong class="reserved">false</strong>, lp);
<a id="L1896" name="L1896"></a>1896         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> otherHit = <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L226" title="Defined at 226 in src/java/awt/font/TextHitInfo.java.">getOtherHit</a>();
<a id="L1897" name="L1897"></a>1897         <strong class="reserved">int</strong> otherCaret = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(otherHit);
<a id="L1898" name="L1898"></a>1898 
<a id="L1899" name="L1899"></a>1899         <strong class="reserved">if</strong> (hitCaret == otherCaret) <em class="brace">{</em>
<a id="L1900" name="L1900"></a>1900             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>[0] = hitShape;
<a id="L1901" name="L1901"></a>1901         <em class="brace">}</em>
<a id="L1902" name="L1902"></a>1902         <strong class="reserved">else</strong> <em class="brace">{</em> <em class="comment">// more than one caret</em>
<a id="L1903" name="L1903"></a>1903             <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> otherShape = <a href="../S/2375.html#L1760" title="Defined at 1760 in src/java/awt/font/TextLayout.java.">pathToShape</a>(<a href="../D/17500.html" title="Multiple defined in 2 places.">getCaretPath</a>(otherHit, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>), <strong class="reserved">false</strong>, lp);
<a id="L1904" name="L1904"></a>1904 
<a id="L1905" name="L1905"></a>1905             <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> strongHit = policy.<a href="../S/2375.html#L336" title="Defined at 336 in src/java/awt/font/TextLayout.java.">getStrongCaret</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, otherHit, <strong class="reserved">this</strong>);
<a id="L1906" name="L1906"></a>1906             <strong class="reserved">boolean</strong> hitIsStrong = strongHit.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L1907" name="L1907"></a>1907 
<a id="L1908" name="L1908"></a>1908             <strong class="reserved">if</strong> (hitIsStrong) <em class="brace">{</em><em class="comment">// then other is weak</em>
<a id="L1909" name="L1909"></a>1909                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>[0] = hitShape;
<a id="L1910" name="L1910"></a>1910                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>[1] = otherShape;
<a id="L1911" name="L1911"></a>1911             <em class="brace">}</em>
<a id="L1912" name="L1912"></a>1912             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1913" name="L1913"></a>1913                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>[0] = otherShape;
<a id="L1914" name="L1914"></a>1914                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>[1] = hitShape;
<a id="L1915" name="L1915"></a>1915             <em class="brace">}</em>
<a id="L1916" name="L1916"></a>1916         <em class="brace">}</em>
<a id="L1917" name="L1917"></a>1917 
<a id="L1918" name="L1918"></a>1918         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L1919" name="L1919"></a>1919     <em class="brace">}</em>
<a id="L1920" name="L1920"></a>1920 
<div class="comment">
      Returns two paths corresponding to the strong and weak caret.
      This method is a convenience overload of <code>getCaretShapes</code>
      that uses the default caret policy.
      @param offset an offset in this <code>TextLayout</code>
      @param bounds the bounds to which to extend the carets.  This is
          in baseline-relative coordinates.
      @return two paths corresponding to the strong and weak caret as
         defined by the <code>DEFAULT_CARET_POLICY</code>.  These are
         in standard coordinates.</div>
<a id="L1932" name="L1932"></a>1932     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a>[] <a href="../R/15453.html" title="Multiple referred from 2 places.">getCaretShapes</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L1933" name="L1933"></a>1933         <em class="comment">// {sfb} parameter checking is done in overloaded version</em>
<a id="L1934" name="L1934"></a>1934         <strong class="reserved">return</strong> <a href="../D/17503.html" title="Multiple defined in 3 places.">getCaretShapes</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>, DEFAULT_CARET_POLICY);
<a id="L1935" name="L1935"></a>1935     <em class="brace">}</em>
<a id="L1936" name="L1936"></a>1936 
<div class="comment">
      Returns two paths corresponding to the strong and weak caret.
      This method is a convenience overload of <code>getCaretShapes</code>
      that uses the default caret policy and this <code>TextLayout</code>
      object's natural bounds.
      @param offset an offset in this <code>TextLayout</code>
      @return two paths corresponding to the strong and weak caret as
         defined by the <code>DEFAULT_CARET_POLICY</code>.  These are
         in standard coordinates.</div>
<a id="L1947" name="L1947"></a>1947     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a>[] <a href="../R/15453.html" title="Multiple referred from 2 places.">getCaretShapes</a>(<strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>) <em class="brace">{</em>
<a id="L1948" name="L1948"></a>1948         <em class="comment">// {sfb} parameter checking is done in overloaded version</em>
<a id="L1949" name="L1949"></a>1949         <strong class="reserved">return</strong> <a href="../D/17503.html" title="Multiple defined in 3 places.">getCaretShapes</a>(<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>, <a href="../S/2375.html#L735" title="Defined at 735 in src/java/awt/font/TextLayout.java.">getNaturalBounds</a>(), DEFAULT_CARET_POLICY);
<a id="L1950" name="L1950"></a>1950     <em class="brace">}</em>
<a id="L1951" name="L1951"></a>1951 
<a id="L1952" name="L1952"></a>1952     <em class="comment">// A utility to return a path enclosing the given path</em>
<a id="L1953" name="L1953"></a>1953     <em class="comment">// Path0 must be left or top of path1</em>
<a id="L1954" name="L1954"></a>1954     <em class="comment">// {jbr} no assumptions about size of path0, path1 anymore.</em>
<a id="L1955" name="L1955"></a>1955     <strong class="reserved">private</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../R/10655.html" title="Multiple referred from 3 places.">boundingShape</a>(<strong class="reserved">double</strong>[] path0, <strong class="reserved">double</strong>[] path1) <em class="brace">{</em>
<a id="L1956" name="L1956"></a>1956 
<a id="L1957" name="L1957"></a>1957         <em class="comment">// Really, we want the path to be a convex hull around all of the</em>
<a id="L1958" name="L1958"></a>1958         <em class="comment">// points in path0 and path1.  But we can get by with less than</em>
<a id="L1959" name="L1959"></a>1959         <em class="comment">// that.  We do need to prevent the two segments which</em>
<a id="L1960" name="L1960"></a>1960         <em class="comment">// join path0 to path1 from crossing each other.  So, if we</em>
<a id="L1961" name="L1961"></a>1961         <em class="comment">// traverse path0 from top to bottom, we'll traverse path1 from</em>
<a id="L1962" name="L1962"></a>1962         <em class="comment">// bottom to top (and vice versa).</em>
<a id="L1963" name="L1963"></a>1963 
<a id="L1964" name="L1964"></a>1964         <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../S/2375.html#L1760" title="Defined at 1760 in src/java/awt/font/TextLayout.java.">pathToShape</a>(path0, <strong class="reserved">false</strong>, <strong class="reserved">null</strong>);
<a id="L1965" name="L1965"></a>1965 
<a id="L1966" name="L1966"></a>1966         <strong class="reserved">boolean</strong> sameDirection;
<a id="L1967" name="L1967"></a>1967 
<a id="L1968" name="L1968"></a>1968         <strong class="reserved">if</strong> (isVerticalLine) <em class="brace">{</em>
<a id="L1969" name="L1969"></a>1969             sameDirection = (path0[1] &gt; path0[path0.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>-1]) ==
<a id="L1970" name="L1970"></a>1970                             (path1[1] &gt; path1[path1.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>-1]);
<a id="L1971" name="L1971"></a>1971         <em class="brace">}</em>
<a id="L1972" name="L1972"></a>1972         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1973" name="L1973"></a>1973             sameDirection = (path0[0] &gt; path0[path0.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>-2]) ==
<a id="L1974" name="L1974"></a>1974                             (path1[0] &gt; path1[path1.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>-2]);
<a id="L1975" name="L1975"></a>1975         <em class="brace">}</em>
<a id="L1976" name="L1976"></a>1976 
<a id="L1977" name="L1977"></a>1977         <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L1978" name="L1978"></a>1978         <strong class="reserved">int</strong> <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>;
<a id="L1979" name="L1979"></a>1979         <strong class="reserved">int</strong> <a href="../D/24445.html" title="Multiple defined in 3 places.">increment</a>;
<a id="L1980" name="L1980"></a>1980 
<a id="L1981" name="L1981"></a>1981         <strong class="reserved">if</strong> (sameDirection) <em class="brace">{</em>
<a id="L1982" name="L1982"></a>1982             <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = path1.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>-2;
<a id="L1983" name="L1983"></a>1983             <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a> = -2;
<a id="L1984" name="L1984"></a>1984             <a href="../D/24445.html" title="Multiple defined in 3 places.">increment</a> = -2;
<a id="L1985" name="L1985"></a>1985         <em class="brace">}</em>
<a id="L1986" name="L1986"></a>1986         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1987" name="L1987"></a>1987             <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = 0;
<a id="L1988" name="L1988"></a>1988             <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a> = path1.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L1989" name="L1989"></a>1989             <a href="../D/24445.html" title="Multiple defined in 3 places.">increment</a> = 2;
<a id="L1990" name="L1990"></a>1990         <em class="brace">}</em>
<a id="L1991" name="L1991"></a>1991 
<a id="L1992" name="L1992"></a>1992         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>; i != <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>; i += <a href="../D/24445.html" title="Multiple defined in 3 places.">increment</a>) <em class="brace">{</em>
<a id="L1993" name="L1993"></a>1993             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/26845.html" title="Multiple defined in 4 places.">lineTo</a>((<strong class="reserved">float</strong>)path1[i], (<strong class="reserved">float</strong>)path1[i+1]);
<a id="L1994" name="L1994"></a>1994         <em class="brace">}</em>
<a id="L1995" name="L1995"></a>1995 
<a id="L1996" name="L1996"></a>1996         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../S/2317.html#L1874" title="Defined at 1874 in src/java/awt/geom/Path2D.java.">closePath</a>();
<a id="L1997" name="L1997"></a>1997 
<a id="L1998" name="L1998"></a>1998         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L1999" name="L1999"></a>1999     <em class="brace">}</em>
<a id="L2000" name="L2000"></a>2000 
<a id="L2001" name="L2001"></a>2001     <em class="comment">// A utility to convert a pair of carets into a bounding path</em>
<a id="L2002" name="L2002"></a>2002     <em class="comment">// {jbr} Shape is never outside of bounds.</em>
<a id="L2003" name="L2003"></a>2003     <strong class="reserved">private</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../R/10972.html" title="Multiple referred from 2 places.">caretBoundingShape</a>(<strong class="reserved">int</strong> caret0,
<a id="L2004" name="L2004"></a>2004                                            <strong class="reserved">int</strong> caret1,
<a id="L2005" name="L2005"></a>2005                                            <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L2006" name="L2006"></a>2006 
<a id="L2007" name="L2007"></a>2007         <strong class="reserved">if</strong> (caret0 &gt; caret1) <em class="brace">{</em>
<a id="L2008" name="L2008"></a>2008             <strong class="reserved">int</strong> temp = caret0;
<a id="L2009" name="L2009"></a>2009             caret0 = caret1;
<a id="L2010" name="L2010"></a>2010             caret1 = temp;
<a id="L2011" name="L2011"></a>2011         <em class="brace">}</em>
<a id="L2012" name="L2012"></a>2012 
<a id="L2013" name="L2013"></a>2013         <strong class="reserved">return</strong> <a href="../S/2375.html#L1955" title="Defined at 1955 in src/java/awt/font/TextLayout.java.">boundingShape</a>(<a href="../D/17500.html" title="Multiple defined in 2 places.">getCaretPath</a>(caret0, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>, <strong class="reserved">true</strong>),
<a id="L2014" name="L2014"></a>2014                              <a href="../D/17500.html" title="Multiple defined in 2 places.">getCaretPath</a>(caret1, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>, <strong class="reserved">true</strong>));
<a id="L2015" name="L2015"></a>2015     <em class="brace">}</em>
<a id="L2016" name="L2016"></a>2016 
<div class="comment">
      A utility to return the path bounding the area to the left (top) of the
      layout.
      Shape is never outside of bounds.</div>
<a id="L2022" name="L2022"></a>2022     <strong class="reserved">private</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../R/22466.html" title="Multiple referred from 2 places.">leftShape</a>(<a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L2023" name="L2023"></a>2023 
<a id="L2024" name="L2024"></a>2024         <strong class="reserved">double</strong>[] path0;
<a id="L2025" name="L2025"></a>2025         <strong class="reserved">if</strong> (isVerticalLine) <em class="brace">{</em>
<a id="L2026" name="L2026"></a>2026             path0 = <strong class="reserved">new</strong> <strong class="reserved">double</strong>[] <em class="brace">{</em> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>(), <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>(),
<a id="L2027" name="L2027"></a>2027                                        <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>() + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>(),
<a id="L2028" name="L2028"></a>2028                                        <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>() <em class="brace">}</em>;
<a id="L2029" name="L2029"></a>2029         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2030" name="L2030"></a>2030             path0 = <strong class="reserved">new</strong> <strong class="reserved">double</strong>[] <em class="brace">{</em> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>(),
<a id="L2031" name="L2031"></a>2031                                        <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>() + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>(),
<a id="L2032" name="L2032"></a>2032                                        <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>(), <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>() <em class="brace">}</em>;
<a id="L2033" name="L2033"></a>2033         <em class="brace">}</em>
<a id="L2034" name="L2034"></a>2034 
<a id="L2035" name="L2035"></a>2035         <strong class="reserved">double</strong>[] path1 = <a href="../D/17500.html" title="Multiple defined in 2 places.">getCaretPath</a>(0, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>, <strong class="reserved">true</strong>);
<a id="L2036" name="L2036"></a>2036 
<a id="L2037" name="L2037"></a>2037         <strong class="reserved">return</strong> <a href="../S/2375.html#L1955" title="Defined at 1955 in src/java/awt/font/TextLayout.java.">boundingShape</a>(path0, path1);
<a id="L2038" name="L2038"></a>2038     <em class="brace">}</em>
<a id="L2039" name="L2039"></a>2039 
<div class="comment">
      A utility to return the path bounding the area to the right (bottom) of
      the layout.</div>
<a id="L2044" name="L2044"></a>2044     <strong class="reserved">private</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../R/26493.html" title="Multiple referred from 2 places.">rightShape</a>(<a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L2045" name="L2045"></a>2045         <strong class="reserved">double</strong>[] path1;
<a id="L2046" name="L2046"></a>2046         <strong class="reserved">if</strong> (isVerticalLine) <em class="brace">{</em>
<a id="L2047" name="L2047"></a>2047             path1 = <strong class="reserved">new</strong> <strong class="reserved">double</strong>[] <em class="brace">{</em>
<a id="L2048" name="L2048"></a>2048                 <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>(),
<a id="L2049" name="L2049"></a>2049                 <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>() + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>(),
<a id="L2050" name="L2050"></a>2050                 <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>() + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>(),
<a id="L2051" name="L2051"></a>2051                 <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>() + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>()
<a id="L2052" name="L2052"></a>2052             <em class="brace">}</em>;
<a id="L2053" name="L2053"></a>2053         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2054" name="L2054"></a>2054             path1 = <strong class="reserved">new</strong> <strong class="reserved">double</strong>[] <em class="brace">{</em>
<a id="L2055" name="L2055"></a>2055                 <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>() + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>(),
<a id="L2056" name="L2056"></a>2056                 <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>() + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/19442.html" title="Multiple defined in 56 places.">getHeight</a>(),
<a id="L2057" name="L2057"></a>2057                 <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23738.html" title="Multiple defined in 24 places.">getX</a>() + <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23687.html" title="Multiple defined in 56 places.">getWidth</a>(),
<a id="L2058" name="L2058"></a>2058                 <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/23797.html" title="Multiple defined in 24 places.">getY</a>()
<a id="L2059" name="L2059"></a>2059             <em class="brace">}</em>;
<a id="L2060" name="L2060"></a>2060         <em class="brace">}</em>
<a id="L2061" name="L2061"></a>2061 
<a id="L2062" name="L2062"></a>2062         <strong class="reserved">double</strong>[] path0 = <a href="../D/17500.html" title="Multiple defined in 2 places.">getCaretPath</a>(<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>, <strong class="reserved">true</strong>);
<a id="L2063" name="L2063"></a>2063 
<a id="L2064" name="L2064"></a>2064         <strong class="reserved">return</strong> <a href="../S/2375.html#L1955" title="Defined at 1955 in src/java/awt/font/TextLayout.java.">boundingShape</a>(path0, path1);
<a id="L2065" name="L2065"></a>2065     <em class="brace">}</em>
<a id="L2066" name="L2066"></a>2066 
<div class="comment">
      Returns the logical ranges of text corresponding to a visual selection.
      @param firstEndpoint an endpoint of the visual range
      @param secondEndpoint the other endpoint of the visual range.
      This endpoint can be less than <code>firstEndpoint</code>.
      @return an array of integers representing start/limit pairs for the
      selected ranges.
      @see #getVisualHighlightShape(TextHitInfo, TextHitInfo, Rectangle2D)</div>
<a id="L2076" name="L2076"></a>2076     <strong class="reserved">public</strong> <strong class="reserved">int</strong>[] getLogicalRangesForVisualSelection(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> firstEndpoint,
<a id="L2077" name="L2077"></a>2077                                                     <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> secondEndpoint) <em class="brace">{</em>
<a id="L2078" name="L2078"></a>2078         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2079" name="L2079"></a>2079 
<a id="L2080" name="L2080"></a>2080         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(firstEndpoint);
<a id="L2081" name="L2081"></a>2081         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(secondEndpoint);
<a id="L2082" name="L2082"></a>2082 
<a id="L2083" name="L2083"></a>2083         <em class="comment">// !!! probably want to optimize for all LTR text</em>
<a id="L2084" name="L2084"></a>2084 
<a id="L2085" name="L2085"></a>2085         <strong class="reserved">boolean</strong>[] included = <strong class="reserved">new</strong> <strong class="reserved">boolean</strong>[<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>];
<a id="L2086" name="L2086"></a>2086 
<a id="L2087" name="L2087"></a>2087         <strong class="reserved">int</strong> startIndex = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(firstEndpoint);
<a id="L2088" name="L2088"></a>2088         <strong class="reserved">int</strong> limitIndex = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(secondEndpoint);
<a id="L2089" name="L2089"></a>2089 
<a id="L2090" name="L2090"></a>2090         <strong class="reserved">if</strong> (startIndex &gt; limitIndex) <em class="brace">{</em>
<a id="L2091" name="L2091"></a>2091             <strong class="reserved">int</strong> t = startIndex;
<a id="L2092" name="L2092"></a>2092             startIndex = limitIndex;
<a id="L2093" name="L2093"></a>2093             limitIndex = t;
<a id="L2094" name="L2094"></a>2094         <em class="brace">}</em>
<a id="L2095" name="L2095"></a>2095 
<div class="comment">
          now we have the visual indexes of the glyphs at the start and limit
          of the selection range walk through runs marking characters that
          were included in the visual range there is probably a more efficient
          way to do this, but this ought to work, so hey</div>
<a id="L2102" name="L2102"></a>2102 
<a id="L2103" name="L2103"></a>2103         <strong class="reserved">if</strong> (startIndex &lt; limitIndex) <em class="brace">{</em>
<a id="L2104" name="L2104"></a>2104             <strong class="reserved">int</strong> visIndex = startIndex;
<a id="L2105" name="L2105"></a>2105             <strong class="reserved">while</strong> (visIndex &lt; limitIndex) <em class="brace">{</em>
<a id="L2106" name="L2106"></a>2106                 included[textLine.<a href="../S/2362.html#L551" title="Defined at 551 in src/java/awt/font/TextLine.java.">visualToLogical</a>(visIndex)] = <strong class="reserved">true</strong>;
<a id="L2107" name="L2107"></a>2107                 ++visIndex;
<a id="L2108" name="L2108"></a>2108             <em class="brace">}</em>
<a id="L2109" name="L2109"></a>2109         <em class="brace">}</em>
<a id="L2110" name="L2110"></a>2110 
<div class="comment">
          count how many runs we have, ought to be one or two, but perhaps
          things are especially weird</div>
<a id="L2115" name="L2115"></a>2115         <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L2116" name="L2116"></a>2116         <strong class="reserved">boolean</strong> inrun = <strong class="reserved">false</strong>;
<a id="L2117" name="L2117"></a>2117         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>; i++) <em class="brace">{</em>
<a id="L2118" name="L2118"></a>2118             <strong class="reserved">if</strong> (included[i] != inrun) <em class="brace">{</em>
<a id="L2119" name="L2119"></a>2119                 inrun = !inrun;
<a id="L2120" name="L2120"></a>2120                 <strong class="reserved">if</strong> (inrun) <em class="brace">{</em>
<a id="L2121" name="L2121"></a>2121                     <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++;
<a id="L2122" name="L2122"></a>2122                 <em class="brace">}</em>
<a id="L2123" name="L2123"></a>2123             <em class="brace">}</em>
<a id="L2124" name="L2124"></a>2124         <em class="brace">}</em>
<a id="L2125" name="L2125"></a>2125 
<a id="L2126" name="L2126"></a>2126         <strong class="reserved">int</strong>[] ranges = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> * 2];
<a id="L2127" name="L2127"></a>2127         <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L2128" name="L2128"></a>2128         inrun = <strong class="reserved">false</strong>;
<a id="L2129" name="L2129"></a>2129         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>; i++) <em class="brace">{</em>
<a id="L2130" name="L2130"></a>2130             <strong class="reserved">if</strong> (included[i] != inrun) <em class="brace">{</em>
<a id="L2131" name="L2131"></a>2131                 ranges[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = i;
<a id="L2132" name="L2132"></a>2132                 inrun = !inrun;
<a id="L2133" name="L2133"></a>2133             <em class="brace">}</em>
<a id="L2134" name="L2134"></a>2134         <em class="brace">}</em>
<a id="L2135" name="L2135"></a>2135         <strong class="reserved">if</strong> (inrun) <em class="brace">{</em>
<a id="L2136" name="L2136"></a>2136             ranges[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>;
<a id="L2137" name="L2137"></a>2137         <em class="brace">}</em>
<a id="L2138" name="L2138"></a>2138 
<a id="L2139" name="L2139"></a>2139         <strong class="reserved">return</strong> ranges;
<a id="L2140" name="L2140"></a>2140     <em class="brace">}</em>
<a id="L2141" name="L2141"></a>2141 
<div class="comment">
      Returns a path enclosing the visual selection in the specified range,
      extended to <code>bounds</code>.
      <p>
      If the selection includes the leftmost (topmost) position, the selection
      is extended to the left (top) of <code>bounds</code>.  If the
      selection includes the rightmost (bottommost) position, the selection
      is extended to the right (bottom) of the bounds.  The height
      (width on vertical lines) of the selection is always extended to
      <code>bounds</code>.
      </p><p>
      Although the selection is always contiguous, the logically selected
      text can be discontiguous on lines with mixed-direction text.  The
      logical ranges of text selected can be retrieved using
      <code>getLogicalRangesForVisualSelection</code>.  For example,
      consider the text 'ABCdef' where capital letters indicate
      right-to-left text, rendered on a right-to-left line, with a visual
      selection from 0L (the leading edge of 'A') to 3T (the trailing edge
      of 'd').  The text appears as follows, with bold underlined areas
      representing the selection:
      <br></p><pre>         d<u><b>efCBA  </b></u>
      </pre>
      The logical selection ranges are 0-3, 4-6 (ABC, ef) because the
      visually contiguous text is logically discontiguous.  Also note that
      since the rightmost position on the layout (to the right of 'A') is
      selected, the selection is extended to the right of the bounds.
      @param firstEndpoint one end of the visual selection
      @param secondEndpoint the other end of the visual selection
      @param bounds the bounding rectangle to which to extend the selection.
          This is in baseline-relative coordinates.
      @return a <code>Shape</code> enclosing the selection.  This is in
          standard coordinates.
      @see #getLogicalRangesForVisualSelection(TextHitInfo, TextHitInfo)
      @see #getLogicalHighlightShape(int, int, Rectangle2D)</div>
<a id="L2178" name="L2178"></a>2178     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../S/2375.html#L2232" title="Referred from 2232 in src/java/awt/font/TextLayout.java.">getVisualHighlightShape</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> firstEndpoint,
<a id="L2179" name="L2179"></a>2179                                         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> secondEndpoint,
<a id="L2180" name="L2180"></a>2180                                         <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>)
<a id="L2181" name="L2181"></a>2181     <em class="brace">{</em>
<a id="L2182" name="L2182"></a>2182         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2183" name="L2183"></a>2183 
<a id="L2184" name="L2184"></a>2184         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(firstEndpoint);
<a id="L2185" name="L2185"></a>2185         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(secondEndpoint);
<a id="L2186" name="L2186"></a>2186 
<a id="L2187" name="L2187"></a>2187         <strong class="reserved">if</strong>(<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2188" name="L2188"></a>2188                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null Rectangle2D passed to TextLayout.getVisualHighlightShape()");
<a id="L2189" name="L2189"></a>2189         <em class="brace">}</em>
<a id="L2190" name="L2190"></a>2190 
<a id="L2191" name="L2191"></a>2191         <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>(<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>.WIND_EVEN_ODD);
<a id="L2192" name="L2192"></a>2192 
<a id="L2193" name="L2193"></a>2193         <strong class="reserved">int</strong> firstCaret = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(firstEndpoint);
<a id="L2194" name="L2194"></a>2194         <strong class="reserved">int</strong> secondCaret = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(secondEndpoint);
<a id="L2195" name="L2195"></a>2195 
<a id="L2196" name="L2196"></a>2196         <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/2375.html#L2003" title="Defined at 2003 in src/java/awt/font/TextLayout.java.">caretBoundingShape</a>(firstCaret, secondCaret, <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>),
<a id="L2197" name="L2197"></a>2197                       <strong class="reserved">false</strong>);
<a id="L2198" name="L2198"></a>2198 
<a id="L2199" name="L2199"></a>2199         <strong class="reserved">if</strong> (firstCaret == 0 || secondCaret == 0) <em class="brace">{</em>
<a id="L2200" name="L2200"></a>2200             <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> ls = <a href="../S/2375.html#L2022" title="Defined at 2022 in src/java/awt/font/TextLayout.java.">leftShape</a>(<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>);
<a id="L2201" name="L2201"></a>2201             <strong class="reserved">if</strong> (!ls.<a href="../D/17335.html" title="Multiple defined in 41 places.">getBounds</a>().<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>())
<a id="L2202" name="L2202"></a>2202                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ls, <strong class="reserved">false</strong>);
<a id="L2203" name="L2203"></a>2203         <em class="brace">}</em>
<a id="L2204" name="L2204"></a>2204 
<a id="L2205" name="L2205"></a>2205         <strong class="reserved">if</strong> (firstCaret == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a> || secondCaret == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L2206" name="L2206"></a>2206             <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> rs = <a href="../S/2375.html#L2044" title="Defined at 2044 in src/java/awt/font/TextLayout.java.">rightShape</a>(<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>);
<a id="L2207" name="L2207"></a>2207             <strong class="reserved">if</strong> (!rs.<a href="../D/17335.html" title="Multiple defined in 41 places.">getBounds</a>().<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L2208" name="L2208"></a>2208                 <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(rs, <strong class="reserved">false</strong>);
<a id="L2209" name="L2209"></a>2209             <em class="brace">}</em>
<a id="L2210" name="L2210"></a>2210         <em class="brace">}</em>
<a id="L2211" name="L2211"></a>2211 
<a id="L2212" name="L2212"></a>2212         LayoutPathImpl lp = textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>();
<a id="L2213" name="L2213"></a>2213         <strong class="reserved">if</strong> (lp != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2214" name="L2214"></a>2214             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>)lp.mapShape(<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>); <em class="comment">// dlf cast safe?</em>
<a id="L2215" name="L2215"></a>2215         <em class="brace">}</em>
<a id="L2216" name="L2216"></a>2216 
<a id="L2217" name="L2217"></a>2217         <strong class="reserved">return</strong>  <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2218" name="L2218"></a>2218     <em class="brace">}</em>
<a id="L2219" name="L2219"></a>2219 
<div class="comment">
      Returns a <code>Shape</code> enclosing the visual selection in the
      specified range, extended to the bounds.  This method is a
      convenience overload of <code>getVisualHighlightShape</code> that
      uses the natural bounds of this <code>TextLayout</code>.
      @param firstEndpoint one end of the visual selection
      @param secondEndpoint the other end of the visual selection
      @return a <code>Shape</code> enclosing the selection.  This is
          in standard coordinates.</div>
<a id="L2230" name="L2230"></a>2230     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../S/2375.html#L2232" title="Referred from 2232 in src/java/awt/font/TextLayout.java.">getVisualHighlightShape</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> firstEndpoint,
<a id="L2231" name="L2231"></a>2231                                              <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> secondEndpoint) <em class="brace">{</em>
<a id="L2232" name="L2232"></a>2232         <strong class="reserved">return</strong> <a href="../D/23632.html" title="Multiple defined in 2 places.">getVisualHighlightShape</a>(firstEndpoint, secondEndpoint, <a href="../S/2375.html#L735" title="Defined at 735 in src/java/awt/font/TextLayout.java.">getNaturalBounds</a>());
<a id="L2233" name="L2233"></a>2233     <em class="brace">}</em>
<a id="L2234" name="L2234"></a>2234 
<div class="comment">
      Returns a <code>Shape</code> enclosing the logical selection in the
      specified range, extended to the specified <code>bounds</code>.
      <p>
      If the selection range includes the first logical character, the
      selection is extended to the portion of <code>bounds</code> before
      the start of this <code>TextLayout</code>.  If the range includes
      the last logical character, the selection is extended to the portion
      of <code>bounds</code> after the end of this <code>TextLayout</code>.
      The height (width on vertical lines) of the selection is always
      extended to <code>bounds</code>.
      </p><p>
      The selection can be discontiguous on lines with mixed-direction text.
      Only those characters in the logical range between start and limit
      appear selected.  For example, consider the text 'ABCdef' where capital
      letters indicate right-to-left text, rendered on a right-to-left line,
      with a logical selection from 0 to 4 ('ABCd').  The text appears as
      follows, with bold standing in for the selection, and underlining for
      the extension:
      <br></p><pre>         <u><b>d</b></u>ef<u><b>CBA  </b></u>
      </pre>
      The selection is discontiguous because the selected characters are
      visually discontiguous. Also note that since the range includes the
      first logical character (A), the selection is extended to the portion
      of the <code>bounds</code> before the start of the layout, which in
      this case (a right-to-left line) is the right portion of the
      <code>bounds</code>.
      @param firstEndpoint an endpoint in the range of characters to select
      @param secondEndpoint the other endpoint of the range of characters
      to select. Can be less than <code>firstEndpoint</code>.  The range
      includes the character at min(firstEndpoint, secondEndpoint), but
      excludes max(firstEndpoint, secondEndpoint).
      @param bounds the bounding rectangle to which to extend the selection.
          This is in baseline-relative coordinates.
      @return an area enclosing the selection.  This is in standard
          coordinates.
      @see #getVisualHighlightShape(TextHitInfo, TextHitInfo, Rectangle2D)</div>
<a id="L2274" name="L2274"></a>2274     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../S/2375.html#L2372" title="Referred from 2372 in src/java/awt/font/TextLayout.java.">getLogicalHighlightShape</a>(<strong class="reserved">int</strong> firstEndpoint,
<a id="L2275" name="L2275"></a>2275                                          <strong class="reserved">int</strong> secondEndpoint,
<a id="L2276" name="L2276"></a>2276                                          <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L2277" name="L2277"></a>2277         <strong class="reserved">if</strong> (<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2278" name="L2278"></a>2278             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null Rectangle2D passed to TextLayout.getLogicalHighlightShape()");
<a id="L2279" name="L2279"></a>2279         <em class="brace">}</em>
<a id="L2280" name="L2280"></a>2280 
<a id="L2281" name="L2281"></a>2281         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2282" name="L2282"></a>2282 
<a id="L2283" name="L2283"></a>2283         <strong class="reserved">if</strong> (firstEndpoint &gt; secondEndpoint) <em class="brace">{</em>
<a id="L2284" name="L2284"></a>2284             <strong class="reserved">int</strong> t = firstEndpoint;
<a id="L2285" name="L2285"></a>2285             firstEndpoint = secondEndpoint;
<a id="L2286" name="L2286"></a>2286             secondEndpoint = t;
<a id="L2287" name="L2287"></a>2287         <em class="brace">}</em>
<a id="L2288" name="L2288"></a>2288 
<a id="L2289" name="L2289"></a>2289         <strong class="reserved">if</strong>(firstEndpoint &lt; 0 || secondEndpoint &gt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L2290" name="L2290"></a>2290             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Range is invalid in TextLayout.getLogicalHighlightShape()");
<a id="L2291" name="L2291"></a>2291         <em class="brace">}</em>
<a id="L2292" name="L2292"></a>2292 
<a id="L2293" name="L2293"></a>2293         <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>(<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>.WIND_EVEN_ODD);
<a id="L2294" name="L2294"></a>2294 
<a id="L2295" name="L2295"></a>2295         <strong class="reserved">int</strong>[] carets = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[10]; <em class="comment">// would this ever not handle all cases?</em>
<a id="L2296" name="L2296"></a>2296         <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L2297" name="L2297"></a>2297 
<a id="L2298" name="L2298"></a>2298         <strong class="reserved">if</strong> (firstEndpoint &lt; secondEndpoint) <em class="brace">{</em>
<a id="L2299" name="L2299"></a>2299             <strong class="reserved">int</strong> logIndex = firstEndpoint;
<a id="L2300" name="L2300"></a>2300             <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L2301" name="L2301"></a>2301                 carets[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(logIndex));
<a id="L2302" name="L2302"></a>2302                 <strong class="reserved">boolean</strong> ltr = textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(logIndex);
<a id="L2303" name="L2303"></a>2303 
<a id="L2304" name="L2304"></a>2304                 <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L2305" name="L2305"></a>2305                     logIndex++;
<a id="L2306" name="L2306"></a>2306                 <em class="brace">}</em> <strong class="reserved">while</strong> (logIndex &lt; secondEndpoint &amp;&amp; textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(logIndex) == ltr);
<a id="L2307" name="L2307"></a>2307 
<a id="L2308" name="L2308"></a>2308                 <strong class="reserved">int</strong> hitCh = logIndex;
<a id="L2309" name="L2309"></a>2309                 carets[<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>++] = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/35566.html" title="Multiple defined in 2 places.">trailing</a>(hitCh - 1));
<a id="L2310" name="L2310"></a>2310 
<a id="L2311" name="L2311"></a>2311                 <strong class="reserved">if</strong> (<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> == carets.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L2312" name="L2312"></a>2312                     <strong class="reserved">int</strong>[] temp = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[carets.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> + 10];
<a id="L2313" name="L2313"></a>2313                     <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(carets, 0, temp, 0, <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>);
<a id="L2314" name="L2314"></a>2314                     carets = temp;
<a id="L2315" name="L2315"></a>2315                 <em class="brace">}</em>
<a id="L2316" name="L2316"></a>2316             <em class="brace">}</em> <strong class="reserved">while</strong> (logIndex &lt; secondEndpoint);
<a id="L2317" name="L2317"></a>2317         <em class="brace">}</em>
<a id="L2318" name="L2318"></a>2318         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2319" name="L2319"></a>2319             <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 2;
<a id="L2320" name="L2320"></a>2320             carets[0] = carets[1] = <a href="../S/2375.html#L1333" title="Defined at 1333 in src/java/awt/font/TextLayout.java.">hitToCaret</a>(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(firstEndpoint));
<a id="L2321" name="L2321"></a>2321         <em class="brace">}</em>
<a id="L2322" name="L2322"></a>2322 
<a id="L2323" name="L2323"></a>2323         <em class="comment">// now create paths for pairs of carets</em>
<a id="L2324" name="L2324"></a>2324 
<a id="L2325" name="L2325"></a>2325         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>; i += 2) <em class="brace">{</em>
<a id="L2326" name="L2326"></a>2326             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<a href="../S/2375.html#L2003" title="Defined at 2003 in src/java/awt/font/TextLayout.java.">caretBoundingShape</a>(carets[i], carets[i+1], <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>),
<a id="L2327" name="L2327"></a>2327                           <strong class="reserved">false</strong>);
<a id="L2328" name="L2328"></a>2328         <em class="brace">}</em>
<a id="L2329" name="L2329"></a>2329 
<a id="L2330" name="L2330"></a>2330         <strong class="reserved">if</strong> (firstEndpoint != secondEndpoint) <em class="brace">{</em>
<a id="L2331" name="L2331"></a>2331             <strong class="reserved">if</strong> ((textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>() &amp;&amp; firstEndpoint == 0) || (!textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>() &amp;&amp;
<a id="L2332" name="L2332"></a>2332                                                                       secondEndpoint == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>)) <em class="brace">{</em>
<a id="L2333" name="L2333"></a>2333                 <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> ls = <a href="../S/2375.html#L2022" title="Defined at 2022 in src/java/awt/font/TextLayout.java.">leftShape</a>(<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>);
<a id="L2334" name="L2334"></a>2334                 <strong class="reserved">if</strong> (!ls.<a href="../D/17335.html" title="Multiple defined in 41 places.">getBounds</a>().<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L2335" name="L2335"></a>2335                     <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(ls, <strong class="reserved">false</strong>);
<a id="L2336" name="L2336"></a>2336                 <em class="brace">}</em>
<a id="L2337" name="L2337"></a>2337             <em class="brace">}</em>
<a id="L2338" name="L2338"></a>2338 
<a id="L2339" name="L2339"></a>2339             <strong class="reserved">if</strong> ((textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>() &amp;&amp; secondEndpoint == <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) ||
<a id="L2340" name="L2340"></a>2340                 (!textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>() &amp;&amp; firstEndpoint == 0)) <em class="brace">{</em>
<a id="L2341" name="L2341"></a>2341 
<a id="L2342" name="L2342"></a>2342                 <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> rs = <a href="../S/2375.html#L2044" title="Defined at 2044 in src/java/awt/font/TextLayout.java.">rightShape</a>(<a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>);
<a id="L2343" name="L2343"></a>2343                 <strong class="reserved">if</strong> (!rs.<a href="../D/17335.html" title="Multiple defined in 41 places.">getBounds</a>().<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L2344" name="L2344"></a>2344                     <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(rs, <strong class="reserved">false</strong>);
<a id="L2345" name="L2345"></a>2345                 <em class="brace">}</em>
<a id="L2346" name="L2346"></a>2346             <em class="brace">}</em>
<a id="L2347" name="L2347"></a>2347         <em class="brace">}</em>
<a id="L2348" name="L2348"></a>2348 
<a id="L2349" name="L2349"></a>2349         LayoutPathImpl lp = textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>();
<a id="L2350" name="L2350"></a>2350         <strong class="reserved">if</strong> (lp != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2351" name="L2351"></a>2351             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>)lp.mapShape(<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>); <em class="comment">// dlf cast safe?</em>
<a id="L2352" name="L2352"></a>2352         <em class="brace">}</em>
<a id="L2353" name="L2353"></a>2353         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2354" name="L2354"></a>2354     <em class="brace">}</em>
<a id="L2355" name="L2355"></a>2355 
<div class="comment">
      Returns a <code>Shape</code> enclosing the logical selection in the
      specified range, extended to the natural bounds of this
      <code>TextLayout</code>.  This method is a convenience overload of
      <code>getLogicalHighlightShape</code> that uses the natural bounds of
      this <code>TextLayout</code>.
      @param firstEndpoint an endpoint in the range of characters to select
      @param secondEndpoint the other endpoint of the range of characters
      to select. Can be less than <code>firstEndpoint</code>.  The range
      includes the character at min(firstEndpoint, secondEndpoint), but
      excludes max(firstEndpoint, secondEndpoint).
      @return a <code>Shape</code> enclosing the selection.  This is in
          standard coordinates.</div>
<a id="L2370" name="L2370"></a>2370     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../S/2375.html#L2372" title="Referred from 2372 in src/java/awt/font/TextLayout.java.">getLogicalHighlightShape</a>(<strong class="reserved">int</strong> firstEndpoint, <strong class="reserved">int</strong> secondEndpoint) <em class="brace">{</em>
<a id="L2371" name="L2371"></a>2371 
<a id="L2372" name="L2372"></a>2372         <strong class="reserved">return</strong> <a href="../D/20274.html" title="Multiple defined in 2 places.">getLogicalHighlightShape</a>(firstEndpoint, secondEndpoint, <a href="../S/2375.html#L735" title="Defined at 735 in src/java/awt/font/TextLayout.java.">getNaturalBounds</a>());
<a id="L2373" name="L2373"></a>2373     <em class="brace">}</em>
<a id="L2374" name="L2374"></a>2374 
<div class="comment">
      Returns the black box bounds of the characters in the specified range.
      The black box bounds is an area consisting of the union of the bounding
      boxes of all the glyphs corresponding to the characters between start
      and limit.  This area can be disjoint.
      @param firstEndpoint one end of the character range
      @param secondEndpoint the other end of the character range.  Can be
      less than <code>firstEndpoint</code>.
      @return a <code>Shape</code> enclosing the black box bounds.  This is
          in standard coordinates.</div>
<a id="L2386" name="L2386"></a>2386     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> getBlackBoxBounds(<strong class="reserved">int</strong> firstEndpoint, <strong class="reserved">int</strong> secondEndpoint) <em class="brace">{</em>
<a id="L2387" name="L2387"></a>2387         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2388" name="L2388"></a>2388 
<a id="L2389" name="L2389"></a>2389         <strong class="reserved">if</strong> (firstEndpoint &gt; secondEndpoint) <em class="brace">{</em>
<a id="L2390" name="L2390"></a>2390             <strong class="reserved">int</strong> t = firstEndpoint;
<a id="L2391" name="L2391"></a>2391             firstEndpoint = secondEndpoint;
<a id="L2392" name="L2392"></a>2392             secondEndpoint = t;
<a id="L2393" name="L2393"></a>2393         <em class="brace">}</em>
<a id="L2394" name="L2394"></a>2394 
<a id="L2395" name="L2395"></a>2395         <strong class="reserved">if</strong> (firstEndpoint &lt; 0 || secondEndpoint &gt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L2396" name="L2396"></a>2396             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Invalid range passed to TextLayout.getBlackBoxBounds()");
<a id="L2397" name="L2397"></a>2397         <em class="brace">}</em>
<a id="L2398" name="L2398"></a>2398 
<div class="comment">
          return an area that consists of the bounding boxes of all the
          characters from firstEndpoint to limit</div>
<a id="L2403" name="L2403"></a>2403 
<a id="L2404" name="L2404"></a>2404         <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <strong class="reserved">new</strong> <a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>(<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>.WIND_NON_ZERO);
<a id="L2405" name="L2405"></a>2405 
<a id="L2406" name="L2406"></a>2406         <strong class="reserved">if</strong> (firstEndpoint &lt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>) <em class="brace">{</em>
<a id="L2407" name="L2407"></a>2407             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> logIndex = firstEndpoint;
<a id="L2408" name="L2408"></a>2408                         logIndex &lt; secondEndpoint;
<a id="L2409" name="L2409"></a>2409                         logIndex++) <em class="brace">{</em>
<a id="L2410" name="L2410"></a>2410 
<a id="L2411" name="L2411"></a>2411                 <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> r = textLine.<a href="../S/2362.html#L735" title="Defined at 735 in src/java/awt/font/TextLine.java.">getCharBounds</a>(logIndex);
<a id="L2412" name="L2412"></a>2412                 <strong class="reserved">if</strong> (!r.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L2413" name="L2413"></a>2413                     <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(r, <strong class="reserved">false</strong>);
<a id="L2414" name="L2414"></a>2414                 <em class="brace">}</em>
<a id="L2415" name="L2415"></a>2415             <em class="brace">}</em>
<a id="L2416" name="L2416"></a>2416         <em class="brace">}</em>
<a id="L2417" name="L2417"></a>2417 
<a id="L2418" name="L2418"></a>2418         <strong class="reserved">if</strong> (dx != 0 || dy != 0) <em class="brace">{</em>
<a id="L2419" name="L2419"></a>2419             <a href="../S/2328.html#L114" title="Defined at 114 in src/java/awt/geom/AffineTransform.java.">AffineTransform</a> tx = <a href="../S/2328.html#L114" title="Defined at 114 in src/java/awt/geom/AffineTransform.java.">AffineTransform</a>.<a href="../S/2328.html#L615" title="Defined at 615 in src/java/awt/geom/AffineTransform.java.">getTranslateInstance</a>(dx, dy);
<a id="L2420" name="L2420"></a>2420             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>)tx.<a href="../D/14265.html" title="Multiple defined in 2 places.">createTransformedShape</a>(<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>);
<a id="L2421" name="L2421"></a>2421         <em class="brace">}</em>
<a id="L2422" name="L2422"></a>2422         LayoutPathImpl lp = textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>();
<a id="L2423" name="L2423"></a>2423         <strong class="reserved">if</strong> (lp != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2424" name="L2424"></a>2424             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = (<a href="../S/2315.html#L51" title="Defined at 51 in src/java/awt/geom/GeneralPath.java.">GeneralPath</a>)lp.mapShape(<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>);
<a id="L2425" name="L2425"></a>2425         <em class="brace">}</em>
<a id="L2426" name="L2426"></a>2426 
<a id="L2427" name="L2427"></a>2427         <em class="comment">//return new Highlight(result, false);</em>
<a id="L2428" name="L2428"></a>2428         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2429" name="L2429"></a>2429     <em class="brace">}</em>
<a id="L2430" name="L2430"></a>2430 
<div class="comment">
      Returns the distance from the point (x,&nbsp;y) to the caret along
      the line direction defined in <code>caretInfo</code>.  Distance is
      negative if the point is to the left of the caret on a horizontal
      line, or above the caret on a vertical line.
      Utility for use by hitTestChar.</div>
<a id="L2438" name="L2438"></a>2438     <strong class="reserved">private</strong> <strong class="reserved">float</strong> caretToPointDistance(<strong class="reserved">float</strong>[] caretInfo, <strong class="reserved">float</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">float</strong> y) <em class="brace">{</em>
<a id="L2439" name="L2439"></a>2439         <em class="comment">// distanceOffBaseline is negative if you're 'above' baseline</em>
<a id="L2440" name="L2440"></a>2440 
<a id="L2441" name="L2441"></a>2441         <strong class="reserved">float</strong> lineDistance = isVerticalLine? y : <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L2442" name="L2442"></a>2442         <strong class="reserved">float</strong> distanceOffBaseline = isVerticalLine? -<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> : y;
<a id="L2443" name="L2443"></a>2443 
<a id="L2444" name="L2444"></a>2444         <strong class="reserved">return</strong> lineDistance - caretInfo[0] +
<a id="L2445" name="L2445"></a>2445             (distanceOffBaseline*caretInfo[1]);
<a id="L2446" name="L2446"></a>2446     <em class="brace">}</em>
<a id="L2447" name="L2447"></a>2447 
<div class="comment">
      Returns a <code>TextHitInfo</code> corresponding to the
      specified point.
      Coordinates outside the bounds of the <code>TextLayout</code>
      map to hits on the leading edge of the first logical character,
      or the trailing edge of the last logical character, as appropriate,
      regardless of the position of that character in the line.  Only the
      direction along the baseline is used to make this evaluation.
      @param x the x offset from the origin of this
          <code>TextLayout</code>.  This is in standard coordinates.
      @param y the y offset from the origin of this
          <code>TextLayout</code>.  This is in standard coordinates.
      @param bounds the bounds of the <code>TextLayout</code>.  This
          is in baseline-relative coordinates.
      @return a hit describing the character and edge (leading or trailing)
          under the specified point.</div>
<a id="L2465" name="L2465"></a>2465     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/20341.html" title="Multiple referred from 4 places.">hitTestChar</a>(<strong class="reserved">float</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">float</strong> y, <a href="../S/2335.html#L43" title="Defined at 43 in src/java/awt/geom/Rectangle2D.java.">Rectangle2D</a> <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>) <em class="brace">{</em>
<a id="L2466" name="L2466"></a>2466         <em class="comment">// check boundary conditions</em>
<a id="L2467" name="L2467"></a>2467 
<a id="L2468" name="L2468"></a>2468         LayoutPathImpl lp = textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>();
<a id="L2469" name="L2469"></a>2469         <strong class="reserved">boolean</strong> prev = <strong class="reserved">false</strong>;
<a id="L2470" name="L2470"></a>2470         <strong class="reserved">if</strong> (lp != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2471" name="L2471"></a>2471             <a href="../S/2319.html#L42" title="Defined at 42 in src/java/awt/geom/Point2D.java.">Point2D</a>.<a href="../D/3293.html" title="Multiple defined in 10 places.">Float</a> pt = <strong class="reserved">new</strong> <a href="../S/2319.html#L42" title="Defined at 42 in src/java/awt/geom/Point2D.java.">Point2D</a>.<a href="../D/3293.html" title="Multiple defined in 10 places.">Float</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y);
<a id="L2472" name="L2472"></a>2472             prev = lp.<a href="../S/2361.html#L61" title="Defined at 61 in src/java/awt/font/LayoutPath.java.">pointToPath</a>(pt, pt);
<a id="L2473" name="L2473"></a>2473             <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> = pt.<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L2474" name="L2474"></a>2474             y = pt.y;
<a id="L2475" name="L2475"></a>2475         <em class="brace">}</em>
<a id="L2476" name="L2476"></a>2476 
<a id="L2477" name="L2477"></a>2477         <strong class="reserved">if</strong> (<a href="../S/2375.html#L1042" title="Defined at 1042 in src/java/awt/font/TextLayout.java.">isVertical</a>()) <em class="brace">{</em>
<a id="L2478" name="L2478"></a>2478             <strong class="reserved">if</strong> (y &lt; <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/20652.html" title="Multiple defined in 6 places.">getMinY</a>()) <em class="brace">{</em>
<a id="L2479" name="L2479"></a>2479                 <strong class="reserved">return</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(0);
<a id="L2480" name="L2480"></a>2480             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (y &gt;= <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../S/2330.html#L137" title="Defined at 137 in src/java/awt/geom/RectangularShape.java.">getMaxY</a>()) <em class="brace">{</em>
<a id="L2481" name="L2481"></a>2481                 <strong class="reserved">return</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/35566.html" title="Multiple defined in 2 places.">trailing</a>(<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>-1);
<a id="L2482" name="L2482"></a>2482             <em class="brace">}</em>
<a id="L2483" name="L2483"></a>2483         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2484" name="L2484"></a>2484             <strong class="reserved">if</strong> (<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &lt; <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../D/20651.html" title="Multiple defined in 6 places.">getMinX</a>()) <em class="brace">{</em>
<a id="L2485" name="L2485"></a>2485                 <strong class="reserved">return</strong> <a href="../D/25785.html" title="Multiple defined in 18 places.">isLeftToRight</a>() ? <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(0) : <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/35566.html" title="Multiple defined in 2 places.">trailing</a>(<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>-1);
<a id="L2486" name="L2486"></a>2486             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &gt;= <a href="../D/11902.html" title="Multiple defined in 2 places.">bounds</a>.<a href="../S/2330.html#L125" title="Defined at 125 in src/java/awt/geom/RectangularShape.java.">getMaxX</a>()) <em class="brace">{</em>
<a id="L2487" name="L2487"></a>2487                 <strong class="reserved">return</strong> <a href="../D/25785.html" title="Multiple defined in 18 places.">isLeftToRight</a>() ? <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/35566.html" title="Multiple defined in 2 places.">trailing</a>(<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>-1) : <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(0);
<a id="L2488" name="L2488"></a>2488             <em class="brace">}</em>
<a id="L2489" name="L2489"></a>2489         <em class="brace">}</em>
<a id="L2490" name="L2490"></a>2490 
<a id="L2491" name="L2491"></a>2491         <em class="comment">// revised hit test</em>
<a id="L2492" name="L2492"></a>2492         <em class="comment">// the original seems too complex and fails miserably with italic offsets</em>
<a id="L2493" name="L2493"></a>2493         <em class="comment">// the natural tendency is to move towards the character you want to hit</em>
<a id="L2494" name="L2494"></a>2494         <em class="comment">// so we'll just measure distance to the center of each character's visual</em>
<a id="L2495" name="L2495"></a>2495         <em class="comment">// bounds, pick the closest one, then see which side of the character's</em>
<a id="L2496" name="L2496"></a>2496         <em class="comment">// center line (italic) the point is on.</em>
<a id="L2497" name="L2497"></a>2497         <em class="comment">// this tends to make it easier to hit narrow characters, which can be a</em>
<a id="L2498" name="L2498"></a>2498         <em class="comment">// bit odd if you're visually over an adjacent wide character. this makes</em>
<a id="L2499" name="L2499"></a>2499         <em class="comment">// a difference with bidi, so perhaps i need to revisit this yet again.</em>
<a id="L2500" name="L2500"></a>2500 
<a id="L2501" name="L2501"></a>2501         <strong class="reserved">double</strong> <a href="../D/14975.html" title="Multiple defined in 4 places.">distance</a> = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.MAX_VALUE;
<a id="L2502" name="L2502"></a>2502         <strong class="reserved">int</strong> <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = 0;
<a id="L2503" name="L2503"></a>2503         <strong class="reserved">int</strong> trail = -1;
<a id="L2504" name="L2504"></a>2504         CoreMetrics lcm = <strong class="reserved">null</strong>;
<a id="L2505" name="L2505"></a>2505         <strong class="reserved">float</strong> icx = 0, icy = 0, ia = 0, cy = 0, dya = 0, ydsq = 0;
<a id="L2506" name="L2506"></a>2506 
<a id="L2507" name="L2507"></a>2507         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>; ++i) <em class="brace">{</em>
<a id="L2508" name="L2508"></a>2508             <strong class="reserved">if</strong> (!textLine.<a href="../S/2362.html#L688" title="Defined at 688 in src/java/awt/font/TextLine.java.">caretAtOffsetIsValid</a>(i)) <em class="brace">{</em>
<a id="L2509" name="L2509"></a>2509                 <strong class="reserved">continue</strong>;
<a id="L2510" name="L2510"></a>2510             <em class="brace">}</em>
<a id="L2511" name="L2511"></a>2511             <strong class="reserved">if</strong> (trail == -1) <em class="brace">{</em>
<a id="L2512" name="L2512"></a>2512                 trail = i;
<a id="L2513" name="L2513"></a>2513             <em class="brace">}</em>
<a id="L2514" name="L2514"></a>2514             CoreMetrics cm = textLine.<a href="../S/2362.html#L600" title="Defined at 600 in src/java/awt/font/TextLine.java.">getCoreMetricsAt</a>(i);
<a id="L2515" name="L2515"></a>2515             <strong class="reserved">if</strong> (cm != lcm) <em class="brace">{</em>
<a id="L2516" name="L2516"></a>2516                 lcm = cm;
<a id="L2517" name="L2517"></a>2517                 <em class="comment">// just work around baseline mess for now</em>
<a id="L2518" name="L2518"></a>2518                 <strong class="reserved">if</strong> (cm.baselineIndex == <a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a>.TOP_ALIGNMENT) <em class="brace">{</em>
<a id="L2519" name="L2519"></a>2519                     cy = -(textLine.<a href="../S/2362.html#L547" title="Defined at 547 in src/java/awt/font/TextLine.java.">getMetrics</a>().ascent - cm.ascent) + cm.ssOffset;
<a id="L2520" name="L2520"></a>2520                 <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (cm.baselineIndex == <a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a>.BOTTOM_ALIGNMENT) <em class="brace">{</em>
<a id="L2521" name="L2521"></a>2521                     cy = textLine.<a href="../S/2362.html#L547" title="Defined at 547 in src/java/awt/font/TextLine.java.">getMetrics</a>().descent - cm.descent + cm.ssOffset;
<a id="L2522" name="L2522"></a>2522                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2523" name="L2523"></a>2523                     cy = cm.effectiveBaselineOffset(baselineOffsets) + cm.ssOffset;
<a id="L2524" name="L2524"></a>2524                 <em class="brace">}</em>
<a id="L2525" name="L2525"></a>2525                 <strong class="reserved">float</strong> dy = (cm.descent - cm.ascent) / 2 - cy;
<a id="L2526" name="L2526"></a>2526                 dya = dy * cm.italicAngle;
<a id="L2527" name="L2527"></a>2527                 cy += dy;
<a id="L2528" name="L2528"></a>2528                 ydsq = (cy - y)*(cy - y);
<a id="L2529" name="L2529"></a>2529             <em class="brace">}</em>
<a id="L2530" name="L2530"></a>2530             <strong class="reserved">float</strong> cx = textLine.<a href="../S/2362.html#L668" title="Defined at 668 in src/java/awt/font/TextLine.java.">getCharXPosition</a>(i);
<a id="L2531" name="L2531"></a>2531             <strong class="reserved">float</strong> ca = textLine.<a href="../S/2362.html#L663" title="Defined at 663 in src/java/awt/font/TextLine.java.">getCharAdvance</a>(i);
<a id="L2532" name="L2532"></a>2532             <strong class="reserved">float</strong> dx = ca / 2;
<a id="L2533" name="L2533"></a>2533             cx += dx - dya;
<a id="L2534" name="L2534"></a>2534 
<a id="L2535" name="L2535"></a>2535             <em class="comment">// proximity in x (along baseline) is two times as important as proximity in y</em>
<a id="L2536" name="L2536"></a>2536             <strong class="reserved">double</strong> nd = <a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/34735.html" title="Multiple defined in 3 places.">sqrt</a>(4*(cx - <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>)*(cx - <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) + ydsq);
<a id="L2537" name="L2537"></a>2537             <strong class="reserved">if</strong> (nd &lt; <a href="../D/14975.html" title="Multiple defined in 4 places.">distance</a>) <em class="brace">{</em>
<a id="L2538" name="L2538"></a>2538                 <a href="../D/14975.html" title="Multiple defined in 4 places.">distance</a> = nd;
<a id="L2539" name="L2539"></a>2539                 <a href="../D/24461.html" title="Multiple defined in 6 places.">index</a> = i;
<a id="L2540" name="L2540"></a>2540                 trail = -1;
<a id="L2541" name="L2541"></a>2541                 icx = cx; icy = cy; ia = cm.italicAngle;
<a id="L2542" name="L2542"></a>2542             <em class="brace">}</em>
<a id="L2543" name="L2543"></a>2543         <em class="brace">}</em>
<a id="L2544" name="L2544"></a>2544         <strong class="reserved">boolean</strong> left = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> &lt; icx - (y - icy) * ia;
<a id="L2545" name="L2545"></a>2545         <strong class="reserved">boolean</strong> <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a> = textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) == left;
<a id="L2546" name="L2546"></a>2546         <strong class="reserved">if</strong> (trail == -1) <em class="brace">{</em>
<a id="L2547" name="L2547"></a>2547             trail = <a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>;
<a id="L2548" name="L2548"></a>2548         <em class="brace">}</em>
<a id="L2549" name="L2549"></a>2549         <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a> ? <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>(<a href="../D/24461.html" title="Multiple defined in 6 places.">index</a>) :
<a id="L2550" name="L2550"></a>2550             <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a>.<a href="../D/35566.html" title="Multiple defined in 2 places.">trailing</a>(trail-1);
<a id="L2551" name="L2551"></a>2551         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2552" name="L2552"></a>2552     <em class="brace">}</em>
<a id="L2553" name="L2553"></a>2553 
<div class="comment">
      Returns a <code>TextHitInfo</code> corresponding to the
      specified point.  This method is a convenience overload of
      <code>hitTestChar</code> that uses the natural bounds of this
      <code>TextLayout</code>.
      @param x the x offset from the origin of this
          <code>TextLayout</code>.  This is in standard coordinates.
      @param y the y offset from the origin of this
          <code>TextLayout</code>.  This is in standard coordinates.
      @return a hit describing the character and edge (leading or trailing)
      under the specified point.</div>
<a id="L2566" name="L2566"></a>2566     <strong class="reserved">public</strong> <a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../R/20341.html" title="Multiple referred from 4 places.">hitTestChar</a>(<strong class="reserved">float</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">float</strong> y) <em class="brace">{</em>
<a id="L2567" name="L2567"></a>2567 
<a id="L2568" name="L2568"></a>2568         <strong class="reserved">return</strong> <a href="../D/24268.html" title="Multiple defined in 2 places.">hitTestChar</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, y, <a href="../S/2375.html#L735" title="Defined at 735 in src/java/awt/font/TextLayout.java.">getNaturalBounds</a>());
<a id="L2569" name="L2569"></a>2569     <em class="brace">}</em>
<a id="L2570" name="L2570"></a>2570 
<div class="comment">
      Returns the hash code of this <code>TextLayout</code>.
      @return the hash code of this <code>TextLayout</code>.</div>
<a id="L2575" name="L2575"></a>2575     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/20298.html" title="Multiple referred from 715 places.">hashCode</a>() <em class="brace">{</em>
<a id="L2576" name="L2576"></a>2576         <strong class="reserved">if</strong> (hashCodeCache == 0) <em class="brace">{</em>
<a id="L2577" name="L2577"></a>2577             <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2578" name="L2578"></a>2578             hashCodeCache = textLine.<a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>();
<a id="L2579" name="L2579"></a>2579         <em class="brace">}</em>
<a id="L2580" name="L2580"></a>2580         <strong class="reserved">return</strong> hashCodeCache;
<a id="L2581" name="L2581"></a>2581     <em class="brace">}</em>
<a id="L2582" name="L2582"></a>2582 
<div class="comment">
      Returns <code>true</code> if the specified <code>Object</code> is a
      <code>TextLayout</code> object and if the specified <code>Object</code>
      equals this <code>TextLayout</code>.
      @param obj an <code>Object</code> to test for equality
      @return <code>true</code> if the specified <code>Object</code>
           equals this <code>TextLayout</code>; <code>false</code>
           otherwise.</div>
<a id="L2592" name="L2592"></a>2592     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13992.html" title="Multiple referred from 5400 places.">equals</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> obj) <em class="brace">{</em>
<a id="L2593" name="L2593"></a>2593         <strong class="reserved">return</strong> (obj <strong class="reserved">instanceof</strong> <a href="../S/2375.html#L239" title="Defined at 239 in src/java/awt/font/TextLayout.java.">TextLayout</a>) &amp;&amp; <a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>((<a href="../S/2375.html#L239" title="Defined at 239 in src/java/awt/font/TextLayout.java.">TextLayout</a>)obj);
<a id="L2594" name="L2594"></a>2594     <em class="brace">}</em>
<a id="L2595" name="L2595"></a>2595 
<div class="comment">
      Returns <code>true</code> if the two layouts are equal.
      Two layouts are equal if they contain equal glyphvectors in the same order.
      @param rhs the <code>TextLayout</code> to compare to this
            <code>TextLayout</code>
      @return <code>true</code> if the specified <code>TextLayout</code>
           equals this <code>TextLayout</code>.</div>
<a id="L2605" name="L2605"></a>2605     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13992.html" title="Multiple referred from 5400 places.">equals</a>(<a href="../S/2375.html#L239" title="Defined at 239 in src/java/awt/font/TextLayout.java.">TextLayout</a> rhs) <em class="brace">{</em>
<a id="L2606" name="L2606"></a>2606 
<a id="L2607" name="L2607"></a>2607         <strong class="reserved">if</strong> (rhs == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2608" name="L2608"></a>2608             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L2609" name="L2609"></a>2609         <em class="brace">}</em>
<a id="L2610" name="L2610"></a>2610         <strong class="reserved">if</strong> (rhs == <strong class="reserved">this</strong>) <em class="brace">{</em>
<a id="L2611" name="L2611"></a>2611             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L2612" name="L2612"></a>2612         <em class="brace">}</em>
<a id="L2613" name="L2613"></a>2613 
<a id="L2614" name="L2614"></a>2614         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2615" name="L2615"></a>2615         <strong class="reserved">return</strong> textLine.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(rhs.textLine);
<a id="L2616" name="L2616"></a>2616     <em class="brace">}</em>
<a id="L2617" name="L2617"></a>2617 
<div class="comment">
      Returns debugging information for this <code>TextLayout</code>.
      @return the <code>textLine</code> of this <code>TextLayout</code>
             as a <code>String</code>.</div>
<a id="L2623" name="L2623"></a>2623     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L2624" name="L2624"></a>2624         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2625" name="L2625"></a>2625         <strong class="reserved">return</strong> textLine.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L2626" name="L2626"></a>2626      <em class="brace">}</em>
<a id="L2627" name="L2627"></a>2627 
<div class="comment">
      Renders this <code>TextLayout</code> at the specified location in
      the specified {@link java.awt.Graphics2D Graphics2D} context.
      The origin of the layout is placed at x,&nbsp;y.  Rendering may touch
      any point within <code>getBounds()</code> of this position.  This
      leaves the <code>g2</code> unchanged.  Text is rendered along the
      baseline path.
      @param g2 the <code>Graphics2D</code> context into which to render
              the layout
      @param x the X coordinate of the origin of this <code>TextLayout</code>
      @param y the Y coordinate of the origin of this <code>TextLayout</code>
      @see #getBounds()</div>
<a id="L2641" name="L2641"></a>2641     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/13517.html" title="Multiple referred from 13 places.">draw</a>(<a href="../S/2098.html#L407" title="Defined at 407 in src/java/awt/Graphics2D.java.">Graphics2D</a> g2, <strong class="reserved">float</strong> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <strong class="reserved">float</strong> y) <em class="brace">{</em>
<a id="L2642" name="L2642"></a>2642 
<a id="L2643" name="L2643"></a>2643         <strong class="reserved">if</strong> (g2 == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2644" name="L2644"></a>2644             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Null Graphics2D passed to TextLayout.draw()");
<a id="L2645" name="L2645"></a>2645         <em class="brace">}</em>
<a id="L2646" name="L2646"></a>2646 
<a id="L2647" name="L2647"></a>2647         textLine.<a href="../D/15161.html" title="Multiple defined in 7 places.">draw</a>(g2, <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a> - dx, y - dy);
<a id="L2648" name="L2648"></a>2648     <em class="brace">}</em>
<a id="L2649" name="L2649"></a>2649 
<div class="comment">
      Package-only method for testing ONLY.  Please don't abuse.</div>
<a id="L2653" name="L2653"></a>2653     <a href="../S/2362.html#L67" title="Defined at 67 in src/java/awt/font/TextLine.java.">TextLine</a> getTextLineForTesting() <em class="brace">{</em>
<a id="L2654" name="L2654"></a>2654 
<a id="L2655" name="L2655"></a>2655         <strong class="reserved">return</strong> textLine;
<a id="L2656" name="L2656"></a>2656     <em class="brace">}</em>
<a id="L2657" name="L2657"></a>2657 
<div class="comment">
      Return the index of the first character with a different baseline from the
      character at start, or limit if all characters between start and limit have
      the same baseline.</div>
<a id="L2664" name="L2664"></a>2664     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> <a href="../R/26580.html" title="Multiple referred from 2 places.">sameBaselineUpTo</a>(<a href="../S/2176.html#L224" title="Defined at 224 in src/java/awt/Font.java.">Font</a> font, <strong class="reserved">char</strong>[] <a href="../D/35255.html" title="Multiple defined in 4 places.">text</a>,
<a id="L2665" name="L2665"></a>2665                                         <strong class="reserved">int</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>, <strong class="reserved">int</strong> <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>) <em class="brace">{</em>
<a id="L2666" name="L2666"></a>2666         <em class="comment">// current implementation doesn't support multiple baselines</em>
<a id="L2667" name="L2667"></a>2667         <strong class="reserved">return</strong> <a href="../D/26840.html" title="Multiple defined in 12 places.">limit</a>;
<div class="comment">
        byte bl = font.getBaselineFor(text[start++]);
        while (start &lt; limit &amp;&amp; font.getBaselineFor(text[start]) == bl) {
            ++start;
        }
        return start;</div>
<a id="L2675" name="L2675"></a>2675     <em class="brace">}</em>
<a id="L2676" name="L2676"></a>2676 
<a id="L2677" name="L2677"></a>2677     <strong class="reserved">static</strong> <strong class="reserved">byte</strong> <a href="../R/15237.html" title="Multiple referred from 2 places.">getBaselineFromGraphic</a>(<a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a> graphic) <em class="brace">{</em>
<a id="L2678" name="L2678"></a>2678 
<a id="L2679" name="L2679"></a>2679         <strong class="reserved">byte</strong> alignment = (<strong class="reserved">byte</strong>) graphic.<a href="../D/16863.html" title="Multiple defined in 22 places.">getAlignment</a>();
<a id="L2680" name="L2680"></a>2680 
<a id="L2681" name="L2681"></a>2681         <strong class="reserved">if</strong> (alignment == <a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a>.BOTTOM_ALIGNMENT ||
<a id="L2682" name="L2682"></a>2682                 alignment == <a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a>.TOP_ALIGNMENT) <em class="brace">{</em>
<a id="L2683" name="L2683"></a>2683 
<a id="L2684" name="L2684"></a>2684             <strong class="reserved">return</strong> (<strong class="reserved">byte</strong>)<a href="../S/2369.html#L64" title="Defined at 64 in src/java/awt/font/GraphicAttribute.java.">GraphicAttribute</a>.ROMAN_BASELINE;
<a id="L2685" name="L2685"></a>2685         <em class="brace">}</em>
<a id="L2686" name="L2686"></a>2686         <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2687" name="L2687"></a>2687             <strong class="reserved">return</strong> alignment;
<a id="L2688" name="L2688"></a>2688         <em class="brace">}</em>
<a id="L2689" name="L2689"></a>2689     <em class="brace">}</em>
<a id="L2690" name="L2690"></a>2690 
<div class="comment">
      Returns a <code>Shape</code> representing the outline of this
      <code>TextLayout</code>.
      @param tx an optional <a href="../S/2328.html#L114" title="Defined at 114 in src/java/awt/geom/AffineTransform.java.">AffineTransform</a> to apply to the
          outline of this <code>TextLayout</code>.
      @return a <code>Shape</code> that is the outline of this
          <code>TextLayout</code>.  This is in standard coordinates.</div>
<a id="L2699" name="L2699"></a>2699     <strong class="reserved">public</strong> <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../R/18181.html" title="Multiple referred from 2 places.">getOutline</a>(<a href="../S/2328.html#L114" title="Defined at 114 in src/java/awt/geom/AffineTransform.java.">AffineTransform</a> tx) <em class="brace">{</em>
<a id="L2700" name="L2700"></a>2700         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2701" name="L2701"></a>2701         <a href="../S/2445.html#L78" title="Defined at 78 in src/java/awt/Shape.java.">Shape</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = textLine.<a href="../D/21264.html" title="Multiple defined in 7 places.">getOutline</a>(tx);
<a id="L2702" name="L2702"></a>2702         LayoutPathImpl lp = textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>();
<a id="L2703" name="L2703"></a>2703         <strong class="reserved">if</strong> (lp != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2704" name="L2704"></a>2704             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = lp.mapShape(<a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>);
<a id="L2705" name="L2705"></a>2705         <em class="brace">}</em>
<a id="L2706" name="L2706"></a>2706         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a>;
<a id="L2707" name="L2707"></a>2707     <em class="brace">}</em>
<a id="L2708" name="L2708"></a>2708 
<div class="comment">
      Return the LayoutPath, or null if the layout path is the
      default path (x maps to advance, y maps to offset).
      @return the layout path
      @since 1.6</div>
<a id="L2715" name="L2715"></a>2715     <strong class="reserved">public</strong> <a href="../S/2361.html#L43" title="Defined at 43 in src/java/awt/font/LayoutPath.java.">LayoutPath</a> <a href="../R/17305.html" title="Multiple referred from 9 places.">getLayoutPath</a>() <em class="brace">{</em>
<a id="L2716" name="L2716"></a>2716         <strong class="reserved">return</strong> textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>();
<a id="L2717" name="L2717"></a>2717     <em class="brace">}</em>
<a id="L2718" name="L2718"></a>2718 
<div class="comment">
      Convert a hit to a point in standard coordinates.  The point is
      on the baseline of the character at the leading or trailing
      edge of the character, as appropriate.  If the path is
      broken at the side of the character represented by the hit, the
      point will be adjacent to the character.
      @param hit the hit to check.  This must be a valid hit on
      the TextLayout.
      @param point the returned point. The point is in standard
          coordinates.
      @throws IllegalArgumentException if the hit is not valid for the
      TextLayout.
      @throws NullPointerException if hit or point is null.
      @since 1.6</div>
<a id="L2734" name="L2734"></a>2734     <strong class="reserved">public</strong> <strong class="reserved">void</strong> hitToPoint(<a href="../S/2364.html#L88" title="Defined at 88 in src/java/awt/font/TextHitInfo.java.">TextHitInfo</a> <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>, <a href="../S/2319.html#L42" title="Defined at 42 in src/java/awt/geom/Point2D.java.">Point2D</a> point) <em class="brace">{</em>
<a id="L2735" name="L2735"></a>2735         <strong class="reserved">if</strong> (<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a> == <strong class="reserved">null</strong> || point == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2736" name="L2736"></a>2736             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>((<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a> == <strong class="reserved">null</strong> ? "hit" : "point") +
<a id="L2737" name="L2737"></a>2737                                            " can't be null");
<a id="L2738" name="L2738"></a>2738         <em class="brace">}</em>
<a id="L2739" name="L2739"></a>2739         <a href="../S/2375.html#L662" title="Defined at 662 in src/java/awt/font/TextLayout.java.">ensureCache</a>();
<a id="L2740" name="L2740"></a>2740         <a href="../S/2375.html#L773" title="Defined at 773 in src/java/awt/font/TextLayout.java.">checkTextHit</a>(<a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>);
<a id="L2741" name="L2741"></a>2741 
<a id="L2742" name="L2742"></a>2742         <strong class="reserved">float</strong> adv = 0;
<a id="L2743" name="L2743"></a>2743         <strong class="reserved">float</strong> off = 0;
<a id="L2744" name="L2744"></a>2744 
<a id="L2745" name="L2745"></a>2745         <strong class="reserved">int</strong> <a href="../D/26595.html" title="Multiple defined in 32 places.">ix</a> = <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L107" title="Defined at 107 in src/java/awt/font/TextHitInfo.java.">getCharIndex</a>();
<a id="L2746" name="L2746"></a>2746         <strong class="reserved">boolean</strong> <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a> = <a href="../S/2098.html#L821" title="Defined at 821 in src/java/awt/Graphics2D.java.">hit</a>.<a href="../S/2364.html#L117" title="Defined at 117 in src/java/awt/font/TextHitInfo.java.">isLeadingEdge</a>();
<a id="L2747" name="L2747"></a>2747         <strong class="reserved">boolean</strong> ltr;
<a id="L2748" name="L2748"></a>2748         <strong class="reserved">if</strong> (<a href="../D/26595.html" title="Multiple defined in 32 places.">ix</a> == -1 || <a href="../D/26595.html" title="Multiple defined in 32 places.">ix</a> == textLine.<a href="../S/2362.html#L537" title="Defined at 537 in src/java/awt/font/TextLine.java.">characterCount</a>()) <em class="brace">{</em>
<a id="L2749" name="L2749"></a>2749             ltr = textLine.<a href="../S/2362.html#L542" title="Defined at 542 in src/java/awt/font/TextLine.java.">isDirectionLTR</a>();
<a id="L2750" name="L2750"></a>2750             adv = (ltr == (<a href="../D/26595.html" title="Multiple defined in 32 places.">ix</a> == -1)) ? 0 : lineMetrics.<a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>;
<a id="L2751" name="L2751"></a>2751         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L2752" name="L2752"></a>2752             ltr = textLine.<a href="../S/2362.html#L575" title="Defined at 575 in src/java/awt/font/TextLine.java.">isCharLTR</a>(<a href="../D/26595.html" title="Multiple defined in 32 places.">ix</a>);
<a id="L2753" name="L2753"></a>2753             adv = textLine.<a href="../D/17591.html" title="Multiple defined in 2 places.">getCharLinePosition</a>(<a href="../D/26595.html" title="Multiple defined in 32 places.">ix</a>, <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>);
<a id="L2754" name="L2754"></a>2754             off = textLine.<a href="../S/2362.html#L673" title="Defined at 673 in src/java/awt/font/TextLine.java.">getCharYPosition</a>(<a href="../D/26595.html" title="Multiple defined in 32 places.">ix</a>);
<a id="L2755" name="L2755"></a>2755         <em class="brace">}</em>
<a id="L2756" name="L2756"></a>2756         point.<a href="../D/33134.html" title="Multiple defined in 29 places.">setLocation</a>(adv, off);
<a id="L2757" name="L2757"></a>2757         <a href="../S/2361.html#L43" title="Defined at 43 in src/java/awt/font/LayoutPath.java.">LayoutPath</a> lp = textLine.<a href="../D/20039.html" title="Multiple defined in 2 places.">getLayoutPath</a>();
<a id="L2758" name="L2758"></a>2758         <strong class="reserved">if</strong> (lp != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L2759" name="L2759"></a>2759             lp.<a href="../S/2361.html#L82" title="Defined at 82 in src/java/awt/font/LayoutPath.java.">pathToPoint</a>(point, ltr != <a href="../D/26791.html" title="Multiple defined in 2 places.">leading</a>, point);
<a id="L2760" name="L2760"></a>2760         <em class="brace">}</em>
<a id="L2761" name="L2761"></a>2761     <em class="brace">}</em>
<a id="L2762" name="L2762"></a>2762 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L336">[^]</a><a href="#L2734">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>