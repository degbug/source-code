<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xml/internal/dtm/ref/DTMManagerDefault.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L133">[^]</a><a href="#L857">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L133" title="Defined at 133.">addDTM</a></li>
<li><a href="#L146" title="Defined at 146.">addDTM</a></li>
<li><a href="#L187" title="Defined at 187.">getFirstFreeDTMID</a></li>
<li><a href="#L239" title="Defined at 239.">getDTM</a></li>
<li><a href="#L494" title="Defined at 494.">getDTMHandleFromNode</a></li>
<li><a href="#L599" title="Defined at 599.">getXMLReader</a></li>
<li><a href="#L633" title="Defined at 633.">releaseXMLReader</a></li>
<li><a href="#L646" title="Defined at 646.">getDTM</a></li>
<li><a href="#L672" title="Defined at 672.">getDTMIdentity</a></li>
<li><a href="#L713" title="Defined at 713.">release</a></li>
<li><a href="#L764" title="Defined at 764.">createDocumentFragment</a></li>
<li><a href="#L794" title="Defined at 794.">createDTMIterator</a></li>
<li><a href="#L811" title="Defined at 811.">createDTMIterator</a></li>
<li><a href="#L827" title="Defined at 827.">createDTMIterator</a></li>
<li><a href="#L843" title="Defined at 843.">createDTMIterator</a></li>
<li><a href="#L857" title="Defined at 857.">getExpandedNameTable</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: DTMManagerDefault.java,v 1.2.4.1 2005/09/15 08:15:02 suresh_emailid Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xml.internal.dtm.<a href="../S/986.html#L2252" title="Defined at 2252 in src/java/util/regex/Pattern.java.">ref</a>;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.utils.FactoryImpl;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> javax.xml.parsers.DocumentBuilder;
<a id="L27" name="L27"></a>  27 <strong class="reserved">import</strong> javax.xml.parsers.DocumentBuilderFactory;
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> javax.xml.transform.Source;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> javax.xml.transform.dom.DOMSource;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> javax.xml.transform.sax.SAXSource;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> javax.xml.transform.stream.StreamSource;
<a id="L32" name="L32"></a>  32 
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTM;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMException;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMFilter;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMIterator;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMManager;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.DTMWSFilter;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.ref.dom2dtm.DOM2DTM;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.ref.sax2dtm.SAX2DTM;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.dtm.ref.sax2dtm.SAX2RTFDTM;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.res.XMLErrorResources;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.res.XMLMessages;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.PrefixResolver;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.SystemIDResolver;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.XMLReaderManager;
<a id="L47" name="L47"></a>  47 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.XMLStringFactory;
<a id="L48" name="L48"></a>  48 
<a id="L49" name="L49"></a>  49 <strong class="reserved">import</strong> org.w3c.dom.Document;
<a id="L50" name="L50"></a>  50 <strong class="reserved">import</strong> org.w3c.dom.Node;
<a id="L51" name="L51"></a>  51 
<a id="L52" name="L52"></a>  52 <strong class="reserved">import</strong> org.xml.sax.InputSource;
<a id="L53" name="L53"></a>  53 <strong class="reserved">import</strong> org.xml.sax.SAXException;
<a id="L54" name="L54"></a>  54 <strong class="reserved">import</strong> org.xml.sax.SAXNotRecognizedException;
<a id="L55" name="L55"></a>  55 <strong class="reserved">import</strong> org.xml.sax.SAXNotSupportedException;
<a id="L56" name="L56"></a>  56 <strong class="reserved">import</strong> org.xml.sax.XMLReader;
<a id="L57" name="L57"></a>  57 <strong class="reserved">import</strong> org.xml.sax.helpers.DefaultHandler;
<a id="L58" name="L58"></a>  58 
<div class="comment">
  The default implementation for the DTMManager.
  %REVIEW% There is currently a reentrancy issue, since the finalizer
  for XRTreeFrag (which runs in the GC thread) wants to call
  DTMManager.release(), and may do so at the same time that the main
  transformation thread is accessing the manager. Our current solution is
  to make most of the manager's methods <code>synchronized</code>.
  Early tests suggest that doing so is not causing a significant
  performance hit in Xalan. However, it should be noted that there
  is a possible alternative solution: rewrite release() so it merely
  posts a request for release onto a threadsafe queue, and explicitly
  process that queue on an infrequent basis during main-thread
  activity (eg, when getDTM() is invoked). The downside of that solution
  would be a greater delay before the DTM's storage is actually released
  for reuse.
 * </div>
<a id="L76" name="L76"></a>  76 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/1964.html" title="Multiple referred from 13 places.">DTMManagerDefault</a> <strong class="reserved">extends</strong> <a href="../S/5920.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/dtm/DTMManager.java.">DTMManager</a>
<a id="L77" name="L77"></a>  77 <em class="brace">{</em>
<a id="L78" name="L78"></a>  78   <em class="comment">//static final boolean JKESS_XNI_EXPERIMENT=true;</em>
<a id="L79" name="L79"></a>  79 
<div class="comment">
   /** Set this to true if you want a dump of the DTM after creation. */</div>
<a id="L81" name="L81"></a>  81   <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> DUMPTREE = <strong class="reserved">false</strong>;
<a id="L82" name="L82"></a>  82 
<div class="comment">
   /** Set this to true if you want a basic diagnostics. */</div>
<a id="L84" name="L84"></a>  84   <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> DEBUG = <strong class="reserved">false</strong>;
<a id="L85" name="L85"></a>  85 
<div class="comment">
    Map from DTM identifier numbers to DTM objects that this manager manages.
    One DTM may have several prefix numbers, if extended node indexing
    is in use; in that case, m_dtm_offsets[] will used to control which
    prefix maps to which section of the DTM.
    This array grows as necessary; see addDTM().
    This array grows as necessary; see addDTM(). Growth is uncommon... but
    access needs to be blindingly fast since it's used in node addressing.</div>
<a id="L97" name="L97"></a>  97   <strong class="reserved">protected</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> m_dtms[] = <strong class="reserved">new</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>[256];
<a id="L98" name="L98"></a>  98 
<div class="comment">
 Map from DTM identifier numbers to offsets. For small DTMs with a
    single identifier, this will always be 0. In overflow addressing, where
    additional identifiers are allocated to access nodes beyond the range of
    a single Node Handle, this table is used to map the handle's node field
    into the actual node identifier.
    This array grows as necessary; see addDTM().
    This array grows as necessary; see addDTM(). Growth is uncommon... but
    access needs to be blindingly fast since it's used in node addressing.
    (And at the moment, that includes accessing it from DTMDefaultBase,
    which is why this is not Protected or Private.)</div>
<a id="L112" name="L112"></a> 112   <strong class="reserved">int</strong> m_dtm_offsets[] = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[256];
<a id="L113" name="L113"></a> 113 
<div class="comment">
    The cache for XMLReader objects to be used if the user did not
    supply an XMLReader for a SAXSource or supplied a StreamSource.</div>
<a id="L118" name="L118"></a> 118   <strong class="reserved">protected</strong> <a href="../S/5841.html#L44" title="Defined at 44 in src/com/sun/org/apache/xml/internal/utils/XMLReaderManager.java.">XMLReaderManager</a> m_readerManager = <strong class="reserved">null</strong>;
<a id="L119" name="L119"></a> 119 
<div class="comment">
    The default implementation of ContentHandler, DTDHandler and ErrorHandler.</div>
<a id="L123" name="L123"></a> 123   <strong class="reserved">protected</strong> <a href="../S/731.html#L83" title="Defined at 83 in src/org/xml/sax/helpers/DefaultHandler.java.">DefaultHandler</a> m_defaultHandler = <strong class="reserved">new</strong> <a href="../S/731.html#L83" title="Defined at 83 in src/org/xml/sax/helpers/DefaultHandler.java.">DefaultHandler</a>();
<a id="L124" name="L124"></a> 124 
<div class="comment">
    Add a DTM to the DTM table. This convenience call adds it as the
    "base DTM ID", with offset 0. The other version of addDTM should
    be used if you want to add "extended" DTM IDs with nonzero offsets.
    @param dtm Should be a valid reference to a DTM.
    @param id Integer DTM ID to be bound to this DTM</div>
<a id="L133" name="L133"></a> 133   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/9681.html" title="Multiple referred from 11 places.">addDTM</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm, <strong class="reserved">int</strong> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>) <em class="brace">{</em>    <a href="../D/10743.html" title="Multiple defined in 2 places.">addDTM</a>(dtm,<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>,0); <em class="brace">}</em>
<a id="L134" name="L134"></a> 134 
<a id="L135" name="L135"></a> 135 
<div class="comment">
    Add a DTM to the DTM table.
    @param dtm Should be a valid reference to a DTM.
    @param id Integer DTM ID to be bound to this DTM.
    @param offset Integer addressing offset. The internal DTM Node ID is
    obtained by adding this offset to the node-number field of the
    public DTM Handle. For the first DTM ID accessing each DTM, this is 0;
    for overflow addressing it will be a multiple of 1&lt;</div>
<a id="L146" name="L146"></a> 146   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/9681.html" title="Multiple referred from 11 places.">addDTM</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm, <strong class="reserved">int</strong> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>, <strong class="reserved">int</strong> <a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>)
<a id="L147" name="L147"></a> 147   <em class="brace">{</em>
<a id="L148" name="L148"></a> 148                 <strong class="reserved">if</strong>(<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>&gt;=IDENT_MAX_DTMS)
<a id="L149" name="L149"></a> 149                 <em class="brace">{</em>
<a id="L150" name="L150"></a> 150                         <em class="comment">// TODO: %REVIEW% Not really the right error message.</em>
<a id="L151" name="L151"></a> 151             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/2144.html" title="Multiple defined in 2 places.">DTMException</a>(<a href="../S/5529.html#L33" title="Defined at 33 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">XMLMessages</a>.<a href="../S/5529.html#L82" title="Defined at 82 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">createXMLMessage</a>(<a href="../S/5541.html#L35" title="Defined at 35 in src/com/sun/org/apache/xml/internal/res/XMLErrorResources.java.">XMLErrorResources</a>.ER_NO_DTMIDS_AVAIL, <strong class="reserved">null</strong>)); <em class="comment">//"No more DTM IDs are available!");</em>
<a id="L152" name="L152"></a> 152                 <em class="brace">}</em>
<a id="L153" name="L153"></a> 153 
<a id="L154" name="L154"></a> 154                 <em class="comment">// We used to just allocate the array size to IDENT_MAX_DTMS.</em>
<a id="L155" name="L155"></a> 155                 <em class="comment">// But we expect to increase that to 16 bits, and I'm not willing</em>
<a id="L156" name="L156"></a> 156                 <em class="comment">// to allocate that much space unless needed. We could use one of our</em>
<a id="L157" name="L157"></a> 157                 <em class="comment">// handy-dandy Fast*Vectors, but this will do for now.</em>
<a id="L158" name="L158"></a> 158                 <em class="comment">// %REVIEW%</em>
<a id="L159" name="L159"></a> 159                 <strong class="reserved">int</strong> oldlen=m_dtms.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L160" name="L160"></a> 160                 <strong class="reserved">if</strong>(oldlen&lt;=<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>)
<a id="L161" name="L161"></a> 161                 <em class="brace">{</em>
<a id="L162" name="L162"></a> 162                         <em class="comment">// Various growth strategies are possible. I think we don't want</em>
<a id="L163" name="L163"></a> 163                         <em class="comment">// to over-allocate excessively, and I'm willing to reallocate</em>
<a id="L164" name="L164"></a> 164                         <em class="comment">// more often to get that. See also Fast*Vector classes.</em>
<a id="L165" name="L165"></a> 165                         <em class="comment">//</em>
<a id="L166" name="L166"></a> 166                         <em class="comment">// %REVIEW% Should throw a more diagnostic error if we go over the max...</em>
<a id="L167" name="L167"></a> 167                         <strong class="reserved">int</strong> newlen=<a href="../S/1768.html#L105" title="Defined at 105 in src/java/lang/Math.java.">Math</a>.<a href="../D/27697.html" title="Multiple defined in 28 places.">min</a>((<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>+256),IDENT_MAX_DTMS);
<a id="L168" name="L168"></a> 168 
<a id="L169" name="L169"></a> 169                         <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> new_m_dtms[] = <strong class="reserved">new</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>[newlen];
<a id="L170" name="L170"></a> 170                         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(m_dtms,0,new_m_dtms,0,oldlen);
<a id="L171" name="L171"></a> 171                         m_dtms=new_m_dtms;
<a id="L172" name="L172"></a> 172                         <strong class="reserved">int</strong> new_m_dtm_offsets[] = <strong class="reserved">new</strong> <strong class="reserved">int</strong>[newlen];
<a id="L173" name="L173"></a> 173                         <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L493" title="Defined at 493 in src/java/lang/System.java.">arraycopy</a>(m_dtm_offsets,0,new_m_dtm_offsets,0,oldlen);
<a id="L174" name="L174"></a> 174                         m_dtm_offsets=new_m_dtm_offsets;
<a id="L175" name="L175"></a> 175                 <em class="brace">}</em>
<a id="L176" name="L176"></a> 176 
<a id="L177" name="L177"></a> 177     m_dtms[<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>] = dtm;
<a id="L178" name="L178"></a> 178                 m_dtm_offsets[<a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>]=<a href="../D/28472.html" title="Multiple defined in 2 places.">offset</a>;
<a id="L179" name="L179"></a> 179     dtm.<a href="../D/15106.html" title="Multiple defined in 5 places.">documentRegistration</a>();
<a id="L180" name="L180"></a> 180                 <em class="comment">// The DTM should have been told who its manager was when we created it.</em>
<a id="L181" name="L181"></a> 181                 <em class="comment">// Do we need to allow for adopting DTMs _not_ created by this manager?</em>
<a id="L182" name="L182"></a> 182   <em class="brace">}</em>
<a id="L183" name="L183"></a> 183 
<div class="comment">
    Get the first free DTM ID available. %OPT% Linear search is inefficient!</div>
<a id="L187" name="L187"></a> 187   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/16616.html" title="Multiple referred from 7 places.">getFirstFreeDTMID</a>()
<a id="L188" name="L188"></a> 188   <em class="brace">{</em>
<a id="L189" name="L189"></a> 189     <strong class="reserved">int</strong> n = m_dtms.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L190" name="L190"></a> 190     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 1; i &lt; n; i++)
<a id="L191" name="L191"></a> 191     <em class="brace">{</em>
<a id="L192" name="L192"></a> 192       <strong class="reserved">if</strong>(<strong class="reserved">null</strong> == m_dtms[i])
<a id="L193" name="L193"></a> 193       <em class="brace">{</em>
<a id="L194" name="L194"></a> 194         <strong class="reserved">return</strong> i;
<a id="L195" name="L195"></a> 195       <em class="brace">}</em>
<a id="L196" name="L196"></a> 196     <em class="brace">}</em>
<a id="L197" name="L197"></a> 197                 <strong class="reserved">return</strong> n; <em class="comment">// count on addDTM() to throw exception if out of range</em>
<a id="L198" name="L198"></a> 198   <em class="brace">}</em>
<a id="L199" name="L199"></a> 199 
<div class="comment">
    The default table for exandedNameID lookups.</div>
<a id="L203" name="L203"></a> 203   <strong class="reserved">private</strong> <a href="../S/5887.html#L39" title="Defined at 39 in src/com/sun/org/apache/xml/internal/dtm/ref/ExpandedNameTable.java.">ExpandedNameTable</a> m_expandedNameTable =
<a id="L204" name="L204"></a> 204     <strong class="reserved">new</strong> <a href="../S/5887.html#L39" title="Defined at 39 in src/com/sun/org/apache/xml/internal/dtm/ref/ExpandedNameTable.java.">ExpandedNameTable</a>();
<a id="L205" name="L205"></a> 205 
<div class="comment">
    Constructor DTMManagerDefault</div>
<a id="L210" name="L210"></a> 210   <strong class="reserved">public</strong> DTMManagerDefault()<em class="brace">{</em><em class="brace">}</em>
<a id="L211" name="L211"></a> 211 
<a id="L212" name="L212"></a> 212 
<div class="comment">
    Get an instance of a DTM, loaded with the content from the
    specified source.  If the unique flag is true, a new instance will
    always be returned.  Otherwise it is up to the DTMManager to return a
    new instance or an instance that it already created and may be being used
    by someone else.
    A bit of magic in this implementation: If the source is null, unique is true,
    and incremental and doIndexing are both false, we return an instance of
    SAX2RTFDTM, which see.
    (I think more parameters will need to be added for error handling, and entity
    resolution, and more explicit control of the RTF situation).
    @param source the specification of the source object.
    @param unique true if the returned DTM must be unique, probably because it
    is going to be mutated.
    @param whiteSpaceFilter Enables filtering of whitespace nodes, and may
                            be null.
    @param incremental true if the DTM should be built incrementally, if
                       possible.
    @param doIndexing true if the caller considers it worth it to use
                      indexing schemes.
    @return a non-null DTM reference.</div>
<a id="L239" name="L239"></a> 239   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> <a href="../R/15933.html" title="Multiple referred from 85 places.">getDTM</a>(<a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, <strong class="reserved">boolean</strong> unique,
<a id="L240" name="L240"></a> 240                                  <a href="../S/5926.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMWSFilter.java.">DTMWSFilter</a> whiteSpaceFilter,
<a id="L241" name="L241"></a> 241                                  <strong class="reserved">boolean</strong> incremental, <strong class="reserved">boolean</strong> doIndexing)
<a id="L242" name="L242"></a> 242   <em class="brace">{</em>
<a id="L243" name="L243"></a> 243 
<a id="L244" name="L244"></a> 244     <strong class="reserved">if</strong>(DEBUG &amp;&amp; <strong class="reserved">null</strong> != <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>)
<a id="L245" name="L245"></a> 245       <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Starting "+
<a id="L246" name="L246"></a> 246                          (unique ? "UNIQUE" : "shared")+
<a id="L247" name="L247"></a> 247                          " source: "+<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>.<a href="../D/22911.html" title="Multiple defined in 50 places.">getSystemId</a>()
<a id="L248" name="L248"></a> 248                          );
<a id="L249" name="L249"></a> 249 
<a id="L250" name="L250"></a> 250     <a href="../S/5839.html#L28" title="Defined at 28 in src/com/sun/org/apache/xml/internal/utils/XMLStringFactory.java.">XMLStringFactory</a> xstringFactory = m_xsf;
<a id="L251" name="L251"></a> 251     <strong class="reserved">int</strong> dtmPos = <a href="../S/5906.html#L187" title="Defined at 187 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMManagerDefault.java.">getFirstFreeDTMID</a>();
<a id="L252" name="L252"></a> 252     <strong class="reserved">int</strong> documentID = dtmPos &lt;&lt; IDENT_DTM_NODE_BITS;
<a id="L253" name="L253"></a> 253 
<a id="L254" name="L254"></a> 254     <strong class="reserved">if</strong> ((<strong class="reserved">null</strong> != <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>) &amp;&amp; <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> <strong class="reserved">instanceof</strong> <a href="../S/4046.html#L44" title="Defined at 44 in src/javax/xml/transform/dom/DOMSource.java.">DOMSource</a>)
<a id="L255" name="L255"></a> 255     <em class="brace">{</em>
<a id="L256" name="L256"></a> 256       <a href="../S/5895.html#L68" title="Defined at 68 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">DOM2DTM</a> dtm = <strong class="reserved">new</strong> <a href="../S/5895.html#L68" title="Defined at 68 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">DOM2DTM</a>(<strong class="reserved">this</strong>, (<a href="../S/4046.html#L44" title="Defined at 44 in src/javax/xml/transform/dom/DOMSource.java.">DOMSource</a>) <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, documentID,
<a id="L257" name="L257"></a> 257                                 whiteSpaceFilter, xstringFactory, doIndexing);
<a id="L258" name="L258"></a> 258 
<a id="L259" name="L259"></a> 259       <a href="../D/10743.html" title="Multiple defined in 2 places.">addDTM</a>(dtm, dtmPos, 0);
<a id="L260" name="L260"></a> 260 
<a id="L261" name="L261"></a> 261       <em class="comment">//      if (DUMPTREE)</em>
<a id="L262" name="L262"></a> 262       <em class="comment">//      {</em>
<a id="L263" name="L263"></a> 263       <em class="comment">//        dtm.dumpDTM();</em>
<a id="L264" name="L264"></a> 264       <em class="comment">//      }</em>
<a id="L265" name="L265"></a> 265 
<a id="L266" name="L266"></a> 266       <strong class="reserved">return</strong> dtm;
<a id="L267" name="L267"></a> 267     <em class="brace">}</em>
<a id="L268" name="L268"></a> 268     <strong class="reserved">else</strong>
<a id="L269" name="L269"></a> 269     <em class="brace">{</em>
<a id="L270" name="L270"></a> 270       <strong class="reserved">boolean</strong> isSAXSource = (<strong class="reserved">null</strong> != <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>)
<a id="L271" name="L271"></a> 271         ? (<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> <strong class="reserved">instanceof</strong> <a href="../S/4031.html#L45" title="Defined at 45 in src/javax/xml/transform/sax/SAXSource.java.">SAXSource</a>) : <strong class="reserved">true</strong>;
<a id="L272" name="L272"></a> 272       <strong class="reserved">boolean</strong> isStreamSource = (<strong class="reserved">null</strong> != <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>)
<a id="L273" name="L273"></a> 273         ? (<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a> <strong class="reserved">instanceof</strong> <a href="../S/4039.html#L43" title="Defined at 43 in src/javax/xml/transform/stream/StreamSource.java.">StreamSource</a>) : <strong class="reserved">false</strong>;
<a id="L274" name="L274"></a> 274 
<a id="L275" name="L275"></a> 275       <strong class="reserved">if</strong> (isSAXSource || isStreamSource) <em class="brace">{</em>
<a id="L276" name="L276"></a> 276         <a href="../S/724.html#L84" title="Defined at 84 in src/org/xml/sax/XMLReader.java.">XMLReader</a> <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a> = <strong class="reserved">null</strong>;
<a id="L277" name="L277"></a> 277         <a href="../S/5892.html#L50" title="Defined at 50 in src/com/sun/org/apache/xml/internal/dtm/ref/sax2dtm/SAX2DTM.java.">SAX2DTM</a> dtm;
<a id="L278" name="L278"></a> 278 
<a id="L279" name="L279"></a> 279         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L280" name="L280"></a> 280           <a href="../S/711.html#L84" title="Defined at 84 in src/org/xml/sax/InputSource.java.">InputSource</a> xmlSource;
<a id="L281" name="L281"></a> 281 
<a id="L282" name="L282"></a> 282           <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>) <em class="brace">{</em>
<a id="L283" name="L283"></a> 283             xmlSource = <strong class="reserved">null</strong>;
<a id="L284" name="L284"></a> 284           <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L285" name="L285"></a> 285             <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a> = <a href="../D/23755.html" title="Multiple defined in 9 places.">getXMLReader</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L286" name="L286"></a> 286             xmlSource = <a href="../S/4031.html#L45" title="Defined at 45 in src/javax/xml/transform/sax/SAXSource.java.">SAXSource</a>.<a href="../S/4031.html#L192" title="Defined at 192 in src/javax/xml/transform/sax/SAXSource.java.">sourceToInputSource</a>(<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>);
<a id="L287" name="L287"></a> 287 
<a id="L288" name="L288"></a> 288             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> urlOfSource = xmlSource.<a href="../D/22911.html" title="Multiple defined in 50 places.">getSystemId</a>();
<a id="L289" name="L289"></a> 289 
<a id="L290" name="L290"></a> 290             <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != urlOfSource) <em class="brace">{</em>
<a id="L291" name="L291"></a> 291               <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L292" name="L292"></a> 292                 urlOfSource = <a href="../D/8695.html" title="Multiple defined in 2 places.">SystemIDResolver</a>.<a href="../D/16701.html" title="Multiple defined in 4 places.">getAbsoluteURI</a>(urlOfSource);
<a id="L293" name="L293"></a> 293               <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L294" name="L294"></a> 294                 <em class="comment">// %REVIEW% Is there a better way to send a warning?</em>
<a id="L295" name="L295"></a> 295                 <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.err.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Can not absolutize URL: " + urlOfSource);
<a id="L296" name="L296"></a> 296               <em class="brace">}</em>
<a id="L297" name="L297"></a> 297 
<a id="L298" name="L298"></a> 298               xmlSource.<a href="../D/34059.html" title="Multiple defined in 31 places.">setSystemId</a>(urlOfSource);
<a id="L299" name="L299"></a> 299             <em class="brace">}</em>
<a id="L300" name="L300"></a> 300           <em class="brace">}</em>
<a id="L301" name="L301"></a> 301 
<a id="L302" name="L302"></a> 302           <strong class="reserved">if</strong> (<a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>==<strong class="reserved">null</strong> &amp;&amp; unique &amp;&amp; !incremental &amp;&amp; !doIndexing) <em class="brace">{</em>
<a id="L303" name="L303"></a> 303             <em class="comment">// Special case to support RTF construction into shared DTM.</em>
<a id="L304" name="L304"></a> 304             <em class="comment">// It should actually still work for other uses,</em>
<a id="L305" name="L305"></a> 305             <em class="comment">// but may be slightly deoptimized relative to the base</em>
<a id="L306" name="L306"></a> 306             <em class="comment">// to allow it to deal with carrying multiple documents.</em>
<a id="L307" name="L307"></a> 307             <em class="comment">//</em>
<a id="L308" name="L308"></a> 308             <em class="comment">// %REVIEW% This is a sloppy way to request this mode;</em>
<a id="L309" name="L309"></a> 309             <em class="comment">// we need to consider architectural improvements.</em>
<a id="L310" name="L310"></a> 310             dtm = <strong class="reserved">new</strong> <a href="../S/5890.html#L64" title="Defined at 64 in src/com/sun/org/apache/xml/internal/dtm/ref/sax2dtm/SAX2RTFDTM.java.">SAX2RTFDTM</a>(<strong class="reserved">this</strong>, <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, documentID, whiteSpaceFilter,
<a id="L311" name="L311"></a> 311                                  xstringFactory, doIndexing);
<a id="L312" name="L312"></a> 312           <em class="brace">}</em>
<div class="comment">
************************************************************
          // EXPERIMENTAL 3/22/02
          else if(JKESS_XNI_EXPERIMENT &amp;&amp; m_incremental) {
            dtm = new XNI2DTM(this, source, documentID, whiteSpaceFilter,
                              xstringFactory, doIndexing);
          }
          *************************************************************</div>
<a id="L320" name="L320"></a> 320           <em class="comment">// Create the basic SAX2DTM.</em>
<a id="L321" name="L321"></a> 321           <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L322" name="L322"></a> 322             dtm = <strong class="reserved">new</strong> <a href="../S/5892.html#L50" title="Defined at 50 in src/com/sun/org/apache/xml/internal/dtm/ref/sax2dtm/SAX2DTM.java.">SAX2DTM</a>(<strong class="reserved">this</strong>, <a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a>, documentID, whiteSpaceFilter,
<a id="L323" name="L323"></a> 323                               xstringFactory, doIndexing);
<a id="L324" name="L324"></a> 324           <em class="brace">}</em>
<a id="L325" name="L325"></a> 325 
<a id="L326" name="L326"></a> 326           <em class="comment">// Go ahead and add the DTM to the lookup table.  This needs to be</em>
<a id="L327" name="L327"></a> 327           <em class="comment">// done before any parsing occurs. Note offset 0, since we've just</em>
<a id="L328" name="L328"></a> 328           <em class="comment">// created a new DTM.</em>
<a id="L329" name="L329"></a> 329           <a href="../D/10743.html" title="Multiple defined in 2 places.">addDTM</a>(dtm, dtmPos, 0);
<a id="L330" name="L330"></a> 330 
<a id="L331" name="L331"></a> 331 
<a id="L332" name="L332"></a> 332           <strong class="reserved">boolean</strong> haveXercesParser =
<a id="L333" name="L333"></a> 333                      (<strong class="reserved">null</strong> != <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>)
<a id="L334" name="L334"></a> 334                      &amp;&amp; (<a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/17675.html" title="Multiple defined in 6 places.">getClass</a>()
<a id="L335" name="L335"></a> 335                                .<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>()
<a id="L336" name="L336"></a> 336                                .<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>("com.sun.org.apache.xerces.internal.parsers.SAXParser") );
<a id="L337" name="L337"></a> 337 
<a id="L338" name="L338"></a> 338           <strong class="reserved">if</strong> (haveXercesParser) <em class="brace">{</em>
<a id="L339" name="L339"></a> 339             incremental = <strong class="reserved">true</strong>;  <em class="comment">// No matter what.  %REVIEW%</em>
<a id="L340" name="L340"></a> 340           <em class="brace">}</em>
<a id="L341" name="L341"></a> 341 
<a id="L342" name="L342"></a> 342           <em class="comment">// If the reader is null, but they still requested an incremental</em>
<a id="L343" name="L343"></a> 343           <em class="comment">// build, then we still want to set up the IncrementalSAXSource stuff.</em>
<a id="L344" name="L344"></a> 344           <strong class="reserved">if</strong> (m_incremental &amp;&amp; incremental
<div class="comment">
                /* || ((null == reader) &amp;&amp; incremental) */</div>) <em class="brace">{</em>
<a id="L346" name="L346"></a> 346             <a href="../S/5909.html#L39" title="Defined at 39 in src/com/sun/org/apache/xml/internal/dtm/ref/IncrementalSAXSource.java.">IncrementalSAXSource</a> coParser=<strong class="reserved">null</strong>;
<a id="L347" name="L347"></a> 347 
<a id="L348" name="L348"></a> 348             <strong class="reserved">if</strong> (haveXercesParser) <em class="brace">{</em>
<a id="L349" name="L349"></a> 349               <em class="comment">// IncrementalSAXSource_Xerces to avoid threading.</em>
<a id="L350" name="L350"></a> 350               <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L351" name="L351"></a> 351                 coParser =(<a href="../S/5909.html#L39" title="Defined at 39 in src/com/sun/org/apache/xml/internal/dtm/ref/IncrementalSAXSource.java.">IncrementalSAXSource</a>)
<a id="L352" name="L352"></a> 352                   <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>.<a href="../D/16518.html" title="Multiple defined in 6 places.">forName</a>("com.sun.org.apache.xml.internal.dtm.ref.IncrementalSAXSource_Xerces").<a href="../D/28016.html" title="Multiple defined in 74 places.">newInstance</a>();
<a id="L353" name="L353"></a> 353               <em class="brace">}</em>  <strong class="reserved">catch</strong>( <a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a> ) <em class="brace">{</em>
<a id="L354" name="L354"></a> 354                 <a href="../S/5015.html#L111" title="Defined at 111 in src/com/sun/org/apache/xerces/internal/impl/xpath/regex/RegexParser.java.">ex</a>.<a href="../D/29703.html" title="Multiple defined in 46 places.">printStackTrace</a>();
<a id="L355" name="L355"></a> 355                 coParser=<strong class="reserved">null</strong>;
<a id="L356" name="L356"></a> 356               <em class="brace">}</em>
<a id="L357" name="L357"></a> 357             <em class="brace">}</em>
<a id="L358" name="L358"></a> 358 
<a id="L359" name="L359"></a> 359             <strong class="reserved">if</strong> (coParser==<strong class="reserved">null</strong> ) <em class="brace">{</em>
<a id="L360" name="L360"></a> 360               <em class="comment">// Create a IncrementalSAXSource to run on the secondary thread.</em>
<a id="L361" name="L361"></a> 361               <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>) <em class="brace">{</em>
<a id="L362" name="L362"></a> 362                 coParser = <strong class="reserved">new</strong> <a href="../S/5910.html#L73" title="Defined at 73 in src/com/sun/org/apache/xml/internal/dtm/ref/IncrementalSAXSource_Filter.java.">IncrementalSAXSource_Filter</a>();
<a id="L363" name="L363"></a> 363               <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L364" name="L364"></a> 364                 <a href="../S/5910.html#L73" title="Defined at 73 in src/com/sun/org/apache/xml/internal/dtm/ref/IncrementalSAXSource_Filter.java.">IncrementalSAXSource_Filter</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a> =
<a id="L365" name="L365"></a> 365                          <strong class="reserved">new</strong> <a href="../S/5910.html#L73" title="Defined at 73 in src/com/sun/org/apache/xml/internal/dtm/ref/IncrementalSAXSource_Filter.java.">IncrementalSAXSource_Filter</a>();
<a id="L366" name="L366"></a> 366                 <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>.<a href="../D/34347.html" title="Multiple defined in 4 places.">setXMLReader</a>(<a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>);
<a id="L367" name="L367"></a> 367                 coParser=<a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>;
<a id="L368" name="L368"></a> 368               <em class="brace">}</em>
<a id="L369" name="L369"></a> 369             <em class="brace">}</em>
<a id="L370" name="L370"></a> 370 
<a id="L371" name="L371"></a> 371 
<div class="comment">
************************************************************
            // EXPERIMENTAL 3/22/02
            if (JKESS_XNI_EXPERIMENT &amp;&amp; m_incremental &amp;&amp;
                  dtm instanceof XNI2DTM &amp;&amp;
                  coParser instanceof IncrementalSAXSource_Xerces) {
                com.sun.org.apache.xerces.internal.xni.parser.XMLPullParserConfiguration xpc=
                      ((IncrementalSAXSource_Xerces)coParser)
                                           .getXNIParserConfiguration();
              if (xpc!=null) {
                // Bypass SAX; listen to the XNI stream
                ((XNI2DTM)dtm).setIncrementalXNISource(xpc);
              } else {
                  // Listen to the SAX stream (will fail, diagnostically...)
                dtm.setIncrementalSAXSource(coParser);
              }
            } else
            **************************************************************</div>
<a id="L389" name="L389"></a> 389 
<a id="L390" name="L390"></a> 390             <em class="comment">// Have the DTM set itself up as IncrementalSAXSource's listener.</em>
<a id="L391" name="L391"></a> 391             dtm.<a href="../D/32918.html" title="Multiple defined in 3 places.">setIncrementalSAXSource</a>(coParser);
<a id="L392" name="L392"></a> 392 
<a id="L393" name="L393"></a> 393             <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == xmlSource) <em class="brace">{</em>
<a id="L394" name="L394"></a> 394 
<a id="L395" name="L395"></a> 395               <em class="comment">// Then the user will construct it themselves.</em>
<a id="L396" name="L396"></a> 396               <strong class="reserved">return</strong> dtm;
<a id="L397" name="L397"></a> 397             <em class="brace">}</em>
<a id="L398" name="L398"></a> 398 
<a id="L399" name="L399"></a> 399             <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/18849.html" title="Multiple defined in 37 places.">getErrorHandler</a>()) <em class="brace">{</em>
<a id="L400" name="L400"></a> 400               <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32615.html" title="Multiple defined in 34 places.">setErrorHandler</a>(dtm);
<a id="L401" name="L401"></a> 401             <em class="brace">}</em>
<a id="L402" name="L402"></a> 402             <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32341.html" title="Multiple defined in 25 places.">setDTDHandler</a>(dtm);
<a id="L403" name="L403"></a> 403 
<a id="L404" name="L404"></a> 404             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L405" name="L405"></a> 405               <em class="comment">// Launch parsing coroutine.  Launches a second thread,</em>
<a id="L406" name="L406"></a> 406               <em class="comment">// if we're using IncrementalSAXSource.filter().</em>
<a id="L407" name="L407"></a> 407 
<a id="L408" name="L408"></a> 408               coParser.<a href="../D/34816.html" title="Multiple defined in 3 places.">startParse</a>(xmlSource);
<a id="L409" name="L409"></a> 409             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> re) <em class="brace">{</em>
<a id="L410" name="L410"></a> 410 
<a id="L411" name="L411"></a> 411               dtm.<a href="../D/12832.html" title="Multiple defined in 2 places.">clearCoRoutine</a>();
<a id="L412" name="L412"></a> 412 
<a id="L413" name="L413"></a> 413               <strong class="reserved">throw</strong> re;
<a id="L414" name="L414"></a> 414             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L415" name="L415"></a> 415 
<a id="L416" name="L416"></a> 416               dtm.<a href="../D/12832.html" title="Multiple defined in 2 places.">clearCoRoutine</a>();
<a id="L417" name="L417"></a> 417 
<a id="L418" name="L418"></a> 418               <strong class="reserved">throw</strong> <strong class="reserved">new</strong> com.sun.org.apache.xml.internal.utils.<a href="../D/9772.html" title="Multiple defined in 2 places.">WrappedRuntimeException</a>(e);
<a id="L419" name="L419"></a> 419             <em class="brace">}</em>
<a id="L420" name="L420"></a> 420           <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L421" name="L421"></a> 421             <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>) <em class="brace">{</em>
<a id="L422" name="L422"></a> 422 
<a id="L423" name="L423"></a> 423               <em class="comment">// Then the user will construct it themselves.</em>
<a id="L424" name="L424"></a> 424               <strong class="reserved">return</strong> dtm;
<a id="L425" name="L425"></a> 425             <em class="brace">}</em>
<a id="L426" name="L426"></a> 426 
<a id="L427" name="L427"></a> 427             <em class="comment">// not incremental</em>
<a id="L428" name="L428"></a> 428             <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32251.html" title="Multiple defined in 23 places.">setContentHandler</a>(dtm);
<a id="L429" name="L429"></a> 429             <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32341.html" title="Multiple defined in 25 places.">setDTDHandler</a>(dtm);
<a id="L430" name="L430"></a> 430             <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/18849.html" title="Multiple defined in 37 places.">getErrorHandler</a>()) <em class="brace">{</em>
<a id="L431" name="L431"></a> 431               <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32615.html" title="Multiple defined in 34 places.">setErrorHandler</a>(dtm);
<a id="L432" name="L432"></a> 432             <em class="brace">}</em>
<a id="L433" name="L433"></a> 433 
<a id="L434" name="L434"></a> 434             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L435" name="L435"></a> 435               <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/33622.html" title="Multiple defined in 81 places.">setProperty</a>(
<a id="L436" name="L436"></a> 436                                "http://xml.org/sax/properties/lexical-handler",
<a id="L437" name="L437"></a> 437                                dtm);
<a id="L438" name="L438"></a> 438             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/725.html#L53" title="Defined at 53 in src/org/xml/sax/SAXNotRecognizedException.java.">SAXNotRecognizedException</a> e)<em class="brace">{</em><em class="brace">}</em>
<a id="L439" name="L439"></a> 439               <strong class="reserved">catch</strong> (<a href="../S/727.html#L53" title="Defined at 53 in src/org/xml/sax/SAXNotSupportedException.java.">SAXNotSupportedException</a> e)<em class="brace">{</em><em class="brace">}</em>
<a id="L440" name="L440"></a> 440 
<a id="L441" name="L441"></a> 441             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L442" name="L442"></a> 442               <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/29076.html" title="Multiple defined in 178 places.">parse</a>(xmlSource);
<a id="L443" name="L443"></a> 443             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a> re) <em class="brace">{</em>
<a id="L444" name="L444"></a> 444               dtm.<a href="../D/12832.html" title="Multiple defined in 2 places.">clearCoRoutine</a>();
<a id="L445" name="L445"></a> 445 
<a id="L446" name="L446"></a> 446               <strong class="reserved">throw</strong> re;
<a id="L447" name="L447"></a> 447             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L448" name="L448"></a> 448               dtm.<a href="../D/12832.html" title="Multiple defined in 2 places.">clearCoRoutine</a>();
<a id="L449" name="L449"></a> 449 
<a id="L450" name="L450"></a> 450               <strong class="reserved">throw</strong> <strong class="reserved">new</strong> com.sun.org.apache.xml.internal.utils.<a href="../D/9772.html" title="Multiple defined in 2 places.">WrappedRuntimeException</a>(e);
<a id="L451" name="L451"></a> 451             <em class="brace">}</em>
<a id="L452" name="L452"></a> 452           <em class="brace">}</em>
<a id="L453" name="L453"></a> 453 
<a id="L454" name="L454"></a> 454           <strong class="reserved">if</strong> (DUMPTREE) <em class="brace">{</em>
<a id="L455" name="L455"></a> 455             <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Dumping SAX2DOM");
<a id="L456" name="L456"></a> 456             dtm.<a href="../S/5889.html#L639" title="Defined at 639 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">dumpDTM</a>(<a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.err);
<a id="L457" name="L457"></a> 457           <em class="brace">}</em>
<a id="L458" name="L458"></a> 458 
<a id="L459" name="L459"></a> 459           <strong class="reserved">return</strong> dtm;
<a id="L460" name="L460"></a> 460         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L461" name="L461"></a> 461           <em class="comment">// Reset the ContentHandler, DTDHandler, ErrorHandler to the DefaultHandler</em>
<a id="L462" name="L462"></a> 462           <em class="comment">// after creating the DTM.</em>
<a id="L463" name="L463"></a> 463           <strong class="reserved">if</strong> (<a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a> != <strong class="reserved">null</strong> &amp;&amp; !(m_incremental &amp;&amp; incremental)) <em class="brace">{</em>
<a id="L464" name="L464"></a> 464             <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32251.html" title="Multiple defined in 23 places.">setContentHandler</a>(m_defaultHandler);
<a id="L465" name="L465"></a> 465             <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32341.html" title="Multiple defined in 25 places.">setDTDHandler</a>(m_defaultHandler);
<a id="L466" name="L466"></a> 466             <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/32615.html" title="Multiple defined in 34 places.">setErrorHandler</a>(m_defaultHandler);
<a id="L467" name="L467"></a> 467 
<a id="L468" name="L468"></a> 468             <em class="comment">// Reset the LexicalHandler to null after creating the DTM.</em>
<a id="L469" name="L469"></a> 469             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L470" name="L470"></a> 470               <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>.<a href="../D/33622.html" title="Multiple defined in 81 places.">setProperty</a>("http://xml.org/sax/properties/lexical-handler", <strong class="reserved">null</strong>);
<a id="L471" name="L471"></a> 471             <em class="brace">}</em>
<a id="L472" name="L472"></a> 472             <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em><em class="brace">}</em>
<a id="L473" name="L473"></a> 473           <em class="brace">}</em>
<a id="L474" name="L474"></a> 474           <a href="../D/30662.html" title="Multiple defined in 2 places.">releaseXMLReader</a>(<a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>);
<a id="L475" name="L475"></a> 475         <em class="brace">}</em>
<a id="L476" name="L476"></a> 476       <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L477" name="L477"></a> 477 
<a id="L478" name="L478"></a> 478         <em class="comment">// It should have been handled by a derived class or the caller</em>
<a id="L479" name="L479"></a> 479         <em class="comment">// made a mistake.</em>
<a id="L480" name="L480"></a> 480         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/2144.html" title="Multiple defined in 2 places.">DTMException</a>(<a href="../S/5529.html#L33" title="Defined at 33 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">XMLMessages</a>.<a href="../S/5529.html#L82" title="Defined at 82 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">createXMLMessage</a>(<a href="../S/5541.html#L35" title="Defined at 35 in src/com/sun/org/apache/xml/internal/res/XMLErrorResources.java.">XMLErrorResources</a>.ER_NOT_SUPPORTED, <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em><a href="../S/2041.html#L132" title="Defined at 132 in src/java/nio/channels/Pipe.java.">source</a><em class="brace">}</em>)); <em class="comment">//"Not supported: " + source);</em>
<a id="L481" name="L481"></a> 481       <em class="brace">}</em>
<a id="L482" name="L482"></a> 482     <em class="brace">}</em>
<a id="L483" name="L483"></a> 483   <em class="brace">}</em>
<a id="L484" name="L484"></a> 484 
<div class="comment">
    Given a W3C DOM node, try and return a DTM handle.
    Note: calling this may be non-optimal, and there is no guarantee that
    the node will be found in any particular DTM.
    @param node Non-null reference to a DOM node.
    @return a valid DTM handle.</div>
<a id="L494" name="L494"></a> 494   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/15934.html" title="Multiple referred from 15 places.">getDTMHandleFromNode</a>(org.w3c.dom.<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L495" name="L495"></a> 495   <em class="brace">{</em>
<a id="L496" name="L496"></a> 496     <strong class="reserved">if</strong>(<strong class="reserved">null</strong> == <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L497" name="L497"></a> 497       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(<a href="../S/5529.html#L33" title="Defined at 33 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">XMLMessages</a>.<a href="../S/5529.html#L82" title="Defined at 82 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">createXMLMessage</a>(<a href="../S/5541.html#L35" title="Defined at 35 in src/com/sun/org/apache/xml/internal/res/XMLErrorResources.java.">XMLErrorResources</a>.ER_NODE_NON_NULL, <strong class="reserved">null</strong>)); <em class="comment">//"node must be non-null for getDTMHandleFromNode!");</em>
<a id="L498" name="L498"></a> 498 
<a id="L499" name="L499"></a> 499     <strong class="reserved">if</strong> (<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> <strong class="reserved">instanceof</strong> com.sun.org.apache.xml.internal.dtm.<a href="../S/986.html#L2252" title="Defined at 2252 in src/java/util/regex/Pattern.java.">ref</a>.<a href="../S/5916.html#L65" title="Defined at 65 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMNodeProxy.java.">DTMNodeProxy</a>)
<a id="L500" name="L500"></a> 500       <strong class="reserved">return</strong> ((com.sun.org.apache.xml.internal.dtm.<a href="../S/986.html#L2252" title="Defined at 2252 in src/java/util/regex/Pattern.java.">ref</a>.<a href="../S/5916.html#L65" title="Defined at 65 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMNodeProxy.java.">DTMNodeProxy</a>) <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>).<a href="../S/5916.html#L109" title="Defined at 109 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMNodeProxy.java.">getDTMNodeNumber</a>();
<a id="L501" name="L501"></a> 501 
<a id="L502" name="L502"></a> 502     <strong class="reserved">else</strong>
<a id="L503" name="L503"></a> 503     <em class="brace">{</em>
<a id="L504" name="L504"></a> 504       <em class="comment">// Find the DOM2DTMs wrapped around this Document (if any)</em>
<a id="L505" name="L505"></a> 505       <em class="comment">// and check whether they contain the Node in question.</em>
<a id="L506" name="L506"></a> 506       <em class="comment">//</em>
<a id="L507" name="L507"></a> 507       <em class="comment">// NOTE that since a DOM2DTM may represent a subtree rather</em>
<a id="L508" name="L508"></a> 508       <em class="comment">// than a full document, we have to be prepared to check more</em>
<a id="L509" name="L509"></a> 509       <em class="comment">// than one -- and there is no guarantee that we will find</em>
<a id="L510" name="L510"></a> 510       <em class="comment">// one that contains ancestors or siblings of the node we're</em>
<a id="L511" name="L511"></a> 511       <em class="comment">// seeking.</em>
<a id="L512" name="L512"></a> 512       <em class="comment">//</em>
<a id="L513" name="L513"></a> 513       <em class="comment">// %REVIEW% We could search for the one which contains this</em>
<a id="L514" name="L514"></a> 514       <em class="comment">// node at the deepest level, and thus covers the widest</em>
<a id="L515" name="L515"></a> 515       <em class="comment">// subtree, but that's going to entail additional work</em>
<a id="L516" name="L516"></a> 516       <em class="comment">// checking more DTMs... and getHandleOfNode is not a</em>
<a id="L517" name="L517"></a> 517       <em class="comment">// cheap operation in most implementations.</em>
<a id="L518" name="L518"></a> 518                         <em class="comment">//</em>
<a id="L519" name="L519"></a> 519                         <em class="comment">// TODO: %REVIEW% If overflow addressing, we may recheck a DTM</em>
<a id="L520" name="L520"></a> 520                         <em class="comment">// already examined. Ouch. But with the increased number of DTMs,</em>
<a id="L521" name="L521"></a> 521                         <em class="comment">// scanning back to check this is painful.</em>
<a id="L522" name="L522"></a> 522                         <em class="comment">// POSSIBLE SOLUTIONS:</em>
<a id="L523" name="L523"></a> 523                         <em class="comment">//   Generate a list of _unique_ DTM objects?</em>
<a id="L524" name="L524"></a> 524                         <em class="comment">//   Have each DTM cache last DOM node search?</em>
<a id="L525" name="L525"></a> 525                         <strong class="reserved">int</strong> <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a> = m_dtms.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L526" name="L526"></a> 526       <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i = 0; i &lt; <a href="../D/27569.html" title="Multiple defined in 28 places.">max</a>; i++)
<a id="L527" name="L527"></a> 527         <em class="brace">{</em>
<a id="L528" name="L528"></a> 528           <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> thisDTM=m_dtms[i];
<a id="L529" name="L529"></a> 529           <strong class="reserved">if</strong>((<strong class="reserved">null</strong> != thisDTM) &amp;&amp; thisDTM <strong class="reserved">instanceof</strong> <a href="../S/5895.html#L68" title="Defined at 68 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">DOM2DTM</a>)
<a id="L530" name="L530"></a> 530           <em class="brace">{</em>
<a id="L531" name="L531"></a> 531             <strong class="reserved">int</strong> <a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>=((<a href="../S/5895.html#L68" title="Defined at 68 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">DOM2DTM</a>)thisDTM).<a href="../D/19408.html" title="Multiple defined in 2 places.">getHandleOfNode</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L532" name="L532"></a> 532             <strong class="reserved">if</strong>(<a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>!=<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>) <strong class="reserved">return</strong> <a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>;
<a id="L533" name="L533"></a> 533           <em class="brace">}</em>
<a id="L534" name="L534"></a> 534          <em class="brace">}</em>
<a id="L535" name="L535"></a> 535 
<a id="L536" name="L536"></a> 536                         <em class="comment">// Not found; generate a new DTM.</em>
<a id="L537" name="L537"></a> 537                         <em class="comment">//</em>
<a id="L538" name="L538"></a> 538                         <em class="comment">// %REVIEW% Is this really desirable, or should we return null</em>
<a id="L539" name="L539"></a> 539                         <em class="comment">// and make folks explicitly instantiate from a DOMSource? The</em>
<a id="L540" name="L540"></a> 540                         <em class="comment">// latter is more work but gives the caller the opportunity to</em>
<a id="L541" name="L541"></a> 541                         <em class="comment">// explicitly add the DTM to a DTMManager... and thus to know when</em>
<a id="L542" name="L542"></a> 542                         <em class="comment">// it can be discarded again, which is something we need to pay much</em>
<a id="L543" name="L543"></a> 543                         <em class="comment">// more attention to. (Especially since only DTMs which are assigned</em>
<a id="L544" name="L544"></a> 544                         <em class="comment">// to a manager can use the overflow addressing scheme.)</em>
<a id="L545" name="L545"></a> 545                         <em class="comment">//</em>
<a id="L546" name="L546"></a> 546                         <em class="comment">// %BUG% If the source node was a DOM2DTM$defaultNamespaceDeclarationNode</em>
<a id="L547" name="L547"></a> 547                         <em class="comment">// and the DTM wasn't registered with this DTMManager, we will create</em>
<a id="L548" name="L548"></a> 548                         <em class="comment">// a new DTM and _still_ not be able to find the node (since it will</em>
<a id="L549" name="L549"></a> 549                         <em class="comment">// be resynthesized). Another reason to push hard on making all DTMs</em>
<a id="L550" name="L550"></a> 550                         <em class="comment">// be managed DTMs.</em>
<a id="L551" name="L551"></a> 551 
<a id="L552" name="L552"></a> 552                         <em class="comment">// Since the real root of our tree may be a DocumentFragment, we need to</em>
<a id="L553" name="L553"></a> 553       <em class="comment">// use getParent to find the root, instead of getOwnerDocument.  Otherwise</em>
<a id="L554" name="L554"></a> 554       <em class="comment">// DOM2DTM#getHandleOfNode will be very unhappy.</em>
<a id="L555" name="L555"></a> 555       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> <a href="../S/867.html#L1804" title="Defined at 1804 in src/java/util/HashMap.java.">root</a> = <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>;
<a id="L556" name="L556"></a> 556       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> p = (<a href="../S/867.html#L1804" title="Defined at 1804 in src/java/util/HashMap.java.">root</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>() == <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.ATTRIBUTE_NODE) ? ((org.w3c.dom.<a href="../S/54.html#L186" title="Defined at 186 in src/org/w3c/dom/Attr.java.">Attr</a>)<a href="../S/867.html#L1804" title="Defined at 1804 in src/java/util/HashMap.java.">root</a>).<a href="../D/21293.html" title="Multiple defined in 9 places.">getOwnerElement</a>() : <a href="../S/867.html#L1804" title="Defined at 1804 in src/java/util/HashMap.java.">root</a>.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>();
<a id="L557" name="L557"></a> 557       <strong class="reserved">for</strong> (; p != <strong class="reserved">null</strong>; p = p.<a href="../D/21403.html" title="Multiple defined in 15 places.">getParentNode</a>())
<a id="L558" name="L558"></a> 558       <em class="brace">{</em>
<a id="L559" name="L559"></a> 559         <a href="../S/867.html#L1804" title="Defined at 1804 in src/java/util/HashMap.java.">root</a> = p;
<a id="L560" name="L560"></a> 560       <em class="brace">}</em>
<a id="L561" name="L561"></a> 561 
<a id="L562" name="L562"></a> 562       <a href="../S/5895.html#L68" title="Defined at 68 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">DOM2DTM</a> dtm = (<a href="../S/5895.html#L68" title="Defined at 68 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">DOM2DTM</a>) <a href="../D/18175.html" title="Multiple defined in 19 places.">getDTM</a>(<strong class="reserved">new</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.dom.<a href="../S/4046.html#L44" title="Defined at 44 in src/javax/xml/transform/dom/DOMSource.java.">DOMSource</a>(<a href="../S/867.html#L1804" title="Defined at 1804 in src/java/util/HashMap.java.">root</a>),
<a id="L563" name="L563"></a> 563                                                                                                                                                  <strong class="reserved">false</strong>, <strong class="reserved">null</strong>, <strong class="reserved">true</strong>, <strong class="reserved">true</strong>);
<a id="L564" name="L564"></a> 564 
<a id="L565" name="L565"></a> 565       <strong class="reserved">int</strong> <a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>;
<a id="L566" name="L566"></a> 566 
<a id="L567" name="L567"></a> 567       <strong class="reserved">if</strong>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a> <strong class="reserved">instanceof</strong> com.sun.org.apache.xml.internal.dtm.<a href="../S/986.html#L2252" title="Defined at 2252 in src/java/util/regex/Pattern.java.">ref</a>.dom2dtm.<a href="../S/5894.html#L55" title="Defined at 55 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTMdefaultNamespaceDeclarationNode.java.">DOM2DTMdefaultNamespaceDeclarationNode</a>)
<a id="L568" name="L568"></a> 568       <em class="brace">{</em>
<a id="L569" name="L569"></a> 569                                 <em class="comment">// Can't return the same node since it's unique to a specific DTM,</em>
<a id="L570" name="L570"></a> 570                                 <em class="comment">// but can return the equivalent node -- find the corresponding</em>
<a id="L571" name="L571"></a> 571                                 <em class="comment">// Document Element, then ask it for the xml: namespace decl.</em>
<a id="L572" name="L572"></a> 572                                 <a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>=dtm.<a href="../D/19408.html" title="Multiple defined in 2 places.">getHandleOfNode</a>(((org.w3c.dom.<a href="../S/54.html#L186" title="Defined at 186 in src/org/w3c/dom/Attr.java.">Attr</a>)<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>).<a href="../D/21293.html" title="Multiple defined in 9 places.">getOwnerElement</a>());
<a id="L573" name="L573"></a> 573                                 <a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>=dtm.<a href="../D/17094.html" title="Multiple defined in 20 places.">getAttributeNode</a>(<a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>,<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20828.html" title="Multiple defined in 47 places.">getNamespaceURI</a>(),<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>.<a href="../D/20201.html" title="Multiple defined in 44 places.">getLocalName</a>());
<a id="L574" name="L574"></a> 574       <em class="brace">}</em>
<a id="L575" name="L575"></a> 575       <strong class="reserved">else</strong>
<a id="L576" name="L576"></a> 576                                 <a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a> = ((<a href="../S/5895.html#L68" title="Defined at 68 in src/com/sun/org/apache/xml/internal/dtm/ref/dom2dtm/DOM2DTM.java.">DOM2DTM</a>)dtm).<a href="../D/19408.html" title="Multiple defined in 2 places.">getHandleOfNode</a>(<a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>);
<a id="L577" name="L577"></a> 577 
<a id="L578" name="L578"></a> 578       <strong class="reserved">if</strong>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a> == <a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>)
<a id="L579" name="L579"></a> 579         <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>(<a href="../S/5529.html#L33" title="Defined at 33 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">XMLMessages</a>.<a href="../S/5529.html#L82" title="Defined at 82 in src/com/sun/org/apache/xml/internal/res/XMLMessages.java.">createXMLMessage</a>(<a href="../S/5541.html#L35" title="Defined at 35 in src/com/sun/org/apache/xml/internal/res/XMLErrorResources.java.">XMLErrorResources</a>.ER_COULD_NOT_RESOLVE_NODE, <strong class="reserved">null</strong>)); <em class="comment">//"Could not resolve the node to a handle!");</em>
<a id="L580" name="L580"></a> 580 
<a id="L581" name="L581"></a> 581       <strong class="reserved">return</strong> <a href="../D/23942.html" title="Multiple defined in 13 places.">handle</a>;
<a id="L582" name="L582"></a> 582     <em class="brace">}</em>
<a id="L583" name="L583"></a> 583   <em class="brace">}</em>
<a id="L584" name="L584"></a> 584 
<div class="comment">
    This method returns the SAX2 parser to use with the InputSource
    obtained from this URI.
    It may return null if any SAX2-conformant XML parser can be used,
    or if getInputSource() will also return null. The parser must
    be free for use (i.e., not currently in use for another parse().
    After use of the parser is completed, the releaseXMLReader(XMLReader)
    must be called.
    @param inputSource The value returned from the URIResolver.
    @return  a SAX2 XMLReader to use to resolve the inputSource argument.
    @return non-null XMLReader reference ready to parse.</div>
<a id="L599" name="L599"></a> 599   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <a href="../S/724.html#L84" title="Defined at 84 in src/org/xml/sax/XMLReader.java.">XMLReader</a> <a href="../R/19913.html" title="Multiple referred from 37 places.">getXMLReader</a>(<a href="../S/4049.html#L32" title="Defined at 32 in src/javax/xml/transform/Source.java.">Source</a> inputSource)
<a id="L600" name="L600"></a> 600   <em class="brace">{</em>
<a id="L601" name="L601"></a> 601 
<a id="L602" name="L602"></a> 602     <strong class="reserved">try</strong>
<a id="L603" name="L603"></a> 603     <em class="brace">{</em>
<a id="L604" name="L604"></a> 604       <a href="../S/724.html#L84" title="Defined at 84 in src/org/xml/sax/XMLReader.java.">XMLReader</a> <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a> = (inputSource <strong class="reserved">instanceof</strong> <a href="../S/4031.html#L45" title="Defined at 45 in src/javax/xml/transform/sax/SAXSource.java.">SAXSource</a>)
<a id="L605" name="L605"></a> 605                          ? ((<a href="../S/4031.html#L45" title="Defined at 45 in src/javax/xml/transform/sax/SAXSource.java.">SAXSource</a>) inputSource).<a href="../D/23755.html" title="Multiple defined in 9 places.">getXMLReader</a>() : <strong class="reserved">null</strong>;
<a id="L606" name="L606"></a> 606 
<a id="L607" name="L607"></a> 607       <em class="comment">// If user did not supply a reader, ask for one from the reader manager</em>
<a id="L608" name="L608"></a> 608       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>) <em class="brace">{</em>
<a id="L609" name="L609"></a> 609         <strong class="reserved">if</strong> (m_readerManager == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L610" name="L610"></a> 610             m_readerManager = <a href="../S/5841.html#L44" title="Defined at 44 in src/com/sun/org/apache/xml/internal/utils/XMLReaderManager.java.">XMLReaderManager</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>(<strong class="reserved">super</strong>.<a href="../D/36285.html" title="Multiple defined in 9 places.">useServicesMechnism</a>());
<a id="L611" name="L611"></a> 611         <em class="brace">}</em>
<a id="L612" name="L612"></a> 612 
<a id="L613" name="L613"></a> 613         <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a> = m_readerManager.<a href="../D/23755.html" title="Multiple defined in 9 places.">getXMLReader</a>();
<a id="L614" name="L614"></a> 614       <em class="brace">}</em>
<a id="L615" name="L615"></a> 615 
<a id="L616" name="L616"></a> 616       <strong class="reserved">return</strong> <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>;
<a id="L617" name="L617"></a> 617 
<a id="L618" name="L618"></a> 618     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/726.html#L62" title="Defined at 62 in src/org/xml/sax/SAXException.java.">SAXException</a> se) <em class="brace">{</em>
<a id="L619" name="L619"></a> 619       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/2144.html" title="Multiple defined in 2 places.">DTMException</a>(se.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>(), se);
<a id="L620" name="L620"></a> 620     <em class="brace">}</em>
<a id="L621" name="L621"></a> 621   <em class="brace">}</em>
<a id="L622" name="L622"></a> 622 
<div class="comment">
    Indicates that the XMLReader object is no longer in use for the transform.
    Note that the getXMLReader method may return an XMLReader that was
    specified on the SAXSource object by the application code.  Such a
    reader should still be passed to releaseXMLReader, but the reader manager
    will only re-use XMLReaders that it created.
    @param reader The XMLReader to be released.</div>
<a id="L633" name="L633"></a> 633   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25870.html" title="Multiple referred from 6 places.">releaseXMLReader</a>(<a href="../S/724.html#L84" title="Defined at 84 in src/org/xml/sax/XMLReader.java.">XMLReader</a> <a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>) <em class="brace">{</em>
<a id="L634" name="L634"></a> 634     <strong class="reserved">if</strong> (m_readerManager != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L635" name="L635"></a> 635       m_readerManager.<a href="../D/30662.html" title="Multiple defined in 2 places.">releaseXMLReader</a>(<a href="../S/1437.html#L135" title="Defined at 135 in src/java/io/Console.java.">reader</a>);
<a id="L636" name="L636"></a> 636     <em class="brace">}</em>
<a id="L637" name="L637"></a> 637   <em class="brace">}</em>
<a id="L638" name="L638"></a> 638 
<div class="comment">
    Return the DTM object containing a representation of this node.
    @param nodeHandle DTM Handle indicating which node to retrieve
    @return a reference to the DTM object containing this node.</div>
<a id="L646" name="L646"></a> 646   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> <a href="../R/15933.html" title="Multiple referred from 85 places.">getDTM</a>(<strong class="reserved">int</strong> nodeHandle)
<a id="L647" name="L647"></a> 647   <em class="brace">{</em>
<a id="L648" name="L648"></a> 648     <strong class="reserved">try</strong>
<a id="L649" name="L649"></a> 649     <em class="brace">{</em>
<a id="L650" name="L650"></a> 650       <em class="comment">// Performance critical function.</em>
<a id="L651" name="L651"></a> 651       <strong class="reserved">return</strong> m_dtms[nodeHandle &gt;&gt;&gt; IDENT_DTM_NODE_BITS];
<a id="L652" name="L652"></a> 652     <em class="brace">}</em>
<a id="L653" name="L653"></a> 653     <strong class="reserved">catch</strong>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../S/1761.html#L37" title="Defined at 37 in src/java/lang/ArrayIndexOutOfBoundsException.java.">ArrayIndexOutOfBoundsException</a> e)
<a id="L654" name="L654"></a> 654     <em class="brace">{</em>
<a id="L655" name="L655"></a> 655       <strong class="reserved">if</strong>(nodeHandle==<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a>.<a href="../S/2603.html#L115" title="Defined at 115 in src/java/sql/JDBCType.java.">NULL</a>)
<a id="L656" name="L656"></a> 656                                 <strong class="reserved">return</strong> <strong class="reserved">null</strong>;            <em class="comment">// Accept as a special case.</em>
<a id="L657" name="L657"></a> 657       <strong class="reserved">else</strong>
<a id="L658" name="L658"></a> 658                                 <strong class="reserved">throw</strong> e;                <em class="comment">// Programming error; want to know about it.</em>
<a id="L659" name="L659"></a> 659     <em class="brace">}</em>
<a id="L660" name="L660"></a> 660   <em class="brace">}</em>
<a id="L661" name="L661"></a> 661 
<div class="comment">
    Given a DTM, find the ID number in the DTM tables which addresses
    the start of the document. If overflow addressing is in use, other
    DTM IDs may also be assigned to this DTM.
    @param dtm The DTM which (hopefully) contains this node.
    @return The DTM ID (as the high bits of a NodeHandle, not as our
    internal index), or -1 if the DTM doesn't belong to this manager.</div>
<a id="L672" name="L672"></a> 672   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/15937.html" title="Multiple referred from 4 places.">getDTMIdentity</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm)
<a id="L673" name="L673"></a> 673   <em class="brace">{</em>
<a id="L674" name="L674"></a> 674         <em class="comment">// Shortcut using DTMDefaultBase's extension hooks</em>
<a id="L675" name="L675"></a> 675         <em class="comment">// %REVIEW% Should the lookup be part of the basic DTM API?</em>
<a id="L676" name="L676"></a> 676         <strong class="reserved">if</strong>(dtm <strong class="reserved">instanceof</strong> <a href="../S/5889.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">DTMDefaultBase</a>)
<a id="L677" name="L677"></a> 677         <em class="brace">{</em>
<a id="L678" name="L678"></a> 678                 <a href="../S/5889.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">DTMDefaultBase</a> dtmdb=(<a href="../S/5889.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">DTMDefaultBase</a>)dtm;
<a id="L679" name="L679"></a> 679                 <strong class="reserved">if</strong>(dtmdb.<a href="../S/5889.html#L2355" title="Defined at 2355 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">getManager</a>()==<strong class="reserved">this</strong>)
<a id="L680" name="L680"></a> 680                         <strong class="reserved">return</strong> dtmdb.<a href="../S/5889.html#L2366" title="Defined at 2366 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">getDTMIDs</a>().<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(0);
<a id="L681" name="L681"></a> 681                 <strong class="reserved">else</strong>
<a id="L682" name="L682"></a> 682                         <strong class="reserved">return</strong> -1;
<a id="L683" name="L683"></a> 683         <em class="brace">}</em>
<a id="L684" name="L684"></a> 684 
<a id="L685" name="L685"></a> 685     <strong class="reserved">int</strong> n = m_dtms.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>;
<a id="L686" name="L686"></a> 686 
<a id="L687" name="L687"></a> 687     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; n; i++)
<a id="L688" name="L688"></a> 688     <em class="brace">{</em>
<a id="L689" name="L689"></a> 689       <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> tdtm = m_dtms[i];
<a id="L690" name="L690"></a> 690 
<a id="L691" name="L691"></a> 691       <strong class="reserved">if</strong> (tdtm == dtm &amp;&amp; m_dtm_offsets[i]==0)
<a id="L692" name="L692"></a> 692         <strong class="reserved">return</strong> i &lt;&lt; IDENT_DTM_NODE_BITS;
<a id="L693" name="L693"></a> 693     <em class="brace">}</em>
<a id="L694" name="L694"></a> 694 
<a id="L695" name="L695"></a> 695     <strong class="reserved">return</strong> -1;
<a id="L696" name="L696"></a> 696   <em class="brace">}</em>
<a id="L697" name="L697"></a> 697 
<div class="comment">
    Release the DTMManager's reference(s) to a DTM, making it unmanaged.
    This is typically done as part of returning the DTM to the heap after
    we're done with it.
    @param dtm the DTM to be released.
    @param shouldHardDelete If false, this call is a suggestion rather than an
    order, and we may not actually release the DTM. This is intended to
    support intelligent caching of documents... which is not implemented
    in this version of the DTM manager.
    @return true if the DTM was released, false if shouldHardDelete was set
    and we decided not to.</div>
<a id="L713" name="L713"></a> 713   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/25846.html" title="Multiple referred from 40 places.">release</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm, <strong class="reserved">boolean</strong> shouldHardDelete)
<a id="L714" name="L714"></a> 714   <em class="brace">{</em>
<a id="L715" name="L715"></a> 715     <strong class="reserved">if</strong>(DEBUG)
<a id="L716" name="L716"></a> 716     <em class="brace">{</em>
<a id="L717" name="L717"></a> 717       <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1038.html#L2317" title="Defined at 2317 in src/java/util/Formatter.java.">out</a>.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>("Releasing "+
<a id="L718" name="L718"></a> 718                          (shouldHardDelete ? "HARD" : "soft")+
<a id="L719" name="L719"></a> 719                          " dtm="+
<a id="L720" name="L720"></a> 720                          <em class="comment">// Following shouldn't need a nodeHandle, but does...</em>
<a id="L721" name="L721"></a> 721                          <em class="comment">// and doesn't seem to report the intended value</em>
<a id="L722" name="L722"></a> 722                          dtm.<a href="../D/18556.html" title="Multiple defined in 5 places.">getDocumentBaseURI</a>()
<a id="L723" name="L723"></a> 723                          );
<a id="L724" name="L724"></a> 724     <em class="brace">}</em>
<a id="L725" name="L725"></a> 725 
<a id="L726" name="L726"></a> 726     <strong class="reserved">if</strong> (dtm <strong class="reserved">instanceof</strong> <a href="../S/5892.html#L50" title="Defined at 50 in src/com/sun/org/apache/xml/internal/dtm/ref/sax2dtm/SAX2DTM.java.">SAX2DTM</a>)
<a id="L727" name="L727"></a> 727     <em class="brace">{</em>
<a id="L728" name="L728"></a> 728       ((<a href="../S/5892.html#L50" title="Defined at 50 in src/com/sun/org/apache/xml/internal/dtm/ref/sax2dtm/SAX2DTM.java.">SAX2DTM</a>) dtm).<a href="../D/12832.html" title="Multiple defined in 2 places.">clearCoRoutine</a>();
<a id="L729" name="L729"></a> 729     <em class="brace">}</em>
<a id="L730" name="L730"></a> 730 
<a id="L731" name="L731"></a> 731                 <em class="comment">// Multiple DTM IDs may be assigned to a single DTM.</em>
<a id="L732" name="L732"></a> 732                 <em class="comment">// The Right Answer is to ask which (if it supports</em>
<a id="L733" name="L733"></a> 733                 <em class="comment">// extension, the DTM will need a list anyway). The</em>
<a id="L734" name="L734"></a> 734                 <em class="comment">// Wrong Answer, applied if the DTM can't help us,</em>
<a id="L735" name="L735"></a> 735                 <em class="comment">// is to linearly search them all; this may be very</em>
<a id="L736" name="L736"></a> 736                 <em class="comment">// painful.</em>
<a id="L737" name="L737"></a> 737                 <em class="comment">//</em>
<a id="L738" name="L738"></a> 738                 <em class="comment">// %REVIEW% Should the lookup move up into the basic DTM API?</em>
<a id="L739" name="L739"></a> 739                 <strong class="reserved">if</strong>(dtm <strong class="reserved">instanceof</strong> <a href="../S/5889.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">DTMDefaultBase</a>)
<a id="L740" name="L740"></a> 740                 <em class="brace">{</em>
<a id="L741" name="L741"></a> 741                         com.sun.org.apache.xml.internal.utils.<a href="../S/5856.html#L45" title="Defined at 45 in src/com/sun/org/apache/xml/internal/utils/SuballocatedIntVector.java.">SuballocatedIntVector</a> ids=((<a href="../S/5889.html#L46" title="Defined at 46 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">DTMDefaultBase</a>)dtm).<a href="../S/5889.html#L2366" title="Defined at 2366 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">getDTMIDs</a>();
<a id="L742" name="L742"></a> 742                         <strong class="reserved">for</strong>(<strong class="reserved">int</strong> i=ids.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()-1;i&gt;=0;--i)
<a id="L743" name="L743"></a> 743                                 m_dtms[ids.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(i)&gt;&gt;&gt;<a href="../S/5920.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/dtm/DTMManager.java.">DTMManager</a>.IDENT_DTM_NODE_BITS]=<strong class="reserved">null</strong>;
<a id="L744" name="L744"></a> 744                 <em class="brace">}</em>
<a id="L745" name="L745"></a> 745                 <strong class="reserved">else</strong>
<a id="L746" name="L746"></a> 746                 <em class="brace">{</em>
<a id="L747" name="L747"></a> 747                         <strong class="reserved">int</strong> i = <a href="../D/18180.html" title="Multiple defined in 4 places.">getDTMIdentity</a>(dtm);
<a id="L748" name="L748"></a> 748                     <strong class="reserved">if</strong> (i &gt;= 0)
<a id="L749" name="L749"></a> 749                         <em class="brace">{</em>
<a id="L750" name="L750"></a> 750                                 m_dtms[i &gt;&gt;&gt; <a href="../S/5920.html#L52" title="Defined at 52 in src/com/sun/org/apache/xml/internal/dtm/DTMManager.java.">DTMManager</a>.IDENT_DTM_NODE_BITS] = <strong class="reserved">null</strong>;
<a id="L751" name="L751"></a> 751                         <em class="brace">}</em>
<a id="L752" name="L752"></a> 752                 <em class="brace">}</em>
<a id="L753" name="L753"></a> 753 
<a id="L754" name="L754"></a> 754     dtm.<a href="../D/15107.html" title="Multiple defined in 5 places.">documentRelease</a>();
<a id="L755" name="L755"></a> 755     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L756" name="L756"></a> 756   <em class="brace">}</em>
<a id="L757" name="L757"></a> 757 
<div class="comment">
    Method createDocumentFragment
    NEEDSDOC (createDocumentFragment) @return</div>
<a id="L764" name="L764"></a> 764   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> <a href="../R/12382.html" title="Multiple referred from 13 places.">createDocumentFragment</a>()
<a id="L765" name="L765"></a> 765   <em class="brace">{</em>
<a id="L766" name="L766"></a> 766 
<a id="L767" name="L767"></a> 767     <strong class="reserved">try</strong>
<a id="L768" name="L768"></a> 768     <em class="brace">{</em>
<a id="L769" name="L769"></a> 769       <a href="../S/3849.html#L41" title="Defined at 41 in src/javax/xml/parsers/DocumentBuilderFactory.java.">DocumentBuilderFactory</a> dbf = <a href="../S/6247.html#L35" title="Defined at 35 in src/com/sun/org/apache/xalan/internal/utils/FactoryImpl.java.">FactoryImpl</a>.<a href="../D/18157.html" title="Multiple defined in 2 places.">getDOMFactory</a>(<strong class="reserved">super</strong>.<a href="../D/36285.html" title="Multiple defined in 9 places.">useServicesMechnism</a>());
<a id="L770" name="L770"></a> 770       dbf.<a href="../D/33323.html" title="Multiple defined in 3 places.">setNamespaceAware</a>(<strong class="reserved">true</strong>);
<a id="L771" name="L771"></a> 771 
<a id="L772" name="L772"></a> 772       <a href="../S/3846.html#L62" title="Defined at 62 in src/javax/xml/parsers/DocumentBuilder.java.">DocumentBuilder</a> db = dbf.<a href="../D/27987.html" title="Multiple defined in 2 places.">newDocumentBuilder</a>();
<a id="L773" name="L773"></a> 773       <a href="../D/2543.html" title="Multiple defined in 2 places.">Document</a> doc = db.<a href="../D/27986.html" title="Multiple defined in 3 places.">newDocument</a>();
<a id="L774" name="L774"></a> 774       <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a> df = doc.<a href="../D/13813.html" title="Multiple defined in 8 places.">createDocumentFragment</a>();
<a id="L775" name="L775"></a> 775 
<a id="L776" name="L776"></a> 776       <strong class="reserved">return</strong> <a href="../D/18175.html" title="Multiple defined in 19 places.">getDTM</a>(<strong class="reserved">new</strong> <a href="../S/4046.html#L44" title="Defined at 44 in src/javax/xml/transform/dom/DOMSource.java.">DOMSource</a>(df), <strong class="reserved">true</strong>, <strong class="reserved">null</strong>, <strong class="reserved">false</strong>, <strong class="reserved">false</strong>);
<a id="L777" name="L777"></a> 777     <em class="brace">}</em>
<a id="L778" name="L778"></a> 778     <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e)
<a id="L779" name="L779"></a> 779     <em class="brace">{</em>
<a id="L780" name="L780"></a> 780       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/2144.html" title="Multiple defined in 2 places.">DTMException</a>(e);
<a id="L781" name="L781"></a> 781     <em class="brace">}</em>
<a id="L782" name="L782"></a> 782   <em class="brace">}</em>
<a id="L783" name="L783"></a> 783 
<div class="comment">
    NEEDSDOC Method createDTMIterator
    NEEDSDOC @param whatToShow
    NEEDSDOC @param filter
    NEEDSDOC @param entityReferenceExpansion
    NEEDSDOC (createDTMIterator) @return</div>
<a id="L794" name="L794"></a> 794   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a> <a href="../R/12321.html" title="Multiple referred from 4 places.">createDTMIterator</a>(<strong class="reserved">int</strong> whatToShow, <a href="../S/5886.html#L29" title="Defined at 29 in src/com/sun/org/apache/xml/internal/dtm/DTMFilter.java.">DTMFilter</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>,
<a id="L795" name="L795"></a> 795                                        <strong class="reserved">boolean</strong> entityReferenceExpansion)
<a id="L796" name="L796"></a> 796   <em class="brace">{</em>
<a id="L797" name="L797"></a> 797 
<div class="comment">
     /** @todo: implement this com.sun.org.apache.xml.internal.dtm.DTMManager abstract method */</div>
<a id="L799" name="L799"></a> 799     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L800" name="L800"></a> 800   <em class="brace">}</em>
<a id="L801" name="L801"></a> 801 
<div class="comment">
    NEEDSDOC Method createDTMIterator
    NEEDSDOC @param xpathString
    NEEDSDOC @param presolver
    NEEDSDOC (createDTMIterator) @return</div>
<a id="L811" name="L811"></a> 811   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a> <a href="../R/12321.html" title="Multiple referred from 4 places.">createDTMIterator</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> xpathString,
<a id="L812" name="L812"></a> 812                                        <a href="../S/5879.html#L32" title="Defined at 32 in src/com/sun/org/apache/xml/internal/utils/PrefixResolver.java.">PrefixResolver</a> presolver)
<a id="L813" name="L813"></a> 813   <em class="brace">{</em>
<a id="L814" name="L814"></a> 814 
<div class="comment">
     /** @todo: implement this com.sun.org.apache.xml.internal.dtm.DTMManager abstract method */</div>
<a id="L816" name="L816"></a> 816     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L817" name="L817"></a> 817   <em class="brace">}</em>
<a id="L818" name="L818"></a> 818 
<div class="comment">
    NEEDSDOC Method createDTMIterator
    NEEDSDOC @param node
    NEEDSDOC (createDTMIterator) @return</div>
<a id="L827" name="L827"></a> 827   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a> <a href="../R/12321.html" title="Multiple referred from 4 places.">createDTMIterator</a>(<strong class="reserved">int</strong> <a href="../D/28235.html" title="Multiple defined in 11 places.">node</a>)
<a id="L828" name="L828"></a> 828   <em class="brace">{</em>
<a id="L829" name="L829"></a> 829 
<div class="comment">
     /** @todo: implement this com.sun.org.apache.xml.internal.dtm.DTMManager abstract method */</div>
<a id="L831" name="L831"></a> 831     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L832" name="L832"></a> 832   <em class="brace">}</em>
<a id="L833" name="L833"></a> 833 
<div class="comment">
    NEEDSDOC Method createDTMIterator
    NEEDSDOC @param xpathCompiler
    NEEDSDOC @param pos
    NEEDSDOC (createDTMIterator) @return</div>
<a id="L843" name="L843"></a> 843   <strong class="reserved">synchronized</strong> <strong class="reserved">public</strong> <a href="../S/5921.html#L51" title="Defined at 51 in src/com/sun/org/apache/xml/internal/dtm/DTMIterator.java.">DTMIterator</a> <a href="../R/12321.html" title="Multiple referred from 4 places.">createDTMIterator</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> xpathCompiler, <strong class="reserved">int</strong> pos)
<a id="L844" name="L844"></a> 844   <em class="brace">{</em>
<a id="L845" name="L845"></a> 845 
<div class="comment">
     /** @todo: implement this com.sun.org.apache.xml.internal.dtm.DTMManager abstract method */</div>
<a id="L847" name="L847"></a> 847     <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L848" name="L848"></a> 848   <em class="brace">}</em>
<a id="L849" name="L849"></a> 849 
<div class="comment">
    return the expanded name table.
    NEEDSDOC @param dtm
    NEEDSDOC ($objectName$) @return</div>
<a id="L857" name="L857"></a> 857   <strong class="reserved">public</strong> <a href="../S/5887.html#L39" title="Defined at 39 in src/com/sun/org/apache/xml/internal/dtm/ref/ExpandedNameTable.java.">ExpandedNameTable</a> <a href="../S/5889.html#L241" title="Referred from 241 in src/com/sun/org/apache/xml/internal/dtm/ref/DTMDefaultBase.java.">getExpandedNameTable</a>(<a href="../S/5924.html#L80" title="Defined at 80 in src/com/sun/org/apache/xml/internal/dtm/DTM.java.">DTM</a> dtm)
<a id="L858" name="L858"></a> 858   <em class="brace">{</em>
<a id="L859" name="L859"></a> 859     <strong class="reserved">return</strong> m_expandedNameTable;
<a id="L860" name="L860"></a> 860   <em class="brace">}</em>
<a id="L861" name="L861"></a> 861 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L133">[^]</a><a href="#L857">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>