<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L103">[^]</a><a href="#L2293">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L103" title="Defined at 103.">initXPath</a></li>
<li><a href="#L179" title="Defined at 179.">initMatchPattern</a></li>
<li><a href="#L241" title="Defined at 241.">setErrorHandler</a></li>
<li><a href="#L251" title="Defined at 251.">getErrorListener</a></li>
<li><a href="#L264" title="Defined at 264.">tokenIs</a></li>
<li><a href="#L277" title="Defined at 277.">tokenIs</a></li>
<li><a href="#L292" title="Defined at 292.">lookahead</a></li>
<li><a href="#L327" title="Defined at 327.">lookbehind</a></li>
<li><a href="#L368" title="Defined at 368.">lookbehindHasToken</a></li>
<li><a href="#L399" title="Defined at 399.">lookahead</a></li>
<li><a href="#L422" title="Defined at 422.">nextToken</a></li>
<li><a href="#L445" title="Defined at 445.">getTokenRelative</a></li>
<li><a href="#L467" title="Defined at 467.">prevToken</a></li>
<li><a href="#L492" title="Defined at 492.">consumeExpected</a></li>
<li><a href="#L520" title="Defined at 520.">consumeExpected</a></li>
<li><a href="#L553" title="Defined at 553.">warn</a></li>
<li><a href="#L580" title="Defined at 580.">assertion</a></li>
<li><a href="#L606" title="Defined at 606.">error</a></li>
<li><a href="#L651" title="Defined at 651.">errorForDOM3</a></li>
<li><a href="#L676" title="Defined at 676.">dumpRemainingTokenQueue</a></li>
<li><a href="#L712" title="Defined at 712.">getFunctionToken</a></li>
<li><a href="#L748" title="Defined at 748.">insertOp</a></li>
<li><a href="#L770" title="Defined at 770.">appendOp</a></li>
<li><a href="#L790" title="Defined at 790.">Expr</a></li>
<li><a href="#L804" title="Defined at 804.">OrExpr</a></li>
<li><a href="#L831" title="Defined at 831.">AndExpr</a></li>
<li><a href="#L864" title="Defined at 864.">EqualityExpr</a></li>
<li><a href="#L924" title="Defined at 924.">RelationalExpr</a></li>
<li><a href="#L999" title="Defined at 999.">AdditiveExpr</a></li>
<li><a href="#L1057" title="Defined at 1057.">MultiplicativeExpr</a></li>
<li><a href="#L1130" title="Defined at 1130.">UnaryExpr</a></li>
<li><a href="#L1158" title="Defined at 1158.">StringExpr</a></li>
<li><a href="#L1178" title="Defined at 1178.">BooleanExpr</a></li>
<li><a href="#L1204" title="Defined at 1204.">NumberExpr</a></li>
<li><a href="#L1229" title="Defined at 1229.">UnionExpr</a></li>
<li><a href="#L1275" title="Defined at 1275.">PathExpr</a></li>
<li><a href="#L1340" title="Defined at 1340.">FilterExpr</a></li>
<li><a href="#L1396" title="Defined at 1396.">PrimaryExpr</a></li>
<li><a href="#L1465" title="Defined at 1465.">Argument</a></li>
<li><a href="#L1485" title="Defined at 1485.">FunctionCall</a></li>
<li><a href="#L1574" title="Defined at 1574.">LocationPath</a></li>
<li><a href="#L1625" title="Defined at 1625.">RelativeLocationPath</a></li>
<li><a href="#L1657" title="Defined at 1657.">Step</a></li>
<li><a href="#L1757" title="Defined at 1757.">Basis</a></li>
<li><a href="#L1804" title="Defined at 1804.">AxisName</a></li>
<li><a href="#L1832" title="Defined at 1832.">NodeTest</a></li>
<li><a href="#L1932" title="Defined at 1932.">Predicate</a></li>
<li><a href="#L1950" title="Defined at 1950.">PredicateExpr</a></li>
<li><a href="#L1972" title="Defined at 1972.">QName</a></li>
<li><a href="#L2000" title="Defined at 2000.">NCName</a></li>
<li><a href="#L2019" title="Defined at 2019.">Literal</a></li>
<li><a href="#L2059" title="Defined at 2059.">Number</a></li>
<li><a href="#L2102" title="Defined at 2102.">Pattern</a></li>
<li><a href="#L2130" title="Defined at 2130.">LocationPathPattern</a></li>
<li><a href="#L2233" title="Defined at 2233.">IdKeyPattern</a></li>
<li><a href="#L2246" title="Defined at 2246.">RelativePathPattern</a></li>
<li><a href="#L2276" title="Defined at 2276.">StepPattern</a></li>
<li><a href="#L2293" title="Defined at 2293.">AbbreviatedNodeTestStep</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 2007, 2015, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<div class="comment">
  Copyright 1999-2004 The Apache Software Foundation.
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
      http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.</div>
<div class="comment">
  $Id: XPathParser.java,v 1.2.4.1 2005/09/14 19:46:02 jeffsuttor Exp $</div>
<a id="L23" name="L23"></a>  23 <strong class="reserved">package</strong> com.sun.org.apache.xpath.internal.compiler;
<a id="L24" name="L24"></a>  24 
<a id="L25" name="L25"></a>  25 <strong class="reserved">import</strong> javax.xml.transform.ErrorListener;
<a id="L26" name="L26"></a>  26 <strong class="reserved">import</strong> javax.xml.transform.TransformerException;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 <strong class="reserved">import</strong> com.sun.org.apache.xalan.internal.res.XSLMessages;
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> com.sun.org.apache.xml.internal.utils.PrefixResolver;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.XPathProcessorException;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.domapi.XPathStylesheetDOM3Exception;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.objects.XNumber;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.objects.XString;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> com.sun.org.apache.xpath.internal.res.XPATHErrorResources;
<a id="L35" name="L35"></a>  35 
<div class="comment">
  Tokenizes and parses XPath expressions. This should really be named
  XPathParserImpl, and may be renamed in the future.
  @xsl.usage general</div>
<a id="L41" name="L41"></a>  41 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/9144.html" title="Multiple referred from 702 places.">XPathParser</a>
<a id="L42" name="L42"></a>  42 <em class="brace">{</em>
<a id="L43" name="L43"></a>  43         <em class="comment">// %REVIEW% Is there a better way of doing this?</em>
<a id="L44" name="L44"></a>  44         <em class="comment">// Upside is minimum object churn. Downside is that we don't have a useful</em>
<a id="L45" name="L45"></a>  45         <em class="comment">// backtrace in the exception itself -- but we don't expect to need one.</em>
<a id="L46" name="L46"></a>  46         <strong class="reserved">static</strong> <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> CONTINUE_AFTER_FATAL_ERROR="CONTINUE_AFTER_FATAL_ERROR";
<a id="L47" name="L47"></a>  47 
<div class="comment">
    The XPath to be processed.</div>
<a id="L51" name="L51"></a>  51   <strong class="reserved">private</strong> <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a> m_ops;
<a id="L52" name="L52"></a>  52 
<div class="comment">
    The next token in the pattern.</div>
<a id="L56" name="L56"></a>  56   <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> m_token;
<a id="L57" name="L57"></a>  57 
<div class="comment">
    The first char in m_token, the theory being that this
    is an optimization because we won't have to do charAt(0) as
    often.</div>
<a id="L63" name="L63"></a>  63   <strong class="reserved">transient</strong> <strong class="reserved">char</strong> m_tokenChar = 0;
<a id="L64" name="L64"></a>  64 
<div class="comment">
    The position in the token queue is tracked by m_queueMark.</div>
<a id="L68" name="L68"></a>  68   <strong class="reserved">int</strong> m_queueMark = 0;
<a id="L69" name="L69"></a>  69 
<div class="comment">
    Results from checking FilterExpr syntax</div>
<a id="L73" name="L73"></a>  73   <strong class="reserved">protected</strong> <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> FILTER_MATCH_FAILED     = 0;
<a id="L74" name="L74"></a>  74   <strong class="reserved">protected</strong> <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> FILTER_MATCH_PRIMARY    = 1;
<a id="L75" name="L75"></a>  75   <strong class="reserved">protected</strong> <strong class="reserved">final</strong> <strong class="reserved">static</strong> <strong class="reserved">int</strong> FILTER_MATCH_PREDICATES = 2;
<a id="L76" name="L76"></a>  76 
<div class="comment">
    The parser constructor.</div>
<a id="L80" name="L80"></a>  80   <strong class="reserved">public</strong> XPathParser(<a href="../S/4030.html#L53" title="Defined at 53 in src/javax/xml/transform/ErrorListener.java.">ErrorListener</a> errorListener, <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4044.html#L32" title="Defined at 32 in src/javax/xml/transform/SourceLocator.java.">SourceLocator</a> sourceLocator)
<a id="L81" name="L81"></a>  81   <em class="brace">{</em>
<a id="L82" name="L82"></a>  82     m_errorListener = errorListener;
<a id="L83" name="L83"></a>  83     m_sourceLocator = sourceLocator;
<a id="L84" name="L84"></a>  84   <em class="brace">}</em>
<a id="L85" name="L85"></a>  85 
<div class="comment">
    The prefix resolver to map prefixes to namespaces in the OpMap.</div>
<a id="L89" name="L89"></a>  89   <a href="../S/5879.html#L32" title="Defined at 32 in src/com/sun/org/apache/xml/internal/utils/PrefixResolver.java.">PrefixResolver</a> m_namespaceContext;
<a id="L90" name="L90"></a>  90 
<div class="comment">
    Given an string, init an XPath object for selections,
    in order that a parse doesn't
    have to be done each time the expression is evaluated.
    @param compiler The compiler object.
    @param expression A string conforming to the XPath grammar.
    @param namespaceContext An object that is able to resolve prefixes in
    the XPath to namespaces.
    @throws javax.xml.transform.TransformerException</div>
<a id="L103" name="L103"></a> 103   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/20675.html" title="Multiple referred from 3 places.">initXPath</a>(
<a id="L104" name="L104"></a> 104           <a href="../D/1702.html" title="Multiple defined in 2 places.">Compiler</a> compiler, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6694.html#L1816" title="Defined at 1816 in src/com/sun/java/swing/plaf/gtk/Metacity.java.">expression</a>, <a href="../S/5879.html#L32" title="Defined at 32 in src/com/sun/org/apache/xml/internal/utils/PrefixResolver.java.">PrefixResolver</a> namespaceContext)
<a id="L105" name="L105"></a> 105             <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L106" name="L106"></a> 106   <em class="brace">{</em>
<a id="L107" name="L107"></a> 107 
<a id="L108" name="L108"></a> 108     m_ops = compiler;
<a id="L109" name="L109"></a> 109     m_namespaceContext = namespaceContext;
<a id="L110" name="L110"></a> 110     m_functionTable = compiler.<a href="../S/4997.html#L628" title="Defined at 628 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">getFunctionTable</a>();
<a id="L111" name="L111"></a> 111 
<a id="L112" name="L112"></a> 112     <a href="../S/5000.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/Lexer.java.">Lexer</a> lexer = <strong class="reserved">new</strong> <a href="../S/5000.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/Lexer.java.">Lexer</a>(compiler, namespaceContext, <strong class="reserved">this</strong>);
<a id="L113" name="L113"></a> 113 
<a id="L114" name="L114"></a> 114     lexer.<a href="../D/35549.html" title="Multiple defined in 6 places.">tokenize</a>(<a href="../S/6694.html#L1816" title="Defined at 1816 in src/com/sun/java/swing/plaf/gtk/Metacity.java.">expression</a>);
<a id="L115" name="L115"></a> 115 
<a id="L116" name="L116"></a> 116     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(0,<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_XPATH);
<a id="L117" name="L117"></a> 117     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,2);
<a id="L118" name="L118"></a> 118 
<a id="L119" name="L119"></a> 119 
<a id="L120" name="L120"></a> 120         <em class="comment">// Patch for Christine's gripe. She wants her errorHandler to return from</em>
<a id="L121" name="L121"></a> 121         <em class="comment">// a fatal error and continue trying to parse, rather than throwing an exception.</em>
<a id="L122" name="L122"></a> 122         <em class="comment">// Without the patch, that put us into an endless loop.</em>
<a id="L123" name="L123"></a> 123         <em class="comment">//</em>
<a id="L124" name="L124"></a> 124         <em class="comment">// %REVIEW% Is there a better way of doing this?</em>
<a id="L125" name="L125"></a> 125         <em class="comment">// %REVIEW% Are there any other cases which need the safety net?</em>
<a id="L126" name="L126"></a> 126         <em class="comment">//      (and if so do we care right now, or should we rewrite the XPath</em>
<a id="L127" name="L127"></a> 127         <em class="comment">//      grammar engine and can fix it at that time?)</em>
<a id="L128" name="L128"></a> 128         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L129" name="L129"></a> 129 
<a id="L130" name="L130"></a> 130       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L131" name="L131"></a> 131       <a href="../S/4999.html#L790" title="Defined at 790 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Expr</a>();
<a id="L132" name="L132"></a> 132 
<a id="L133" name="L133"></a> 133       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L134" name="L134"></a> 134       <em class="brace">{</em>
<a id="L135" name="L135"></a> 135         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> extraTokens = "";
<a id="L136" name="L136"></a> 136 
<a id="L137" name="L137"></a> 137         <strong class="reserved">while</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L138" name="L138"></a> 138         <em class="brace">{</em>
<a id="L139" name="L139"></a> 139           extraTokens += "'" + m_token + "'";
<a id="L140" name="L140"></a> 140 
<a id="L141" name="L141"></a> 141           <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L142" name="L142"></a> 142 
<a id="L143" name="L143"></a> 143           <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L144" name="L144"></a> 144             extraTokens += ", ";
<a id="L145" name="L145"></a> 145         <em class="brace">}</em>
<a id="L146" name="L146"></a> 146 
<a id="L147" name="L147"></a> 147         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXTRA_ILLEGAL_TOKENS,
<a id="L148" name="L148"></a> 148               <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> extraTokens <em class="brace">}</em>);  <em class="comment">//"Extra illegal tokens: "+extraTokens);</em>
<a id="L149" name="L149"></a> 149       <em class="brace">}</em>
<a id="L150" name="L150"></a> 150 
<a id="L151" name="L151"></a> 151     <em class="brace">}</em>
<a id="L152" name="L152"></a> 152     <strong class="reserved">catch</strong> (com.sun.org.apache.xpath.internal.<a href="../S/4893.html#L30" title="Defined at 30 in src/com/sun/org/apache/xpath/internal/XPathProcessorException.java.">XPathProcessorException</a> e)
<a id="L153" name="L153"></a> 153     <em class="brace">{</em>
<a id="L154" name="L154"></a> 154           <strong class="reserved">if</strong>(CONTINUE_AFTER_FATAL_ERROR.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(e.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>()))
<a id="L155" name="L155"></a> 155           <em class="brace">{</em>
<a id="L156" name="L156"></a> 156                 <em class="comment">// What I _want_ to do is null out this XPath.</em>
<a id="L157" name="L157"></a> 157                 <em class="comment">// I doubt this has the desired effect, but I'm not sure what else to do.</em>
<a id="L158" name="L158"></a> 158                 <em class="comment">// %REVIEW%!!!</em>
<a id="L159" name="L159"></a> 159                 <a href="../S/4999.html#L103" title="Defined at 103 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">initXPath</a>(compiler, "/..",  namespaceContext);
<a id="L160" name="L160"></a> 160           <em class="brace">}</em>
<a id="L161" name="L161"></a> 161           <strong class="reserved">else</strong>
<a id="L162" name="L162"></a> 162                 <strong class="reserved">throw</strong> e;
<a id="L163" name="L163"></a> 163     <em class="brace">}</em>
<a id="L164" name="L164"></a> 164 
<a id="L165" name="L165"></a> 165     compiler.<a href="../D/34536.html" title="Multiple defined in 2 places.">shrink</a>();
<a id="L166" name="L166"></a> 166   <em class="brace">}</em>
<a id="L167" name="L167"></a> 167 
<div class="comment">
    Given an string, init an XPath object for pattern matches,
    in order that a parse doesn't
    have to be done each time the expression is evaluated.
    @param compiler The XPath object to be initialized.
    @param expression A String representing the XPath.
    @param namespaceContext An object that is able to resolve prefixes in
    the XPath to namespaces.
    @throws javax.xml.transform.TransformerException</div>
<a id="L179" name="L179"></a> 179   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/20606.html" title="Multiple referred from 2 places.">initMatchPattern</a>(
<a id="L180" name="L180"></a> 180           <a href="../D/1702.html" title="Multiple defined in 2 places.">Compiler</a> compiler, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6694.html#L1816" title="Defined at 1816 in src/com/sun/java/swing/plaf/gtk/Metacity.java.">expression</a>, <a href="../S/5879.html#L32" title="Defined at 32 in src/com/sun/org/apache/xml/internal/utils/PrefixResolver.java.">PrefixResolver</a> namespaceContext)
<a id="L181" name="L181"></a> 181             <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L182" name="L182"></a> 182   <em class="brace">{</em>
<a id="L183" name="L183"></a> 183 
<a id="L184" name="L184"></a> 184     m_ops = compiler;
<a id="L185" name="L185"></a> 185     m_namespaceContext = namespaceContext;
<a id="L186" name="L186"></a> 186     m_functionTable = compiler.<a href="../S/4997.html#L628" title="Defined at 628 in src/com/sun/org/apache/xpath/internal/compiler/Compiler.java.">getFunctionTable</a>();
<a id="L187" name="L187"></a> 187 
<a id="L188" name="L188"></a> 188     <a href="../S/5000.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/Lexer.java.">Lexer</a> lexer = <strong class="reserved">new</strong> <a href="../S/5000.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/Lexer.java.">Lexer</a>(compiler, namespaceContext, <strong class="reserved">this</strong>);
<a id="L189" name="L189"></a> 189 
<a id="L190" name="L190"></a> 190     lexer.<a href="../D/35549.html" title="Multiple defined in 6 places.">tokenize</a>(<a href="../S/6694.html#L1816" title="Defined at 1816 in src/com/sun/java/swing/plaf/gtk/Metacity.java.">expression</a>);
<a id="L191" name="L191"></a> 191 
<a id="L192" name="L192"></a> 192     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(0, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_MATCHPATTERN);
<a id="L193" name="L193"></a> 193     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, 2);
<a id="L194" name="L194"></a> 194 
<a id="L195" name="L195"></a> 195     <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L196" name="L196"></a> 196     <a href="../D/6677.html" title="Multiple defined in 3 places.">Pattern</a>();
<a id="L197" name="L197"></a> 197 
<a id="L198" name="L198"></a> 198     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L199" name="L199"></a> 199     <em class="brace">{</em>
<a id="L200" name="L200"></a> 200       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> extraTokens = "";
<a id="L201" name="L201"></a> 201 
<a id="L202" name="L202"></a> 202       <strong class="reserved">while</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L203" name="L203"></a> 203       <em class="brace">{</em>
<a id="L204" name="L204"></a> 204         extraTokens += "'" + m_token + "'";
<a id="L205" name="L205"></a> 205 
<a id="L206" name="L206"></a> 206         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L207" name="L207"></a> 207 
<a id="L208" name="L208"></a> 208         <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L209" name="L209"></a> 209           extraTokens += ", ";
<a id="L210" name="L210"></a> 210       <em class="brace">}</em>
<a id="L211" name="L211"></a> 211 
<a id="L212" name="L212"></a> 212       <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXTRA_ILLEGAL_TOKENS,
<a id="L213" name="L213"></a> 213             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> extraTokens <em class="brace">}</em>);  <em class="comment">//"Extra illegal tokens: "+extraTokens);</em>
<a id="L214" name="L214"></a> 214     <em class="brace">}</em>
<a id="L215" name="L215"></a> 215 
<a id="L216" name="L216"></a> 216     <em class="comment">// Terminate for safety.</em>
<a id="L217" name="L217"></a> 217     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ENDOP);
<a id="L218" name="L218"></a> 218     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH)+1);
<a id="L219" name="L219"></a> 219 
<a id="L220" name="L220"></a> 220     m_ops.<a href="../D/34536.html" title="Multiple defined in 2 places.">shrink</a>();
<a id="L221" name="L221"></a> 221   <em class="brace">}</em>
<a id="L222" name="L222"></a> 222 
<div class="comment">
 The error listener where syntax errors are to be sent.</div>
<a id="L225" name="L225"></a> 225   <strong class="reserved">private</strong> <a href="../S/4030.html#L53" title="Defined at 53 in src/javax/xml/transform/ErrorListener.java.">ErrorListener</a> m_errorListener;
<a id="L226" name="L226"></a> 226 
<div class="comment">
   /** The source location of the XPath. */</div>
<a id="L228" name="L228"></a> 228   <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4044.html#L32" title="Defined at 32 in src/javax/xml/transform/SourceLocator.java.">SourceLocator</a> m_sourceLocator;
<a id="L229" name="L229"></a> 229 
<div class="comment">
   /** The table contains build-in functions and customized functions */</div>
<a id="L231" name="L231"></a> 231   <strong class="reserved">private</strong> <a href="../S/4995.html#L33" title="Defined at 33 in src/com/sun/org/apache/xpath/internal/compiler/FunctionTable.java.">FunctionTable</a> m_functionTable;
<a id="L232" name="L232"></a> 232 
<div class="comment">
    Allow an application to register an error event handler, where syntax
    errors will be sent.  If the error listener is not set, syntax errors
    will be sent to System.err.
    @param handler Reference to error listener where syntax errors will be
                   sent.</div>
<a id="L241" name="L241"></a> 241   <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27345.html" title="Multiple referred from 43 places.">setErrorHandler</a>(<a href="../S/4030.html#L53" title="Defined at 53 in src/javax/xml/transform/ErrorListener.java.">ErrorListener</a> <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>)
<a id="L242" name="L242"></a> 242   <em class="brace">{</em>
<a id="L243" name="L243"></a> 243     m_errorListener = <a href="../S/5398.html#L302" title="Defined at 302 in src/com/sun/org/apache/xerces/internal/jaxp/JAXPValidatorComponent.java.">handler</a>;
<a id="L244" name="L244"></a> 244   <em class="brace">}</em>
<a id="L245" name="L245"></a> 245 
<div class="comment">
    Return the current error listener.
    @return The error listener, which should not normally be null, but may be.</div>
<a id="L251" name="L251"></a> 251   <strong class="reserved">public</strong> <a href="../S/4030.html#L53" title="Defined at 53 in src/javax/xml/transform/ErrorListener.java.">ErrorListener</a> <a href="../R/16433.html" title="Multiple referred from 16 places.">getErrorListener</a>()
<a id="L252" name="L252"></a> 252   <em class="brace">{</em>
<a id="L253" name="L253"></a> 253     <strong class="reserved">return</strong> m_errorListener;
<a id="L254" name="L254"></a> 254   <em class="brace">}</em>
<a id="L255" name="L255"></a> 255 
<div class="comment">
    Check whether m_token matches the target string.
    @param s A string reference or null.
    @return If m_token is null, returns false (or true if s is also null), or
    return true if the current token matches the string, else false.</div>
<a id="L264" name="L264"></a> 264   <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../R/29386.html" title="Multiple referred from 54 places.">tokenIs</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s)
<a id="L265" name="L265"></a> 265   <em class="brace">{</em>
<a id="L266" name="L266"></a> 266     <strong class="reserved">return</strong> (m_token != <strong class="reserved">null</strong>) ? (m_token.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(s)) : (s == <strong class="reserved">null</strong>);
<a id="L267" name="L267"></a> 267   <em class="brace">}</em>
<a id="L268" name="L268"></a> 268 
<div class="comment">
    Check whether m_tokenChar==c.
    @param c A character to be tested.
    @return If m_token is null, returns false, or return true if c matches
            the current token.</div>
<a id="L277" name="L277"></a> 277   <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../R/29386.html" title="Multiple referred from 54 places.">tokenIs</a>(<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)
<a id="L278" name="L278"></a> 278   <em class="brace">{</em>
<a id="L279" name="L279"></a> 279     <strong class="reserved">return</strong> (m_token != <strong class="reserved">null</strong>) ? (m_tokenChar == <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) : <strong class="reserved">false</strong>;
<a id="L280" name="L280"></a> 280   <em class="brace">}</em>
<a id="L281" name="L281"></a> 281 
<div class="comment">
    Look ahead of the current token in order to
    make a branching decision.
    @param c the character to be tested for.
    @param n number of tokens to look ahead.  Must be
    greater than 1.
    @return true if the next token matches the character argument.</div>
<a id="L292" name="L292"></a> 292   <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../R/22721.html" title="Multiple referred from 39 places.">lookahead</a>(<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <strong class="reserved">int</strong> n)
<a id="L293" name="L293"></a> 293   <em class="brace">{</em>
<a id="L294" name="L294"></a> 294 
<a id="L295" name="L295"></a> 295     <strong class="reserved">int</strong> pos = (m_queueMark + n);
<a id="L296" name="L296"></a> 296     <strong class="reserved">boolean</strong> b;
<a id="L297" name="L297"></a> 297 
<a id="L298" name="L298"></a> 298     <strong class="reserved">if</strong> ((pos &lt;= m_ops.<a href="../S/4996.html#L111" title="Defined at 111 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getTokenQueueSize</a>()) &amp;&amp; (pos &gt; 0)
<a id="L299" name="L299"></a> 299             &amp;&amp; (m_ops.<a href="../S/4996.html#L111" title="Defined at 111 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getTokenQueueSize</a>() != 0))
<a id="L300" name="L300"></a> 300     <em class="brace">{</em>
<a id="L301" name="L301"></a> 301       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> tok = ((<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_ops.m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(pos - 1));
<a id="L302" name="L302"></a> 302 
<a id="L303" name="L303"></a> 303       b = (tok.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 1) ? (tok.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0) == <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) : <strong class="reserved">false</strong>;
<a id="L304" name="L304"></a> 304     <em class="brace">}</em>
<a id="L305" name="L305"></a> 305     <strong class="reserved">else</strong>
<a id="L306" name="L306"></a> 306     <em class="brace">{</em>
<a id="L307" name="L307"></a> 307       b = <strong class="reserved">false</strong>;
<a id="L308" name="L308"></a> 308     <em class="brace">}</em>
<a id="L309" name="L309"></a> 309 
<a id="L310" name="L310"></a> 310     <strong class="reserved">return</strong> b;
<a id="L311" name="L311"></a> 311   <em class="brace">}</em>
<a id="L312" name="L312"></a> 312 
<div class="comment">
    Look behind the first character of the current token in order to
    make a branching decision.
    @param c the character to compare it to.
    @param n number of tokens to look behind.  Must be
    greater than 1.  Note that the look behind terminates
    at either the beginning of the string or on a '|'
    character.  Because of this, this method should only
    be used for pattern matching.
    @return true if the token behind the current token matches the character
            argument.</div>
<a id="L327" name="L327"></a> 327   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../R/22722.html" title="Multiple referred from 5 places.">lookbehind</a>(<strong class="reserved">char</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>, <strong class="reserved">int</strong> n)
<a id="L328" name="L328"></a> 328   <em class="brace">{</em>
<a id="L329" name="L329"></a> 329 
<a id="L330" name="L330"></a> 330     <strong class="reserved">boolean</strong> <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a>;
<a id="L331" name="L331"></a> 331     <strong class="reserved">int</strong> lookBehindPos = m_queueMark - (n + 1);
<a id="L332" name="L332"></a> 332 
<a id="L333" name="L333"></a> 333     <strong class="reserved">if</strong> (lookBehindPos &gt;= 0)
<a id="L334" name="L334"></a> 334     <em class="brace">{</em>
<a id="L335" name="L335"></a> 335       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4999.html#L327" title="Defined at 327 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">lookbehind</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_ops.m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(lookBehindPos);
<a id="L336" name="L336"></a> 336 
<a id="L337" name="L337"></a> 337       <strong class="reserved">if</strong> (<a href="../S/4999.html#L327" title="Defined at 327 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">lookbehind</a>.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() == 1)
<a id="L338" name="L338"></a> 338       <em class="brace">{</em>
<a id="L339" name="L339"></a> 339         <strong class="reserved">char</strong> c0 = (<a href="../S/4999.html#L327" title="Defined at 327 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">lookbehind</a> == <strong class="reserved">null</strong>) ? '|' : <a href="../S/4999.html#L327" title="Defined at 327 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">lookbehind</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0);
<a id="L340" name="L340"></a> 340 
<a id="L341" name="L341"></a> 341         <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a> = (c0 == '|') ? <strong class="reserved">false</strong> : (c0 == <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>);
<a id="L342" name="L342"></a> 342       <em class="brace">}</em>
<a id="L343" name="L343"></a> 343       <strong class="reserved">else</strong>
<a id="L344" name="L344"></a> 344       <em class="brace">{</em>
<a id="L345" name="L345"></a> 345         <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a> = <strong class="reserved">false</strong>;
<a id="L346" name="L346"></a> 346       <em class="brace">}</em>
<a id="L347" name="L347"></a> 347     <em class="brace">}</em>
<a id="L348" name="L348"></a> 348     <strong class="reserved">else</strong>
<a id="L349" name="L349"></a> 349     <em class="brace">{</em>
<a id="L350" name="L350"></a> 350       <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a> = <strong class="reserved">false</strong>;
<a id="L351" name="L351"></a> 351     <em class="brace">}</em>
<a id="L352" name="L352"></a> 352 
<a id="L353" name="L353"></a> 353     <strong class="reserved">return</strong> <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a>;
<a id="L354" name="L354"></a> 354   <em class="brace">}</em>
<a id="L355" name="L355"></a> 355 
<div class="comment">
    look behind the current token in order to
    see if there is a useable token.
    @param n number of tokens to look behind.  Must be
    greater than 1.  Note that the look behind terminates
    at either the beginning of the string or on a '|'
    character.  Because of this, this method should only
    be used for pattern matching.
    @return true if look behind has a token, false otherwise.</div>
<a id="L368" name="L368"></a> 368   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> lookbehindHasToken(<strong class="reserved">int</strong> n)
<a id="L369" name="L369"></a> 369   <em class="brace">{</em>
<a id="L370" name="L370"></a> 370 
<a id="L371" name="L371"></a> 371     <strong class="reserved">boolean</strong> hasToken;
<a id="L372" name="L372"></a> 372 
<a id="L373" name="L373"></a> 373     <strong class="reserved">if</strong> ((m_queueMark - n) &gt; 0)
<a id="L374" name="L374"></a> 374     <em class="brace">{</em>
<a id="L375" name="L375"></a> 375       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/4999.html#L327" title="Defined at 327 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">lookbehind</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_ops.m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(m_queueMark - (n - 1));
<a id="L376" name="L376"></a> 376       <strong class="reserved">char</strong> c0 = (<a href="../S/4999.html#L327" title="Defined at 327 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">lookbehind</a> == <strong class="reserved">null</strong>) ? '|' : <a href="../S/4999.html#L327" title="Defined at 327 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">lookbehind</a>.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0);
<a id="L377" name="L377"></a> 377 
<a id="L378" name="L378"></a> 378       hasToken = (c0 == '|') ? <strong class="reserved">false</strong> : <strong class="reserved">true</strong>;
<a id="L379" name="L379"></a> 379     <em class="brace">}</em>
<a id="L380" name="L380"></a> 380     <strong class="reserved">else</strong>
<a id="L381" name="L381"></a> 381     <em class="brace">{</em>
<a id="L382" name="L382"></a> 382       hasToken = <strong class="reserved">false</strong>;
<a id="L383" name="L383"></a> 383     <em class="brace">}</em>
<a id="L384" name="L384"></a> 384 
<a id="L385" name="L385"></a> 385     <strong class="reserved">return</strong> hasToken;
<a id="L386" name="L386"></a> 386   <em class="brace">}</em>
<a id="L387" name="L387"></a> 387 
<div class="comment">
    Look ahead of the current token in order to
    make a branching decision.
    @param s the string to compare it to.
    @param n number of tokens to lookahead.  Must be
    greater than 1.
    @return true if the token behind the current token matches the string
            argument.</div>
<a id="L399" name="L399"></a> 399   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">boolean</strong> <a href="../R/22721.html" title="Multiple referred from 39 places.">lookahead</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> s, <strong class="reserved">int</strong> n)
<a id="L400" name="L400"></a> 400   <em class="brace">{</em>
<a id="L401" name="L401"></a> 401 
<a id="L402" name="L402"></a> 402     <strong class="reserved">boolean</strong> <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a>;
<a id="L403" name="L403"></a> 403 
<a id="L404" name="L404"></a> 404     <strong class="reserved">if</strong> ((m_queueMark + n) &lt;= m_ops.<a href="../S/4996.html#L111" title="Defined at 111 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getTokenQueueSize</a>())
<a id="L405" name="L405"></a> 405     <em class="brace">{</em>
<a id="L406" name="L406"></a> 406       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a> = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_ops.m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(m_queueMark + (n - 1));
<a id="L407" name="L407"></a> 407 
<a id="L408" name="L408"></a> 408       <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a> = (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a> != <strong class="reserved">null</strong>) ? <a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(s) : (s == <strong class="reserved">null</strong>);
<a id="L409" name="L409"></a> 409     <em class="brace">}</em>
<a id="L410" name="L410"></a> 410     <strong class="reserved">else</strong>
<a id="L411" name="L411"></a> 411     <em class="brace">{</em>
<a id="L412" name="L412"></a> 412       <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a> = (<strong class="reserved">null</strong> == s);
<a id="L413" name="L413"></a> 413     <em class="brace">}</em>
<a id="L414" name="L414"></a> 414 
<a id="L415" name="L415"></a> 415     <strong class="reserved">return</strong> <a href="../S/776.html#L775" title="Defined at 775 in src/java/net/HttpCookie.java.">isToken</a>;
<a id="L416" name="L416"></a> 416   <em class="brace">}</em>
<a id="L417" name="L417"></a> 417 
<div class="comment">
    Retrieve the next token from the command and
    store it in m_token string.</div>
<a id="L422" name="L422"></a> 422   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/23704.html" title="Multiple referred from 285 places.">nextToken</a>()
<a id="L423" name="L423"></a> 423   <em class="brace">{</em>
<a id="L424" name="L424"></a> 424 
<a id="L425" name="L425"></a> 425     <strong class="reserved">if</strong> (m_queueMark &lt; m_ops.<a href="../S/4996.html#L111" title="Defined at 111 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getTokenQueueSize</a>())
<a id="L426" name="L426"></a> 426     <em class="brace">{</em>
<a id="L427" name="L427"></a> 427       m_token = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_ops.m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(m_queueMark++);
<a id="L428" name="L428"></a> 428       m_tokenChar = m_token.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0);
<a id="L429" name="L429"></a> 429     <em class="brace">}</em>
<a id="L430" name="L430"></a> 430     <strong class="reserved">else</strong>
<a id="L431" name="L431"></a> 431     <em class="brace">{</em>
<a id="L432" name="L432"></a> 432       m_token = <strong class="reserved">null</strong>;
<a id="L433" name="L433"></a> 433       m_tokenChar = 0;
<a id="L434" name="L434"></a> 434     <em class="brace">}</em>
<a id="L435" name="L435"></a> 435   <em class="brace">}</em>
<a id="L436" name="L436"></a> 436 
<div class="comment">
    Retrieve a token relative to the current token.
    @param i Position relative to current token.
    @return The string at the given index, or null if the index is out
            of range.</div>
<a id="L445" name="L445"></a> 445   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> getTokenRelative(<strong class="reserved">int</strong> i)
<a id="L446" name="L446"></a> 446   <em class="brace">{</em>
<a id="L447" name="L447"></a> 447 
<a id="L448" name="L448"></a> 448     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> tok;
<a id="L449" name="L449"></a> 449     <strong class="reserved">int</strong> <a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a> = m_queueMark + i;
<a id="L450" name="L450"></a> 450 
<a id="L451" name="L451"></a> 451     <strong class="reserved">if</strong> ((<a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a> &gt; 0) &amp;&amp; (<a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a> &lt; m_ops.<a href="../S/4996.html#L111" title="Defined at 111 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getTokenQueueSize</a>()))
<a id="L452" name="L452"></a> 452     <em class="brace">{</em>
<a id="L453" name="L453"></a> 453       tok = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_ops.m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(<a href="../S/2602.html#L1248" title="Defined at 1248 in src/java/sql/ResultSet.java.">relative</a>);
<a id="L454" name="L454"></a> 454     <em class="brace">}</em>
<a id="L455" name="L455"></a> 455     <strong class="reserved">else</strong>
<a id="L456" name="L456"></a> 456     <em class="brace">{</em>
<a id="L457" name="L457"></a> 457       tok = <strong class="reserved">null</strong>;
<a id="L458" name="L458"></a> 458     <em class="brace">}</em>
<a id="L459" name="L459"></a> 459 
<a id="L460" name="L460"></a> 460     <strong class="reserved">return</strong> tok;
<a id="L461" name="L461"></a> 461   <em class="brace">}</em>
<a id="L462" name="L462"></a> 462 
<div class="comment">
    Retrieve the previous token from the command and
    store it in m_token string.</div>
<a id="L467" name="L467"></a> 467   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/24960.html" title="Multiple referred from 4 places.">prevToken</a>()
<a id="L468" name="L468"></a> 468   <em class="brace">{</em>
<a id="L469" name="L469"></a> 469 
<a id="L470" name="L470"></a> 470     <strong class="reserved">if</strong> (m_queueMark &gt; 0)
<a id="L471" name="L471"></a> 471     <em class="brace">{</em>
<a id="L472" name="L472"></a> 472       m_queueMark--;
<a id="L473" name="L473"></a> 473 
<a id="L474" name="L474"></a> 474       m_token = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_ops.m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(m_queueMark);
<a id="L475" name="L475"></a> 475       m_tokenChar = m_token.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0);
<a id="L476" name="L476"></a> 476     <em class="brace">}</em>
<a id="L477" name="L477"></a> 477     <strong class="reserved">else</strong>
<a id="L478" name="L478"></a> 478     <em class="brace">{</em>
<a id="L479" name="L479"></a> 479       m_token = <strong class="reserved">null</strong>;
<a id="L480" name="L480"></a> 480       m_tokenChar = 0;
<a id="L481" name="L481"></a> 481     <em class="brace">}</em>
<a id="L482" name="L482"></a> 482   <em class="brace">}</em>
<a id="L483" name="L483"></a> 483 
<div class="comment">
    Consume an expected token, throwing an exception if it
    isn't there.
    @param expected The string to be expected.
    @throws javax.xml.transform.TransformerException</div>
<a id="L492" name="L492"></a> 492   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/11941.html" title="Multiple referred from 10 places.">consumeExpected</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> expected)
<a id="L493" name="L493"></a> 493           <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L494" name="L494"></a> 494   <em class="brace">{</em>
<a id="L495" name="L495"></a> 495 
<a id="L496" name="L496"></a> 496     <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(expected))
<a id="L497" name="L497"></a> 497     <em class="brace">{</em>
<a id="L498" name="L498"></a> 498       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L499" name="L499"></a> 499     <em class="brace">}</em>
<a id="L500" name="L500"></a> 500     <strong class="reserved">else</strong>
<a id="L501" name="L501"></a> 501     <em class="brace">{</em>
<a id="L502" name="L502"></a> 502       <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_BUT_FOUND, <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> expected,
<a id="L503" name="L503"></a> 503                                                                      m_token <em class="brace">}</em>);  <em class="comment">//"Expected "+expected+", but found: "+m_token);</em>
<a id="L504" name="L504"></a> 504 
<a id="L505" name="L505"></a> 505           <em class="comment">// Patch for Christina's gripe. She wants her errorHandler to return from</em>
<a id="L506" name="L506"></a> 506           <em class="comment">// this error and continue trying to parse, rather than throwing an exception.</em>
<a id="L507" name="L507"></a> 507           <em class="comment">// Without the patch, that put us into an endless loop.</em>
<a id="L508" name="L508"></a> 508                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/4893.html#L30" title="Defined at 30 in src/com/sun/org/apache/xpath/internal/XPathProcessorException.java.">XPathProcessorException</a>(CONTINUE_AFTER_FATAL_ERROR);
<a id="L509" name="L509"></a> 509         <em class="brace">}</em>
<a id="L510" name="L510"></a> 510   <em class="brace">}</em>
<a id="L511" name="L511"></a> 511 
<div class="comment">
    Consume an expected token, throwing an exception if it
    isn't there.
    @param expected the character to be expected.
    @throws javax.xml.transform.TransformerException</div>
<a id="L520" name="L520"></a> 520   <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/11941.html" title="Multiple referred from 10 places.">consumeExpected</a>(<strong class="reserved">char</strong> expected)
<a id="L521" name="L521"></a> 521           <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L522" name="L522"></a> 522   <em class="brace">{</em>
<a id="L523" name="L523"></a> 523 
<a id="L524" name="L524"></a> 524     <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(expected))
<a id="L525" name="L525"></a> 525     <em class="brace">{</em>
<a id="L526" name="L526"></a> 526       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L527" name="L527"></a> 527     <em class="brace">}</em>
<a id="L528" name="L528"></a> 528     <strong class="reserved">else</strong>
<a id="L529" name="L529"></a> 529     <em class="brace">{</em>
<a id="L530" name="L530"></a> 530       <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_BUT_FOUND,
<a id="L531" name="L531"></a> 531             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(expected),
<a id="L532" name="L532"></a> 532                           m_token <em class="brace">}</em>);  <em class="comment">//"Expected "+expected+", but found: "+m_token);</em>
<a id="L533" name="L533"></a> 533 
<a id="L534" name="L534"></a> 534           <em class="comment">// Patch for Christina's gripe. She wants her errorHandler to return from</em>
<a id="L535" name="L535"></a> 535           <em class="comment">// this error and continue trying to parse, rather than throwing an exception.</em>
<a id="L536" name="L536"></a> 536           <em class="comment">// Without the patch, that put us into an endless loop.</em>
<a id="L537" name="L537"></a> 537                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/4893.html#L30" title="Defined at 30 in src/com/sun/org/apache/xpath/internal/XPathProcessorException.java.">XPathProcessorException</a>(CONTINUE_AFTER_FATAL_ERROR);
<a id="L538" name="L538"></a> 538     <em class="brace">}</em>
<a id="L539" name="L539"></a> 539   <em class="brace">}</em>
<a id="L540" name="L540"></a> 540 
<div class="comment">
    Warn the user of a problem.
    @param msg An error msgkey that corresponds to one of the constants found
               in {@link com.sun.org.apache.xpath.internal.res.XPATHErrorResources}, which is
               a key for a format string.
    @param args An array of arguments represented in the format string, which
                may be null.
    @throws TransformerException if the current ErrorListoner determines to
                                 throw an exception.</div>
<a id="L553" name="L553"></a> 553   <strong class="reserved">void</strong> <a href="../R/30451.html" title="Multiple referred from 5 places.">warn</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] args) <strong class="reserved">throws</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L554" name="L554"></a> 554   <em class="brace">{</em>
<a id="L555" name="L555"></a> 555 
<a id="L556" name="L556"></a> 556     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fmsg = <a href="../S/5961.html#L36" title="Defined at 36 in src/com/sun/org/apache/xalan/internal/res/XSLMessages.java.">XSLMessages</a>.<a href="../S/4842.html#L79" title="Defined at 79 in src/com/sun/org/apache/xpath/internal/res/XPATHMessages.java.">createXPATHWarning</a>(<a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, args);
<a id="L557" name="L557"></a> 557     <a href="../S/4030.html#L53" title="Defined at 53 in src/javax/xml/transform/ErrorListener.java.">ErrorListener</a> ehandler = <strong class="reserved">this</strong>.<a href="../D/18851.html" title="Multiple defined in 9 places.">getErrorListener</a>();
<a id="L558" name="L558"></a> 558 
<a id="L559" name="L559"></a> 559     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != ehandler)
<a id="L560" name="L560"></a> 560     <em class="brace">{</em>
<a id="L561" name="L561"></a> 561       <em class="comment">// TO DO: Need to get stylesheet Locator from here.</em>
<a id="L562" name="L562"></a> 562       ehandler.<a href="../D/36831.html" title="Multiple defined in 36 places.">warning</a>(<strong class="reserved">new</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>(fmsg, m_sourceLocator));
<a id="L563" name="L563"></a> 563     <em class="brace">}</em>
<a id="L564" name="L564"></a> 564     <strong class="reserved">else</strong>
<a id="L565" name="L565"></a> 565     <em class="brace">{</em>
<a id="L566" name="L566"></a> 566       <em class="comment">// Should never happen.</em>
<a id="L567" name="L567"></a> 567       <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.err.<a href="../D/29725.html" title="Multiple defined in 27 places.">println</a>(fmsg);
<a id="L568" name="L568"></a> 568     <em class="brace">}</em>
<a id="L569" name="L569"></a> 569   <em class="brace">}</em>
<a id="L570" name="L570"></a> 570 
<div class="comment">
    Notify the user of an assertion error, and probably throw an
    exception.
    @param b  If false, a runtime exception will be thrown.
    @param msg The assertion message, which should be informative.
    @throws RuntimeException if the b argument is false.</div>
<a id="L580" name="L580"></a> 580   <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/10376.html" title="Multiple referred from 16 places.">assertion</a>(<strong class="reserved">boolean</strong> b, <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>)
<a id="L581" name="L581"></a> 581   <em class="brace">{</em>
<a id="L582" name="L582"></a> 582 
<a id="L583" name="L583"></a> 583     <strong class="reserved">if</strong> (!b)
<a id="L584" name="L584"></a> 584     <em class="brace">{</em>
<a id="L585" name="L585"></a> 585       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fMsg = <a href="../S/5961.html#L36" title="Defined at 36 in src/com/sun/org/apache/xalan/internal/res/XSLMessages.java.">XSLMessages</a>.<a href="../S/4842.html#L56" title="Defined at 56 in src/com/sun/org/apache/xpath/internal/res/XPATHMessages.java.">createXPATHMessage</a>(
<a id="L586" name="L586"></a> 586         <a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_INCORRECT_PROGRAMMER_ASSERTION,
<a id="L587" name="L587"></a> 587         <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a> <em class="brace">}</em>);
<a id="L588" name="L588"></a> 588 
<a id="L589" name="L589"></a> 589       <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1723.html#L43" title="Defined at 43 in src/java/lang/RuntimeException.java.">RuntimeException</a>(fMsg);
<a id="L590" name="L590"></a> 590     <em class="brace">}</em>
<a id="L591" name="L591"></a> 591   <em class="brace">}</em>
<a id="L592" name="L592"></a> 592 
<div class="comment">
    Notify the user of an error, and probably throw an
    exception.
    @param msg An error msgkey that corresponds to one of the constants found
               in {@link com.sun.org.apache.xpath.internal.res.XPATHErrorResources}, which is
               a key for a format string.
    @param args An array of arguments represented in the format string, which
                may be null.
    @throws TransformerException if the current ErrorListoner determines to
                                 throw an exception.</div>
<a id="L606" name="L606"></a> 606   <strong class="reserved">void</strong> <a href="../R/14003.html" title="Multiple referred from 408 places.">error</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] args) <strong class="reserved">throws</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L607" name="L607"></a> 607   <em class="brace">{</em>
<a id="L608" name="L608"></a> 608 
<a id="L609" name="L609"></a> 609     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fmsg = <a href="../S/5961.html#L36" title="Defined at 36 in src/com/sun/org/apache/xalan/internal/res/XSLMessages.java.">XSLMessages</a>.<a href="../S/4842.html#L56" title="Defined at 56 in src/com/sun/org/apache/xpath/internal/res/XPATHMessages.java.">createXPATHMessage</a>(<a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, args);
<a id="L610" name="L610"></a> 610     <a href="../S/4030.html#L53" title="Defined at 53 in src/javax/xml/transform/ErrorListener.java.">ErrorListener</a> ehandler = <strong class="reserved">this</strong>.<a href="../D/18851.html" title="Multiple defined in 9 places.">getErrorListener</a>();
<a id="L611" name="L611"></a> 611 
<a id="L612" name="L612"></a> 612     <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a> te = <strong class="reserved">new</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>(fmsg, m_sourceLocator);
<a id="L613" name="L613"></a> 613     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != ehandler)
<a id="L614" name="L614"></a> 614     <em class="brace">{</em>
<a id="L615" name="L615"></a> 615       <em class="comment">// TO DO: Need to get stylesheet Locator from here.</em>
<a id="L616" name="L616"></a> 616       ehandler.<a href="../D/15986.html" title="Multiple defined in 31 places.">fatalError</a>(te);
<a id="L617" name="L617"></a> 617     <em class="brace">}</em>
<a id="L618" name="L618"></a> 618     <strong class="reserved">else</strong>
<a id="L619" name="L619"></a> 619     <em class="brace">{</em>
<a id="L620" name="L620"></a> 620       <em class="comment">// System.err.println(fmsg);</em>
<a id="L621" name="L621"></a> 621       <strong class="reserved">throw</strong> te;
<a id="L622" name="L622"></a> 622     <em class="brace">}</em>
<a id="L623" name="L623"></a> 623   <em class="brace">}</em>
<a id="L624" name="L624"></a> 624 
<div class="comment">
    This method is added to support DOM 3 XPath API.
    <p>
    This method is exactly like error(String, Object[]); except that
    the underlying TransformerException is
    XpathStylesheetDOM3Exception (which extends TransformerException).
    </p><p>
    So older XPath code in Xalan is not affected by this. To older XPath code
    the behavior of whether error() or errorForDOM3() is called because it is
    always catching TransformerException objects and is oblivious to
    the new subclass of XPathStylesheetDOM3Exception. Older XPath code
    runs as before.
    </p><p>
    However, newer DOM3 XPath code upon catching a TransformerException can
    can check if the exception is an instance of XPathStylesheetDOM3Exception
    and take appropriate action.
    @param msg An error msgkey that corresponds to one of the constants found
               in {@link com.sun.org.apache.xpath.internal.res.XPATHErrorResources}, which is
               a key for a format string.
    @param args An array of arguments represented in the format string, which
                may be null.
    @throws TransformerException if the current ErrorListoner determines to
                                 throw an exception.</p></div>
<a id="L651" name="L651"></a> 651   <strong class="reserved">void</strong> <a href="../S/5000.html#L642" title="Referred from 642 in src/com/sun/org/apache/xpath/internal/compiler/Lexer.java.">errorForDOM3</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] args) <strong class="reserved">throws</strong> <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L652" name="L652"></a> 652   <em class="brace">{</em>
<a id="L653" name="L653"></a> 653 
<a id="L654" name="L654"></a> 654         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> fmsg = <a href="../S/5961.html#L36" title="Defined at 36 in src/com/sun/org/apache/xalan/internal/res/XSLMessages.java.">XSLMessages</a>.<a href="../S/4842.html#L56" title="Defined at 56 in src/com/sun/org/apache/xpath/internal/res/XPATHMessages.java.">createXPATHMessage</a>(<a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a>, args);
<a id="L655" name="L655"></a> 655         <a href="../S/4030.html#L53" title="Defined at 53 in src/javax/xml/transform/ErrorListener.java.">ErrorListener</a> ehandler = <strong class="reserved">this</strong>.<a href="../D/18851.html" title="Multiple defined in 9 places.">getErrorListener</a>();
<a id="L656" name="L656"></a> 656 
<a id="L657" name="L657"></a> 657         <a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a> te = <strong class="reserved">new</strong> <a href="../S/4853.html#L58" title="Defined at 58 in src/com/sun/org/apache/xpath/internal/domapi/XPathStylesheetDOM3Exception.java.">XPathStylesheetDOM3Exception</a>(fmsg, m_sourceLocator);
<a id="L658" name="L658"></a> 658         <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != ehandler)
<a id="L659" name="L659"></a> 659         <em class="brace">{</em>
<a id="L660" name="L660"></a> 660           <em class="comment">// TO DO: Need to get stylesheet Locator from here.</em>
<a id="L661" name="L661"></a> 661           ehandler.<a href="../D/15986.html" title="Multiple defined in 31 places.">fatalError</a>(te);
<a id="L662" name="L662"></a> 662         <em class="brace">}</em>
<a id="L663" name="L663"></a> 663         <strong class="reserved">else</strong>
<a id="L664" name="L664"></a> 664         <em class="brace">{</em>
<a id="L665" name="L665"></a> 665           <em class="comment">// System.err.println(fmsg);</em>
<a id="L666" name="L666"></a> 666           <strong class="reserved">throw</strong> te;
<a id="L667" name="L667"></a> 667         <em class="brace">}</em>
<a id="L668" name="L668"></a> 668   <em class="brace">}</em>
<div class="comment">
    Dump the remaining token queue.
    Thanks to Craig for this.
    @return A dump of the remaining token queue, which may be appended to
            an error message.</div>
<a id="L676" name="L676"></a> 676   <strong class="reserved">protected</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> dumpRemainingTokenQueue()
<a id="L677" name="L677"></a> 677   <em class="brace">{</em>
<a id="L678" name="L678"></a> 678 
<a id="L679" name="L679"></a> 679     <strong class="reserved">int</strong> q = m_queueMark;
<a id="L680" name="L680"></a> 680     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> returnMsg;
<a id="L681" name="L681"></a> 681 
<a id="L682" name="L682"></a> 682     <strong class="reserved">if</strong> (q &lt; m_ops.<a href="../S/4996.html#L111" title="Defined at 111 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getTokenQueueSize</a>())
<a id="L683" name="L683"></a> 683     <em class="brace">{</em>
<a id="L684" name="L684"></a> 684       <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a> = "\n Remaining tokens: (";
<a id="L685" name="L685"></a> 685 
<a id="L686" name="L686"></a> 686       <strong class="reserved">while</strong> (q &lt; m_ops.<a href="../S/4996.html#L111" title="Defined at 111 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">getTokenQueueSize</a>())
<a id="L687" name="L687"></a> 687       <em class="brace">{</em>
<a id="L688" name="L688"></a> 688         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> t = (<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>) m_ops.m_tokenQueue.<a href="../D/15289.html" title="Multiple defined in 23 places.">elementAt</a>(q++);
<a id="L689" name="L689"></a> 689 
<a id="L690" name="L690"></a> 690         <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a> += (" '" + t + "'");
<a id="L691" name="L691"></a> 691       <em class="brace">}</em>
<a id="L692" name="L692"></a> 692 
<a id="L693" name="L693"></a> 693       returnMsg = <a href="../S/6957.html#L1026" title="Defined at 1026 in src/com/sun/corba/se/impl/io/ObjectStreamClass.java.">msg</a> + ")";
<a id="L694" name="L694"></a> 694     <em class="brace">}</em>
<a id="L695" name="L695"></a> 695     <strong class="reserved">else</strong>
<a id="L696" name="L696"></a> 696     <em class="brace">{</em>
<a id="L697" name="L697"></a> 697       returnMsg = "";
<a id="L698" name="L698"></a> 698     <em class="brace">}</em>
<a id="L699" name="L699"></a> 699 
<a id="L700" name="L700"></a> 700     <strong class="reserved">return</strong> returnMsg;
<a id="L701" name="L701"></a> 701   <em class="brace">}</em>
<a id="L702" name="L702"></a> 702 
<div class="comment">
    Given a string, return the corresponding function token.
    @param key A local name of a function.
    @return   The function ID, which may correspond to one of the FUNC_XXX
       values found in {@link com.sun.org.apache.xpath.internal.compiler.FunctionTable}, but may
       be a value installed by an external module.</div>
<a id="L712" name="L712"></a> 712   <strong class="reserved">final</strong> <strong class="reserved">int</strong> <a href="../S/4999.html#L1505" title="Referred from 1505 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">getFunctionToken</a>(<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>)
<a id="L713" name="L713"></a> 713   <em class="brace">{</em>
<a id="L714" name="L714"></a> 714 
<a id="L715" name="L715"></a> 715     <strong class="reserved">int</strong> tok;
<a id="L716" name="L716"></a> 716 
<a id="L717" name="L717"></a> 717     <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>;
<a id="L718" name="L718"></a> 718 
<a id="L719" name="L719"></a> 719     <strong class="reserved">try</strong>
<a id="L720" name="L720"></a> 720     <em class="brace">{</em>
<a id="L721" name="L721"></a> 721       <em class="comment">// These are nodetests, xpathparser treats them as functions when parsing</em>
<a id="L722" name="L722"></a> 722       <em class="comment">// a FilterExpr.</em>
<a id="L723" name="L723"></a> 723       <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a> = <a href="../S/4993.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/compiler/Keywords.java.">Keywords</a>.<a href="../S/4993.html#L277" title="Defined at 277 in src/com/sun/org/apache/xpath/internal/compiler/Keywords.java.">lookupNodeTest</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>);
<a id="L724" name="L724"></a> 724       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>) <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a> = m_functionTable.<a href="../S/4995.html#L354" title="Defined at 354 in src/com/sun/org/apache/xpath/internal/compiler/FunctionTable.java.">getFunctionID</a>(<a href="../D/26706.html" title="Multiple defined in 2 places.">key</a>);
<a id="L725" name="L725"></a> 725       tok = ((<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>) <a href="../D/24291.html" title="Multiple defined in 202 places.">id</a>).<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>();
<a id="L726" name="L726"></a> 726     <em class="brace">}</em>
<a id="L727" name="L727"></a> 727     <strong class="reserved">catch</strong> (<a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a> npe)
<a id="L728" name="L728"></a> 728     <em class="brace">{</em>
<a id="L729" name="L729"></a> 729       tok = -1;
<a id="L730" name="L730"></a> 730     <em class="brace">}</em>
<a id="L731" name="L731"></a> 731     <strong class="reserved">catch</strong> (<a href="../S/1727.html#L41" title="Defined at 41 in src/java/lang/ClassCastException.java.">ClassCastException</a> cce)
<a id="L732" name="L732"></a> 732     <em class="brace">{</em>
<a id="L733" name="L733"></a> 733       tok = -1;
<a id="L734" name="L734"></a> 734     <em class="brace">}</em>
<a id="L735" name="L735"></a> 735 
<a id="L736" name="L736"></a> 736     <strong class="reserved">return</strong> tok;
<a id="L737" name="L737"></a> 737   <em class="brace">}</em>
<a id="L738" name="L738"></a> 738 
<div class="comment">
    Insert room for operation.  This will NOT set
    the length value of the operation, but will update
    the length value for the total expression.
    @param pos The position where the op is to be inserted.
    @param length The length of the operation space in the op map.
    @param op The op code to the inserted.</div>
<a id="L748" name="L748"></a> 748   <strong class="reserved">void</strong> <a href="../R/20786.html" title="Multiple referred from 22 places.">insertOp</a>(<strong class="reserved">int</strong> pos, <strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>, <strong class="reserved">int</strong> <a href="../D/28500.html" title="Multiple defined in 3 places.">op</a>)
<a id="L749" name="L749"></a> 749   <em class="brace">{</em>
<a id="L750" name="L750"></a> 750 
<a id="L751" name="L751"></a> 751     <strong class="reserved">int</strong> totalLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L752" name="L752"></a> 752 
<a id="L753" name="L753"></a> 753     <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = totalLen - 1; i &gt;= pos; i--)
<a id="L754" name="L754"></a> 754     <em class="brace">{</em>
<a id="L755" name="L755"></a> 755       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(i + <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(i));
<a id="L756" name="L756"></a> 756     <em class="brace">}</em>
<a id="L757" name="L757"></a> 757 
<a id="L758" name="L758"></a> 758     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(pos,<a href="../D/28500.html" title="Multiple defined in 3 places.">op</a>);
<a id="L759" name="L759"></a> 759     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,totalLen + <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L760" name="L760"></a> 760   <em class="brace">}</em>
<a id="L761" name="L761"></a> 761 
<div class="comment">
    Insert room for operation.  This WILL set
    the length value of the operation, and will update
    the length value for the total expression.
    @param length The length of the operation.
    @param op The op code to the inserted.</div>
<a id="L770" name="L770"></a> 770   <strong class="reserved">void</strong> <a href="../R/10229.html" title="Multiple referred from 30 places.">appendOp</a>(<strong class="reserved">int</strong> <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>, <strong class="reserved">int</strong> <a href="../D/28500.html" title="Multiple defined in 3 places.">op</a>)
<a id="L771" name="L771"></a> 771   <em class="brace">{</em>
<a id="L772" name="L772"></a> 772 
<a id="L773" name="L773"></a> 773     <strong class="reserved">int</strong> totalLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L774" name="L774"></a> 774 
<a id="L775" name="L775"></a> 775     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(totalLen, <a href="../D/28500.html" title="Multiple defined in 3 places.">op</a>);
<a id="L776" name="L776"></a> 776     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(totalLen + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L777" name="L777"></a> 777     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, totalLen + <a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L778" name="L778"></a> 778   <em class="brace">}</em>
<a id="L779" name="L779"></a> 779 
<a id="L780" name="L780"></a> 780   <em class="comment">// ============= EXPRESSIONS FUNCTIONS =================</em>
<a id="L781" name="L781"></a> 781 
<div class="comment">
    Expr  ::=  OrExpr
    @throws javax.xml.transform.TransformerException</div>
<a id="L790" name="L790"></a> 790   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/2793.html" title="Multiple referred from 7 places.">Expr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L791" name="L791"></a> 791   <em class="brace">{</em>
<a id="L792" name="L792"></a> 792     <a href="../S/4999.html#L804" title="Defined at 804 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">OrExpr</a>();
<a id="L793" name="L793"></a> 793   <em class="brace">}</em>
<a id="L794" name="L794"></a> 794 
<div class="comment">
    OrExpr  ::=  AndExpr
    | OrExpr 'or' AndExpr
    @throws javax.xml.transform.TransformerException</div>
<a id="L804" name="L804"></a> 804   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/5850.html" title="Multiple referred from 2 places.">OrExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L805" name="L805"></a> 805   <em class="brace">{</em>
<a id="L806" name="L806"></a> 806 
<a id="L807" name="L807"></a> 807     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L808" name="L808"></a> 808 
<a id="L809" name="L809"></a> 809     <a href="../S/4999.html#L831" title="Defined at 831 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AndExpr</a>();
<a id="L810" name="L810"></a> 810 
<a id="L811" name="L811"></a> 811     <strong class="reserved">if</strong> ((<strong class="reserved">null</strong> != m_token) &amp;&amp; <a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>("or"))
<a id="L812" name="L812"></a> 812     <em class="brace">{</em>
<a id="L813" name="L813"></a> 813       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L814" name="L814"></a> 814       <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(opPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_OR);
<a id="L815" name="L815"></a> 815       <a href="../S/4999.html#L804" title="Defined at 804 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">OrExpr</a>();
<a id="L816" name="L816"></a> 816 
<a id="L817" name="L817"></a> 817       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L818" name="L818"></a> 818         m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L819" name="L819"></a> 819     <em class="brace">}</em>
<a id="L820" name="L820"></a> 820   <em class="brace">}</em>
<a id="L821" name="L821"></a> 821 
<div class="comment">
    AndExpr  ::=  EqualityExpr
    | AndExpr 'and' EqualityExpr
    @throws javax.xml.transform.TransformerException</div>
<a id="L831" name="L831"></a> 831   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/377.html" title="Multiple referred from 2 places.">AndExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L832" name="L832"></a> 832   <em class="brace">{</em>
<a id="L833" name="L833"></a> 833 
<a id="L834" name="L834"></a> 834     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L835" name="L835"></a> 835 
<a id="L836" name="L836"></a> 836     <a href="../D/2954.html" title="Multiple defined in 2 places.">EqualityExpr</a>(-1);
<a id="L837" name="L837"></a> 837 
<a id="L838" name="L838"></a> 838     <strong class="reserved">if</strong> ((<strong class="reserved">null</strong> != m_token) &amp;&amp; <a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>("and"))
<a id="L839" name="L839"></a> 839     <em class="brace">{</em>
<a id="L840" name="L840"></a> 840       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L841" name="L841"></a> 841       <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(opPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_AND);
<a id="L842" name="L842"></a> 842       <a href="../S/4999.html#L831" title="Defined at 831 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AndExpr</a>();
<a id="L843" name="L843"></a> 843 
<a id="L844" name="L844"></a> 844       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L845" name="L845"></a> 845         m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L846" name="L846"></a> 846     <em class="brace">}</em>
<a id="L847" name="L847"></a> 847   <em class="brace">}</em>
<a id="L848" name="L848"></a> 848 
<div class="comment">
    @returns an Object which is either a String, a Number, a Boolean, or a vector
    of nodes.
    EqualityExpr  ::=  RelationalExpr
    | EqualityExpr '=' RelationalExpr
    @param addPos Position where expression is to be added, or -1 for append.
    @return the position at the end of the equality expression.
    @throws javax.xml.transform.TransformerException</div>
<a id="L864" name="L864"></a> 864   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/2721.html" title="Multiple referred from 13 places.">EqualityExpr</a>(<strong class="reserved">int</strong> addPos) <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L865" name="L865"></a> 865   <em class="brace">{</em>
<a id="L866" name="L866"></a> 866 
<a id="L867" name="L867"></a> 867     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L868" name="L868"></a> 868 
<a id="L869" name="L869"></a> 869     <strong class="reserved">if</strong> (-1 == addPos)
<a id="L870" name="L870"></a> 870       addPos = opPos;
<a id="L871" name="L871"></a> 871 
<a id="L872" name="L872"></a> 872     <a href="../D/7232.html" title="Multiple defined in 2 places.">RelationalExpr</a>(-1);
<a id="L873" name="L873"></a> 873 
<a id="L874" name="L874"></a> 874     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L875" name="L875"></a> 875     <em class="brace">{</em>
<a id="L876" name="L876"></a> 876       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('!') &amp;&amp; <a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>('=', 1))
<a id="L877" name="L877"></a> 877       <em class="brace">{</em>
<a id="L878" name="L878"></a> 878         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L879" name="L879"></a> 879         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L880" name="L880"></a> 880         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_NOTEQUALS);
<a id="L881" name="L881"></a> 881 
<a id="L882" name="L882"></a> 882         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L883" name="L883"></a> 883 
<a id="L884" name="L884"></a> 884         addPos = <a href="../D/2954.html" title="Multiple defined in 2 places.">EqualityExpr</a>(addPos);
<a id="L885" name="L885"></a> 885         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L886" name="L886"></a> 886           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L887" name="L887"></a> 887         addPos += 2;
<a id="L888" name="L888"></a> 888       <em class="brace">}</em>
<a id="L889" name="L889"></a> 889       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('='))
<a id="L890" name="L890"></a> 890       <em class="brace">{</em>
<a id="L891" name="L891"></a> 891         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L892" name="L892"></a> 892         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_EQUALS);
<a id="L893" name="L893"></a> 893 
<a id="L894" name="L894"></a> 894         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L895" name="L895"></a> 895 
<a id="L896" name="L896"></a> 896         addPos = <a href="../D/2954.html" title="Multiple defined in 2 places.">EqualityExpr</a>(addPos);
<a id="L897" name="L897"></a> 897         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L898" name="L898"></a> 898           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L899" name="L899"></a> 899         addPos += 2;
<a id="L900" name="L900"></a> 900       <em class="brace">}</em>
<a id="L901" name="L901"></a> 901     <em class="brace">}</em>
<a id="L902" name="L902"></a> 902 
<a id="L903" name="L903"></a> 903     <strong class="reserved">return</strong> addPos;
<a id="L904" name="L904"></a> 904   <em class="brace">}</em>
<a id="L905" name="L905"></a> 905 
<div class="comment">
    .
    @returns an Object which is either a String, a Number, a Boolean, or a vector
    of nodes.
    RelationalExpr  ::=  AdditiveExpr
    | RelationalExpr '&lt;' AdditiveExpr
    | RelationalExpr '&gt;' AdditiveExpr
    | RelationalExpr '&lt;=' AdditiveExpr
    | RelationalExpr '&gt;=' AdditiveExpr
    @param addPos Position where expression is to be added, or -1 for append.
    @return the position at the end of the relational expression.
    @throws javax.xml.transform.TransformerException</div>
<a id="L924" name="L924"></a> 924   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/6592.html" title="Multiple referred from 7 places.">RelationalExpr</a>(<strong class="reserved">int</strong> addPos) <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L925" name="L925"></a> 925   <em class="brace">{</em>
<a id="L926" name="L926"></a> 926 
<a id="L927" name="L927"></a> 927     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L928" name="L928"></a> 928 
<a id="L929" name="L929"></a> 929     <strong class="reserved">if</strong> (-1 == addPos)
<a id="L930" name="L930"></a> 930       addPos = opPos;
<a id="L931" name="L931"></a> 931 
<a id="L932" name="L932"></a> 932     <a href="../S/4999.html#L999" title="Defined at 999 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AdditiveExpr</a>(-1);
<a id="L933" name="L933"></a> 933 
<a id="L934" name="L934"></a> 934     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L935" name="L935"></a> 935     <em class="brace">{</em>
<a id="L936" name="L936"></a> 936       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('&lt;'))
<a id="L937" name="L937"></a> 937       <em class="brace">{</em>
<a id="L938" name="L938"></a> 938         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L939" name="L939"></a> 939 
<a id="L940" name="L940"></a> 940         <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('='))
<a id="L941" name="L941"></a> 941         <em class="brace">{</em>
<a id="L942" name="L942"></a> 942           <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L943" name="L943"></a> 943           <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_LTE);
<a id="L944" name="L944"></a> 944         <em class="brace">}</em>
<a id="L945" name="L945"></a> 945         <strong class="reserved">else</strong>
<a id="L946" name="L946"></a> 946         <em class="brace">{</em>
<a id="L947" name="L947"></a> 947           <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_LT);
<a id="L948" name="L948"></a> 948         <em class="brace">}</em>
<a id="L949" name="L949"></a> 949 
<a id="L950" name="L950"></a> 950         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L951" name="L951"></a> 951 
<a id="L952" name="L952"></a> 952         addPos = <a href="../D/7232.html" title="Multiple defined in 2 places.">RelationalExpr</a>(addPos);
<a id="L953" name="L953"></a> 953         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L954" name="L954"></a> 954           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L955" name="L955"></a> 955         addPos += 2;
<a id="L956" name="L956"></a> 956       <em class="brace">}</em>
<a id="L957" name="L957"></a> 957       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('&gt;'))
<a id="L958" name="L958"></a> 958       <em class="brace">{</em>
<a id="L959" name="L959"></a> 959         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L960" name="L960"></a> 960 
<a id="L961" name="L961"></a> 961         <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('='))
<a id="L962" name="L962"></a> 962         <em class="brace">{</em>
<a id="L963" name="L963"></a> 963           <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L964" name="L964"></a> 964           <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_GTE);
<a id="L965" name="L965"></a> 965         <em class="brace">}</em>
<a id="L966" name="L966"></a> 966         <strong class="reserved">else</strong>
<a id="L967" name="L967"></a> 967         <em class="brace">{</em>
<a id="L968" name="L968"></a> 968           <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_GT);
<a id="L969" name="L969"></a> 969         <em class="brace">}</em>
<a id="L970" name="L970"></a> 970 
<a id="L971" name="L971"></a> 971         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L972" name="L972"></a> 972 
<a id="L973" name="L973"></a> 973         addPos = <a href="../D/7232.html" title="Multiple defined in 2 places.">RelationalExpr</a>(addPos);
<a id="L974" name="L974"></a> 974         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L975" name="L975"></a> 975           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L976" name="L976"></a> 976         addPos += 2;
<a id="L977" name="L977"></a> 977       <em class="brace">}</em>
<a id="L978" name="L978"></a> 978     <em class="brace">}</em>
<a id="L979" name="L979"></a> 979 
<a id="L980" name="L980"></a> 980     <strong class="reserved">return</strong> addPos;
<a id="L981" name="L981"></a> 981   <em class="brace">}</em>
<a id="L982" name="L982"></a> 982 
<div class="comment">
    This has to handle construction of the operations so that they are evaluated
    in pre-fix order.  So, for 9+7-6, instead of |+|9|-|7|6|, this needs to be
    evaluated as |-|+|9|7|6|.
    AdditiveExpr  ::=  MultiplicativeExpr
    | AdditiveExpr '+' MultiplicativeExpr
    | AdditiveExpr '-' MultiplicativeExpr
    @param addPos Position where expression is to be added, or -1 for append.
    @return the position at the end of the equality expression.
    @throws javax.xml.transform.TransformerException</div>
<a id="L999" name="L999"></a> 999   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/325.html" title="Multiple referred from 3 places.">AdditiveExpr</a>(<strong class="reserved">int</strong> addPos) <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1000" name="L1000"></a>1000   <em class="brace">{</em>
<a id="L1001" name="L1001"></a>1001 
<a id="L1002" name="L1002"></a>1002     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1003" name="L1003"></a>1003 
<a id="L1004" name="L1004"></a>1004     <strong class="reserved">if</strong> (-1 == addPos)
<a id="L1005" name="L1005"></a>1005       addPos = opPos;
<a id="L1006" name="L1006"></a>1006 
<a id="L1007" name="L1007"></a>1007     <a href="../S/4999.html#L1057" title="Defined at 1057 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">MultiplicativeExpr</a>(-1);
<a id="L1008" name="L1008"></a>1008 
<a id="L1009" name="L1009"></a>1009     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L1010" name="L1010"></a>1010     <em class="brace">{</em>
<a id="L1011" name="L1011"></a>1011       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('+'))
<a id="L1012" name="L1012"></a>1012       <em class="brace">{</em>
<a id="L1013" name="L1013"></a>1013         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1014" name="L1014"></a>1014         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_PLUS);
<a id="L1015" name="L1015"></a>1015 
<a id="L1016" name="L1016"></a>1016         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L1017" name="L1017"></a>1017 
<a id="L1018" name="L1018"></a>1018         addPos = <a href="../S/4999.html#L999" title="Defined at 999 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AdditiveExpr</a>(addPos);
<a id="L1019" name="L1019"></a>1019         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1020" name="L1020"></a>1020           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L1021" name="L1021"></a>1021         addPos += 2;
<a id="L1022" name="L1022"></a>1022       <em class="brace">}</em>
<a id="L1023" name="L1023"></a>1023       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('-'))
<a id="L1024" name="L1024"></a>1024       <em class="brace">{</em>
<a id="L1025" name="L1025"></a>1025         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1026" name="L1026"></a>1026         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_MINUS);
<a id="L1027" name="L1027"></a>1027 
<a id="L1028" name="L1028"></a>1028         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L1029" name="L1029"></a>1029 
<a id="L1030" name="L1030"></a>1030         addPos = <a href="../S/4999.html#L999" title="Defined at 999 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AdditiveExpr</a>(addPos);
<a id="L1031" name="L1031"></a>1031         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1032" name="L1032"></a>1032           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L1033" name="L1033"></a>1033         addPos += 2;
<a id="L1034" name="L1034"></a>1034       <em class="brace">}</em>
<a id="L1035" name="L1035"></a>1035     <em class="brace">}</em>
<a id="L1036" name="L1036"></a>1036 
<a id="L1037" name="L1037"></a>1037     <strong class="reserved">return</strong> addPos;
<a id="L1038" name="L1038"></a>1038   <em class="brace">}</em>
<a id="L1039" name="L1039"></a>1039 
<div class="comment">
    This has to handle construction of the operations so that they are evaluated
    in pre-fix order.  So, for 9+7-6, instead of |+|9|-|7|6|, this needs to be
    evaluated as |-|+|9|7|6|.
    MultiplicativeExpr  ::=  UnaryExpr
    | MultiplicativeExpr MultiplyOperator UnaryExpr
    | MultiplicativeExpr 'div' UnaryExpr
    | MultiplicativeExpr 'mod' UnaryExpr
    | MultiplicativeExpr 'quo' UnaryExpr
    @param addPos Position where expression is to be added, or -1 for append.
    @return the position at the end of the equality expression.
    @throws javax.xml.transform.TransformerException</div>
<a id="L1057" name="L1057"></a>1057   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/5342.html" title="Multiple referred from 5 places.">MultiplicativeExpr</a>(<strong class="reserved">int</strong> addPos) <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1058" name="L1058"></a>1058   <em class="brace">{</em>
<a id="L1059" name="L1059"></a>1059 
<a id="L1060" name="L1060"></a>1060     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1061" name="L1061"></a>1061 
<a id="L1062" name="L1062"></a>1062     <strong class="reserved">if</strong> (-1 == addPos)
<a id="L1063" name="L1063"></a>1063       addPos = opPos;
<a id="L1064" name="L1064"></a>1064 
<a id="L1065" name="L1065"></a>1065     <a href="../S/4999.html#L1130" title="Defined at 1130 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">UnaryExpr</a>();
<a id="L1066" name="L1066"></a>1066 
<a id="L1067" name="L1067"></a>1067     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L1068" name="L1068"></a>1068     <em class="brace">{</em>
<a id="L1069" name="L1069"></a>1069       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('*'))
<a id="L1070" name="L1070"></a>1070       <em class="brace">{</em>
<a id="L1071" name="L1071"></a>1071         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1072" name="L1072"></a>1072         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_MULT);
<a id="L1073" name="L1073"></a>1073 
<a id="L1074" name="L1074"></a>1074         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L1075" name="L1075"></a>1075 
<a id="L1076" name="L1076"></a>1076         addPos = <a href="../S/4999.html#L1057" title="Defined at 1057 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">MultiplicativeExpr</a>(addPos);
<a id="L1077" name="L1077"></a>1077         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1078" name="L1078"></a>1078           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L1079" name="L1079"></a>1079         addPos += 2;
<a id="L1080" name="L1080"></a>1080       <em class="brace">}</em>
<a id="L1081" name="L1081"></a>1081       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>("div"))
<a id="L1082" name="L1082"></a>1082       <em class="brace">{</em>
<a id="L1083" name="L1083"></a>1083         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1084" name="L1084"></a>1084         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_DIV);
<a id="L1085" name="L1085"></a>1085 
<a id="L1086" name="L1086"></a>1086         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L1087" name="L1087"></a>1087 
<a id="L1088" name="L1088"></a>1088         addPos = <a href="../S/4999.html#L1057" title="Defined at 1057 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">MultiplicativeExpr</a>(addPos);
<a id="L1089" name="L1089"></a>1089         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1090" name="L1090"></a>1090           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L1091" name="L1091"></a>1091         addPos += 2;
<a id="L1092" name="L1092"></a>1092       <em class="brace">}</em>
<a id="L1093" name="L1093"></a>1093       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>("mod"))
<a id="L1094" name="L1094"></a>1094       <em class="brace">{</em>
<a id="L1095" name="L1095"></a>1095         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1096" name="L1096"></a>1096         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_MOD);
<a id="L1097" name="L1097"></a>1097 
<a id="L1098" name="L1098"></a>1098         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L1099" name="L1099"></a>1099 
<a id="L1100" name="L1100"></a>1100         addPos = <a href="../S/4999.html#L1057" title="Defined at 1057 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">MultiplicativeExpr</a>(addPos);
<a id="L1101" name="L1101"></a>1101         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1102" name="L1102"></a>1102           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L1103" name="L1103"></a>1103         addPos += 2;
<a id="L1104" name="L1104"></a>1104       <em class="brace">}</em>
<a id="L1105" name="L1105"></a>1105       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>("quo"))
<a id="L1106" name="L1106"></a>1106       <em class="brace">{</em>
<a id="L1107" name="L1107"></a>1107         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1108" name="L1108"></a>1108         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(addPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_QUO);
<a id="L1109" name="L1109"></a>1109 
<a id="L1110" name="L1110"></a>1110         <strong class="reserved">int</strong> opPlusLeftHandLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - addPos;
<a id="L1111" name="L1111"></a>1111 
<a id="L1112" name="L1112"></a>1112         addPos = <a href="../S/4999.html#L1057" title="Defined at 1057 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">MultiplicativeExpr</a>(addPos);
<a id="L1113" name="L1113"></a>1113         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(addPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1114" name="L1114"></a>1114           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(addPos + opPlusLeftHandLen + 1) + opPlusLeftHandLen);
<a id="L1115" name="L1115"></a>1115         addPos += 2;
<a id="L1116" name="L1116"></a>1116       <em class="brace">}</em>
<a id="L1117" name="L1117"></a>1117     <em class="brace">}</em>
<a id="L1118" name="L1118"></a>1118 
<a id="L1119" name="L1119"></a>1119     <strong class="reserved">return</strong> addPos;
<a id="L1120" name="L1120"></a>1120   <em class="brace">}</em>
<a id="L1121" name="L1121"></a>1121 
<div class="comment">
    UnaryExpr  ::=  UnionExpr
    | '-' UnaryExpr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1130" name="L1130"></a>1130   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/4999.html#L1065" title="Referred from 1065 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">UnaryExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1131" name="L1131"></a>1131   <em class="brace">{</em>
<a id="L1132" name="L1132"></a>1132 
<a id="L1133" name="L1133"></a>1133     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1134" name="L1134"></a>1134     <strong class="reserved">boolean</strong> isNeg = <strong class="reserved">false</strong>;
<a id="L1135" name="L1135"></a>1135 
<a id="L1136" name="L1136"></a>1136     <strong class="reserved">if</strong> (m_tokenChar == '-')
<a id="L1137" name="L1137"></a>1137     <em class="brace">{</em>
<a id="L1138" name="L1138"></a>1138       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1139" name="L1139"></a>1139       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_NEG);
<a id="L1140" name="L1140"></a>1140 
<a id="L1141" name="L1141"></a>1141       isNeg = <strong class="reserved">true</strong>;
<a id="L1142" name="L1142"></a>1142     <em class="brace">}</em>
<a id="L1143" name="L1143"></a>1143 
<a id="L1144" name="L1144"></a>1144     <a href="../S/4999.html#L1229" title="Defined at 1229 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">UnionExpr</a>();
<a id="L1145" name="L1145"></a>1145 
<a id="L1146" name="L1146"></a>1146     <strong class="reserved">if</strong> (isNeg)
<a id="L1147" name="L1147"></a>1147       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1148" name="L1148"></a>1148         m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1149" name="L1149"></a>1149   <em class="brace">}</em>
<a id="L1150" name="L1150"></a>1150 
<div class="comment">
    StringExpr  ::=  Expr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1158" name="L1158"></a>1158   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> StringExpr() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1159" name="L1159"></a>1159   <em class="brace">{</em>
<a id="L1160" name="L1160"></a>1160 
<a id="L1161" name="L1161"></a>1161     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1162" name="L1162"></a>1162 
<a id="L1163" name="L1163"></a>1163     <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_STRING);
<a id="L1164" name="L1164"></a>1164     <a href="../S/4999.html#L790" title="Defined at 790 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Expr</a>();
<a id="L1165" name="L1165"></a>1165 
<a id="L1166" name="L1166"></a>1166     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1167" name="L1167"></a>1167       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1168" name="L1168"></a>1168   <em class="brace">}</em>
<a id="L1169" name="L1169"></a>1169 
<div class="comment">
    StringExpr  ::=  Expr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1178" name="L1178"></a>1178   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/858.html" title="Multiple referred from 3 places.">BooleanExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1179" name="L1179"></a>1179   <em class="brace">{</em>
<a id="L1180" name="L1180"></a>1180 
<a id="L1181" name="L1181"></a>1181     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1182" name="L1182"></a>1182 
<a id="L1183" name="L1183"></a>1183     <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_BOOL);
<a id="L1184" name="L1184"></a>1184     <a href="../S/4999.html#L790" title="Defined at 790 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Expr</a>();
<a id="L1185" name="L1185"></a>1185 
<a id="L1186" name="L1186"></a>1186     <strong class="reserved">int</strong> opLen = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos;
<a id="L1187" name="L1187"></a>1187 
<a id="L1188" name="L1188"></a>1188     <strong class="reserved">if</strong> (opLen == 2)
<a id="L1189" name="L1189"></a>1189     <em class="brace">{</em>
<a id="L1190" name="L1190"></a>1190       <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_BOOLEAN_ARG_NO_LONGER_OPTIONAL, <strong class="reserved">null</strong>);  <em class="comment">//"boolean(...) argument is no longer optional with 19990709 XPath draft.");</em>
<a id="L1191" name="L1191"></a>1191     <em class="brace">}</em>
<a id="L1192" name="L1192"></a>1192 
<a id="L1193" name="L1193"></a>1193     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, opLen);
<a id="L1194" name="L1194"></a>1194   <em class="brace">}</em>
<a id="L1195" name="L1195"></a>1195 
<div class="comment">
    NumberExpr  ::=  Expr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1204" name="L1204"></a>1204   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> NumberExpr() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1205" name="L1205"></a>1205   <em class="brace">{</em>
<a id="L1206" name="L1206"></a>1206 
<a id="L1207" name="L1207"></a>1207     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1208" name="L1208"></a>1208 
<a id="L1209" name="L1209"></a>1209     <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_NUMBER);
<a id="L1210" name="L1210"></a>1210     <a href="../S/4999.html#L790" title="Defined at 790 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Expr</a>();
<a id="L1211" name="L1211"></a>1211 
<a id="L1212" name="L1212"></a>1212     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1213" name="L1213"></a>1213       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1214" name="L1214"></a>1214   <em class="brace">}</em>
<a id="L1215" name="L1215"></a>1215 
<div class="comment">
    The context of the right hand side expressions is the context of the
    left hand side expression. The results of the right hand side expressions
    are node sets. The result of the left hand side UnionExpr is the union
    of the results of the right hand side expressions.
    UnionExpr    ::=    PathExpr
    | UnionExpr '|' PathExpr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1229" name="L1229"></a>1229   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/4999.html#L1144" title="Referred from 1144 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">UnionExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1230" name="L1230"></a>1230   <em class="brace">{</em>
<a id="L1231" name="L1231"></a>1231 
<a id="L1232" name="L1232"></a>1232     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1233" name="L1233"></a>1233     <strong class="reserved">boolean</strong> continueOrLoop = <strong class="reserved">true</strong>;
<a id="L1234" name="L1234"></a>1234     <strong class="reserved">boolean</strong> foundUnion = <strong class="reserved">false</strong>;
<a id="L1235" name="L1235"></a>1235 
<a id="L1236" name="L1236"></a>1236     <strong class="reserved">do</strong>
<a id="L1237" name="L1237"></a>1237     <em class="brace">{</em>
<a id="L1238" name="L1238"></a>1238       <a href="../S/4999.html#L1275" title="Defined at 1275 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">PathExpr</a>();
<a id="L1239" name="L1239"></a>1239 
<a id="L1240" name="L1240"></a>1240       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('|'))
<a id="L1241" name="L1241"></a>1241       <em class="brace">{</em>
<a id="L1242" name="L1242"></a>1242         <strong class="reserved">if</strong> (<strong class="reserved">false</strong> == foundUnion)
<a id="L1243" name="L1243"></a>1243         <em class="brace">{</em>
<a id="L1244" name="L1244"></a>1244           foundUnion = <strong class="reserved">true</strong>;
<a id="L1245" name="L1245"></a>1245 
<a id="L1246" name="L1246"></a>1246           <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(opPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_UNION);
<a id="L1247" name="L1247"></a>1247         <em class="brace">}</em>
<a id="L1248" name="L1248"></a>1248 
<a id="L1249" name="L1249"></a>1249         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1250" name="L1250"></a>1250       <em class="brace">}</em>
<a id="L1251" name="L1251"></a>1251       <strong class="reserved">else</strong>
<a id="L1252" name="L1252"></a>1252       <em class="brace">{</em>
<a id="L1253" name="L1253"></a>1253         <strong class="reserved">break</strong>;
<a id="L1254" name="L1254"></a>1254       <em class="brace">}</em>
<a id="L1255" name="L1255"></a>1255 
<a id="L1256" name="L1256"></a>1256       <em class="comment">// this.m_testForDocOrder = true;</em>
<a id="L1257" name="L1257"></a>1257     <em class="brace">}</em>
<a id="L1258" name="L1258"></a>1258     <strong class="reserved">while</strong> (continueOrLoop);
<a id="L1259" name="L1259"></a>1259 
<a id="L1260" name="L1260"></a>1260     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1261" name="L1261"></a>1261           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1262" name="L1262"></a>1262   <em class="brace">}</em>
<a id="L1263" name="L1263"></a>1263 
<div class="comment">
    PathExpr  ::=  LocationPath
    | FilterExpr
    | FilterExpr '/' RelativeLocationPath
    | FilterExpr '//' RelativeLocationPath
    @throws XSLProcessorException thrown if the active ProblemListener and XPathContext decide
    the error condition is severe enough to halt processing.
    @throws javax.xml.transform.TransformerException</div>
<a id="L1275" name="L1275"></a>1275   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/4999.html#L1238" title="Referred from 1238 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">PathExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1276" name="L1276"></a>1276   <em class="brace">{</em>
<a id="L1277" name="L1277"></a>1277 
<a id="L1278" name="L1278"></a>1278     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1279" name="L1279"></a>1279 
<a id="L1280" name="L1280"></a>1280     <strong class="reserved">int</strong> filterExprMatch = <a href="../D/3249.html" title="Multiple defined in 2 places.">FilterExpr</a>();
<a id="L1281" name="L1281"></a>1281 
<a id="L1282" name="L1282"></a>1282     <strong class="reserved">if</strong> (filterExprMatch != FILTER_MATCH_FAILED)
<a id="L1283" name="L1283"></a>1283     <em class="brace">{</em>
<a id="L1284" name="L1284"></a>1284       <em class="comment">// If FilterExpr had Predicates, a OP_LOCATIONPATH opcode would already</em>
<a id="L1285" name="L1285"></a>1285       <em class="comment">// have been inserted.</em>
<a id="L1286" name="L1286"></a>1286       <strong class="reserved">boolean</strong> locationPathStarted = (filterExprMatch==FILTER_MATCH_PREDICATES);
<a id="L1287" name="L1287"></a>1287 
<a id="L1288" name="L1288"></a>1288       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/'))
<a id="L1289" name="L1289"></a>1289       <em class="brace">{</em>
<a id="L1290" name="L1290"></a>1290         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1291" name="L1291"></a>1291 
<a id="L1292" name="L1292"></a>1292         <strong class="reserved">if</strong> (!locationPathStarted)
<a id="L1293" name="L1293"></a>1293         <em class="brace">{</em>
<a id="L1294" name="L1294"></a>1294           <em class="comment">// int locationPathOpPos = opPos;</em>
<a id="L1295" name="L1295"></a>1295           <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(opPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_LOCATIONPATH);
<a id="L1296" name="L1296"></a>1296 
<a id="L1297" name="L1297"></a>1297           locationPathStarted = <strong class="reserved">true</strong>;
<a id="L1298" name="L1298"></a>1298         <em class="brace">}</em>
<a id="L1299" name="L1299"></a>1299 
<a id="L1300" name="L1300"></a>1300         <strong class="reserved">if</strong> (!<a href="../D/7233.html" title="Multiple defined in 2 places.">RelativeLocationPath</a>())
<a id="L1301" name="L1301"></a>1301         <em class="brace">{</em>
<a id="L1302" name="L1302"></a>1302           <em class="comment">// "Relative location path expected following '/' or '//'"</em>
<a id="L1303" name="L1303"></a>1303           <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_REL_LOC_PATH, <strong class="reserved">null</strong>);
<a id="L1304" name="L1304"></a>1304         <em class="brace">}</em>
<a id="L1305" name="L1305"></a>1305 
<a id="L1306" name="L1306"></a>1306       <em class="brace">}</em>
<a id="L1307" name="L1307"></a>1307 
<a id="L1308" name="L1308"></a>1308       <em class="comment">// Terminate for safety.</em>
<a id="L1309" name="L1309"></a>1309       <strong class="reserved">if</strong> (locationPathStarted)
<a id="L1310" name="L1310"></a>1310       <em class="brace">{</em>
<a id="L1311" name="L1311"></a>1311         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ENDOP);
<a id="L1312" name="L1312"></a>1312         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1313" name="L1313"></a>1313         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1314" name="L1314"></a>1314           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1315" name="L1315"></a>1315       <em class="brace">}</em>
<a id="L1316" name="L1316"></a>1316     <em class="brace">}</em>
<a id="L1317" name="L1317"></a>1317     <strong class="reserved">else</strong>
<a id="L1318" name="L1318"></a>1318     <em class="brace">{</em>
<a id="L1319" name="L1319"></a>1319       <a href="../D/5189.html" title="Multiple defined in 2 places.">LocationPath</a>();
<a id="L1320" name="L1320"></a>1320     <em class="brace">}</em>
<a id="L1321" name="L1321"></a>1321   <em class="brace">}</em>
<a id="L1322" name="L1322"></a>1322 
<div class="comment">
    FilterExpr  ::=  PrimaryExpr
    | FilterExpr Predicate
    @throws XSLProcessorException thrown if the active ProblemListener and XPathContext decide
    the error condition is severe enough to halt processing.
    @return  FILTER_MATCH_PREDICATES, if this method successfully matched a
             FilterExpr with one or more Predicates;
             FILTER_MATCH_PRIMARY, if this method successfully matched a
             FilterExpr that was just a PrimaryExpr; or
             FILTER_MATCH_FAILED, if this method did not match a FilterExpr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1340" name="L1340"></a>1340   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../R/2979.html" title="Multiple referred from 2 places.">FilterExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1341" name="L1341"></a>1341   <em class="brace">{</em>
<a id="L1342" name="L1342"></a>1342 
<a id="L1343" name="L1343"></a>1343     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1344" name="L1344"></a>1344 
<a id="L1345" name="L1345"></a>1345     <strong class="reserved">int</strong> filterMatch;
<a id="L1346" name="L1346"></a>1346 
<a id="L1347" name="L1347"></a>1347     <strong class="reserved">if</strong> (<a href="../S/4999.html#L1396" title="Defined at 1396 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">PrimaryExpr</a>())
<a id="L1348" name="L1348"></a>1348     <em class="brace">{</em>
<a id="L1349" name="L1349"></a>1349       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('['))
<a id="L1350" name="L1350"></a>1350       <em class="brace">{</em>
<a id="L1351" name="L1351"></a>1351 
<a id="L1352" name="L1352"></a>1352         <em class="comment">// int locationPathOpPos = opPos;</em>
<a id="L1353" name="L1353"></a>1353         <a href="../S/4999.html#L748" title="Defined at 748 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">insertOp</a>(opPos, 2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_LOCATIONPATH);
<a id="L1354" name="L1354"></a>1354 
<a id="L1355" name="L1355"></a>1355         <strong class="reserved">while</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('['))
<a id="L1356" name="L1356"></a>1356         <em class="brace">{</em>
<a id="L1357" name="L1357"></a>1357           <a href="../D/6788.html" title="Multiple defined in 4 places.">Predicate</a>();
<a id="L1358" name="L1358"></a>1358         <em class="brace">}</em>
<a id="L1359" name="L1359"></a>1359 
<a id="L1360" name="L1360"></a>1360         filterMatch = FILTER_MATCH_PREDICATES;
<a id="L1361" name="L1361"></a>1361       <em class="brace">}</em>
<a id="L1362" name="L1362"></a>1362       <strong class="reserved">else</strong>
<a id="L1363" name="L1363"></a>1363       <em class="brace">{</em>
<a id="L1364" name="L1364"></a>1364         filterMatch = FILTER_MATCH_PRIMARY;
<a id="L1365" name="L1365"></a>1365       <em class="brace">}</em>
<a id="L1366" name="L1366"></a>1366     <em class="brace">}</em>
<a id="L1367" name="L1367"></a>1367     <strong class="reserved">else</strong>
<a id="L1368" name="L1368"></a>1368     <em class="brace">{</em>
<a id="L1369" name="L1369"></a>1369       filterMatch = FILTER_MATCH_FAILED;
<a id="L1370" name="L1370"></a>1370     <em class="brace">}</em>
<a id="L1371" name="L1371"></a>1371 
<a id="L1372" name="L1372"></a>1372     <strong class="reserved">return</strong> filterMatch;
<a id="L1373" name="L1373"></a>1373 
<div class="comment">
      if(tokenIs('['))
      {
        Predicate();
        m_ops.m_opMap[opPos + OpMap.MAPINDEX_LENGTH] = m_ops.m_opMap[OpMap.MAPINDEX_LENGTH] - opPos;
      }</div>
<a id="L1381" name="L1381"></a>1381   <em class="brace">}</em>
<a id="L1382" name="L1382"></a>1382 
<div class="comment">
    PrimaryExpr  ::=  VariableReference
    | '(' Expr ')'
    | Literal
    | Number
    | FunctionCall
    @return true if this method successfully matched a PrimaryExpr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1396" name="L1396"></a>1396   <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../S/4999.html#L1347" title="Referred from 1347 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">PrimaryExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1397" name="L1397"></a>1397   <em class="brace">{</em>
<a id="L1398" name="L1398"></a>1398 
<a id="L1399" name="L1399"></a>1399     <strong class="reserved">boolean</strong> matchFound;
<a id="L1400" name="L1400"></a>1400     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1401" name="L1401"></a>1401 
<a id="L1402" name="L1402"></a>1402     <strong class="reserved">if</strong> ((m_tokenChar == '\'') || (m_tokenChar == '"'))
<a id="L1403" name="L1403"></a>1403     <em class="brace">{</em>
<a id="L1404" name="L1404"></a>1404       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_LITERAL);
<a id="L1405" name="L1405"></a>1405       <a href="../S/4999.html#L2019" title="Defined at 2019 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Literal</a>();
<a id="L1406" name="L1406"></a>1406 
<a id="L1407" name="L1407"></a>1407       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1408" name="L1408"></a>1408         m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1409" name="L1409"></a>1409 
<a id="L1410" name="L1410"></a>1410       matchFound = <strong class="reserved">true</strong>;
<a id="L1411" name="L1411"></a>1411     <em class="brace">}</em>
<a id="L1412" name="L1412"></a>1412     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (m_tokenChar == '$')
<a id="L1413" name="L1413"></a>1413     <em class="brace">{</em>
<a id="L1414" name="L1414"></a>1414       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();  <em class="comment">// consume '$'</em>
<a id="L1415" name="L1415"></a>1415       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_VARIABLE);
<a id="L1416" name="L1416"></a>1416       <a href="../D/6976.html" title="Multiple defined in 5 places.">QName</a>();
<a id="L1417" name="L1417"></a>1417 
<a id="L1418" name="L1418"></a>1418       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1419" name="L1419"></a>1419         m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1420" name="L1420"></a>1420 
<a id="L1421" name="L1421"></a>1421       matchFound = <strong class="reserved">true</strong>;
<a id="L1422" name="L1422"></a>1422     <em class="brace">}</em>
<a id="L1423" name="L1423"></a>1423     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (m_tokenChar == '(')
<a id="L1424" name="L1424"></a>1424     <em class="brace">{</em>
<a id="L1425" name="L1425"></a>1425       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1426" name="L1426"></a>1426       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_GROUP);
<a id="L1427" name="L1427"></a>1427       <a href="../S/4999.html#L790" title="Defined at 790 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Expr</a>();
<a id="L1428" name="L1428"></a>1428       <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>(')');
<a id="L1429" name="L1429"></a>1429 
<a id="L1430" name="L1430"></a>1430       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1431" name="L1431"></a>1431         m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1432" name="L1432"></a>1432 
<a id="L1433" name="L1433"></a>1433       matchFound = <strong class="reserved">true</strong>;
<a id="L1434" name="L1434"></a>1434     <em class="brace">}</em>
<a id="L1435" name="L1435"></a>1435     <strong class="reserved">else</strong> <strong class="reserved">if</strong> ((<strong class="reserved">null</strong> != m_token) &amp;&amp; ((('.' == m_tokenChar) &amp;&amp; (m_token.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() &gt; 1) &amp;&amp; <a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25439.html" title="Multiple defined in 11 places.">isDigit</a>(
<a id="L1436" name="L1436"></a>1436             m_token.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(1))) || <a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25439.html" title="Multiple defined in 11 places.">isDigit</a>(m_tokenChar)))
<a id="L1437" name="L1437"></a>1437     <em class="brace">{</em>
<a id="L1438" name="L1438"></a>1438       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_NUMBERLIT);
<a id="L1439" name="L1439"></a>1439       <a href="../D/6185.html" title="Multiple defined in 4 places.">Number</a>();
<a id="L1440" name="L1440"></a>1440 
<a id="L1441" name="L1441"></a>1441       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1442" name="L1442"></a>1442         m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1443" name="L1443"></a>1443 
<a id="L1444" name="L1444"></a>1444       matchFound = <strong class="reserved">true</strong>;
<a id="L1445" name="L1445"></a>1445     <em class="brace">}</em>
<a id="L1446" name="L1446"></a>1446     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>('(', 1) || (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>(':', 1) &amp;&amp; <a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>('(', 3)))
<a id="L1447" name="L1447"></a>1447     <em class="brace">{</em>
<a id="L1448" name="L1448"></a>1448       matchFound = <a href="../D/3457.html" title="Multiple defined in 2 places.">FunctionCall</a>();
<a id="L1449" name="L1449"></a>1449     <em class="brace">}</em>
<a id="L1450" name="L1450"></a>1450     <strong class="reserved">else</strong>
<a id="L1451" name="L1451"></a>1451     <em class="brace">{</em>
<a id="L1452" name="L1452"></a>1452       matchFound = <strong class="reserved">false</strong>;
<a id="L1453" name="L1453"></a>1453     <em class="brace">}</em>
<a id="L1454" name="L1454"></a>1454 
<a id="L1455" name="L1455"></a>1455     <strong class="reserved">return</strong> matchFound;
<a id="L1456" name="L1456"></a>1456   <em class="brace">}</em>
<a id="L1457" name="L1457"></a>1457 
<div class="comment">
    Argument    ::=    Expr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1465" name="L1465"></a>1465   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/4999.html#L1539" title="Referred from 1539 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Argument</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1466" name="L1466"></a>1466   <em class="brace">{</em>
<a id="L1467" name="L1467"></a>1467 
<a id="L1468" name="L1468"></a>1468     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1469" name="L1469"></a>1469 
<a id="L1470" name="L1470"></a>1470     <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_ARGUMENT);
<a id="L1471" name="L1471"></a>1471     <a href="../S/4999.html#L790" title="Defined at 790 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Expr</a>();
<a id="L1472" name="L1472"></a>1472 
<a id="L1473" name="L1473"></a>1473     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1474" name="L1474"></a>1474       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1475" name="L1475"></a>1475   <em class="brace">}</em>
<a id="L1476" name="L1476"></a>1476 
<div class="comment">
    FunctionCall    ::=    FunctionName '(' ( Argument ( ',' Argument)*)? ')'
    @return true if, and only if, a FunctionCall was matched
    @throws javax.xml.transform.TransformerException</div>
<a id="L1485" name="L1485"></a>1485   <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/3172.html" title="Multiple referred from 31 places.">FunctionCall</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1486" name="L1486"></a>1486   <em class="brace">{</em>
<a id="L1487" name="L1487"></a>1487 
<a id="L1488" name="L1488"></a>1488     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1489" name="L1489"></a>1489 
<a id="L1490" name="L1490"></a>1490     <strong class="reserved">if</strong> (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>(':', 1))
<a id="L1491" name="L1491"></a>1491     <em class="brace">{</em>
<a id="L1492" name="L1492"></a>1492       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(4, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_EXTFUNCTION);
<a id="L1493" name="L1493"></a>1493 
<a id="L1494" name="L1494"></a>1494       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH + 1, m_queueMark - 1);
<a id="L1495" name="L1495"></a>1495 
<a id="L1496" name="L1496"></a>1496       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1497" name="L1497"></a>1497       <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>(':');
<a id="L1498" name="L1498"></a>1498 
<a id="L1499" name="L1499"></a>1499       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH + 2, m_queueMark - 1);
<a id="L1500" name="L1500"></a>1500 
<a id="L1501" name="L1501"></a>1501       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1502" name="L1502"></a>1502     <em class="brace">}</em>
<a id="L1503" name="L1503"></a>1503     <strong class="reserved">else</strong>
<a id="L1504" name="L1504"></a>1504     <em class="brace">{</em>
<a id="L1505" name="L1505"></a>1505       <strong class="reserved">int</strong> funcTok = <a href="../S/4999.html#L712" title="Defined at 712 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">getFunctionToken</a>(m_token);
<a id="L1506" name="L1506"></a>1506 
<a id="L1507" name="L1507"></a>1507       <strong class="reserved">if</strong> (-1 == funcTok)
<a id="L1508" name="L1508"></a>1508       <em class="brace">{</em>
<a id="L1509" name="L1509"></a>1509         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_COULDNOT_FIND_FUNCTION,
<a id="L1510" name="L1510"></a>1510               <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> m_token <em class="brace">}</em>);  <em class="comment">//"Could not find function: "+m_token+"()");</em>
<a id="L1511" name="L1511"></a>1511       <em class="brace">}</em>
<a id="L1512" name="L1512"></a>1512 
<a id="L1513" name="L1513"></a>1513       <strong class="reserved">switch</strong> (funcTok)
<a id="L1514" name="L1514"></a>1514       <em class="brace">{</em>
<a id="L1515" name="L1515"></a>1515       <strong class="reserved">case</strong> <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_PI :
<a id="L1516" name="L1516"></a>1516       <strong class="reserved">case</strong> <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_COMMENT :
<a id="L1517" name="L1517"></a>1517       <strong class="reserved">case</strong> <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_TEXT :
<a id="L1518" name="L1518"></a>1518       <strong class="reserved">case</strong> <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_NODE :
<a id="L1519" name="L1519"></a>1519         <em class="comment">// Node type tests look like function calls, but they're not</em>
<a id="L1520" name="L1520"></a>1520         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1521" name="L1521"></a>1521       <strong class="reserved">default</strong> :
<a id="L1522" name="L1522"></a>1522         <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(3, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_FUNCTION);
<a id="L1523" name="L1523"></a>1523 
<a id="L1524" name="L1524"></a>1524         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH + 1, funcTok);
<a id="L1525" name="L1525"></a>1525       <em class="brace">}</em>
<a id="L1526" name="L1526"></a>1526 
<a id="L1527" name="L1527"></a>1527       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1528" name="L1528"></a>1528     <em class="brace">}</em>
<a id="L1529" name="L1529"></a>1529 
<a id="L1530" name="L1530"></a>1530     <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>('(');
<a id="L1531" name="L1531"></a>1531 
<a id="L1532" name="L1532"></a>1532     <strong class="reserved">while</strong> (!<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(')') &amp;&amp; m_token != <strong class="reserved">null</strong>)
<a id="L1533" name="L1533"></a>1533     <em class="brace">{</em>
<a id="L1534" name="L1534"></a>1534       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(','))
<a id="L1535" name="L1535"></a>1535       <em class="brace">{</em>
<a id="L1536" name="L1536"></a>1536         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_FOUND_COMMA_BUT_NO_PRECEDING_ARG, <strong class="reserved">null</strong>);  <em class="comment">//"Found ',' but no preceding argument!");</em>
<a id="L1537" name="L1537"></a>1537       <em class="brace">}</em>
<a id="L1538" name="L1538"></a>1538 
<a id="L1539" name="L1539"></a>1539       <a href="../S/4999.html#L1465" title="Defined at 1465 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Argument</a>();
<a id="L1540" name="L1540"></a>1540 
<a id="L1541" name="L1541"></a>1541       <strong class="reserved">if</strong> (!<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(')'))
<a id="L1542" name="L1542"></a>1542       <em class="brace">{</em>
<a id="L1543" name="L1543"></a>1543         <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>(',');
<a id="L1544" name="L1544"></a>1544 
<a id="L1545" name="L1545"></a>1545         <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(')'))
<a id="L1546" name="L1546"></a>1546         <em class="brace">{</em>
<a id="L1547" name="L1547"></a>1547           <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_FOUND_COMMA_BUT_NO_FOLLOWING_ARG,
<a id="L1548" name="L1548"></a>1548                 <strong class="reserved">null</strong>);  <em class="comment">//"Found ',' but no following argument!");</em>
<a id="L1549" name="L1549"></a>1549         <em class="brace">}</em>
<a id="L1550" name="L1550"></a>1550       <em class="brace">}</em>
<a id="L1551" name="L1551"></a>1551     <em class="brace">}</em>
<a id="L1552" name="L1552"></a>1552 
<a id="L1553" name="L1553"></a>1553     <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>(')');
<a id="L1554" name="L1554"></a>1554 
<a id="L1555" name="L1555"></a>1555     <em class="comment">// Terminate for safety.</em>
<a id="L1556" name="L1556"></a>1556     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ENDOP);
<a id="L1557" name="L1557"></a>1557     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1558" name="L1558"></a>1558     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1559" name="L1559"></a>1559       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1560" name="L1560"></a>1560 
<a id="L1561" name="L1561"></a>1561     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1562" name="L1562"></a>1562   <em class="brace">}</em>
<a id="L1563" name="L1563"></a>1563 
<a id="L1564" name="L1564"></a>1564   <em class="comment">// ============= GRAMMAR FUNCTIONS =================</em>
<a id="L1565" name="L1565"></a>1565 
<div class="comment">
    LocationPath ::= RelativeLocationPath
    | AbsoluteLocationPath
    @throws javax.xml.transform.TransformerException</div>
<a id="L1574" name="L1574"></a>1574   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/4720.html" title="Multiple referred from 13 places.">LocationPath</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1575" name="L1575"></a>1575   <em class="brace">{</em>
<a id="L1576" name="L1576"></a>1576 
<a id="L1577" name="L1577"></a>1577     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1578" name="L1578"></a>1578 
<a id="L1579" name="L1579"></a>1579     <em class="comment">// int locationPathOpPos = opPos;</em>
<a id="L1580" name="L1580"></a>1580     <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_LOCATIONPATH);
<a id="L1581" name="L1581"></a>1581 
<a id="L1582" name="L1582"></a>1582     <strong class="reserved">boolean</strong> seenSlash = <a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/');
<a id="L1583" name="L1583"></a>1583 
<a id="L1584" name="L1584"></a>1584     <strong class="reserved">if</strong> (seenSlash)
<a id="L1585" name="L1585"></a>1585     <em class="brace">{</em>
<a id="L1586" name="L1586"></a>1586       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(4, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_ROOT);
<a id="L1587" name="L1587"></a>1587 
<a id="L1588" name="L1588"></a>1588       <em class="comment">// Tell how long the step is without the predicate</em>
<a id="L1589" name="L1589"></a>1589       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 2, 4);
<a id="L1590" name="L1590"></a>1590       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 1, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_ROOT);
<a id="L1591" name="L1591"></a>1591 
<a id="L1592" name="L1592"></a>1592       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1593" name="L1593"></a>1593     <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (m_token == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1594" name="L1594"></a>1594       <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_LOC_PATH_AT_END_EXPR, <strong class="reserved">null</strong>);
<a id="L1595" name="L1595"></a>1595     <em class="brace">}</em>
<a id="L1596" name="L1596"></a>1596 
<a id="L1597" name="L1597"></a>1597     <strong class="reserved">if</strong> (m_token != <strong class="reserved">null</strong>)
<a id="L1598" name="L1598"></a>1598     <em class="brace">{</em>
<a id="L1599" name="L1599"></a>1599       <strong class="reserved">if</strong> (!<a href="../D/7233.html" title="Multiple defined in 2 places.">RelativeLocationPath</a>() &amp;&amp; !seenSlash)
<a id="L1600" name="L1600"></a>1600       <em class="brace">{</em>
<a id="L1601" name="L1601"></a>1601         <em class="comment">// Neither a '/' nor a RelativeLocationPath - i.e., matched nothing</em>
<a id="L1602" name="L1602"></a>1602         <em class="comment">// "Location path expected, but found "+m_token+" was encountered."</em>
<a id="L1603" name="L1603"></a>1603         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_LOC_PATH,
<a id="L1604" name="L1604"></a>1604               <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> [] <em class="brace">{</em>m_token<em class="brace">}</em>);
<a id="L1605" name="L1605"></a>1605       <em class="brace">}</em>
<a id="L1606" name="L1606"></a>1606     <em class="brace">}</em>
<a id="L1607" name="L1607"></a>1607 
<a id="L1608" name="L1608"></a>1608     <em class="comment">// Terminate for safety.</em>
<a id="L1609" name="L1609"></a>1609     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ENDOP);
<a id="L1610" name="L1610"></a>1610     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1611" name="L1611"></a>1611     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1612" name="L1612"></a>1612       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1613" name="L1613"></a>1613   <em class="brace">}</em>
<a id="L1614" name="L1614"></a>1614 
<div class="comment">
    RelativeLocationPath ::= Step
    | RelativeLocationPath '/' Step
    | AbbreviatedRelativeLocationPath
    @returns true if, and only if, a RelativeLocationPath was matched
    @throws javax.xml.transform.TransformerException</div>
<a id="L1625" name="L1625"></a>1625   <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/6593.html" title="Multiple referred from 16 places.">RelativeLocationPath</a>()
<a id="L1626" name="L1626"></a>1626                <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1627" name="L1627"></a>1627   <em class="brace">{</em>
<a id="L1628" name="L1628"></a>1628     <strong class="reserved">if</strong> (!<a href="../D/8383.html" title="Multiple defined in 3 places.">Step</a>())
<a id="L1629" name="L1629"></a>1629     <em class="brace">{</em>
<a id="L1630" name="L1630"></a>1630       <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1631" name="L1631"></a>1631     <em class="brace">}</em>
<a id="L1632" name="L1632"></a>1632 
<a id="L1633" name="L1633"></a>1633     <strong class="reserved">while</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/'))
<a id="L1634" name="L1634"></a>1634     <em class="brace">{</em>
<a id="L1635" name="L1635"></a>1635       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1636" name="L1636"></a>1636 
<a id="L1637" name="L1637"></a>1637       <strong class="reserved">if</strong> (!<a href="../D/8383.html" title="Multiple defined in 3 places.">Step</a>())
<a id="L1638" name="L1638"></a>1638       <em class="brace">{</em>
<a id="L1639" name="L1639"></a>1639         <em class="comment">// RelativeLocationPath can't end with a trailing '/'</em>
<a id="L1640" name="L1640"></a>1640         <em class="comment">// "Location step expected following '/' or '//'"</em>
<a id="L1641" name="L1641"></a>1641         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_LOC_STEP, <strong class="reserved">null</strong>);
<a id="L1642" name="L1642"></a>1642       <em class="brace">}</em>
<a id="L1643" name="L1643"></a>1643     <em class="brace">}</em>
<a id="L1644" name="L1644"></a>1644 
<a id="L1645" name="L1645"></a>1645     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1646" name="L1646"></a>1646   <em class="brace">}</em>
<a id="L1647" name="L1647"></a>1647 
<div class="comment">
    Step    ::=    Basis Predicate
    | AbbreviatedStep
    @returns false if step was empty (or only a '/'); true, otherwise
    @throws javax.xml.transform.TransformerException</div>
<a id="L1657" name="L1657"></a>1657   <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/7607.html" title="Multiple referred from 81 places.">Step</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1658" name="L1658"></a>1658   <em class="brace">{</em>
<a id="L1659" name="L1659"></a>1659     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1660" name="L1660"></a>1660 
<a id="L1661" name="L1661"></a>1661     <strong class="reserved">boolean</strong> doubleSlash = <a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/');
<a id="L1662" name="L1662"></a>1662 
<a id="L1663" name="L1663"></a>1663     <em class="comment">// At most a single '/' before each Step is consumed by caller; if the</em>
<a id="L1664" name="L1664"></a>1664     <em class="comment">// first thing is a '/', that means we had '//' and the Step must not</em>
<a id="L1665" name="L1665"></a>1665     <em class="comment">// be empty.</em>
<a id="L1666" name="L1666"></a>1666     <strong class="reserved">if</strong> (doubleSlash)
<a id="L1667" name="L1667"></a>1667     <em class="brace">{</em>
<a id="L1668" name="L1668"></a>1668       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1669" name="L1669"></a>1669 
<a id="L1670" name="L1670"></a>1670       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_DESCENDANTS_OR_SELF);
<a id="L1671" name="L1671"></a>1671 
<a id="L1672" name="L1672"></a>1672       <em class="comment">// Have to fix up for patterns such as '//@foo' or '//attribute::foo',</em>
<a id="L1673" name="L1673"></a>1673       <em class="comment">// which translate to 'descendant-or-self::node()/attribute::foo'.</em>
<a id="L1674" name="L1674"></a>1674       <em class="comment">// notice I leave the '/' on the queue, so the next will be processed</em>
<a id="L1675" name="L1675"></a>1675       <em class="comment">// by a regular step pattern.</em>
<a id="L1676" name="L1676"></a>1676 
<a id="L1677" name="L1677"></a>1677       <em class="comment">// Make room for telling how long the step is without the predicate</em>
<a id="L1678" name="L1678"></a>1678       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1679" name="L1679"></a>1679       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_NODE);
<a id="L1680" name="L1680"></a>1680       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1681" name="L1681"></a>1681 
<a id="L1682" name="L1682"></a>1682       <em class="comment">// Tell how long the step is without the predicate</em>
<a id="L1683" name="L1683"></a>1683       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH + 1,
<a id="L1684" name="L1684"></a>1684           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1685" name="L1685"></a>1685 
<a id="L1686" name="L1686"></a>1686       <em class="comment">// Tell how long the step is with the predicate</em>
<a id="L1687" name="L1687"></a>1687       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1688" name="L1688"></a>1688           m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1689" name="L1689"></a>1689 
<a id="L1690" name="L1690"></a>1690       opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1691" name="L1691"></a>1691     <em class="brace">}</em>
<a id="L1692" name="L1692"></a>1692 
<a id="L1693" name="L1693"></a>1693     <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>("."))
<a id="L1694" name="L1694"></a>1694     <em class="brace">{</em>
<a id="L1695" name="L1695"></a>1695       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1696" name="L1696"></a>1696 
<a id="L1697" name="L1697"></a>1697       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('['))
<a id="L1698" name="L1698"></a>1698       <em class="brace">{</em>
<a id="L1699" name="L1699"></a>1699         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_PREDICATE_ILLEGAL_SYNTAX, <strong class="reserved">null</strong>);  <em class="comment">//"'..[predicate]' or '.[predicate]' is illegal syntax.  Use 'self::node()[predicate]' instead.");</em>
<a id="L1700" name="L1700"></a>1700       <em class="brace">}</em>
<a id="L1701" name="L1701"></a>1701 
<a id="L1702" name="L1702"></a>1702       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(4, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_SELF);
<a id="L1703" name="L1703"></a>1703 
<a id="L1704" name="L1704"></a>1704       <em class="comment">// Tell how long the step is without the predicate</em>
<a id="L1705" name="L1705"></a>1705       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 2,4);
<a id="L1706" name="L1706"></a>1706       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 1, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_NODE);
<a id="L1707" name="L1707"></a>1707     <em class="brace">}</em>
<a id="L1708" name="L1708"></a>1708     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(".."))
<a id="L1709" name="L1709"></a>1709     <em class="brace">{</em>
<a id="L1710" name="L1710"></a>1710       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1711" name="L1711"></a>1711       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(4, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_PARENT);
<a id="L1712" name="L1712"></a>1712 
<a id="L1713" name="L1713"></a>1713       <em class="comment">// Tell how long the step is without the predicate</em>
<a id="L1714" name="L1714"></a>1714       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 2,4);
<a id="L1715" name="L1715"></a>1715       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 1, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_NODE);
<a id="L1716" name="L1716"></a>1716     <em class="brace">}</em>
<a id="L1717" name="L1717"></a>1717 
<a id="L1718" name="L1718"></a>1718     <em class="comment">// There is probably a better way to test for this</em>
<a id="L1719" name="L1719"></a>1719     <em class="comment">// transition... but it gets real hairy if you try</em>
<a id="L1720" name="L1720"></a>1720     <em class="comment">// to do it in basis().</em>
<a id="L1721" name="L1721"></a>1721     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('*') || <a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('@') || <a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('_')
<a id="L1722" name="L1722"></a>1722              || (m_token!= <strong class="reserved">null</strong> &amp;&amp; <a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25794.html" title="Multiple defined in 3 places.">isLetter</a>(m_token.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(0))))
<a id="L1723" name="L1723"></a>1723     <em class="brace">{</em>
<a id="L1724" name="L1724"></a>1724       <a href="../S/4999.html#L1757" title="Defined at 1757 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Basis</a>();
<a id="L1725" name="L1725"></a>1725 
<a id="L1726" name="L1726"></a>1726       <strong class="reserved">while</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('['))
<a id="L1727" name="L1727"></a>1727       <em class="brace">{</em>
<a id="L1728" name="L1728"></a>1728         <a href="../D/6788.html" title="Multiple defined in 4 places.">Predicate</a>();
<a id="L1729" name="L1729"></a>1729       <em class="brace">}</em>
<a id="L1730" name="L1730"></a>1730 
<a id="L1731" name="L1731"></a>1731       <em class="comment">// Tell how long the entire step is.</em>
<a id="L1732" name="L1732"></a>1732       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1733" name="L1733"></a>1733         m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1734" name="L1734"></a>1734     <em class="brace">}</em>
<a id="L1735" name="L1735"></a>1735     <strong class="reserved">else</strong>
<a id="L1736" name="L1736"></a>1736     <em class="brace">{</em>
<a id="L1737" name="L1737"></a>1737       <em class="comment">// No Step matched - that's an error if previous thing was a '//'</em>
<a id="L1738" name="L1738"></a>1738       <strong class="reserved">if</strong> (doubleSlash)
<a id="L1739" name="L1739"></a>1739       <em class="brace">{</em>
<a id="L1740" name="L1740"></a>1740         <em class="comment">// "Location step expected following '/' or '//'"</em>
<a id="L1741" name="L1741"></a>1741         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_LOC_STEP, <strong class="reserved">null</strong>);
<a id="L1742" name="L1742"></a>1742       <em class="brace">}</em>
<a id="L1743" name="L1743"></a>1743 
<a id="L1744" name="L1744"></a>1744       <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1745" name="L1745"></a>1745     <em class="brace">}</em>
<a id="L1746" name="L1746"></a>1746 
<a id="L1747" name="L1747"></a>1747     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1748" name="L1748"></a>1748   <em class="brace">}</em>
<a id="L1749" name="L1749"></a>1749 
<div class="comment">
    Basis    ::=    AxisName '::' NodeTest
    | AbbreviatedBasis
    @throws javax.xml.transform.TransformerException</div>
<a id="L1757" name="L1757"></a>1757   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/4999.html#L1724" title="Referred from 1724 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Basis</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1758" name="L1758"></a>1758   <em class="brace">{</em>
<a id="L1759" name="L1759"></a>1759 
<a id="L1760" name="L1760"></a>1760     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1761" name="L1761"></a>1761     <strong class="reserved">int</strong> axesType;
<a id="L1762" name="L1762"></a>1762 
<a id="L1763" name="L1763"></a>1763     <em class="comment">// The next blocks guarantee that a FROM_XXX will be added.</em>
<a id="L1764" name="L1764"></a>1764     <strong class="reserved">if</strong> (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>("::", 1))
<a id="L1765" name="L1765"></a>1765     <em class="brace">{</em>
<a id="L1766" name="L1766"></a>1766       axesType = <a href="../S/4999.html#L1804" title="Defined at 1804 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AxisName</a>();
<a id="L1767" name="L1767"></a>1767 
<a id="L1768" name="L1768"></a>1768       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1769" name="L1769"></a>1769       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1770" name="L1770"></a>1770     <em class="brace">}</em>
<a id="L1771" name="L1771"></a>1771     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('@'))
<a id="L1772" name="L1772"></a>1772     <em class="brace">{</em>
<a id="L1773" name="L1773"></a>1773       axesType = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_ATTRIBUTES;
<a id="L1774" name="L1774"></a>1774 
<a id="L1775" name="L1775"></a>1775       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, axesType);
<a id="L1776" name="L1776"></a>1776       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1777" name="L1777"></a>1777     <em class="brace">}</em>
<a id="L1778" name="L1778"></a>1778     <strong class="reserved">else</strong>
<a id="L1779" name="L1779"></a>1779     <em class="brace">{</em>
<a id="L1780" name="L1780"></a>1780       axesType = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_CHILDREN;
<a id="L1781" name="L1781"></a>1781 
<a id="L1782" name="L1782"></a>1782       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, axesType);
<a id="L1783" name="L1783"></a>1783     <em class="brace">}</em>
<a id="L1784" name="L1784"></a>1784 
<a id="L1785" name="L1785"></a>1785     <em class="comment">// Make room for telling how long the step is without the predicate</em>
<a id="L1786" name="L1786"></a>1786     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1787" name="L1787"></a>1787 
<a id="L1788" name="L1788"></a>1788     <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>(axesType);
<a id="L1789" name="L1789"></a>1789 
<a id="L1790" name="L1790"></a>1790     <em class="comment">// Tell how long the step is without the predicate</em>
<a id="L1791" name="L1791"></a>1791     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH + 1,
<a id="L1792" name="L1792"></a>1792       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1793" name="L1793"></a>1793    <em class="brace">}</em>
<a id="L1794" name="L1794"></a>1794 
<div class="comment">
    Basis    ::=    AxisName '::' NodeTest
    | AbbreviatedBasis
    @return FROM_XXX axes type, found in {@link com.sun.org.apache.xpath.internal.compiler.Keywords}.
    @throws javax.xml.transform.TransformerException</div>
<a id="L1804" name="L1804"></a>1804   <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../S/4999.html#L1766" title="Referred from 1766 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AxisName</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1805" name="L1805"></a>1805   <em class="brace">{</em>
<a id="L1806" name="L1806"></a>1806 
<a id="L1807" name="L1807"></a>1807     <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a> = <a href="../S/4993.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/compiler/Keywords.java.">Keywords</a>.<a href="../S/4993.html#L273" title="Defined at 273 in src/com/sun/org/apache/xpath/internal/compiler/Keywords.java.">getAxisName</a>(m_token);
<a id="L1808" name="L1808"></a>1808 
<a id="L1809" name="L1809"></a>1809     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>)
<a id="L1810" name="L1810"></a>1810     <em class="brace">{</em>
<a id="L1811" name="L1811"></a>1811       <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_ILLEGAL_AXIS_NAME,
<a id="L1812" name="L1812"></a>1812             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> m_token <em class="brace">}</em>);  <em class="comment">//"illegal axis name: "+m_token);</em>
<a id="L1813" name="L1813"></a>1813     <em class="brace">}</em>
<a id="L1814" name="L1814"></a>1814 
<a id="L1815" name="L1815"></a>1815     <strong class="reserved">int</strong> axesType = ((<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>) <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>).<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>();
<a id="L1816" name="L1816"></a>1816 
<a id="L1817" name="L1817"></a>1817     <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, axesType);
<a id="L1818" name="L1818"></a>1818 
<a id="L1819" name="L1819"></a>1819     <strong class="reserved">return</strong> axesType;
<a id="L1820" name="L1820"></a>1820   <em class="brace">}</em>
<a id="L1821" name="L1821"></a>1821 
<div class="comment">
    NodeTest    ::=    WildcardName
    | NodeType '(' ')'
    | 'processing-instruction' '(' Literal ')'
    @param axesType FROM_XXX axes type, found in {@link com.sun.org.apache.xpath.internal.compiler.Keywords}.
    @throws javax.xml.transform.TransformerException</div>
<a id="L1832" name="L1832"></a>1832   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/5569.html" title="Multiple referred from 108 places.">NodeTest</a>(<strong class="reserved">int</strong> axesType) <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1833" name="L1833"></a>1833   <em class="brace">{</em>
<a id="L1834" name="L1834"></a>1834 
<a id="L1835" name="L1835"></a>1835     <strong class="reserved">if</strong> (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>('(', 1))
<a id="L1836" name="L1836"></a>1836     <em class="brace">{</em>
<a id="L1837" name="L1837"></a>1837       <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> nodeTestOp = <a href="../S/4993.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/compiler/Keywords.java.">Keywords</a>.<a href="../D/20988.html" title="Multiple defined in 34 places.">getNodeType</a>(m_token);
<a id="L1838" name="L1838"></a>1838 
<a id="L1839" name="L1839"></a>1839       <strong class="reserved">if</strong> (<strong class="reserved">null</strong> == nodeTestOp)
<a id="L1840" name="L1840"></a>1840       <em class="brace">{</em>
<a id="L1841" name="L1841"></a>1841         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_UNKNOWN_NODETYPE,
<a id="L1842" name="L1842"></a>1842               <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> m_token <em class="brace">}</em>);  <em class="comment">//"Unknown nodetype: "+m_token);</em>
<a id="L1843" name="L1843"></a>1843       <em class="brace">}</em>
<a id="L1844" name="L1844"></a>1844       <strong class="reserved">else</strong>
<a id="L1845" name="L1845"></a>1845       <em class="brace">{</em>
<a id="L1846" name="L1846"></a>1846         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1847" name="L1847"></a>1847 
<a id="L1848" name="L1848"></a>1848         <strong class="reserved">int</strong> nt = ((<a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>) nodeTestOp).<a href="../D/24897.html" title="Multiple defined in 21 places.">intValue</a>();
<a id="L1849" name="L1849"></a>1849 
<a id="L1850" name="L1850"></a>1850         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), nt);
<a id="L1851" name="L1851"></a>1851         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1852" name="L1852"></a>1852 
<a id="L1853" name="L1853"></a>1853         <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>('(');
<a id="L1854" name="L1854"></a>1854 
<a id="L1855" name="L1855"></a>1855         <strong class="reserved">if</strong> (<a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_PI == nt)
<a id="L1856" name="L1856"></a>1856         <em class="brace">{</em>
<a id="L1857" name="L1857"></a>1857           <strong class="reserved">if</strong> (!<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(')'))
<a id="L1858" name="L1858"></a>1858           <em class="brace">{</em>
<a id="L1859" name="L1859"></a>1859             <a href="../S/4999.html#L2019" title="Defined at 2019 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Literal</a>();
<a id="L1860" name="L1860"></a>1860           <em class="brace">}</em>
<a id="L1861" name="L1861"></a>1861         <em class="brace">}</em>
<a id="L1862" name="L1862"></a>1862 
<a id="L1863" name="L1863"></a>1863         <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>(')');
<a id="L1864" name="L1864"></a>1864       <em class="brace">}</em>
<a id="L1865" name="L1865"></a>1865     <em class="brace">}</em>
<a id="L1866" name="L1866"></a>1866     <strong class="reserved">else</strong>
<a id="L1867" name="L1867"></a>1867     <em class="brace">{</em>
<a id="L1868" name="L1868"></a>1868 
<a id="L1869" name="L1869"></a>1869       <em class="comment">// Assume name of attribute or element.</em>
<a id="L1870" name="L1870"></a>1870       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODENAME);
<a id="L1871" name="L1871"></a>1871       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1872" name="L1872"></a>1872 
<a id="L1873" name="L1873"></a>1873       <strong class="reserved">if</strong> (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>(':', 1))
<a id="L1874" name="L1874"></a>1874       <em class="brace">{</em>
<a id="L1875" name="L1875"></a>1875         <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('*'))
<a id="L1876" name="L1876"></a>1876         <em class="brace">{</em>
<a id="L1877" name="L1877"></a>1877           m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ELEMWILDCARD);
<a id="L1878" name="L1878"></a>1878         <em class="brace">}</em>
<a id="L1879" name="L1879"></a>1879         <strong class="reserved">else</strong>
<a id="L1880" name="L1880"></a>1880         <em class="brace">{</em>
<a id="L1881" name="L1881"></a>1881           m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), m_queueMark - 1);
<a id="L1882" name="L1882"></a>1882 
<a id="L1883" name="L1883"></a>1883           <em class="comment">// Minimalist check for an NCName - just check first character</em>
<a id="L1884" name="L1884"></a>1884           <em class="comment">// to distinguish from other possible tokens</em>
<a id="L1885" name="L1885"></a>1885           <strong class="reserved">if</strong> (!<a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25794.html" title="Multiple defined in 3 places.">isLetter</a>(m_tokenChar) &amp;&amp; !<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('_'))
<a id="L1886" name="L1886"></a>1886           <em class="brace">{</em>
<a id="L1887" name="L1887"></a>1887             <em class="comment">// "Node test that matches either NCName:* or QName was expected."</em>
<a id="L1888" name="L1888"></a>1888             <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_NODE_TEST, <strong class="reserved">null</strong>);
<a id="L1889" name="L1889"></a>1889           <em class="brace">}</em>
<a id="L1890" name="L1890"></a>1890         <em class="brace">}</em>
<a id="L1891" name="L1891"></a>1891 
<a id="L1892" name="L1892"></a>1892         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1893" name="L1893"></a>1893         <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>(':');
<a id="L1894" name="L1894"></a>1894       <em class="brace">}</em>
<a id="L1895" name="L1895"></a>1895       <strong class="reserved">else</strong>
<a id="L1896" name="L1896"></a>1896       <em class="brace">{</em>
<a id="L1897" name="L1897"></a>1897         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.EMPTY);
<a id="L1898" name="L1898"></a>1898       <em class="brace">}</em>
<a id="L1899" name="L1899"></a>1899 
<a id="L1900" name="L1900"></a>1900       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1901" name="L1901"></a>1901 
<a id="L1902" name="L1902"></a>1902       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('*'))
<a id="L1903" name="L1903"></a>1903       <em class="brace">{</em>
<a id="L1904" name="L1904"></a>1904         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ELEMWILDCARD);
<a id="L1905" name="L1905"></a>1905       <em class="brace">}</em>
<a id="L1906" name="L1906"></a>1906       <strong class="reserved">else</strong>
<a id="L1907" name="L1907"></a>1907       <em class="brace">{</em>
<a id="L1908" name="L1908"></a>1908         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), m_queueMark - 1);
<a id="L1909" name="L1909"></a>1909 
<a id="L1910" name="L1910"></a>1910         <em class="comment">// Minimalist check for an NCName - just check first character</em>
<a id="L1911" name="L1911"></a>1911         <em class="comment">// to distinguish from other possible tokens</em>
<a id="L1912" name="L1912"></a>1912         <strong class="reserved">if</strong> (!<a href="../S/1732.html#L123" title="Defined at 123 in src/java/lang/Character.java.">Character</a>.<a href="../D/25794.html" title="Multiple defined in 3 places.">isLetter</a>(m_tokenChar) &amp;&amp; !<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('_'))
<a id="L1913" name="L1913"></a>1913         <em class="brace">{</em>
<a id="L1914" name="L1914"></a>1914           <em class="comment">// "Node test that matches either NCName:* or QName was expected."</em>
<a id="L1915" name="L1915"></a>1915           <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_NODE_TEST, <strong class="reserved">null</strong>);
<a id="L1916" name="L1916"></a>1916         <em class="brace">}</em>
<a id="L1917" name="L1917"></a>1917       <em class="brace">}</em>
<a id="L1918" name="L1918"></a>1918 
<a id="L1919" name="L1919"></a>1919       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1920" name="L1920"></a>1920 
<a id="L1921" name="L1921"></a>1921       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1922" name="L1922"></a>1922     <em class="brace">}</em>
<a id="L1923" name="L1923"></a>1923   <em class="brace">}</em>
<a id="L1924" name="L1924"></a>1924 
<div class="comment">
    Predicate ::= '[' PredicateExpr ']'
    @throws javax.xml.transform.TransformerException</div>
<a id="L1932" name="L1932"></a>1932   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/6185.html" title="Multiple referred from 71 places.">Predicate</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1933" name="L1933"></a>1933   <em class="brace">{</em>
<a id="L1934" name="L1934"></a>1934 
<a id="L1935" name="L1935"></a>1935     <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('['))
<a id="L1936" name="L1936"></a>1936     <em class="brace">{</em>
<a id="L1937" name="L1937"></a>1937       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1938" name="L1938"></a>1938       <a href="../S/4999.html#L1950" title="Defined at 1950 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">PredicateExpr</a>();
<a id="L1939" name="L1939"></a>1939       <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>(']');
<a id="L1940" name="L1940"></a>1940     <em class="brace">}</em>
<a id="L1941" name="L1941"></a>1941   <em class="brace">}</em>
<a id="L1942" name="L1942"></a>1942 
<div class="comment">
    PredicateExpr ::= Expr
    @throws javax.xml.transform.TransformerException</div>
<a id="L1950" name="L1950"></a>1950   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../S/4999.html#L1938" title="Referred from 1938 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">PredicateExpr</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1951" name="L1951"></a>1951   <em class="brace">{</em>
<a id="L1952" name="L1952"></a>1952 
<a id="L1953" name="L1953"></a>1953     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L1954" name="L1954"></a>1954 
<a id="L1955" name="L1955"></a>1955     <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_PREDICATE);
<a id="L1956" name="L1956"></a>1956     <a href="../S/4999.html#L790" title="Defined at 790 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">Expr</a>();
<a id="L1957" name="L1957"></a>1957 
<a id="L1958" name="L1958"></a>1958     <em class="comment">// Terminate for safety.</em>
<a id="L1959" name="L1959"></a>1959     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ENDOP);
<a id="L1960" name="L1960"></a>1960     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1961" name="L1961"></a>1961     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L1962" name="L1962"></a>1962       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L1963" name="L1963"></a>1963   <em class="brace">}</em>
<a id="L1964" name="L1964"></a>1964 
<div class="comment">
    QName ::=  (Prefix ':')? LocalPart
    Prefix ::=  NCName
    LocalPart ::=  NCName
    @throws javax.xml.transform.TransformerException</div>
<a id="L1972" name="L1972"></a>1972   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/6356.html" title="Multiple referred from 820 places.">QName</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L1973" name="L1973"></a>1973   <em class="brace">{</em>
<a id="L1974" name="L1974"></a>1974     <em class="comment">// Namespace</em>
<a id="L1975" name="L1975"></a>1975     <strong class="reserved">if</strong>(<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>(':', 1))
<a id="L1976" name="L1976"></a>1976     <em class="brace">{</em>
<a id="L1977" name="L1977"></a>1977       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), m_queueMark - 1);
<a id="L1978" name="L1978"></a>1978       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1979" name="L1979"></a>1979 
<a id="L1980" name="L1980"></a>1980       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1981" name="L1981"></a>1981       <a href="../D/13301.html" title="Multiple defined in 2 places.">consumeExpected</a>(':');
<a id="L1982" name="L1982"></a>1982     <em class="brace">}</em>
<a id="L1983" name="L1983"></a>1983     <strong class="reserved">else</strong>
<a id="L1984" name="L1984"></a>1984     <em class="brace">{</em>
<a id="L1985" name="L1985"></a>1985       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.EMPTY);
<a id="L1986" name="L1986"></a>1986       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1987" name="L1987"></a>1987     <em class="brace">}</em>
<a id="L1988" name="L1988"></a>1988 
<a id="L1989" name="L1989"></a>1989     <em class="comment">// Local name</em>
<a id="L1990" name="L1990"></a>1990     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), m_queueMark - 1);
<a id="L1991" name="L1991"></a>1991     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L1992" name="L1992"></a>1992 
<a id="L1993" name="L1993"></a>1993     <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L1994" name="L1994"></a>1994   <em class="brace">}</em>
<a id="L1995" name="L1995"></a>1995 
<div class="comment">
    NCName ::=  (Letter | '_') (NCNameChar)
    NCNameChar ::=  Letter | Digit | '.' | '-' | '_' | CombiningChar | Extender</div>
<a id="L2000" name="L2000"></a>2000   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> NCName()
<a id="L2001" name="L2001"></a>2001   <em class="brace">{</em>
<a id="L2002" name="L2002"></a>2002 
<a id="L2003" name="L2003"></a>2003     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), m_queueMark - 1);
<a id="L2004" name="L2004"></a>2004     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L2005" name="L2005"></a>2005 
<a id="L2006" name="L2006"></a>2006     <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2007" name="L2007"></a>2007   <em class="brace">}</em>
<a id="L2008" name="L2008"></a>2008 
<div class="comment">
    The value of the Literal is the sequence of characters inside
    the " or ' characters&gt;.
    Literal  ::=  '"' [^"]* '"'
    | "'" [^']* "'"
    @throws javax.xml.transform.TransformerException</div>
<a id="L2019" name="L2019"></a>2019   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/4660.html" title="Multiple referred from 5 places.">Literal</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L2020" name="L2020"></a>2020   <em class="brace">{</em>
<a id="L2021" name="L2021"></a>2021 
<a id="L2022" name="L2022"></a>2022     <strong class="reserved">int</strong> <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = m_token.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>() - 1;
<a id="L2023" name="L2023"></a>2023     <strong class="reserved">char</strong> c0 = m_tokenChar;
<a id="L2024" name="L2024"></a>2024     <strong class="reserved">char</strong> cX = m_token.<a href="../D/12321.html" title="Multiple defined in 24 places.">charAt</a>(<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>);
<a id="L2025" name="L2025"></a>2025 
<a id="L2026" name="L2026"></a>2026     <strong class="reserved">if</strong> (((c0 == '\"') &amp;&amp; (cX == '\"')) || ((c0 == '\'') &amp;&amp; (cX == '\'')))
<a id="L2027" name="L2027"></a>2027     <em class="brace">{</em>
<a id="L2028" name="L2028"></a>2028 
<a id="L2029" name="L2029"></a>2029       <em class="comment">// Mutate the token to remove the quotes and have the XString object</em>
<a id="L2030" name="L2030"></a>2030       <em class="comment">// already made.</em>
<a id="L2031" name="L2031"></a>2031       <strong class="reserved">int</strong> tokenQueuePos = m_queueMark - 1;
<a id="L2032" name="L2032"></a>2032 
<a id="L2033" name="L2033"></a>2033       m_ops.m_tokenQueue.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<strong class="reserved">null</strong>,tokenQueuePos);
<a id="L2034" name="L2034"></a>2034 
<a id="L2035" name="L2035"></a>2035       <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> obj = <strong class="reserved">new</strong> <a href="../S/4898.html#L40" title="Defined at 40 in src/com/sun/org/apache/xpath/internal/objects/XString.java.">XString</a>(m_token.<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(1, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>));
<a id="L2036" name="L2036"></a>2036 
<a id="L2037" name="L2037"></a>2037       m_ops.m_tokenQueue.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(obj,tokenQueuePos);
<a id="L2038" name="L2038"></a>2038 
<a id="L2039" name="L2039"></a>2039       <em class="comment">// lit = m_token.substring(1, last);</em>
<a id="L2040" name="L2040"></a>2040       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), tokenQueuePos);
<a id="L2041" name="L2041"></a>2041       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L2042" name="L2042"></a>2042 
<a id="L2043" name="L2043"></a>2043       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2044" name="L2044"></a>2044     <em class="brace">}</em>
<a id="L2045" name="L2045"></a>2045     <strong class="reserved">else</strong>
<a id="L2046" name="L2046"></a>2046     <em class="brace">{</em>
<a id="L2047" name="L2047"></a>2047       <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_PATTERN_LITERAL_NEEDS_BE_QUOTED,
<a id="L2048" name="L2048"></a>2048             <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> m_token <em class="brace">}</em>);  <em class="comment">//"Pattern literal ("+m_token+") needs to be quoted!");</em>
<a id="L2049" name="L2049"></a>2049     <em class="brace">}</em>
<a id="L2050" name="L2050"></a>2050   <em class="brace">}</em>
<a id="L2051" name="L2051"></a>2051 
<div class="comment">
    Number ::= [0-9]+('.'[0-9]+)? | '.'[0-9]+
    @throws javax.xml.transform.TransformerException</div>
<a id="L2059" name="L2059"></a>2059   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/5634.html" title="Multiple referred from 282 places.">Number</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L2060" name="L2060"></a>2060   <em class="brace">{</em>
<a id="L2061" name="L2061"></a>2061 
<a id="L2062" name="L2062"></a>2062     <strong class="reserved">if</strong> (<strong class="reserved">null</strong> != m_token)
<a id="L2063" name="L2063"></a>2063     <em class="brace">{</em>
<a id="L2064" name="L2064"></a>2064 
<a id="L2065" name="L2065"></a>2065       <em class="comment">// Mutate the token to remove the quotes and have the XNumber object</em>
<a id="L2066" name="L2066"></a>2066       <em class="comment">// already made.</em>
<a id="L2067" name="L2067"></a>2067       <strong class="reserved">double</strong> <a href="../D/28365.html" title="Multiple defined in 17 places.">num</a>;
<a id="L2068" name="L2068"></a>2068 
<a id="L2069" name="L2069"></a>2069       <strong class="reserved">try</strong>
<a id="L2070" name="L2070"></a>2070       <em class="brace">{</em>
<a id="L2071" name="L2071"></a>2071         <em class="comment">// XPath 1.0 does not support number in exp notation</em>
<a id="L2072" name="L2072"></a>2072         <strong class="reserved">if</strong> ((m_token.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('e') &gt; -1)||(m_token.<a href="../D/24468.html" title="Multiple defined in 74 places.">indexOf</a>('E') &gt; -1))
<a id="L2073" name="L2073"></a>2073                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1762.html#L38" title="Defined at 38 in src/java/lang/NumberFormatException.java.">NumberFormatException</a>();
<a id="L2074" name="L2074"></a>2074         <a href="../D/28365.html" title="Multiple defined in 17 places.">num</a> = <a href="../D/2585.html" title="Multiple defined in 10 places.">Double</a>.<a href="../D/36373.html" title="Multiple defined in 48 places.">valueOf</a>(m_token).<a href="../D/15134.html" title="Multiple defined in 16 places.">doubleValue</a>();
<a id="L2075" name="L2075"></a>2075       <em class="brace">}</em>
<a id="L2076" name="L2076"></a>2076       <strong class="reserved">catch</strong> (<a href="../S/1762.html#L38" title="Defined at 38 in src/java/lang/NumberFormatException.java.">NumberFormatException</a> nfe)
<a id="L2077" name="L2077"></a>2077       <em class="brace">{</em>
<a id="L2078" name="L2078"></a>2078         <a href="../D/28365.html" title="Multiple defined in 17 places.">num</a> = 0.0;  <em class="comment">// to shut up compiler.</em>
<a id="L2079" name="L2079"></a>2079 
<a id="L2080" name="L2080"></a>2080         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_COULDNOT_BE_FORMATTED_TO_NUMBER,
<a id="L2081" name="L2081"></a>2081               <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> m_token <em class="brace">}</em>);  <em class="comment">//m_token+" could not be formatted to a number!");</em>
<a id="L2082" name="L2082"></a>2082       <em class="brace">}</em>
<a id="L2083" name="L2083"></a>2083 
<a id="L2084" name="L2084"></a>2084       m_ops.m_tokenQueue.<a href="../D/32553.html" title="Multiple defined in 11 places.">setElementAt</a>(<strong class="reserved">new</strong> <a href="../S/4902.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/objects/XNumber.java.">XNumber</a>(<a href="../D/28365.html" title="Multiple defined in 17 places.">num</a>),m_queueMark - 1);
<a id="L2085" name="L2085"></a>2085       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), m_queueMark - 1);
<a id="L2086" name="L2086"></a>2086       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L2087" name="L2087"></a>2087 
<a id="L2088" name="L2088"></a>2088       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2089" name="L2089"></a>2089     <em class="brace">}</em>
<a id="L2090" name="L2090"></a>2090   <em class="brace">}</em>
<a id="L2091" name="L2091"></a>2091 
<a id="L2092" name="L2092"></a>2092   <em class="comment">// ============= PATTERN FUNCTIONS =================</em>
<a id="L2093" name="L2093"></a>2093 
<div class="comment">
    Pattern  ::=  LocationPathPattern
    | Pattern '|' LocationPathPattern
    @throws javax.xml.transform.TransformerException</div>
<a id="L2102" name="L2102"></a>2102   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/6083.html" title="Multiple referred from 137 places.">Pattern</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L2103" name="L2103"></a>2103   <em class="brace">{</em>
<a id="L2104" name="L2104"></a>2104 
<a id="L2105" name="L2105"></a>2105     <strong class="reserved">while</strong> (<strong class="reserved">true</strong>)
<a id="L2106" name="L2106"></a>2106     <em class="brace">{</em>
<a id="L2107" name="L2107"></a>2107       <a href="../D/5190.html" title="Multiple defined in 2 places.">LocationPathPattern</a>();
<a id="L2108" name="L2108"></a>2108 
<a id="L2109" name="L2109"></a>2109       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('|'))
<a id="L2110" name="L2110"></a>2110       <em class="brace">{</em>
<a id="L2111" name="L2111"></a>2111         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2112" name="L2112"></a>2112       <em class="brace">}</em>
<a id="L2113" name="L2113"></a>2113       <strong class="reserved">else</strong>
<a id="L2114" name="L2114"></a>2114       <em class="brace">{</em>
<a id="L2115" name="L2115"></a>2115         <strong class="reserved">break</strong>;
<a id="L2116" name="L2116"></a>2116       <em class="brace">}</em>
<a id="L2117" name="L2117"></a>2117     <em class="brace">}</em>
<a id="L2118" name="L2118"></a>2118   <em class="brace">}</em>
<a id="L2119" name="L2119"></a>2119 
<div class="comment">
    LocationPathPattern  ::=  '/' RelativePathPattern?
    | IdKeyPattern (('/' | '//') RelativePathPattern)?
    | '//'? RelativePathPattern
    @throws javax.xml.transform.TransformerException</div>
<a id="L2130" name="L2130"></a>2130   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/4721.html" title="Multiple referred from 22 places.">LocationPathPattern</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L2131" name="L2131"></a>2131   <em class="brace">{</em>
<a id="L2132" name="L2132"></a>2132 
<a id="L2133" name="L2133"></a>2133     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L2134" name="L2134"></a>2134 
<a id="L2135" name="L2135"></a>2135     <strong class="reserved">final</strong> <strong class="reserved">int</strong> RELATIVE_PATH_NOT_PERMITTED = 0;
<a id="L2136" name="L2136"></a>2136     <strong class="reserved">final</strong> <strong class="reserved">int</strong> RELATIVE_PATH_PERMITTED     = 1;
<a id="L2137" name="L2137"></a>2137     <strong class="reserved">final</strong> <strong class="reserved">int</strong> RELATIVE_PATH_REQUIRED      = 2;
<a id="L2138" name="L2138"></a>2138 
<a id="L2139" name="L2139"></a>2139     <strong class="reserved">int</strong> relativePathStatus = RELATIVE_PATH_NOT_PERMITTED;
<a id="L2140" name="L2140"></a>2140 
<a id="L2141" name="L2141"></a>2141     <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.OP_LOCATIONPATHPATTERN);
<a id="L2142" name="L2142"></a>2142 
<a id="L2143" name="L2143"></a>2143     <strong class="reserved">if</strong> (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>('(', 1)
<a id="L2144" name="L2144"></a>2144             &amp;&amp; (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(<a href="../S/4993.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/compiler/Keywords.java.">Keywords</a>.FUNC_ID_STRING)
<a id="L2145" name="L2145"></a>2145                 || <a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>(<a href="../S/4993.html#L31" title="Defined at 31 in src/com/sun/org/apache/xpath/internal/compiler/Keywords.java.">Keywords</a>.FUNC_KEY_STRING)))
<a id="L2146" name="L2146"></a>2146     <em class="brace">{</em>
<a id="L2147" name="L2147"></a>2147       <a href="../D/4021.html" title="Multiple defined in 2 places.">IdKeyPattern</a>();
<a id="L2148" name="L2148"></a>2148 
<a id="L2149" name="L2149"></a>2149       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/'))
<a id="L2150" name="L2150"></a>2150       <em class="brace">{</em>
<a id="L2151" name="L2151"></a>2151         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2152" name="L2152"></a>2152 
<a id="L2153" name="L2153"></a>2153         <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/'))
<a id="L2154" name="L2154"></a>2154         <em class="brace">{</em>
<a id="L2155" name="L2155"></a>2155           <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(4, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_ANY_ANCESTOR);
<a id="L2156" name="L2156"></a>2156 
<a id="L2157" name="L2157"></a>2157           <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2158" name="L2158"></a>2158         <em class="brace">}</em>
<a id="L2159" name="L2159"></a>2159         <strong class="reserved">else</strong>
<a id="L2160" name="L2160"></a>2160         <em class="brace">{</em>
<a id="L2161" name="L2161"></a>2161           <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(4, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_IMMEDIATE_ANCESTOR);
<a id="L2162" name="L2162"></a>2162         <em class="brace">}</em>
<a id="L2163" name="L2163"></a>2163 
<a id="L2164" name="L2164"></a>2164         <em class="comment">// Tell how long the step is without the predicate</em>
<a id="L2165" name="L2165"></a>2165         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 2, 4);
<a id="L2166" name="L2166"></a>2166         m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 1, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_FUNCTEST);
<a id="L2167" name="L2167"></a>2167 
<a id="L2168" name="L2168"></a>2168         relativePathStatus = RELATIVE_PATH_REQUIRED;
<a id="L2169" name="L2169"></a>2169       <em class="brace">}</em>
<a id="L2170" name="L2170"></a>2170     <em class="brace">}</em>
<a id="L2171" name="L2171"></a>2171     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/'))
<a id="L2172" name="L2172"></a>2172     <em class="brace">{</em>
<a id="L2173" name="L2173"></a>2173       <strong class="reserved">if</strong> (<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>('/', 1))
<a id="L2174" name="L2174"></a>2174       <em class="brace">{</em>
<a id="L2175" name="L2175"></a>2175         <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(4, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_ANY_ANCESTOR);
<a id="L2176" name="L2176"></a>2176 
<a id="L2177" name="L2177"></a>2177         <em class="comment">// Added this to fix bug reported by Myriam for match="//x/a"</em>
<a id="L2178" name="L2178"></a>2178         <em class="comment">// patterns.  If you don't do this, the 'x' step will think it's part</em>
<a id="L2179" name="L2179"></a>2179         <em class="comment">// of a '//' pattern, and so will cause 'a' to be matched when it has</em>
<a id="L2180" name="L2180"></a>2180         <em class="comment">// any ancestor that is 'x'.</em>
<a id="L2181" name="L2181"></a>2181         <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2182" name="L2182"></a>2182 
<a id="L2183" name="L2183"></a>2183         relativePathStatus = RELATIVE_PATH_REQUIRED;
<a id="L2184" name="L2184"></a>2184       <em class="brace">}</em>
<a id="L2185" name="L2185"></a>2185       <strong class="reserved">else</strong>
<a id="L2186" name="L2186"></a>2186       <em class="brace">{</em>
<a id="L2187" name="L2187"></a>2187         <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(4, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.FROM_ROOT);
<a id="L2188" name="L2188"></a>2188 
<a id="L2189" name="L2189"></a>2189         relativePathStatus = RELATIVE_PATH_PERMITTED;
<a id="L2190" name="L2190"></a>2190       <em class="brace">}</em>
<a id="L2191" name="L2191"></a>2191 
<a id="L2192" name="L2192"></a>2192 
<a id="L2193" name="L2193"></a>2193       <em class="comment">// Tell how long the step is without the predicate</em>
<a id="L2194" name="L2194"></a>2194       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 2, 4);
<a id="L2195" name="L2195"></a>2195       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - 1, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.NODETYPE_ROOT);
<a id="L2196" name="L2196"></a>2196 
<a id="L2197" name="L2197"></a>2197       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2198" name="L2198"></a>2198     <em class="brace">}</em>
<a id="L2199" name="L2199"></a>2199     <strong class="reserved">else</strong>
<a id="L2200" name="L2200"></a>2200     <em class="brace">{</em>
<a id="L2201" name="L2201"></a>2201       relativePathStatus = RELATIVE_PATH_REQUIRED;
<a id="L2202" name="L2202"></a>2202     <em class="brace">}</em>
<a id="L2203" name="L2203"></a>2203 
<a id="L2204" name="L2204"></a>2204     <strong class="reserved">if</strong> (relativePathStatus != RELATIVE_PATH_NOT_PERMITTED)
<a id="L2205" name="L2205"></a>2205     <em class="brace">{</em>
<a id="L2206" name="L2206"></a>2206       <strong class="reserved">if</strong> (!<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('|') &amp;&amp; (<strong class="reserved">null</strong> != m_token))
<a id="L2207" name="L2207"></a>2207       <em class="brace">{</em>
<a id="L2208" name="L2208"></a>2208         <a href="../D/7234.html" title="Multiple defined in 2 places.">RelativePathPattern</a>();
<a id="L2209" name="L2209"></a>2209       <em class="brace">}</em>
<a id="L2210" name="L2210"></a>2210       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (relativePathStatus == RELATIVE_PATH_REQUIRED)
<a id="L2211" name="L2211"></a>2211       <em class="brace">{</em>
<a id="L2212" name="L2212"></a>2212         <em class="comment">// "A relative path pattern was expected."</em>
<a id="L2213" name="L2213"></a>2213         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_REL_PATH_PATTERN, <strong class="reserved">null</strong>);
<a id="L2214" name="L2214"></a>2214       <em class="brace">}</em>
<a id="L2215" name="L2215"></a>2215     <em class="brace">}</em>
<a id="L2216" name="L2216"></a>2216 
<a id="L2217" name="L2217"></a>2217     <em class="comment">// Terminate for safety.</em>
<a id="L2218" name="L2218"></a>2218     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH), <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.ENDOP);
<a id="L2219" name="L2219"></a>2219     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L2220" name="L2220"></a>2220     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L2221" name="L2221"></a>2221       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L2222" name="L2222"></a>2222   <em class="brace">}</em>
<a id="L2223" name="L2223"></a>2223 
<div class="comment">
    IdKeyPattern  ::=  'id' '(' Literal ')'
    | 'key' '(' Literal ',' Literal ')'
    (Also handle doc())
    @throws javax.xml.transform.TransformerException</div>
<a id="L2233" name="L2233"></a>2233   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/3649.html" title="Multiple referred from 11 places.">IdKeyPattern</a>() <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L2234" name="L2234"></a>2234   <em class="brace">{</em>
<a id="L2235" name="L2235"></a>2235     <a href="../D/3457.html" title="Multiple defined in 2 places.">FunctionCall</a>();
<a id="L2236" name="L2236"></a>2236   <em class="brace">}</em>
<a id="L2237" name="L2237"></a>2237 
<div class="comment">
    RelativePathPattern  ::=  StepPattern
    | RelativePathPattern '/' StepPattern
    | RelativePathPattern '//' StepPattern
    @throws javax.xml.transform.TransformerException</div>
<a id="L2246" name="L2246"></a>2246   <strong class="reserved">protected</strong> <strong class="reserved">void</strong> <a href="../R/6594.html" title="Multiple referred from 23 places.">RelativePathPattern</a>()
<a id="L2247" name="L2247"></a>2247               <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L2248" name="L2248"></a>2248   <em class="brace">{</em>
<a id="L2249" name="L2249"></a>2249 
<a id="L2250" name="L2250"></a>2250     <em class="comment">// Caller will have consumed any '/' or '//' preceding the</em>
<a id="L2251" name="L2251"></a>2251     <em class="comment">// RelativePathPattern, so let StepPattern know it can't begin with a '/'</em>
<a id="L2252" name="L2252"></a>2252     <strong class="reserved">boolean</strong> trailingSlashConsumed = <a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a>(<strong class="reserved">false</strong>);
<a id="L2253" name="L2253"></a>2253 
<a id="L2254" name="L2254"></a>2254     <strong class="reserved">while</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/'))
<a id="L2255" name="L2255"></a>2255     <em class="brace">{</em>
<a id="L2256" name="L2256"></a>2256       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2257" name="L2257"></a>2257 
<a id="L2258" name="L2258"></a>2258       <em class="comment">// StepPattern() may consume first slash of pair in "a//b" while</em>
<a id="L2259" name="L2259"></a>2259       <em class="comment">// processing StepPattern "a".  On next iteration, let StepPattern know</em>
<a id="L2260" name="L2260"></a>2260       <em class="comment">// that happened, so it doesn't match ill-formed patterns like "a///b".</em>
<a id="L2261" name="L2261"></a>2261       trailingSlashConsumed = <a href="../D/8385.html" title="Multiple defined in 3 places.">StepPattern</a>(!trailingSlashConsumed);
<a id="L2262" name="L2262"></a>2262     <em class="brace">}</em>
<a id="L2263" name="L2263"></a>2263   <em class="brace">}</em>
<a id="L2264" name="L2264"></a>2264 
<div class="comment">
    StepPattern  ::=  AbbreviatedNodeTestStep
    @param isLeadingSlashPermitted a boolean indicating whether a slash can
           appear at the start of this step
    @return boolean indicating whether a slash following the step was consumed
    @throws javax.xml.transform.TransformerException</div>
<a id="L2276" name="L2276"></a>2276   <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../R/7609.html" title="Multiple referred from 82 places.">StepPattern</a>(<strong class="reserved">boolean</strong> isLeadingSlashPermitted)
<a id="L2277" name="L2277"></a>2277             <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L2278" name="L2278"></a>2278   <em class="brace">{</em>
<a id="L2279" name="L2279"></a>2279     <strong class="reserved">return</strong> <a href="../S/4999.html#L2293" title="Defined at 2293 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AbbreviatedNodeTestStep</a>(isLeadingSlashPermitted);
<a id="L2280" name="L2280"></a>2280   <em class="brace">}</em>
<a id="L2281" name="L2281"></a>2281 
<div class="comment">
    AbbreviatedNodeTestStep    ::=    '@'? NodeTest Predicate
    @param isLeadingSlashPermitted a boolean indicating whether a slash can
           appear at the start of this step
    @return boolean indicating whether a slash following the step was consumed
    @throws javax.xml.transform.TransformerException</div>
<a id="L2293" name="L2293"></a>2293   <strong class="reserved">protected</strong> <strong class="reserved">boolean</strong> <a href="../S/4999.html#L2279" title="Referred from 2279 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">AbbreviatedNodeTestStep</a>(<strong class="reserved">boolean</strong> isLeadingSlashPermitted)
<a id="L2294" name="L2294"></a>2294             <strong class="reserved">throws</strong> <a href="../D/26637.html" title="Multiple defined in 6 places.">javax</a>.xml.<a href="../D/35592.html" title="Multiple defined in 22 places.">transform</a>.<a href="../S/4051.html#L35" title="Defined at 35 in src/javax/xml/transform/TransformerException.java.">TransformerException</a>
<a id="L2295" name="L2295"></a>2295   <em class="brace">{</em>
<a id="L2296" name="L2296"></a>2296 
<a id="L2297" name="L2297"></a>2297     <strong class="reserved">int</strong> opPos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L2298" name="L2298"></a>2298     <strong class="reserved">int</strong> axesType;
<a id="L2299" name="L2299"></a>2299 
<a id="L2300" name="L2300"></a>2300     <em class="comment">// The next blocks guarantee that a MATCH_XXX will be added.</em>
<a id="L2301" name="L2301"></a>2301     <strong class="reserved">int</strong> matchTypePos = -1;
<a id="L2302" name="L2302"></a>2302 
<a id="L2303" name="L2303"></a>2303     <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('@'))
<a id="L2304" name="L2304"></a>2304     <em class="brace">{</em>
<a id="L2305" name="L2305"></a>2305       axesType = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_ATTRIBUTE;
<a id="L2306" name="L2306"></a>2306 
<a id="L2307" name="L2307"></a>2307       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, axesType);
<a id="L2308" name="L2308"></a>2308       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2309" name="L2309"></a>2309     <em class="brace">}</em>
<a id="L2310" name="L2310"></a>2310     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.<a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>("::", 1))
<a id="L2311" name="L2311"></a>2311     <em class="brace">{</em>
<a id="L2312" name="L2312"></a>2312       <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>("attribute"))
<a id="L2313" name="L2313"></a>2313       <em class="brace">{</em>
<a id="L2314" name="L2314"></a>2314         axesType = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_ATTRIBUTE;
<a id="L2315" name="L2315"></a>2315 
<a id="L2316" name="L2316"></a>2316         <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, axesType);
<a id="L2317" name="L2317"></a>2317       <em class="brace">}</em>
<a id="L2318" name="L2318"></a>2318       <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>("child"))
<a id="L2319" name="L2319"></a>2319       <em class="brace">{</em>
<a id="L2320" name="L2320"></a>2320         matchTypePos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L2321" name="L2321"></a>2321         axesType = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_IMMEDIATE_ANCESTOR;
<a id="L2322" name="L2322"></a>2322 
<a id="L2323" name="L2323"></a>2323         <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, axesType);
<a id="L2324" name="L2324"></a>2324       <em class="brace">}</em>
<a id="L2325" name="L2325"></a>2325       <strong class="reserved">else</strong>
<a id="L2326" name="L2326"></a>2326       <em class="brace">{</em>
<a id="L2327" name="L2327"></a>2327         axesType = -1;
<a id="L2328" name="L2328"></a>2328 
<a id="L2329" name="L2329"></a>2329         <strong class="reserved">this</strong>.<a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_AXES_NOT_ALLOWED,
<a id="L2330" name="L2330"></a>2330                    <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[]<em class="brace">{</em> <strong class="reserved">this</strong>.m_token <em class="brace">}</em>);
<a id="L2331" name="L2331"></a>2331       <em class="brace">}</em>
<a id="L2332" name="L2332"></a>2332 
<a id="L2333" name="L2333"></a>2333       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2334" name="L2334"></a>2334       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2335" name="L2335"></a>2335     <em class="brace">}</em>
<a id="L2336" name="L2336"></a>2336     <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/'))
<a id="L2337" name="L2337"></a>2337     <em class="brace">{</em>
<a id="L2338" name="L2338"></a>2338       <strong class="reserved">if</strong> (!isLeadingSlashPermitted)
<a id="L2339" name="L2339"></a>2339       <em class="brace">{</em>
<a id="L2340" name="L2340"></a>2340         <em class="comment">// "A step was expected in the pattern, but '/' was encountered."</em>
<a id="L2341" name="L2341"></a>2341         <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>(<a href="../S/4836.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/res/XPATHErrorResources.java.">XPATHErrorResources</a>.ER_EXPECTED_STEP_PATTERN, <strong class="reserved">null</strong>);
<a id="L2342" name="L2342"></a>2342       <em class="brace">}</em>
<a id="L2343" name="L2343"></a>2343       axesType = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_ANY_ANCESTOR;
<a id="L2344" name="L2344"></a>2344 
<a id="L2345" name="L2345"></a>2345       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, axesType);
<a id="L2346" name="L2346"></a>2346       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2347" name="L2347"></a>2347     <em class="brace">}</em>
<a id="L2348" name="L2348"></a>2348     <strong class="reserved">else</strong>
<a id="L2349" name="L2349"></a>2349     <em class="brace">{</em>
<a id="L2350" name="L2350"></a>2350       matchTypePos = m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH);
<a id="L2351" name="L2351"></a>2351       axesType = <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_IMMEDIATE_ANCESTOR;
<a id="L2352" name="L2352"></a>2352 
<a id="L2353" name="L2353"></a>2353       <a href="../S/4999.html#L770" title="Defined at 770 in src/com/sun/org/apache/xpath/internal/compiler/XPathParser.java.">appendOp</a>(2, axesType);
<a id="L2354" name="L2354"></a>2354     <em class="brace">}</em>
<a id="L2355" name="L2355"></a>2355 
<a id="L2356" name="L2356"></a>2356     <em class="comment">// Make room for telling how long the step is without the predicate</em>
<a id="L2357" name="L2357"></a>2357     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH, m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) + 1);
<a id="L2358" name="L2358"></a>2358 
<a id="L2359" name="L2359"></a>2359     <a href="../D/6106.html" title="Multiple defined in 4 places.">NodeTest</a>(axesType);
<a id="L2360" name="L2360"></a>2360 
<a id="L2361" name="L2361"></a>2361     <em class="comment">// Tell how long the step is without the predicate</em>
<a id="L2362" name="L2362"></a>2362     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH + 1,
<a id="L2363" name="L2363"></a>2363       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L2364" name="L2364"></a>2364 
<a id="L2365" name="L2365"></a>2365     <strong class="reserved">while</strong> (<a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('['))
<a id="L2366" name="L2366"></a>2366     <em class="brace">{</em>
<a id="L2367" name="L2367"></a>2367       <a href="../D/6788.html" title="Multiple defined in 4 places.">Predicate</a>();
<a id="L2368" name="L2368"></a>2368     <em class="brace">}</em>
<a id="L2369" name="L2369"></a>2369 
<a id="L2370" name="L2370"></a>2370     <strong class="reserved">boolean</strong> trailingSlashConsumed;
<a id="L2371" name="L2371"></a>2371 
<a id="L2372" name="L2372"></a>2372     <em class="comment">// For "a//b", where "a" is current step, we need to mark operation of</em>
<a id="L2373" name="L2373"></a>2373     <em class="comment">// current step as "MATCH_ANY_ANCESTOR".  Then we'll consume the first</em>
<a id="L2374" name="L2374"></a>2374     <em class="comment">// slash and subsequent step will be treated as a MATCH_IMMEDIATE_ANCESTOR</em>
<a id="L2375" name="L2375"></a>2375     <em class="comment">// (unless it too is followed by '//'.)</em>
<a id="L2376" name="L2376"></a>2376     <em class="comment">//</em>
<a id="L2377" name="L2377"></a>2377     <em class="comment">// %REVIEW%  Following is what happens today, but I'm not sure that's</em>
<a id="L2378" name="L2378"></a>2378     <em class="comment">// %REVIEW%  correct behaviour.  Perhaps no valid case could be constructed</em>
<a id="L2379" name="L2379"></a>2379     <em class="comment">// %REVIEW%  where it would matter?</em>
<a id="L2380" name="L2380"></a>2380     <em class="comment">//</em>
<a id="L2381" name="L2381"></a>2381     <em class="comment">// If current step is on the attribute axis (e.g., "@x//b"), we won't</em>
<a id="L2382" name="L2382"></a>2382     <em class="comment">// change the current step, and let following step be marked as</em>
<a id="L2383" name="L2383"></a>2383     <em class="comment">// MATCH_ANY_ANCESTOR on next call instead.</em>
<a id="L2384" name="L2384"></a>2384     <strong class="reserved">if</strong> ((matchTypePos &gt; -1) &amp;&amp; <a href="../D/35548.html" title="Multiple defined in 2 places.">tokenIs</a>('/') &amp;&amp; <a href="../D/27091.html" title="Multiple defined in 2 places.">lookahead</a>('/', 1))
<a id="L2385" name="L2385"></a>2385     <em class="brace">{</em>
<a id="L2386" name="L2386"></a>2386       m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(matchTypePos, <a href="../S/5001.html#L43" title="Defined at 43 in src/com/sun/org/apache/xpath/internal/compiler/OpCodes.java.">OpCodes</a>.MATCH_ANY_ANCESTOR);
<a id="L2387" name="L2387"></a>2387 
<a id="L2388" name="L2388"></a>2388       <a href="../D/28195.html" title="Multiple defined in 10 places.">nextToken</a>();
<a id="L2389" name="L2389"></a>2389 
<a id="L2390" name="L2390"></a>2390       trailingSlashConsumed = <strong class="reserved">true</strong>;
<a id="L2391" name="L2391"></a>2391     <em class="brace">}</em>
<a id="L2392" name="L2392"></a>2392     <strong class="reserved">else</strong>
<a id="L2393" name="L2393"></a>2393     <em class="brace">{</em>
<a id="L2394" name="L2394"></a>2394       trailingSlashConsumed = <strong class="reserved">false</strong>;
<a id="L2395" name="L2395"></a>2395     <em class="brace">}</em>
<a id="L2396" name="L2396"></a>2396 
<a id="L2397" name="L2397"></a>2397     <em class="comment">// Tell how long the entire step is.</em>
<a id="L2398" name="L2398"></a>2398     m_ops.<a href="../S/4996.html#L187" title="Defined at 187 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">setOp</a>(opPos + <a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH,
<a id="L2399" name="L2399"></a>2399       m_ops.<a href="../D/21202.html" title="Multiple defined in 3 places.">getOp</a>(<a href="../S/4996.html#L34" title="Defined at 34 in src/com/sun/org/apache/xpath/internal/compiler/OpMap.java.">OpMap</a>.MAPINDEX_LENGTH) - opPos);
<a id="L2400" name="L2400"></a>2400 
<a id="L2401" name="L2401"></a>2401     <strong class="reserved">return</strong> trailingSlashConsumed;
<a id="L2402" name="L2402"></a>2402   <em class="brace">}</em>
<a id="L2403" name="L2403"></a>2403 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L103">[^]</a><a href="#L2293">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>