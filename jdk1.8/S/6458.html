<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/com/sun/jmx/snmp/daemon/CommunicatorServer.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L261">[^]</a><a href="#L1370">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L261" title="Defined at 261.">createMainThread</a></li>
<li><a href="#L282" title="Defined at 282.">start</a></li>
<li><a href="#L328" title="Defined at 328.">start</a></li>
<li><a href="#L347" title="Defined at 347.">stop</a></li>
<li><a href="#L395" title="Defined at 395.">isActive</a></li>
<li><a href="#L434" title="Defined at 434.">waitState</a></li>
<li><a href="#L502" title="Defined at 502.">waitForStart</a></li>
<li><a href="#L599" title="Defined at 599.">getState</a></li>
<li><a href="#L612" title="Defined at 612.">getStateString</a></li>
<li><a href="#L622" title="Defined at 622.">getHost</a></li>
<li><a href="#L637" title="Defined at 637.">getPort</a></li>
<li><a href="#L653" title="Defined at 653.">setPort</a></li>
<li><a href="#L668" title="Defined at 668.">getProtocol</a></li>
<li><a href="#L679" title="Defined at 679.">getServedClientCount</a></li>
<li><a href="#L690" title="Defined at 690.">getActiveClientCount</a></li>
<li><a href="#L703" title="Defined at 703.">getMaxActiveClientCount</a></li>
<li><a href="#L716" title="Defined at 716.">setMaxActiveClientCount</a></li>
<li><a href="#L730" title="Defined at 730.">notifyClientHandlerCreated</a></li>
<li><a href="#L737" title="Defined at 737.">notifyClientHandlerDeleted</a></li>
<li><a href="#L746" title="Defined at 746.">getBindTries</a></li>
<li><a href="#L754" title="Defined at 754.">getBindSleepTime</a></li>
<li><a href="#L764" title="Defined at 764.">run</a></li>
<li><a href="#L888" title="Defined at 888.">doError</a></li>
<li><a href="#L912" title="Defined at 912.">doBind</a></li>
<li><a href="#L921" title="Defined at 921.">doReceive</a></li>
<li><a href="#L930" title="Defined at 930.">doProcess</a></li>
<li><a href="#L938" title="Defined at 938.">doUnbind</a></li>
<li><a href="#L947" title="Defined at 947.">getMBeanServer</a></li>
<li><a href="#L969" title="Defined at 969.">setMBeanServer</a></li>
<li><a href="#L1000" title="Defined at 1000.">getObjectName</a></li>
<li><a href="#L1007" title="Defined at 1007.">changeState</a></li>
<li><a href="#L1022" title="Defined at 1022.">makeDebugTag</a></li>
<li><a href="#L1029" title="Defined at 1029.">makeThreadName</a></li>
<li><a href="#L1045" title="Defined at 1045.">waitIfTooManyClients</a></li>
<li><a href="#L1059" title="Defined at 1059.">waitClientTermination</a></li>
<li><a href="#L1103" title="Defined at 1103.">terminateAllClient</a></li>
<li><a href="#L1148" title="Defined at 1148.">readObject</a></li>
<li><a href="#L1194" title="Defined at 1194.">addNotificationListener</a></li>
<li><a href="#L1218" title="Defined at 1218.">removeNotificationListener</a></li>
<li><a href="#L1237" title="Defined at 1237.">getNotificationInfo</a></li>
<li><a href="#L1257" title="Defined at 1257.">sendStateChangeNotification</a></li>
<li><a href="#L1288" title="Defined at 1288.">getStringForState</a></li>
<li><a href="#L1317" title="Defined at 1317.">preRegister</a></li>
<li><a href="#L1339" title="Defined at 1339.">postRegister</a></li>
<li><a href="#L1355" title="Defined at 1355.">preDeregister</a></li>
<li><a href="#L1370" title="Defined at 1370.">postDeregister</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1999, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 
<a id="L27" name="L27"></a>  27 <strong class="reserved">package</strong> com.sun.jmx.snmp.daemon;
<a id="L28" name="L28"></a>  28 
<a id="L29" name="L29"></a>  29 
<a id="L30" name="L30"></a>  30 
<a id="L31" name="L31"></a>  31 <em class="comment">// java import</em>
<a id="L32" name="L32"></a>  32 <em class="comment">//</em>
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> java.io.ObjectInputStream;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> java.io.IOException;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> java.net.InetAddress;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> java.util.logging.Level;
<a id="L37" name="L37"></a>  37 <strong class="reserved">import</strong> java.util.Vector;
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> java.util.NoSuchElementException;
<a id="L39" name="L39"></a>  39 
<a id="L40" name="L40"></a>  40 <em class="comment">// jmx import</em>
<a id="L41" name="L41"></a>  41 <em class="comment">//</em>
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> javax.management.MBeanServer;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> javax.management.MBeanRegistration;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> javax.management.ObjectName;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> javax.management.NotificationListener;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> javax.management.NotificationFilter;
<a id="L47" name="L47"></a>  47 <strong class="reserved">import</strong> javax.management.NotificationBroadcaster;
<a id="L48" name="L48"></a>  48 <strong class="reserved">import</strong> javax.management.NotificationBroadcasterSupport;
<a id="L49" name="L49"></a>  49 <strong class="reserved">import</strong> javax.management.MBeanNotificationInfo;
<a id="L50" name="L50"></a>  50 <strong class="reserved">import</strong> javax.management.AttributeChangeNotification;
<a id="L51" name="L51"></a>  51 <strong class="reserved">import</strong> javax.management.ListenerNotFoundException;
<a id="L52" name="L52"></a>  52 
<a id="L53" name="L53"></a>  53 <strong class="reserved">import</strong> static com.sun.jmx.defaults.JmxProperties.SNMP_ADAPTOR_LOGGER;
<a id="L54" name="L54"></a>  54 
<a id="L55" name="L55"></a>  55 <em class="comment">// JSR 160 import</em>
<a id="L56" name="L56"></a>  56 <em class="comment">//</em>
<a id="L57" name="L57"></a>  57 <em class="comment">// XXX Revisit:</em>
<a id="L58" name="L58"></a>  58 <em class="comment">//   used to import com.sun.jmx.snmp.MBeanServerForwarder</em>
<a id="L59" name="L59"></a>  59 <em class="comment">// Now using JSR 160 instead. =&gt; this is an additional</em>
<a id="L60" name="L60"></a>  60 <em class="comment">// dependency to JSR 160.</em>
<a id="L61" name="L61"></a>  61 <em class="comment">//</em>
<a id="L62" name="L62"></a>  62 <strong class="reserved">import</strong> javax.management.remote.MBeanServerForwarder;
<a id="L63" name="L63"></a>  63 
<div class="comment">
  Defines generic behavior for the server part of a connector or an adaptor.
  Most connectors or adaptors extend <code>CommunicatorServer</code>
  and inherit this behavior. Connectors or adaptors that do not fit into
  this model do not extend <code>CommunicatorServer</code>.
  <p>
  A <code>CommunicatorServer</code> is an active object, it listens for
  client requests  and processes them in its own thread. When necessary, a
  <code>CommunicatorServer</code> creates other threads to process multiple
  requests concurrently.
  </p><p>
  A <code>CommunicatorServer</code> object can be stopped by calling the
  <code>stop</code> method. When it is stopped, the
  <code>CommunicatorServer</code> no longer listens to client requests and
  no longer holds any thread or communication resources.
  It can be started again by calling the <code>start</code> method.
  </p><p>
  A <code>CommunicatorServer</code> has a <code>State</code> attribute
  which reflects its  activity.
  </p><p>
  </p><table>
  <tbody><tr><th>CommunicatorServer</th>      <th>State</th></tr>
  <tr><td><code>stopped</code></td>    <td><code>OFFLINE</code></td></tr>
  <tr><td><code>starting</code></td>    <td><code>STARTING</code></td></tr>
  <tr><td><code>running</code></td>     <td><code>ONLINE</code></td></tr>
  <tr><td><code>stopping</code></td>     <td><code>STOPPING</code></td></tr>
  </tbody></table>
  <p>
  The <code>STARTING</code> state marks the transition
  from <code>OFFLINE</code> to <code>ONLINE</code>.
  </p><p>
  The <code>STOPPING</code> state marks the transition from
  <code>ONLINE</code> to <code>OFFLINE</code>. This occurs when the
  <code>CommunicatorServer</code> is finishing or interrupting active
  requests.
  </p><p>
  When a <code>CommunicatorServer</code> is unregistered from the MBeanServer,
  it is stopped automatically.
  </p><p>
  When the value of the <code>State</code> attribute changes the
  <code>CommunicatorServer</code> sends a
  <tt>{@link javax.management.AttributeChangeNotification}</tt> to the
  registered listeners, if any.
  </p><p><b>This API is a Sun Microsystems internal API  and is subject
  to change without notice.</b></p></div>
<a id="L111" name="L111"></a> 111 
<a id="L112" name="L112"></a> 112 <strong class="reserved">public</strong> <strong class="reserved">abstract</strong> <strong class="reserved">class</strong> <a href="../R/1540.html" title="Multiple referred from 4 places.">CommunicatorServer</a>
<a id="L113" name="L113"></a> 113     <strong class="reserved">implements</strong> <a href="../S/1758.html#L56" title="Defined at 56 in src/java/lang/Runnable.java.">Runnable</a>, <a href="../S/3438.html#L38" title="Defined at 38 in src/javax/management/MBeanRegistration.java.">MBeanRegistration</a>, <a href="../S/3441.html#L73" title="Defined at 73 in src/javax/management/NotificationBroadcaster.java.">NotificationBroadcaster</a>,
<a id="L114" name="L114"></a> 114                <a href="../S/6452.html#L76" title="Defined at 76 in src/com/sun/jmx/snmp/daemon/CommunicatorServerMBean.java.">CommunicatorServerMBean</a> <em class="brace">{</em>
<a id="L115" name="L115"></a> 115 
<a id="L116" name="L116"></a> 116     <em class="comment">//</em>
<a id="L117" name="L117"></a> 117     <em class="comment">// States of a CommunicatorServer</em>
<a id="L118" name="L118"></a> 118     <em class="comment">//</em>
<a id="L119" name="L119"></a> 119 
<div class="comment">
      Represents an <code>ONLINE</code> state.</div>
<a id="L123" name="L123"></a> 123     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> ONLINE = 0 ;
<a id="L124" name="L124"></a> 124 
<div class="comment">
      Represents an <code>OFFLINE</code> state.</div>
<a id="L128" name="L128"></a> 128     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> OFFLINE = 1 ;
<a id="L129" name="L129"></a> 129 
<div class="comment">
      Represents a <code>STOPPING</code> state.</div>
<a id="L133" name="L133"></a> 133     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> STOPPING = 2 ;
<a id="L134" name="L134"></a> 134 
<div class="comment">
      Represents a <code>STARTING</code> state.</div>
<a id="L138" name="L138"></a> 138     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> STARTING = 3 ;
<a id="L139" name="L139"></a> 139 
<a id="L140" name="L140"></a> 140     <em class="comment">//</em>
<a id="L141" name="L141"></a> 141     <em class="comment">// Types of connectors.</em>
<a id="L142" name="L142"></a> 142     <em class="comment">//</em>
<a id="L143" name="L143"></a> 143 
<div class="comment">
      Indicates that it is an RMI connector type.</div>
<a id="L147" name="L147"></a> 147     <em class="comment">//public static final int RMI_TYPE = 1 ;</em>
<a id="L148" name="L148"></a> 148 
<div class="comment">
      Indicates that it is an HTTP connector type.</div>
<a id="L152" name="L152"></a> 152     <em class="comment">//public static final int HTTP_TYPE = 2 ;</em>
<a id="L153" name="L153"></a> 153 
<div class="comment">
      Indicates that it is an HTML connector type.</div>
<a id="L157" name="L157"></a> 157     <em class="comment">//public static final int HTML_TYPE = 3 ;</em>
<a id="L158" name="L158"></a> 158 
<div class="comment">
      Indicates that it is an SNMP connector type.</div>
<a id="L162" name="L162"></a> 162     <strong class="reserved">public</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> SNMP_TYPE = 4 ;
<a id="L163" name="L163"></a> 163 
<div class="comment">
      Indicates that it is an HTTPS connector type.</div>
<a id="L167" name="L167"></a> 167     <em class="comment">//public static final int HTTPS_TYPE = 5 ;</em>
<a id="L168" name="L168"></a> 168 
<a id="L169" name="L169"></a> 169     <em class="comment">//</em>
<a id="L170" name="L170"></a> 170     <em class="comment">// Package variables</em>
<a id="L171" name="L171"></a> 171     <em class="comment">//</em>
<a id="L172" name="L172"></a> 172 
<div class="comment">
      The state of the connector server.</div>
<a id="L176" name="L176"></a> 176      <strong class="reserved">transient</strong> <strong class="reserved">volatile</strong> <strong class="reserved">int</strong> <a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> = OFFLINE ;
<a id="L177" name="L177"></a> 177 
<div class="comment">
      The object name of the connector server.
      @serial</div>
<a id="L182" name="L182"></a> 182     <a href="../S/3486.html#L223" title="Defined at 223 in src/javax/management/ObjectName.java.">ObjectName</a> objectName ;
<a id="L183" name="L183"></a> 183 
<a id="L184" name="L184"></a> 184     <a href="../S/3578.html#L260" title="Defined at 260 in src/javax/management/MBeanServer.java.">MBeanServer</a> topMBS;
<a id="L185" name="L185"></a> 185     <a href="../S/3578.html#L260" title="Defined at 260 in src/javax/management/MBeanServer.java.">MBeanServer</a> bottomMBS;
<a id="L186" name="L186"></a> 186 
<div class="comment">
</div>
<a id="L189" name="L189"></a> 189     <strong class="reserved">transient</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> dbgTag = <strong class="reserved">null</strong> ;
<a id="L190" name="L190"></a> 190 
<div class="comment">
      The maximum number of clients that the CommunicatorServer can
      process concurrently.
      @serial</div>
<a id="L196" name="L196"></a> 196     <strong class="reserved">int</strong> maxActiveClientCount = 1 ;
<a id="L197" name="L197"></a> 197 
<div class="comment">
</div>
<a id="L200" name="L200"></a> 200     <strong class="reserved">transient</strong> <strong class="reserved">int</strong> servedClientCount = 0 ;
<a id="L201" name="L201"></a> 201 
<div class="comment">
      The host name used by this CommunicatorServer.
      @serial</div>
<a id="L206" name="L206"></a> 206     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> host = <strong class="reserved">null</strong> ;
<a id="L207" name="L207"></a> 207 
<div class="comment">
      The port number used by this CommunicatorServer.
      @serial</div>
<a id="L212" name="L212"></a> 212     <strong class="reserved">int</strong> port = -1 ;
<a id="L213" name="L213"></a> 213 
<a id="L214" name="L214"></a> 214 
<a id="L215" name="L215"></a> 215     <em class="comment">//</em>
<a id="L216" name="L216"></a> 216     <em class="comment">// Private fields</em>
<a id="L217" name="L217"></a> 217     <em class="comment">//</em>
<a id="L218" name="L218"></a> 218 
<div class="comment">
 This object controls access to the "state" and "interrupted" variables.
       If held at the same time as the lock on "this", the "this" lock must
       be taken first.  </div>
<a id="L222" name="L222"></a> 222     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> stateLock = <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>();
<a id="L223" name="L223"></a> 223 
<a id="L224" name="L224"></a> 224     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;<a href="../S/6454.html#L50" title="Defined at 50 in src/com/sun/jmx/snmp/daemon/ClientHandler.java.">ClientHandler</a>&gt;
<a id="L225" name="L225"></a> 225             clientHandlerVector = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;&gt;() ;
<a id="L226" name="L226"></a> 226 
<a id="L227" name="L227"></a> 227     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> mainThread = <strong class="reserved">null</strong> ;
<a id="L228" name="L228"></a> 228 
<a id="L229" name="L229"></a> 229     <strong class="reserved">private</strong> <strong class="reserved">volatile</strong> <strong class="reserved">boolean</strong> stopRequested = <strong class="reserved">false</strong> ;
<a id="L230" name="L230"></a> 230     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a> = <strong class="reserved">false</strong>;
<a id="L231" name="L231"></a> 231     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> startException = <strong class="reserved">null</strong>;
<a id="L232" name="L232"></a> 232 
<a id="L233" name="L233"></a> 233     <em class="comment">// Notifs count, broadcaster and info</em>
<a id="L234" name="L234"></a> 234     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <strong class="reserved">long</strong> notifCount = 0;
<a id="L235" name="L235"></a> 235     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/3524.html#L62" title="Defined at 62 in src/javax/management/NotificationBroadcasterSupport.java.">NotificationBroadcasterSupport</a> notifBroadcaster =
<a id="L236" name="L236"></a> 236         <strong class="reserved">new</strong> <a href="../S/3524.html#L62" title="Defined at 62 in src/javax/management/NotificationBroadcasterSupport.java.">NotificationBroadcasterSupport</a>();
<a id="L237" name="L237"></a> 237     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/3444.html#L61" title="Defined at 61 in src/javax/management/MBeanNotificationInfo.java.">MBeanNotificationInfo</a>[] notifInfos = <strong class="reserved">null</strong>;
<a id="L238" name="L238"></a> 238 
<a id="L239" name="L239"></a> 239 
<div class="comment">
      Instantiates a <code>CommunicatorServer</code>.
      @param connectorType Indicates the connector type. Possible values are:
      SNMP_TYPE.
      @exception <code>java.lang.IllegalArgumentException</code>
                 This connector type is not correct.</div>
<a id="L249" name="L249"></a> 249     <strong class="reserved">public</strong> CommunicatorServer(<strong class="reserved">int</strong> connectorType)
<a id="L250" name="L250"></a> 250         <strong class="reserved">throws</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> <em class="brace">{</em>
<a id="L251" name="L251"></a> 251         <strong class="reserved">switch</strong> (connectorType) <em class="brace">{</em>
<a id="L252" name="L252"></a> 252         <strong class="reserved">case</strong> SNMP_TYPE :
<a id="L253" name="L253"></a> 253             <em class="comment">//No op. int Type deciding debugging removed.</em>
<a id="L254" name="L254"></a> 254             <strong class="reserved">break</strong>;
<a id="L255" name="L255"></a> 255         <strong class="reserved">default</strong>:
<a id="L256" name="L256"></a> 256             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("Invalid connector Type") ;
<a id="L257" name="L257"></a> 257         <em class="brace">}</em>
<a id="L258" name="L258"></a> 258         dbgTag = <a href="../D/27250.html" title="Multiple defined in 4 places.">makeDebugTag</a>() ;
<a id="L259" name="L259"></a> 259     <em class="brace">}</em>
<a id="L260" name="L260"></a> 260 
<a id="L261" name="L261"></a> 261     <strong class="reserved">protected</strong> <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> <a href="../R/12549.html" title="Multiple referred from 2 places.">createMainThread</a>() <em class="brace">{</em>
<a id="L262" name="L262"></a> 262         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a> (<strong class="reserved">this</strong>, <a href="../S/6458.html#L1029" title="Defined at 1029 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">makeThreadName</a>());
<a id="L263" name="L263"></a> 263     <em class="brace">}</em>
<a id="L264" name="L264"></a> 264 
<div class="comment">
      Starts this <code>CommunicatorServer</code>.
      <p>
      Has no effect if this <code>CommunicatorServer</code> is
      <code>ONLINE</code> or <code>STOPPING</code>.
      @param timeout Time in ms to wait for the connector to start.
             If <code>timeout</code> is positive, wait for at most
             the specified time. An infinite timeout can be specified
             by passing a <code>timeout</code> value equals
             <code>Long.MAX_VALUE</code>. In that case the method
             will wait until the connector starts or fails to start.
             If timeout is negative or zero, returns as soon as possible
             without waiting.
      @exception CommunicationException if the connectors fails to start.
      @exception InterruptedException if the thread is interrupted or the
                 timeout expires.</p></div>
<a id="L282" name="L282"></a> 282     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28780.html" title="Multiple referred from 2027 places.">start</a>(<strong class="reserved">long</strong> timeout)
<a id="L283" name="L283"></a> 283         <strong class="reserved">throws</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>, <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> <em class="brace">{</em>
<a id="L284" name="L284"></a> 284         <strong class="reserved">boolean</strong> <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>;
<a id="L285" name="L285"></a> 285 
<a id="L286" name="L286"></a> 286         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L287" name="L287"></a> 287             <strong class="reserved">if</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == STOPPING) <em class="brace">{</em>
<a id="L288" name="L288"></a> 288                 <em class="comment">// Fix for bug 4352451:</em>
<a id="L289" name="L289"></a> 289                 <em class="comment">//     "java.net.BindException: Address in use".</em>
<a id="L290" name="L290"></a> 290                 <a href="../D/36795.html" title="Multiple defined in 2 places.">waitState</a>(OFFLINE, 60000);
<a id="L291" name="L291"></a> 291             <em class="brace">}</em>
<a id="L292" name="L292"></a> 292             <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a> = (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == OFFLINE);
<a id="L293" name="L293"></a> 293             <strong class="reserved">if</strong> (<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>) <em class="brace">{</em>
<a id="L294" name="L294"></a> 294                 <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(STARTING);
<a id="L295" name="L295"></a> 295                 stopRequested = <strong class="reserved">false</strong>;
<a id="L296" name="L296"></a> 296                 <a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a> = <strong class="reserved">false</strong>;
<a id="L297" name="L297"></a> 297                 startException = <strong class="reserved">null</strong>;
<a id="L298" name="L298"></a> 298             <em class="brace">}</em>
<a id="L299" name="L299"></a> 299         <em class="brace">}</em>
<a id="L300" name="L300"></a> 300 
<a id="L301" name="L301"></a> 301         <strong class="reserved">if</strong> (!<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>) <em class="brace">{</em>
<a id="L302" name="L302"></a> 302             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L303" name="L303"></a> 303                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L304" name="L304"></a> 304                     "start","Connector is not OFFLINE");
<a id="L305" name="L305"></a> 305             <em class="brace">}</em>
<a id="L306" name="L306"></a> 306             <strong class="reserved">return</strong>;
<a id="L307" name="L307"></a> 307         <em class="brace">}</em>
<a id="L308" name="L308"></a> 308 
<a id="L309" name="L309"></a> 309         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L310" name="L310"></a> 310             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L311" name="L311"></a> 311                 "start","--&gt; Start connector ");
<a id="L312" name="L312"></a> 312         <em class="brace">}</em>
<a id="L313" name="L313"></a> 313 
<a id="L314" name="L314"></a> 314         mainThread = <a href="../D/14029.html" title="Multiple defined in 2 places.">createMainThread</a>();
<a id="L315" name="L315"></a> 315 
<a id="L316" name="L316"></a> 316         mainThread.<a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>() ;
<a id="L317" name="L317"></a> 317 
<a id="L318" name="L318"></a> 318         <strong class="reserved">if</strong> (timeout &gt; 0) <a href="../S/6458.html#L502" title="Defined at 502 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">waitForStart</a>(timeout);
<a id="L319" name="L319"></a> 319     <em class="brace">}</em>
<a id="L320" name="L320"></a> 320 
<div class="comment">
      Starts this <code>CommunicatorServer</code>.
      <p>
      Has no effect if this <code>CommunicatorServer</code> is
      <code>ONLINE</code> or <code>STOPPING</code>.</p></div>
<a id="L327" name="L327"></a> 327     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L328" name="L328"></a> 328     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28780.html" title="Multiple referred from 2027 places.">start</a>() <em class="brace">{</em>
<a id="L329" name="L329"></a> 329         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L330" name="L330"></a> 330             <a href="../D/34747.html" title="Multiple defined in 52 places.">start</a>(0);
<a id="L331" name="L331"></a> 331         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L332" name="L332"></a> 332             <em class="comment">// cannot happen because of `0'</em>
<a id="L333" name="L333"></a> 333             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L334" name="L334"></a> 334                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L335" name="L335"></a> 335                     "start","interrupted", <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L336" name="L336"></a> 336             <em class="brace">}</em>
<a id="L337" name="L337"></a> 337         <em class="brace">}</em>
<a id="L338" name="L338"></a> 338     <em class="brace">}</em>
<a id="L339" name="L339"></a> 339 
<div class="comment">
      Stops this <code>CommunicatorServer</code>.
      <p>
      Has no effect if this <code>CommunicatorServer</code> is
      <code>OFFLINE</code> or  <code>STOPPING</code>.</p></div>
<a id="L346" name="L346"></a> 346     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L347" name="L347"></a> 347     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/28900.html" title="Multiple referred from 176 places.">stop</a>() <em class="brace">{</em>
<a id="L348" name="L348"></a> 348         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L349" name="L349"></a> 349             <strong class="reserved">if</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == OFFLINE || <a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == STOPPING) <em class="brace">{</em>
<a id="L350" name="L350"></a> 350                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L351" name="L351"></a> 351                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L352" name="L352"></a> 352                         "stop","Connector is not ONLINE");
<a id="L353" name="L353"></a> 353                 <em class="brace">}</em>
<a id="L354" name="L354"></a> 354                 <strong class="reserved">return</strong>;
<a id="L355" name="L355"></a> 355             <em class="brace">}</em>
<a id="L356" name="L356"></a> 356             <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(STOPPING);
<a id="L357" name="L357"></a> 357             <em class="comment">//</em>
<a id="L358" name="L358"></a> 358             <em class="comment">// Stop the connector thread</em>
<a id="L359" name="L359"></a> 359             <em class="comment">//</em>
<a id="L360" name="L360"></a> 360             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L361" name="L361"></a> 361                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L362" name="L362"></a> 362                     "stop","Interrupt main thread");
<a id="L363" name="L363"></a> 363             <em class="brace">}</em>
<a id="L364" name="L364"></a> 364             stopRequested = <strong class="reserved">true</strong> ;
<a id="L365" name="L365"></a> 365             <strong class="reserved">if</strong> (!<a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a>) <em class="brace">{</em>
<a id="L366" name="L366"></a> 366                 <a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a> = <strong class="reserved">true</strong>;
<a id="L367" name="L367"></a> 367                 mainThread.<a href="../D/24969.html" title="Multiple defined in 3 places.">interrupt</a>();
<a id="L368" name="L368"></a> 368             <em class="brace">}</em>
<a id="L369" name="L369"></a> 369         <em class="brace">}</em>
<a id="L370" name="L370"></a> 370 
<a id="L371" name="L371"></a> 371         <em class="comment">//</em>
<a id="L372" name="L372"></a> 372         <em class="comment">// Call terminate on each active client handler</em>
<a id="L373" name="L373"></a> 373         <em class="comment">//</em>
<a id="L374" name="L374"></a> 374         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L375" name="L375"></a> 375             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L376" name="L376"></a> 376                 "stop","terminateAllClient");
<a id="L377" name="L377"></a> 377         <em class="brace">}</em>
<a id="L378" name="L378"></a> 378         <a href="../S/6458.html#L1103" title="Defined at 1103 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">terminateAllClient</a>() ;
<a id="L379" name="L379"></a> 379 
<a id="L380" name="L380"></a> 380         <em class="comment">// ----------------------</em>
<a id="L381" name="L381"></a> 381         <em class="comment">// changeState</em>
<a id="L382" name="L382"></a> 382         <em class="comment">// ----------------------</em>
<a id="L383" name="L383"></a> 383         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L384" name="L384"></a> 384             <strong class="reserved">if</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == STARTING)
<a id="L385" name="L385"></a> 385                 <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(OFFLINE);
<a id="L386" name="L386"></a> 386         <em class="brace">}</em>
<a id="L387" name="L387"></a> 387     <em class="brace">}</em>
<a id="L388" name="L388"></a> 388 
<div class="comment">
      Tests whether the <code>CommunicatorServer</code> is active.
      @return True if connector is <code>ONLINE</code>; false otherwise.</div>
<a id="L394" name="L394"></a> 394     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L395" name="L395"></a> 395     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21137.html" title="Multiple referred from 67 places.">isActive</a>() <em class="brace">{</em>
<a id="L396" name="L396"></a> 396         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L397" name="L397"></a> 397             <strong class="reserved">return</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == ONLINE);
<a id="L398" name="L398"></a> 398         <em class="brace">}</em>
<a id="L399" name="L399"></a> 399     <em class="brace">}</em>
<a id="L400" name="L400"></a> 400 
<div class="comment">
      <p>Waits until either the State attribute of this MBean equals the
      specified <var>wantedState</var> parameter,
      or the specified  <var>timeOut</var> has elapsed.
      The method <code>waitState</code> returns with a boolean value
      indicating whether the specified <var>wantedState</var> parameter
      equals the value of this MBean's State attribute at the time the method
      terminates.</p>
      <p>Two special cases for the <var>timeOut</var> parameter value are:</p>
      <ul><li> if <var>timeOut</var> is negative then <code>waitState</code>
          returns immediately (i.e. does not wait at all),</li>
      <li> if <var>timeOut</var> equals zero then <code>waitState</code>
          waits untill the value of this MBean's State attribute
          is the same as the <var>wantedState</var> parameter (i.e. will wait
          indefinitely if this condition is never met).</li></ul>
      @param wantedState The value of this MBean's State attribute to wait
             for. <var>wantedState</var> can be one of:
      <ul><li><code>CommunicatorServer.OFFLINE</code>,</li><li><code>CommunicatorServer.ONLINE</code>,</li><li><code>CommunicatorServer.STARTING</code>,</li><li><code>CommunicatorServer.STOPPING</code>.</li>
      </ul>
      @param timeOut The maximum time to wait for, in milliseconds,
             if positive.
      Infinite time out if 0, or no waiting at all if negative.
      @return true if the value of this MBean's State attribute is the
           same as the <var>wantedState</var> parameter; false otherwise.</div>
<a id="L433" name="L433"></a> 433     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L434" name="L434"></a> 434     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../S/6458.html#L290" title="Referred from 290 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">waitState</a>(<strong class="reserved">int</strong> wantedState, <strong class="reserved">long</strong> timeOut) <em class="brace">{</em>
<a id="L435" name="L435"></a> 435         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L436" name="L436"></a> 436             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L437" name="L437"></a> 437                 "waitState", wantedState + "(0on,1off,2st) TO=" + timeOut +
<a id="L438" name="L438"></a> 438                   " ; current state = " + <a href="../D/22728.html" title="Multiple defined in 3 places.">getStateString</a>());
<a id="L439" name="L439"></a> 439         <em class="brace">}</em>
<a id="L440" name="L440"></a> 440 
<a id="L441" name="L441"></a> 441         <strong class="reserved">long</strong> endTime = 0;
<a id="L442" name="L442"></a> 442         <strong class="reserved">if</strong> (timeOut &gt; 0)
<a id="L443" name="L443"></a> 443             endTime = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() + timeOut;
<a id="L444" name="L444"></a> 444 
<a id="L445" name="L445"></a> 445         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L446" name="L446"></a> 446             <strong class="reserved">while</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> != wantedState) <em class="brace">{</em>
<a id="L447" name="L447"></a> 447                 <strong class="reserved">if</strong> (timeOut &lt; 0) <em class="brace">{</em>
<a id="L448" name="L448"></a> 448                     <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L449" name="L449"></a> 449                         SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L450" name="L450"></a> 450                             "waitState", "timeOut &lt; 0, return without wait");
<a id="L451" name="L451"></a> 451                     <em class="brace">}</em>
<a id="L452" name="L452"></a> 452                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L453" name="L453"></a> 453                 <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L454" name="L454"></a> 454                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L455" name="L455"></a> 455                         <strong class="reserved">if</strong> (timeOut &gt; 0) <em class="brace">{</em>
<a id="L456" name="L456"></a> 456                             <strong class="reserved">long</strong> toWait = endTime - <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>();
<a id="L457" name="L457"></a> 457                             <strong class="reserved">if</strong> (toWait &lt;= 0) <em class="brace">{</em>
<a id="L458" name="L458"></a> 458                                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L459" name="L459"></a> 459                                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L460" name="L460"></a> 460                                         "waitState", "timed out");
<a id="L461" name="L461"></a> 461                                 <em class="brace">}</em>
<a id="L462" name="L462"></a> 462                                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L463" name="L463"></a> 463                             <em class="brace">}</em>
<a id="L464" name="L464"></a> 464                             stateLock.<a href="../D/36778.html" title="Multiple defined in 3 places.">wait</a>(toWait);
<a id="L465" name="L465"></a> 465                         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>  <em class="comment">// timeOut == 0</em>
<a id="L466" name="L466"></a> 466                             stateLock.<a href="../D/36778.html" title="Multiple defined in 3 places.">wait</a>();
<a id="L467" name="L467"></a> 467                         <em class="brace">}</em>
<a id="L468" name="L468"></a> 468                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> e) <em class="brace">{</em>
<a id="L469" name="L469"></a> 469                         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L470" name="L470"></a> 470                             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L471" name="L471"></a> 471                                 "waitState", "wait interrupted");
<a id="L472" name="L472"></a> 472                         <em class="brace">}</em>
<a id="L473" name="L473"></a> 473                         <strong class="reserved">return</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == wantedState);
<a id="L474" name="L474"></a> 474                     <em class="brace">}</em>
<a id="L475" name="L475"></a> 475                 <em class="brace">}</em>
<a id="L476" name="L476"></a> 476             <em class="brace">}</em>
<a id="L477" name="L477"></a> 477             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L478" name="L478"></a> 478                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L479" name="L479"></a> 479                     "waitState","returning in desired state");
<a id="L480" name="L480"></a> 480             <em class="brace">}</em>
<a id="L481" name="L481"></a> 481             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L482" name="L482"></a> 482         <em class="brace">}</em>
<a id="L483" name="L483"></a> 483     <em class="brace">}</em>
<a id="L484" name="L484"></a> 484 
<div class="comment">
      <p>Waits until the communicator is started or timeout expires.
      @param timeout Time in ms to wait for the connector to start.
             If <code>timeout</code> is positive, wait for at most
             the specified time. An infinite timeout can be specified
             by passing a <code>timeout</code> value equals
             <code>Long.MAX_VALUE</code>. In that case the method
             will wait until the connector starts or fails to start.
             If timeout is negative or zero, returns as soon as possible
             without waiting.
      @exception CommunicationException if the connectors fails to start.
      @exception InterruptedException if the thread is interrupted or the
                 timeout expires.</p></div>
<a id="L502" name="L502"></a> 502     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6458.html#L318" title="Referred from 318 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">waitForStart</a>(<strong class="reserved">long</strong> timeout)
<a id="L503" name="L503"></a> 503         <strong class="reserved">throws</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>, <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> <em class="brace">{</em>
<a id="L504" name="L504"></a> 504         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L505" name="L505"></a> 505             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L506" name="L506"></a> 506                 "waitForStart", "Timeout=" + timeout +
<a id="L507" name="L507"></a> 507                  " ; current state = " + <a href="../D/22728.html" title="Multiple defined in 3 places.">getStateString</a>());
<a id="L508" name="L508"></a> 508         <em class="brace">}</em>
<a id="L509" name="L509"></a> 509 
<a id="L510" name="L510"></a> 510         <strong class="reserved">final</strong> <strong class="reserved">long</strong> startTime = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>();
<a id="L511" name="L511"></a> 511 
<a id="L512" name="L512"></a> 512         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L513" name="L513"></a> 513             <strong class="reserved">while</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == STARTING) <em class="brace">{</em>
<a id="L514" name="L514"></a> 514                 <em class="comment">// Time elapsed since startTime...</em>
<a id="L515" name="L515"></a> 515                 <em class="comment">//</em>
<a id="L516" name="L516"></a> 516                 <strong class="reserved">final</strong> <strong class="reserved">long</strong> elapsed = <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>() - startTime;
<a id="L517" name="L517"></a> 517 
<a id="L518" name="L518"></a> 518                 <em class="comment">// wait for timeout - elapsed.</em>
<a id="L519" name="L519"></a> 519                 <em class="comment">// A timeout of Long.MAX_VALUE is equivalent to something</em>
<a id="L520" name="L520"></a> 520                 <em class="comment">// like 292271023 years - which is pretty close to</em>
<a id="L521" name="L521"></a> 521                 <em class="comment">// forever as far as we are concerned ;-)</em>
<a id="L522" name="L522"></a> 522                 <em class="comment">//</em>
<a id="L523" name="L523"></a> 523                 <strong class="reserved">final</strong> <strong class="reserved">long</strong> remainingTime = timeout-elapsed;
<a id="L524" name="L524"></a> 524 
<a id="L525" name="L525"></a> 525                 <em class="comment">// If remainingTime is negative, the timeout has elapsed.</em>
<a id="L526" name="L526"></a> 526                 <em class="comment">//</em>
<a id="L527" name="L527"></a> 527                 <strong class="reserved">if</strong> (remainingTime &lt; 0) <em class="brace">{</em>
<a id="L528" name="L528"></a> 528                     <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L529" name="L529"></a> 529                         SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L530" name="L530"></a> 530                             "waitForStart", "timeout &lt; 0, return without wait");
<a id="L531" name="L531"></a> 531                     <em class="brace">}</em>
<a id="L532" name="L532"></a> 532                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a>("Timeout expired");
<a id="L533" name="L533"></a> 533                 <em class="brace">}</em>
<a id="L534" name="L534"></a> 534 
<a id="L535" name="L535"></a> 535                 <em class="comment">// We're going to wait until someone notifies on the</em>
<a id="L536" name="L536"></a> 536                 <em class="comment">// the stateLock object, or until the timeout expires,</em>
<a id="L537" name="L537"></a> 537                 <em class="comment">// or until the thread is interrupted.</em>
<a id="L538" name="L538"></a> 538                 <em class="comment">//</em>
<a id="L539" name="L539"></a> 539                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L540" name="L540"></a> 540                     stateLock.<a href="../D/36778.html" title="Multiple defined in 3 places.">wait</a>(remainingTime);
<a id="L541" name="L541"></a> 541                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> e) <em class="brace">{</em>
<a id="L542" name="L542"></a> 542                     <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L543" name="L543"></a> 543                         SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L544" name="L544"></a> 544                             "waitForStart", "wait interrupted");
<a id="L545" name="L545"></a> 545                     <em class="brace">}</em>
<a id="L546" name="L546"></a> 546 
<a id="L547" name="L547"></a> 547                     <em class="comment">// If we are now ONLINE, then no need to rethrow the</em>
<a id="L548" name="L548"></a> 548                     <em class="comment">// exception... we're simply going to exit the while</em>
<a id="L549" name="L549"></a> 549                     <em class="comment">// loop. Otherwise, throw the InterruptedException.</em>
<a id="L550" name="L550"></a> 550                     <em class="comment">//</em>
<a id="L551" name="L551"></a> 551                     <strong class="reserved">if</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> != ONLINE) <strong class="reserved">throw</strong> e;
<a id="L552" name="L552"></a> 552                 <em class="brace">}</em>
<a id="L553" name="L553"></a> 553             <em class="brace">}</em>
<a id="L554" name="L554"></a> 554 
<a id="L555" name="L555"></a> 555             <em class="comment">// We're no longer in STARTING state</em>
<a id="L556" name="L556"></a> 556             <em class="comment">//</em>
<a id="L557" name="L557"></a> 557             <strong class="reserved">if</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == ONLINE) <em class="brace">{</em>
<a id="L558" name="L558"></a> 558                 <em class="comment">// OK, we're started, everything went fine, just return</em>
<a id="L559" name="L559"></a> 559                 <em class="comment">//</em>
<a id="L560" name="L560"></a> 560                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L561" name="L561"></a> 561                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L562" name="L562"></a> 562                         "waitForStart", "started");
<a id="L563" name="L563"></a> 563                 <em class="brace">}</em>
<a id="L564" name="L564"></a> 564                 <strong class="reserved">return</strong>;
<a id="L565" name="L565"></a> 565             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (startException <strong class="reserved">instanceof</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>) <em class="brace">{</em>
<a id="L566" name="L566"></a> 566                 <em class="comment">// There was some exception during the starting phase.</em>
<a id="L567" name="L567"></a> 567                 <em class="comment">// Cast and throw...</em>
<a id="L568" name="L568"></a> 568                 <em class="comment">//</em>
<a id="L569" name="L569"></a> 569                 <strong class="reserved">throw</strong> (<a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>)startException;
<a id="L570" name="L570"></a> 570             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (startException <strong class="reserved">instanceof</strong> <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a>) <em class="brace">{</em>
<a id="L571" name="L571"></a> 571                 <em class="comment">// There was some exception during the starting phase.</em>
<a id="L572" name="L572"></a> 572                 <em class="comment">// Cast and throw...</em>
<a id="L573" name="L573"></a> 573                 <em class="comment">//</em>
<a id="L574" name="L574"></a> 574                 <strong class="reserved">throw</strong> (<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a>)startException;
<a id="L575" name="L575"></a> 575             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (startException != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L576" name="L576"></a> 576                 <em class="comment">// There was some exception during the starting phase.</em>
<a id="L577" name="L577"></a> 577                 <em class="comment">// Wrap and throw...</em>
<a id="L578" name="L578"></a> 578                 <em class="comment">//</em>
<a id="L579" name="L579"></a> 579                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>(startException,
<a id="L580" name="L580"></a> 580                                                  "Failed to start: "+
<a id="L581" name="L581"></a> 581                                                  startException);
<a id="L582" name="L582"></a> 582             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L583" name="L583"></a> 583                 <em class="comment">// We're not ONLINE, and there's no exception...</em>
<a id="L584" name="L584"></a> 584                 <em class="comment">// Something went wrong but we don't know what...</em>
<a id="L585" name="L585"></a> 585                 <em class="comment">//</em>
<a id="L586" name="L586"></a> 586                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>("Failed to start: state is "+
<a id="L587" name="L587"></a> 587                                                  <a href="../S/6458.html#L1288" title="Defined at 1288 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">getStringForState</a>(<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a>));
<a id="L588" name="L588"></a> 588             <em class="brace">}</em>
<a id="L589" name="L589"></a> 589         <em class="brace">}</em>
<a id="L590" name="L590"></a> 590     <em class="brace">}</em>
<a id="L591" name="L591"></a> 591 
<div class="comment">
      Gets the state of this <code>CommunicatorServer</code> as an integer.
      @return <code>ONLINE</code>, <code>OFFLINE</code>,
              <code>STARTING</code> or <code>STOPPING</code>.</div>
<a id="L598" name="L598"></a> 598     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L599" name="L599"></a> 599     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/19176.html" title="Multiple referred from 92 places.">getState</a>() <em class="brace">{</em>
<a id="L600" name="L600"></a> 600         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L601" name="L601"></a> 601             <strong class="reserved">return</strong> <a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> ;
<a id="L602" name="L602"></a> 602         <em class="brace">}</em>
<a id="L603" name="L603"></a> 603     <em class="brace">}</em>
<a id="L604" name="L604"></a> 604 
<div class="comment">
      Gets the state of this <code>CommunicatorServer</code> as a string.
      @return One of the strings "ONLINE", "OFFLINE", "STARTING" or
              "STOPPING".</div>
<a id="L611" name="L611"></a> 611     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L612" name="L612"></a> 612     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/19180.html" title="Multiple referred from 5 places.">getStateString</a>() <em class="brace">{</em>
<a id="L613" name="L613"></a> 613         <strong class="reserved">return</strong> <a href="../S/6458.html#L1288" title="Defined at 1288 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">getStringForState</a>(<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a>) ;
<a id="L614" name="L614"></a> 614     <em class="brace">}</em>
<a id="L615" name="L615"></a> 615 
<div class="comment">
      Gets the host name used by this <code>CommunicatorServer</code>.
      @return The host name used by this <code>CommunicatorServer</code>.</div>
<a id="L621" name="L621"></a> 621     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L622" name="L622"></a> 622     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/16910.html" title="Multiple referred from 54 places.">getHost</a>() <em class="brace">{</em>
<a id="L623" name="L623"></a> 623         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L624" name="L624"></a> 624             host = <a href="../S/826.html#L189" title="Defined at 189 in src/java/net/InetAddress.java.">InetAddress</a>.<a href="../S/826.html#L1470" title="Defined at 1470 in src/java/net/InetAddress.java.">getLocalHost</a>().<a href="../D/19494.html" title="Multiple defined in 9 places.">getHostName</a>();
<a id="L625" name="L625"></a> 625         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L626" name="L626"></a> 626             host = "Unknown host";
<a id="L627" name="L627"></a> 627         <em class="brace">}</em>
<a id="L628" name="L628"></a> 628         <strong class="reserved">return</strong> host ;
<a id="L629" name="L629"></a> 629     <em class="brace">}</em>
<a id="L630" name="L630"></a> 630 
<div class="comment">
      Gets the port number used by this <code>CommunicatorServer</code>.
      @return The port number used by this <code>CommunicatorServer</code>.</div>
<a id="L636" name="L636"></a> 636     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L637" name="L637"></a> 637     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/18374.html" title="Multiple referred from 119 places.">getPort</a>() <em class="brace">{</em>
<a id="L638" name="L638"></a> 638         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L639" name="L639"></a> 639             <strong class="reserved">return</strong> port ;
<a id="L640" name="L640"></a> 640         <em class="brace">}</em>
<a id="L641" name="L641"></a> 641     <em class="brace">}</em>
<a id="L642" name="L642"></a> 642 
<div class="comment">
      Sets the port number used by this <code>CommunicatorServer</code>.
      @param port The port number used by this
                  <code>CommunicatorServer</code>.
      @exception java.lang.IllegalStateException This method has been invoked
      while the communicator was ONLINE or STARTING.</div>
<a id="L652" name="L652"></a> 652     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L653" name="L653"></a> 653     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/27939.html" title="Multiple referred from 14 places.">setPort</a>(<strong class="reserved">int</strong> port) <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a> <em class="brace">{</em>
<a id="L654" name="L654"></a> 654         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L655" name="L655"></a> 655             <strong class="reserved">if</strong> ((<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == ONLINE) || (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == STARTING))
<a id="L656" name="L656"></a> 656                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a>("Stop server before " +
<a id="L657" name="L657"></a> 657                                                 "carrying out this operation");
<a id="L658" name="L658"></a> 658             <strong class="reserved">this</strong>.port = port;
<a id="L659" name="L659"></a> 659             dbgTag = <a href="../D/27250.html" title="Multiple defined in 4 places.">makeDebugTag</a>();
<a id="L660" name="L660"></a> 660         <em class="brace">}</em>
<a id="L661" name="L661"></a> 661     <em class="brace">}</em>
<a id="L662" name="L662"></a> 662 
<div class="comment">
      Gets the protocol being used by this <code>CommunicatorServer</code>.
      @return The protocol as a string.</div>
<a id="L667" name="L667"></a> 667     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L668" name="L668"></a> 668     <strong class="reserved">public</strong> <strong class="reserved">abstract</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/18529.html" title="Multiple referred from 40 places.">getProtocol</a>();
<a id="L669" name="L669"></a> 669 
<div class="comment">
      Gets the number of clients that have been processed by this
      <code>CommunicatorServer</code>  since its creation.
      @return The number of clients handled by this
              <code>CommunicatorServer</code>
              since its creation. This counter is not reset by the
              <code>stop</code> method.</div>
<a id="L679" name="L679"></a> 679     <strong class="reserved">int</strong> <a href="../S/6449.html#L511" title="Referred from 511 in src/com/sun/jmx/snmp/daemon/SnmpAdaptorServer.java.">getServedClientCount</a>() <em class="brace">{</em>
<a id="L680" name="L680"></a> 680         <strong class="reserved">return</strong> servedClientCount ;
<a id="L681" name="L681"></a> 681     <em class="brace">}</em>
<a id="L682" name="L682"></a> 682 
<div class="comment">
      Gets the number of clients currently being processed by this
      <code>CommunicatorServer</code>.
      @return The number of clients currently being processed by this
              <code>CommunicatorServer</code>.</div>
<a id="L690" name="L690"></a> 690     <strong class="reserved">int</strong> <a href="../R/14958.html" title="Multiple referred from 2 places.">getActiveClientCount</a>() <em class="brace">{</em>
<a id="L691" name="L691"></a> 691         <strong class="reserved">int</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = clientHandlerVector.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() ;
<a id="L692" name="L692"></a> 692         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> ;
<a id="L693" name="L693"></a> 693     <em class="brace">}</em>
<a id="L694" name="L694"></a> 694 
<div class="comment">
      Gets the maximum number of clients that this
      <code>CommunicatorServer</code> can  process concurrently.
      @return The maximum number of clients that this
              <code>CommunicatorServer</code> can
              process concurrently.</div>
<a id="L703" name="L703"></a> 703     <strong class="reserved">int</strong> <a href="../S/6449.html#L535" title="Referred from 535 in src/com/sun/jmx/snmp/daemon/SnmpAdaptorServer.java.">getMaxActiveClientCount</a>() <em class="brace">{</em>
<a id="L704" name="L704"></a> 704         <strong class="reserved">return</strong> maxActiveClientCount ;
<a id="L705" name="L705"></a> 705     <em class="brace">}</em>
<a id="L706" name="L706"></a> 706 
<div class="comment">
      Sets the maximum number of clients this
      <code>CommunicatorServer</code> can process concurrently.
      @param c The number of clients.
      @exception java.lang.IllegalStateException This method has been invoked
      while the communicator was ONLINE or STARTING.</div>
<a id="L716" name="L716"></a> 716     <strong class="reserved">void</strong> <a href="../S/6449.html#L550" title="Referred from 550 in src/com/sun/jmx/snmp/daemon/SnmpAdaptorServer.java.">setMaxActiveClientCount</a>(<strong class="reserved">int</strong> <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>)
<a id="L717" name="L717"></a> 717         <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a> <em class="brace">{</em>
<a id="L718" name="L718"></a> 718         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L719" name="L719"></a> 719             <strong class="reserved">if</strong> ((<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == ONLINE) || (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == STARTING)) <em class="brace">{</em>
<a id="L720" name="L720"></a> 720                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a>(
<a id="L721" name="L721"></a> 721                           "Stop server before carrying out this operation");
<a id="L722" name="L722"></a> 722             <em class="brace">}</em>
<a id="L723" name="L723"></a> 723             maxActiveClientCount = <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> ;
<a id="L724" name="L724"></a> 724         <em class="brace">}</em>
<a id="L725" name="L725"></a> 725     <em class="brace">}</em>
<a id="L726" name="L726"></a> 726 
<div class="comment">
      For SNMP Runtime internal use only.</div>
<a id="L730" name="L730"></a> 730     <strong class="reserved">void</strong> <a href="../S/6454.html#L100" title="Referred from 100 in src/com/sun/jmx/snmp/daemon/ClientHandler.java.">notifyClientHandlerCreated</a>(<a href="../S/6454.html#L50" title="Defined at 50 in src/com/sun/jmx/snmp/daemon/ClientHandler.java.">ClientHandler</a> h) <em class="brace">{</em>
<a id="L731" name="L731"></a> 731         clientHandlerVector.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(h) ;
<a id="L732" name="L732"></a> 732     <em class="brace">}</em>
<a id="L733" name="L733"></a> 733 
<div class="comment">
      For SNMP Runtime internal use only.</div>
<a id="L737" name="L737"></a> 737     <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../S/6454.html#L113" title="Referred from 113 in src/com/sun/jmx/snmp/daemon/ClientHandler.java.">notifyClientHandlerDeleted</a>(<a href="../S/6454.html#L50" title="Defined at 50 in src/com/sun/jmx/snmp/daemon/ClientHandler.java.">ClientHandler</a> h) <em class="brace">{</em>
<a id="L738" name="L738"></a> 738         clientHandlerVector.<a href="../D/30774.html" title="Multiple defined in 14 places.">removeElement</a>(h);
<a id="L739" name="L739"></a> 739         <a href="../S/1724.html#L295" title="Defined at 295 in src/java/lang/Object.java.">notifyAll</a>();
<a id="L740" name="L740"></a> 740     <em class="brace">}</em>
<a id="L741" name="L741"></a> 741 
<div class="comment">
      The number of times the communicator server will attempt
      to bind before giving up.
     *</div>
<a id="L746" name="L746"></a> 746     <strong class="reserved">protected</strong> <strong class="reserved">int</strong> <a href="../S/6458.html#L780" title="Referred from 780 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">getBindTries</a>() <em class="brace">{</em>
<a id="L747" name="L747"></a> 747         <strong class="reserved">return</strong> 50;
<a id="L748" name="L748"></a> 748     <em class="brace">}</em>
<a id="L749" name="L749"></a> 749 
<div class="comment">
      The delay, in ms, during which the communicator server will sleep before
      attempting to bind again.
     *</div>
<a id="L754" name="L754"></a> 754     <strong class="reserved">protected</strong> <strong class="reserved">long</strong> <a href="../S/6458.html#L781" title="Referred from 781 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">getBindSleepTime</a>() <em class="brace">{</em>
<a id="L755" name="L755"></a> 755         <strong class="reserved">return</strong> 100;
<a id="L756" name="L756"></a> 756     <em class="brace">}</em>
<a id="L757" name="L757"></a> 757 
<div class="comment">
      For SNMP Runtime internal use only.
      <p>
      The <code>run</code> method executed by this connector's main thread.</p></div>
<a id="L763" name="L763"></a> 763     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L764" name="L764"></a> 764     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26539.html" title="Multiple referred from 715 places.">run</a>() <em class="brace">{</em>
<a id="L765" name="L765"></a> 765 
<a id="L766" name="L766"></a> 766         <em class="comment">// Fix jaw.00667.B</em>
<a id="L767" name="L767"></a> 767         <em class="comment">// It seems that the init of "i" and "success"</em>
<a id="L768" name="L768"></a> 768         <em class="comment">// need to be done outside the "try" clause...</em>
<a id="L769" name="L769"></a> 769         <em class="comment">// A bug in Java 2 production release ?</em>
<a id="L770" name="L770"></a> 770         <em class="comment">//</em>
<a id="L771" name="L771"></a> 771         <strong class="reserved">int</strong> i = 0;
<a id="L772" name="L772"></a> 772         <strong class="reserved">boolean</strong> <a href="../S/4534.html#L874" title="Defined at 874 in src/com/sun/org/apache/regexp/internal/RETest.java.">success</a> = <strong class="reserved">false</strong>;
<a id="L773" name="L773"></a> 773 
<a id="L774" name="L774"></a> 774         <em class="comment">// ----------------------</em>
<a id="L775" name="L775"></a> 775         <em class="comment">// Bind</em>
<a id="L776" name="L776"></a> 776         <em class="comment">// ----------------------</em>
<a id="L777" name="L777"></a> 777         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L778" name="L778"></a> 778             <em class="comment">// Fix for bug 4352451: "java.net.BindException: Address in use".</em>
<a id="L779" name="L779"></a> 779             <em class="comment">//</em>
<a id="L780" name="L780"></a> 780             <strong class="reserved">final</strong> <strong class="reserved">int</strong>  bindRetries = <a href="../D/17254.html" title="Multiple defined in 2 places.">getBindTries</a>();
<a id="L781" name="L781"></a> 781             <strong class="reserved">final</strong> <strong class="reserved">long</strong> sleepTime   = <a href="../S/6458.html#L754" title="Defined at 754 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">getBindSleepTime</a>();
<a id="L782" name="L782"></a> 782             <strong class="reserved">while</strong> (i &lt; bindRetries &amp;&amp; !<a href="../S/4534.html#L874" title="Defined at 874 in src/com/sun/org/apache/regexp/internal/RETest.java.">success</a>) <em class="brace">{</em>
<a id="L783" name="L783"></a> 783                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L784" name="L784"></a> 784                     <em class="comment">// Try socket connection.</em>
<a id="L785" name="L785"></a> 785                     <em class="comment">//</em>
<a id="L786" name="L786"></a> 786                     <a href="../D/15020.html" title="Multiple defined in 4 places.">doBind</a>();
<a id="L787" name="L787"></a> 787                     <a href="../S/4534.html#L874" title="Defined at 874 in src/com/sun/org/apache/regexp/internal/RETest.java.">success</a> = <strong class="reserved">true</strong>;
<a id="L788" name="L788"></a> 788                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a> ce) <em class="brace">{</em>
<a id="L789" name="L789"></a> 789                     i++;
<a id="L790" name="L790"></a> 790                     <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L791" name="L791"></a> 791                         <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../D/34632.html" title="Multiple defined in 4 places.">sleep</a>(sleepTime);
<a id="L792" name="L792"></a> 792                     <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> ie) <em class="brace">{</em>
<a id="L793" name="L793"></a> 793                         <strong class="reserved">throw</strong> ie;
<a id="L794" name="L794"></a> 794                     <em class="brace">}</em>
<a id="L795" name="L795"></a> 795                 <em class="brace">}</em>
<a id="L796" name="L796"></a> 796             <em class="brace">}</em>
<a id="L797" name="L797"></a> 797             <em class="comment">// Retry last time to get correct exception.</em>
<a id="L798" name="L798"></a> 798             <em class="comment">//</em>
<a id="L799" name="L799"></a> 799             <strong class="reserved">if</strong> (!<a href="../S/4534.html#L874" title="Defined at 874 in src/com/sun/org/apache/regexp/internal/RETest.java.">success</a>) <em class="brace">{</em>
<a id="L800" name="L800"></a> 800                 <em class="comment">// Try socket connection.</em>
<a id="L801" name="L801"></a> 801                 <em class="comment">//</em>
<a id="L802" name="L802"></a> 802                 <a href="../D/15020.html" title="Multiple defined in 4 places.">doBind</a>();
<a id="L803" name="L803"></a> 803             <em class="brace">}</em>
<a id="L804" name="L804"></a> 804 
<a id="L805" name="L805"></a> 805         <em class="brace">}</em> <strong class="reserved">catch</strong>(<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L806" name="L806"></a> 806             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L807" name="L807"></a> 807                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, dbgTag,
<a id="L808" name="L808"></a> 808                     "run", "Got unexpected exception", <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L809" name="L809"></a> 809             <em class="brace">}</em>
<a id="L810" name="L810"></a> 810             <strong class="reserved">synchronized</strong>(stateLock) <em class="brace">{</em>
<a id="L811" name="L811"></a> 811                 startException = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>;
<a id="L812" name="L812"></a> 812                 <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(OFFLINE);
<a id="L813" name="L813"></a> 813             <em class="brace">}</em>
<a id="L814" name="L814"></a> 814             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L815" name="L815"></a> 815                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L816" name="L816"></a> 816                     "run","State is OFFLINE");
<a id="L817" name="L817"></a> 817             <em class="brace">}</em>
<a id="L818" name="L818"></a> 818             <a href="../D/15031.html" title="Multiple defined in 2 places.">doError</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L819" name="L819"></a> 819             <strong class="reserved">return</strong>;
<a id="L820" name="L820"></a> 820         <em class="brace">}</em>
<a id="L821" name="L821"></a> 821 
<a id="L822" name="L822"></a> 822         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L823" name="L823"></a> 823             <em class="comment">// ----------------------</em>
<a id="L824" name="L824"></a> 824             <em class="comment">// State change</em>
<a id="L825" name="L825"></a> 825             <em class="comment">// ----------------------</em>
<a id="L826" name="L826"></a> 826             <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(ONLINE) ;
<a id="L827" name="L827"></a> 827             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L828" name="L828"></a> 828                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L829" name="L829"></a> 829                     "run","State is ONLINE");
<a id="L830" name="L830"></a> 830             <em class="brace">}</em>
<a id="L831" name="L831"></a> 831 
<a id="L832" name="L832"></a> 832             <em class="comment">// ----------------------</em>
<a id="L833" name="L833"></a> 833             <em class="comment">// Main loop</em>
<a id="L834" name="L834"></a> 834             <em class="comment">// ----------------------</em>
<a id="L835" name="L835"></a> 835             <strong class="reserved">while</strong> (!stopRequested) <em class="brace">{</em>
<a id="L836" name="L836"></a> 836                 servedClientCount++;
<a id="L837" name="L837"></a> 837                 <a href="../D/15068.html" title="Multiple defined in 2 places.">doReceive</a>() ;
<a id="L838" name="L838"></a> 838                 <a href="../S/6458.html#L1045" title="Defined at 1045 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">waitIfTooManyClients</a>() ;
<a id="L839" name="L839"></a> 839                 <a href="../D/15063.html" title="Multiple defined in 2 places.">doProcess</a>() ;
<a id="L840" name="L840"></a> 840             <em class="brace">}</em>
<a id="L841" name="L841"></a> 841             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L842" name="L842"></a> 842                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L843" name="L843"></a> 843                     "run","Stop has been requested");
<a id="L844" name="L844"></a> 844             <em class="brace">}</em>
<a id="L845" name="L845"></a> 845 
<a id="L846" name="L846"></a> 846         <em class="brace">}</em> <strong class="reserved">catch</strong>(<a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L847" name="L847"></a> 847             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L848" name="L848"></a> 848                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, dbgTag,
<a id="L849" name="L849"></a> 849                     "run","Interrupt caught");
<a id="L850" name="L850"></a> 850             <em class="brace">}</em>
<a id="L851" name="L851"></a> 851             <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(STOPPING);
<a id="L852" name="L852"></a> 852         <em class="brace">}</em> <strong class="reserved">catch</strong>(<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L853" name="L853"></a> 853             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L854" name="L854"></a> 854                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, dbgTag,
<a id="L855" name="L855"></a> 855                     "run","Got unexpected exception", <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L856" name="L856"></a> 856             <em class="brace">}</em>
<a id="L857" name="L857"></a> 857             <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(STOPPING);
<a id="L858" name="L858"></a> 858         <em class="brace">}</em> <strong class="reserved">finally</strong> <em class="brace">{</em>
<a id="L859" name="L859"></a> 859             <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L860" name="L860"></a> 860                 <a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a> = <strong class="reserved">true</strong>;
<a id="L861" name="L861"></a> 861                 <a href="../S/1769.html#L141" title="Defined at 141 in src/java/lang/Thread.java.">Thread</a>.<a href="../S/1769.html#L943" title="Defined at 943 in src/java/lang/Thread.java.">interrupted</a>();
<a id="L862" name="L862"></a> 862             <em class="brace">}</em>
<a id="L863" name="L863"></a> 863 
<a id="L864" name="L864"></a> 864             <em class="comment">// ----------------------</em>
<a id="L865" name="L865"></a> 865             <em class="comment">// unBind</em>
<a id="L866" name="L866"></a> 866             <em class="comment">// ----------------------</em>
<a id="L867" name="L867"></a> 867             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L868" name="L868"></a> 868                 <a href="../D/15098.html" title="Multiple defined in 4 places.">doUnbind</a>() ;
<a id="L869" name="L869"></a> 869                 <a href="../S/6458.html#L1059" title="Defined at 1059 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">waitClientTermination</a>() ;
<a id="L870" name="L870"></a> 870                 <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(OFFLINE);
<a id="L871" name="L871"></a> 871                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L872" name="L872"></a> 872                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L873" name="L873"></a> 873                         "run","State is OFFLINE");
<a id="L874" name="L874"></a> 874                 <em class="brace">}</em>
<a id="L875" name="L875"></a> 875             <em class="brace">}</em> <strong class="reserved">catch</strong>(<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L876" name="L876"></a> 876                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L877" name="L877"></a> 877                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, dbgTag,
<a id="L878" name="L878"></a> 878                         "run","Got unexpected exception", <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L879" name="L879"></a> 879                 <em class="brace">}</em>
<a id="L880" name="L880"></a> 880                 <a href="../S/6458.html#L1007" title="Defined at 1007 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">changeState</a>(OFFLINE);
<a id="L881" name="L881"></a> 881             <em class="brace">}</em>
<a id="L882" name="L882"></a> 882 
<a id="L883" name="L883"></a> 883         <em class="brace">}</em>
<a id="L884" name="L884"></a> 884     <em class="brace">}</em>
<a id="L885" name="L885"></a> 885 
<div class="comment">
</div>
<a id="L888" name="L888"></a> 888     <strong class="reserved">protected</strong> <strong class="reserved">abstract</strong> <strong class="reserved">void</strong> <a href="../S/6458.html#L818" title="Referred from 818 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">doError</a>(<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <strong class="reserved">throws</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>;
<a id="L889" name="L889"></a> 889 
<a id="L890" name="L890"></a> 890     <em class="comment">//</em>
<a id="L891" name="L891"></a> 891     <em class="comment">// To be defined by the subclass.</em>
<a id="L892" name="L892"></a> 892     <em class="comment">//</em>
<a id="L893" name="L893"></a> 893     <em class="comment">// Each method below is called by run() and must be subclassed.</em>
<a id="L894" name="L894"></a> 894     <em class="comment">// If the method sends an exception (Communication or Interrupt), this</em>
<a id="L895" name="L895"></a> 895     <em class="comment">// will end up the run() method and switch the connector offline.</em>
<a id="L896" name="L896"></a> 896     <em class="comment">//</em>
<a id="L897" name="L897"></a> 897     <em class="comment">// If it is a CommunicationException, run() will call</em>
<a id="L898" name="L898"></a> 898     <em class="comment">//       Debug.printException().</em>
<a id="L899" name="L899"></a> 899     <em class="comment">//</em>
<a id="L900" name="L900"></a> 900     <em class="comment">// All these methods should propagate the InterruptedException to inform</em>
<a id="L901" name="L901"></a> 901     <em class="comment">// run() that the connector must be switch OFFLINE.</em>
<a id="L902" name="L902"></a> 902     <em class="comment">//</em>
<a id="L903" name="L903"></a> 903     <em class="comment">//</em>
<a id="L904" name="L904"></a> 904     <em class="comment">//</em>
<a id="L905" name="L905"></a> 905     <em class="comment">// doBind() should do all what is needed before calling doReceive().</em>
<a id="L906" name="L906"></a> 906     <em class="comment">// If doBind() throws an exception, doUnbind() is not to be called</em>
<a id="L907" name="L907"></a> 907     <em class="comment">// and run() ends up.</em>
<a id="L908" name="L908"></a> 908     <em class="comment">//</em>
<a id="L909" name="L909"></a> 909 
<div class="comment">
</div>
<a id="L912" name="L912"></a> 912     <strong class="reserved">protected</strong> <strong class="reserved">abstract</strong> <strong class="reserved">void</strong> <a href="../R/13383.html" title="Multiple referred from 10 places.">doBind</a>()
<a id="L913" name="L913"></a> 913         <strong class="reserved">throws</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>, <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> ;
<a id="L914" name="L914"></a> 914 
<div class="comment">
      <code>doReceive()</code> should block until a client is available.
      If this method throws an exception, <code>doProcess()</code> is not
      called but <code>doUnbind()</code> is called then <code>run()</code>
      stops.</div>
<a id="L921" name="L921"></a> 921     <strong class="reserved">protected</strong> <strong class="reserved">abstract</strong> <strong class="reserved">void</strong> <a href="../S/6458.html#L837" title="Referred from 837 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">doReceive</a>()
<a id="L922" name="L922"></a> 922         <strong class="reserved">throws</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>, <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> ;
<a id="L923" name="L923"></a> 923 
<div class="comment">
      <code>doProcess()</code> is called after <code>doReceive()</code>:
      it should process the requests of the incoming client.
      If it throws an exception, <code>doUnbind()</code> is called and
      <code>run()</code> stops.</div>
<a id="L930" name="L930"></a> 930     <strong class="reserved">protected</strong> <strong class="reserved">abstract</strong> <strong class="reserved">void</strong> <a href="../R/13423.html" title="Multiple referred from 6 places.">doProcess</a>()
<a id="L931" name="L931"></a> 931         <strong class="reserved">throws</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>, <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> ;
<a id="L932" name="L932"></a> 932 
<div class="comment">
      <code>doUnbind()</code> is called whenever the connector goes
      <code>OFFLINE</code>, except if <code>doBind()</code> has thrown an
      exception.</div>
<a id="L938" name="L938"></a> 938     <strong class="reserved">protected</strong> <strong class="reserved">abstract</strong> <strong class="reserved">void</strong> <a href="../R/13457.html" title="Multiple referred from 3 places.">doUnbind</a>()
<a id="L939" name="L939"></a> 939         <strong class="reserved">throws</strong> <a href="../D/1679.html" title="Multiple defined in 2 places.">CommunicationException</a>, <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> ;
<a id="L940" name="L940"></a> 940 
<div class="comment">
      Get the <code>MBeanServer</code> object to which incoming requests are
      sent.  This is either the MBean server in which this connector is
      registered, or an <code>MBeanServerForwarder</code> leading to that
      server.</div>
<a id="L947" name="L947"></a> 947     <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <a href="../S/3578.html#L260" title="Defined at 260 in src/javax/management/MBeanServer.java.">MBeanServer</a> <a href="../R/17510.html" title="Multiple referred from 60 places.">getMBeanServer</a>() <em class="brace">{</em>
<a id="L948" name="L948"></a> 948         <strong class="reserved">return</strong> topMBS;
<a id="L949" name="L949"></a> 949     <em class="brace">}</em>
<a id="L950" name="L950"></a> 950 
<div class="comment">
      Set the <code>MBeanServer</code> object to which incoming
      requests are sent.  This must be either the MBean server in
      which this connector is registered, or an
      <code>MBeanServerForwarder</code> leading to that server.  An
      <code>MBeanServerForwarder</code> <code>mbsf</code> leads to an
      MBean server <code>mbs</code> if
      <code>mbsf.getMBeanServer()</code> is either <code>mbs</code>
      or an <code>MBeanServerForwarder</code> leading to
      <code>mbs</code>.
      @exception IllegalArgumentException if <code>newMBS</code> is neither
      the MBean server in which this connector is registered nor an
      <code>MBeanServerForwarder</code> leading to that server.
      @exception IllegalStateException This method has been invoked
      while the communicator was ONLINE or STARTING.</div>
<a id="L969" name="L969"></a> 969     <strong class="reserved">public</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../R/27706.html" title="Multiple referred from 15 places.">setMBeanServer</a>(<a href="../S/3578.html#L260" title="Defined at 260 in src/javax/management/MBeanServer.java.">MBeanServer</a> newMBS)
<a id="L970" name="L970"></a> 970             <strong class="reserved">throws</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>, <a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a> <em class="brace">{</em>
<a id="L971" name="L971"></a> 971         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L972" name="L972"></a> 972             <strong class="reserved">if</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == ONLINE || <a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == STARTING)
<a id="L973" name="L973"></a> 973                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a>("Stop server before " +
<a id="L974" name="L974"></a> 974                                                 "carrying out this operation");
<a id="L975" name="L975"></a> 975         <em class="brace">}</em>
<a id="L976" name="L976"></a> 976         <strong class="reserved">final</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/15699.html" title="Multiple defined in 51 places.">error</a> =
<a id="L977" name="L977"></a> 977             "MBeanServer argument must be MBean server where this " +
<a id="L978" name="L978"></a> 978             "server is registered, or an MBeanServerForwarder " +
<a id="L979" name="L979"></a> 979             "leading to that server";
<a id="L980" name="L980"></a> 980         <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;<a href="../S/3578.html#L260" title="Defined at 260 in src/javax/management/MBeanServer.java.">MBeanServer</a>&gt; seenMBS = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;&gt;();
<a id="L981" name="L981"></a> 981         <strong class="reserved">for</strong> (<a href="../S/3578.html#L260" title="Defined at 260 in src/javax/management/MBeanServer.java.">MBeanServer</a> mbs = newMBS;
<a id="L982" name="L982"></a> 982              mbs != bottomMBS;
<a id="L983" name="L983"></a> 983              mbs = ((<a href="../S/3620.html#L40" title="Defined at 40 in src/javax/management/remote/MBeanServerForwarder.java.">MBeanServerForwarder</a>) mbs).<a href="../D/20324.html" title="Multiple defined in 8 places.">getMBeanServer</a>()) <em class="brace">{</em>
<a id="L984" name="L984"></a> 984             <strong class="reserved">if</strong> (!(mbs <strong class="reserved">instanceof</strong> <a href="../S/3620.html#L40" title="Defined at 40 in src/javax/management/remote/MBeanServerForwarder.java.">MBeanServerForwarder</a>))
<a id="L985" name="L985"></a> 985                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>(<a href="../D/15699.html" title="Multiple defined in 51 places.">error</a>);
<a id="L986" name="L986"></a> 986             <strong class="reserved">if</strong> (seenMBS.<a href="../D/13313.html" title="Multiple defined in 245 places.">contains</a>(mbs))
<a id="L987" name="L987"></a> 987                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("MBeanServerForwarder " +
<a id="L988" name="L988"></a> 988                                                    "loop");
<a id="L989" name="L989"></a> 989             seenMBS.<a href="../D/10774.html" title="Multiple defined in 24 places.">addElement</a>(mbs);
<a id="L990" name="L990"></a> 990         <em class="brace">}</em>
<a id="L991" name="L991"></a> 991         topMBS = newMBS;
<a id="L992" name="L992"></a> 992     <em class="brace">}</em>
<a id="L993" name="L993"></a> 993 
<a id="L994" name="L994"></a> 994     <em class="comment">//</em>
<a id="L995" name="L995"></a> 995     <em class="comment">// To be called by the subclass if needed</em>
<a id="L996" name="L996"></a> 996     <em class="comment">//</em>
<div class="comment">
      For internal use only.</div>
<a id="L1000" name="L1000"></a>1000     <a href="../S/3486.html#L223" title="Defined at 223 in src/javax/management/ObjectName.java.">ObjectName</a> <a href="../R/18101.html" title="Multiple referred from 18 places.">getObjectName</a>() <em class="brace">{</em>
<a id="L1001" name="L1001"></a>1001         <strong class="reserved">return</strong> objectName ;
<a id="L1002" name="L1002"></a>1002     <em class="brace">}</em>
<a id="L1003" name="L1003"></a>1003 
<div class="comment">
      For internal use only.</div>
<a id="L1007" name="L1007"></a>1007     <strong class="reserved">void</strong> <a href="../R/11028.html" title="Multiple referred from 9 places.">changeState</a>(<strong class="reserved">int</strong> newState) <em class="brace">{</em>
<a id="L1008" name="L1008"></a>1008         <strong class="reserved">int</strong> oldState;
<a id="L1009" name="L1009"></a>1009         <strong class="reserved">synchronized</strong> (stateLock) <em class="brace">{</em>
<a id="L1010" name="L1010"></a>1010             <strong class="reserved">if</strong> (<a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> == newState)
<a id="L1011" name="L1011"></a>1011                 <strong class="reserved">return</strong>;
<a id="L1012" name="L1012"></a>1012             oldState = <a href="../D/34848.html" title="Multiple defined in 2 places.">state</a>;
<a id="L1013" name="L1013"></a>1013             <a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> = newState;
<a id="L1014" name="L1014"></a>1014             stateLock.<a href="../S/1724.html#L295" title="Defined at 295 in src/java/lang/Object.java.">notifyAll</a>();
<a id="L1015" name="L1015"></a>1015         <em class="brace">}</em>
<a id="L1016" name="L1016"></a>1016         <a href="../S/6458.html#L1257" title="Defined at 1257 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">sendStateChangeNotification</a>(oldState, newState);
<a id="L1017" name="L1017"></a>1017     <em class="brace">}</em>
<a id="L1018" name="L1018"></a>1018 
<div class="comment">
      Returns the string used in debug traces.</div>
<a id="L1022" name="L1022"></a>1022     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/22864.html" title="Multiple referred from 6 places.">makeDebugTag</a>() <em class="brace">{</em>
<a id="L1023" name="L1023"></a>1023         <strong class="reserved">return</strong> "CommunicatorServer["+ <a href="../D/21751.html" title="Multiple defined in 10 places.">getProtocol</a>() + ":" + <a href="../D/21541.html" title="Multiple defined in 42 places.">getPort</a>() + "]" ;
<a id="L1024" name="L1024"></a>1024     <em class="brace">}</em>
<a id="L1025" name="L1025"></a>1025 
<div class="comment">
      Returns the string used to name the connector thread.</div>
<a id="L1029" name="L1029"></a>1029     <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../S/6458.html#L262" title="Referred from 262 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">makeThreadName</a>() <em class="brace">{</em>
<a id="L1030" name="L1030"></a>1030         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> ;
<a id="L1031" name="L1031"></a>1031 
<a id="L1032" name="L1032"></a>1032         <strong class="reserved">if</strong> (objectName == <strong class="reserved">null</strong>)
<a id="L1033" name="L1033"></a>1033             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = "CommunicatorServer" ;
<a id="L1034" name="L1034"></a>1034         <strong class="reserved">else</strong>
<a id="L1035" name="L1035"></a>1035             <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> = objectName.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>() ;
<a id="L1036" name="L1036"></a>1036 
<a id="L1037" name="L1037"></a>1037         <strong class="reserved">return</strong> <a href="../D/31365.html" title="Multiple defined in 7 places.">result</a> ;
<a id="L1038" name="L1038"></a>1038     <em class="brace">}</em>
<a id="L1039" name="L1039"></a>1039 
<div class="comment">
      This method blocks if there are too many active clients.
      Call to <code>wait()</code> is terminated when a client handler
      thread calls <code>notifyClientHandlerDeleted(this)</code> ;</div>
<a id="L1045" name="L1045"></a>1045     <strong class="reserved">private</strong> <strong class="reserved">synchronized</strong> <strong class="reserved">void</strong> <a href="../S/6458.html#L838" title="Referred from 838 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">waitIfTooManyClients</a>()
<a id="L1046" name="L1046"></a>1046         <strong class="reserved">throws</strong> <a href="../S/1730.html#L50" title="Defined at 50 in src/java/lang/InterruptedException.java.">InterruptedException</a> <em class="brace">{</em>
<a id="L1047" name="L1047"></a>1047         <strong class="reserved">while</strong> (<a href="../D/16793.html" title="Multiple defined in 3 places.">getActiveClientCount</a>() &gt;= maxActiveClientCount) <em class="brace">{</em>
<a id="L1048" name="L1048"></a>1048             <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L1049" name="L1049"></a>1049                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L1050" name="L1050"></a>1050                     "waitIfTooManyClients","Waiting for a client to terminate");
<a id="L1051" name="L1051"></a>1051             <em class="brace">}</em>
<a id="L1052" name="L1052"></a>1052             <a href="../D/36778.html" title="Multiple defined in 3 places.">wait</a>();
<a id="L1053" name="L1053"></a>1053         <em class="brace">}</em>
<a id="L1054" name="L1054"></a>1054     <em class="brace">}</em>
<a id="L1055" name="L1055"></a>1055 
<div class="comment">
      This method blocks until there is no more active client.</div>
<a id="L1059" name="L1059"></a>1059     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6458.html#L869" title="Referred from 869 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">waitClientTermination</a>() <em class="brace">{</em>
<a id="L1060" name="L1060"></a>1060         <strong class="reserved">int</strong> s = clientHandlerVector.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() ;
<a id="L1061" name="L1061"></a>1061         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L1062" name="L1062"></a>1062             <strong class="reserved">if</strong> (s &gt;= 1) <em class="brace">{</em>
<a id="L1063" name="L1063"></a>1063                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L1064" name="L1064"></a>1064                 "waitClientTermination","waiting for " +
<a id="L1065" name="L1065"></a>1065                       s + " clients to terminate");
<a id="L1066" name="L1066"></a>1066             <em class="brace">}</em>
<a id="L1067" name="L1067"></a>1067         <em class="brace">}</em>
<a id="L1068" name="L1068"></a>1068 
<a id="L1069" name="L1069"></a>1069         <em class="comment">// The ClientHandler will remove themselves from the</em>
<a id="L1070" name="L1070"></a>1070         <em class="comment">// clientHandlerVector at the end of their run() method, by</em>
<a id="L1071" name="L1071"></a>1071         <em class="comment">// calling notifyClientHandlerDeleted().</em>
<a id="L1072" name="L1072"></a>1072         <em class="comment">// Since the clientHandlerVector is modified by the ClientHandler</em>
<a id="L1073" name="L1073"></a>1073         <em class="comment">// threads we must avoid using Enumeration or Iterator to loop</em>
<a id="L1074" name="L1074"></a>1074         <em class="comment">// over this array. We must also take care of NoSuchElementException</em>
<a id="L1075" name="L1075"></a>1075         <em class="comment">// which could be thrown if the last ClientHandler removes itself</em>
<a id="L1076" name="L1076"></a>1076         <em class="comment">// between the call to clientHandlerVector.isEmpty() and the call</em>
<a id="L1077" name="L1077"></a>1077         <em class="comment">// to clientHandlerVector.firstElement().</em>
<a id="L1078" name="L1078"></a>1078         <em class="comment">// What we *MUST NOT DO* is locking the clientHandlerVector, because</em>
<a id="L1079" name="L1079"></a>1079         <em class="comment">// this would most probably cause a deadlock.</em>
<a id="L1080" name="L1080"></a>1080         <em class="comment">//</em>
<a id="L1081" name="L1081"></a>1081         <strong class="reserved">while</strong> (! clientHandlerVector.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L1082" name="L1082"></a>1082             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1083" name="L1083"></a>1083                 clientHandlerVector.<a href="../D/16403.html" title="Multiple defined in 2 places.">firstElement</a>().<a href="../D/26697.html" title="Multiple defined in 17 places.">join</a>();
<a id="L1084" name="L1084"></a>1084             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1128.html#L38" title="Defined at 38 in src/java/util/NoSuchElementException.java.">NoSuchElementException</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L1085" name="L1085"></a>1085                 <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L1086" name="L1086"></a>1086                     SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L1087" name="L1087"></a>1087                         "waitClientTermination","No elements left",  <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L1088" name="L1088"></a>1088                 <em class="brace">}</em>
<a id="L1089" name="L1089"></a>1089             <em class="brace">}</em>
<a id="L1090" name="L1090"></a>1090         <em class="brace">}</em>
<a id="L1091" name="L1091"></a>1091 
<a id="L1092" name="L1092"></a>1092         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L1093" name="L1093"></a>1093             <strong class="reserved">if</strong> (s &gt;= 1) <em class="brace">{</em>
<a id="L1094" name="L1094"></a>1094                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L1095" name="L1095"></a>1095                     "waitClientTermination","Ok, let's go...");
<a id="L1096" name="L1096"></a>1096             <em class="brace">}</em>
<a id="L1097" name="L1097"></a>1097         <em class="brace">}</em>
<a id="L1098" name="L1098"></a>1098     <em class="brace">}</em>
<a id="L1099" name="L1099"></a>1099 
<div class="comment">
      Call <code>interrupt()</code> on each pending client.</div>
<a id="L1103" name="L1103"></a>1103     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6458.html#L378" title="Referred from 378 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">terminateAllClient</a>() <em class="brace">{</em>
<a id="L1104" name="L1104"></a>1104         <strong class="reserved">final</strong> <strong class="reserved">int</strong> s = clientHandlerVector.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>() ;
<a id="L1105" name="L1105"></a>1105         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L1106" name="L1106"></a>1106             <strong class="reserved">if</strong> (s &gt;= 1) <em class="brace">{</em>
<a id="L1107" name="L1107"></a>1107                 SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L1108" name="L1108"></a>1108                     "terminateAllClient","Interrupting " + s + " clients");
<a id="L1109" name="L1109"></a>1109             <em class="brace">}</em>
<a id="L1110" name="L1110"></a>1110         <em class="brace">}</em>
<a id="L1111" name="L1111"></a>1111 
<a id="L1112" name="L1112"></a>1112         <em class="comment">// The ClientHandler will remove themselves from the</em>
<a id="L1113" name="L1113"></a>1113         <em class="comment">// clientHandlerVector at the end of their run() method, by</em>
<a id="L1114" name="L1114"></a>1114         <em class="comment">// calling notifyClientHandlerDeleted().</em>
<a id="L1115" name="L1115"></a>1115         <em class="comment">// Since the clientHandlerVector is modified by the ClientHandler</em>
<a id="L1116" name="L1116"></a>1116         <em class="comment">// threads we must avoid using Enumeration or Iterator to loop</em>
<a id="L1117" name="L1117"></a>1117         <em class="comment">// over this array.</em>
<a id="L1118" name="L1118"></a>1118         <em class="comment">// We cannot use the same logic here than in waitClientTermination()</em>
<a id="L1119" name="L1119"></a>1119         <em class="comment">// because there is no guarantee that calling interrupt() on the</em>
<a id="L1120" name="L1120"></a>1120         <em class="comment">// ClientHandler will actually terminate the ClientHandler.</em>
<a id="L1121" name="L1121"></a>1121         <em class="comment">// Since we do not want to wait for the actual ClientHandler</em>
<a id="L1122" name="L1122"></a>1122         <em class="comment">// termination, we cannot simply loop over the array until it is</em>
<a id="L1123" name="L1123"></a>1123         <em class="comment">// empty (this might result in calling interrupt() endlessly on</em>
<a id="L1124" name="L1124"></a>1124         <em class="comment">// the same client handler. So what we do is simply take a snapshot</em>
<a id="L1125" name="L1125"></a>1125         <em class="comment">// copy of the vector and loop over the copy.</em>
<a id="L1126" name="L1126"></a>1126         <em class="comment">// What we *MUST NOT DO* is locking the clientHandlerVector, because</em>
<a id="L1127" name="L1127"></a>1127         <em class="comment">// this would most probably cause a deadlock.</em>
<a id="L1128" name="L1128"></a>1128         <em class="comment">//</em>
<a id="L1129" name="L1129"></a>1129         <strong class="reserved">final</strong>  <a href="../S/6454.html#L50" title="Defined at 50 in src/com/sun/jmx/snmp/daemon/ClientHandler.java.">ClientHandler</a>[] handlers =
<a id="L1130" name="L1130"></a>1130                 clientHandlerVector.<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>(<strong class="reserved">new</strong> <a href="../S/6454.html#L50" title="Defined at 50 in src/com/sun/jmx/snmp/daemon/ClientHandler.java.">ClientHandler</a>[0]);
<a id="L1131" name="L1131"></a>1131          <strong class="reserved">for</strong> (<a href="../S/6454.html#L50" title="Defined at 50 in src/com/sun/jmx/snmp/daemon/ClientHandler.java.">ClientHandler</a> h : handlers) <em class="brace">{</em>
<a id="L1132" name="L1132"></a>1132              <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1133" name="L1133"></a>1133                  h.<a href="../D/24969.html" title="Multiple defined in 3 places.">interrupt</a>() ;
<a id="L1134" name="L1134"></a>1134              <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L1135" name="L1135"></a>1135                  <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER)) <em class="brace">{</em>
<a id="L1136" name="L1136"></a>1136                      SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINER, dbgTag,
<a id="L1137" name="L1137"></a>1137                              "terminateAllClient",
<a id="L1138" name="L1138"></a>1138                              "Failed to interrupt pending request. " +
<a id="L1139" name="L1139"></a>1139                              "Ignore the exception.", <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L1140" name="L1140"></a>1140                  <em class="brace">}</em>
<a id="L1141" name="L1141"></a>1141             <em class="brace">}</em>
<a id="L1142" name="L1142"></a>1142         <em class="brace">}</em>
<a id="L1143" name="L1143"></a>1143     <em class="brace">}</em>
<a id="L1144" name="L1144"></a>1144 
<div class="comment">
      Controls the way the CommunicatorServer service is deserialized.</div>
<a id="L1148" name="L1148"></a>1148     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25518.html" title="Multiple referred from 189 places.">readObject</a>(<a href="../S/1378.html#L206" title="Defined at 206 in src/java/io/ObjectInputStream.java.">ObjectInputStream</a> <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>)
<a id="L1149" name="L1149"></a>1149         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a> <em class="brace">{</em>
<a id="L1150" name="L1150"></a>1150 
<a id="L1151" name="L1151"></a>1151         <em class="comment">// Call the default deserialization of the object.</em>
<a id="L1152" name="L1152"></a>1152         <em class="comment">//</em>
<a id="L1153" name="L1153"></a>1153         <a href="../D/34926.html" title="Multiple defined in 21 places.">stream</a>.<a href="../D/14746.html" title="Multiple defined in 2 places.">defaultReadObject</a>();
<a id="L1154" name="L1154"></a>1154 
<a id="L1155" name="L1155"></a>1155         <em class="comment">// Call the specific initialization for the CommunicatorServer service.</em>
<a id="L1156" name="L1156"></a>1156         <em class="comment">// This is for transient structures to be initialized to specific</em>
<a id="L1157" name="L1157"></a>1157         <em class="comment">// default values.</em>
<a id="L1158" name="L1158"></a>1158         <em class="comment">//</em>
<a id="L1159" name="L1159"></a>1159         stateLock = <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>();
<a id="L1160" name="L1160"></a>1160         <a href="../D/34848.html" title="Multiple defined in 2 places.">state</a> = OFFLINE;
<a id="L1161" name="L1161"></a>1161         stopRequested = <strong class="reserved">false</strong>;
<a id="L1162" name="L1162"></a>1162         servedClientCount = 0;
<a id="L1163" name="L1163"></a>1163         clientHandlerVector = <strong class="reserved">new</strong> <a href="../S/846.html#L83" title="Defined at 83 in src/java/util/Vector.java.">Vector</a>&lt;&gt;();
<a id="L1164" name="L1164"></a>1164         mainThread = <strong class="reserved">null</strong>;
<a id="L1165" name="L1165"></a>1165         notifCount = 0;
<a id="L1166" name="L1166"></a>1166         notifInfos = <strong class="reserved">null</strong>;
<a id="L1167" name="L1167"></a>1167         notifBroadcaster = <strong class="reserved">new</strong> <a href="../S/3524.html#L62" title="Defined at 62 in src/javax/management/NotificationBroadcasterSupport.java.">NotificationBroadcasterSupport</a>();
<a id="L1168" name="L1168"></a>1168         dbgTag = <a href="../D/27250.html" title="Multiple defined in 4 places.">makeDebugTag</a>();
<a id="L1169" name="L1169"></a>1169     <em class="brace">}</em>
<a id="L1170" name="L1170"></a>1170 
<a id="L1171" name="L1171"></a>1171 
<a id="L1172" name="L1172"></a>1172     <em class="comment">//</em>
<a id="L1173" name="L1173"></a>1173     <em class="comment">// NotificationBroadcaster</em>
<a id="L1174" name="L1174"></a>1174     <em class="comment">//</em>
<a id="L1175" name="L1175"></a>1175 
<div class="comment">
      Adds a listener for the notifications emitted by this
      CommunicatorServer.
      There is only one type of notifications sent by the CommunicatorServer:
      they are <tt>{@link javax.management.AttributeChangeNotification}</tt>,
      sent when the <tt>State</tt> attribute of this CommunicatorServer
      changes.
      @param listener The listener object which will handle the emitted
             notifications.
      @param filter The filter object. If filter is null, no filtering
             will be performed before handling notifications.
      @param handback An object which will be sent back unchanged to the
             listener when a notification is emitted.
      @exception IllegalArgumentException Listener parameter is null.</div>
<a id="L1193" name="L1193"></a>1193     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L1194" name="L1194"></a>1194     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/9880.html" title="Multiple referred from 25 places.">addNotificationListener</a>(<a href="../S/3533.html#L34" title="Defined at 34 in src/javax/management/NotificationListener.java.">NotificationListener</a> listener,
<a id="L1195" name="L1195"></a>1195                                         <a href="../S/3548.html#L35" title="Defined at 35 in src/javax/management/NotificationFilter.java.">NotificationFilter</a> <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>,
<a id="L1196" name="L1196"></a>1196                                         <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> handback)
<a id="L1197" name="L1197"></a>1197         <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a> <em class="brace">{</em>
<a id="L1198" name="L1198"></a>1198 
<a id="L1199" name="L1199"></a>1199         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L1200" name="L1200"></a>1200             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, dbgTag,
<a id="L1201" name="L1201"></a>1201                 "addNotificationListener","Adding listener "+ listener +
<a id="L1202" name="L1202"></a>1202                   " with filter "+ <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a> + " and handback "+ handback);
<a id="L1203" name="L1203"></a>1203         <em class="brace">}</em>
<a id="L1204" name="L1204"></a>1204         notifBroadcaster.<a href="../D/10974.html" title="Multiple defined in 26 places.">addNotificationListener</a>(listener, <a href="../D/16061.html" title="Multiple defined in 29 places.">filter</a>, handback);
<a id="L1205" name="L1205"></a>1205     <em class="brace">}</em>
<a id="L1206" name="L1206"></a>1206 
<div class="comment">
      Removes the specified listener from this CommunicatorServer.
      Note that if the listener has been registered with different
      handback objects or notification filters, all entries corresponding
      to the listener will be removed.
      @param listener The listener object to be removed.
      @exception ListenerNotFoundException The listener is not registered.</div>
<a id="L1217" name="L1217"></a>1217     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L1218" name="L1218"></a>1218     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/26036.html" title="Multiple referred from 45 places.">removeNotificationListener</a>(<a href="../S/3533.html#L34" title="Defined at 34 in src/javax/management/NotificationListener.java.">NotificationListener</a> listener)
<a id="L1219" name="L1219"></a>1219         <strong class="reserved">throws</strong> <a href="../S/3606.html#L34" title="Defined at 34 in src/javax/management/ListenerNotFoundException.java.">ListenerNotFoundException</a> <em class="brace">{</em>
<a id="L1220" name="L1220"></a>1220 
<a id="L1221" name="L1221"></a>1221         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L1222" name="L1222"></a>1222             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, dbgTag,
<a id="L1223" name="L1223"></a>1223                 "removeNotificationListener","Removing listener "+ listener);
<a id="L1224" name="L1224"></a>1224         <em class="brace">}</em>
<a id="L1225" name="L1225"></a>1225         notifBroadcaster.<a href="../D/30900.html" title="Multiple defined in 49 places.">removeNotificationListener</a>(listener);
<a id="L1226" name="L1226"></a>1226     <em class="brace">}</em>
<a id="L1227" name="L1227"></a>1227 
<div class="comment">
      Returns an array of MBeanNotificationInfo objects describing
      the notification types sent by this CommunicatorServer.
      There is only one type of notifications sent by the CommunicatorServer:
      it is <tt>{@link javax.management.AttributeChangeNotification}</tt>,
      sent when the <tt>State</tt> attribute of this CommunicatorServer
      changes.</div>
<a id="L1236" name="L1236"></a>1236     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L1237" name="L1237"></a>1237     <strong class="reserved">public</strong> <a href="../S/3444.html#L61" title="Defined at 61 in src/javax/management/MBeanNotificationInfo.java.">MBeanNotificationInfo</a>[] <a href="../R/18026.html" title="Multiple referred from 6 places.">getNotificationInfo</a>() <em class="brace">{</em>
<a id="L1238" name="L1238"></a>1238 
<a id="L1239" name="L1239"></a>1239         <em class="comment">// Initialize notifInfos on first call to getNotificationInfo()</em>
<a id="L1240" name="L1240"></a>1240         <em class="comment">//</em>
<a id="L1241" name="L1241"></a>1241         <strong class="reserved">if</strong> (notifInfos == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1242" name="L1242"></a>1242             notifInfos = <strong class="reserved">new</strong> <a href="../S/3444.html#L61" title="Defined at 61 in src/javax/management/MBeanNotificationInfo.java.">MBeanNotificationInfo</a>[1];
<a id="L1243" name="L1243"></a>1243             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>[] notifTypes = <em class="brace">{</em>
<a id="L1244" name="L1244"></a>1244                 <a href="../S/3554.html#L52" title="Defined at 52 in src/javax/management/AttributeChangeNotification.java.">AttributeChangeNotification</a>.ATTRIBUTE_CHANGE<em class="brace">}</em>;
<a id="L1245" name="L1245"></a>1245             notifInfos[0] = <strong class="reserved">new</strong> <a href="../S/3444.html#L61" title="Defined at 61 in src/javax/management/MBeanNotificationInfo.java.">MBeanNotificationInfo</a>( notifTypes,
<a id="L1246" name="L1246"></a>1246                      <a href="../S/3554.html#L52" title="Defined at 52 in src/javax/management/AttributeChangeNotification.java.">AttributeChangeNotification</a>.<strong class="reserved">class</strong>.<a href="../D/20784.html" title="Multiple defined in 355 places.">getName</a>(),
<a id="L1247" name="L1247"></a>1247                      "Sent to notify that the value of the State attribute "+
<a id="L1248" name="L1248"></a>1248                      "of this CommunicatorServer instance has changed.");
<a id="L1249" name="L1249"></a>1249         <em class="brace">}</em>
<a id="L1250" name="L1250"></a>1250 
<a id="L1251" name="L1251"></a>1251         <strong class="reserved">return</strong> notifInfos.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L1252" name="L1252"></a>1252     <em class="brace">}</em>
<a id="L1253" name="L1253"></a>1253 
<div class="comment">
</div>
<a id="L1257" name="L1257"></a>1257     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../S/6458.html#L1016" title="Referred from 1016 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">sendStateChangeNotification</a>(<strong class="reserved">int</strong> oldState, <strong class="reserved">int</strong> newState) <em class="brace">{</em>
<a id="L1258" name="L1258"></a>1258 
<a id="L1259" name="L1259"></a>1259         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> oldStateString = <a href="../S/6458.html#L1288" title="Defined at 1288 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">getStringForState</a>(oldState);
<a id="L1260" name="L1260"></a>1260         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> newStateString = <a href="../S/6458.html#L1288" title="Defined at 1288 in src/com/sun/jmx/snmp/daemon/CommunicatorServer.java.">getStringForState</a>(newState);
<a id="L1261" name="L1261"></a>1261         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a> = <strong class="reserved">new</strong> <a href="../S/1583.html#L97" title="Defined at 97 in src/java/lang/StringBuffer.java.">StringBuffer</a>().<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(dbgTag)
<a id="L1262" name="L1262"></a>1262             .<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(" The value of attribute State has changed from ")
<a id="L1263" name="L1263"></a>1263             .<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(oldState).<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(" (").<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(oldStateString)
<a id="L1264" name="L1264"></a>1264             .<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(") to ").<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(newState).<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(" (")
<a id="L1265" name="L1265"></a>1265             .<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(newStateString).<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(").").<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L1266" name="L1266"></a>1266 
<a id="L1267" name="L1267"></a>1267         notifCount++;
<a id="L1268" name="L1268"></a>1268         <a href="../S/3554.html#L52" title="Defined at 52 in src/javax/management/AttributeChangeNotification.java.">AttributeChangeNotification</a> notif =
<a id="L1269" name="L1269"></a>1269             <strong class="reserved">new</strong> <a href="../S/3554.html#L52" title="Defined at 52 in src/javax/management/AttributeChangeNotification.java.">AttributeChangeNotification</a>(<strong class="reserved">this</strong>,    <em class="comment">// source</em>
<a id="L1270" name="L1270"></a>1270                          notifCount,                 <em class="comment">// sequence number</em>
<a id="L1271" name="L1271"></a>1271                          <a href="../S/1557.html#L59" title="Defined at 59 in src/java/lang/System.java.">System</a>.<a href="../S/1557.html#L353" title="Defined at 353 in src/java/lang/System.java.">currentTimeMillis</a>(), <em class="comment">// time stamp</em>
<a id="L1272" name="L1272"></a>1272                          <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>,                    <em class="comment">// message</em>
<a id="L1273" name="L1273"></a>1273                          "State",                    <em class="comment">// attribute name</em>
<a id="L1274" name="L1274"></a>1274                          "int",                      <em class="comment">// attribute type</em>
<a id="L1275" name="L1275"></a>1275                          <strong class="reserved">new</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>(oldState),      <em class="comment">// old value</em>
<a id="L1276" name="L1276"></a>1276                          <strong class="reserved">new</strong> <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>(newState) );    <em class="comment">// new value</em>
<a id="L1277" name="L1277"></a>1277         <strong class="reserved">if</strong> (SNMP_ADAPTOR_LOGGER.<a href="../D/25833.html" title="Multiple defined in 6 places.">isLoggable</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST)) <em class="brace">{</em>
<a id="L1278" name="L1278"></a>1278             SNMP_ADAPTOR_LOGGER.<a href="../D/27062.html" title="Multiple defined in 6 places.">logp</a>(<a href="../S/1180.html#L66" title="Defined at 66 in src/java/util/logging/Level.java.">Level</a>.FINEST, dbgTag,
<a id="L1279" name="L1279"></a>1279                 "sendStateChangeNotification","Sending AttributeChangeNotification #"
<a id="L1280" name="L1280"></a>1280                     + notifCount + " with message: "+ <a href="../D/27673.html" title="Multiple defined in 6 places.">message</a>);
<a id="L1281" name="L1281"></a>1281         <em class="brace">}</em>
<a id="L1282" name="L1282"></a>1282         notifBroadcaster.<a href="../D/31741.html" title="Multiple defined in 14 places.">sendNotification</a>(notif);
<a id="L1283" name="L1283"></a>1283     <em class="brace">}</em>
<a id="L1284" name="L1284"></a>1284 
<div class="comment">
</div>
<a id="L1288" name="L1288"></a>1288     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/19217.html" title="Multiple referred from 4 places.">getStringForState</a>(<strong class="reserved">int</strong> s) <em class="brace">{</em>
<a id="L1289" name="L1289"></a>1289         <strong class="reserved">switch</strong> (s) <em class="brace">{</em>
<a id="L1290" name="L1290"></a>1290         <strong class="reserved">case</strong> ONLINE:   <strong class="reserved">return</strong> "ONLINE";
<a id="L1291" name="L1291"></a>1291         <strong class="reserved">case</strong> STARTING: <strong class="reserved">return</strong> "STARTING";
<a id="L1292" name="L1292"></a>1292         <strong class="reserved">case</strong> OFFLINE:  <strong class="reserved">return</strong> "OFFLINE";
<a id="L1293" name="L1293"></a>1293         <strong class="reserved">case</strong> STOPPING: <strong class="reserved">return</strong> "STOPPING";
<a id="L1294" name="L1294"></a>1294         <strong class="reserved">default</strong>:       <strong class="reserved">return</strong> "UNDEFINED";
<a id="L1295" name="L1295"></a>1295         <em class="brace">}</em>
<a id="L1296" name="L1296"></a>1296     <em class="brace">}</em>
<a id="L1297" name="L1297"></a>1297 
<a id="L1298" name="L1298"></a>1298 
<a id="L1299" name="L1299"></a>1299     <em class="comment">//</em>
<a id="L1300" name="L1300"></a>1300     <em class="comment">// MBeanRegistration</em>
<a id="L1301" name="L1301"></a>1301     <em class="comment">//</em>
<a id="L1302" name="L1302"></a>1302 
<div class="comment">
      Preregister method of connector.
     @param server The <code>MBeanServer</code> in which the MBean will
            be registered.
     @param name The object name of the MBean.
     @return  The name of the MBean registered.
     @exception java.langException This exception should be caught by
                the <code>MBeanServer</code> and re-thrown
                as an <code>MBeanRegistrationException</code>.</div>
<a id="L1316" name="L1316"></a>1316     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L1317" name="L1317"></a>1317     <strong class="reserved">public</strong> <a href="../S/3486.html#L223" title="Defined at 223 in src/javax/management/ObjectName.java.">ObjectName</a> <a href="../R/24896.html" title="Multiple referred from 4 places.">preRegister</a>(<a href="../S/3578.html#L260" title="Defined at 260 in src/javax/management/MBeanServer.java.">MBeanServer</a> server, <a href="../S/3486.html#L223" title="Defined at 223 in src/javax/management/ObjectName.java.">ObjectName</a> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>)
<a id="L1318" name="L1318"></a>1318             <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <em class="brace">{</em>
<a id="L1319" name="L1319"></a>1319         objectName = <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>;
<a id="L1320" name="L1320"></a>1320         <strong class="reserved">synchronized</strong> (<strong class="reserved">this</strong>) <em class="brace">{</em>
<a id="L1321" name="L1321"></a>1321             <strong class="reserved">if</strong> (bottomMBS != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1322" name="L1322"></a>1322                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>("connector already " +
<a id="L1323" name="L1323"></a>1323                                                    "registered in an MBean " +
<a id="L1324" name="L1324"></a>1324                                                    "server");
<a id="L1325" name="L1325"></a>1325             <em class="brace">}</em>
<a id="L1326" name="L1326"></a>1326             topMBS = bottomMBS = server;
<a id="L1327" name="L1327"></a>1327         <em class="brace">}</em>
<a id="L1328" name="L1328"></a>1328         dbgTag = <a href="../D/27250.html" title="Multiple defined in 4 places.">makeDebugTag</a>();
<a id="L1329" name="L1329"></a>1329         <strong class="reserved">return</strong> <a href="../D/27856.html" title="Multiple defined in 46 places.">name</a>;
<a id="L1330" name="L1330"></a>1330     <em class="brace">}</em>
<a id="L1331" name="L1331"></a>1331 
<div class="comment">
     @param registrationDone Indicates whether or not the MBean has been
            successfully registered in the <code>MBeanServer</code>.
            The value false means that the registration phase has failed.</div>
<a id="L1338" name="L1338"></a>1338     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L1339" name="L1339"></a>1339     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/24865.html" title="Multiple referred from 4 places.">postRegister</a>(<a href="../S/1770.html#L43" title="Defined at 43 in src/java/lang/Boolean.java.">Boolean</a> registrationDone) <em class="brace">{</em>
<a id="L1340" name="L1340"></a>1340         <strong class="reserved">if</strong> (!registrationDone.<a href="../D/11892.html" title="Multiple defined in 3 places.">booleanValue</a>()) <em class="brace">{</em>
<a id="L1341" name="L1341"></a>1341             <strong class="reserved">synchronized</strong> (<strong class="reserved">this</strong>) <em class="brace">{</em>
<a id="L1342" name="L1342"></a>1342                 topMBS = bottomMBS = <strong class="reserved">null</strong>;
<a id="L1343" name="L1343"></a>1343             <em class="brace">}</em>
<a id="L1344" name="L1344"></a>1344         <em class="brace">}</em>
<a id="L1345" name="L1345"></a>1345     <em class="brace">}</em>
<a id="L1346" name="L1346"></a>1346 
<div class="comment">
      Stop the connector.
      @exception java.langException This exception should be caught by
                 the <code>MBeanServer</code> and re-thrown
                 as an <code>MBeanRegistrationException</code>.</div>
<a id="L1354" name="L1354"></a>1354     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L1355" name="L1355"></a>1355     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/24887.html" title="Multiple referred from 3 places.">preDeregister</a>() <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.lang.<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> <em class="brace">{</em>
<a id="L1356" name="L1356"></a>1356         <strong class="reserved">synchronized</strong> (<strong class="reserved">this</strong>) <em class="brace">{</em>
<a id="L1357" name="L1357"></a>1357             topMBS = bottomMBS = <strong class="reserved">null</strong>;
<a id="L1358" name="L1358"></a>1358         <em class="brace">}</em>
<a id="L1359" name="L1359"></a>1359         objectName = <strong class="reserved">null</strong> ;
<a id="L1360" name="L1360"></a>1360         <strong class="reserved">final</strong> <strong class="reserved">int</strong> cstate = <a href="../D/22724.html" title="Multiple defined in 28 places.">getState</a>();
<a id="L1361" name="L1361"></a>1361         <strong class="reserved">if</strong> ((cstate == ONLINE) || ( cstate == STARTING)) <em class="brace">{</em>
<a id="L1362" name="L1362"></a>1362             <a href="../D/34877.html" title="Multiple defined in 25 places.">stop</a>() ;
<a id="L1363" name="L1363"></a>1363         <em class="brace">}</em>
<a id="L1364" name="L1364"></a>1364     <em class="brace">}</em>
<a id="L1365" name="L1365"></a>1365 
<div class="comment">
      Do nothing.</div>
<a id="L1369" name="L1369"></a>1369     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L1370" name="L1370"></a>1370     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/24854.html" title="Multiple referred from 3 places.">postDeregister</a>()<em class="brace">{</em>
<a id="L1371" name="L1371"></a>1371     <em class="brace">}</em>
<a id="L1372" name="L1372"></a>1372 
<a id="L1373" name="L1373"></a>1373 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L261">[^]</a><a href="#L1370">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>