<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/util/concurrent/ConcurrentLinkedDeque.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L280">[^]</a><a href="#L1561">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L280" title="Defined at 280.">SuppressWarnings</a></li>
<li><a href="#L281" title="Defined at 281.">prevTerminator</a></li>
<li><a href="#L285" title="Defined at 285.">SuppressWarnings</a></li>
<li><a href="#L286" title="Defined at 286.">nextTerminator</a></li>
<li><a href="#L306" title="Defined at 306.">casItem</a></li>
<li><a href="#L310" title="Defined at 310.">lazySetNext</a></li>
<li><a href="#L314" title="Defined at 314.">casNext</a></li>
<li><a href="#L318" title="Defined at 318.">lazySetPrev</a></li>
<li><a href="#L322" title="Defined at 322.">casPrev</a></li>
<li><a href="#L352" title="Defined at 352.">linkFirst</a></li>
<li><a href="#L385" title="Defined at 385.">linkLast</a></li>
<li><a href="#L420" title="Defined at 420.">unlink</a></li>
<li><a href="#L531" title="Defined at 531.">unlinkFirst</a></li>
<li><a href="#L565" title="Defined at 565.">unlinkLast</a></li>
<li><a href="#L602" title="Defined at 602.">updateHead</a></li>
<li><a href="#L632" title="Defined at 632.">updateTail</a></li>
<li><a href="#L656" title="Defined at 656.">skipDeletedPredecessors</a></li>
<li><a href="#L687" title="Defined at 687.">skipDeletedSuccessors</a></li>
<li><a href="#L723" title="Defined at 723.">succ</a></li>
<li><a href="#L734" title="Defined at 734.">pred</a></li>
<li><a href="#L745" title="Defined at 745.">first</a></li>
<li><a href="#L770" title="Defined at 770.">last</a></li>
<li><a href="#L796" title="Defined at 796.">checkNotNull</a></li>
<li><a href="#L808" title="Defined at 808.">screenNullResult</a></li>
<li><a href="#L820" title="Defined at 820.">toArrayList</a></li>
<li><a href="#L866" title="Defined at 866.">initHeadTail</a></li>
<li><a href="#L889" title="Defined at 889.">addFirst</a></li>
<li><a href="#L902" title="Defined at 902.">addLast</a></li>
<li><a href="#L913" title="Defined at 913.">offerFirst</a></li>
<li><a href="#L927" title="Defined at 927.">offerLast</a></li>
<li><a href="#L932" title="Defined at 932.">peekFirst</a></li>
<li><a href="#L941" title="Defined at 941.">peekLast</a></li>
<li><a href="#L953" title="Defined at 953.">getFirst</a></li>
<li><a href="#L960" title="Defined at 960.">getLast</a></li>
<li><a href="#L964" title="Defined at 964.">pollFirst</a></li>
<li><a href="#L975" title="Defined at 975.">pollLast</a></li>
<li><a href="#L989" title="Defined at 989.">removeFirst</a></li>
<li><a href="#L996" title="Defined at 996.">removeLast</a></li>
<li><a href="#L1009" title="Defined at 1009.">offer</a></li>
<li><a href="#L1021" title="Defined at 1021.">add</a></li>
<li><a href="#L1025" title="Defined at 1025.">poll</a></li>
<li><a href="#L1026" title="Defined at 1026.">peek</a></li>
<li><a href="#L1031" title="Defined at 1031.">remove</a></li>
<li><a href="#L1036" title="Defined at 1036.">pop</a></li>
<li><a href="#L1041" title="Defined at 1041.">element</a></li>
<li><a href="#L1046" title="Defined at 1046.">push</a></li>
<li><a href="#L1057" title="Defined at 1057.">removeFirstOccurrence</a></li>
<li><a href="#L1078" title="Defined at 1078.">removeLastOccurrence</a></li>
<li><a href="#L1097" title="Defined at 1097.">contains</a></li>
<li><a href="#L1112" title="Defined at 1112.">isEmpty</a></li>
<li><a href="#L1132" title="Defined at 1132.">size</a></li>
<li><a href="#L1151" title="Defined at 1151.">remove</a></li>
<li><a href="#L1167" title="Defined at 1167.">addAll</a></li>
<li><a href="#L1222" title="Defined at 1222.">clear</a></li>
<li><a href="#L1240" title="Defined at 1240.">toArray</a></li>
<li><a href="#L1281" title="Defined at 1281.">toArray</a></li>
<li><a href="#L1294" title="Defined at 1294.">iterator</a></li>
<li><a href="#L1308" title="Defined at 1308.">descendingIterator</a></li>
<li><a href="#L1332" title="Defined at 1332.">startNode</a></li>
<li><a href="#L1333" title="Defined at 1333.">nextNode</a></li>
<li><a href="#L1343" title="Defined at 1343.">advance</a></li>
<li><a href="#L1363" title="Defined at 1363.">hasNext</a></li>
<li><a href="#L1367" title="Defined at 1367.">next</a></li>
<li><a href="#L1374" title="Defined at 1374.">remove</a></li>
<li><a href="#L1385" title="Defined at 1385.">startNode</a></li>
<li><a href="#L1386" title="Defined at 1386.">nextNode</a></li>
<li><a href="#L1391" title="Defined at 1391.">startNode</a></li>
<li><a href="#L1392" title="Defined at 1392.">nextNode</a></li>
<li><a href="#L1406" title="Defined at 1406.">trySplit</a></li>
<li><a href="#L1437" title="Defined at 1437.">forEachRemaining</a></li>
<li><a href="#L1454" title="Defined at 1454.">tryAdvance</a></li>
<li><a href="#L1476" title="Defined at 1476.">estimateSize</a></li>
<li><a href="#L1478" title="Defined at 1478.">characteristics</a></li>
<li><a href="#L1500" title="Defined at 1500.">spliterator</a></li>
<li><a href="#L1512" title="Defined at 1512.">writeObject</a></li>
<li><a href="#L1536" title="Defined at 1536.">readObject</a></li>
<li><a href="#L1557" title="Defined at 1557.">casHead</a></li>
<li><a href="#L1561" title="Defined at 1561.">casTail</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L24" name="L24"></a>  24 
<div class="comment">
  Written by Doug Lea and Martin Buchholz with assistance from members of
  JCP JSR-166 Expert Group and released to the public domain, as explained
  at http://creativecommons.org/publicdomain/zero/1.0/</div>
<a id="L35" name="L35"></a>  35 
<a id="L36" name="L36"></a>  36 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.util.concurrent;
<a id="L37" name="L37"></a>  37 
<a id="L38" name="L38"></a>  38 <strong class="reserved">import</strong> java.util.AbstractCollection;
<a id="L39" name="L39"></a>  39 <strong class="reserved">import</strong> java.util.ArrayList;
<a id="L40" name="L40"></a>  40 <strong class="reserved">import</strong> java.util.Collection;
<a id="L41" name="L41"></a>  41 <strong class="reserved">import</strong> java.util.Deque;
<a id="L42" name="L42"></a>  42 <strong class="reserved">import</strong> java.util.Iterator;
<a id="L43" name="L43"></a>  43 <strong class="reserved">import</strong> java.util.NoSuchElementException;
<a id="L44" name="L44"></a>  44 <strong class="reserved">import</strong> java.util.Queue;
<a id="L45" name="L45"></a>  45 <strong class="reserved">import</strong> java.util.Spliterator;
<a id="L46" name="L46"></a>  46 <strong class="reserved">import</strong> java.util.Spliterators;
<a id="L47" name="L47"></a>  47 <strong class="reserved">import</strong> java.util.function.Consumer;
<a id="L48" name="L48"></a>  48 
<div class="comment">
  An unbounded concurrent {@linkplain Deque deque} based on linked nodes.
  Concurrent insertion, removal, and access operations execute safely
  across multiple threads.
  A <code>ConcurrentLinkedDeque</code> is an appropriate choice when
  many threads will share access to a common collection.
  Like most other concurrent collection implementations, this class
  does not permit the use of <code>null</code> elements.
  <p>Iterators and spliterators are
  <a href="package-summary.html#Weakly"><i>weakly consistent</i></a>.
  </p><p>Beware that, unlike in most collections, the <code>size</code> method
  is <em>NOT</em> a constant-time operation. Because of the
  asynchronous nature of these deques, determining the current number
  of elements requires a traversal of the elements, and so may report
  inaccurate results if this collection is modified during traversal.
  Additionally, the bulk operations <code>addAll</code>,
  <code>removeAll</code>, <code>retainAll</code>, <code>containsAll</code>,
  <code>equals</code>, and <code>toArray</code> are <em>not</em> guaranteed
  to be performed atomically. For example, an iterator operating
  concurrently with an <code>addAll</code> operation might view only some
  of the added elements.
  </p><p>This class and its iterator implement all of the <em>optional</em>
  methods of the {@link Deque} and {@link Iterator} interfaces.
  </p><p>Memory consistency effects: As with other concurrent collections,
  actions in a thread prior to placing an object into a
  <code>ConcurrentLinkedDeque</code>
  <a href="package-summary.html#MemoryVisibility"><i>happen-before</i></a>
  actions subsequent to the access or removal of that element from
  the <code>ConcurrentLinkedDeque</code> in another thread.
  </p><p>This class is a member of the
  <a href="{@docRoot}/../technotes/guides/collections/index.html">
  Java Collections Framework</a>.
  @since 1.7
  @author Doug Lea
  @author Martin Buchholz
  @param <e> the type of elements held in this collection</e></p></div>
<a id="L92" name="L92"></a>  92 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/1629.html" title="Multiple referred from 6 places.">ConcurrentLinkedDeque</a>&lt;E&gt;
<a id="L93" name="L93"></a>  93     <strong class="reserved">extends</strong> <a href="../S/995.html#L61" title="Defined at 61 in src/java/util/AbstractCollection.java.">AbstractCollection</a>&lt;E&gt;
<a id="L94" name="L94"></a>  94     <strong class="reserved">implements</strong> <a href="../S/1133.html#L193" title="Defined at 193 in src/java/util/Deque.java.">Deque</a>&lt;E&gt;, <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1407.html#L169" title="Defined at 169 in src/java/io/Serializable.java.">Serializable</a> <em class="brace">{</em>
<a id="L95" name="L95"></a>  95 
<div class="comment">
      This is an implementation of a concurrent lock-free deque
      supporting interior removes but not interior insertions, as
      required to support the entire Deque interface.
      We extend the techniques developed for ConcurrentLinkedQueue and
      LinkedTransferQueue (see the internal docs for those classes).
      Understanding the ConcurrentLinkedQueue implementation is a
      prerequisite for understanding the implementation of this class.
      The data structure is a symmetrical doubly-linked "GC-robust"
      linked list of nodes.  We minimize the number of volatile writes
      using two techniques: advancing multiple hops with a single CAS
      and mixing volatile and non-volatile writes of the same memory
      locations.
      A node contains the expected E ("item") and links to predecessor
      ("prev") and successor ("next") nodes:
      class Node<e> { volatile Node<e> prev, next; volatile E item; }
      A node p is considered "live" if it contains a non-null item
      (p.item != null).  When an item is CASed to null, the item is
      atomically logically deleted from the collection.
      At any time, there is precisely one "first" node with a null
      prev reference that terminates any chain of prev references
      starting at a live node.  Similarly there is precisely one
      "last" node terminating any chain of next references starting at
      a live node.  The "first" and "last" nodes may or may not be live.
      The "first" and "last" nodes are always mutually reachable.
      A new element is added atomically by CASing the null prev or
      next reference in the first or last node to a fresh node
      containing the element.  The element's node atomically becomes
      "live" at that point.
      A node is considered "active" if it is a live node, or the
      first or last node.  Active nodes cannot be unlinked.
      A "self-link" is a next or prev reference that is the same node:
        p.prev == p  or  p.next == p
      Self-links are used in the node unlinking process.  Active nodes
      never have self-links.
      A node p is active if and only if:
      p.item != null ||
      (p.prev == null &amp;&amp; p.next != p) ||
      (p.next == null &amp;&amp; p.prev != p)
      The deque object has two node references, "head" and "tail".
      The head and tail are only approximations to the first and last
      nodes of the deque.  The first node can always be found by
      following prev pointers from head; likewise for tail.  However,
      it is permissible for head and tail to be referring to deleted
      nodes that have been unlinked and so may not be reachable from
      any live node.
      There are 3 stages of node deletion;
      "logical deletion", "unlinking", and "gc-unlinking".
      1. "logical deletion" by CASing item to null atomically removes
      the element from the collection, and makes the containing node
      eligible for unlinking.
      2. "unlinking" makes a deleted node unreachable from active
      nodes, and thus eventually reclaimable by GC.  Unlinked nodes
      may remain reachable indefinitely from an iterator.
      Physical node unlinking is merely an optimization (albeit a
      critical one), and so can be performed at our convenience.  At
      any time, the set of live nodes maintained by prev and next
      links are identical, that is, the live nodes found via next
      links from the first node is equal to the elements found via
      prev links from the last node.  However, this is not true for
      nodes that have already been logically deleted - such nodes may
      be reachable in one direction only.
      3. "gc-unlinking" takes unlinking further by making active
      nodes unreachable from deleted nodes, making it easier for the
      GC to reclaim future deleted nodes.  This step makes the data
      structure "gc-robust", as first described in detail by Boehm
      (http://portal.acm.org/citation.cfm?doid=503272.503282).
      GC-unlinked nodes may remain reachable indefinitely from an
      iterator, but unlike unlinked nodes, are never reachable from
      head or tail.
      Making the data structure GC-robust will eliminate the risk of
      unbounded memory retention with conservative GCs and is likely
      to improve performance with generational GCs.
      When a node is dequeued at either end, e.g. via poll(), we would
      like to break any references from the node to active nodes.  We
      develop further the use of self-links that was very effective in
      other concurrent collection classes.  The idea is to replace
      prev and next pointers with special values that are interpreted
      to mean off-the-list-at-one-end.  These are approximations, but
      good enough to preserve the properties we want in our
      traversals, e.g. we guarantee that a traversal will never visit
      the same element twice, but we don't guarantee whether a
      traversal that runs out of elements will be able to see more
      elements later after enqueues at that end.  Doing gc-unlinking
      safely is particularly tricky, since any node can be in use
      indefinitely (for example by an iterator).  We must ensure that
      the nodes pointed at by head/tail never get gc-unlinked, since
      head/tail are needed to get "back on track" by other nodes that
      are gc-unlinked.  gc-unlinking accounts for much of the
      implementation complexity.
      Since neither unlinking nor gc-unlinking are necessary for
      correctness, there are many implementation choices regarding
      frequency (eagerness) of these operations.  Since volatile
      reads are likely to be much cheaper than CASes, saving CASes by
      unlinking multiple adjacent nodes at a time may be a win.
      gc-unlinking can be performed rarely and still be effective,
      since it is most important that long chains of deleted nodes
      are occasionally broken.
      The actual representation we use is that p.next == p means to
      goto the first node (which in turn is reached by following prev
      pointers from head), and p.next == null &amp;&amp; p.prev == p means
      that the iteration is at an end and that p is a (static final)
      dummy node, NEXT_TERMINATOR, and not the last active node.
      Finishing the iteration when encountering such a TERMINATOR is
      good enough for read-only traversals, so such traversals can use
      p.next == null as the termination condition.  When we need to
      find the last (active) node, for enqueueing a new node, we need
      to check whether we have reached a TERMINATOR node; if so,
      restart traversal from tail.
      The implementation is completely directionally symmetrical,
      except that most public methods that iterate through the list
      follow next pointers ("forward" direction).
      We believe (without full proof) that all single-element deque
      operations (e.g., addFirst, peekLast, pollLast) are linearizable
      (see Herlihy and Shavit's book).  However, some combinations of
      operations are known not to be linearizable.  In particular,
      when an addFirst(A) is racing with pollFirst() removing B, it is
      possible for an observer iterating over the elements to observe
      A B C and subsequently observe A C, even though no interior
      removes are ever performed.  Nevertheless, iterators behave
      reasonably, providing the "weakly consistent" guarantees.
      Empirically, microbenchmarks suggest that this class adds about
      40% overhead relative to ConcurrentLinkedQueue, which feels as
      good as we can hope for.</e></e></div>
<a id="L246" name="L246"></a> 246 
<a id="L247" name="L247"></a> 247     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = 876323262645176354L;
<a id="L248" name="L248"></a> 248 
<div class="comment">
      A node from which the first node on list (that is, the unique node p
      with p.prev == null &amp;&amp; p.next != p) can be reached in O(1) time.
      Invariants:
      - the first node is always O(1) reachable from head via prev links
      - all live nodes are reachable from the first node via succ()
      - head != null
      - (tmp = head).next != tmp || tmp != head
      - head is never gc-unlinked (but may be unlinked)
      Non-invariants:
      - head.item may or may not be null
      - head may not be reachable from the first or last node, or from tail</div>
<a id="L262" name="L262"></a> 262     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <strong class="reserved">volatile</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; head;
<a id="L263" name="L263"></a> 263 
<div class="comment">
      A node from which the last node on list (that is, the unique node p
      with p.next == null &amp;&amp; p.prev != p) can be reached in O(1) time.
      Invariants:
      - the last node is always O(1) reachable from tail via next links
      - all live nodes are reachable from the last node via pred()
      - tail != null
      - tail is never gc-unlinked (but may be unlinked)
      Non-invariants:
      - tail.item may or may not be null
      - tail may not be reachable from the first or last node, or from head</div>
<a id="L276" name="L276"></a> 276     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <strong class="reserved">volatile</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; tail;
<a id="L277" name="L277"></a> 277 
<a id="L278" name="L278"></a> 278     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt; PREV_TERMINATOR, NEXT_TERMINATOR;
<a id="L279" name="L279"></a> 279 
<a id="L280" name="L280"></a> 280     @<a href="../R/7764.html" title="Multiple referred from 264 places.">SuppressWarnings</a>("unchecked")
<a id="L281" name="L281"></a> 281     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/24959.html" title="Multiple referred from 2 places.">prevTerminator</a>() <em class="brace">{</em>
<a id="L282" name="L282"></a> 282         <strong class="reserved">return</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;) PREV_TERMINATOR;
<a id="L283" name="L283"></a> 283     <em class="brace">}</em>
<a id="L284" name="L284"></a> 284 
<a id="L285" name="L285"></a> 285     @<a href="../R/7764.html" title="Multiple referred from 264 places.">SuppressWarnings</a>("unchecked")
<a id="L286" name="L286"></a> 286     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/23701.html" title="Multiple referred from 2 places.">nextTerminator</a>() <em class="brace">{</em>
<a id="L287" name="L287"></a> 287         <strong class="reserved">return</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;) NEXT_TERMINATOR;
<a id="L288" name="L288"></a> 288     <em class="brace">}</em>
<a id="L289" name="L289"></a> 289 
<a id="L290" name="L290"></a> 290     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../R/5542.html" title="Multiple referred from 4060 places.">Node</a>&lt;E&gt; <em class="brace">{</em>
<a id="L291" name="L291"></a> 291         <strong class="reserved">volatile</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; prev;
<a id="L292" name="L292"></a> 292         <strong class="reserved">volatile</strong> E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L293" name="L293"></a> 293         <strong class="reserved">volatile</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L294" name="L294"></a> 294 
<a id="L295" name="L295"></a> 295         Node() <em class="brace">{</em>  <em class="comment">// default constructor for NEXT_TERMINATOR, PREV_TERMINATOR</em>
<a id="L296" name="L296"></a> 296         <em class="brace">}</em>
<a id="L297" name="L297"></a> 297 
<div class="comment">
          Constructs a new node.  Uses relaxed write because item can
          only be seen after publication via casNext or casPrev.</div>
<a id="L302" name="L302"></a> 302         Node(E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>) <em class="brace">{</em>
<a id="L303" name="L303"></a> 303             UNSAFE.putObject(<strong class="reserved">this</strong>, itemOffset, <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L304" name="L304"></a> 304         <em class="brace">}</em>
<a id="L305" name="L305"></a> 305 
<a id="L306" name="L306"></a> 306         <strong class="reserved">boolean</strong> <a href="../R/10984.html" title="Multiple referred from 10 places.">casItem</a>(E cmp, E <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L307" name="L307"></a> 307             <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, itemOffset, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L308" name="L308"></a> 308         <em class="brace">}</em>
<a id="L309" name="L309"></a> 309 
<a id="L310" name="L310"></a> 310         <strong class="reserved">void</strong> <a href="../R/22451.html" title="Multiple referred from 18 places.">lazySetNext</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L311" name="L311"></a> 311             UNSAFE.putOrderedObject(<strong class="reserved">this</strong>, <a href="../D/28171.html" title="Multiple defined in 2 places.">nextOffset</a>, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L312" name="L312"></a> 312         <em class="brace">}</em>
<a id="L313" name="L313"></a> 313 
<a id="L314" name="L314"></a> 314         <strong class="reserved">boolean</strong> <a href="../R/10985.html" title="Multiple referred from 26 places.">casNext</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; cmp, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L315" name="L315"></a> 315             <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, <a href="../D/28171.html" title="Multiple defined in 2 places.">nextOffset</a>, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L316" name="L316"></a> 316         <em class="brace">}</em>
<a id="L317" name="L317"></a> 317 
<a id="L318" name="L318"></a> 318         <strong class="reserved">void</strong> <a href="../R/22452.html" title="Multiple referred from 9 places.">lazySetPrev</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L319" name="L319"></a> 319             UNSAFE.putOrderedObject(<strong class="reserved">this</strong>, prevOffset, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L320" name="L320"></a> 320         <em class="brace">}</em>
<a id="L321" name="L321"></a> 321 
<a id="L322" name="L322"></a> 322         <strong class="reserved">boolean</strong> <a href="../R/10987.html" title="Multiple referred from 3 places.">casPrev</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; cmp, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L323" name="L323"></a> 323             <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, prevOffset, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L324" name="L324"></a> 324         <em class="brace">}</em>
<a id="L325" name="L325"></a> 325 
<a id="L326" name="L326"></a> 326         <em class="comment">// Unsafe mechanics</em>
<a id="L327" name="L327"></a> 327 
<a id="L328" name="L328"></a> 328         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> sun.misc.Unsafe UNSAFE;
<a id="L329" name="L329"></a> 329         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> prevOffset;
<a id="L330" name="L330"></a> 330         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> itemOffset;
<a id="L331" name="L331"></a> 331         <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> <a href="../D/28171.html" title="Multiple defined in 2 places.">nextOffset</a>;
<a id="L332" name="L332"></a> 332 
<a id="L333" name="L333"></a> 333         <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L334" name="L334"></a> 334             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L335" name="L335"></a> 335                 UNSAFE = sun.misc.Unsafe.getUnsafe();
<a id="L336" name="L336"></a> 336                 <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; k = <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>.<strong class="reserved">class</strong>;
<a id="L337" name="L337"></a> 337                 prevOffset = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L338" name="L338"></a> 338                     (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("prev"));
<a id="L339" name="L339"></a> 339                 itemOffset = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L340" name="L340"></a> 340                     (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("item"));
<a id="L341" name="L341"></a> 341                 <a href="../D/28171.html" title="Multiple defined in 2 places.">nextOffset</a> = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L342" name="L342"></a> 342                     (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("next"));
<a id="L343" name="L343"></a> 343             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L344" name="L344"></a> 344                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>(e);
<a id="L345" name="L345"></a> 345             <em class="brace">}</em>
<a id="L346" name="L346"></a> 346         <em class="brace">}</em>
<a id="L347" name="L347"></a> 347     <em class="brace">}</em>
<a id="L348" name="L348"></a> 348 
<div class="comment">
      Links e as first element.</div>
<a id="L352" name="L352"></a> 352     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/22517.html" title="Multiple referred from 6 places.">linkFirst</a>(E e) <em class="brace">{</em>
<a id="L353" name="L353"></a> 353         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(e);
<a id="L354" name="L354"></a> 354         <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(e);
<a id="L355" name="L355"></a> 355 
<a id="L356" name="L356"></a> 356         restartFromHead:
<a id="L357" name="L357"></a> 357         <strong class="reserved">for</strong> (;;)
<a id="L358" name="L358"></a> 358             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = head, p = h, q;;) <em class="brace">{</em>
<a id="L359" name="L359"></a> 359                 <strong class="reserved">if</strong> ((q = p.prev) != <strong class="reserved">null</strong> &amp;&amp;
<a id="L360" name="L360"></a> 360                     (q = (p = q).prev) != <strong class="reserved">null</strong>)
<a id="L361" name="L361"></a> 361                     <em class="comment">// Check for head updates every other hop.</em>
<a id="L362" name="L362"></a> 362                     <em class="comment">// If p == q, we are sure to follow head instead.</em>
<a id="L363" name="L363"></a> 363                     p = (h != (h = head)) ? h : q;
<a id="L364" name="L364"></a> 364                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == p) <em class="comment">// PREV_TERMINATOR</em>
<a id="L365" name="L365"></a> 365                     <strong class="reserved">continue</strong> restartFromHead;
<a id="L366" name="L366"></a> 366                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L367" name="L367"></a> 367                     <em class="comment">// p is first node</em>
<a id="L368" name="L368"></a> 368                     <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(p); <em class="comment">// CAS piggyback</em>
<a id="L369" name="L369"></a> 369                     <strong class="reserved">if</strong> (p.<a href="../S/1076.html#L322" title="Defined at 322 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">casPrev</a>(<strong class="reserved">null</strong>, <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>)) <em class="brace">{</em>
<a id="L370" name="L370"></a> 370                         <em class="comment">// Successful CAS is the linearization point</em>
<a id="L371" name="L371"></a> 371                         <em class="comment">// for e to become an element of this deque,</em>
<a id="L372" name="L372"></a> 372                         <em class="comment">// and for newNode to become "live".</em>
<a id="L373" name="L373"></a> 373                         <strong class="reserved">if</strong> (p != h) <em class="comment">// hop two nodes at a time</em>
<a id="L374" name="L374"></a> 374                             <a href="../D/12261.html" title="Multiple defined in 5 places.">casHead</a>(h, <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);  <em class="comment">// Failure is OK.</em>
<a id="L375" name="L375"></a> 375                         <strong class="reserved">return</strong>;
<a id="L376" name="L376"></a> 376                     <em class="brace">}</em>
<a id="L377" name="L377"></a> 377                     <em class="comment">// Lost CAS race to another thread; re-read prev</em>
<a id="L378" name="L378"></a> 378                 <em class="brace">}</em>
<a id="L379" name="L379"></a> 379             <em class="brace">}</em>
<a id="L380" name="L380"></a> 380     <em class="brace">}</em>
<a id="L381" name="L381"></a> 381 
<div class="comment">
      Links e as last element.</div>
<a id="L385" name="L385"></a> 385     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/22518.html" title="Multiple referred from 11 places.">linkLast</a>(E e) <em class="brace">{</em>
<a id="L386" name="L386"></a> 386         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(e);
<a id="L387" name="L387"></a> 387         <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(e);
<a id="L388" name="L388"></a> 388 
<a id="L389" name="L389"></a> 389         restartFromTail:
<a id="L390" name="L390"></a> 390         <strong class="reserved">for</strong> (;;)
<a id="L391" name="L391"></a> 391             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; t = tail, p = t, q;;) <em class="brace">{</em>
<a id="L392" name="L392"></a> 392                 <strong class="reserved">if</strong> ((q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) != <strong class="reserved">null</strong> &amp;&amp;
<a id="L393" name="L393"></a> 393                     (q = (p = q).<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) != <strong class="reserved">null</strong>)
<a id="L394" name="L394"></a> 394                     <em class="comment">// Check for tail updates every other hop.</em>
<a id="L395" name="L395"></a> 395                     <em class="comment">// If p == q, we are sure to follow tail instead.</em>
<a id="L396" name="L396"></a> 396                     p = (t != (t = tail)) ? t : q;
<a id="L397" name="L397"></a> 397                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p.prev == p) <em class="comment">// NEXT_TERMINATOR</em>
<a id="L398" name="L398"></a> 398                     <strong class="reserved">continue</strong> restartFromTail;
<a id="L399" name="L399"></a> 399                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L400" name="L400"></a> 400                     <em class="comment">// p is last node</em>
<a id="L401" name="L401"></a> 401                     <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(p); <em class="comment">// CAS piggyback</em>
<a id="L402" name="L402"></a> 402                     <strong class="reserved">if</strong> (p.<a href="../D/12263.html" title="Multiple defined in 6 places.">casNext</a>(<strong class="reserved">null</strong>, <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>)) <em class="brace">{</em>
<a id="L403" name="L403"></a> 403                         <em class="comment">// Successful CAS is the linearization point</em>
<a id="L404" name="L404"></a> 404                         <em class="comment">// for e to become an element of this deque,</em>
<a id="L405" name="L405"></a> 405                         <em class="comment">// and for newNode to become "live".</em>
<a id="L406" name="L406"></a> 406                         <strong class="reserved">if</strong> (p != t) <em class="comment">// hop two nodes at a time</em>
<a id="L407" name="L407"></a> 407                             <a href="../D/12271.html" title="Multiple defined in 3 places.">casTail</a>(t, <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);  <em class="comment">// Failure is OK.</em>
<a id="L408" name="L408"></a> 408                         <strong class="reserved">return</strong>;
<a id="L409" name="L409"></a> 409                     <em class="brace">}</em>
<a id="L410" name="L410"></a> 410                     <em class="comment">// Lost CAS race to another thread; re-read next</em>
<a id="L411" name="L411"></a> 411                 <em class="brace">}</em>
<a id="L412" name="L412"></a> 412             <em class="brace">}</em>
<a id="L413" name="L413"></a> 413     <em class="brace">}</em>
<a id="L414" name="L414"></a> 414 
<a id="L415" name="L415"></a> 415     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> HOPS = 2;
<a id="L416" name="L416"></a> 416 
<div class="comment">
      Unlinks non-null node x.</div>
<a id="L420" name="L420"></a> 420     <strong class="reserved">void</strong> <a href="../R/29705.html" title="Multiple referred from 21 places.">unlink</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L421" name="L421"></a> 421         <em class="comment">// assert x != null;</em>
<a id="L422" name="L422"></a> 422         <em class="comment">// assert x.item == null;</em>
<a id="L423" name="L423"></a> 423         <em class="comment">// assert x != PREV_TERMINATOR;</em>
<a id="L424" name="L424"></a> 424         <em class="comment">// assert x != NEXT_TERMINATOR;</em>
<a id="L425" name="L425"></a> 425 
<a id="L426" name="L426"></a> 426         <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; prev = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.prev;
<a id="L427" name="L427"></a> 427         <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L428" name="L428"></a> 428         <strong class="reserved">if</strong> (prev == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L429" name="L429"></a> 429             <a href="../D/35907.html" title="Multiple defined in 3 places.">unlinkFirst</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>);
<a id="L430" name="L430"></a> 430         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L431" name="L431"></a> 431             <a href="../D/35908.html" title="Multiple defined in 3 places.">unlinkLast</a>(<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>, prev);
<a id="L432" name="L432"></a> 432         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L433" name="L433"></a> 433             <em class="comment">// Unlink interior node.</em>
<a id="L434" name="L434"></a> 434             <em class="comment">//</em>
<a id="L435" name="L435"></a> 435             <em class="comment">// This is the common case, since a series of polls at the</em>
<a id="L436" name="L436"></a> 436             <em class="comment">// same end will be "interior" removes, except perhaps for</em>
<a id="L437" name="L437"></a> 437             <em class="comment">// the first one, since end nodes cannot be unlinked.</em>
<a id="L438" name="L438"></a> 438             <em class="comment">//</em>
<a id="L439" name="L439"></a> 439             <em class="comment">// At any time, all active nodes are mutually reachable by</em>
<a id="L440" name="L440"></a> 440             <em class="comment">// following a sequence of either next or prev pointers.</em>
<a id="L441" name="L441"></a> 441             <em class="comment">//</em>
<a id="L442" name="L442"></a> 442             <em class="comment">// Our strategy is to find the unique active predecessor</em>
<a id="L443" name="L443"></a> 443             <em class="comment">// and successor of x.  Try to fix up their links so that</em>
<a id="L444" name="L444"></a> 444             <em class="comment">// they point to each other, leaving x unreachable from</em>
<a id="L445" name="L445"></a> 445             <em class="comment">// active nodes.  If successful, and if x has no live</em>
<a id="L446" name="L446"></a> 446             <em class="comment">// predecessor/successor, we additionally try to gc-unlink,</em>
<a id="L447" name="L447"></a> 447             <em class="comment">// leaving active nodes unreachable from x, by rechecking</em>
<a id="L448" name="L448"></a> 448             <em class="comment">// that the status of predecessor and successor are</em>
<a id="L449" name="L449"></a> 449             <em class="comment">// unchanged and ensuring that x is not reachable from</em>
<a id="L450" name="L450"></a> 450             <em class="comment">// tail/head, before setting x's prev/next links to their</em>
<a id="L451" name="L451"></a> 451             <em class="comment">// logical approximate replacements, self/TERMINATOR.</em>
<a id="L452" name="L452"></a> 452             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; activePred, activeSucc;
<a id="L453" name="L453"></a> 453             <strong class="reserved">boolean</strong> <a href="../S/2602.html#L1082" title="Defined at 1082 in src/java/sql/ResultSet.java.">isFirst</a>, <a href="../S/2602.html#L1103" title="Defined at 1103 in src/java/sql/ResultSet.java.">isLast</a>;
<a id="L454" name="L454"></a> 454             <strong class="reserved">int</strong> hops = 1;
<a id="L455" name="L455"></a> 455 
<a id="L456" name="L456"></a> 456             <em class="comment">// Find active predecessor</em>
<a id="L457" name="L457"></a> 457             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = prev; ; ++hops) <em class="brace">{</em>
<a id="L458" name="L458"></a> 458                 <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L459" name="L459"></a> 459                     activePred = p;
<a id="L460" name="L460"></a> 460                     <a href="../S/2602.html#L1082" title="Defined at 1082 in src/java/sql/ResultSet.java.">isFirst</a> = <strong class="reserved">false</strong>;
<a id="L461" name="L461"></a> 461                     <strong class="reserved">break</strong>;
<a id="L462" name="L462"></a> 462                 <em class="brace">}</em>
<a id="L463" name="L463"></a> 463                 <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = p.prev;
<a id="L464" name="L464"></a> 464                 <strong class="reserved">if</strong> (q == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L465" name="L465"></a> 465                     <strong class="reserved">if</strong> (p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == p)
<a id="L466" name="L466"></a> 466                         <strong class="reserved">return</strong>;
<a id="L467" name="L467"></a> 467                     activePred = p;
<a id="L468" name="L468"></a> 468                     <a href="../S/2602.html#L1082" title="Defined at 1082 in src/java/sql/ResultSet.java.">isFirst</a> = <strong class="reserved">true</strong>;
<a id="L469" name="L469"></a> 469                     <strong class="reserved">break</strong>;
<a id="L470" name="L470"></a> 470                 <em class="brace">}</em>
<a id="L471" name="L471"></a> 471                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L472" name="L472"></a> 472                     <strong class="reserved">return</strong>;
<a id="L473" name="L473"></a> 473                 <strong class="reserved">else</strong>
<a id="L474" name="L474"></a> 474                     p = q;
<a id="L475" name="L475"></a> 475             <em class="brace">}</em>
<a id="L476" name="L476"></a> 476 
<a id="L477" name="L477"></a> 477             <em class="comment">// Find active successor</em>
<a id="L478" name="L478"></a> 478             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>; ; ++hops) <em class="brace">{</em>
<a id="L479" name="L479"></a> 479                 <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L480" name="L480"></a> 480                     activeSucc = p;
<a id="L481" name="L481"></a> 481                     <a href="../S/2602.html#L1103" title="Defined at 1103 in src/java/sql/ResultSet.java.">isLast</a> = <strong class="reserved">false</strong>;
<a id="L482" name="L482"></a> 482                     <strong class="reserved">break</strong>;
<a id="L483" name="L483"></a> 483                 <em class="brace">}</em>
<a id="L484" name="L484"></a> 484                 <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L485" name="L485"></a> 485                 <strong class="reserved">if</strong> (q == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L486" name="L486"></a> 486                     <strong class="reserved">if</strong> (p.prev == p)
<a id="L487" name="L487"></a> 487                         <strong class="reserved">return</strong>;
<a id="L488" name="L488"></a> 488                     activeSucc = p;
<a id="L489" name="L489"></a> 489                     <a href="../S/2602.html#L1103" title="Defined at 1103 in src/java/sql/ResultSet.java.">isLast</a> = <strong class="reserved">true</strong>;
<a id="L490" name="L490"></a> 490                     <strong class="reserved">break</strong>;
<a id="L491" name="L491"></a> 491                 <em class="brace">}</em>
<a id="L492" name="L492"></a> 492                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L493" name="L493"></a> 493                     <strong class="reserved">return</strong>;
<a id="L494" name="L494"></a> 494                 <strong class="reserved">else</strong>
<a id="L495" name="L495"></a> 495                     p = q;
<a id="L496" name="L496"></a> 496             <em class="brace">}</em>
<a id="L497" name="L497"></a> 497 
<a id="L498" name="L498"></a> 498             <em class="comment">// TODO: better HOP heuristics</em>
<a id="L499" name="L499"></a> 499             <strong class="reserved">if</strong> (hops &lt; HOPS
<a id="L500" name="L500"></a> 500                 <em class="comment">// always squeeze out interior deleted nodes</em>
<a id="L501" name="L501"></a> 501                 &amp;&amp; (<a href="../S/2602.html#L1082" title="Defined at 1082 in src/java/sql/ResultSet.java.">isFirst</a> | <a href="../S/2602.html#L1103" title="Defined at 1103 in src/java/sql/ResultSet.java.">isLast</a>))
<a id="L502" name="L502"></a> 502                 <strong class="reserved">return</strong>;
<a id="L503" name="L503"></a> 503 
<a id="L504" name="L504"></a> 504             <em class="comment">// Squeeze out deleted nodes between activePred and</em>
<a id="L505" name="L505"></a> 505             <em class="comment">// activeSucc, including x.</em>
<a id="L506" name="L506"></a> 506             <a href="../S/1076.html#L687" title="Defined at 687 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">skipDeletedSuccessors</a>(activePred);
<a id="L507" name="L507"></a> 507             <a href="../S/1076.html#L656" title="Defined at 656 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">skipDeletedPredecessors</a>(activeSucc);
<a id="L508" name="L508"></a> 508 
<a id="L509" name="L509"></a> 509             <em class="comment">// Try to gc-unlink, if possible</em>
<a id="L510" name="L510"></a> 510             <strong class="reserved">if</strong> ((<a href="../S/2602.html#L1082" title="Defined at 1082 in src/java/sql/ResultSet.java.">isFirst</a> | <a href="../S/2602.html#L1103" title="Defined at 1103 in src/java/sql/ResultSet.java.">isLast</a>) &amp;&amp;
<a id="L511" name="L511"></a> 511 
<a id="L512" name="L512"></a> 512                 <em class="comment">// Recheck expected state of predecessor and successor</em>
<a id="L513" name="L513"></a> 513                 (activePred.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == activeSucc) &amp;&amp;
<a id="L514" name="L514"></a> 514                 (activeSucc.prev == activePred) &amp;&amp;
<a id="L515" name="L515"></a> 515                 (<a href="../S/2602.html#L1082" title="Defined at 1082 in src/java/sql/ResultSet.java.">isFirst</a> ? activePred.prev == <strong class="reserved">null</strong> : activePred.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>) &amp;&amp;
<a id="L516" name="L516"></a> 516                 (<a href="../S/2602.html#L1103" title="Defined at 1103 in src/java/sql/ResultSet.java.">isLast</a>  ? activeSucc.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == <strong class="reserved">null</strong> : activeSucc.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L517" name="L517"></a> 517 
<a id="L518" name="L518"></a> 518                 <a href="../D/36118.html" title="Multiple defined in 2 places.">updateHead</a>(); <em class="comment">// Ensure x is not reachable from head</em>
<a id="L519" name="L519"></a> 519                 <a href="../S/1076.html#L632" title="Defined at 632 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">updateTail</a>(); <em class="comment">// Ensure x is not reachable from tail</em>
<a id="L520" name="L520"></a> 520 
<a id="L521" name="L521"></a> 521                 <em class="comment">// Finally, actually gc-unlink</em>
<a id="L522" name="L522"></a> 522                 <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(<a href="../S/2602.html#L1082" title="Defined at 1082 in src/java/sql/ResultSet.java.">isFirst</a> ? <a href="../S/1076.html#L281" title="Defined at 281 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">prevTerminator</a>() : <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L523" name="L523"></a> 523                 <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../S/2602.html#L1103" title="Defined at 1103 in src/java/sql/ResultSet.java.">isLast</a>  ? <a href="../S/1076.html#L286" title="Defined at 286 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">nextTerminator</a>() : <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>);
<a id="L524" name="L524"></a> 524             <em class="brace">}</em>
<a id="L525" name="L525"></a> 525         <em class="brace">}</em>
<a id="L526" name="L526"></a> 526     <em class="brace">}</em>
<a id="L527" name="L527"></a> 527 
<div class="comment">
      Unlinks non-null first node.</div>
<a id="L531" name="L531"></a> 531     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/29707.html" title="Multiple referred from 9 places.">unlinkFirst</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) <em class="brace">{</em>
<a id="L532" name="L532"></a> 532         <em class="comment">// assert first != null;</em>
<a id="L533" name="L533"></a> 533         <em class="comment">// assert next != null;</em>
<a id="L534" name="L534"></a> 534         <em class="comment">// assert first.item == null;</em>
<a id="L535" name="L535"></a> 535         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> = <strong class="reserved">null</strong>, p = <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>, q;;) <em class="brace">{</em>
<a id="L536" name="L536"></a> 536             <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> || (q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L537" name="L537"></a> 537                 <strong class="reserved">if</strong> (<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> != <strong class="reserved">null</strong> &amp;&amp; p.prev != p &amp;&amp; <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>.<a href="../D/12263.html" title="Multiple defined in 6 places.">casNext</a>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>, p)) <em class="brace">{</em>
<a id="L538" name="L538"></a> 538                     <a href="../S/1076.html#L656" title="Defined at 656 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">skipDeletedPredecessors</a>(p);
<a id="L539" name="L539"></a> 539                     <strong class="reserved">if</strong> (<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>.prev == <strong class="reserved">null</strong> &amp;&amp;
<a id="L540" name="L540"></a> 540                         (p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == <strong class="reserved">null</strong> || p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>) &amp;&amp;
<a id="L541" name="L541"></a> 541                         p.prev == <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>) <em class="brace">{</em>
<a id="L542" name="L542"></a> 542 
<a id="L543" name="L543"></a> 543                         <a href="../D/36118.html" title="Multiple defined in 2 places.">updateHead</a>(); <em class="comment">// Ensure o is not reachable from head</em>
<a id="L544" name="L544"></a> 544                         <a href="../S/1076.html#L632" title="Defined at 632 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">updateTail</a>(); <em class="comment">// Ensure o is not reachable from tail</em>
<a id="L545" name="L545"></a> 545 
<a id="L546" name="L546"></a> 546                         <em class="comment">// Finally, actually gc-unlink</em>
<a id="L547" name="L547"></a> 547                         <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>);
<a id="L548" name="L548"></a> 548                         <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(<a href="../S/1076.html#L281" title="Defined at 281 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">prevTerminator</a>());
<a id="L549" name="L549"></a> 549                     <em class="brace">}</em>
<a id="L550" name="L550"></a> 550                 <em class="brace">}</em>
<a id="L551" name="L551"></a> 551                 <strong class="reserved">return</strong>;
<a id="L552" name="L552"></a> 552             <em class="brace">}</em>
<a id="L553" name="L553"></a> 553             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L554" name="L554"></a> 554                 <strong class="reserved">return</strong>;
<a id="L555" name="L555"></a> 555             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L556" name="L556"></a> 556                 <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> = p;
<a id="L557" name="L557"></a> 557                 p = q;
<a id="L558" name="L558"></a> 558             <em class="brace">}</em>
<a id="L559" name="L559"></a> 559         <em class="brace">}</em>
<a id="L560" name="L560"></a> 560     <em class="brace">}</em>
<a id="L561" name="L561"></a> 561 
<div class="comment">
      Unlinks non-null last node.</div>
<a id="L565" name="L565"></a> 565     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/29708.html" title="Multiple referred from 7 places.">unlinkLast</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; prev) <em class="brace">{</em>
<a id="L566" name="L566"></a> 566         <em class="comment">// assert last != null;</em>
<a id="L567" name="L567"></a> 567         <em class="comment">// assert prev != null;</em>
<a id="L568" name="L568"></a> 568         <em class="comment">// assert last.item == null;</em>
<a id="L569" name="L569"></a> 569         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> = <strong class="reserved">null</strong>, p = prev, q;;) <em class="brace">{</em>
<a id="L570" name="L570"></a> 570             <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> || (q = p.prev) == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L571" name="L571"></a> 571                 <strong class="reserved">if</strong> (<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> != <strong class="reserved">null</strong> &amp;&amp; p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> != p &amp;&amp; <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>.<a href="../S/1076.html#L322" title="Defined at 322 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">casPrev</a>(prev, p)) <em class="brace">{</em>
<a id="L572" name="L572"></a> 572                     <a href="../S/1076.html#L687" title="Defined at 687 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">skipDeletedSuccessors</a>(p);
<a id="L573" name="L573"></a> 573                     <strong class="reserved">if</strong> (<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == <strong class="reserved">null</strong> &amp;&amp;
<a id="L574" name="L574"></a> 574                         (p.prev == <strong class="reserved">null</strong> || p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>) &amp;&amp;
<a id="L575" name="L575"></a> 575                         p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>) <em class="brace">{</em>
<a id="L576" name="L576"></a> 576 
<a id="L577" name="L577"></a> 577                         <a href="../D/36118.html" title="Multiple defined in 2 places.">updateHead</a>(); <em class="comment">// Ensure o is not reachable from head</em>
<a id="L578" name="L578"></a> 578                         <a href="../S/1076.html#L632" title="Defined at 632 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">updateTail</a>(); <em class="comment">// Ensure o is not reachable from tail</em>
<a id="L579" name="L579"></a> 579 
<a id="L580" name="L580"></a> 580                         <em class="comment">// Finally, actually gc-unlink</em>
<a id="L581" name="L581"></a> 581                         <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>);
<a id="L582" name="L582"></a> 582                         <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../S/1076.html#L286" title="Defined at 286 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">nextTerminator</a>());
<a id="L583" name="L583"></a> 583                     <em class="brace">}</em>
<a id="L584" name="L584"></a> 584                 <em class="brace">}</em>
<a id="L585" name="L585"></a> 585                 <strong class="reserved">return</strong>;
<a id="L586" name="L586"></a> 586             <em class="brace">}</em>
<a id="L587" name="L587"></a> 587             <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L588" name="L588"></a> 588                 <strong class="reserved">return</strong>;
<a id="L589" name="L589"></a> 589             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L590" name="L590"></a> 590                 <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> = p;
<a id="L591" name="L591"></a> 591                 p = q;
<a id="L592" name="L592"></a> 592             <em class="brace">}</em>
<a id="L593" name="L593"></a> 593         <em class="brace">}</em>
<a id="L594" name="L594"></a> 594     <em class="brace">}</em>
<a id="L595" name="L595"></a> 595 
<div class="comment">
      Guarantees that any node which was unlinked before a call to
      this method will be unreachable from head after it returns.
      Does not guarantee to eliminate slack, only that head will
      point to a node that was active while this method was running.</div>
<a id="L602" name="L602"></a> 602     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/29877.html" title="Multiple referred from 7 places.">updateHead</a>() <em class="brace">{</em>
<a id="L603" name="L603"></a> 603         <em class="comment">// Either head already points to an active node, or we keep</em>
<a id="L604" name="L604"></a> 604         <em class="comment">// trying to cas it to the first node until it does.</em>
<a id="L605" name="L605"></a> 605         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h, p, q;
<a id="L606" name="L606"></a> 606         restartFromHead:
<a id="L607" name="L607"></a> 607         <strong class="reserved">while</strong> ((h = head).<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> == <strong class="reserved">null</strong> &amp;&amp; (p = h.prev) != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L608" name="L608"></a> 608             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L609" name="L609"></a> 609                 <strong class="reserved">if</strong> ((q = p.prev) == <strong class="reserved">null</strong> ||
<a id="L610" name="L610"></a> 610                     (q = (p = q).prev) == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L611" name="L611"></a> 611                     <em class="comment">// It is possible that p is PREV_TERMINATOR,</em>
<a id="L612" name="L612"></a> 612                     <em class="comment">// but if so, the CAS is guaranteed to fail.</em>
<a id="L613" name="L613"></a> 613                     <strong class="reserved">if</strong> (<a href="../D/12261.html" title="Multiple defined in 5 places.">casHead</a>(h, p))
<a id="L614" name="L614"></a> 614                         <strong class="reserved">return</strong>;
<a id="L615" name="L615"></a> 615                     <strong class="reserved">else</strong>
<a id="L616" name="L616"></a> 616                         <strong class="reserved">continue</strong> restartFromHead;
<a id="L617" name="L617"></a> 617                 <em class="brace">}</em>
<a id="L618" name="L618"></a> 618                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (h != head)
<a id="L619" name="L619"></a> 619                     <strong class="reserved">continue</strong> restartFromHead;
<a id="L620" name="L620"></a> 620                 <strong class="reserved">else</strong>
<a id="L621" name="L621"></a> 621                     p = q;
<a id="L622" name="L622"></a> 622             <em class="brace">}</em>
<a id="L623" name="L623"></a> 623         <em class="brace">}</em>
<a id="L624" name="L624"></a> 624     <em class="brace">}</em>
<a id="L625" name="L625"></a> 625 
<div class="comment">
      Guarantees that any node which was unlinked before a call to
      this method will be unreachable from tail after it returns.
      Does not guarantee to eliminate slack, only that tail will
      point to a node that was active while this method was running.</div>
<a id="L632" name="L632"></a> 632     <strong class="reserved">private</strong> <strong class="reserved">final</strong> <strong class="reserved">void</strong> <a href="../R/29971.html" title="Multiple referred from 3 places.">updateTail</a>() <em class="brace">{</em>
<a id="L633" name="L633"></a> 633         <em class="comment">// Either tail already points to an active node, or we keep</em>
<a id="L634" name="L634"></a> 634         <em class="comment">// trying to cas it to the last node until it does.</em>
<a id="L635" name="L635"></a> 635         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; t, p, q;
<a id="L636" name="L636"></a> 636         restartFromTail:
<a id="L637" name="L637"></a> 637         <strong class="reserved">while</strong> ((t = tail).<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> == <strong class="reserved">null</strong> &amp;&amp; (p = t.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L638" name="L638"></a> 638             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L639" name="L639"></a> 639                 <strong class="reserved">if</strong> ((q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) == <strong class="reserved">null</strong> ||
<a id="L640" name="L640"></a> 640                     (q = (p = q).<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L641" name="L641"></a> 641                     <em class="comment">// It is possible that p is NEXT_TERMINATOR,</em>
<a id="L642" name="L642"></a> 642                     <em class="comment">// but if so, the CAS is guaranteed to fail.</em>
<a id="L643" name="L643"></a> 643                     <strong class="reserved">if</strong> (<a href="../D/12271.html" title="Multiple defined in 3 places.">casTail</a>(t, p))
<a id="L644" name="L644"></a> 644                         <strong class="reserved">return</strong>;
<a id="L645" name="L645"></a> 645                     <strong class="reserved">else</strong>
<a id="L646" name="L646"></a> 646                         <strong class="reserved">continue</strong> restartFromTail;
<a id="L647" name="L647"></a> 647                 <em class="brace">}</em>
<a id="L648" name="L648"></a> 648                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (t != tail)
<a id="L649" name="L649"></a> 649                     <strong class="reserved">continue</strong> restartFromTail;
<a id="L650" name="L650"></a> 650                 <strong class="reserved">else</strong>
<a id="L651" name="L651"></a> 651                     p = q;
<a id="L652" name="L652"></a> 652             <em class="brace">}</em>
<a id="L653" name="L653"></a> 653         <em class="brace">}</em>
<a id="L654" name="L654"></a> 654     <em class="brace">}</em>
<a id="L655" name="L655"></a> 655 
<a id="L656" name="L656"></a> 656     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/28651.html" title="Multiple referred from 2 places.">skipDeletedPredecessors</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L657" name="L657"></a> 657         whileActive:
<a id="L658" name="L658"></a> 658         <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L659" name="L659"></a> 659             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; prev = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.prev;
<a id="L660" name="L660"></a> 660             <em class="comment">// assert prev != null;</em>
<a id="L661" name="L661"></a> 661             <em class="comment">// assert x != NEXT_TERMINATOR;</em>
<a id="L662" name="L662"></a> 662             <em class="comment">// assert x != PREV_TERMINATOR;</em>
<a id="L663" name="L663"></a> 663             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = prev;
<a id="L664" name="L664"></a> 664             findActive:
<a id="L665" name="L665"></a> 665             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L666" name="L666"></a> 666                 <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L667" name="L667"></a> 667                     <strong class="reserved">break</strong> findActive;
<a id="L668" name="L668"></a> 668                 <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = p.prev;
<a id="L669" name="L669"></a> 669                 <strong class="reserved">if</strong> (q == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L670" name="L670"></a> 670                     <strong class="reserved">if</strong> (p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == p)
<a id="L671" name="L671"></a> 671                         <strong class="reserved">continue</strong> whileActive;
<a id="L672" name="L672"></a> 672                     <strong class="reserved">break</strong> findActive;
<a id="L673" name="L673"></a> 673                 <em class="brace">}</em>
<a id="L674" name="L674"></a> 674                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L675" name="L675"></a> 675                     <strong class="reserved">continue</strong> whileActive;
<a id="L676" name="L676"></a> 676                 <strong class="reserved">else</strong>
<a id="L677" name="L677"></a> 677                     p = q;
<a id="L678" name="L678"></a> 678             <em class="brace">}</em>
<a id="L679" name="L679"></a> 679 
<a id="L680" name="L680"></a> 680             <em class="comment">// found active CAS target</em>
<a id="L681" name="L681"></a> 681             <strong class="reserved">if</strong> (prev == p || <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../S/1076.html#L322" title="Defined at 322 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">casPrev</a>(prev, p))
<a id="L682" name="L682"></a> 682                 <strong class="reserved">return</strong>;
<a id="L683" name="L683"></a> 683 
<a id="L684" name="L684"></a> 684         <em class="brace">}</em> <strong class="reserved">while</strong> (<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> || <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == <strong class="reserved">null</strong>);
<a id="L685" name="L685"></a> 685     <em class="brace">}</em>
<a id="L686" name="L686"></a> 686 
<a id="L687" name="L687"></a> 687     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/28652.html" title="Multiple referred from 2 places.">skipDeletedSuccessors</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>) <em class="brace">{</em>
<a id="L688" name="L688"></a> 688         whileActive:
<a id="L689" name="L689"></a> 689         <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L690" name="L690"></a> 690             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L691" name="L691"></a> 691             <em class="comment">// assert next != null;</em>
<a id="L692" name="L692"></a> 692             <em class="comment">// assert x != NEXT_TERMINATOR;</em>
<a id="L693" name="L693"></a> 693             <em class="comment">// assert x != PREV_TERMINATOR;</em>
<a id="L694" name="L694"></a> 694             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L695" name="L695"></a> 695             findActive:
<a id="L696" name="L696"></a> 696             <strong class="reserved">for</strong> (;;) <em class="brace">{</em>
<a id="L697" name="L697"></a> 697                 <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L698" name="L698"></a> 698                     <strong class="reserved">break</strong> findActive;
<a id="L699" name="L699"></a> 699                 <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L700" name="L700"></a> 700                 <strong class="reserved">if</strong> (q == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L701" name="L701"></a> 701                     <strong class="reserved">if</strong> (p.prev == p)
<a id="L702" name="L702"></a> 702                         <strong class="reserved">continue</strong> whileActive;
<a id="L703" name="L703"></a> 703                     <strong class="reserved">break</strong> findActive;
<a id="L704" name="L704"></a> 704                 <em class="brace">}</em>
<a id="L705" name="L705"></a> 705                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == q)
<a id="L706" name="L706"></a> 706                     <strong class="reserved">continue</strong> whileActive;
<a id="L707" name="L707"></a> 707                 <strong class="reserved">else</strong>
<a id="L708" name="L708"></a> 708                     p = q;
<a id="L709" name="L709"></a> 709             <em class="brace">}</em>
<a id="L710" name="L710"></a> 710 
<a id="L711" name="L711"></a> 711             <em class="comment">// found active CAS target</em>
<a id="L712" name="L712"></a> 712             <strong class="reserved">if</strong> (<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == p || <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/12263.html" title="Multiple defined in 6 places.">casNext</a>(<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>, p))
<a id="L713" name="L713"></a> 713                 <strong class="reserved">return</strong>;
<a id="L714" name="L714"></a> 714 
<a id="L715" name="L715"></a> 715         <em class="brace">}</em> <strong class="reserved">while</strong> (<a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> || <a href="../D/37285.html" title="Multiple defined in 2 places.">x</a>.prev == <strong class="reserved">null</strong>);
<a id="L716" name="L716"></a> 716     <em class="brace">}</em>
<a id="L717" name="L717"></a> 717 
<div class="comment">
      Returns the successor of p, or the first node if p.next has been
      linked to self, which will only be true if traversing with a
      stale pointer that is now off the list.</div>
<a id="L723" name="L723"></a> 723     <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/29027.html" title="Multiple referred from 54 places.">succ</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p) <em class="brace">{</em>
<a id="L724" name="L724"></a> 724         <em class="comment">// TODO: should we skip deleted nodes here?</em>
<a id="L725" name="L725"></a> 725         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>;
<a id="L726" name="L726"></a> 726         <strong class="reserved">return</strong> (p == q) ? <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>() : q;
<a id="L727" name="L727"></a> 727     <em class="brace">}</em>
<a id="L728" name="L728"></a> 728 
<div class="comment">
      Returns the predecessor of p, or the last node if p.prev has been
      linked to self, which will only be true if traversing with a
      stale pointer that is now off the list.</div>
<a id="L734" name="L734"></a> 734     <strong class="reserved">final</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/24905.html" title="Multiple referred from 206 places.">pred</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p) <em class="brace">{</em>
<a id="L735" name="L735"></a> 735         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; q = p.prev;
<a id="L736" name="L736"></a> 736         <strong class="reserved">return</strong> (p == q) ? <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>() : q;
<a id="L737" name="L737"></a> 737     <em class="brace">}</em>
<a id="L738" name="L738"></a> 738 
<div class="comment">
      Returns the first node, the unique node p for which:
          p.prev == null &amp;&amp; p.next != p
      The returned node may or may not be logically deleted.
      Guarantees that head is set to the returned node.</div>
<a id="L745" name="L745"></a> 745     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/14628.html" title="Multiple referred from 688 places.">first</a>() <em class="brace">{</em>
<a id="L746" name="L746"></a> 746         restartFromHead:
<a id="L747" name="L747"></a> 747         <strong class="reserved">for</strong> (;;)
<a id="L748" name="L748"></a> 748             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = head, p = h, q;;) <em class="brace">{</em>
<a id="L749" name="L749"></a> 749                 <strong class="reserved">if</strong> ((q = p.prev) != <strong class="reserved">null</strong> &amp;&amp;
<a id="L750" name="L750"></a> 750                     (q = (p = q).prev) != <strong class="reserved">null</strong>)
<a id="L751" name="L751"></a> 751                     <em class="comment">// Check for head updates every other hop.</em>
<a id="L752" name="L752"></a> 752                     <em class="comment">// If p == q, we are sure to follow head instead.</em>
<a id="L753" name="L753"></a> 753                     p = (h != (h = head)) ? h : q;
<a id="L754" name="L754"></a> 754                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == h
<a id="L755" name="L755"></a> 755                          <em class="comment">// It is possible that p is PREV_TERMINATOR,</em>
<a id="L756" name="L756"></a> 756                          <em class="comment">// but if so, the CAS is guaranteed to fail.</em>
<a id="L757" name="L757"></a> 757                          || <a href="../D/12261.html" title="Multiple defined in 5 places.">casHead</a>(h, p))
<a id="L758" name="L758"></a> 758                     <strong class="reserved">return</strong> p;
<a id="L759" name="L759"></a> 759                 <strong class="reserved">else</strong>
<a id="L760" name="L760"></a> 760                     <strong class="reserved">continue</strong> restartFromHead;
<a id="L761" name="L761"></a> 761             <em class="brace">}</em>
<a id="L762" name="L762"></a> 762     <em class="brace">}</em>
<a id="L763" name="L763"></a> 763 
<div class="comment">
      Returns the last node, the unique node p for which:
          p.next == null &amp;&amp; p.prev != p
      The returned node may or may not be logically deleted.
      Guarantees that tail is set to the returned node.</div>
<a id="L770" name="L770"></a> 770     <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/22411.html" title="Multiple referred from 612 places.">last</a>() <em class="brace">{</em>
<a id="L771" name="L771"></a> 771         restartFromTail:
<a id="L772" name="L772"></a> 772         <strong class="reserved">for</strong> (;;)
<a id="L773" name="L773"></a> 773             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; t = tail, p = t, q;;) <em class="brace">{</em>
<a id="L774" name="L774"></a> 774                 <strong class="reserved">if</strong> ((q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) != <strong class="reserved">null</strong> &amp;&amp;
<a id="L775" name="L775"></a> 775                     (q = (p = q).<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) != <strong class="reserved">null</strong>)
<a id="L776" name="L776"></a> 776                     <em class="comment">// Check for tail updates every other hop.</em>
<a id="L777" name="L777"></a> 777                     <em class="comment">// If p == q, we are sure to follow tail instead.</em>
<a id="L778" name="L778"></a> 778                     p = (t != (t = tail)) ? t : q;
<a id="L779" name="L779"></a> 779                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p == t
<a id="L780" name="L780"></a> 780                          <em class="comment">// It is possible that p is NEXT_TERMINATOR,</em>
<a id="L781" name="L781"></a> 781                          <em class="comment">// but if so, the CAS is guaranteed to fail.</em>
<a id="L782" name="L782"></a> 782                          || <a href="../D/12271.html" title="Multiple defined in 3 places.">casTail</a>(t, p))
<a id="L783" name="L783"></a> 783                     <strong class="reserved">return</strong> p;
<a id="L784" name="L784"></a> 784                 <strong class="reserved">else</strong>
<a id="L785" name="L785"></a> 785                     <strong class="reserved">continue</strong> restartFromTail;
<a id="L786" name="L786"></a> 786             <em class="brace">}</em>
<a id="L787" name="L787"></a> 787     <em class="brace">}</em>
<a id="L788" name="L788"></a> 788 
<a id="L789" name="L789"></a> 789     <em class="comment">// Minor convenience utilities</em>
<a id="L790" name="L790"></a> 790 
<div class="comment">
      Throws NullPointerException if argument is null.
      @param v the element</div>
<a id="L796" name="L796"></a> 796     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">void</strong> <a href="../R/11267.html" title="Multiple referred from 30 places.">checkNotNull</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> v) <em class="brace">{</em>
<a id="L797" name="L797"></a> 797         <strong class="reserved">if</strong> (v == <strong class="reserved">null</strong>)
<a id="L798" name="L798"></a> 798             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L799" name="L799"></a> 799     <em class="brace">}</em>
<a id="L800" name="L800"></a> 800 
<div class="comment">
      Returns element unless it is null, in which case throws
      NoSuchElementException.
      @param v the element
      @return the element</div>
<a id="L808" name="L808"></a> 808     <strong class="reserved">private</strong> E <a href="../R/26679.html" title="Multiple referred from 4 places.">screenNullResult</a>(E v) <em class="brace">{</em>
<a id="L809" name="L809"></a> 809         <strong class="reserved">if</strong> (v == <strong class="reserved">null</strong>)
<a id="L810" name="L810"></a> 810             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1128.html#L38" title="Defined at 38 in src/java/util/NoSuchElementException.java.">NoSuchElementException</a>();
<a id="L811" name="L811"></a> 811         <strong class="reserved">return</strong> v;
<a id="L812" name="L812"></a> 812     <em class="brace">}</em>
<a id="L813" name="L813"></a> 813 
<div class="comment">
      Creates an array list and fills it with elements of this list.
      Used by toArray.
      @return the array list</div>
<a id="L820" name="L820"></a> 820     <strong class="reserved">private</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;E&gt; <a href="../R/29215.html" title="Multiple referred from 2 places.">toArrayList</a>() <em class="brace">{</em>
<a id="L821" name="L821"></a> 821         <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;E&gt; <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a> = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;E&gt;();
<a id="L822" name="L822"></a> 822         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L823" name="L823"></a> 823             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L824" name="L824"></a> 824             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L825" name="L825"></a> 825                 <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L826" name="L826"></a> 826         <em class="brace">}</em>
<a id="L827" name="L827"></a> 827         <strong class="reserved">return</strong> <a href="../D/26871.html" title="Multiple defined in 42 places.">list</a>;
<a id="L828" name="L828"></a> 828     <em class="brace">}</em>
<a id="L829" name="L829"></a> 829 
<div class="comment">
      Constructs an empty deque.</div>
<a id="L833" name="L833"></a> 833     <strong class="reserved">public</strong> ConcurrentLinkedDeque() <em class="brace">{</em>
<a id="L834" name="L834"></a> 834         head = tail = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(<strong class="reserved">null</strong>);
<a id="L835" name="L835"></a> 835     <em class="brace">}</em>
<a id="L836" name="L836"></a> 836 
<div class="comment">
      Constructs a deque initially containing the elements of
      the given collection, added in traversal order of the
      collection's iterator.
      @param c the collection of elements to initially contain
      @throws NullPointerException if the specified collection or any
              of its elements are null</div>
<a id="L846" name="L846"></a> 846     <strong class="reserved">public</strong> ConcurrentLinkedDeque(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;? <strong class="reserved">extends</strong> E&gt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L847" name="L847"></a> 847         <em class="comment">// Copy c into a private chain of Nodes</em>
<a id="L848" name="L848"></a> 848         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = <strong class="reserved">null</strong>, t = <strong class="reserved">null</strong>;
<a id="L849" name="L849"></a> 849         <strong class="reserved">for</strong> (E e : <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L850" name="L850"></a> 850             <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(e);
<a id="L851" name="L851"></a> 851             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(e);
<a id="L852" name="L852"></a> 852             <strong class="reserved">if</strong> (h == <strong class="reserved">null</strong>)
<a id="L853" name="L853"></a> 853                 h = t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L854" name="L854"></a> 854             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L855" name="L855"></a> 855                 t.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);
<a id="L856" name="L856"></a> 856                 <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(t);
<a id="L857" name="L857"></a> 857                 t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L858" name="L858"></a> 858             <em class="brace">}</em>
<a id="L859" name="L859"></a> 859         <em class="brace">}</em>
<a id="L860" name="L860"></a> 860         <a href="../S/1076.html#L866" title="Defined at 866 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">initHeadTail</a>(h, t);
<a id="L861" name="L861"></a> 861     <em class="brace">}</em>
<a id="L862" name="L862"></a> 862 
<div class="comment">
      Initializes head and tail, ensuring invariants hold.</div>
<a id="L866" name="L866"></a> 866     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/20587.html" title="Multiple referred from 2 places.">initHeadTail</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; t) <em class="brace">{</em>
<a id="L867" name="L867"></a> 867         <strong class="reserved">if</strong> (h == t) <em class="brace">{</em>
<a id="L868" name="L868"></a> 868             <strong class="reserved">if</strong> (h == <strong class="reserved">null</strong>)
<a id="L869" name="L869"></a> 869                 h = t = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(<strong class="reserved">null</strong>);
<a id="L870" name="L870"></a> 870             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L871" name="L871"></a> 871                 <em class="comment">// Avoid edge case of a single Node with non-null item.</em>
<a id="L872" name="L872"></a> 872                 <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(<strong class="reserved">null</strong>);
<a id="L873" name="L873"></a> 873                 t.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);
<a id="L874" name="L874"></a> 874                 <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(t);
<a id="L875" name="L875"></a> 875                 t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L876" name="L876"></a> 876             <em class="brace">}</em>
<a id="L877" name="L877"></a> 877         <em class="brace">}</em>
<a id="L878" name="L878"></a> 878         head = h;
<a id="L879" name="L879"></a> 879         tail = t;
<a id="L880" name="L880"></a> 880     <em class="brace">}</em>
<a id="L881" name="L881"></a> 881 
<div class="comment">
      Inserts the specified element at the front of this deque.
      As the deque is unbounded, this method will never throw
      {@link IllegalStateException}.
      @throws NullPointerException if the specified element is null</div>
<a id="L889" name="L889"></a> 889     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/9734.html" title="Multiple referred from 11 places.">addFirst</a>(E e) <em class="brace">{</em>
<a id="L890" name="L890"></a> 890         <a href="../D/26856.html" title="Multiple defined in 3 places.">linkFirst</a>(e);
<a id="L891" name="L891"></a> 891     <em class="brace">}</em>
<a id="L892" name="L892"></a> 892 
<div class="comment">
      Inserts the specified element at the end of this deque.
      As the deque is unbounded, this method will never throw
      {@link IllegalStateException}.
      <p>This method is equivalent to {@link #add}.
      @throws NullPointerException if the specified element is null</p></div>
<a id="L902" name="L902"></a> 902     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/9819.html" title="Multiple referred from 19 places.">addLast</a>(E e) <em class="brace">{</em>
<a id="L903" name="L903"></a> 903         <a href="../D/26857.html" title="Multiple defined in 3 places.">linkLast</a>(e);
<a id="L904" name="L904"></a> 904     <em class="brace">}</em>
<a id="L905" name="L905"></a> 905 
<div class="comment">
      Inserts the specified element at the front of this deque.
      As the deque is unbounded, this method will never return <code>false</code>.
      @return <code>true</code> (as specified by {@link Deque#offerFirst})
      @throws NullPointerException if the specified element is null</div>
<a id="L913" name="L913"></a> 913     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/23933.html" title="Multiple referred from 2 places.">offerFirst</a>(E e) <em class="brace">{</em>
<a id="L914" name="L914"></a> 914         <a href="../D/26856.html" title="Multiple defined in 3 places.">linkFirst</a>(e);
<a id="L915" name="L915"></a> 915         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L916" name="L916"></a> 916     <em class="brace">}</em>
<a id="L917" name="L917"></a> 917 
<div class="comment">
      Inserts the specified element at the end of this deque.
      As the deque is unbounded, this method will never return <code>false</code>.
      <p>This method is equivalent to {@link #add}.
      @return <code>true</code> (as specified by {@link Deque#offerLast})
      @throws NullPointerException if the specified element is null</p></div>
<a id="L927" name="L927"></a> 927     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/23934.html" title="Multiple referred from 6 places.">offerLast</a>(E e) <em class="brace">{</em>
<a id="L928" name="L928"></a> 928         <a href="../D/26857.html" title="Multiple defined in 3 places.">linkLast</a>(e);
<a id="L929" name="L929"></a> 929         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L930" name="L930"></a> 930     <em class="brace">}</em>
<a id="L931" name="L931"></a> 931 
<a id="L932" name="L932"></a> 932     <strong class="reserved">public</strong> E <a href="../R/24696.html" title="Multiple referred from 7 places.">peekFirst</a>() <em class="brace">{</em>
<a id="L933" name="L933"></a> 933         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L934" name="L934"></a> 934             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L935" name="L935"></a> 935             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L936" name="L936"></a> 936                 <strong class="reserved">return</strong> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L937" name="L937"></a> 937         <em class="brace">}</em>
<a id="L938" name="L938"></a> 938         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L939" name="L939"></a> 939     <em class="brace">}</em>
<a id="L940" name="L940"></a> 940 
<a id="L941" name="L941"></a> 941     <strong class="reserved">public</strong> E <a href="../R/24698.html" title="Multiple referred from 2 places.">peekLast</a>() <em class="brace">{</em>
<a id="L942" name="L942"></a> 942         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>(); p != <strong class="reserved">null</strong>; p = <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>(p)) <em class="brace">{</em>
<a id="L943" name="L943"></a> 943             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L944" name="L944"></a> 944             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L945" name="L945"></a> 945                 <strong class="reserved">return</strong> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L946" name="L946"></a> 946         <em class="brace">}</em>
<a id="L947" name="L947"></a> 947         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L948" name="L948"></a> 948     <em class="brace">}</em>
<a id="L949" name="L949"></a> 949 
<div class="comment">
      @throws NoSuchElementException {@inheritDoc}</div>
<a id="L953" name="L953"></a> 953     <strong class="reserved">public</strong> E <a href="../R/16600.html" title="Multiple referred from 24 places.">getFirst</a>() <em class="brace">{</em>
<a id="L954" name="L954"></a> 954         <strong class="reserved">return</strong> <a href="../S/1076.html#L808" title="Defined at 808 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">screenNullResult</a>(<a href="../D/29294.html" title="Multiple defined in 5 places.">peekFirst</a>());
<a id="L955" name="L955"></a> 955     <em class="brace">}</em>
<a id="L956" name="L956"></a> 956 
<div class="comment">
      @throws NoSuchElementException {@inheritDoc}</div>
<a id="L960" name="L960"></a> 960     <strong class="reserved">public</strong> E <a href="../R/17269.html" title="Multiple referred from 11 places.">getLast</a>() <em class="brace">{</em>
<a id="L961" name="L961"></a> 961         <strong class="reserved">return</strong> <a href="../S/1076.html#L808" title="Defined at 808 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">screenNullResult</a>(<a href="../D/29296.html" title="Multiple defined in 5 places.">peekLast</a>());
<a id="L962" name="L962"></a> 962     <em class="brace">}</em>
<a id="L963" name="L963"></a> 963 
<a id="L964" name="L964"></a> 964     <strong class="reserved">public</strong> E <a href="../R/24799.html" title="Multiple referred from 12 places.">pollFirst</a>() <em class="brace">{</em>
<a id="L965" name="L965"></a> 965         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L966" name="L966"></a> 966             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L967" name="L967"></a> 967             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> &amp;&amp; p.<a href="../D/12262.html" title="Multiple defined in 4 places.">casItem</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>, <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L968" name="L968"></a> 968                 <a href="../D/35905.html" title="Multiple defined in 7 places.">unlink</a>(p);
<a id="L969" name="L969"></a> 969                 <strong class="reserved">return</strong> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L970" name="L970"></a> 970             <em class="brace">}</em>
<a id="L971" name="L971"></a> 971         <em class="brace">}</em>
<a id="L972" name="L972"></a> 972         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L973" name="L973"></a> 973     <em class="brace">}</em>
<a id="L974" name="L974"></a> 974 
<a id="L975" name="L975"></a> 975     <strong class="reserved">public</strong> E <a href="../R/24801.html" title="Multiple referred from 5 places.">pollLast</a>() <em class="brace">{</em>
<a id="L976" name="L976"></a> 976         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>(); p != <strong class="reserved">null</strong>; p = <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>(p)) <em class="brace">{</em>
<a id="L977" name="L977"></a> 977             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L978" name="L978"></a> 978             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> &amp;&amp; p.<a href="../D/12262.html" title="Multiple defined in 4 places.">casItem</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>, <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L979" name="L979"></a> 979                 <a href="../D/35905.html" title="Multiple defined in 7 places.">unlink</a>(p);
<a id="L980" name="L980"></a> 980                 <strong class="reserved">return</strong> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L981" name="L981"></a> 981             <em class="brace">}</em>
<a id="L982" name="L982"></a> 982         <em class="brace">}</em>
<a id="L983" name="L983"></a> 983         <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L984" name="L984"></a> 984     <em class="brace">}</em>
<a id="L985" name="L985"></a> 985 
<div class="comment">
      @throws NoSuchElementException {@inheritDoc}</div>
<a id="L989" name="L989"></a> 989     <strong class="reserved">public</strong> E <a href="../R/25964.html" title="Multiple referred from 31 places.">removeFirst</a>() <em class="brace">{</em>
<a id="L990" name="L990"></a> 990         <strong class="reserved">return</strong> <a href="../S/1076.html#L808" title="Defined at 808 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">screenNullResult</a>(<a href="../D/29407.html" title="Multiple defined in 15 places.">pollFirst</a>());
<a id="L991" name="L991"></a> 991     <em class="brace">}</em>
<a id="L992" name="L992"></a> 992 
<div class="comment">
      @throws NoSuchElementException {@inheritDoc}</div>
<a id="L996" name="L996"></a> 996     <strong class="reserved">public</strong> E <a href="../S/2110.html#L3013" title="Referred from 3013 in src/java/awt/KeyboardFocusManager.java.">removeLast</a>() <em class="brace">{</em>
<a id="L997" name="L997"></a> 997         <strong class="reserved">return</strong> <a href="../S/1076.html#L808" title="Defined at 808 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">screenNullResult</a>(<a href="../D/29409.html" title="Multiple defined in 15 places.">pollLast</a>());
<a id="L998" name="L998"></a> 998     <em class="brace">}</em>
<a id="L999" name="L999"></a> 999 
<a id="L1000" name="L1000"></a>1000     <em class="comment">// *** Queue and stack methods ***</em>
<a id="L1001" name="L1001"></a>1001 
<div class="comment">
      Inserts the specified element at the tail of this deque.
      As the deque is unbounded, this method will never return <code>false</code>.
      @return <code>true</code> (as specified by {@link Queue#offer})
      @throws NullPointerException if the specified element is null</div>
<a id="L1009" name="L1009"></a>1009     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/23932.html" title="Multiple referred from 17 places.">offer</a>(E e) <em class="brace">{</em>
<a id="L1010" name="L1010"></a>1010         <strong class="reserved">return</strong> <a href="../D/28471.html" title="Multiple defined in 8 places.">offerLast</a>(e);
<a id="L1011" name="L1011"></a>1011     <em class="brace">}</em>
<a id="L1012" name="L1012"></a>1012 
<div class="comment">
      Inserts the specified element at the tail of this deque.
      As the deque is unbounded, this method will never throw
      {@link IllegalStateException} or return <code>false</code>.
      @return <code>true</code> (as specified by {@link Collection#add})
      @throws NullPointerException if the specified element is null</div>
<a id="L1021" name="L1021"></a>1021     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/9592.html" title="Multiple referred from 2612 places.">add</a>(E e) <em class="brace">{</em>
<a id="L1022" name="L1022"></a>1022         <strong class="reserved">return</strong> <a href="../D/28471.html" title="Multiple defined in 8 places.">offerLast</a>(e);
<a id="L1023" name="L1023"></a>1023     <em class="brace">}</em>
<a id="L1024" name="L1024"></a>1024 
<a id="L1025" name="L1025"></a>1025     <strong class="reserved">public</strong> E <a href="../R/24795.html" title="Multiple referred from 51 places.">poll</a>()           <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/29407.html" title="Multiple defined in 15 places.">pollFirst</a>(); <em class="brace">}</em>
<a id="L1026" name="L1026"></a>1026     <strong class="reserved">public</strong> E <a href="../R/24689.html" title="Multiple referred from 168 places.">peek</a>()           <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/29294.html" title="Multiple defined in 5 places.">peekFirst</a>(); <em class="brace">}</em>
<a id="L1027" name="L1027"></a>1027 
<div class="comment">
      @throws NoSuchElementException {@inheritDoc}</div>
<a id="L1031" name="L1031"></a>1031     <strong class="reserved">public</strong> E <a href="../R/25882.html" title="Multiple referred from 1115 places.">remove</a>()         <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/30795.html" title="Multiple defined in 5 places.">removeFirst</a>(); <em class="brace">}</em>
<a id="L1032" name="L1032"></a>1032 
<div class="comment">
      @throws NoSuchElementException {@inheritDoc}</div>
<a id="L1036" name="L1036"></a>1036     <strong class="reserved">public</strong> E <a href="../R/24804.html" title="Multiple referred from 176 places.">pop</a>()            <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/30795.html" title="Multiple defined in 5 places.">removeFirst</a>(); <em class="brace">}</em>
<a id="L1037" name="L1037"></a>1037 
<div class="comment">
      @throws NoSuchElementException {@inheritDoc}</div>
<a id="L1041" name="L1041"></a>1041     <strong class="reserved">public</strong> E <a href="../R/13628.html" title="Multiple referred from 1794 places.">element</a>()        <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/19082.html" title="Multiple defined in 8 places.">getFirst</a>(); <em class="brace">}</em>
<a id="L1042" name="L1042"></a>1042 
<div class="comment">
      @throws NullPointerException {@inheritDoc}</div>
<a id="L1046" name="L1046"></a>1046     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25256.html" title="Multiple referred from 281 places.">push</a>(E e)     <em class="brace">{</em> <a href="../D/10807.html" title="Multiple defined in 6 places.">addFirst</a>(e); <em class="brace">}</em>
<a id="L1047" name="L1047"></a>1047 
<div class="comment">
      Removes the first element <code>e</code> such that
      <code>o.equals(e)</code>, if such an element exists in this deque.
      If the deque does not contain the element, it is unchanged.
      @param o element to be removed from this deque, if present
      @return <code>true</code> if the deque contained the specified element
      @throws NullPointerException if the specified element is null</div>
<a id="L1057" name="L1057"></a>1057     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/25965.html" title="Multiple referred from 3 places.">removeFirstOccurrence</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>) <em class="brace">{</em>
<a id="L1058" name="L1058"></a>1058         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>);
<a id="L1059" name="L1059"></a>1059         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L1060" name="L1060"></a>1060             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1061" name="L1061"></a>1061             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> &amp;&amp; <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>) &amp;&amp; p.<a href="../D/12262.html" title="Multiple defined in 4 places.">casItem</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>, <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L1062" name="L1062"></a>1062                 <a href="../D/35905.html" title="Multiple defined in 7 places.">unlink</a>(p);
<a id="L1063" name="L1063"></a>1063                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1064" name="L1064"></a>1064             <em class="brace">}</em>
<a id="L1065" name="L1065"></a>1065         <em class="brace">}</em>
<a id="L1066" name="L1066"></a>1066         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1067" name="L1067"></a>1067     <em class="brace">}</em>
<a id="L1068" name="L1068"></a>1068 
<div class="comment">
      Removes the last element <code>e</code> such that
      <code>o.equals(e)</code>, if such an element exists in this deque.
      If the deque does not contain the element, it is unchanged.
      @param o element to be removed from this deque, if present
      @return <code>true</code> if the deque contained the specified element
      @throws NullPointerException if the specified element is null</div>
<a id="L1078" name="L1078"></a>1078     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> removeLastOccurrence(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>) <em class="brace">{</em>
<a id="L1079" name="L1079"></a>1079         <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>);
<a id="L1080" name="L1080"></a>1080         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>(); p != <strong class="reserved">null</strong>; p = <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>(p)) <em class="brace">{</em>
<a id="L1081" name="L1081"></a>1081             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1082" name="L1082"></a>1082             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> &amp;&amp; <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>) &amp;&amp; p.<a href="../D/12262.html" title="Multiple defined in 4 places.">casItem</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>, <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L1083" name="L1083"></a>1083                 <a href="../D/35905.html" title="Multiple defined in 7 places.">unlink</a>(p);
<a id="L1084" name="L1084"></a>1084                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1085" name="L1085"></a>1085             <em class="brace">}</em>
<a id="L1086" name="L1086"></a>1086         <em class="brace">}</em>
<a id="L1087" name="L1087"></a>1087         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1088" name="L1088"></a>1088     <em class="brace">}</em>
<a id="L1089" name="L1089"></a>1089 
<div class="comment">
      Returns <code>true</code> if this deque contains at least one
      element <code>e</code> such that <code>o.equals(e)</code>.
      @param o element whose presence in this deque is to be tested
      @return <code>true</code> if this deque contains the specified element</div>
<a id="L1097" name="L1097"></a>1097     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/11949.html" title="Multiple referred from 682 places.">contains</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>) <em class="brace">{</em>
<a id="L1098" name="L1098"></a>1098         <strong class="reserved">if</strong> (<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a> == <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1099" name="L1099"></a>1099         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L1100" name="L1100"></a>1100             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1101" name="L1101"></a>1101             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong> &amp;&amp; <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>))
<a id="L1102" name="L1102"></a>1102                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1103" name="L1103"></a>1103         <em class="brace">}</em>
<a id="L1104" name="L1104"></a>1104         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1105" name="L1105"></a>1105     <em class="brace">}</em>
<a id="L1106" name="L1106"></a>1106 
<div class="comment">
      Returns <code>true</code> if this collection contains no elements.
      @return <code>true</code> if this collection contains no elements</div>
<a id="L1112" name="L1112"></a>1112     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/21404.html" title="Multiple referred from 435 places.">isEmpty</a>() <em class="brace">{</em>
<a id="L1113" name="L1113"></a>1113         <strong class="reserved">return</strong> <a href="../D/29294.html" title="Multiple defined in 5 places.">peekFirst</a>() == <strong class="reserved">null</strong>;
<a id="L1114" name="L1114"></a>1114     <em class="brace">}</em>
<a id="L1115" name="L1115"></a>1115 
<div class="comment">
      Returns the number of elements in this deque.  If this deque
      contains more than <code>Integer.MAX_VALUE</code> elements, it
      returns <code>Integer.MAX_VALUE</code>.
      <p>Beware that, unlike in most collections, this method is
      <em>NOT</em> a constant-time operation. Because of the
      asynchronous nature of these deques, determining the current
      number of elements requires traversing them all to count them.
      Additionally, it is possible for the size to change during
      execution of this method, in which case the returned result
      will be inaccurate. Thus, this method is typically not very
      useful in concurrent applications.
      @return the number of elements in this deque</p></div>
<a id="L1132" name="L1132"></a>1132     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/28639.html" title="Multiple referred from 5617 places.">size</a>() <em class="brace">{</em>
<a id="L1133" name="L1133"></a>1133         <strong class="reserved">int</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> = 0;
<a id="L1134" name="L1134"></a>1134         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p))
<a id="L1135" name="L1135"></a>1135             <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L1136" name="L1136"></a>1136                 <em class="comment">// Collection.size() spec says to max out</em>
<a id="L1137" name="L1137"></a>1137                 <strong class="reserved">if</strong> (++<a href="../D/13557.html" title="Multiple defined in 24 places.">count</a> == <a href="../D/4299.html" title="Multiple defined in 4 places.">Integer</a>.MAX_VALUE)
<a id="L1138" name="L1138"></a>1138                     <strong class="reserved">break</strong>;
<a id="L1139" name="L1139"></a>1139         <strong class="reserved">return</strong> <a href="../D/13557.html" title="Multiple defined in 24 places.">count</a>;
<a id="L1140" name="L1140"></a>1140     <em class="brace">}</em>
<a id="L1141" name="L1141"></a>1141 
<div class="comment">
      Removes the first element <code>e</code> such that
      <code>o.equals(e)</code>, if such an element exists in this deque.
      If the deque does not contain the element, it is unchanged.
      @param o element to be removed from this deque, if present
      @return <code>true</code> if the deque contained the specified element
      @throws NullPointerException if the specified element is null</div>
<a id="L1151" name="L1151"></a>1151     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/25882.html" title="Multiple referred from 1115 places.">remove</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>) <em class="brace">{</em>
<a id="L1152" name="L1152"></a>1152         <strong class="reserved">return</strong> <a href="../D/30796.html" title="Multiple defined in 6 places.">removeFirstOccurrence</a>(<a href="../S/986.html#L3177" title="Defined at 3177 in src/java/util/regex/Pattern.java.">o</a>);
<a id="L1153" name="L1153"></a>1153     <em class="brace">}</em>
<a id="L1154" name="L1154"></a>1154 
<div class="comment">
      Appends all of the elements in the specified collection to the end of
      this deque, in the order that they are returned by the specified
      collection's iterator.  Attempts to <code>addAll</code> of a deque to
      itself result in <code>IllegalArgumentException</code>.
      @param c the elements to be inserted into this deque
      @return <code>true</code> if this deque changed as a result of the call
      @throws NullPointerException if the specified collection or any
              of its elements are null
      @throws IllegalArgumentException if the collection is this deque</div>
<a id="L1167" name="L1167"></a>1167     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/9603.html" title="Multiple referred from 145 places.">addAll</a>(<a href="../S/875.html#L144" title="Defined at 144 in src/java/util/Collection.java.">Collection</a>&lt;? <strong class="reserved">extends</strong> E&gt; <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L1168" name="L1168"></a>1168         <strong class="reserved">if</strong> (<a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a> == <strong class="reserved">this</strong>)
<a id="L1169" name="L1169"></a>1169             <em class="comment">// As historically specified in AbstractQueue#addAll</em>
<a id="L1170" name="L1170"></a>1170             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../D/4055.html" title="Multiple defined in 2 places.">IllegalArgumentException</a>();
<a id="L1171" name="L1171"></a>1171 
<a id="L1172" name="L1172"></a>1172         <em class="comment">// Copy c into a private chain of Nodes</em>
<a id="L1173" name="L1173"></a>1173         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; beginningOfTheEnd = <strong class="reserved">null</strong>, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = <strong class="reserved">null</strong>;
<a id="L1174" name="L1174"></a>1174         <strong class="reserved">for</strong> (E e : <a href="../S/986.html#L3167" title="Defined at 3167 in src/java/util/regex/Pattern.java.">c</a>) <em class="brace">{</em>
<a id="L1175" name="L1175"></a>1175             <a href="../D/12564.html" title="Multiple defined in 5 places.">checkNotNull</a>(e);
<a id="L1176" name="L1176"></a>1176             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;(e);
<a id="L1177" name="L1177"></a>1177             <strong class="reserved">if</strong> (beginningOfTheEnd == <strong class="reserved">null</strong>)
<a id="L1178" name="L1178"></a>1178                 beginningOfTheEnd = <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L1179" name="L1179"></a>1179             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1180" name="L1180"></a>1180                 <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);
<a id="L1181" name="L1181"></a>1181                 <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>);
<a id="L1182" name="L1182"></a>1182                 <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L1183" name="L1183"></a>1183             <em class="brace">}</em>
<a id="L1184" name="L1184"></a>1184         <em class="brace">}</em>
<a id="L1185" name="L1185"></a>1185         <strong class="reserved">if</strong> (beginningOfTheEnd == <strong class="reserved">null</strong>)
<a id="L1186" name="L1186"></a>1186             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1187" name="L1187"></a>1187 
<a id="L1188" name="L1188"></a>1188         <em class="comment">// Atomically append the chain at the tail of this collection</em>
<a id="L1189" name="L1189"></a>1189         restartFromTail:
<a id="L1190" name="L1190"></a>1190         <strong class="reserved">for</strong> (;;)
<a id="L1191" name="L1191"></a>1191             <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; t = tail, p = t, q;;) <em class="brace">{</em>
<a id="L1192" name="L1192"></a>1192                 <strong class="reserved">if</strong> ((q = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) != <strong class="reserved">null</strong> &amp;&amp;
<a id="L1193" name="L1193"></a>1193                     (q = (p = q).<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>) != <strong class="reserved">null</strong>)
<a id="L1194" name="L1194"></a>1194                     <em class="comment">// Check for tail updates every other hop.</em>
<a id="L1195" name="L1195"></a>1195                     <em class="comment">// If p == q, we are sure to follow tail instead.</em>
<a id="L1196" name="L1196"></a>1196                     p = (t != (t = tail)) ? t : q;
<a id="L1197" name="L1197"></a>1197                 <strong class="reserved">else</strong> <strong class="reserved">if</strong> (p.prev == p) <em class="comment">// NEXT_TERMINATOR</em>
<a id="L1198" name="L1198"></a>1198                     <strong class="reserved">continue</strong> restartFromTail;
<a id="L1199" name="L1199"></a>1199                 <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1200" name="L1200"></a>1200                     <em class="comment">// p is last node</em>
<a id="L1201" name="L1201"></a>1201                     beginningOfTheEnd.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(p); <em class="comment">// CAS piggyback</em>
<a id="L1202" name="L1202"></a>1202                     <strong class="reserved">if</strong> (p.<a href="../D/12263.html" title="Multiple defined in 6 places.">casNext</a>(<strong class="reserved">null</strong>, beginningOfTheEnd)) <em class="brace">{</em>
<a id="L1203" name="L1203"></a>1203                         <em class="comment">// Successful CAS is the linearization point</em>
<a id="L1204" name="L1204"></a>1204                         <em class="comment">// for all elements to be added to this deque.</em>
<a id="L1205" name="L1205"></a>1205                         <strong class="reserved">if</strong> (!<a href="../D/12271.html" title="Multiple defined in 3 places.">casTail</a>(t, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>)) <em class="brace">{</em>
<a id="L1206" name="L1206"></a>1206                             <em class="comment">// Try a little harder to update tail,</em>
<a id="L1207" name="L1207"></a>1207                             <em class="comment">// since we may be adding many elements.</em>
<a id="L1208" name="L1208"></a>1208                             t = tail;
<a id="L1209" name="L1209"></a>1209                             <strong class="reserved">if</strong> (<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> == <strong class="reserved">null</strong>)
<a id="L1210" name="L1210"></a>1210                                 <a href="../D/12271.html" title="Multiple defined in 3 places.">casTail</a>(t, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>);
<a id="L1211" name="L1211"></a>1211                         <em class="brace">}</em>
<a id="L1212" name="L1212"></a>1212                         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1213" name="L1213"></a>1213                     <em class="brace">}</em>
<a id="L1214" name="L1214"></a>1214                     <em class="comment">// Lost CAS race to another thread; re-read next</em>
<a id="L1215" name="L1215"></a>1215                 <em class="brace">}</em>
<a id="L1216" name="L1216"></a>1216             <em class="brace">}</em>
<a id="L1217" name="L1217"></a>1217     <em class="brace">}</em>
<a id="L1218" name="L1218"></a>1218 
<div class="comment">
      Removes all of the elements from this deque.</div>
<a id="L1222" name="L1222"></a>1222     <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/11497.html" title="Multiple referred from 522 places.">clear</a>() <em class="brace">{</em>
<a id="L1223" name="L1223"></a>1223         <strong class="reserved">while</strong> (<a href="../D/29407.html" title="Multiple defined in 15 places.">pollFirst</a>() != <strong class="reserved">null</strong>)
<a id="L1224" name="L1224"></a>1224             ;
<a id="L1225" name="L1225"></a>1225     <em class="brace">}</em>
<a id="L1226" name="L1226"></a>1226 
<div class="comment">
      Returns an array containing all of the elements in this deque, in
      proper sequence (from first to last element).
      <p>The returned array will be "safe" in that no references to it are
      maintained by this deque.  (In other words, this method must allocate
      a new array).  The caller is thus free to modify the returned array.
      </p><p>This method acts as bridge between array-based and collection-based
      APIs.
      @return an array containing all of the elements in this deque</p></div>
<a id="L1240" name="L1240"></a>1240     <strong class="reserved">public</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <a href="../R/29213.html" title="Multiple referred from 289 places.">toArray</a>() <em class="brace">{</em>
<a id="L1241" name="L1241"></a>1241         <strong class="reserved">return</strong> <a href="../S/1076.html#L820" title="Defined at 820 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">toArrayList</a>().<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>();
<a id="L1242" name="L1242"></a>1242     <em class="brace">}</em>
<a id="L1243" name="L1243"></a>1243 
<div class="comment">
      Returns an array containing all of the elements in this deque,
      in proper sequence (from first to last element); the runtime
      type of the returned array is that of the specified array.  If
      the deque fits in the specified array, it is returned therein.
      Otherwise, a new array is allocated with the runtime type of
      the specified array and the size of this deque.
      <p>If this deque fits in the specified array with room to spare
      (i.e., the array has more elements than this deque), the element in
      the array immediately following the end of the deque is set to
      <code>null</code>.
      </p><p>Like the {@link #toArray()} method, this method acts as
      bridge between array-based and collection-based APIs.  Further,
      this method allows precise control over the runtime type of the
      output array, and may, under certain circumstances, be used to
      save allocation costs.
      </p><p>Suppose <code>x</code> is a deque known to contain only strings.
      The following code can be used to dump the deque into a newly
      allocated array of <code>String</code>:
       </p><pre> <code>String[] y = x.toArray(new String[0]);</code></pre>
      Note that <code>toArray(new Object[0])</code> is identical in function to
      <code>toArray()</code>.
      @param a the array into which the elements of the deque are to
               be stored, if it is big enough; otherwise, a new array of the
               same runtime type is allocated for this purpose
      @return an array containing all of the elements in this deque
      @throws ArrayStoreException if the runtime type of the specified array
              is not a supertype of the runtime type of every element in
              this deque
      @throws NullPointerException if the specified array is null</div>
<a id="L1281" name="L1281"></a>1281     <strong class="reserved">public</strong> &lt;<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>&gt; <a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>[] <a href="../R/29213.html" title="Multiple referred from 289 places.">toArray</a>(<a href="../D/8701.html" title="Multiple defined in 3 places.">T</a>[] <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>) <em class="brace">{</em>
<a id="L1282" name="L1282"></a>1282         <strong class="reserved">return</strong> <a href="../S/1076.html#L820" title="Defined at 820 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">toArrayList</a>().<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>(<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>);
<a id="L1283" name="L1283"></a>1283     <em class="brace">}</em>
<a id="L1284" name="L1284"></a>1284 
<div class="comment">
      Returns an iterator over the elements in this deque in proper sequence.
      The elements will be returned in order from first (head) to last (tail).
      <p>The returned iterator is
      <a href="package-summary.html#Weakly"><i>weakly consistent</i></a>.
      @return an iterator over the elements in this deque in proper sequence</p></div>
<a id="L1294" name="L1294"></a>1294     <strong class="reserved">public</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;E&gt; <a href="../R/22304.html" title="Multiple referred from 905 places.">iterator</a>() <em class="brace">{</em>
<a id="L1295" name="L1295"></a>1295         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/4466.html" title="Multiple defined in 13 places.">Itr</a>();
<a id="L1296" name="L1296"></a>1296     <em class="brace">}</em>
<a id="L1297" name="L1297"></a>1297 
<div class="comment">
      Returns an iterator over the elements in this deque in reverse
      sequential order.  The elements will be returned in order from
      last (tail) to first (head).
      <p>The returned iterator is
      <a href="package-summary.html#Weakly"><i>weakly consistent</i></a>.
      @return an iterator over the elements in this deque in reverse order</p></div>
<a id="L1308" name="L1308"></a>1308     <strong class="reserved">public</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;E&gt; descendingIterator() <em class="brace">{</em>
<a id="L1309" name="L1309"></a>1309         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../D/2397.html" title="Multiple defined in 2 places.">DescendingItr</a>();
<a id="L1310" name="L1310"></a>1310     <em class="brace">}</em>
<a id="L1311" name="L1311"></a>1311 
<a id="L1312" name="L1312"></a>1312     <strong class="reserved">private</strong> <strong class="reserved">abstract</strong> <strong class="reserved">class</strong> <a href="../R/90.html" title="Multiple referred from 4 places.">AbstractItr</a> <strong class="reserved">implements</strong> <a href="../D/4461.html" title="Multiple defined in 3 places.">Iterator</a>&lt;E&gt; <em class="brace">{</em>
<div class="comment">
          Next node to return item for.</div>
<a id="L1316" name="L1316"></a>1316         <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>;
<a id="L1317" name="L1317"></a>1317 
<div class="comment">
          nextItem holds on to item fields because once we claim
          that an element exists in hasNext(), we must return it in
          the following next() call even if it was in the process of
          being removed when hasNext() was called.</div>
<a id="L1324" name="L1324"></a>1324         <strong class="reserved">private</strong> E nextItem;
<a id="L1325" name="L1325"></a>1325 
<div class="comment">
          Node returned by most recent call to next. Needed by remove.
          Reset to null if this element is deleted by a call to remove.</div>
<a id="L1330" name="L1330"></a>1330         <strong class="reserved">private</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; lastRet;
<a id="L1331" name="L1331"></a>1331 
<a id="L1332" name="L1332"></a>1332         <strong class="reserved">abstract</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/28833.html" title="Multiple referred from 58 places.">startNode</a>();
<a id="L1333" name="L1333"></a>1333         <strong class="reserved">abstract</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/23682.html" title="Multiple referred from 192 places.">nextNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p);
<a id="L1334" name="L1334"></a>1334 
<a id="L1335" name="L1335"></a>1335         AbstractItr() <em class="brace">{</em>
<a id="L1336" name="L1336"></a>1336             <a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>();
<a id="L1337" name="L1337"></a>1337         <em class="brace">}</em>
<a id="L1338" name="L1338"></a>1338 
<div class="comment">
          Sets nextNode and nextItem to next valid node, or to null
          if no such.</div>
<a id="L1343" name="L1343"></a>1343         <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/10102.html" title="Multiple referred from 119 places.">advance</a>() <em class="brace">{</em>
<a id="L1344" name="L1344"></a>1344             lastRet = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>;
<a id="L1345" name="L1345"></a>1345 
<a id="L1346" name="L1346"></a>1346             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = (<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> == <strong class="reserved">null</strong>) ? <a href="../D/34804.html" title="Multiple defined in 6 places.">startNode</a>() : <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>(<a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>);
<a id="L1347" name="L1347"></a>1347             <strong class="reserved">for</strong> (;; p = <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a>(p)) <em class="brace">{</em>
<a id="L1348" name="L1348"></a>1348                 <strong class="reserved">if</strong> (p == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1349" name="L1349"></a>1349                     <em class="comment">// p might be active end or TERMINATOR node; both are OK</em>
<a id="L1350" name="L1350"></a>1350                     <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> = <strong class="reserved">null</strong>;
<a id="L1351" name="L1351"></a>1351                     nextItem = <strong class="reserved">null</strong>;
<a id="L1352" name="L1352"></a>1352                     <strong class="reserved">break</strong>;
<a id="L1353" name="L1353"></a>1353                 <em class="brace">}</em>
<a id="L1354" name="L1354"></a>1354                 E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1355" name="L1355"></a>1355                 <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1356" name="L1356"></a>1356                     <a href="../D/28170.html" title="Multiple defined in 34 places.">nextNode</a> = p;
<a id="L1357" name="L1357"></a>1357                     nextItem = <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1358" name="L1358"></a>1358                     <strong class="reserved">break</strong>;
<a id="L1359" name="L1359"></a>1359                 <em class="brace">}</em>
<a id="L1360" name="L1360"></a>1360             <em class="brace">}</em>
<a id="L1361" name="L1361"></a>1361         <em class="brace">}</em>
<a id="L1362" name="L1362"></a>1362 
<a id="L1363" name="L1363"></a>1363         <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/20233.html" title="Multiple referred from 653 places.">hasNext</a>() <em class="brace">{</em>
<a id="L1364" name="L1364"></a>1364             <strong class="reserved">return</strong> nextItem != <strong class="reserved">null</strong>;
<a id="L1365" name="L1365"></a>1365         <em class="brace">}</em>
<a id="L1366" name="L1366"></a>1366 
<a id="L1367" name="L1367"></a>1367         <strong class="reserved">public</strong> E <a href="../R/23650.html" title="Multiple referred from 3301 places.">next</a>() <em class="brace">{</em>
<a id="L1368" name="L1368"></a>1368             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = nextItem;
<a id="L1369" name="L1369"></a>1369             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> == <strong class="reserved">null</strong>) <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1128.html#L38" title="Defined at 38 in src/java/util/NoSuchElementException.java.">NoSuchElementException</a>();
<a id="L1370" name="L1370"></a>1370             <a href="../D/11249.html" title="Multiple defined in 12 places.">advance</a>();
<a id="L1371" name="L1371"></a>1371             <strong class="reserved">return</strong> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1372" name="L1372"></a>1372         <em class="brace">}</em>
<a id="L1373" name="L1373"></a>1373 
<a id="L1374" name="L1374"></a>1374         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/25882.html" title="Multiple referred from 1115 places.">remove</a>() <em class="brace">{</em>
<a id="L1375" name="L1375"></a>1375             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; l = lastRet;
<a id="L1376" name="L1376"></a>1376             <strong class="reserved">if</strong> (l == <strong class="reserved">null</strong>) <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1555.html#L38" title="Defined at 38 in src/java/lang/IllegalStateException.java.">IllegalStateException</a>();
<a id="L1377" name="L1377"></a>1377             l.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = <strong class="reserved">null</strong>;
<a id="L1378" name="L1378"></a>1378             <a href="../D/35905.html" title="Multiple defined in 7 places.">unlink</a>(l);
<a id="L1379" name="L1379"></a>1379             lastRet = <strong class="reserved">null</strong>;
<a id="L1380" name="L1380"></a>1380         <em class="brace">}</em>
<a id="L1381" name="L1381"></a>1381     <em class="brace">}</em>
<a id="L1382" name="L1382"></a>1382 
<div class="comment">
     /** Forward iterator */</div>
<a id="L1384" name="L1384"></a>1384     <strong class="reserved">private</strong> <strong class="reserved">class</strong> <a href="../R/4056.html" title="Multiple referred from 24 places.">Itr</a> <strong class="reserved">extends</strong> <a href="../D/101.html" title="Multiple defined in 2 places.">AbstractItr</a> <em class="brace">{</em>
<a id="L1385" name="L1385"></a>1385         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/28833.html" title="Multiple referred from 58 places.">startNode</a>() <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); <em class="brace">}</em>
<a id="L1386" name="L1386"></a>1386         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/23682.html" title="Multiple referred from 192 places.">nextNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p) <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p); <em class="brace">}</em>
<a id="L1387" name="L1387"></a>1387     <em class="brace">}</em>
<a id="L1388" name="L1388"></a>1388 
<div class="comment">
     /** Descending iterator */</div>
<a id="L1390" name="L1390"></a>1390     <strong class="reserved">private</strong> <strong class="reserved">class</strong> <a href="../R/2206.html" title="Multiple referred from 2 places.">DescendingItr</a> <strong class="reserved">extends</strong> <a href="../D/101.html" title="Multiple defined in 2 places.">AbstractItr</a> <em class="brace">{</em>
<a id="L1391" name="L1391"></a>1391         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/28833.html" title="Multiple referred from 58 places.">startNode</a>() <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>(); <em class="brace">}</em>
<a id="L1392" name="L1392"></a>1392         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../R/23682.html" title="Multiple referred from 192 places.">nextNode</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p) <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../S/1076.html#L734" title="Defined at 734 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">pred</a>(p); <em class="brace">}</em>
<a id="L1393" name="L1393"></a>1393     <em class="brace">}</em>
<a id="L1394" name="L1394"></a>1394 
<div class="comment">
     /** A customized variant of Spliterators.IteratorSpliterator */</div>
<a id="L1396" name="L1396"></a>1396     <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">class</strong> <a href="../S/1076.html#L1501" title="Referred from 1501 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">CLDSpliterator</a>&lt;E&gt; <strong class="reserved">implements</strong> <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>&lt;E&gt; <em class="brace">{</em>
<a id="L1397" name="L1397"></a>1397         <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">int</strong> MAX_BATCH = 1 &lt;&lt; 25;  <em class="comment">// max batch array size;</em>
<a id="L1398" name="L1398"></a>1398         <strong class="reserved">final</strong> <a href="../S/1076.html#L92" title="Defined at 92 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">ConcurrentLinkedDeque</a>&lt;E&gt; queue;
<a id="L1399" name="L1399"></a>1399         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>;    <em class="comment">// current node; null until initialized</em>
<a id="L1400" name="L1400"></a>1400         <strong class="reserved">int</strong> batch;          <em class="comment">// batch size for splits</em>
<a id="L1401" name="L1401"></a>1401         <strong class="reserved">boolean</strong> exhausted;  <em class="comment">// true when no more nodes</em>
<a id="L1402" name="L1402"></a>1402         CLDSpliterator(<a href="../S/1076.html#L92" title="Defined at 92 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">ConcurrentLinkedDeque</a>&lt;E&gt; queue) <em class="brace">{</em>
<a id="L1403" name="L1403"></a>1403             <strong class="reserved">this</strong>.queue = queue;
<a id="L1404" name="L1404"></a>1404         <em class="brace">}</em>
<a id="L1405" name="L1405"></a>1405 
<a id="L1406" name="L1406"></a>1406         <strong class="reserved">public</strong> <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>&lt;E&gt; <a href="../R/29563.html" title="Multiple referred from 18 places.">trySplit</a>() <em class="brace">{</em>
<a id="L1407" name="L1407"></a>1407             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p;
<a id="L1408" name="L1408"></a>1408             <strong class="reserved">final</strong> <a href="../S/1076.html#L92" title="Defined at 92 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">ConcurrentLinkedDeque</a>&lt;E&gt; q = <strong class="reserved">this</strong>.queue;
<a id="L1409" name="L1409"></a>1409             <strong class="reserved">int</strong> b = batch;
<a id="L1410" name="L1410"></a>1410             <strong class="reserved">int</strong> n = (b &lt;= 0) ? 1 : (b &gt;= MAX_BATCH) ? MAX_BATCH : b + 1;
<a id="L1411" name="L1411"></a>1411             <strong class="reserved">if</strong> (!exhausted &amp;&amp;
<a id="L1412" name="L1412"></a>1412                 ((p = <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>) != <strong class="reserved">null</strong> || (p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>()) != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L1413" name="L1413"></a>1413                 <strong class="reserved">if</strong> (p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> == <strong class="reserved">null</strong> &amp;&amp; p == (p = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>))
<a id="L1414" name="L1414"></a>1414                     <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a> = p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L1415" name="L1415"></a>1415                 <strong class="reserved">if</strong> (p != <strong class="reserved">null</strong> &amp;&amp; p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1416" name="L1416"></a>1416                     <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[] <a href="../D/10513.html" title="Multiple defined in 3 places.">a</a> = <strong class="reserved">new</strong> <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>[n];
<a id="L1417" name="L1417"></a>1417                     <strong class="reserved">int</strong> i = 0;
<a id="L1418" name="L1418"></a>1418                     <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L1419" name="L1419"></a>1419                         <strong class="reserved">if</strong> ((<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>[i] = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>) != <strong class="reserved">null</strong>)
<a id="L1420" name="L1420"></a>1420                             ++i;
<a id="L1421" name="L1421"></a>1421                         <strong class="reserved">if</strong> (p == (p = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>))
<a id="L1422" name="L1422"></a>1422                             p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L1423" name="L1423"></a>1423                     <em class="brace">}</em> <strong class="reserved">while</strong> (p != <strong class="reserved">null</strong> &amp;&amp; i &lt; n);
<a id="L1424" name="L1424"></a>1424                     <strong class="reserved">if</strong> ((<a href="../D/14417.html" title="Multiple defined in 10 places.">current</a> = p) == <strong class="reserved">null</strong>)
<a id="L1425" name="L1425"></a>1425                         exhausted = <strong class="reserved">true</strong>;
<a id="L1426" name="L1426"></a>1426                     <strong class="reserved">if</strong> (i &gt; 0) <em class="brace">{</em>
<a id="L1427" name="L1427"></a>1427                         batch = i;
<a id="L1428" name="L1428"></a>1428                         <strong class="reserved">return</strong> <a href="../S/1188.html#L41" title="Defined at 41 in src/java/util/Spliterators.java.">Spliterators</a>.<a href="../D/34729.html" title="Multiple defined in 111 places.">spliterator</a>
<a id="L1429" name="L1429"></a>1429                             (<a href="../D/10513.html" title="Multiple defined in 3 places.">a</a>, 0, i, <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.<a href="../S/915.html#L281" title="Defined at 281 in src/java/util/stream/StreamOpFlag.java.">ORDERED</a> | <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.NONNULL |
<a id="L1430" name="L1430"></a>1430                              <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.CONCURRENT);
<a id="L1431" name="L1431"></a>1431                     <em class="brace">}</em>
<a id="L1432" name="L1432"></a>1432                 <em class="brace">}</em>
<a id="L1433" name="L1433"></a>1433             <em class="brace">}</em>
<a id="L1434" name="L1434"></a>1434             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L1435" name="L1435"></a>1435         <em class="brace">}</em>
<a id="L1436" name="L1436"></a>1436 
<a id="L1437" name="L1437"></a>1437         <strong class="reserved">public</strong> <strong class="reserved">void</strong> <a href="../R/14732.html" title="Multiple referred from 54 places.">forEachRemaining</a>(<a href="../S/963.html#L42" title="Defined at 42 in src/java/util/function/Consumer.java.">Consumer</a>&lt;? <strong class="reserved">super</strong> E&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>) <em class="brace">{</em>
<a id="L1438" name="L1438"></a>1438             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p;
<a id="L1439" name="L1439"></a>1439             <strong class="reserved">if</strong> (<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a> == <strong class="reserved">null</strong>) <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L1440" name="L1440"></a>1440             <strong class="reserved">final</strong> <a href="../S/1076.html#L92" title="Defined at 92 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">ConcurrentLinkedDeque</a>&lt;E&gt; q = <strong class="reserved">this</strong>.queue;
<a id="L1441" name="L1441"></a>1441             <strong class="reserved">if</strong> (!exhausted &amp;&amp;
<a id="L1442" name="L1442"></a>1442                 ((p = <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>) != <strong class="reserved">null</strong> || (p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>()) != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L1443" name="L1443"></a>1443                 exhausted = <strong class="reserved">true</strong>;
<a id="L1444" name="L1444"></a>1444                 <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L1445" name="L1445"></a>1445                     E e = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1446" name="L1446"></a>1446                     <strong class="reserved">if</strong> (p == (p = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>))
<a id="L1447" name="L1447"></a>1447                         p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L1448" name="L1448"></a>1448                     <strong class="reserved">if</strong> (e != <strong class="reserved">null</strong>)
<a id="L1449" name="L1449"></a>1449                         <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>.<a href="../D/10537.html" title="Multiple defined in 327 places.">accept</a>(e);
<a id="L1450" name="L1450"></a>1450                 <em class="brace">}</em> <strong class="reserved">while</strong> (p != <strong class="reserved">null</strong>);
<a id="L1451" name="L1451"></a>1451             <em class="brace">}</em>
<a id="L1452" name="L1452"></a>1452         <em class="brace">}</em>
<a id="L1453" name="L1453"></a>1453 
<a id="L1454" name="L1454"></a>1454         <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/29541.html" title="Multiple referred from 73 places.">tryAdvance</a>(<a href="../S/963.html#L42" title="Defined at 42 in src/java/util/function/Consumer.java.">Consumer</a>&lt;? <strong class="reserved">super</strong> E&gt; <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>) <em class="brace">{</em>
<a id="L1455" name="L1455"></a>1455             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p;
<a id="L1456" name="L1456"></a>1456             <strong class="reserved">if</strong> (<a href="../D/10591.html" title="Multiple defined in 3 places.">action</a> == <strong class="reserved">null</strong>) <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1559.html#L53" title="Defined at 53 in src/java/lang/NullPointerException.java.">NullPointerException</a>();
<a id="L1457" name="L1457"></a>1457             <strong class="reserved">final</strong> <a href="../S/1076.html#L92" title="Defined at 92 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">ConcurrentLinkedDeque</a>&lt;E&gt; q = <strong class="reserved">this</strong>.queue;
<a id="L1458" name="L1458"></a>1458             <strong class="reserved">if</strong> (!exhausted &amp;&amp;
<a id="L1459" name="L1459"></a>1459                 ((p = <a href="../D/14417.html" title="Multiple defined in 10 places.">current</a>) != <strong class="reserved">null</strong> || (p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>()) != <strong class="reserved">null</strong>)) <em class="brace">{</em>
<a id="L1460" name="L1460"></a>1460                 E e;
<a id="L1461" name="L1461"></a>1461                 <strong class="reserved">do</strong> <em class="brace">{</em>
<a id="L1462" name="L1462"></a>1462                     e = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1463" name="L1463"></a>1463                     <strong class="reserved">if</strong> (p == (p = p.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a>))
<a id="L1464" name="L1464"></a>1464                         p = q.<a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>();
<a id="L1465" name="L1465"></a>1465                 <em class="brace">}</em> <strong class="reserved">while</strong> (e == <strong class="reserved">null</strong> &amp;&amp; p != <strong class="reserved">null</strong>);
<a id="L1466" name="L1466"></a>1466                 <strong class="reserved">if</strong> ((<a href="../D/14417.html" title="Multiple defined in 10 places.">current</a> = p) == <strong class="reserved">null</strong>)
<a id="L1467" name="L1467"></a>1467                     exhausted = <strong class="reserved">true</strong>;
<a id="L1468" name="L1468"></a>1468                 <strong class="reserved">if</strong> (e != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1469" name="L1469"></a>1469                     <a href="../D/10591.html" title="Multiple defined in 3 places.">action</a>.<a href="../D/10537.html" title="Multiple defined in 327 places.">accept</a>(e);
<a id="L1470" name="L1470"></a>1470                     <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L1471" name="L1471"></a>1471                 <em class="brace">}</em>
<a id="L1472" name="L1472"></a>1472             <em class="brace">}</em>
<a id="L1473" name="L1473"></a>1473             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L1474" name="L1474"></a>1474         <em class="brace">}</em>
<a id="L1475" name="L1475"></a>1475 
<a id="L1476" name="L1476"></a>1476         <strong class="reserved">public</strong> <strong class="reserved">long</strong> <a href="../R/14042.html" title="Multiple referred from 29 places.">estimateSize</a>() <em class="brace">{</em> <strong class="reserved">return</strong> <a href="../S/1720.html#L54" title="Defined at 54 in src/java/lang/Long.java.">Long</a>.MAX_VALUE; <em class="brace">}</em>
<a id="L1477" name="L1477"></a>1477 
<a id="L1478" name="L1478"></a>1478         <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/11055.html" title="Multiple referred from 149 places.">characteristics</a>() <em class="brace">{</em>
<a id="L1479" name="L1479"></a>1479             <strong class="reserved">return</strong> <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.<a href="../S/915.html#L281" title="Defined at 281 in src/java/util/stream/StreamOpFlag.java.">ORDERED</a> | <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.NONNULL |
<a id="L1480" name="L1480"></a>1480                 <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>.CONCURRENT;
<a id="L1481" name="L1481"></a>1481         <em class="brace">}</em>
<a id="L1482" name="L1482"></a>1482     <em class="brace">}</em>
<a id="L1483" name="L1483"></a>1483 
<div class="comment">
      Returns a {@link Spliterator} over the elements in this deque.
      <p>The returned spliterator is
      <a href="package-summary.html#Weakly"><i>weakly consistent</i></a>.
      </p><p>The <code>Spliterator</code> reports {@link Spliterator#CONCURRENT},
      {@link Spliterator#ORDERED}, and {@link Spliterator#NONNULL}.
      @implNote
      The <code>Spliterator</code> implements <code>trySplit</code> to permit limited
      parallelism.
      @return a <code>Spliterator</code> over the elements in this deque
      @since 1.8</p></div>
<a id="L1500" name="L1500"></a>1500     <strong class="reserved">public</strong> <a href="../S/1151.html#L296" title="Defined at 296 in src/java/util/Spliterator.java.">Spliterator</a>&lt;E&gt; <a href="../R/28762.html" title="Multiple referred from 435 places.">spliterator</a>() <em class="brace">{</em>
<a id="L1501" name="L1501"></a>1501         <strong class="reserved">return</strong> <strong class="reserved">new</strong> <a href="../S/1076.html#L1396" title="Defined at 1396 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">CLDSpliterator</a>&lt;E&gt;(<strong class="reserved">this</strong>);
<a id="L1502" name="L1502"></a>1502     <em class="brace">}</em>
<a id="L1503" name="L1503"></a>1503 
<div class="comment">
      Saves this deque to a stream (that is, serializes it).
      @param s the stream
      @throws java.io.IOException if an I/O error occurs
      @serialData All of the elements (each an <code>E</code>) in
      the proper order, followed by a null</div>
<a id="L1512" name="L1512"></a>1512     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/30680.html" title="Multiple referred from 184 places.">writeObject</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1381.html#L162" title="Defined at 162 in src/java/io/ObjectOutputStream.java.">ObjectOutputStream</a> s)
<a id="L1513" name="L1513"></a>1513         <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> <em class="brace">{</em>
<a id="L1514" name="L1514"></a>1514 
<a id="L1515" name="L1515"></a>1515         <em class="comment">// Write out any hidden stuff</em>
<a id="L1516" name="L1516"></a>1516         s.<a href="../D/14752.html" title="Multiple defined in 6 places.">defaultWriteObject</a>();
<a id="L1517" name="L1517"></a>1517 
<a id="L1518" name="L1518"></a>1518         <em class="comment">// Write out all elements in the proper order.</em>
<a id="L1519" name="L1519"></a>1519         <strong class="reserved">for</strong> (<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; p = <a href="../D/16393.html" title="Multiple defined in 45 places.">first</a>(); p != <strong class="reserved">null</strong>; p = <a href="../D/35024.html" title="Multiple defined in 4 places.">succ</a>(p)) <em class="brace">{</em>
<a id="L1520" name="L1520"></a>1520             E <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = p.<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1521" name="L1521"></a>1521             <strong class="reserved">if</strong> (<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> != <strong class="reserved">null</strong>)
<a id="L1522" name="L1522"></a>1522                 s.<a href="../D/37124.html" title="Multiple defined in 263 places.">writeObject</a>(<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L1523" name="L1523"></a>1523         <em class="brace">}</em>
<a id="L1524" name="L1524"></a>1524 
<a id="L1525" name="L1525"></a>1525         <em class="comment">// Use trailing null as sentinel</em>
<a id="L1526" name="L1526"></a>1526         s.<a href="../D/37124.html" title="Multiple defined in 263 places.">writeObject</a>(<strong class="reserved">null</strong>);
<a id="L1527" name="L1527"></a>1527     <em class="brace">}</em>
<a id="L1528" name="L1528"></a>1528 
<div class="comment">
      Reconstitutes this deque from a stream (that is, deserializes it).
      @param s the stream
      @throws ClassNotFoundException if the class of a serialized object
              could not be found
      @throws java.io.IOException if an I/O error occurs</div>
<a id="L1536" name="L1536"></a>1536     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25518.html" title="Multiple referred from 189 places.">readObject</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1378.html#L206" title="Defined at 206 in src/java/io/ObjectInputStream.java.">ObjectInputStream</a> s)
<a id="L1537" name="L1537"></a>1537         <strong class="reserved">throws</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a> <em class="brace">{</em>
<a id="L1538" name="L1538"></a>1538         s.<a href="../D/14746.html" title="Multiple defined in 2 places.">defaultReadObject</a>();
<a id="L1539" name="L1539"></a>1539 
<a id="L1540" name="L1540"></a>1540         <em class="comment">// Read in elements until trailing null sentinel found</em>
<a id="L1541" name="L1541"></a>1541         <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; h = <strong class="reserved">null</strong>, t = <strong class="reserved">null</strong>;
<a id="L1542" name="L1542"></a>1542         <a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>;
<a id="L1543" name="L1543"></a>1543         <strong class="reserved">while</strong> ((<a href="../D/26564.html" title="Multiple defined in 60 places.">item</a> = s.<a href="../D/30232.html" title="Multiple defined in 322 places.">readObject</a>()) != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L1544" name="L1544"></a>1544             @<a href="../D/8551.html" title="Multiple defined in 725 places.">SuppressWarnings</a>("unchecked")
<a id="L1545" name="L1545"></a>1545             <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a> = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt;((E) <a href="../D/26564.html" title="Multiple defined in 60 places.">item</a>);
<a id="L1546" name="L1546"></a>1546             <strong class="reserved">if</strong> (h == <strong class="reserved">null</strong>)
<a id="L1547" name="L1547"></a>1547                 h = t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L1548" name="L1548"></a>1548             <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L1549" name="L1549"></a>1549                 t.<a href="../D/26787.html" title="Multiple defined in 3 places.">lazySetNext</a>(<a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>);
<a id="L1550" name="L1550"></a>1550                 <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>.<a href="../S/1076.html#L318" title="Defined at 318 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">lazySetPrev</a>(t);
<a id="L1551" name="L1551"></a>1551                 t = <a href="../D/28045.html" title="Multiple defined in 5 places.">newNode</a>;
<a id="L1552" name="L1552"></a>1552             <em class="brace">}</em>
<a id="L1553" name="L1553"></a>1553         <em class="brace">}</em>
<a id="L1554" name="L1554"></a>1554         <a href="../S/1076.html#L866" title="Defined at 866 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">initHeadTail</a>(h, t);
<a id="L1555" name="L1555"></a>1555     <em class="brace">}</em>
<a id="L1556" name="L1556"></a>1556 
<a id="L1557" name="L1557"></a>1557     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/10983.html" title="Multiple referred from 20 places.">casHead</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; cmp, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L1558" name="L1558"></a>1558         <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, headOffset, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L1559" name="L1559"></a>1559     <em class="brace">}</em>
<a id="L1560" name="L1560"></a>1560 
<a id="L1561" name="L1561"></a>1561     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/10993.html" title="Multiple referred from 9 places.">casTail</a>(<a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; cmp, <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;E&gt; <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>) <em class="brace">{</em>
<a id="L1562" name="L1562"></a>1562         <strong class="reserved">return</strong> UNSAFE.compareAndSwapObject(<strong class="reserved">this</strong>, tailOffset, cmp, <a href="../S/1444.html#L56" title="Defined at 56 in src/java/io/ExpiringCache.java.">val</a>);
<a id="L1563" name="L1563"></a>1563     <em class="brace">}</em>
<a id="L1564" name="L1564"></a>1564 
<a id="L1565" name="L1565"></a>1565     <em class="comment">// Unsafe mechanics</em>
<a id="L1566" name="L1566"></a>1566 
<a id="L1567" name="L1567"></a>1567     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> sun.misc.Unsafe UNSAFE;
<a id="L1568" name="L1568"></a>1568     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> headOffset;
<a id="L1569" name="L1569"></a>1569     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> tailOffset;
<a id="L1570" name="L1570"></a>1570     <strong class="reserved">static</strong> <em class="brace">{</em>
<a id="L1571" name="L1571"></a>1571         PREV_TERMINATOR = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt;();
<a id="L1572" name="L1572"></a>1572         PREV_TERMINATOR.<a href="../D/28131.html" title="Multiple defined in 273 places.">next</a> = PREV_TERMINATOR;
<a id="L1573" name="L1573"></a>1573         NEXT_TERMINATOR = <strong class="reserved">new</strong> <a href="../D/6077.html" title="Multiple defined in 24 places.">Node</a>&lt;<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a>&gt;();
<a id="L1574" name="L1574"></a>1574         NEXT_TERMINATOR.prev = NEXT_TERMINATOR;
<a id="L1575" name="L1575"></a>1575         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L1576" name="L1576"></a>1576             UNSAFE = sun.misc.Unsafe.getUnsafe();
<a id="L1577" name="L1577"></a>1577             <a href="../S/1722.html#L119" title="Defined at 119 in src/java/lang/Class.java.">Class</a>&lt;?&gt; k = <a href="../S/1076.html#L92" title="Defined at 92 in src/java/util/concurrent/ConcurrentLinkedDeque.java.">ConcurrentLinkedDeque</a>.<strong class="reserved">class</strong>;
<a id="L1578" name="L1578"></a>1578             headOffset = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L1579" name="L1579"></a>1579                 (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("head"));
<a id="L1580" name="L1580"></a>1580             tailOffset = UNSAFE.<a href="../D/28395.html" title="Multiple defined in 5 places.">objectFieldOffset</a>
<a id="L1581" name="L1581"></a>1581                 (k.<a href="../S/1722.html#L2065" title="Defined at 2065 in src/java/lang/Class.java.">getDeclaredField</a>("tail"));
<a id="L1582" name="L1582"></a>1582         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1582.html#L45" title="Defined at 45 in src/java/lang/Exception.java.">Exception</a> e) <em class="brace">{</em>
<a id="L1583" name="L1583"></a>1583             <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1772.html#L49" title="Defined at 49 in src/java/lang/Error.java.">Error</a>(e);
<a id="L1584" name="L1584"></a>1584         <em class="brace">}</em>
<a id="L1585" name="L1585"></a>1585     <em class="brace">}</em>
<a id="L1586" name="L1586"></a>1586 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L280">[^]</a><a href="#L1561">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>