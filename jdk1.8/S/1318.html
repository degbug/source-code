<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<title>src/java/security/CodeSource.java</title>
<meta name="robots" content="noindex,nofollow">
<meta name="generator" content="GLOBAL-6.6.3">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" type="text/css" href="../style.css">
</head>
<body>
<a id="TOP" name="TOP"></a><div class="comment">
/* [&lt;][&gt;]<a href="#L118">[^]</a><a href="#L600">[v]</a>[top]<a href="#BOTTOM">[bottom]</a><a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
<hr>
<h2 class="header">DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href="#L118" title="Defined at 118.">hashCode</a></li>
<li><a href="#L137" title="Defined at 137.">equals</a></li>
<li><a href="#L165" title="Defined at 165.">getLocation</a></li>
<li><a href="#L185" title="Defined at 185.">getCertificates</a></li>
<li><a href="#L219" title="Defined at 219.">getCodeSigners</a></li>
<li><a href="#L303" title="Defined at 303.">implies</a></li>
<li><a href="#L319" title="Defined at 319.">matchCerts</a></li>
<li><a href="#L374" title="Defined at 374.">matchLocation</a></li>
<li><a href="#L464" title="Defined at 464.">toString</a></li>
<li><a href="#L499" title="Defined at 499.">writeObject</a></li>
<li><a href="#L533" title="Defined at 533.">readObject</a></li>
<li><a href="#L600" title="Defined at 600.">convertCertArrayToSignerArray</a></li>
</ol>
<hr>
<pre>
<div class="comment">
  Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
  ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</div>
<a id="L25" name="L25"></a>  25 
<a id="L26" name="L26"></a>  26 <strong class="reserved">package</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security;
<a id="L27" name="L27"></a>  27 
<a id="L28" name="L28"></a>  28 
<a id="L29" name="L29"></a>  29 <strong class="reserved">import</strong> java.net.URL;
<a id="L30" name="L30"></a>  30 <strong class="reserved">import</strong> java.net.SocketPermission;
<a id="L31" name="L31"></a>  31 <strong class="reserved">import</strong> java.util.ArrayList;
<a id="L32" name="L32"></a>  32 <strong class="reserved">import</strong> java.util.List;
<a id="L33" name="L33"></a>  33 <strong class="reserved">import</strong> java.util.Hashtable;
<a id="L34" name="L34"></a>  34 <strong class="reserved">import</strong> java.io.ByteArrayInputStream;
<a id="L35" name="L35"></a>  35 <strong class="reserved">import</strong> java.io.IOException;
<a id="L36" name="L36"></a>  36 <strong class="reserved">import</strong> java.security.cert.*;
<a id="L37" name="L37"></a>  37 
<div class="comment">
  <p>This class extends the concept of a codebase to
  encapsulate not only the location (URL) but also the certificate chains
  that were used to verify signed code originating from that location.
  @author Li Gong
  @author Roland Schemers</p></div>
<a id="L47" name="L47"></a>  47 
<a id="L48" name="L48"></a>  48 <strong class="reserved">public</strong> <strong class="reserved">class</strong> <a href="../R/1462.html" title="Multiple referred from 60 places.">CodeSource</a> <strong class="reserved">implements</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1407.html#L169" title="Defined at 169 in src/java/io/Serializable.java.">Serializable</a> <em class="brace">{</em>
<a id="L49" name="L49"></a>  49 
<a id="L50" name="L50"></a>  50     <strong class="reserved">private</strong> <strong class="reserved">static</strong> <strong class="reserved">final</strong> <strong class="reserved">long</strong> serialVersionUID = 4977541819976013951L;
<a id="L51" name="L51"></a>  51 
<div class="comment">
      The code location.
      @serial</div>
<a id="L57" name="L57"></a>  57     <strong class="reserved">private</strong> <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> <a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>;
<a id="L58" name="L58"></a>  58 
<div class="comment">
      The code signers.</div>
<a id="L62" name="L62"></a>  62     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/1331.html#L39" title="Defined at 39 in src/java/security/CodeSigner.java.">CodeSigner</a>[] signers = <strong class="reserved">null</strong>;
<a id="L63" name="L63"></a>  63 
<div class="comment">
      The code signers. Certificate chains are concatenated.</div>
<a id="L67" name="L67"></a>  67     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a> certs[] = <strong class="reserved">null</strong>;
<a id="L68" name="L68"></a>  68 
<a id="L69" name="L69"></a>  69     <em class="comment">// cached SocketPermission used for matchLocation</em>
<a id="L70" name="L70"></a>  70     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/774.html#L148" title="Defined at 148 in src/java/net/SocketPermission.java.">SocketPermission</a> sp;
<a id="L71" name="L71"></a>  71 
<a id="L72" name="L72"></a>  72     <em class="comment">// for generating cert paths</em>
<a id="L73" name="L73"></a>  73     <strong class="reserved">private</strong> <strong class="reserved">transient</strong> <a href="../S/1307.html#L126" title="Defined at 126 in src/java/security/cert/CertificateFactory.java.">CertificateFactory</a> <a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a> = <strong class="reserved">null</strong>;
<a id="L74" name="L74"></a>  74 
<div class="comment">
      Constructs a CodeSource and associates it with the specified
      location and set of certificates.
      @param url the location (URL).
      @param certs the certificate(s). It may be null. The contents of the
      array are copied to protect against subsequent modification.</div>
<a id="L84" name="L84"></a>  84     <strong class="reserved">public</strong> CodeSource(<a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> url, <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a> certs[]) <em class="brace">{</em>
<a id="L85" name="L85"></a>  85         <strong class="reserved">this</strong>.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a> = url;
<a id="L86" name="L86"></a>  86 
<a id="L87" name="L87"></a>  87         <em class="comment">// Copy the supplied certs</em>
<a id="L88" name="L88"></a>  88         <strong class="reserved">if</strong> (certs != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L89" name="L89"></a>  89             <strong class="reserved">this</strong>.certs = certs.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L90" name="L90"></a>  90         <em class="brace">}</em>
<a id="L91" name="L91"></a>  91     <em class="brace">}</em>
<a id="L92" name="L92"></a>  92 
<div class="comment">
      Constructs a CodeSource and associates it with the specified
      location and set of code signers.
      @param url the location (URL).
      @param signers the code signers. It may be null. The contents of the
      array are copied to protect against subsequent modification.
      @since 1.5</div>
<a id="L103" name="L103"></a> 103     <strong class="reserved">public</strong> CodeSource(<a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> url, <a href="../S/1331.html#L39" title="Defined at 39 in src/java/security/CodeSigner.java.">CodeSigner</a>[] signers) <em class="brace">{</em>
<a id="L104" name="L104"></a> 104         <strong class="reserved">this</strong>.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a> = url;
<a id="L105" name="L105"></a> 105 
<a id="L106" name="L106"></a> 106         <em class="comment">// Copy the supplied signers</em>
<a id="L107" name="L107"></a> 107         <strong class="reserved">if</strong> (signers != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L108" name="L108"></a> 108             <strong class="reserved">this</strong>.signers = signers.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L109" name="L109"></a> 109         <em class="brace">}</em>
<a id="L110" name="L110"></a> 110     <em class="brace">}</em>
<a id="L111" name="L111"></a> 111 
<div class="comment">
      Returns the hash code value for this object.
      @return a hash code value for this object.</div>
<a id="L117" name="L117"></a> 117     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L118" name="L118"></a> 118     <strong class="reserved">public</strong> <strong class="reserved">int</strong> <a href="../R/20298.html" title="Multiple referred from 715 places.">hashCode</a>() <em class="brace">{</em>
<a id="L119" name="L119"></a> 119         <strong class="reserved">if</strong> (<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a> != <strong class="reserved">null</strong>)
<a id="L120" name="L120"></a> 120             <strong class="reserved">return</strong> <a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/24220.html" title="Multiple defined in 552 places.">hashCode</a>();
<a id="L121" name="L121"></a> 121         <strong class="reserved">else</strong>
<a id="L122" name="L122"></a> 122             <strong class="reserved">return</strong> 0;
<a id="L123" name="L123"></a> 123     <em class="brace">}</em>
<a id="L124" name="L124"></a> 124 
<div class="comment">
      Tests for equality between the specified object and this
      object. Two CodeSource objects are considered equal if their
      locations are of identical value and if their signer certificate
      chains are of identical value. It is not required that
      the certificate chains be in the same order.
      @param obj the object to test for equality with this object.
      @return true if the objects are considered equal, false otherwise.</div>
<a id="L136" name="L136"></a> 136     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L137" name="L137"></a> 137     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/13992.html" title="Multiple referred from 5400 places.">equals</a>(<a href="../D/6272.html" title="Multiple defined in 7 places.">Object</a> obj) <em class="brace">{</em>
<a id="L138" name="L138"></a> 138         <strong class="reserved">if</strong> (obj == <strong class="reserved">this</strong>)
<a id="L139" name="L139"></a> 139             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L140" name="L140"></a> 140 
<a id="L141" name="L141"></a> 141         <em class="comment">// objects types must be equal</em>
<a id="L142" name="L142"></a> 142         <strong class="reserved">if</strong> (!(obj <strong class="reserved">instanceof</strong> <a href="../S/1318.html#L48" title="Defined at 48 in src/java/security/CodeSource.java.">CodeSource</a>))
<a id="L143" name="L143"></a> 143             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L144" name="L144"></a> 144 
<a id="L145" name="L145"></a> 145         <a href="../S/1318.html#L48" title="Defined at 48 in src/java/security/CodeSource.java.">CodeSource</a> cs = (<a href="../S/1318.html#L48" title="Defined at 48 in src/java/security/CodeSource.java.">CodeSource</a>) obj;
<a id="L146" name="L146"></a> 146 
<a id="L147" name="L147"></a> 147         <em class="comment">// URLs must match</em>
<a id="L148" name="L148"></a> 148         <strong class="reserved">if</strong> (<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L149" name="L149"></a> 149             <em class="comment">// if location is null, then cs.location must be null as well</em>
<a id="L150" name="L150"></a> 150             <strong class="reserved">if</strong> (cs.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a> != <strong class="reserved">null</strong>) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L151" name="L151"></a> 151         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L152" name="L152"></a> 152             <em class="comment">// if location is not null, then it must equal cs.location</em>
<a id="L153" name="L153"></a> 153             <strong class="reserved">if</strong> (!<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(cs.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>)) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L154" name="L154"></a> 154         <em class="brace">}</em>
<a id="L155" name="L155"></a> 155 
<a id="L156" name="L156"></a> 156         <em class="comment">// certs must match</em>
<a id="L157" name="L157"></a> 157         <strong class="reserved">return</strong> <a href="../S/1318.html#L319" title="Defined at 319 in src/java/security/CodeSource.java.">matchCerts</a>(cs, <strong class="reserved">true</strong>);
<a id="L158" name="L158"></a> 158     <em class="brace">}</em>
<a id="L159" name="L159"></a> 159 
<div class="comment">
      Returns the location associated with this CodeSource.
      @return the location (URL).</div>
<a id="L165" name="L165"></a> 165     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../D/9256.html" title="Multiple defined in 2 places.">URL</a> <a href="../R/17447.html" title="Multiple referred from 115 places.">getLocation</a>() <em class="brace">{</em>
<div class="comment">
 since URL is practically immutable, returning itself is not
           a security problem </div>
<a id="L168" name="L168"></a> 168         <strong class="reserved">return</strong> <strong class="reserved">this</strong>.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>;
<a id="L169" name="L169"></a> 169     <em class="brace">}</em>
<a id="L170" name="L170"></a> 170 
<div class="comment">
      Returns the certificates associated with this CodeSource.
      <p>
      If this CodeSource object was created using the
      {@link #CodeSource(URL url, CodeSigner[] signers)}
      constructor then its certificate chains are extracted and used to
      create an array of Certificate objects. Each signer certificate is
      followed by its supporting certificate chain (which may be empty).
      Each signer certificate and its supporting certificate chain is ordered
      bottom-to-top (i.e., with the signer certificate first and the (root)
      certificate authority last).
      @return A copy of the certificates array, or null if there is none.</p></div>
<a id="L185" name="L185"></a> 185     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a>[] <a href="../R/15488.html" title="Multiple referred from 14 places.">getCertificates</a>() <em class="brace">{</em>
<a id="L186" name="L186"></a> 186         <strong class="reserved">if</strong> (certs != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L187" name="L187"></a> 187             <strong class="reserved">return</strong> certs.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L188" name="L188"></a> 188 
<a id="L189" name="L189"></a> 189         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (signers != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L190" name="L190"></a> 190             <em class="comment">// Convert the code signers to certs</em>
<a id="L191" name="L191"></a> 191             <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a>&gt; certChains =
<a id="L192" name="L192"></a> 192                         <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;&gt;();
<a id="L193" name="L193"></a> 193             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; signers.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L194" name="L194"></a> 194                 certChains.<a href="../D/10646.html" title="Multiple defined in 78 places.">addAll</a>(
<a id="L195" name="L195"></a> 195                     signers[i].<a href="../D/22515.html" title="Multiple defined in 2 places.">getSignerCertPath</a>().<a href="../D/17559.html" title="Multiple defined in 6 places.">getCertificates</a>());
<a id="L196" name="L196"></a> 196             <em class="brace">}</em>
<a id="L197" name="L197"></a> 197             certs = certChains.<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>(
<a id="L198" name="L198"></a> 198                         <strong class="reserved">new</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a>[certChains.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()]);
<a id="L199" name="L199"></a> 199             <strong class="reserved">return</strong> certs.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L200" name="L200"></a> 200 
<a id="L201" name="L201"></a> 201         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L202" name="L202"></a> 202             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L203" name="L203"></a> 203         <em class="brace">}</em>
<a id="L204" name="L204"></a> 204     <em class="brace">}</em>
<a id="L205" name="L205"></a> 205 
<div class="comment">
      Returns the code signers associated with this CodeSource.
      <p>
      If this CodeSource object was created using the
      {@link #CodeSource(URL url, java.security.cert.Certificate[] certs)}
      constructor then its certificate chains are extracted and used to
      create an array of CodeSigner objects. Note that only X.509 certificates
      are examined - all other certificate types are ignored.
      @return A copy of the code signer array, or null if there is none.
      @since 1.5</p></div>
<a id="L219" name="L219"></a> 219     <strong class="reserved">public</strong> <strong class="reserved">final</strong> <a href="../S/1331.html#L39" title="Defined at 39 in src/java/security/CodeSigner.java.">CodeSigner</a>[] <a href="../R/15644.html" title="Multiple referred from 8 places.">getCodeSigners</a>() <em class="brace">{</em>
<a id="L220" name="L220"></a> 220         <strong class="reserved">if</strong> (signers != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L221" name="L221"></a> 221             <strong class="reserved">return</strong> signers.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L222" name="L222"></a> 222 
<a id="L223" name="L223"></a> 223         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (certs != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L224" name="L224"></a> 224             <em class="comment">// Convert the certs to code signers</em>
<a id="L225" name="L225"></a> 225             signers = <a href="../S/1318.html#L600" title="Defined at 600 in src/java/security/CodeSource.java.">convertCertArrayToSignerArray</a>(certs);
<a id="L226" name="L226"></a> 226             <strong class="reserved">return</strong> signers.<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L227" name="L227"></a> 227 
<a id="L228" name="L228"></a> 228         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L229" name="L229"></a> 229             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L230" name="L230"></a> 230         <em class="brace">}</em>
<a id="L231" name="L231"></a> 231     <em class="brace">}</em>
<a id="L232" name="L232"></a> 232 
<div class="comment">
      Returns true if this CodeSource object "implies" the specified CodeSource.
      <p>
      More specifically, this method makes the following checks.
      If any fail, it returns false. If they all succeed, it returns true.
      </p><ul><li> <i>codesource</i> must not be null.
      </li><li> If this object's certificates are not null, then all
      of this object's certificates must be present in <i>codesource</i>'s
      certificates.
      </li><li> If this object's location (getLocation()) is not null, then the
      following checks are made against this object's location and
      <i>codesource</i>'s:
        <ul><li>  <i>codesource</i>'s location must not be null.
          </li><li>  If this object's location
                equals <i>codesource</i>'s location, then return true.
          </li><li>  This object's protocol (getLocation().getProtocol()) must be
                equal to <i>codesource</i>'s protocol, ignoring case.
          </li><li>  If this object's host (getLocation().getHost()) is not null,
                then the SocketPermission
                constructed with this object's host must imply the
                SocketPermission constructed with <i>codesource</i>'s host.
          </li><li>  If this object's port (getLocation().getPort()) is not
                equal to -1 (that is, if a port is specified), it must equal
                <i>codesource</i>'s port or default port
                (codesource.getLocation().getDefaultPort()).
          </li><li>  If this object's file (getLocation().getFile()) doesn't equal
                <i>codesource</i>'s file, then the following checks are made:
                If this object's file ends with "/-",
                then <i>codesource</i>'s file must start with this object's
                file (exclusive the trailing "-").
     *           If this object's file ends with a "",
                then <i>codesource</i>'s file must start with this object's
                file and must not have any further "/" separators.
                If this object's file doesn't end with a "/",
                then <i>codesource</i>'s file must match this object's
                file with a '/' appended.
          </li><li>  If this object's reference (getLocation().getRef()) is
                not null, it must equal <i>codesource</i>'s reference.
        </li></ul>
      </li></ul>
      <p>
      For example, the codesource objects with the following locations
      and null certificates all imply
      the codesource with the location "http://java.sun.com/classes/foo.jar"
      and null certificates:
      </p><pre>          http:
     *     http:/.sun.com/classes/*
          http://java.sun.com/classes/-
          http://java.sun.com/classes/foo.jar
      </pre>
      Note that if this CodeSource has a null location and a null
      certificate chain, then it implies every other CodeSource.
      @param codesource CodeSource to compare against.
      @return true if the specified codesource is implied by this codesource,
      false if not.</div>
<a id="L302" name="L302"></a> 302 
<a id="L303" name="L303"></a> 303     <strong class="reserved">public</strong> <strong class="reserved">boolean</strong> <a href="../R/20435.html" title="Multiple referred from 23 places.">implies</a>(<a href="../S/1318.html#L48" title="Defined at 48 in src/java/security/CodeSource.java.">CodeSource</a> codesource)
<a id="L304" name="L304"></a> 304     <em class="brace">{</em>
<a id="L305" name="L305"></a> 305         <strong class="reserved">if</strong> (codesource == <strong class="reserved">null</strong>)
<a id="L306" name="L306"></a> 306             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L307" name="L307"></a> 307 
<a id="L308" name="L308"></a> 308         <strong class="reserved">return</strong> <a href="../S/1318.html#L319" title="Defined at 319 in src/java/security/CodeSource.java.">matchCerts</a>(codesource, <strong class="reserved">false</strong>) &amp;&amp; <a href="../S/1318.html#L374" title="Defined at 374 in src/java/security/CodeSource.java.">matchLocation</a>(codesource);
<a id="L309" name="L309"></a> 309     <em class="brace">}</em>
<a id="L310" name="L310"></a> 310 
<div class="comment">
      Returns true if all the certs in this
      CodeSource are also in <i>that</i>.
      @param that the CodeSource to check against.
      @param strict If true then a strict equality match is performed.
                    Otherwise a subset match is performed.</div>
<a id="L319" name="L319"></a> 319     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../R/23125.html" title="Multiple referred from 2 places.">matchCerts</a>(<a href="../S/1318.html#L48" title="Defined at 48 in src/java/security/CodeSource.java.">CodeSource</a> that, <strong class="reserved">boolean</strong> strict)
<a id="L320" name="L320"></a> 320     <em class="brace">{</em>
<a id="L321" name="L321"></a> 321         <strong class="reserved">boolean</strong> <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>;
<a id="L322" name="L322"></a> 322 
<a id="L323" name="L323"></a> 323         <em class="comment">// match any key</em>
<a id="L324" name="L324"></a> 324         <strong class="reserved">if</strong> (certs == <strong class="reserved">null</strong> &amp;&amp; signers == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L325" name="L325"></a> 325             <strong class="reserved">if</strong> (strict) <em class="brace">{</em>
<a id="L326" name="L326"></a> 326                 <strong class="reserved">return</strong> (that.certs == <strong class="reserved">null</strong> &amp;&amp; that.signers == <strong class="reserved">null</strong>);
<a id="L327" name="L327"></a> 327             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L328" name="L328"></a> 328                 <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L329" name="L329"></a> 329             <em class="brace">}</em>
<a id="L330" name="L330"></a> 330         <em class="comment">// both have signers</em>
<a id="L331" name="L331"></a> 331         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (signers != <strong class="reserved">null</strong> &amp;&amp; that.signers != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L332" name="L332"></a> 332             <strong class="reserved">if</strong> (strict &amp;&amp; signers.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != that.signers.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L333" name="L333"></a> 333                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L334" name="L334"></a> 334             <em class="brace">}</em>
<a id="L335" name="L335"></a> 335             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; signers.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L336" name="L336"></a> 336                 <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a> = <strong class="reserved">false</strong>;
<a id="L337" name="L337"></a> 337                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> j = 0; j &lt; that.signers.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; j++) <em class="brace">{</em>
<a id="L338" name="L338"></a> 338                     <strong class="reserved">if</strong> (signers[i].<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(that.signers[j])) <em class="brace">{</em>
<a id="L339" name="L339"></a> 339                         <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a> = <strong class="reserved">true</strong>;
<a id="L340" name="L340"></a> 340                         <strong class="reserved">break</strong>;
<a id="L341" name="L341"></a> 341                     <em class="brace">}</em>
<a id="L342" name="L342"></a> 342                 <em class="brace">}</em>
<a id="L343" name="L343"></a> 343                 <strong class="reserved">if</strong> (!<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L344" name="L344"></a> 344             <em class="brace">}</em>
<a id="L345" name="L345"></a> 345             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L346" name="L346"></a> 346 
<a id="L347" name="L347"></a> 347         <em class="comment">// both have certs</em>
<a id="L348" name="L348"></a> 348         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (certs != <strong class="reserved">null</strong> &amp;&amp; that.certs != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L349" name="L349"></a> 349             <strong class="reserved">if</strong> (strict &amp;&amp; certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> != that.certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L350" name="L350"></a> 350                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L351" name="L351"></a> 351             <em class="brace">}</em>
<a id="L352" name="L352"></a> 352             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L353" name="L353"></a> 353                 <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a> = <strong class="reserved">false</strong>;
<a id="L354" name="L354"></a> 354                 <strong class="reserved">for</strong> (<strong class="reserved">int</strong> j = 0; j &lt; that.certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; j++) <em class="brace">{</em>
<a id="L355" name="L355"></a> 355                     <strong class="reserved">if</strong> (certs[i].<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(that.certs[j])) <em class="brace">{</em>
<a id="L356" name="L356"></a> 356                         <a href="../D/27519.html" title="Multiple defined in 69 places.">match</a> = <strong class="reserved">true</strong>;
<a id="L357" name="L357"></a> 357                         <strong class="reserved">break</strong>;
<a id="L358" name="L358"></a> 358                     <em class="brace">}</em>
<a id="L359" name="L359"></a> 359                 <em class="brace">}</em>
<a id="L360" name="L360"></a> 360                 <strong class="reserved">if</strong> (!<a href="../D/27519.html" title="Multiple defined in 69 places.">match</a>) <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L361" name="L361"></a> 361             <em class="brace">}</em>
<a id="L362" name="L362"></a> 362             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L363" name="L363"></a> 363         <em class="brace">}</em>
<a id="L364" name="L364"></a> 364 
<a id="L365" name="L365"></a> 365         <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L366" name="L366"></a> 366     <em class="brace">}</em>
<a id="L367" name="L367"></a> 367 
<a id="L368" name="L368"></a> 368 
<div class="comment">
      Returns true if two CodeSource's have the "same" location.
      @param that CodeSource to compare against</div>
<a id="L374" name="L374"></a> 374     <strong class="reserved">private</strong> <strong class="reserved">boolean</strong> <a href="../S/1318.html#L308" title="Referred from 308 in src/java/security/CodeSource.java.">matchLocation</a>(<a href="../S/1318.html#L48" title="Defined at 48 in src/java/security/CodeSource.java.">CodeSource</a> that) <em class="brace">{</em>
<a id="L375" name="L375"></a> 375         <strong class="reserved">if</strong> (<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a> == <strong class="reserved">null</strong>)
<a id="L376" name="L376"></a> 376             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L377" name="L377"></a> 377 
<a id="L378" name="L378"></a> 378         <strong class="reserved">if</strong> ((that == <strong class="reserved">null</strong>) || (that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a> == <strong class="reserved">null</strong>))
<a id="L379" name="L379"></a> 379             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L380" name="L380"></a> 380 
<a id="L381" name="L381"></a> 381         <strong class="reserved">if</strong> (<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>))
<a id="L382" name="L382"></a> 382             <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L383" name="L383"></a> 383 
<a id="L384" name="L384"></a> 384         <strong class="reserved">if</strong> (!<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/21751.html" title="Multiple defined in 10 places.">getProtocol</a>().<a href="../D/15687.html" title="Multiple defined in 6 places.">equalsIgnoreCase</a>(that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/21751.html" title="Multiple defined in 10 places.">getProtocol</a>()))
<a id="L385" name="L385"></a> 385             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L386" name="L386"></a> 386 
<a id="L387" name="L387"></a> 387         <strong class="reserved">int</strong> thisPort = <a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/21541.html" title="Multiple defined in 42 places.">getPort</a>();
<a id="L388" name="L388"></a> 388         <strong class="reserved">if</strong> (thisPort != -1) <em class="brace">{</em>
<a id="L389" name="L389"></a> 389             <strong class="reserved">int</strong> thatPort = that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/21541.html" title="Multiple defined in 42 places.">getPort</a>();
<a id="L390" name="L390"></a> 390             <strong class="reserved">int</strong> port = thatPort != -1 ? thatPort
<a id="L391" name="L391"></a> 391                                       : that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/18340.html" title="Multiple defined in 2 places.">getDefaultPort</a>();
<a id="L392" name="L392"></a> 392             <strong class="reserved">if</strong> (thisPort != port)
<a id="L393" name="L393"></a> 393                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L394" name="L394"></a> 394         <em class="brace">}</em>
<a id="L395" name="L395"></a> 395 
<a id="L396" name="L396"></a> 396         <strong class="reserved">if</strong> (<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/15495.html" title="Multiple defined in 12 places.">endsWith</a>("/-")) <em class="brace">{</em>
<a id="L397" name="L397"></a> 397             <em class="comment">// Matches the directory and (recursively) all files</em>
<a id="L398" name="L398"></a> 398             <em class="comment">// and subdirectories contained in that directory.</em>
<a id="L399" name="L399"></a> 399             <em class="comment">// For example, "/a/b/-" implies anything that starts with</em>
<a id="L400" name="L400"></a> 400             <em class="comment">// "/a/b/"</em>
<a id="L401" name="L401"></a> 401             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> thisPath = <a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0,
<a id="L402" name="L402"></a> 402                                             <a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()-1);
<a id="L403" name="L403"></a> 403             <strong class="reserved">if</strong> (!that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/34843.html" title="Multiple defined in 24 places.">startsWith</a>(thisPath))
<a id="L404" name="L404"></a> 404                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L405" name="L405"></a> 405         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/15495.html" title="Multiple defined in 12 places.">endsWith</a>("/*")) <em class="brace">{</em>
<a id="L406" name="L406"></a> 406             <em class="comment">// Matches the directory and all the files contained in that</em>
<a id="L407" name="L407"></a> 407             <em class="comment">// directory.</em>
<a id="L408" name="L408"></a> 408             <em class="comment">// For example, "/a/b/*" implies anything that starts with</em>
<a id="L409" name="L409"></a> 409             <em class="comment">// "/a/b/" but has no further slashes</em>
<a id="L410" name="L410"></a> 410             <strong class="reserved">int</strong> <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> = that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/26748.html" title="Multiple defined in 44 places.">lastIndexOf</a>('/');
<a id="L411" name="L411"></a> 411             <strong class="reserved">if</strong> (<a href="../D/26739.html" title="Multiple defined in 19 places.">last</a> == -1)
<a id="L412" name="L412"></a> 412                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L413" name="L413"></a> 413             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> thisPath = <a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0,
<a id="L414" name="L414"></a> 414                                             <a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>()-1);
<a id="L415" name="L415"></a> 415             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> thatPath = that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/35013.html" title="Multiple defined in 26 places.">substring</a>(0, <a href="../D/26739.html" title="Multiple defined in 19 places.">last</a>+1);
<a id="L416" name="L416"></a> 416             <strong class="reserved">if</strong> (!thatPath.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(thisPath))
<a id="L417" name="L417"></a> 417                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L418" name="L418"></a> 418         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L419" name="L419"></a> 419             <em class="comment">// Exact matches only.</em>
<a id="L420" name="L420"></a> 420             <em class="comment">// For example, "/a/b" and "/a/b/" both imply "/a/b/"</em>
<a id="L421" name="L421"></a> 421             <strong class="reserved">if</strong> ((!that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>()))
<a id="L422" name="L422"></a> 422                 &amp;&amp; (!that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19040.html" title="Multiple defined in 3 places.">getFile</a>()+"/"))) <em class="brace">{</em>
<a id="L423" name="L423"></a> 423                 <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L424" name="L424"></a> 424             <em class="brace">}</em>
<a id="L425" name="L425"></a> 425         <em class="brace">}</em>
<a id="L426" name="L426"></a> 426 
<a id="L427" name="L427"></a> 427         <strong class="reserved">if</strong> (<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/21910.html" title="Multiple defined in 7 places.">getRef</a>() != <strong class="reserved">null</strong>
<a id="L428" name="L428"></a> 428             &amp;&amp; !<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/21910.html" title="Multiple defined in 7 places.">getRef</a>().<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/21910.html" title="Multiple defined in 7 places.">getRef</a>())) <em class="brace">{</em>
<a id="L429" name="L429"></a> 429             <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L430" name="L430"></a> 430         <em class="brace">}</em>
<a id="L431" name="L431"></a> 431 
<a id="L432" name="L432"></a> 432         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> thisHost = <a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19490.html" title="Multiple defined in 17 places.">getHost</a>();
<a id="L433" name="L433"></a> 433         <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> thatHost = that.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>.<a href="../D/19490.html" title="Multiple defined in 17 places.">getHost</a>();
<a id="L434" name="L434"></a> 434         <strong class="reserved">if</strong> (thisHost != <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L435" name="L435"></a> 435             <strong class="reserved">if</strong> (("".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(thisHost) || "localhost".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(thisHost)) &amp;&amp;
<a id="L436" name="L436"></a> 436                 ("".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(thatHost) || "localhost".<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(thatHost))) <em class="brace">{</em>
<a id="L437" name="L437"></a> 437                 <em class="comment">// ok</em>
<a id="L438" name="L438"></a> 438             <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (!thisHost.<a href="../D/15685.html" title="Multiple defined in 654 places.">equals</a>(thatHost)) <em class="brace">{</em>
<a id="L439" name="L439"></a> 439                 <strong class="reserved">if</strong> (thatHost == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L440" name="L440"></a> 440                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L441" name="L441"></a> 441                 <em class="brace">}</em>
<a id="L442" name="L442"></a> 442                 <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.sp == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L443" name="L443"></a> 443                     <strong class="reserved">this</strong>.sp = <strong class="reserved">new</strong> <a href="../S/774.html#L148" title="Defined at 148 in src/java/net/SocketPermission.java.">SocketPermission</a>(thisHost, "resolve");
<a id="L444" name="L444"></a> 444                 <em class="brace">}</em>
<a id="L445" name="L445"></a> 445                 <strong class="reserved">if</strong> (that.sp == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L446" name="L446"></a> 446                     that.sp = <strong class="reserved">new</strong> <a href="../S/774.html#L148" title="Defined at 148 in src/java/net/SocketPermission.java.">SocketPermission</a>(thatHost, "resolve");
<a id="L447" name="L447"></a> 447                 <em class="brace">}</em>
<a id="L448" name="L448"></a> 448                 <strong class="reserved">if</strong> (!<strong class="reserved">this</strong>.sp.<a href="../D/24381.html" title="Multiple defined in 34 places.">implies</a>(that.sp)) <em class="brace">{</em>
<a id="L449" name="L449"></a> 449                     <strong class="reserved">return</strong> <strong class="reserved">false</strong>;
<a id="L450" name="L450"></a> 450                 <em class="brace">}</em>
<a id="L451" name="L451"></a> 451             <em class="brace">}</em>
<a id="L452" name="L452"></a> 452         <em class="brace">}</em>
<a id="L453" name="L453"></a> 453         <em class="comment">// everything matches</em>
<a id="L454" name="L454"></a> 454         <strong class="reserved">return</strong> <strong class="reserved">true</strong>;
<a id="L455" name="L455"></a> 455     <em class="brace">}</em>
<a id="L456" name="L456"></a> 456 
<div class="comment">
      Returns a string describing this CodeSource, telling its
      URL and certificates.
      @return information about this CodeSource.</div>
<a id="L463" name="L463"></a> 463     @<a href="../S/1740.html#L51" title="Defined at 51 in src/java/lang/Override.java.">Override</a>
<a id="L464" name="L464"></a> 464     <strong class="reserved">public</strong> <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> <a href="../R/29337.html" title="Multiple referred from 3013 places.">toString</a>() <em class="brace">{</em>
<a id="L465" name="L465"></a> 465         <a href="../S/1560.html#L76" title="Defined at 76 in src/java/lang/StringBuilder.java.">StringBuilder</a> sb = <strong class="reserved">new</strong> <a href="../S/1560.html#L76" title="Defined at 76 in src/java/lang/StringBuilder.java.">StringBuilder</a>();
<a id="L466" name="L466"></a> 466         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>("(");
<a id="L467" name="L467"></a> 467         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(<strong class="reserved">this</strong>.<a href="../D/27026.html" title="Multiple defined in 4 places.">location</a>);
<a id="L468" name="L468"></a> 468 
<a id="L469" name="L469"></a> 469         <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.certs != <strong class="reserved">null</strong> &amp;&amp; <strong class="reserved">this</strong>.certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; 0) <em class="brace">{</em>
<a id="L470" name="L470"></a> 470             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <strong class="reserved">this</strong>.certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L471" name="L471"></a> 471                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>( " " + <strong class="reserved">this</strong>.certs[i]);
<a id="L472" name="L472"></a> 472             <em class="brace">}</em>
<a id="L473" name="L473"></a> 473 
<a id="L474" name="L474"></a> 474         <em class="brace">}</em> <strong class="reserved">else</strong> <strong class="reserved">if</strong> (<strong class="reserved">this</strong>.signers != <strong class="reserved">null</strong> &amp;&amp; <strong class="reserved">this</strong>.signers.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; 0) <em class="brace">{</em>
<a id="L475" name="L475"></a> 475             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <strong class="reserved">this</strong>.signers.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L476" name="L476"></a> 476                 sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>( " " + <strong class="reserved">this</strong>.signers[i]);
<a id="L477" name="L477"></a> 477             <em class="brace">}</em>
<a id="L478" name="L478"></a> 478         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L479" name="L479"></a> 479             sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(" &lt;no signer certificates&gt;");
<a id="L480" name="L480"></a> 480         <em class="brace">}</em>
<a id="L481" name="L481"></a> 481         sb.<a href="../D/11357.html" title="Multiple defined in 137 places.">append</a>(")");
<a id="L482" name="L482"></a> 482         <strong class="reserved">return</strong> sb.<a href="../D/35493.html" title="Multiple defined in 1021 places.">toString</a>();
<a id="L483" name="L483"></a> 483     <em class="brace">}</em>
<a id="L484" name="L484"></a> 484 
<div class="comment">
      Writes this object out to a stream (i.e., serializes it).
      @serialData An initial <code>URL</code> is followed by an
      <code>int</code> indicating the number of certificates to follow
      (a value of "zero" denotes that there are no certificates associated
      with this object).
      Each certificate is written out starting with a <code>String</code>
      denoting the certificate type, followed by an
      <code>int</code> specifying the length of the certificate encoding,
      followed by the certificate encoding itself which is written out as an
      array of bytes. Finally, if any code signers are present then the array
      of code signers is serialized and written out too.</div>
<a id="L499" name="L499"></a> 499     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/30680.html" title="Multiple referred from 184 places.">writeObject</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1381.html#L162" title="Defined at 162 in src/java/io/ObjectOutputStream.java.">ObjectOutputStream</a> oos)
<a id="L500" name="L500"></a> 500         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>
<a id="L501" name="L501"></a> 501     <em class="brace">{</em>
<a id="L502" name="L502"></a> 502         oos.<a href="../D/14752.html" title="Multiple defined in 6 places.">defaultWriteObject</a>(); <em class="comment">// location</em>
<a id="L503" name="L503"></a> 503 
<a id="L504" name="L504"></a> 504         <em class="comment">// Serialize the array of certs</em>
<a id="L505" name="L505"></a> 505         <strong class="reserved">if</strong> (certs == <strong class="reserved">null</strong> || certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> == 0) <em class="brace">{</em>
<a id="L506" name="L506"></a> 506             oos.<a href="../D/37085.html" title="Multiple defined in 12 places.">writeInt</a>(0);
<a id="L507" name="L507"></a> 507         <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L508" name="L508"></a> 508             <em class="comment">// write out the total number of certs</em>
<a id="L509" name="L509"></a> 509             oos.<a href="../D/37085.html" title="Multiple defined in 12 places.">writeInt</a>(certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L510" name="L510"></a> 510             <em class="comment">// write out each cert, including its type</em>
<a id="L511" name="L511"></a> 511             <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>; i++) <em class="brace">{</em>
<a id="L512" name="L512"></a> 512                 <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a> cert = certs[i];
<a id="L513" name="L513"></a> 513                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L514" name="L514"></a> 514                     oos.<a href="../D/37198.html" title="Multiple defined in 10 places.">writeUTF</a>(cert.<a href="../D/23311.html" title="Multiple defined in 232 places.">getType</a>());
<a id="L515" name="L515"></a> 515                     <strong class="reserved">byte</strong>[] encoded = cert.<a href="../D/18742.html" title="Multiple defined in 18 places.">getEncoded</a>();
<a id="L516" name="L516"></a> 516                     oos.<a href="../D/37085.html" title="Multiple defined in 12 places.">writeInt</a>(encoded.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>);
<a id="L517" name="L517"></a> 517                     oos.<a href="../D/36968.html" title="Multiple defined in 508 places.">write</a>(encoded);
<a id="L518" name="L518"></a> 518                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1347.html" title="Multiple defined in 2 places.">CertificateEncodingException</a> cee) <em class="brace">{</em>
<a id="L519" name="L519"></a> 519                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>(cee.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L520" name="L520"></a> 520                 <em class="brace">}</em>
<a id="L521" name="L521"></a> 521             <em class="brace">}</em>
<a id="L522" name="L522"></a> 522         <em class="brace">}</em>
<a id="L523" name="L523"></a> 523 
<a id="L524" name="L524"></a> 524         <em class="comment">// Serialize the array of code signers (if any)</em>
<a id="L525" name="L525"></a> 525         <strong class="reserved">if</strong> (signers != <strong class="reserved">null</strong> &amp;&amp; signers.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &gt; 0) <em class="brace">{</em>
<a id="L526" name="L526"></a> 526             oos.<a href="../D/37124.html" title="Multiple defined in 263 places.">writeObject</a>(signers);
<a id="L527" name="L527"></a> 527         <em class="brace">}</em>
<a id="L528" name="L528"></a> 528     <em class="brace">}</em>
<a id="L529" name="L529"></a> 529 
<div class="comment">
      Restores this object from a stream (i.e., deserializes it).</div>
<a id="L533" name="L533"></a> 533     <strong class="reserved">private</strong> <strong class="reserved">void</strong> <a href="../R/25518.html" title="Multiple referred from 189 places.">readObject</a>(<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.io.<a href="../S/1378.html#L206" title="Defined at 206 in src/java/io/ObjectInputStream.java.">ObjectInputStream</a> ois)
<a id="L534" name="L534"></a> 534         <strong class="reserved">throws</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>, <a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a>
<a id="L535" name="L535"></a> 535     <em class="brace">{</em>
<a id="L536" name="L536"></a> 536         <a href="../S/1307.html#L126" title="Defined at 126 in src/java/security/cert/CertificateFactory.java.">CertificateFactory</a> cf;
<a id="L537" name="L537"></a> 537         <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>, <a href="../S/1307.html#L126" title="Defined at 126 in src/java/security/cert/CertificateFactory.java.">CertificateFactory</a>&gt; cfs = <strong class="reserved">null</strong>;
<a id="L538" name="L538"></a> 538 
<a id="L539" name="L539"></a> 539         ois.<a href="../D/14746.html" title="Multiple defined in 2 places.">defaultReadObject</a>(); <em class="comment">// location</em>
<a id="L540" name="L540"></a> 540 
<a id="L541" name="L541"></a> 541         <em class="comment">// process any new-style certs in the stream (if present)</em>
<a id="L542" name="L542"></a> 542         <strong class="reserved">int</strong> <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a> = ois.<a href="../D/30206.html" title="Multiple defined in 10 places.">readInt</a>();
<a id="L543" name="L543"></a> 543         <strong class="reserved">if</strong> (<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a> &gt; 0) <em class="brace">{</em>
<a id="L544" name="L544"></a> 544             <em class="comment">// we know of 3 different cert types: X.509, PGP, SDSI, which</em>
<a id="L545" name="L545"></a> 545             <em class="comment">// could all be present in the stream at the same time</em>
<a id="L546" name="L546"></a> 546             cfs = <strong class="reserved">new</strong> <a href="../D/3743.html" title="Multiple defined in 2 places.">Hashtable</a>&lt;<a href="../D/8419.html" title="Multiple defined in 2 places.">String</a>, <a href="../S/1307.html#L126" title="Defined at 126 in src/java/security/cert/CertificateFactory.java.">CertificateFactory</a>&gt;(3);
<a id="L547" name="L547"></a> 547             <strong class="reserved">this</strong>.certs = <strong class="reserved">new</strong> <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a>[<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>];
<a id="L548" name="L548"></a> 548         <em class="brace">}</em>
<a id="L549" name="L549"></a> 549 
<a id="L550" name="L550"></a> 550         <strong class="reserved">for</strong> (<strong class="reserved">int</strong> i = 0; i &lt; <a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>; i++) <em class="brace">{</em>
<a id="L551" name="L551"></a> 551             <em class="comment">// read the certificate type, and instantiate a certificate</em>
<a id="L552" name="L552"></a> 552             <em class="comment">// factory of that type (reuse existing factory if possible)</em>
<a id="L553" name="L553"></a> 553             <a href="../D/8419.html" title="Multiple defined in 2 places.">String</a> certType = ois.<a href="../D/30284.html" title="Multiple defined in 9 places.">readUTF</a>();
<a id="L554" name="L554"></a> 554             <strong class="reserved">if</strong> (cfs.<a href="../D/13333.html" title="Multiple defined in 42 places.">containsKey</a>(certType)) <em class="brace">{</em>
<a id="L555" name="L555"></a> 555                 <em class="comment">// reuse certificate factory</em>
<a id="L556" name="L556"></a> 556                 cf = cfs.<a href="../D/16676.html" title="Multiple defined in 434 places.">get</a>(certType);
<a id="L557" name="L557"></a> 557             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L558" name="L558"></a> 558                 <em class="comment">// create new certificate factory</em>
<a id="L559" name="L559"></a> 559                 <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L560" name="L560"></a> 560                     cf = <a href="../S/1307.html#L126" title="Defined at 126 in src/java/security/cert/CertificateFactory.java.">CertificateFactory</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>(certType);
<a id="L561" name="L561"></a> 561                 <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1348.html" title="Multiple defined in 2 places.">CertificateException</a> ce) <em class="brace">{</em>
<a id="L562" name="L562"></a> 562                     <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1705.html#L53" title="Defined at 53 in src/java/lang/ClassNotFoundException.java.">ClassNotFoundException</a>
<a id="L563" name="L563"></a> 563                         ("Certificate factory for " + certType + " not found");
<a id="L564" name="L564"></a> 564                 <em class="brace">}</em>
<a id="L565" name="L565"></a> 565                 <em class="comment">// store the certificate factory so we can reuse it later</em>
<a id="L566" name="L566"></a> 566                 cfs.<a href="../D/29971.html" title="Multiple defined in 370 places.">put</a>(certType, cf);
<a id="L567" name="L567"></a> 567             <em class="brace">}</em>
<a id="L568" name="L568"></a> 568             <em class="comment">// parse the certificate</em>
<a id="L569" name="L569"></a> 569             <strong class="reserved">byte</strong>[] encoded = <strong class="reserved">null</strong>;
<a id="L570" name="L570"></a> 570             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L571" name="L571"></a> 571                 encoded = <strong class="reserved">new</strong> <strong class="reserved">byte</strong>[ois.<a href="../D/30206.html" title="Multiple defined in 10 places.">readInt</a>()];
<a id="L572" name="L572"></a> 572             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1597.html#L41" title="Defined at 41 in src/java/lang/OutOfMemoryError.java.">OutOfMemoryError</a> oome) <em class="brace">{</em>
<a id="L573" name="L573"></a> 573                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>("Certificate too big");
<a id="L574" name="L574"></a> 574             <em class="brace">}</em>
<a id="L575" name="L575"></a> 575             ois.<a href="../D/30189.html" title="Multiple defined in 33 places.">readFully</a>(encoded);
<a id="L576" name="L576"></a> 576             <a href="../S/1443.html#L44" title="Defined at 44 in src/java/io/ByteArrayInputStream.java.">ByteArrayInputStream</a> bais = <strong class="reserved">new</strong> <a href="../S/1443.html#L44" title="Defined at 44 in src/java/io/ByteArrayInputStream.java.">ByteArrayInputStream</a>(encoded);
<a id="L577" name="L577"></a> 577             <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L578" name="L578"></a> 578                 <strong class="reserved">this</strong>.certs[i] = cf.<a href="../S/1307.html#L336" title="Defined at 336 in src/java/security/cert/CertificateFactory.java.">generateCertificate</a>(bais);
<a id="L579" name="L579"></a> 579             <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1348.html" title="Multiple defined in 2 places.">CertificateException</a> ce) <em class="brace">{</em>
<a id="L580" name="L580"></a> 580                 <strong class="reserved">throw</strong> <strong class="reserved">new</strong> <a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a>(ce.<a href="../D/20565.html" title="Multiple defined in 56 places.">getMessage</a>());
<a id="L581" name="L581"></a> 581             <em class="brace">}</em>
<a id="L582" name="L582"></a> 582             bais.<a href="../D/12922.html" title="Multiple defined in 218 places.">close</a>();
<a id="L583" name="L583"></a> 583         <em class="brace">}</em>
<a id="L584" name="L584"></a> 584 
<a id="L585" name="L585"></a> 585         <em class="comment">// Deserialize array of code signers (if any)</em>
<a id="L586" name="L586"></a> 586         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L587" name="L587"></a> 587             <strong class="reserved">this</strong>.signers = ((<a href="../S/1331.html#L39" title="Defined at 39 in src/java/security/CodeSigner.java.">CodeSigner</a>[])ois.<a href="../D/30232.html" title="Multiple defined in 322 places.">readObject</a>()).<a href="../D/12888.html" title="Multiple defined in 229 places.">clone</a>();
<a id="L588" name="L588"></a> 588         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../S/1392.html#L39" title="Defined at 39 in src/java/io/IOException.java.">IOException</a> ioe) <em class="brace">{</em>
<a id="L589" name="L589"></a> 589             <em class="comment">// no signers present</em>
<a id="L590" name="L590"></a> 590         <em class="brace">}</em>
<a id="L591" name="L591"></a> 591     <em class="brace">}</em>
<a id="L592" name="L592"></a> 592 
<div class="comment">
      Convert an array of certificates to an array of code signers.
      The array of certificates is a concatenation of certificate chains
      where the initial certificate in each chain is the end-entity cert.
      @return An array of code signers or null if none are generated.</div>
<a id="L600" name="L600"></a> 600     <strong class="reserved">private</strong> <a href="../S/1331.html#L39" title="Defined at 39 in src/java/security/CodeSigner.java.">CodeSigner</a>[] <a href="../S/1318.html#L225" title="Referred from 225 in src/java/security/CodeSource.java.">convertCertArrayToSignerArray</a>(
<a id="L601" name="L601"></a> 601         <a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a>[] certs) <em class="brace">{</em>
<a id="L602" name="L602"></a> 602 
<a id="L603" name="L603"></a> 603         <strong class="reserved">if</strong> (certs == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L604" name="L604"></a> 604             <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L605" name="L605"></a> 605         <em class="brace">}</em>
<a id="L606" name="L606"></a> 606 
<a id="L607" name="L607"></a> 607         <strong class="reserved">try</strong> <em class="brace">{</em>
<a id="L608" name="L608"></a> 608             <em class="comment">// Initialize certificate factory</em>
<a id="L609" name="L609"></a> 609             <strong class="reserved">if</strong> (<a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a> == <strong class="reserved">null</strong>) <em class="brace">{</em>
<a id="L610" name="L610"></a> 610                 <a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a> = <a href="../S/1307.html#L126" title="Defined at 126 in src/java/security/cert/CertificateFactory.java.">CertificateFactory</a>.<a href="../D/19762.html" title="Multiple defined in 157 places.">getInstance</a>("X.509");
<a id="L611" name="L611"></a> 611             <em class="brace">}</em>
<a id="L612" name="L612"></a> 612 
<a id="L613" name="L613"></a> 613             <em class="comment">// Iterate through all the certificates</em>
<a id="L614" name="L614"></a> 614             <strong class="reserved">int</strong> i = 0;
<a id="L615" name="L615"></a> 615             <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/1331.html#L39" title="Defined at 39 in src/java/security/CodeSigner.java.">CodeSigner</a>&gt; signers = <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;&gt;();
<a id="L616" name="L616"></a> 616             <strong class="reserved">while</strong> (i &lt; certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a>) <em class="brace">{</em>
<a id="L617" name="L617"></a> 617                 <a href="../D/5090.html" title="Multiple defined in 5 places.">List</a>&lt;<a href="../S/3625.html#L43" title="Defined at 43 in src/javax/management/remote/rmi/RMIConnectionImpl_Stub.java.">java</a>.security.cert.<a href="../D/1346.html" title="Multiple defined in 3 places.">Certificate</a>&gt; certChain =
<a id="L618" name="L618"></a> 618                         <strong class="reserved">new</strong> <a href="../D/498.html" title="Multiple defined in 2 places.">ArrayList</a>&lt;&gt;();
<a id="L619" name="L619"></a> 619                 certChain.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(certs[i++]); <em class="comment">// first cert is an end-entity cert</em>
<a id="L620" name="L620"></a> 620                 <strong class="reserved">int</strong> j = i;
<a id="L621" name="L621"></a> 621 
<a id="L622" name="L622"></a> 622                 <em class="comment">// Extract chain of certificates</em>
<a id="L623" name="L623"></a> 623                 <em class="comment">// (loop while certs are not end-entity certs)</em>
<a id="L624" name="L624"></a> 624                 <strong class="reserved">while</strong> (j &lt; certs.<a href="../D/26813.html" title="Multiple defined in 43 places.">length</a> &amp;&amp;
<a id="L625" name="L625"></a> 625                     certs[j] <strong class="reserved">instanceof</strong> <a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a> &amp;&amp;
<a id="L626" name="L626"></a> 626                     ((<a href="../D/9813.html" title="Multiple defined in 2 places.">X509Certificate</a>)certs[j]).<a href="../D/17215.html" title="Multiple defined in 2 places.">getBasicConstraints</a>() != -1) <em class="brace">{</em>
<a id="L627" name="L627"></a> 627                     certChain.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(certs[j]);
<a id="L628" name="L628"></a> 628                     j++;
<a id="L629" name="L629"></a> 629                 <em class="brace">}</em>
<a id="L630" name="L630"></a> 630                 i = j;
<a id="L631" name="L631"></a> 631                 <a href="../S/1316.html#L120" title="Defined at 120 in src/java/security/cert/CertPath.java.">CertPath</a> certPath = <a href="../D/15962.html" title="Multiple defined in 2 places.">factory</a>.<a href="../D/16635.html" title="Multiple defined in 3 places.">generateCertPath</a>(certChain);
<a id="L632" name="L632"></a> 632                 signers.<a href="../D/10632.html" title="Multiple defined in 301 places.">add</a>(<strong class="reserved">new</strong> <a href="../S/1331.html#L39" title="Defined at 39 in src/java/security/CodeSigner.java.">CodeSigner</a>(certPath, <strong class="reserved">null</strong>));
<a id="L633" name="L633"></a> 633             <em class="brace">}</em>
<a id="L634" name="L634"></a> 634 
<a id="L635" name="L635"></a> 635             <strong class="reserved">if</strong> (signers.<a href="../D/25493.html" title="Multiple defined in 113 places.">isEmpty</a>()) <em class="brace">{</em>
<a id="L636" name="L636"></a> 636                 <strong class="reserved">return</strong> <strong class="reserved">null</strong>;
<a id="L637" name="L637"></a> 637             <em class="brace">}</em> <strong class="reserved">else</strong> <em class="brace">{</em>
<a id="L638" name="L638"></a> 638                 <strong class="reserved">return</strong> signers.<a href="../D/35348.html" title="Multiple defined in 117 places.">toArray</a>(<strong class="reserved">new</strong> <a href="../S/1331.html#L39" title="Defined at 39 in src/java/security/CodeSigner.java.">CodeSigner</a>[signers.<a href="../D/34593.html" title="Multiple defined in 204 places.">size</a>()]);
<a id="L639" name="L639"></a> 639             <em class="brace">}</em>
<a id="L640" name="L640"></a> 640 
<a id="L641" name="L641"></a> 641         <em class="brace">}</em> <strong class="reserved">catch</strong> (<a href="../D/1348.html" title="Multiple defined in 2 places.">CertificateException</a> e) <em class="brace">{</em>
<a id="L642" name="L642"></a> 642             <strong class="reserved">return</strong> <strong class="reserved">null</strong>; <em class="comment">//TODO - may be better to throw an ex. here</em>
<a id="L643" name="L643"></a> 643         <em class="brace">}</em>
<a id="L644" name="L644"></a> 644     <em class="brace">}</em>
<a id="L645" name="L645"></a> 645 <em class="brace">}</em>
</pre>
<hr>
<div class="comment">
/* [&lt;][&gt;]<a href="#L118">[^]</a><a href="#L600">[v]</a><a href="#TOP">[top]</a>[bottom]<a href="../mains.html">[index]</a><a href="../help.html">[help]</a> */</div>
</body></html>